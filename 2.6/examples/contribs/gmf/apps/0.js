(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[0],{

/***/ "./node_modules/mapillary-js/dist/mapillary.js":
/*!*****************************************************!*\
  !*** ./node_modules/mapillary-js/dist/mapillary.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {!function(t,e){ true?e(exports):undefined}(this,(function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,i)};function i(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}function n(t){return"function"==typeof t}var r=!1,s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;r=t},get useDeprecatedSynchronousErrorHandling(){return r}};function o(t){setTimeout((function(){throw t}),0)}var a={closed:!0,next:function(t){},error:function(t){if(s.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete:function(){}},c=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function h(t){return null!==t&&"object"==typeof t}var l=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),u=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var i=this,r=i._parentOrParents,s=i._ctorUnsubscribe,o=i._unsubscribe,a=i._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var u=0;u<r.length;++u){r[u].remove(this)}if(n(o)){s&&(this._unsubscribe=void 0);try{o.call(this)}catch(t){e=t instanceof l?d(t.errors):[t]}}if(c(a)){u=-1;for(var p=a.length;++u<p;){var f=a[u];if(h(f))try{f.unsubscribe()}catch(t){e=e||[],t instanceof l?e=e.concat(d(t.errors)):e.push(t)}}}if(e)throw new l(e)}},t.prototype.add=function(e){var i=e;if(!e)return t.EMPTY;switch(typeof e){case"function":i=new t(e);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof t)){var n=i;(i=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var r=i._parentOrParents;if(null===r)i._parentOrParents=this;else if(r instanceof t){if(r===this)return i;i._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return i;r.push(this)}var s=this._subscriptions;return null===s?this._subscriptions=[i]:s.push(i),i},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function d(t){return t.reduce((function(t,e){return t.concat(e instanceof l?e.errors:e)}),[])}var p=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),f=function(t){function e(i,n,r){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=a;break;case 1:if(!i){s.destination=a;break}if("object"==typeof i){i instanceof e?(s.syncErrorThrowable=i.syncErrorThrowable,s.destination=i,i.add(s)):(s.syncErrorThrowable=!0,s.destination=new m(s,i));break}default:s.syncErrorThrowable=!0,s.destination=new m(s,i,n,r)}return s}return i(e,t),e.prototype[p]=function(){return this},e.create=function(t,i,n){var r=new e(t,i,n);return r.syncErrorThrowable=!1,r},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(u),m=function(t){function e(e,i,r,s){var o,c=t.call(this)||this;c._parentSubscriber=e;var h=c;return n(i)?o=i:i&&(o=i.next,r=i.error,s=i.complete,i!==a&&(n((h=Object.create(i)).unsubscribe)&&c.add(h.unsubscribe.bind(h)),h.unsubscribe=c.unsubscribe.bind(c))),c._context=h,c._next=o,c._error=r,c._complete=s,c}return i(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,i=s.useDeprecatedSynchronousErrorHandling;if(this._error)i&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)i?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;o(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var i=function(){return t._complete.call(t._context)};s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw t;o(t)}},e.prototype.__tryOrSetError=function(t,e,i){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,i)}catch(e){return s.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(o(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(f);var g=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function _(t){return t}function v(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return y(t)}function y(t){return 0===t.length?_:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var b=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var i=new t;return i.source=this,i.operator=e,i},t.prototype.subscribe=function(t,e,i){var n=this.operator,r=function(t,e,i){if(t){if(t instanceof f)return t;if(t[p])return t[p]()}return t||e||i?new f(t,e,i):new f(a)}(t,e,i);if(n?r.add(n.call(r,this.source)):r.add(this.source||s.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),s.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){s.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,i=e.closed,n=e.destination,r=e.isStopped;if(i||r)return!1;t=n&&n instanceof f?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var i=this;return new(e=x(e))((function(e,n){var r;r=i.subscribe((function(e){try{t(e)}catch(t){n(t),r&&r.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[g]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:y(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=x(t))((function(t,i){var n;e.subscribe((function(t){return n=t}),(function(t){return i(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function x(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var w=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),S=function(t){function e(e,i){var n=t.call(this)||this;return n.subject=e,n.subscriber=i,n.closed=!1,n}return i(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}},e}(u),M=function(t){function e(e){var i=t.call(this,e)||this;return i.destination=e,i}return i(e,t),e}(f),T=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return i(e,t),e.prototype[p]=function(){return new M(this)},e.prototype.lift=function(t){var e=new C(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new w;if(!this.isStopped)for(var e=this.observers,i=e.length,n=e.slice(),r=0;r<i;r++)n[r].next(t)},e.prototype.error=function(t){if(this.closed)throw new w;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,i=e.length,n=e.slice(),r=0;r<i;r++)n[r].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new w;this.isStopped=!0;for(var t=this.observers,e=t.length,i=t.slice(),n=0;n<e;n++)i[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new w;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new w;return this.hasError?(t.error(this.thrownError),u.EMPTY):this.isStopped?(t.complete(),u.EMPTY):(this.observers.push(t),new S(this,t))},e.prototype.asObservable=function(){var t=new b;return t.source=this,t},e.create=function(t,e){return new C(t,e)},e}(b),C=function(t){function e(e,i){var n=t.call(this)||this;return n.destination=e,n.source=i,n}return i(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):u.EMPTY},e}(T);function E(){return function(t){return t.lift(new I(t))}}var I=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var i=this.connectable;i._refCount++;var n=new A(t,i),r=e.subscribe(n);return n.closed||(n.connection=i.connect()),r},t}(),A=function(t){function e(e,i){var n=t.call(this,e)||this;return n.connectable=i,n}return i(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var i=this.connection,n=t._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}else this.connection=null},e}(f),P=function(t){function e(e,i){var n=t.call(this)||this;return n.source=e,n.subjectFactory=i,n._refCount=0,n._isComplete=!1,n}return i(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new u).add(this.source.subscribe(new L(this.getSubject(),this))),t.closed&&(this._connection=null,t=u.EMPTY)),t},e.prototype.refCount=function(){return E()(this)},e}(b),R=function(){var t=P.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),L=function(t){function e(e,i){var n=t.call(this,e)||this;return n.connectable=i,n}return i(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(M),O=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return i(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var i=t.prototype._subscribe.call(this,e);return i&&!i.closed&&e.next(this._value),i},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new w;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(T),N=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.scheduler=e,n.work=i,n.pending=!1,n}return i(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,e,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var i=!1,n=void 0;try{this.work(t)}catch(t){i=!0,n=!!t&&t||new Error(t)}if(i)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,i){return t.call(this)||this}return i(e,t),e.prototype.schedule=function(t,e){return this},e}(u)),D=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.scheduler=e,n.work=i,n}return i(e,t),e.prototype.schedule=function(e,i){return void 0===i&&(i=0),i>0?t.prototype.schedule.call(this,e,i):(this.delay=i,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,i){return i>0||this.closed?t.prototype.execute.call(this,e,i):this._execute(e,i)},e.prototype.requestAsyncId=function(e,i,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?t.prototype.requestAsyncId.call(this,e,i,n):e.flush(this)},e}(N),$=function(){function t(e,i){void 0===i&&(i=t.now),this.SchedulerAction=e,this.now=i}return t.prototype.schedule=function(t,e,i){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(i,e)},t.now=function(){return Date.now()},t}(),k=function(t){function e(i,n){void 0===n&&(n=$.now);var r=t.call(this,i,(function(){return e.delegate&&e.delegate!==r?e.delegate.now():n()}))||this;return r.actions=[],r.active=!1,r.scheduled=void 0,r}return i(e,t),e.prototype.schedule=function(i,n,r){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(i,n,r):t.prototype.schedule.call(this,i,n,r)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}},e}($),z=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(k))(D),F=new b((function(t){return t.complete()}));function B(t){return t?function(t){return new b((function(e){return t.schedule((function(){return e.complete()}))}))}(t):F}function j(t){return t&&"function"==typeof t.schedule}var H=function(t){return function(e){for(var i=0,n=t.length;i<n&&!e.closed;i++)e.next(t[i]);e.complete()}};function U(t,e){return new b((function(i){var n=new u,r=0;return n.add(e.schedule((function(){r!==t.length?(i.next(t[r++]),i.closed||n.add(this.schedule())):i.complete()}))),n}))}function V(t,e){return e?U(t,e):new b(H(t))}function G(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[t.length-1];return j(i)?(t.pop(),U(t,i)):V(t)}function q(t,e){return new b(e?function(i){return e.schedule(W,0,{error:t,subscriber:i})}:function(e){return e.error(t)})}function W(t){var e=t.error;t.subscriber.error(e)}var X=function(){function t(t,e,i){this.kind=t,this.value=e,this.error=i,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,i){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return i&&i()}},t.prototype.accept=function(t,e,i){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,i)},t.prototype.toObservable=function(){switch(this.kind){case"N":return G(this.value);case"E":return q(this.error);case"C":return B()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}(),Y=function(t){function e(e,i,n){void 0===n&&(n=0);var r=t.call(this,e)||this;return r.scheduler=i,r.delay=n,r}return i(e,t),e.dispatch=function(t){var e=t.notification,i=t.destination;e.observe(i),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new Z(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(X.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(X.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(X.createComplete()),this.unsubscribe()},e}(f),Z=function(){return function(t,e){this.notification=t,this.destination=e}}(),J=function(t){function e(e,i,n){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===i&&(i=Number.POSITIVE_INFINITY);var r=t.call(this)||this;return r.scheduler=n,r._events=[],r._infiniteTimeWindow=!1,r._bufferSize=e<1?1:e,r._windowTime=i<1?1:i,i===Number.POSITIVE_INFINITY?(r._infiniteTimeWindow=!0,r.next=r.nextInfiniteTimeWindow):r.next=r.nextTimeWindow,r}return i(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var i=this._events;i.push(e),i.length>this._bufferSize&&i.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new K(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,i=this._infiniteTimeWindow,n=i?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,s=n.length;if(this.closed)throw new w;if(this.isStopped||this.hasError?e=u.EMPTY:(this.observers.push(t),e=new S(this,t)),r&&t.add(t=new Y(t,r)),i)for(var o=0;o<s&&!t.closed;o++)t.next(n[o]);else for(o=0;o<s&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||z).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,i=this._windowTime,n=this._events,r=n.length,s=0;s<r&&!(t-n[s].time<i);)s++;return r>e&&(s=Math.max(s,r-e)),s>0&&n.splice(0,s),n},e}(T),K=function(){return function(t,e){this.time=t,this.value=e}}(),Q=new k(N);function tt(){}var et=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),it=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}(),nt=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}();function rt(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new st(t,e))}}var st=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new ot(t,this.project,this.thisArg))},t}(),ot=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.project=i,r.count=0,r.thisArg=n||r,r}return i(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(f),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.notifyNext=function(t,e,i,n,r){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(f),ct=function(t){function e(e,i,n){var r=t.call(this)||this;return r.parent=e,r.outerValue=i,r.outerIndex=n,r.index=0,r}return i(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(f);function ht(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var lt=ht(),ut=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function dt(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var pt=function(t){if(t&&"function"==typeof t[g])return n=t,function(t){var e=n[g]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(ut(t))return H(t);if(dt(t))return i=t,function(t){return i.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,o),t};if(t&&"function"==typeof t[lt])return e=t,function(t){for(var i=e[lt]();;){var n=void 0;try{n=i.next()}catch(e){return t.error(e),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof i.return&&t.add((function(){i.return&&i.return()})),t};var e,i,n,r=h(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+r+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function ft(t,e,i,n,r){if(void 0===r&&(r=new ct(t,i,n)),!r.closed)return e instanceof b?e.subscribe(r):pt(e)(r)}var mt={};function gt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=void 0,n=void 0;return j(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(i=t.pop()),1===t.length&&c(t[0])&&(t=t[0]),V(t,n).lift(new _t(i))}var _t=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new vt(t,this.resultSelector))},t}(),vt=function(t){function e(e,i){var n=t.call(this,e)||this;return n.resultSelector=i,n.active=0,n.values=[],n.observables=[],n}return i(e,t),e.prototype._next=function(t){this.values.push(mt),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var i=0;i<e;i++){var n=t[i];this.add(ft(this,n,void 0,i))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,i){var n=this.values,r=n[i],s=this.toRespond?r===mt?--this.toRespond:this.toRespond:0;n[i]=e,0===s&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(at);function yt(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[g]}(t))return function(t,e){return new b((function(i){var n=new u;return n.add(e.schedule((function(){var r=t[g]();n.add(r.subscribe({next:function(t){n.add(e.schedule((function(){return i.next(t)})))},error:function(t){n.add(e.schedule((function(){return i.error(t)})))},complete:function(){n.add(e.schedule((function(){return i.complete()})))}}))}))),n}))}(t,e);if(dt(t))return function(t,e){return new b((function(i){var n=new u;return n.add(e.schedule((function(){return t.then((function(t){n.add(e.schedule((function(){i.next(t),n.add(e.schedule((function(){return i.complete()})))})))}),(function(t){n.add(e.schedule((function(){return i.error(t)})))}))}))),n}))}(t,e);if(ut(t))return U(t,e);if(function(t){return t&&"function"==typeof t[lt]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new b((function(i){var n,r=new u;return r.add((function(){n&&"function"==typeof n.return&&n.return()})),r.add(e.schedule((function(){n=t[lt](),r.add(e.schedule((function(){if(!i.closed){var t,e;try{var r=n.next();t=r.value,e=r.done}catch(t){return void i.error(t)}e?i.complete():(i.next(t),this.schedule())}})))}))),r}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function bt(t,e){return e?yt(t,e):t instanceof b?t:new b(pt(t))}var xt=function(t){function e(e){var i=t.call(this)||this;return i.parent=e,i}return i(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(f),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(f);function St(t,e){if(!e.closed)return t instanceof b?t.subscribe(e):pt(t)(e)}function Mt(t,e,i){return void 0===i&&(i=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(Mt((function(i,n){return bt(t(i,n)).pipe(rt((function(t,r){return e(i,t,n,r)})))}),i))}:("number"==typeof e&&(i=e),function(e){return e.lift(new Tt(t,i))})}var Tt=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Ct(t,this.project,this.concurrent))},t}(),Ct=function(t){function e(e,i,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var r=t.call(this,e)||this;return r.project=i,r.concurrent=n,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return i(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,i=this.index++;try{e=this.project(t,i)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new xt(this),i=this.destination;i.add(e);var n=St(t,e);n!==e&&i.add(n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(wt);function Et(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),Mt(_,t)}function It(){return Et(1)}function At(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return It()(G.apply(void 0,t))}function Pt(t,e,i,r){return n(i)&&(r=i,i=void 0),r?Pt(t,e,i).pipe(rt((function(t){return c(t)?r.apply(void 0,t):r(t)}))):new b((function(n){Rt(t,e,(function(t){arguments.length>1?n.next(Array.prototype.slice.call(arguments)):n.next(t)}),n,i)}))}function Rt(t,e,i,n,r){var s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var o=t;t.addEventListener(e,i,r),s=function(){return o.removeEventListener(e,i,r)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var a=t;t.on(e,i),s=function(){return a.off(e,i)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var c=t;t.addListener(e,i),s=function(){return c.removeListener(e,i)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var h=0,l=t.length;h<l;h++)Rt(t[h],e,i,n,r)}n.add(s)}function Lt(t){return!c(t)&&t-parseFloat(t)+1>=0}function Ot(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return j(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(i=t.pop())):"number"==typeof r&&(i=t.pop()),null===n&&1===t.length&&t[0]instanceof b?t[0]:Et(i)(V(t,n))}function Nt(t,e){return function(i){return i.lift(new Dt(t,e))}}var Dt=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new $t(t,this.predicate,this.thisArg))},t}(),$t=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.predicate=i,r.thisArg=n,r.count=0,r}return i(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(f);function kt(t,e,i){void 0===t&&(t=0);var n=-1;return Lt(e)?n=Number(e)<1?1:Number(e):j(e)&&(i=e),j(i)||(i=Q),new b((function(e){var r=Lt(t)?t:+t-i.now();return i.schedule(zt,r,{index:0,period:n,subscriber:e})}))}function zt(t){var e=t.index,i=t.period,n=t.subscriber;if(n.next(e),!n.closed){if(-1===i)return n.complete();t.index=e+1,this.schedule(t,i)}}function Ft(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[t.length-1];return"function"==typeof i&&t.pop(),V(t,void 0).lift(new Bt(i))}var Bt=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new jt(t,this.resultSelector))},t}(),jt=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.resultSelector=i,r.iterators=[],r.active=0,r.resultSelector="function"==typeof i?i:void 0,r}return i(e,t),e.prototype._next=function(t){var e=this.iterators;c(t)?e.push(new Ut(t)):"function"==typeof t[lt]?e.push(new Ht(t[lt]())):e.push(new Vt(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var i=0;i<e;i++){var n=t[i];if(n.stillUnsubscribed)this.destination.add(n.subscribe());else this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,i=this.destination,n=0;n<e;n++){if("function"==typeof(o=t[n]).hasValue&&!o.hasValue())return}var r=!1,s=[];for(n=0;n<e;n++){var o,a=(o=t[n]).next();if(o.hasCompleted()&&(r=!0),a.done)return void i.complete();s.push(a.value)}this.resultSelector?this._tryresultSelector(s):i.next(s),r&&i.complete()},e.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(f),Ht=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return Boolean(t&&t.done)},t}(),Ut=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[lt]=function(){return this},t.prototype.next=function(t){var e=this.index++,i=this.array;return e<this.length?{value:i[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),Vt=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.parent=i,r.observable=n,r.stillUnsubscribed=!0,r.buffer=[],r.isComplete=!1,r}return i(e,t),e.prototype[lt]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t){this.buffer.push(t),this.parent.checkIterators()},e.prototype.subscribe=function(){return St(this.observable,new xt(this))},e}(wt);var Gt=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new qt(t,this.durationSelector))},t}(),qt=function(t){function e(e,i){var n=t.call(this,e)||this;return n.durationSelector=i,n.hasValue=!1,n}return i(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(t){return this.destination.error(t)}var i=St(e,new xt(this));!i||i.closed?this.clearThrottle():this.add(this.throttled=i)}},e.prototype.clearThrottle=function(){var t=this,e=t.value,i=t.hasValue,n=t.throttled;n&&(this.remove(n),this.throttled=void 0,n.unsubscribe()),i&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))},e.prototype.notifyNext=function(){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(wt);function Wt(t,e){return void 0===e&&(e=Q),i=function(){return kt(t,e)},function(t){return t.lift(new Gt(i))};var i}function Xt(t,e){return void 0===e&&(e=null),function(i){return i.lift(new Yt(t,e))}}var Yt=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?Jt:Zt}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),Zt=function(t){function e(e,i){var n=t.call(this,e)||this;return n.bufferSize=i,n.buffer=[],n}return i(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(f),Jt=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.bufferSize=i,r.startBufferEvery=n,r.buffers=[],r.count=0,r}return i(e,t),e.prototype._next=function(t){var e=this,i=e.bufferSize,n=e.startBufferEvery,r=e.buffers,s=e.count;this.count++,s%n==0&&r.push([]);for(var o=r.length;o--;){var a=r[o];a.push(t),a.length===i&&(r.splice(o,1),this.destination.next(a))}},e.prototype._complete=function(){for(var e=this.buffers,i=this.destination;e.length>0;){var n=e.shift();n.length>0&&i.next(n)}t.prototype._complete.call(this)},e}(f);var Kt=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Qt(t,this.closingSelector))},t}(),Qt=function(t){function e(e,i){var n=t.call(this,e)||this;return n.closingSelector=i,n.subscribing=!1,n.openBuffer(),n}return i(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},e.prototype.notifyNext=function(){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e,i=this.buffer;this.buffer&&this.destination.next(i),this.buffer=[];try{e=(0,this.closingSelector)()}catch(t){return this.error(t)}t=new u,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add(St(e,new xt(this))),this.subscribing=!1},e}(wt);function te(t){return function(e){var i=new ee(t),n=e.lift(i);return i.caught=n}}var ee=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new ie(t,this.selector,this.caught))},t}(),ie=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.selector=i,r.caught=n,r}return i(e,t),e.prototype.error=function(e){if(!this.isStopped){var i=void 0;try{i=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var n=new xt(this);this.add(n);var r=St(i,n);r!==n&&this.add(r)}},e}(wt);function ne(t,e){return Mt(t,e,1)}function re(t,e){return void 0===e&&(e=Q),function(i){return i.lift(new se(t,e))}}var se=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new oe(t,this.dueTime,this.scheduler))},t}(),oe=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.dueTime=i,r.scheduler=n,r.debouncedSubscription=null,r.lastValue=null,r.hasValue=!1,r}return i(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(ae,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(f);function ae(t){t.debouncedNext()}function ce(t){return void 0===t&&(t=null),function(e){return e.lift(new he(t))}}var he=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new le(t,this.defaultValue))},t}(),le=function(t){function e(e,i){var n=t.call(this,e)||this;return n.defaultValue=i,n.isEmpty=!0,n}return i(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(f);function ue(t,e){return function(i){return i.lift(new de(t,e))}}var de=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new pe(t,this.compare,this.keySelector))},t}(),pe=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.keySelector=n,r.hasKey=!1,"function"==typeof i&&(r.compare=i),r}return i(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var i=this.keySelector;e=i?i(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},e}(f);function fe(t){return void 0===t&&(t=_e),function(e){return e.lift(new me(t))}}var me=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new ge(t,this.errorFactory))},t}(),ge=function(t){function e(e,i){var n=t.call(this,e)||this;return n.errorFactory=i,n.hasValue=!1,n}return i(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(f);function _e(){return new it}function ve(t){return function(e){return 0===t?B():e.lift(new ye(t))}}var ye=function(){function t(t){if(this.total=t,this.total<0)throw new et}return t.prototype.call=function(t,e){return e.subscribe(new be(t,this.total))},t}(),be=function(t){function e(e,i){var n=t.call(this,e)||this;return n.total=i,n.count=0,n}return i(e,t),e.prototype._next=function(t){var e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))},e}(f);function xe(t,e,i){return void 0===e&&(e=Number.POSITIVE_INFINITY),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(n){return n.lift(new we(t,e,i))}}var we=function(){function t(t,e,i){this.project=t,this.concurrent=e,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new Se(t,this.project,this.concurrent,this.scheduler))},t}(),Se=function(t){function e(e,i,n,r){var s=t.call(this,e)||this;return s.project=i,s.concurrent=n,s.scheduler=r,s.index=0,s.active=0,s.hasCompleted=!1,n<Number.POSITIVE_INFINITY&&(s.buffer=[]),s}return i(e,t),e.dispatch=function(t){var e=t.subscriber,i=t.result,n=t.value,r=t.index;e.subscribeToProjection(i,n,r)},e.prototype._next=function(t){var i=this.destination;if(i.closed)this._complete();else{var n=this.index++;if(this.active<this.concurrent){i.next(t);try{var r=(0,this.project)(t,n);if(this.scheduler){var s={subscriber:this,result:r,value:t,index:n};this.destination.add(this.scheduler.schedule(e.dispatch,0,s))}else this.subscribeToProjection(r,t,n)}catch(t){i.error(t)}}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,i){this.active++,this.destination.add(St(t,new xt(this)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this._next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(wt);function Me(t){return function(e){return e.lift(new Te(t))}}var Te=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new Ce(t,this.callback))},t}(),Ce=function(t){function e(e,i){var n=t.call(this,e)||this;return n.add(new u(i)),n}return i(e,t),e}(f);function Ee(t,e){var i=arguments.length>=2;return function(n){return n.pipe(t?Nt((function(e,i){return t(e,i,n)})):_,ve(1),i?ce(e):fe((function(){return new it})))}}function Ie(t){return function(e){return 0===t?B():e.lift(new Ae(t))}}var Ae=function(){function t(t){if(this.total=t,this.total<0)throw new et}return t.prototype.call=function(t,e){return e.subscribe(new Pe(t,this.total))},t}(),Pe=function(t){function e(e,i){var n=t.call(this,e)||this;return n.total=i,n.ring=new Array,n.count=0,n}return i(e,t),e.prototype._next=function(t){var e=this.ring,i=this.total,n=this.count++;e.length<i?e.push(t):e[n%i]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var i=this.count>=this.total?this.total:this.count,n=this.ring,r=0;r<i;r++){var s=e++%i;t.next(n[s])}t.complete()},e}(f);function Re(t,e){var i=arguments.length>=2;return function(n){return n.pipe(t?Nt((function(e,i){return t(e,i,n)})):_,Ie(1),i?ce(e):fe((function(){return new it})))}}function Le(t,e){var i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new Oe(t,e,i))}}var Oe=function(){function t(t,e,i){void 0===i&&(i=!1),this.accumulator=t,this.seed=e,this.hasSeed=i}return t.prototype.call=function(t,e){return e.subscribe(new Ne(t,this.accumulator,this.seed,this.hasSeed))},t}(),Ne=function(t){function e(e,i,n,r){var s=t.call(this,e)||this;return s.accumulator=i,s._seed=n,s.hasSeed=r,s.index=0,s}return i(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,i=this.index++;try{e=this.accumulator(this.seed,t,i)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(f);function De(t,e){return arguments.length>=2?function(i){return v(Le(t,e),Ie(1),ce(e))(i)}:function(e){return v(Le((function(e,i,n){return t(e,i,n+1)})),Ie(1))(e)}}function $e(t,e){return function(i){var n;if(n="function"==typeof t?t:function(){return t},"function"==typeof e)return i.lift(new ke(n,e));var r=Object.create(i,R);return r.source=i,r.subjectFactory=n,r}}var ke=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var i=this.selector,n=this.subjectFactory(),r=i(n).subscribe(t);return r.add(e.subscribe(n)),r},t}();function ze(){return function(t){return t.lift(new Fe)}}var Fe=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Be(t))},t}(),Be=function(t){function e(e){var i=t.call(this,e)||this;return i.hasPrev=!1,i}return i(e,t),e.prototype._next=function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)},e}(f);function je(t,e){return function(i){for(var n=i,r=0;r<e;r++){var s=null!=n?n[t[r]]:void 0;if(void 0===s)return;n=s}return n}}function He(t){return t?$e((function(){return new T}),t):$e(new T)}function Ue(t,e,i,n){i&&"function"!=typeof i&&(n=i);var r="function"==typeof i?i:void 0,s=new J(t,e,n);return function(t){return $e((function(){return s}),r)(t)}}function Ve(t){return void 0===t&&(t=-1),function(e){return e.lift(new Ge(t,e))}}var Ge=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new qe(t,this.count,this.source))},t}(),qe=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.count=i,r.source=n,r}return i(e,t),e.prototype.error=function(e){if(!this.isStopped){var i=this.source,n=this.count;if(0===n)return t.prototype.error.call(this,e);n>-1&&(this.count=n-1),i.subscribe(this._unsubscribeAndRecycle())}},e}(f);var We=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var i=new Xe(t),n=e.subscribe(i);return n.add(St(this.notifier,new xt(i))),n},t}(),Xe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return i(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(wt);function Ye(){return new T}function Ze(){return function(t){return E()($e(Ye)(t))}}function Je(t){return function(e){return e.lift(new Ke(t))}}var Ke=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Qe(t,this.total))},t}(),Qe=function(t){function e(e,i){var n=t.call(this,e)||this;return n.total=i,n.count=0,n}return i(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(f);function ti(t){return function(e){return e.lift(new ei(t))}}var ei=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new ii(t,this.predicate))},t}(),ii=function(t){function e(e,i){var n=t.call(this,e)||this;return n.predicate=i,n.skipping=!0,n.index=0,n}return i(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},e}(f);function ni(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[t.length-1];return j(i)?(t.pop(),function(e){return At(t,e,i)}):function(e){return At(t,e)}}function ri(t,e){return"function"==typeof e?function(i){return i.pipe(ri((function(i,n){return bt(t(i,n)).pipe(rt((function(t,r){return e(i,t,n,r)})))})))}:function(e){return e.lift(new si(t))}}var si=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new oi(t,this.project))},t}(),oi=function(t){function e(e,i){var n=t.call(this,e)||this;return n.project=i,n.index=0,n}return i(e,t),e.prototype._next=function(t){var e,i=this.index++;try{e=this.project(t,i)}catch(t){return void this.destination.error(t)}this._innerSub(e)},e.prototype._innerSub=function(t){var e=this.innerSubscription;e&&e.unsubscribe();var i=new xt(this),n=this.destination;n.add(i),this.innerSubscription=St(t,i),this.innerSubscription!==i&&n.add(this.innerSubscription)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t){this.destination.next(t)},e}(wt);function ai(t){return function(e){return e.lift(new ci(t))}}var ci=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var i=new hi(t),n=St(this.notifier,new xt(i));return n&&!i.seenValue?(i.add(n),e.subscribe(i)):i},t}(),hi=function(t){function e(e){var i=t.call(this,e)||this;return i.seenValue=!1,i}return i(e,t),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(wt);function li(t,e){return void 0===e&&(e=!1),function(i){return i.lift(new ui(t,e))}}var ui=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new di(t,this.predicate,this.inclusive))},t}(),di=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r.predicate=i,r.inclusive=n,r.index=0,r}return i(e,t),e.prototype._next=function(t){var e,i=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void i.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var i=this.destination;Boolean(e)?i.next(t):(this.inclusive&&i.next(t),i.complete())},e}(f);function pi(t,e,i){return function(n){return n.lift(new fi(t,e,i))}}var fi=function(){function t(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}return t.prototype.call=function(t,e){return e.subscribe(new mi(t,this.nextOrObserver,this.error,this.complete))},t}(),mi=function(t){function e(e,i,r,s){var o=t.call(this,e)||this;return o._tapNext=tt,o._tapError=tt,o._tapComplete=tt,o._tapError=r||tt,o._tapComplete=s||tt,n(i)?(o._context=o,o._tapNext=i):i&&(o._context=i,o._tapNext=i.next||tt,o._tapError=i.error||tt,o._tapComplete=i.complete||tt),o}return i(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(f);function gi(t,e,i){return void 0===i&&(i=Q),function(n){var r,s=(r=t)instanceof Date&&!isNaN(+r),o=s?+t-i.now():Math.abs(t);return n.lift(new _i(o,s,e,i))}}var _i=function(){function t(t,e,i,n){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=i,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new vi(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),vi=function(t){function e(e,i,n,r,s){var o=t.call(this,e)||this;return o.absoluteTimeout=i,o.waitFor=n,o.withObservable=r,o.scheduler=s,o.scheduleTimeout(),o}return i(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add(St(e,new xt(t)))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},e}(wt);function yi(t,e){return void 0===e&&(e=Q),gi(t,q(new nt),e)}function bi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var i;"function"==typeof t[t.length-1]&&(i=t.pop());var n=t;return e.lift(new xi(n,i))}}var xi=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new wi(t,this.observables,this.project))},t}(),wi=function(t){function e(e,i,n){var r=t.call(this,e)||this;r.observables=i,r.project=n,r.toRespond=[];var s=i.length;r.values=new Array(s);for(var o=0;o<s;o++)r.toRespond.push(o);for(o=0;o<s;o++){var a=i[o];r.add(ft(r,a,void 0,o))}return r}return i(e,t),e.prototype.notifyNext=function(t,e,i){this.values[i]=e;var n=this.toRespond;if(n.length>0){var r=n.indexOf(i);-1!==r&&n.splice(r,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(at);class Si{createFilter(t){return new Function("node","return "+this._compile(t)+";")}_compile(t){if(null==t||t.length<=1)return"true";const e=t[0];return"("+("=="===e?this._compileComparisonOp("===",t[1],t[2],!1):"!="===e?this._compileComparisonOp("!==",t[1],t[2],!1):">"===e||">="===e||"<"===e||"<="===e?this._compileComparisonOp(e,t[1],t[2],!0):"in"===e?this._compileInOp(t[1],t.slice(2)):"!in"===e?this._compileNegation(this._compileInOp(t[1],t.slice(2))):"all"===e?this._compileLogicalOp(t.slice(1),"&&"):"true")+")"}_compare(t,e){return t<e?-1:t>e?1:0}_compileComparisonOp(t,e,i,n){const r=this._compilePropertyReference(e),s=JSON.stringify(i);return(n?"typeof "+r+"===typeof "+s+"&&":"")+r+t+s}_compileInOp(t,e){const i=this._compare;return JSON.stringify(e.sort(i))+".indexOf("+this._compilePropertyReference(t)+")!==-1"}_compileLogicalOp(t,e){const i=this._compile.bind(this);return t.map(i).join(e)}_compileNegation(t){return"!("+t+")"}_compilePropertyReference(t){return"node["+JSON.stringify(t)+"]"}}const Mi=100,Ti=1e3,Ci=1001,Ei=1002,Ii=1003,Ai=1006,Pi=1008,Ri=1009,Li=1012,Oi=1014,Ni=1015,Di=1016,$i=1020,ki=1022,zi=1023,Fi=1026,Bi=1027,ji=2300,Hi=2301,Ui=2302,Vi=2400,Gi=2401,qi=2402,Wi=2500,Xi=3e3,Yi=7680,Zi=35044,Ji=35048,Ki="300 es";function Qi(){}Object.assign(Qi.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return;const i=this._listeners[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const i=e.slice(0);for(let e=0,n=i.length;e<n;e++)i[e].call(this,t)}}});const tn=[];for(let t=0;t<256;t++)tn[t]=(t<16?"0":"")+t.toString(16);let en=1234567;const nn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(tn[255&t]+tn[t>>8&255]+tn[t>>16&255]+tn[t>>24&255]+"-"+tn[255&e]+tn[e>>8&255]+"-"+tn[e>>16&15|64]+tn[e>>24&255]+"-"+tn[63&i|128]+tn[i>>8&255]+"-"+tn[i>>16&255]+tn[i>>24&255]+tn[255&n]+tn[n>>8&255]+tn[n>>16&255]+tn[n>>24&255]).toUpperCase()},clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},damp:function(t,e,i,n){return nn.lerp(t,e,1-Math.exp(-i*n))},pingpong:function(t,e=1){return e-Math.abs(nn.euclideanModulo(t,2*e)-e)},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(en=t%2147483647),en=16807*en%2147483647,(en-1)/2147483646},degToRad:function(t){return t*nn.DEG2RAD},radToDeg:function(t){return t*nn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,i,n,r){const s=Math.cos,o=Math.sin,a=s(i/2),c=o(i/2),h=s((e+n)/2),l=o((e+n)/2),u=s((e-n)/2),d=o((e-n)/2),p=s((n-e)/2),f=o((n-e)/2);switch(r){case"XYX":t.set(a*l,c*u,c*d,a*h);break;case"YZY":t.set(c*d,a*l,c*u,a*h);break;case"ZXZ":t.set(c*u,c*d,a*l,a*h);break;case"XZX":t.set(a*l,c*f,c*p,a*h);break;case"YXY":t.set(c*p,a*l,c*f,a*h);break;case"ZYZ":t.set(c*f,c*p,a*l,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};class rn{constructor(t=0,e=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*i-s*n+t.x,this.y=r*n+s*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class sn{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,n,r,s,o,a,c){const h=this.elements;return h[0]=t,h[1]=n,h[2]=o,h[3]=e,h[4]=r,h[5]=a,h[6]=i,h[7]=s,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return(new this.constructor).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,s=i[0],o=i[3],a=i[6],c=i[1],h=i[4],l=i[7],u=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],_=n[1],v=n[4],y=n[7],b=n[2],x=n[5],w=n[8];return r[0]=s*f+o*_+a*b,r[3]=s*m+o*v+a*x,r[6]=s*g+o*y+a*w,r[1]=c*f+h*_+l*b,r[4]=c*m+h*v+l*x,r[7]=c*g+h*y+l*w,r[2]=u*f+d*_+p*b,r[5]=u*m+d*v+p*x,r[8]=u*g+d*y+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8];return e*s*h-e*o*c-i*r*h+i*o*a+n*r*c-n*s*a}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8],l=h*s-o*c,u=o*a-h*r,d=c*r-s*a,p=e*l+i*u+n*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=l*f,t[1]=(n*c-h*i)*f,t[2]=(o*i-n*s)*f,t[3]=u*f,t[4]=(h*e-n*a)*f,t[5]=(n*r-o*e)*f,t[6]=d*f,t[7]=(i*a-c*e)*f,t[8]=(s*e-i*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).copy(this).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,r,s,o){const a=Math.cos(r),c=Math.sin(r);return this.set(i*a,i*c,-i*(a*s+c*o)+s+t,-n*c,n*a,-n*(-c*s+a*o)+o+e,0,0,1),this}scale(t,e){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.elements,r=n[0],s=n[3],o=n[6],a=n[1],c=n[4],h=n[7];return n[0]=e*r+i*a,n[3]=e*s+i*c,n[6]=e*o+i*h,n[1]=-i*r+e*a,n[4]=-i*s+e*c,n[7]=-i*o+e*h,this}translate(t,e){const i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<9;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}}let on;const an={getDataURL:function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===on&&(on=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),on.width=t.width,on.height=t.height;const i=on.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=on}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}};let cn=0;function hn(t=hn.DEFAULT_IMAGE,e=hn.DEFAULT_MAPPING,i=1001,n=1001,r=1006,s=1008,o=1023,a=1009,c=1,h=3e3){Object.defineProperty(this,"id",{value:cn++}),this.uuid=nn.generateUUID(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=a,this.offset=new rn(0,0),this.repeat=new rn(1,1),this.center=new rn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new sn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.version=0,this.onUpdate=null}function ln(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?an.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}hn.DEFAULT_IMAGE=void 0,hn.DEFAULT_MAPPING=300,hn.prototype=Object.assign(Object.create(Qi.prototype),{constructor:hn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const n=this.image;if(void 0===n.uuid&&(n.uuid=nn.generateUUID()),!e&&void 0===t.images[n.uuid]){let e;if(Array.isArray(n)){e=[];for(let t=0,i=n.length;t<i;t++)n[t].isDataTexture?e.push(ln(n[t].image)):e.push(ln(n[t]))}else e=ln(n);t.images[n.uuid]={uuid:n.uuid,url:e}}i.image=n.uuid}return e||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ti:t.x=t.x-Math.floor(t.x);break;case Ci:t.x=t.x<0?0:1;break;case Ei:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ti:t.y=t.y-Math.floor(t.y);break;case Ci:t.y=t.y<0?0:1;break;case Ei:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(hn.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});class un{constructor(t=0,e=0,i=0,n=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*e+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*e+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*e+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,r;const s=.01,o=.1,a=t.elements,c=a[0],h=a[4],l=a[8],u=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(h-u)<s&&Math.abs(l-f)<s&&Math.abs(p-m)<s){if(Math.abs(h+u)<o&&Math.abs(l+f)<o&&Math.abs(p+m)<o&&Math.abs(c+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(c+1)/2,a=(d+1)/2,_=(g+1)/2,v=(h+u)/4,y=(l+f)/4,b=(p+m)/4;return t>a&&t>_?t<s?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(t),n=v/i,r=y/i):a>_?a<s?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(a),i=v/n,r=b/n):_<s?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(_),i=y/r,n=b/r),this.set(i,n,r,e),this}let _=Math.sqrt((m-p)*(m-p)+(l-f)*(l-f)+(u-h)*(u-h));return Math.abs(_)<.001&&(_=1),this.x=(m-p)/_,this.y=(l-f)/_,this.z=(u-h)/_,this.w=Math.acos((c+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}class dn extends Qi{constructor(t,e,i){super(),Object.defineProperty(this,"isWebGLRenderTarget",{value:!0}),this.width=t,this.height=e,this.scissor=new un(0,0,t,e),this.scissorTest=!1,this.viewport=new un(0,0,t,e),i=i||{},this.texture=new hn(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Ai,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}setSize(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}class pn{constructor(t=0,e=0,i=0,n=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=e,this._z=i,this._w=n}static slerp(t,e,i,n){return i.copy(t).slerp(e,n)}static slerpFlat(t,e,i,n,r,s,o){let a=i[n+0],c=i[n+1],h=i[n+2],l=i[n+3];const u=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(l!==f||a!==u||c!==d||h!==p){let t=1-o;const e=a*u+c*d+h*p+l*f,i=e>=0?1:-1,n=1-e*e;if(n>Number.EPSILON){const r=Math.sqrt(n),s=Math.atan2(r,e*i);t=Math.sin(t*s)/r,o=Math.sin(o*s)/r}const r=o*i;if(a=a*t+u*r,c=c*t+d*r,h=h*t+p*r,l=l*t+f*r,t===1-o){const t=1/Math.sqrt(a*a+c*c+h*h+l*l);a*=t,c*=t,h*=t,l*=t}}t[e]=a,t[e+1]=c,t[e+2]=h,t[e+3]=l}static multiplyQuaternionsFlat(t,e,i,n,r,s){const o=i[n],a=i[n+1],c=i[n+2],h=i[n+3],l=r[s],u=r[s+1],d=r[s+2],p=r[s+3];return t[e]=o*p+h*l+a*d-c*u,t[e+1]=a*p+h*u+c*l-o*d,t[e+2]=c*p+h*d+o*u-a*l,t[e+3]=h*p-o*l-a*u-c*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=t._x,n=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,c=o(i/2),h=o(n/2),l=o(r/2),u=a(i/2),d=a(n/2),p=a(r/2);switch(s){case"XYZ":this._x=u*h*l+c*d*p,this._y=c*d*l-u*h*p,this._z=c*h*p+u*d*l,this._w=c*h*l-u*d*p;break;case"YXZ":this._x=u*h*l+c*d*p,this._y=c*d*l-u*h*p,this._z=c*h*p-u*d*l,this._w=c*h*l+u*d*p;break;case"ZXY":this._x=u*h*l-c*d*p,this._y=c*d*l+u*h*p,this._z=c*h*p+u*d*l,this._w=c*h*l-u*d*p;break;case"ZYX":this._x=u*h*l-c*d*p,this._y=c*d*l+u*h*p,this._z=c*h*p-u*d*l,this._w=c*h*l+u*d*p;break;case"YZX":this._x=u*h*l+c*d*p,this._y=c*d*l+u*h*p,this._z=c*h*p-u*d*l,this._w=c*h*l-u*d*p;break;case"XZY":this._x=u*h*l-c*d*p,this._y=c*d*l-u*h*p,this._z=c*h*p+u*d*l,this._w=c*h*l+u*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],r=e[8],s=e[1],o=e[5],a=e[9],c=e[2],h=e[6],l=e[10],u=i+o+l;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(h-a)*t,this._y=(r-c)*t,this._z=(s-n)*t}else if(i>o&&i>l){const t=2*Math.sqrt(1+i-o-l);this._w=(h-a)/t,this._x=.25*t,this._y=(n+s)/t,this._z=(r+c)/t}else if(o>l){const t=2*Math.sqrt(1+o-i-l);this._w=(r-c)/t,this._x=(n+s)/t,this._y=.25*t,this._z=(a+h)/t}else{const t=2*Math.sqrt(1+l-i-o);this._w=(s-n)/t,this._x=(r+c)/t,this._y=(a+h)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(nn.clamp(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(0===i)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,r=t._z,s=t._w,o=e._x,a=e._y,c=e._z,h=e._w;return this._x=i*h+s*o+n*c-r*a,this._y=n*h+s*a+r*o-i*c,this._z=r*h+s*c+i*a-n*o,this._w=s*h-i*o-n*a-r*c,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const i=this._x,n=this._y,r=this._z,s=this._w;let o=s*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*i+e*this._x,this._y=t*n+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(a),h=Math.atan2(c,o),l=Math.sin((1-e)*h)/c,u=Math.sin(e*h)/c;return this._w=s*l+this._w*u,this._x=i*l+this._x*u,this._y=n*l+this._y*u,this._z=r*l+this._z*u,this._onChangeCallback(),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}class fn{constructor(t=0,e=0,i=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=e,this.z=i}set(t,e,i){return void 0===i&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(gn.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(gn.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,r=t.elements,s=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,r=t.x,s=t.y,o=t.z,a=t.w,c=a*e+s*n-o*i,h=a*i+o*e-r*n,l=a*n+r*i-s*e,u=-r*e-s*i-o*n;return this.x=c*a+u*-r+h*-o-l*-s,this.y=h*a+u*-s+l*-r-c*-o,this.z=l*a+u*-o+c*-s-h*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=n*a-r*o,this.y=r*s-i*a,this.z=i*o-n*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return mn.copy(this).projectOnVector(t),this.sub(mn)}reflect(t){return this.sub(mn.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(nn.clamp(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const mn=new fn,gn=new pn;class _n{constructor(t,e){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==t?t:new fn(1/0,1/0,1/0),this.max=void 0!==e?e:new fn(-1/0,-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,c=t.length;a<c;a+=3){const c=t[a],h=t[a+1],l=t[a+2];c<e&&(e=c),h<i&&(i=h),l<n&&(n=l),c>r&&(r=c),h>s&&(s=h),l>o&&(o=l)}return this.min.set(e,i,n),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,c=t.count;a<c;a++){const c=t.getX(a),h=t.getY(a),l=t.getZ(a);c<e&&(e=c),h<i&&(i=h),l<n&&(n=l),c>r&&(r=c),h>s&&(s=h),l>o&&(o=l)}return this.min.set(e,i,n),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=bn.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new fn),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new fn),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),xn.copy(e.boundingBox),xn.applyMatrix4(t.matrixWorld),this.union(xn));const i=t.children;for(let t=0,e=i.length;t<e;t++)this.expandByObject(i[t]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new fn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,bn),bn.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(In),An.subVectors(this.max,In),wn.subVectors(t.a,In),Sn.subVectors(t.b,In),Mn.subVectors(t.c,In),Tn.subVectors(Sn,wn),Cn.subVectors(Mn,Sn),En.subVectors(wn,Mn);let e=[0,-Tn.z,Tn.y,0,-Cn.z,Cn.y,0,-En.z,En.y,Tn.z,0,-Tn.x,Cn.z,0,-Cn.x,En.z,0,-En.x,-Tn.y,Tn.x,0,-Cn.y,Cn.x,0,-En.y,En.x,0];return!!vn(e,wn,Sn,Mn,An)&&(e=[1,0,0,0,1,0,0,0,1],!!vn(e,wn,Sn,Mn,An)&&(Pn.crossVectors(Tn,Cn),e=[Pn.x,Pn.y,Pn.z],vn(e,wn,Sn,Mn,An)))}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new fn),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return bn.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(bn).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(yn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),yn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),yn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),yn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),yn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),yn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),yn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),yn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(yn)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}function vn(t,e,i,n,r){for(let s=0,o=t.length-3;s<=o;s+=3){Rn.fromArray(t,s);const o=r.x*Math.abs(Rn.x)+r.y*Math.abs(Rn.y)+r.z*Math.abs(Rn.z),a=e.dot(Rn),c=i.dot(Rn),h=n.dot(Rn);if(Math.max(-Math.max(a,c,h),Math.min(a,c,h))>o)return!1}return!0}const yn=[new fn,new fn,new fn,new fn,new fn,new fn,new fn,new fn],bn=new fn,xn=new _n,wn=new fn,Sn=new fn,Mn=new fn,Tn=new fn,Cn=new fn,En=new fn,In=new fn,An=new fn,Pn=new fn,Rn=new fn,Ln=new _n;class On{constructor(t,e){this.center=void 0!==t?t:new fn,this.radius=void 0!==e?e:-1}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const i=this.center;void 0!==e?i.copy(e):Ln.setFromPoints(t).getCenter(i);let n=0;for(let e=0,r=t.length;e<r;e++)n=Math.max(n,i.distanceToSquared(t[e]));return this.radius=Math.sqrt(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const i=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new fn),e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new _n),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}}const Nn=new fn,Dn=new fn,$n=new fn,kn=new fn,zn=new fn,Fn=new fn,Bn=new fn;class jn{constructor(t,e){this.origin=void 0!==t?t:new fn,this.direction=void 0!==e?e:new fn(0,0,-1)}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new fn),e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Nn)),this}closestPointToPoint(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new fn),e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Nn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Nn.copy(this.direction).multiplyScalar(e).add(this.origin),Nn.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){Dn.copy(t).add(e).multiplyScalar(.5),$n.copy(e).sub(t).normalize(),kn.copy(this.origin).sub(Dn);const r=.5*t.distanceTo(e),s=-this.direction.dot($n),o=kn.dot(this.direction),a=-kn.dot($n),c=kn.lengthSq(),h=Math.abs(1-s*s);let l,u,d,p;if(h>0)if(l=s*a-o,u=s*o-a,p=r*h,l>=0)if(u>=-p)if(u<=p){const t=1/h;l*=t,u*=t,d=l*(l+s*u+2*o)+u*(s*l+u+2*a)+c}else u=r,l=Math.max(0,-(s*u+o)),d=-l*l+u*(u+2*a)+c;else u=-r,l=Math.max(0,-(s*u+o)),d=-l*l+u*(u+2*a)+c;else u<=-p?(l=Math.max(0,-(-s*r+o)),u=l>0?-r:Math.min(Math.max(-r,-a),r),d=-l*l+u*(u+2*a)+c):u<=p?(l=0,u=Math.min(Math.max(-r,-a),r),d=u*(u+2*a)+c):(l=Math.max(0,-(s*r+o)),u=l>0?r:Math.min(Math.max(-r,-a),r),d=-l*l+u*(u+2*a)+c);else u=s>0?-r:r,l=Math.max(0,-(s*u+o)),d=-l*l+u*(u+2*a)+c;return i&&i.copy(this.direction).multiplyScalar(l).add(this.origin),n&&n.copy($n).multiplyScalar(u).add(Dn),d}intersectSphere(t,e){Nn.subVectors(t.center,this.origin);const i=Nn.dot(this.direction),n=Nn.dot(Nn)-i*i,r=t.radius*t.radius;if(n>r)return null;const s=Math.sqrt(r-n),o=i-s,a=i+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return null===i?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,r,s,o,a;const c=1/this.direction.x,h=1/this.direction.y,l=1/this.direction.z,u=this.origin;return c>=0?(i=(t.min.x-u.x)*c,n=(t.max.x-u.x)*c):(i=(t.max.x-u.x)*c,n=(t.min.x-u.x)*c),h>=0?(r=(t.min.y-u.y)*h,s=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,s=(t.min.y-u.y)*h),i>s||r>n?null:((r>i||i!=i)&&(i=r),(s<n||n!=n)&&(n=s),l>=0?(o=(t.min.z-u.z)*l,a=(t.max.z-u.z)*l):(o=(t.max.z-u.z)*l,a=(t.min.z-u.z)*l),i>a||o>n?null:((o>i||i!=i)&&(i=o),(a<n||n!=n)&&(n=a),n<0?null:this.at(i>=0?i:n,e)))}intersectsBox(t){return null!==this.intersectBox(t,Nn)}intersectTriangle(t,e,i,n,r){zn.subVectors(e,t),Fn.subVectors(i,t),Bn.crossVectors(zn,Fn);let s,o=this.direction.dot(Bn);if(o>0){if(n)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}kn.subVectors(this.origin,t);const a=s*this.direction.dot(Fn.crossVectors(kn,Fn));if(a<0)return null;const c=s*this.direction.dot(zn.cross(kn));if(c<0)return null;if(a+c>o)return null;const h=-s*kn.dot(Bn);return h<0?null:this.at(h/o,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}class Hn{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,i,n,r,s,o,a,c,h,l,u,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=s,g[9]=o,g[13]=a,g[2]=c,g[6]=h,g[10]=l,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Hn).fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/Un.setFromMatrixColumn(t,0).length(),r=1/Un.setFromMatrixColumn(t,1).length(),s=1/Un.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*r,e[5]=i[5]*r,e[6]=i[6]*r,e[7]=0,e[8]=i[8]*s,e[9]=i[9]*s,e[10]=i[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,i=t.x,n=t.y,r=t.z,s=Math.cos(i),o=Math.sin(i),a=Math.cos(n),c=Math.sin(n),h=Math.cos(r),l=Math.sin(r);if("XYZ"===t.order){const t=s*h,i=s*l,n=o*h,r=o*l;e[0]=a*h,e[4]=-a*l,e[8]=c,e[1]=i+n*c,e[5]=t-r*c,e[9]=-o*a,e[2]=r-t*c,e[6]=n+i*c,e[10]=s*a}else if("YXZ"===t.order){const t=a*h,i=a*l,n=c*h,r=c*l;e[0]=t+r*o,e[4]=n*o-i,e[8]=s*c,e[1]=s*l,e[5]=s*h,e[9]=-o,e[2]=i*o-n,e[6]=r+t*o,e[10]=s*a}else if("ZXY"===t.order){const t=a*h,i=a*l,n=c*h,r=c*l;e[0]=t-r*o,e[4]=-s*l,e[8]=n+i*o,e[1]=i+n*o,e[5]=s*h,e[9]=r-t*o,e[2]=-s*c,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){const t=s*h,i=s*l,n=o*h,r=o*l;e[0]=a*h,e[4]=n*c-i,e[8]=t*c+r,e[1]=a*l,e[5]=r*c+t,e[9]=i*c-n,e[2]=-c,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){const t=s*a,i=s*c,n=o*a,r=o*c;e[0]=a*h,e[4]=r-t*l,e[8]=n*l+i,e[1]=l,e[5]=s*h,e[9]=-o*h,e[2]=-c*h,e[6]=i*l+n,e[10]=t-r*l}else if("XZY"===t.order){const t=s*a,i=s*c,n=o*a,r=o*c;e[0]=a*h,e[4]=-l,e[8]=c*h,e[1]=t*l+r,e[5]=s*h,e[9]=i*l-n,e[2]=n*l-i,e[6]=o*h,e[10]=r*l+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Gn,t,qn)}lookAt(t,e,i){const n=this.elements;return Yn.subVectors(t,e),0===Yn.lengthSq()&&(Yn.z=1),Yn.normalize(),Wn.crossVectors(i,Yn),0===Wn.lengthSq()&&(1===Math.abs(i.z)?Yn.x+=1e-4:Yn.z+=1e-4,Yn.normalize(),Wn.crossVectors(i,Yn)),Wn.normalize(),Xn.crossVectors(Yn,Wn),n[0]=Wn.x,n[4]=Xn.x,n[8]=Yn.x,n[1]=Wn.y,n[5]=Xn.y,n[9]=Yn.y,n[2]=Wn.z,n[6]=Xn.z,n[10]=Yn.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,r=this.elements,s=i[0],o=i[4],a=i[8],c=i[12],h=i[1],l=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],_=i[3],v=i[7],y=i[11],b=i[15],x=n[0],w=n[4],S=n[8],M=n[12],T=n[1],C=n[5],E=n[9],I=n[13],A=n[2],P=n[6],R=n[10],L=n[14],O=n[3],N=n[7],D=n[11],$=n[15];return r[0]=s*x+o*T+a*A+c*O,r[4]=s*w+o*C+a*P+c*N,r[8]=s*S+o*E+a*R+c*D,r[12]=s*M+o*I+a*L+c*$,r[1]=h*x+l*T+u*A+d*O,r[5]=h*w+l*C+u*P+d*N,r[9]=h*S+l*E+u*R+d*D,r[13]=h*M+l*I+u*L+d*$,r[2]=p*x+f*T+m*A+g*O,r[6]=p*w+f*C+m*P+g*N,r[10]=p*S+f*E+m*R+g*D,r[14]=p*M+f*I+m*L+g*$,r[3]=_*x+v*T+y*A+b*O,r[7]=_*w+v*C+y*P+b*N,r[11]=_*S+v*E+y*R+b*D,r[15]=_*M+v*I+y*L+b*$,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],s=t[1],o=t[5],a=t[9],c=t[13],h=t[2],l=t[6],u=t[10],d=t[14];return t[3]*(+r*a*l-n*c*l-r*o*u+i*c*u+n*o*d-i*a*d)+t[7]*(+e*a*d-e*c*u+r*s*u-n*s*d+n*c*h-r*a*h)+t[11]*(+e*c*l-e*o*d-r*s*l+i*s*d+r*o*h-i*c*h)+t[15]*(-n*o*h-e*a*l+e*o*u+n*s*l-i*s*u+i*a*h)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8],l=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],_=l*m*c-f*u*c+f*a*d-o*m*d-l*a*g+o*u*g,v=p*u*c-h*m*c-p*a*d+s*m*d+h*a*g-s*u*g,y=h*f*c-p*l*c+p*o*d-s*f*d-h*o*g+s*l*g,b=p*l*a-h*f*a-p*o*u+s*f*u+h*o*m-s*l*m,x=e*_+i*v+n*y+r*b;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return t[0]=_*w,t[1]=(f*u*r-l*m*r-f*n*d+i*m*d+l*n*g-i*u*g)*w,t[2]=(o*m*r-f*a*r+f*n*c-i*m*c-o*n*g+i*a*g)*w,t[3]=(l*a*r-o*u*r-l*n*c+i*u*c+o*n*d-i*a*d)*w,t[4]=v*w,t[5]=(h*m*r-p*u*r+p*n*d-e*m*d-h*n*g+e*u*g)*w,t[6]=(p*a*r-s*m*r-p*n*c+e*m*c+s*n*g-e*a*g)*w,t[7]=(s*u*r-h*a*r+h*n*c-e*u*c-s*n*d+e*a*d)*w,t[8]=y*w,t[9]=(p*l*r-h*f*r-p*i*d+e*f*d+h*i*g-e*l*g)*w,t[10]=(s*f*r-p*o*r+p*i*c-e*f*c-s*i*g+e*o*g)*w,t[11]=(h*o*r-s*l*r-h*i*c+e*l*c+s*i*d-e*o*d)*w,t[12]=b*w,t[13]=(h*f*n-p*l*n+p*i*u-e*f*u-h*i*m+e*l*m)*w,t[14]=(p*o*n-s*f*n-p*i*a+e*f*a+s*i*m-e*o*m)*w,t[15]=(s*l*n-h*o*n+h*i*a-e*l*a-s*i*u+e*o*u)*w,this}scale(t){const e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),r=1-i,s=t.x,o=t.y,a=t.z,c=r*s,h=r*o;return this.set(c*s+i,c*o-n*a,c*a+n*o,0,c*o+n*a,h*o+i,h*a-n*s,0,c*a-n*o,h*a+n*s,r*a*a+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,r=e._x,s=e._y,o=e._z,a=e._w,c=r+r,h=s+s,l=o+o,u=r*c,d=r*h,p=r*l,f=s*h,m=s*l,g=o*l,_=a*c,v=a*h,y=a*l,b=i.x,x=i.y,w=i.z;return n[0]=(1-(f+g))*b,n[1]=(d+y)*b,n[2]=(p-v)*b,n[3]=0,n[4]=(d-y)*x,n[5]=(1-(u+g))*x,n[6]=(m+_)*x,n[7]=0,n[8]=(p+v)*w,n[9]=(m-_)*w,n[10]=(1-(u+f))*w,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let r=Un.set(n[0],n[1],n[2]).length();const s=Un.set(n[4],n[5],n[6]).length(),o=Un.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],Vn.copy(this);const a=1/r,c=1/s,h=1/o;return Vn.elements[0]*=a,Vn.elements[1]*=a,Vn.elements[2]*=a,Vn.elements[4]*=c,Vn.elements[5]*=c,Vn.elements[6]*=c,Vn.elements[8]*=h,Vn.elements[9]*=h,Vn.elements[10]*=h,e.setFromRotationMatrix(Vn),i.x=r,i.y=s,i.z=o,this}makePerspective(t,e,i,n,r,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*r/(e-t),c=2*r/(i-n),h=(e+t)/(e-t),l=(i+n)/(i-n),u=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=c,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,i,n,r,s){const o=this.elements,a=1/(e-t),c=1/(i-n),h=1/(s-r),l=(e+t)*a,u=(i+n)*c,d=(s+r)*h;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let t=0;t<16;t++)if(e[t]!==i[t])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}const Un=new fn,Vn=new Hn,Gn=new fn(0,0,0),qn=new fn(1,1,1),Wn=new fn,Xn=new fn,Yn=new fn;class Zn{constructor(t=0,e=0,i=0,n=Zn.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e,i){const n=nn.clamp,r=t.elements,s=r[0],o=r[4],a=r[8],c=r[1],h=r[5],l=r[9],u=r[2],d=r[6],p=r[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,h),this._z=0);break;case"YXZ":this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,p),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,p));break;case"XZY":this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-l,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==i&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return Jn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Jn,e,i)}setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order)}reorder(t){return Kn.setFromEuler(this),this.setFromQuaternion(Kn,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new fn(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Zn.DefaultOrder="XYZ",Zn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const Jn=new Hn,Kn=new pn;class Qn{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}let tr=0;const er=new fn,ir=new pn,nr=new Hn,rr=new fn,sr=new fn,or=new fn,ar=new pn,cr=new fn(1,0,0),hr=new fn(0,1,0),lr=new fn(0,0,1),ur={type:"added"},dr={type:"removed"};function pr(){Object.defineProperty(this,"id",{value:tr++}),this.uuid=nn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pr.DefaultUp.clone();const t=new fn,e=new Zn,i=new pn,n=new fn(1,1,1);e._onChange((function(){i.setFromEuler(e,!1)})),i._onChange((function(){e.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Hn},normalMatrix:{value:new sn}}),this.matrix=new Hn,this.matrixWorld=new Hn,this.matrixAutoUpdate=pr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Qn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}pr.DefaultUp=new fn(0,1,0),pr.DefaultMatrixAutoUpdate=!0,pr.prototype=Object.assign(Object.create(Qi.prototype),{constructor:pr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return ir.setFromAxisAngle(t,e),this.quaternion.multiply(ir),this},rotateOnWorldAxis:function(t,e){return ir.setFromAxisAngle(t,e),this.quaternion.premultiply(ir),this},rotateX:function(t){return this.rotateOnAxis(cr,t)},rotateY:function(t){return this.rotateOnAxis(hr,t)},rotateZ:function(t){return this.rotateOnAxis(lr,t)},translateOnAxis:function(t,e){return er.copy(t).applyQuaternion(this.quaternion),this.position.add(er.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(cr,t)},translateY:function(t){return this.translateOnAxis(hr,t)},translateZ:function(t){return this.translateOnAxis(lr,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(nr.copy(this.matrixWorld).invert())},lookAt:function(t,e,i){t.isVector3?rr.copy(t):rr.set(t,e,i);const n=this.parent;this.updateWorldMatrix(!0,!1),sr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?nr.lookAt(sr,rr,this.up):nr.lookAt(rr,sr,this.up),this.quaternion.setFromRotationMatrix(nr),n&&(nr.extractRotation(n.matrixWorld),ir.setFromRotationMatrix(nr),this.quaternion.premultiply(ir.invert()))},add:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ur)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(dr)),this},clear:function(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(dr)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),nr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),nr.multiply(t.parent.matrixWorld)),t.applyMatrix4(nr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){const n=this.children[i].getObjectByProperty(t,e);if(void 0!==n)return n}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new fn),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new pn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sr,t,or),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new fn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sr,ar,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new fn),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)},traverseAncestors:function(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){const i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,i=t.length;e<i;e++)t[e].updateWorldMatrix(!1,!0)}},toJSON:function(t){const e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};function r(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){n.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const i=e.shapes;if(Array.isArray(i))for(let e=0,n=i.length;e<n;e++){const n=i[e];r(t.shapes,n)}else r(t.shapes,i)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let i=0,n=this.material.length;i<n;i++)e.push(r(t.materials,this.material[i]));n.material=e}else n.material=r(t.materials,this.material);if(this.children.length>0){n.children=[];for(let e=0;e<this.children.length;e++)n.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let e=0;e<this.animations.length;e++){const i=this.animations[e];n.animations.push(r(t.animations,i))}}if(e){const e=s(t.geometries),n=s(t.materials),r=s(t.textures),o=s(t.images),a=s(t.shapes),c=s(t.skeletons),h=s(t.animations);e.length>0&&(i.geometries=e),n.length>0&&(i.materials=n),r.length>0&&(i.textures=r),o.length>0&&(i.images=o),a.length>0&&(i.shapes=a),c.length>0&&(i.skeletons=c),h.length>0&&(i.animations=h)}return i.object=n,i;function s(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const i=t.children[e];this.add(i.clone())}return this}});const fr=new fn,mr=new fn,gr=new sn;class _r{constructor(t,e){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==t?t:new fn(1,0,0),this.constant=void 0!==e?e:0}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){const n=fr.subVectors(i,e).cross(mr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new fn),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new fn);const i=t.delta(fr),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(t.start)?e.copy(t.start):void 0;const r=-(t.start.dot(this.normal)+this.constant)/n;return r<0||r>1?void 0:e.copy(i).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new fn),t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const i=e||gr.getNormalMatrix(t),n=this.coplanarPoint(fr).applyMatrix4(t),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}const vr=new fn,yr=new fn,br=new fn,xr=new fn,wr=new fn,Sr=new fn,Mr=new fn,Tr=new fn,Cr=new fn,Er=new fn;class Ir{constructor(t,e,i){this.a=void 0!==t?t:new fn,this.b=void 0!==e?e:new fn,this.c=void 0!==i?i:new fn}static getNormal(t,e,i,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new fn),n.subVectors(i,e),vr.subVectors(t,e),n.cross(vr);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(t,e,i,n,r){vr.subVectors(n,e),yr.subVectors(i,e),br.subVectors(t,e);const s=vr.dot(vr),o=vr.dot(yr),a=vr.dot(br),c=yr.dot(yr),h=yr.dot(br),l=s*c-o*o;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new fn),0===l)return r.set(-2,-1,-1);const u=1/l,d=(c*a-o*h)*u,p=(s*h-o*a)*u;return r.set(1-d-p,p,d)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,xr),xr.x>=0&&xr.y>=0&&xr.x+xr.y<=1}static getUV(t,e,i,n,r,s,o,a){return this.getBarycoord(t,e,i,n,xr),a.set(0,0),a.addScaledVector(r,xr.x),a.addScaledVector(s,xr.y),a.addScaledVector(o,xr.z),a}static isFrontFacing(t,e,i,n){return vr.subVectors(i,e),yr.subVectors(t,e),vr.cross(yr).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return vr.subVectors(this.c,this.b),yr.subVectors(this.a,this.b),.5*vr.cross(yr).length()}getMidpoint(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new fn),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ir.getNormal(this.a,this.b,this.c,t)}getPlane(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new _r),t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Ir.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,i,n,r){return Ir.getUV(t,this.a,this.b,this.c,e,i,n,r)}containsPoint(t){return Ir.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ir.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new fn);const i=this.a,n=this.b,r=this.c;let s,o;wr.subVectors(n,i),Sr.subVectors(r,i),Tr.subVectors(t,i);const a=wr.dot(Tr),c=Sr.dot(Tr);if(a<=0&&c<=0)return e.copy(i);Cr.subVectors(t,n);const h=wr.dot(Cr),l=Sr.dot(Cr);if(h>=0&&l<=h)return e.copy(n);const u=a*l-h*c;if(u<=0&&a>=0&&h<=0)return s=a/(a-h),e.copy(i).addScaledVector(wr,s);Er.subVectors(t,r);const d=wr.dot(Er),p=Sr.dot(Er);if(p>=0&&d<=p)return e.copy(r);const f=d*c-a*p;if(f<=0&&c>=0&&p<=0)return o=c/(c-p),e.copy(i).addScaledVector(Sr,o);const m=h*p-d*l;if(m<=0&&l-h>=0&&d-p>=0)return Mr.subVectors(r,n),o=(l-h)/(l-h+(d-p)),e.copy(n).addScaledVector(Mr,o);const g=1/(m+f+u);return s=f*g,o=u*g,e.copy(i).addScaledVector(wr,s).addScaledVector(Sr,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const Ar={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Pr={h:0,s:0,l:0},Rr={h:0,s:0,l:0};function Lr(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}function Or(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Nr(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class Dr{constructor(t,e,i){return Object.defineProperty(this,"isColor",{value:!0}),void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,i){return this.r=t,this.g=e,this.b=i,this}setHSL(t,e,i){if(t=nn.euclideanModulo(t,1),e=nn.clamp(e,0,1),i=nn.clamp(i,0,1),0===e)this.r=this.g=this.b=i;else{const n=i<=.5?i*(1+e):i+e-i*e,r=2*i-n;this.r=Lr(r,n,t+1/3),this.g=Lr(r,n,t),this.b=Lr(r,n,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const n=i[1],r=i[2];switch(n){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const i=parseFloat(t[1])/360,n=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(i,n,r)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=Ar[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=Or(t.r),this.g=Or(t.g),this.b=Or(t.b),this}copyLinearToSRGB(t){return this.r=Nr(t.r),this.g=Nr(t.g),this.b=Nr(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const e=this.r,i=this.g,n=this.b,r=Math.max(e,i,n),s=Math.min(e,i,n);let o,a;const c=(s+r)/2;if(s===r)o=0,a=0;else{const t=r-s;switch(a=c<=.5?t/(r+s):t/(2-r-s),r){case e:o=(i-n)/t+(i<n?6:0);break;case i:o=(n-e)/t+2;break;case n:o=(e-i)/t+4}o/=6}return t.h=o,t.s=a,t.l=c,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,i){return this.getHSL(Pr),Pr.h+=t,Pr.s+=e,Pr.l+=i,this.setHSL(Pr.h,Pr.s,Pr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(Pr),t.getHSL(Rr);const i=nn.lerp(Pr.h,Rr.h,e),n=nn.lerp(Pr.s,Rr.s,e),r=nn.lerp(Pr.l,Rr.l,e);return this.setHSL(i,n,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Dr.NAMES=Ar,Dr.prototype.r=1,Dr.prototype.g=1,Dr.prototype.b=1;class $r{constructor(t,e,i,n,r,s=0){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new fn,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new Dr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return(new this.constructor).copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}let kr=0;function zr(){Object.defineProperty(this,"id",{value:kr++}),this.uuid=nn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Mi,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Yi,this.stencilZFail=Yi,this.stencilZPass=Yi,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Fr(t){zr.call(this),this.type="MeshBasicMaterial",this.color=new Dr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}zr.prototype=Object.assign(Object.create(Qi.prototype),{constructor:zr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const e in t){const i=t[e];if(void 0===i){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}},toJSON:function(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){const e=[];for(const i in t){const n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.morphNormals&&(i.morphNormals=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e){const e=n(t.textures),r=n(t.images);e.length>0&&(i.textures=e),r.length>0&&(i.images=r)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let i=null;if(null!==e){const t=e.length;i=new Array(t);for(let n=0;n!==t;++n)i[n]=e[n].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(zr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Fr.prototype=Object.create(zr.prototype),Fr.prototype.constructor=Fr,Fr.prototype.isMeshBasicMaterial=!0,Fr.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const Br=new fn,jr=new rn;function Hr(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.usage=Zi,this.updateRange={offset:0,count:-1},this.version=0}function Ur(t,e,i){Hr.call(this,new Int8Array(t),e,i)}function Vr(t,e,i){Hr.call(this,new Uint8Array(t),e,i)}function Gr(t,e,i){Hr.call(this,new Uint8ClampedArray(t),e,i)}function qr(t,e,i){Hr.call(this,new Int16Array(t),e,i)}function Wr(t,e,i){Hr.call(this,new Uint16Array(t),e,i)}function Xr(t,e,i){Hr.call(this,new Int32Array(t),e,i)}function Yr(t,e,i){Hr.call(this,new Uint32Array(t),e,i)}function Zr(t,e,i){Hr.call(this,new Uint16Array(t),e,i)}function Jr(t,e,i){Hr.call(this,new Float32Array(t),e,i)}function Kr(t,e,i){Hr.call(this,new Float64Array(t),e,i)}function Qr(t){if(0===t.length)return-1/0;let e=t[0];for(let i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e}Object.defineProperty(Hr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Hr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),r=new Dr),e[i++]=r.r,e[i++]=r.g,e[i++]=r.b}return this},copyVector2sArray:function(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),r=new rn),e[i++]=r.x,e[i++]=r.y}return this},copyVector3sArray:function(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),r=new fn),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z}return this},copyVector4sArray:function(t){const e=this.array;let i=0;for(let n=0,r=t.length;n<r;n++){let r=t[n];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),r=new un),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z,e[i++]=r.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let e=0,i=this.count;e<i;e++)jr.fromBufferAttribute(this,e),jr.applyMatrix3(t),this.setXY(e,jr.x,jr.y);else if(3===this.itemSize)for(let e=0,i=this.count;e<i;e++)Br.fromBufferAttribute(this,e),Br.applyMatrix3(t),this.setXYZ(e,Br.x,Br.y,Br.z);return this},applyMatrix4:function(t){for(let e=0,i=this.count;e<i;e++)Br.x=this.getX(e),Br.y=this.getY(e),Br.z=this.getZ(e),Br.applyMatrix4(t),this.setXYZ(e,Br.x,Br.y,Br.z);return this},applyNormalMatrix:function(t){for(let e=0,i=this.count;e<i;e++)Br.x=this.getX(e),Br.y=this.getY(e),Br.z=this.getZ(e),Br.applyNormalMatrix(t),this.setXYZ(e,Br.x,Br.y,Br.z);return this},transformDirection:function(t){for(let e=0,i=this.count;e<i;e++)Br.x=this.getX(e),Br.y=this.getY(e),Br.z=this.getZ(e),Br.transformDirection(t),this.setXYZ(e,Br.x,Br.y,Br.z);return this},set:function(t,e=0){return this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Ur.prototype=Object.create(Hr.prototype),Ur.prototype.constructor=Ur,Vr.prototype=Object.create(Hr.prototype),Vr.prototype.constructor=Vr,Gr.prototype=Object.create(Hr.prototype),Gr.prototype.constructor=Gr,qr.prototype=Object.create(Hr.prototype),qr.prototype.constructor=qr,Wr.prototype=Object.create(Hr.prototype),Wr.prototype.constructor=Wr,Xr.prototype=Object.create(Hr.prototype),Xr.prototype.constructor=Xr,Yr.prototype=Object.create(Hr.prototype),Yr.prototype.constructor=Yr,Zr.prototype=Object.create(Hr.prototype),Zr.prototype.constructor=Zr,Zr.prototype.isFloat16BufferAttribute=!0,Jr.prototype=Object.create(Hr.prototype),Jr.prototype.constructor=Jr,Kr.prototype=Object.create(Hr.prototype),Kr.prototype.constructor=Kr;const ts={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function es(t,e){return new ts[t](e)}let is=0;const ns=new Hn,rs=new pr,ss=new fn,os=new _n,as=new _n,cs=new fn;function hs(){Object.defineProperty(this,"id",{value:is++}),this.uuid=nn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}hs.prototype=Object.assign(Object.create(Qi.prototype),{constructor:hs,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(Qr(t)>65535?Yr:Wr)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const e=(new sn).getNormalMatrix(t);i.applyNormalMatrix(e),i.needsUpdate=!0}const n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return ns.makeRotationX(t),this.applyMatrix4(ns),this},rotateY:function(t){return ns.makeRotationY(t),this.applyMatrix4(ns),this},rotateZ:function(t){return ns.makeRotationZ(t),this.applyMatrix4(ns),this},translate:function(t,e,i){return ns.makeTranslation(t,e,i),this.applyMatrix4(ns),this},scale:function(t,e,i){return ns.makeScale(t,e,i),this.applyMatrix4(ns),this},lookAt:function(t){return rs.lookAt(t),rs.updateMatrix(),this.applyMatrix4(rs.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ss).negate(),this.translate(ss.x,ss.y,ss.z),this},setFromPoints:function(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i];e.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Jr(e,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new _n);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new fn(-1/0,-1/0,-1/0),new fn(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];os.setFromBufferAttribute(i),this.morphTargetsRelative?(cs.addVectors(this.boundingBox.min,os.min),this.boundingBox.expandByPoint(cs),cs.addVectors(this.boundingBox.max,os.max),this.boundingBox.expandByPoint(cs)):(this.boundingBox.expandByPoint(os.min),this.boundingBox.expandByPoint(os.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new On);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new fn,1/0);if(t){const i=this.boundingSphere.center;if(os.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const i=e[t];as.setFromBufferAttribute(i),this.morphTargetsRelative?(cs.addVectors(os.min,as.min),os.expandByPoint(cs),cs.addVectors(os.max,as.max),os.expandByPoint(cs)):(os.expandByPoint(as.min),os.expandByPoint(as.max))}os.getCenter(i);let n=0;for(let e=0,r=t.count;e<r;e++)cs.fromBufferAttribute(t,e),n=Math.max(n,i.distanceToSquared(cs));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],o=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)cs.fromBufferAttribute(s,e),o&&(ss.fromBufferAttribute(t,e),cs.add(ss)),n=Math.max(n,i.distanceToSquared(cs))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.array,n=e.position.array,r=e.normal.array,s=e.uv.array,o=n.length/3;void 0===e.tangent&&this.setAttribute("tangent",new Hr(new Float32Array(4*o),4));const a=e.tangent.array,c=[],h=[];for(let t=0;t<o;t++)c[t]=new fn,h[t]=new fn;const l=new fn,u=new fn,d=new fn,p=new rn,f=new rn,m=new rn,g=new fn,_=new fn;function v(t,e,i){l.fromArray(n,3*t),u.fromArray(n,3*e),d.fromArray(n,3*i),p.fromArray(s,2*t),f.fromArray(s,2*e),m.fromArray(s,2*i),u.sub(l),d.sub(l),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(u).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),_.copy(d).multiplyScalar(f.x).addScaledVector(u,-m.x).multiplyScalar(r),c[t].add(g),c[e].add(g),c[i].add(g),h[t].add(_),h[e].add(_),h[i].add(_))}let y=this.groups;0===y.length&&(y=[{start:0,count:i.length}]);for(let t=0,e=y.length;t<e;++t){const e=y[t],n=e.start;for(let t=n,r=n+e.count;t<r;t+=3)v(i[t+0],i[t+1],i[t+2])}const b=new fn,x=new fn,w=new fn,S=new fn;function M(t){w.fromArray(r,3*t),S.copy(w);const e=c[t];b.copy(e),b.sub(w.multiplyScalar(w.dot(e))).normalize(),x.crossVectors(S,e);const i=x.dot(h[t])<0?-1:1;a[4*t]=b.x,a[4*t+1]=b.y,a[4*t+2]=b.z,a[4*t+3]=i}for(let t=0,e=y.length;t<e;++t){const e=y[t],n=e.start;for(let t=n,r=n+e.count;t<r;t+=3)M(i[t+0]),M(i[t+1]),M(i[t+2])}},computeVertexNormals:function(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let i=this.getAttribute("normal");if(void 0===i)i=new Hr(new Float32Array(3*e.count),3),this.setAttribute("normal",i);else for(let t=0,e=i.count;t<e;t++)i.setXYZ(t,0,0,0);const n=new fn,r=new fn,s=new fn,o=new fn,a=new fn,c=new fn,h=new fn,l=new fn;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),p=t.getX(u+1),f=t.getX(u+2);n.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,f),h.subVectors(s,r),l.subVectors(n,r),h.cross(l),o.fromBufferAttribute(i,d),a.fromBufferAttribute(i,p),c.fromBufferAttribute(i,f),o.add(h),a.add(h),c.add(h),i.setXYZ(d,o.x,o.y,o.z),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(f,c.x,c.y,c.z)}else for(let t=0,o=e.count;t<o;t+=3)n.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),h.subVectors(s,r),l.subVectors(n,r),h.cross(l),i.setXYZ(t+0,h.x,h.y,h.z),i.setXYZ(t+1,h.x,h.y,h.z),i.setXYZ(t+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}},merge:function(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const n in i){if(void 0===t.attributes[n])continue;const r=i[n].array,s=t.attributes[n],o=s.array,a=s.itemSize*e,c=Math.min(o.length,r.length-a);for(let t=0,e=a;t<c;t++,e++)r[e]=o[t]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)cs.fromBufferAttribute(t,e),cs.normalize(),t.setXYZ(e,cs.x,cs.y,cs.z)},toNonIndexed:function(){function t(t,e){const i=t.array,n=t.itemSize,r=t.normalized,s=new i.constructor(e.length*n);let o=0,a=0;for(let t=0,r=e.length;t<r;t++){o=e[t]*n;for(let t=0;t<n;t++)s[a++]=i[o++]}return new Hr(s,n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new hs,i=this.index.array,n=this.attributes;for(const r in n){const s=t(n[r],i);e.setAttribute(r,s)}const r=this.morphAttributes;for(const n in r){const s=[],o=r[n];for(let e=0,n=o.length;e<n;e++){const n=t(o[e],i);s.push(n)}e.morphAttributes[n]=s}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let t=0,i=s.length;t<i;t++){const i=s[t];e.addGroup(i.start,i.count,i.materialIndex)}return e},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const i=this.attributes;for(const e in i){const n=i[e],r=n.toJSON(t.data);""!==n.name&&(r.name=n.name),t.data.attributes[e]=r}const n={};let r=!1;for(const e in this.morphAttributes){const i=this.morphAttributes[e],s=[];for(let e=0,n=i.length;e<n;e++){const n=i[e],r=n.toJSON(t.data);""!==n.name&&(r.name=n.name),s.push(r)}s.length>0&&(n[e]=s,r=!0)}r&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t},clone:function(){return(new hs).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const i=t.index;null!==i&&this.setIndex(i.clone(e));const n=t.attributes;for(const t in n){const i=n[t];this.setAttribute(t,i.clone(e))}const r=t.morphAttributes;for(const t in r){const i=[],n=r[t];for(let t=0,r=n.length;t<r;t++)i.push(n[t].clone(e));this.morphAttributes[t]=i}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let t=0,e=s.length;t<e;t++){const e=s[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const ls=new Hn,us=new jn,ds=new On,ps=new fn,fs=new fn,ms=new fn,gs=new fn,_s=new fn,vs=new fn,ys=new fn,bs=new fn,xs=new fn,ws=new rn,Ss=new rn,Ms=new rn,Ts=new fn,Cs=new fn;function Es(t=new hs,e=new Fr){pr.call(this),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}function Is(t,e,i,n,r,s,o,a,c,h,l,u){ps.fromBufferAttribute(r,h),fs.fromBufferAttribute(r,l),ms.fromBufferAttribute(r,u);const d=t.morphTargetInfluences;if(e.morphTargets&&s&&d){ys.set(0,0,0),bs.set(0,0,0),xs.set(0,0,0);for(let t=0,e=s.length;t<e;t++){const e=d[t],i=s[t];0!==e&&(gs.fromBufferAttribute(i,h),_s.fromBufferAttribute(i,l),vs.fromBufferAttribute(i,u),o?(ys.addScaledVector(gs,e),bs.addScaledVector(_s,e),xs.addScaledVector(vs,e)):(ys.addScaledVector(gs.sub(ps),e),bs.addScaledVector(_s.sub(fs),e),xs.addScaledVector(vs.sub(ms),e)))}ps.add(ys),fs.add(bs),ms.add(xs)}t.isSkinnedMesh&&(t.boneTransform(h,ps),t.boneTransform(l,fs),t.boneTransform(u,ms));const p=function(t,e,i,n,r,s,o,a){let c;if(c=1===e.side?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,2!==e.side,a),null===c)return null;Cs.copy(a),Cs.applyMatrix4(t.matrixWorld);const h=i.ray.origin.distanceTo(Cs);return h<i.near||h>i.far?null:{distance:h,point:Cs.clone(),object:t}}(t,e,i,n,ps,fs,ms,Ts);if(p){a&&(ws.fromBufferAttribute(a,h),Ss.fromBufferAttribute(a,l),Ms.fromBufferAttribute(a,u),p.uv=Ir.getUV(Ts,ps,fs,ms,ws,Ss,Ms,new rn)),c&&(ws.fromBufferAttribute(c,h),Ss.fromBufferAttribute(c,l),Ms.fromBufferAttribute(c,u),p.uv2=Ir.getUV(Ts,ps,fs,ms,ws,Ss,Ms,new rn));const t=new $r(h,l,u);Ir.getNormal(ps,fs,ms,t.normal),p.face=t}return p}Es.prototype=Object.assign(Object.create(pr.prototype),{constructor:Es,isMesh:!0,copy:function(t){return pr.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,i=Object.keys(e);if(i.length>0){const t=e[i[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=t.length;e<i;e++){const i=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,e){const i=this.geometry,n=this.material,r=this.matrixWorld;if(void 0===n)return;if(null===i.boundingSphere&&i.computeBoundingSphere(),ds.copy(i.boundingSphere),ds.applyMatrix4(r),!1===t.ray.intersectsSphere(ds))return;if(ls.copy(r).invert(),us.copy(t.ray).applyMatrix4(ls),null!==i.boundingBox&&!1===us.intersectsBox(i.boundingBox))return;let s;if(i.isBufferGeometry){const r=i.index,o=i.attributes.position,a=i.morphAttributes.position,c=i.morphTargetsRelative,h=i.attributes.uv,l=i.attributes.uv2,u=i.groups,d=i.drawRange;if(null!==r)if(Array.isArray(n))for(let i=0,p=u.length;i<p;i++){const p=u[i],f=n[p.materialIndex];for(let i=Math.max(p.start,d.start),n=Math.min(p.start+p.count,d.start+d.count);i<n;i+=3){const n=r.getX(i),u=r.getX(i+1),d=r.getX(i+2);s=Is(this,f,t,us,o,a,c,h,l,n,u,d),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{for(let i=Math.max(0,d.start),u=Math.min(r.count,d.start+d.count);i<u;i+=3){const u=r.getX(i),d=r.getX(i+1),p=r.getX(i+2);s=Is(this,n,t,us,o,a,c,h,l,u,d,p),s&&(s.faceIndex=Math.floor(i/3),e.push(s))}}else if(void 0!==o)if(Array.isArray(n))for(let i=0,r=u.length;i<r;i++){const r=u[i],p=n[r.materialIndex];for(let i=Math.max(r.start,d.start),n=Math.min(r.start+r.count,d.start+d.count);i<n;i+=3){s=Is(this,p,t,us,o,a,c,h,l,i,i+1,i+2),s&&(s.faceIndex=Math.floor(i/3),s.face.materialIndex=r.materialIndex,e.push(s))}}else{for(let i=Math.max(0,d.start),r=Math.min(o.count,d.start+d.count);i<r;i+=3){s=Is(this,n,t,us,o,a,c,h,l,i,i+1,i+2),s&&(s.faceIndex=Math.floor(i/3),e.push(s))}}}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});class As extends hs{constructor(t=1,e=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};const o=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);const a=[],c=[],h=[],l=[];let u=0,d=0;function p(t,e,i,n,r,s,p,f,m,g,_){const v=s/m,y=p/g,b=s/2,x=p/2,w=f/2,S=m+1,M=g+1;let T=0,C=0;const E=new fn;for(let s=0;s<M;s++){const o=s*y-x;for(let a=0;a<S;a++){const u=a*v-b;E[t]=u*n,E[e]=o*r,E[i]=w,c.push(E.x,E.y,E.z),E[t]=0,E[e]=0,E[i]=f>0?1:-1,h.push(E.x,E.y,E.z),l.push(a/m),l.push(1-s/g),T+=1}}for(let t=0;t<g;t++)for(let e=0;e<m;e++){const i=u+e+S*t,n=u+e+S*(t+1),r=u+(e+1)+S*(t+1),s=u+(e+1)+S*t;a.push(i,n,s),a.push(n,r,s),C+=6}o.addGroup(d,C,_),d+=C,u+=T}p("z","y","x",-1,-1,i,e,t,s,r,0),p("z","y","x",1,-1,i,e,-t,s,r,1),p("x","z","y",1,1,t,i,e,n,s,2),p("x","z","y",1,-1,t,i,-e,n,s,3),p("x","y","z",1,-1,t,e,i,n,r,4),p("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(a),this.setAttribute("position",new Jr(c,3)),this.setAttribute("normal",new Jr(h,3)),this.setAttribute("uv",new Jr(l,2))}}function Ps(t){const e={};for(const i in t){e[i]={};for(const n in t[i]){const r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}}return e}function Rs(t){const e={};for(let i=0;i<t.length;i++){const n=Ps(t[i]);for(const t in n)e[t]=n[t]}return e}const Ls={clone:Ps,merge:Rs};function Os(t){zr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ns(){pr.call(this),this.type="Camera",this.matrixWorldInverse=new Hn,this.projectionMatrix=new Hn,this.projectionMatrixInverse=new Hn}function Ds(t=50,e=1,i=.1,n=2e3){Ns.call(this),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Os.prototype=Object.create(zr.prototype),Os.prototype.constructor=Os,Os.prototype.isShaderMaterial=!0,Os.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ps(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this},Os.prototype.toJSON=function(t){const e=zr.prototype.toJSON.call(this,t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const i={};for(const t in this.extensions)!0===this.extensions[t]&&(i[t]=!0);return Object.keys(i).length>0&&(e.extensions=i),e},Ns.prototype=Object.assign(Object.create(pr.prototype),{constructor:Ns,isCamera:!0,copy:function(t,e){return pr.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new fn),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){pr.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(t,e){pr.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Ds.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Ds,isPerspectiveCamera:!0,copy:function(t,e){return Ns.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const e=.5*this.getFilmHeight()/t;this.fov=2*nn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*nn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*nn.RAD2DEG*Math.atan(Math.tan(.5*nn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=this.near;let e=t*Math.tan(.5*nn.DEG2RAD*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,o=s.fullHeight;r+=s.offsetX*n/t,e-=s.offsetY*i/o,n*=s.width/t,i*=s.height/o}const o=this.filmOffset;0!==o&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){const e=pr.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});const $s=90;function ks(t,e,i){if(pr.call(this),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const n=new Ds($s,1,t,e);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new fn(1,0,0)),this.add(n);const r=new Ds($s,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new fn(-1,0,0)),this.add(r);const s=new Ds($s,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new fn(0,1,0)),this.add(s);const o=new Ds($s,1,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new fn(0,-1,0)),this.add(o);const a=new Ds($s,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new fn(0,0,1)),this.add(a);const c=new Ds($s,1,t,e);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new fn(0,0,-1)),this.add(c),this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();const h=t.xr.enabled,l=t.getRenderTarget();t.xr.enabled=!1;const u=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,n),t.setRenderTarget(i,1),t.render(e,r),t.setRenderTarget(i,2),t.render(e,s),t.setRenderTarget(i,3),t.render(e,o),t.setRenderTarget(i,4),t.render(e,a),i.texture.generateMipmaps=u,t.setRenderTarget(i,5),t.render(e,c),t.setRenderTarget(l),t.xr.enabled=h}}function zs(t,e,i,n,r,s,o,a,c,h){t=void 0!==t?t:[],e=void 0!==e?e:301,o=void 0!==o?o:ki,hn.call(this,t,e,i,n,r,s,o,a,c,h),this.flipY=!1,this._needsFlipEnvMap=!0}ks.prototype=Object.create(pr.prototype),ks.prototype.constructor=ks,zs.prototype=Object.create(hn.prototype),zs.prototype.constructor=zs,zs.prototype.isCubeTexture=!0,Object.defineProperty(zs.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});class Fs extends dn{constructor(t,e,i){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=i),super(t,t,e),Object.defineProperty(this,"isWebGLCubeRenderTarget",{value:!0}),e=e||{},this.texture=new zs(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=zi,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},n=new As(5,5,5),r=new Os({name:"CubemapFromEquirect",uniforms:Ps(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=e;const s=new Es(n,r),o=e.minFilter;e.minFilter===Pi&&(e.minFilter=Ai);return new ks(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,i,n){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,i,n);t.setRenderTarget(r)}}function Bs(t,e,i,n,r,s,o,a,c,h,l,u){hn.call(this,null,s,o,a,c,h,n,r,l,u),this.image={data:t||null,width:e||1,height:i||1},this.magFilter=void 0!==c?c:Ii,this.minFilter=void 0!==h?h:Ii,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Bs.prototype=Object.create(hn.prototype),Bs.prototype.constructor=Bs,Bs.prototype.isDataTexture=!0;const js=new On,Hs=new fn;class Us{constructor(t,e,i,n,r,s){this.planes=[void 0!==t?t:new _r,void 0!==e?e:new _r,void 0!==i?i:new _r,void 0!==n?n:new _r,void 0!==r?r:new _r,void 0!==s?s:new _r]}set(t,e,i,n,r,s){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(s),this}clone(){return(new this.constructor).copy(this)}copy(t){const e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){const e=this.planes,i=t.elements,n=i[0],r=i[1],s=i[2],o=i[3],a=i[4],c=i[5],h=i[6],l=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],_=i[14],v=i[15];return e[0].setComponents(o-n,l-a,f-u,v-m).normalize(),e[1].setComponents(o+n,l+a,f+u,v+m).normalize(),e[2].setComponents(o+r,l+c,f+d,v+g).normalize(),e[3].setComponents(o-r,l-c,f-d,v-g).normalize(),e[4].setComponents(o-s,l-h,f-p,v-_).normalize(),e[5].setComponents(o+s,l+h,f+p,v+_).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),js.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(js)}intersectsSprite(t){return js.center.set(0,0,0),js.radius=.7071067811865476,js.applyMatrix4(t.matrixWorld),this.intersectsSphere(js)}intersectsSphere(t){const e=this.planes,i=t.center,n=-t.radius;for(let t=0;t<6;t++){if(e[t].distanceToPoint(i)<n)return!1}return!0}intersectsBox(t){const e=this.planes;for(let i=0;i<6;i++){const n=e[i];if(Hs.x=n.normal.x>0?t.max.x:t.min.x,Hs.y=n.normal.y>0?t.max.y:t.min.y,Hs.z=n.normal.z>0?t.max.z:t.min.z,n.distanceToPoint(Hs)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}}function Vs(){let t=null,e=!1,i=null,n=null;function r(e,s){i(e,s),n=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==i&&(n=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(t){i=t},setContext:function(e){t=e}}}function Gs(t,e){const i=e.isWebGL2,n=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),n.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const i=n.get(e);i&&(t.deleteBuffer(i.buffer),n.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=n.get(e);return void((!t||t.version<e.version)&&n.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=n.get(e);void 0===s?n.set(e,function(e,n){const r=e.array,s=e.usage,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,s),e.onUploadCallback();let a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?e.isFloat16BufferAttribute?i?a=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:r instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):s.version<e.version&&(!function(e,n,r){const s=n.array,o=n.updateRange;t.bindBuffer(r,e),-1===o.count?t.bufferSubData(r,0,s):(i?t.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):t.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}(s.buffer,e,r),s.version=e.version)}}}class qs extends hs{constructor(t=1,e=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};const r=t/2,s=e/2,o=Math.floor(i),a=Math.floor(n),c=o+1,h=a+1,l=t/o,u=e/a,d=[],p=[],f=[],m=[];for(let t=0;t<h;t++){const e=t*u-s;for(let i=0;i<c;i++){const n=i*l-r;p.push(n,-e,0),f.push(0,0,1),m.push(i/o),m.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<o;e++){const i=e+c*t,n=e+c*(t+1),r=e+1+c*(t+1),s=e+1+c*t;d.push(i,n,s),d.push(n,r,s)}this.setIndex(d),this.setAttribute("position",new Jr(p,3)),this.setAttribute("normal",new Jr(f,3)),this.setAttribute("uv",new Jr(m,2))}}const Ws={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Xs={common:{diffuse:{value:new Dr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new sn},uv2Transform:{value:new sn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new rn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Dr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Dr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new sn}},sprite:{diffuse:{value:new Dr(15658734)},opacity:{value:1},center:{value:new rn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new sn}}},Ys={basic:{uniforms:Rs([Xs.common,Xs.specularmap,Xs.envmap,Xs.aomap,Xs.lightmap,Xs.fog]),vertexShader:Ws.meshbasic_vert,fragmentShader:Ws.meshbasic_frag},lambert:{uniforms:Rs([Xs.common,Xs.specularmap,Xs.envmap,Xs.aomap,Xs.lightmap,Xs.emissivemap,Xs.fog,Xs.lights,{emissive:{value:new Dr(0)}}]),vertexShader:Ws.meshlambert_vert,fragmentShader:Ws.meshlambert_frag},phong:{uniforms:Rs([Xs.common,Xs.specularmap,Xs.envmap,Xs.aomap,Xs.lightmap,Xs.emissivemap,Xs.bumpmap,Xs.normalmap,Xs.displacementmap,Xs.fog,Xs.lights,{emissive:{value:new Dr(0)},specular:{value:new Dr(1118481)},shininess:{value:30}}]),vertexShader:Ws.meshphong_vert,fragmentShader:Ws.meshphong_frag},standard:{uniforms:Rs([Xs.common,Xs.envmap,Xs.aomap,Xs.lightmap,Xs.emissivemap,Xs.bumpmap,Xs.normalmap,Xs.displacementmap,Xs.roughnessmap,Xs.metalnessmap,Xs.fog,Xs.lights,{emissive:{value:new Dr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ws.meshphysical_vert,fragmentShader:Ws.meshphysical_frag},toon:{uniforms:Rs([Xs.common,Xs.aomap,Xs.lightmap,Xs.emissivemap,Xs.bumpmap,Xs.normalmap,Xs.displacementmap,Xs.gradientmap,Xs.fog,Xs.lights,{emissive:{value:new Dr(0)}}]),vertexShader:Ws.meshtoon_vert,fragmentShader:Ws.meshtoon_frag},matcap:{uniforms:Rs([Xs.common,Xs.bumpmap,Xs.normalmap,Xs.displacementmap,Xs.fog,{matcap:{value:null}}]),vertexShader:Ws.meshmatcap_vert,fragmentShader:Ws.meshmatcap_frag},points:{uniforms:Rs([Xs.points,Xs.fog]),vertexShader:Ws.points_vert,fragmentShader:Ws.points_frag},dashed:{uniforms:Rs([Xs.common,Xs.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ws.linedashed_vert,fragmentShader:Ws.linedashed_frag},depth:{uniforms:Rs([Xs.common,Xs.displacementmap]),vertexShader:Ws.depth_vert,fragmentShader:Ws.depth_frag},normal:{uniforms:Rs([Xs.common,Xs.bumpmap,Xs.normalmap,Xs.displacementmap,{opacity:{value:1}}]),vertexShader:Ws.normal_vert,fragmentShader:Ws.normal_frag},sprite:{uniforms:Rs([Xs.sprite,Xs.fog]),vertexShader:Ws.sprite_vert,fragmentShader:Ws.sprite_frag},background:{uniforms:{uvTransform:{value:new sn},t2D:{value:null}},vertexShader:Ws.background_vert,fragmentShader:Ws.background_frag},cube:{uniforms:Rs([Xs.envmap,{opacity:{value:1}}]),vertexShader:Ws.cube_vert,fragmentShader:Ws.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ws.equirect_vert,fragmentShader:Ws.equirect_frag},distanceRGBA:{uniforms:Rs([Xs.common,Xs.displacementmap,{referencePosition:{value:new fn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ws.distanceRGBA_vert,fragmentShader:Ws.distanceRGBA_frag},shadow:{uniforms:Rs([Xs.lights,Xs.fog,{color:{value:new Dr(0)},opacity:{value:1}}]),vertexShader:Ws.shadow_vert,fragmentShader:Ws.shadow_frag}};function Zs(t,e,i,n,r){const s=new Dr(0);let o,a,c=0,h=null,l=0,u=null;function d(t,e){i.buffers.color.setClear(t.r,t.g,t.b,e,r)}return{getClearColor:function(){return s},setClearColor:function(t,e=1){s.set(t),c=e,d(s,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,d(s,c)},render:function(i,r,p,f){let m=!0===r.isScene?r.background:null;m&&m.isTexture&&(m=e.get(m));const g=t.xr,_=g.getSession&&g.getSession();_&&"additive"===_.environmentBlendMode&&(m=null),null===m?d(s,c):m&&m.isColor&&(d(m,1),f=!0),(t.autoClear||f)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),m&&(m.isCubeTexture||m.isWebGLCubeRenderTarget||306===m.mapping)?(void 0===a&&(a=new Es(new As(1,1,1),new Os({name:"BackgroundCubeMaterial",uniforms:Ps(Ys.cube.uniforms),vertexShader:Ys.cube.vertexShader,fragmentShader:Ys.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a)),m.isWebGLCubeRenderTarget&&(m=m.texture),a.material.uniforms.envMap.value=m,a.material.uniforms.flipEnvMap.value=m.isCubeTexture&&m._needsFlipEnvMap?-1:1,h===m&&l===m.version&&u===t.toneMapping||(a.material.needsUpdate=!0,h=m,l=m.version,u=t.toneMapping),i.unshift(a,a.geometry,a.material,0,0,null)):m&&m.isTexture&&(void 0===o&&(o=new Es(new qs(2,2),new Os({name:"BackgroundMaterial",uniforms:Ps(Ys.background.uniforms),vertexShader:Ys.background.vertexShader,fragmentShader:Ys.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(o)),o.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),h===m&&l===m.version&&u===t.toneMapping||(o.material.needsUpdate=!0,h=m,l=m.version,u=t.toneMapping),i.unshift(o,o.geometry,o.material,0,0,null))}}}function Js(t,e,i,n){const r=t.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},c=d(null);let h=c;function l(e){return n.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function u(e){return n.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function d(t){const e=[],i=[],n=[];for(let t=0;t<r;t++)e[t]=0,i[t]=0,n[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:i,attributeDivisors:n,object:t,attributes:{},index:null}}function p(){const t=h.newAttributes;for(let e=0,i=t.length;e<i;e++)t[e]=0}function f(t){m(t,0)}function m(i,r){const s=h.newAttributes,o=h.enabledAttributes,a=h.attributeDivisors;if(s[i]=1,0===o[i]&&(t.enableVertexAttribArray(i),o[i]=1),a[i]!==r){(n.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),a[i]=r}}function g(){const e=h.newAttributes,i=h.enabledAttributes;for(let n=0,r=i.length;n<r;n++)i[n]!==e[n]&&(t.disableVertexAttribArray(n),i[n]=0)}function _(e,i,r,s,o,a){!0!==n.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,i,r,s,o,a):t.vertexAttribIPointer(e,i,r,o,a)}function v(){y(),h!==c&&(h=c,l(h.object))}function y(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(r,c,u,v,y){let b=!1;if(o){const e=function(e,i,r){const o=!0===r.wireframe;let c=a[e.id];void 0===c&&(c={},a[e.id]=c);let h=c[i.id];void 0===h&&(h={},c[i.id]=h);let l=h[o];void 0===l&&(l=d(n.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),h[o]=l);return l}(v,u,c);h!==e&&(h=e,l(h.object)),b=function(t,e){const i=h.attributes,n=t.attributes;let r=0;for(const t in n){const e=i[t],s=n[t];if(void 0===e)return!0;if(e.attribute!==s)return!0;if(e.data!==s.data)return!0;r++}return h.attributesNum!==r||h.index!==e}(v,y),b&&function(t,e){const i={},n=t.attributes;let r=0;for(const t in n){const e=n[t],s={};s.attribute=e,e.data&&(s.data=e.data),i[t]=s,r++}h.attributes=i,h.attributesNum=r,h.index=e}(v,y)}else{const t=!0===c.wireframe;h.geometry===v.id&&h.program===u.id&&h.wireframe===t||(h.geometry=v.id,h.program=u.id,h.wireframe=t,b=!0)}!0===r.isInstancedMesh&&(b=!0),null!==y&&i.update(y,34963),b&&(!function(r,s,o,a){if(!1===n.isWebGL2&&(r.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const c=a.attributes,h=o.getAttributes(),l=s.defaultAttributeValues;for(const e in h){const n=h[e];if(n>=0){const s=c[e];if(void 0!==s){const e=s.normalized,r=s.itemSize,o=i.get(s);if(void 0===o)continue;const c=o.buffer,h=o.type,l=o.bytesPerElement;if(s.isInterleavedBufferAttribute){const i=s.data,o=i.stride,u=s.offset;i&&i.isInstancedInterleavedBuffer?(m(n,i.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=i.meshPerAttribute*i.count)):f(n),t.bindBuffer(34962,c),_(n,r,h,e,o*l,u*l)}else s.isInstancedBufferAttribute?(m(n,s.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)):f(n),t.bindBuffer(34962,c),_(n,r,h,e,0,0)}else if("instanceMatrix"===e){const e=i.get(r.instanceMatrix);if(void 0===e)continue;const s=e.buffer,o=e.type;m(n+0,1),m(n+1,1),m(n+2,1),m(n+3,1),t.bindBuffer(34962,s),t.vertexAttribPointer(n+0,4,o,!1,64,0),t.vertexAttribPointer(n+1,4,o,!1,64,16),t.vertexAttribPointer(n+2,4,o,!1,64,32),t.vertexAttribPointer(n+3,4,o,!1,64,48)}else if("instanceColor"===e){const e=i.get(r.instanceColor);if(void 0===e)continue;const s=e.buffer,o=e.type;m(n,1),t.bindBuffer(34962,s),t.vertexAttribPointer(n,3,o,!1,12,0)}else if(void 0!==l){const i=l[e];if(void 0!==i)switch(i.length){case 2:t.vertexAttrib2fv(n,i);break;case 3:t.vertexAttrib3fv(n,i);break;case 4:t.vertexAttrib4fv(n,i);break;default:t.vertexAttrib1fv(n,i)}}}}g()}(r,c,u,v),null!==y&&t.bindBuffer(34963,i.get(y).buffer))},reset:v,resetDefaultState:y,dispose:function(){v();for(const t in a){const e=a[t];for(const t in e){const i=e[t];for(const t in i)u(i[t].object),delete i[t];delete e[t]}delete a[t]}},releaseStatesOfGeometry:function(t){if(void 0===a[t.id])return;const e=a[t.id];for(const t in e){const i=e[t];for(const t in i)u(i[t].object),delete i[t];delete e[t]}delete a[t.id]},releaseStatesOfProgram:function(t){for(const e in a){const i=a[e];if(void 0===i[t.id])continue;const n=i[t.id];for(const t in n)u(n[t].object),delete n[t];delete i[t.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function Ks(t,e,i,n){const r=n.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,n){t.drawArrays(s,e,n),i.update(n,s,1)},this.renderInstances=function(n,o,a){if(0===a)return;let c,h;if(r)c=t,h="drawArraysInstanced";else if(c=e.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",null===c)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](s,n,o,a),i.update(o,s,a)}}function Qs(t,e,i){let n;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let o=void 0!==i.precision?i.precision:"highp";const a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const c=!0===i.logarithmicDepthBuffer,h=t.getParameter(34930),l=t.getParameter(35660),u=t.getParameter(3379),d=t.getParameter(34076),p=t.getParameter(34921),f=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),_=l>0,v=s||!!e.get("OES_texture_float");return{isWebGL2:s,getMaxAnisotropy:function(){if(void 0!==n)return n;const i=e.get("EXT_texture_filter_anisotropic");return n=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,n},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:l,maxTextureSize:u,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:_,floatFragmentTextures:v,floatVertexTextures:_&&v,maxSamples:s?t.getParameter(36183):0}}function to(t){const e=this;let i=null,n=0,r=!1,s=!1;const o=new _r,a=new sn,c={value:null,needsUpdate:!1};function h(){c.value!==i&&(c.value=i,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(t,i,n,r){const s=null!==t?t.length:0;let h=null;if(0!==s){if(h=c.value,!0!==r||null===h){const e=n+4*s,r=i.matrixWorldInverse;a.getNormalMatrix(r),(null===h||h.length<e)&&(h=new Float32Array(e));for(let e=0,i=n;e!==s;++e,i+=4)o.copy(t[e]).applyMatrix4(r,a),o.normal.toArray(h,i),h[i+3]=o.constant}c.value=h,c.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,h}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,s){const o=0!==t.length||e||0!==n||r;return r=e,i=l(t,s,0),n=t.length,o},this.beginShadows=function(){s=!0,l(null)},this.endShadows=function(){s=!1,h()},this.setState=function(e,o,a){const u=e.clippingPlanes,d=e.clipIntersection,p=e.clipShadows,f=t.get(e);if(!r||null===u||0===u.length||s&&!p)s?l(null):h();else{const t=s?0:n,e=4*t;let r=f.clippingState||null;c.value=r,r=l(u,o,e,a);for(let t=0;t!==e;++t)r[t]=i[t];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function eo(t){let e=new WeakMap;function i(t,e){return 303===e?t.mapping=301:304===e&&(t.mapping=302),t}function n(t){const i=t.target;i.removeEventListener("dispose",n);const r=e.get(i);void 0!==r&&(e.delete(i),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(303===s||304===s){if(e.has(r)){return i(e.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=t.getRenderList(),a=t.getRenderTarget(),c=new Fs(s.height/2);return c.fromEquirectangularTexture(t,r),e.set(r,c),t.setRenderTarget(a),t.setRenderList(o),r.addEventListener("dispose",n),i(c.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}function io(t){const e={};function i(i){if(void 0!==e[i])return e[i];let n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return e[i]=n,n}return{has:function(t){return null!==i(t)},init:function(t){t.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float")},get:function(t){const e=i(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function no(t,e,i,n){const r={},s=new WeakMap;function o(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const t in a.attributes)e.remove(a.attributes[t]);a.removeEventListener("dispose",o),delete r[a.id];const c=s.get(a);c&&(e.remove(c),s.delete(a)),n.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,i.memory.geometries--}function a(t){const i=[],n=t.index,r=t.attributes.position;let o=0;if(null!==n){const t=n.array;o=n.version;for(let e=0,n=t.length;e<n;e+=3){const n=t[e+0],r=t[e+1],s=t[e+2];i.push(n,r,r,s,s,n)}}else{const t=r.array;o=r.version;for(let e=0,n=t.length/3-1;e<n;e+=3){const t=e+0,n=e+1,r=e+2;i.push(t,n,n,r,r,t)}}const a=new(Qr(i)>65535?Yr:Wr)(i,1);a.version=o;const c=s.get(t);c&&e.remove(c),s.set(t,a)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",o),r[e.id]=!0,i.memory.geometries++),e},update:function(t){const i=t.attributes;for(const t in i)e.update(i[t],34962);const n=t.morphAttributes;for(const t in n){const i=n[t];for(let t=0,n=i.length;t<n;t++)e.update(i[t],34962)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const i=t.index;null!==i&&e.version<i.version&&a(t)}else a(t);return s.get(t)}}}function ro(t,e,i,n){const r=n.isWebGL2;let s,o,a;this.setMode=function(t){s=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,n){t.drawElements(s,n,o,e*a),i.update(n,s,1)},this.renderInstances=function(n,c,h){if(0===h)return;let l,u;if(r)l=t,u="drawElementsInstanced";else if(l=e.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===l)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](s,c,o,n*a,h),i.update(c,s,h)}}function so(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,i,n){switch(e.calls++,i){case 4:e.triangles+=n*(t/3);break;case 1:e.lines+=n*(t/2);break;case 3:e.lines+=n*(t-1);break;case 2:e.lines+=n*t;break;case 0:e.points+=n*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function oo(t,e){return t[0]-e[0]}function ao(t,e){return Math.abs(e[1])-Math.abs(t[1])}function co(t){const e={},i=new Float32Array(8),n=[];for(let t=0;t<8;t++)n[t]=[t,0];return{update:function(r,s,o,a){const c=r.morphTargetInfluences,h=void 0===c?0:c.length;let l=e[s.id];if(void 0===l){l=[];for(let t=0;t<h;t++)l[t]=[t,0];e[s.id]=l}for(let t=0;t<h;t++){const e=l[t];e[0]=t,e[1]=c[t]}l.sort(ao);for(let t=0;t<8;t++)t<h&&l[t][1]?(n[t][0]=l[t][0],n[t][1]=l[t][1]):(n[t][0]=Number.MAX_SAFE_INTEGER,n[t][1]=0);n.sort(oo);const u=o.morphTargets&&s.morphAttributes.position,d=o.morphNormals&&s.morphAttributes.normal;let p=0;for(let t=0;t<8;t++){const e=n[t],r=e[0],o=e[1];r!==Number.MAX_SAFE_INTEGER&&o?(u&&s.getAttribute("morphTarget"+t)!==u[r]&&s.setAttribute("morphTarget"+t,u[r]),d&&s.getAttribute("morphNormal"+t)!==d[r]&&s.setAttribute("morphNormal"+t,d[r]),i[t]=o,p+=o):(u&&!0===s.hasAttribute("morphTarget"+t)&&s.deleteAttribute("morphTarget"+t),d&&!0===s.hasAttribute("morphNormal"+t)&&s.deleteAttribute("morphNormal"+t),i[t]=0)}const f=s.morphTargetsRelative?1:1-p;a.getUniforms().setValue(t,"morphTargetBaseInfluence",f),a.getUniforms().setValue(t,"morphTargetInfluences",i)}}}function ho(t,e,i,n){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),i.remove(e.instanceMatrix),null!==e.instanceColor&&i.remove(e.instanceColor)}return{update:function(t){const o=n.render.frame,a=t.geometry,c=e.get(t,a);return r.get(c)!==o&&(e.update(c),r.set(c,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),i.update(t.instanceMatrix,34962),null!==t.instanceColor&&i.update(t.instanceColor,34962)),c},dispose:function(){r=new WeakMap}}}function lo(t=null,e=1,i=1,n=1){hn.call(this,null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=Ci,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function uo(t=null,e=1,i=1,n=1){hn.call(this,null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=Ci,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ys.physical={uniforms:Rs([Ys.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new rn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Dr(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Ws.meshphysical_vert,fragmentShader:Ws.meshphysical_frag},lo.prototype=Object.create(hn.prototype),lo.prototype.constructor=lo,lo.prototype.isDataTexture2DArray=!0,uo.prototype=Object.create(hn.prototype),uo.prototype.constructor=uo,uo.prototype.isDataTexture3D=!0;const po=new hn,fo=new lo,mo=new uo,go=new zs,_o=[],vo=[],yo=new Float32Array(16),bo=new Float32Array(9),xo=new Float32Array(4);function wo(t,e,i){const n=t[0];if(n<=0||n>0)return t;const r=e*i;let s=_o[r];if(void 0===s&&(s=new Float32Array(r),_o[r]=s),0!==e){n.toArray(s,0);for(let n=1,r=0;n!==e;++n)r+=i,t[n].toArray(s,r)}return s}function So(t,e){if(t.length!==e.length)return!1;for(let i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Mo(t,e){for(let i=0,n=e.length;i<n;i++)t[i]=e[i]}function To(t,e){let i=vo[e];void 0===i&&(i=new Int32Array(e),vo[e]=i);for(let n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function Co(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Eo(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(So(i,e))return;t.uniform2fv(this.addr,e),Mo(i,e)}}function Io(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!==e.r)i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(So(i,e))return;t.uniform3fv(this.addr,e),Mo(i,e)}}function Ao(t,e){const i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(So(i,e))return;t.uniform4fv(this.addr,e),Mo(i,e)}}function Po(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(So(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),Mo(i,e)}else{if(So(i,n))return;xo.set(n),t.uniformMatrix2fv(this.addr,!1,xo),Mo(i,n)}}function Ro(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(So(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),Mo(i,e)}else{if(So(i,n))return;bo.set(n),t.uniformMatrix3fv(this.addr,!1,bo),Mo(i,n)}}function Lo(t,e){const i=this.cache,n=e.elements;if(void 0===n){if(So(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),Mo(i,e)}else{if(So(i,n))return;yo.set(n),t.uniformMatrix4fv(this.addr,!1,yo),Mo(i,n)}}function Oo(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTexture2D(e||po,r)}function No(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||fo,r)}function Do(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||mo,r)}function $o(t,e,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTextureCube(e||go,r)}function ko(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function zo(t,e){const i=this.cache;So(i,e)||(t.uniform2iv(this.addr,e),Mo(i,e))}function Fo(t,e){const i=this.cache;So(i,e)||(t.uniform3iv(this.addr,e),Mo(i,e))}function Bo(t,e){const i=this.cache;So(i,e)||(t.uniform4iv(this.addr,e),Mo(i,e))}function jo(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function Ho(t,e){t.uniform1fv(this.addr,e)}function Uo(t,e){t.uniform1iv(this.addr,e)}function Vo(t,e){t.uniform2iv(this.addr,e)}function Go(t,e){t.uniform3iv(this.addr,e)}function qo(t,e){t.uniform4iv(this.addr,e)}function Wo(t,e){const i=wo(e,this.size,2);t.uniform2fv(this.addr,i)}function Xo(t,e){const i=wo(e,this.size,3);t.uniform3fv(this.addr,i)}function Yo(t,e){const i=wo(e,this.size,4);t.uniform4fv(this.addr,i)}function Zo(t,e){const i=wo(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function Jo(t,e){const i=wo(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function Ko(t,e){const i=wo(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function Qo(t,e,i){const n=e.length,r=To(i,n);t.uniform1iv(this.addr,r);for(let t=0;t!==n;++t)i.safeSetTexture2D(e[t]||po,r[t])}function ta(t,e,i){const n=e.length,r=To(i,n);t.uniform1iv(this.addr,r);for(let t=0;t!==n;++t)i.safeSetTextureCube(e[t]||go,r[t])}function ea(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Co;case 35664:return Eo;case 35665:return Io;case 35666:return Ao;case 35674:return Po;case 35675:return Ro;case 35676:return Lo;case 5124:case 35670:return ko;case 35667:case 35671:return zo;case 35668:case 35672:return Fo;case 35669:case 35673:return Bo;case 5125:return jo;case 35678:case 36198:case 36298:case 36306:case 35682:return Oo;case 35679:case 36299:case 36307:return Do;case 35680:case 36300:case 36308:case 36293:return $o;case 36289:case 36303:case 36311:case 36292:return No}}(e.type)}function ia(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Ho;case 35664:return Wo;case 35665:return Xo;case 35666:return Yo;case 35674:return Zo;case 35675:return Jo;case 35676:return Ko;case 5124:case 35670:return Uo;case 35667:case 35671:return Vo;case 35668:case 35672:return Go;case 35669:case 35673:return qo;case 35678:case 36198:case 36298:case 36306:case 35682:return Qo;case 35680:case 36300:case 36308:case 36293:return ta}}(e.type)}function na(t){this.id=t,this.seq=[],this.map={}}ia.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Mo(e,t)},na.prototype.setValue=function(t,e,i){const n=this.seq;for(let r=0,s=n.length;r!==s;++r){const s=n[r];s.setValue(t,e[s.id],i)}};const ra=/(\w+)(\])?(\[|\.)?/g;function sa(t,e){t.seq.push(e),t.map[e.id]=e}function oa(t,e,i){const n=t.name,r=n.length;for(ra.lastIndex=0;;){const s=ra.exec(n),o=ra.lastIndex;let a=s[1];const c="]"===s[2],h=s[3];if(c&&(a|=0),void 0===h||"["===h&&o+2===r){sa(i,void 0===h?new ea(a,t,e):new ia(a,t,e));break}{let t=i.map[a];void 0===t&&(t=new na(a),sa(i,t)),i=t}}}function aa(t,e){this.seq=[],this.map={};const i=t.getProgramParameter(e,35718);for(let n=0;n<i;++n){const i=t.getActiveUniform(e,n);oa(i,t.getUniformLocation(e,i.name),this)}}function ca(t,e,i){const n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}aa.prototype.setValue=function(t,e,i,n){const r=this.map[e];void 0!==r&&r.setValue(t,i,n)},aa.prototype.setOptional=function(t,e,i){const n=e[i];void 0!==n&&this.setValue(t,i,n)},aa.upload=function(t,e,i,n){for(let r=0,s=e.length;r!==s;++r){const s=e[r],o=i[s.id];!1!==o.needsUpdate&&s.setValue(t,o.value,n)}},aa.seqWithValue=function(t,e){const i=[];for(let n=0,r=t.length;n!==r;++n){const r=t[n];r.id in e&&i.push(r)}return i};let ha=0;function la(t){switch(t){case Xi:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function ua(t,e,i){const n=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(n&&""===r)return"";return"THREE.WebGLShader: gl.getShaderInfoLog() "+i+"\n"+r+function(t){const e=t.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(t.getShaderSource(e))}function da(t,e){const i=la(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function pa(t,e){const i=la(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function fa(t,e){let i;switch(e){case 1:i="Linear";break;case 2:i="Reinhard";break;case 3:i="OptimizedCineon";break;case 4:i="ACESFilmic";break;case 5:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function ma(t){return""!==t}function ga(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function _a(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const va=/^[ \t]*#include +<([\w\d./]+)>/gm;function ya(t){return t.replace(va,ba)}function ba(t,e){const i=Ws[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return ya(i)}const xa=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,wa=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Sa(t){return t.replace(wa,Ta).replace(xa,Ma)}function Ma(t,e,i,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ta(t,e,i,n)}function Ta(t,e,i,n){let r="";for(let t=parseInt(e);t<parseInt(i);t++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function Ca(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Ea(t,e,i,n){const r=t.getContext(),s=i.defines;let o=i.vertexShader,a=i.fragmentShader;const c=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(i),h=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(i),l=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(i),u=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(i),d=t.gammaFactor>0?t.gammaFactor:1,p=i.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ma).join("\n")}(i),f=function(t){const e=[];for(const i in t){const n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(s),m=r.createProgram();let g,_,v=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?(g=[f].filter(ma).join("\n"),g.length>0&&(g+="\n"),_=[p,f].filter(ma).join("\n"),_.length>0&&(_+="\n")):(g=[Ca(i),"#define SHADER_NAME "+i.shaderName,f,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+l:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ma).join("\n"),_=[p,Ca(i),"#define SHADER_NAME "+i.shaderName,f,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+l:"",i.envMap?"#define "+u:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+c:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==i.toneMapping?"#define TONE_MAPPING":"",0!==i.toneMapping?Ws.tonemapping_pars_fragment:"",0!==i.toneMapping?fa("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",Ws.encodings_pars_fragment,i.map?da("mapTexelToLinear",i.mapEncoding):"",i.matcap?da("matcapTexelToLinear",i.matcapEncoding):"",i.envMap?da("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMap?da("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMap?da("lightMapTexelToLinear",i.lightMapEncoding):"",pa("linearToOutputTexel",i.outputEncoding),i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(ma).join("\n")),o=ya(o),o=ga(o,i),o=_a(o,i),a=ya(a),a=ga(a,i),a=_a(a,i),o=Sa(o),a=Sa(a),i.isWebGL2&&!0!==i.isRawShaderMaterial&&(v="#version 300 es\n",g=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,_=["#define varying in",i.glslVersion===Ki?"":"out highp vec4 pc_fragColor;",i.glslVersion===Ki?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const y=v+_+a,b=ca(r,35633,v+g+o),x=ca(r,35632,y);if(r.attachShader(m,b),r.attachShader(m,x),void 0!==i.index0AttributeName?r.bindAttribLocation(m,0,i.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(m).trim(),e=r.getShaderInfoLog(b).trim(),i=r.getShaderInfoLog(x).trim();let n=!0,s=!0;if(!1===r.getProgramParameter(m,35714)){n=!1;const e=ua(r,b,"vertex"),i=ua(r,x,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(m,35715),"gl.getProgramInfoLog",t,e,i)}else""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==e&&""!==i||(s=!1);s&&(this.diagnostics={runnable:n,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:i,prefix:_}})}let w,S;return r.deleteShader(b),r.deleteShader(x),this.getUniforms=function(){return void 0===w&&(w=new aa(r,m)),w},this.getAttributes=function(){return void 0===S&&(S=function(t,e){const i={},n=t.getProgramParameter(e,35721);for(let r=0;r<n;r++){const n=t.getActiveAttrib(e,r).name;i[n]=t.getAttribLocation(e,n)}return i}(r,m)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=i.shaderName,this.id=ha++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=x,this}function Ia(t,e,i,n,r,s){const o=[],a=n.isWebGL2,c=n.logarithmicDepthBuffer,h=n.floatVertexTextures,l=n.maxVertexUniforms,u=n.vertexTextures;let d=n.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function m(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=Xi,e}return{getParameters:function(r,o,f,g,_){const v=g.fog,y=r.isMeshStandardMaterial?g.environment:null,b=e.get(r.envMap||y),x=p[r.type],w=_.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(h)return 1024;{const t=l,i=Math.floor((t-20)/4),n=Math.min(i,e.length);return n<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+n+"."),0):n}}(_):0;let S,M;if(null!==r.precision&&(d=n.getMaxPrecision(r.precision),d!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",d,"instead.")),x){const t=Ys[x];S=t.vertexShader,M=t.fragmentShader}else S=r.vertexShader,M=r.fragmentShader;const T=t.getRenderTarget();return{isWebGL2:a,shaderID:x,shaderName:r.type,vertexShader:S,fragmentShader:M,defines:r.defines,isRawShaderMaterial:!0===r.isRawShaderMaterial,glslVersion:r.glslVersion,precision:d,instancing:!0===_.isInstancedMesh,instancingColor:!0===_.isInstancedMesh&&null!==_.instanceColor,supportsVertexTextures:u,outputEncoding:null!==T?m(T.texture):t.outputEncoding,map:!!r.map,mapEncoding:m(r.map),matcap:!!r.matcap,matcapEncoding:m(r.matcap),envMap:!!b,envMapMode:b&&b.mapping,envMapEncoding:m(b),envMapCubeUV:!!b&&(306===b.mapping||307===b.mapping),lightMap:!!r.lightMap,lightMapEncoding:m(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:m(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:0===r.normalMapType,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,transmissionMap:!!r.transmissionMap,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap||r.transmissionMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.transmissionMap||!r.displacementMap),fog:!!v,useFog:r.fog,fogExp2:v&&v.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:c,skinning:r.skinning&&w>0,maxBones:w,useVertexTexture:h,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||i.has("EXT_shader_texture_lod"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(e){const i=[];if(e.shaderID?i.push(e.shaderID):(i.push(e.fragmentShader),i.push(e.vertexShader)),void 0!==e.defines)for(const t in e.defines)i.push(t),i.push(e.defines[t]);if(!1===e.isRawShaderMaterial){for(let t=0;t<f.length;t++)i.push(e[f[t]]);i.push(t.outputEncoding),i.push(t.gammaFactor)}return i.push(e.customProgramCacheKey),i.join()},getUniforms:function(t){const e=p[t.type];let i;if(e){const t=Ys[e];i=Ls.clone(t.uniforms)}else i=t.uniforms;return i},acquireProgram:function(e,i){let n;for(let t=0,e=o.length;t<e;t++){const e=o[t];if(e.cacheKey===i){n=e,++n.usedTimes;break}}return void 0===n&&(n=new Ea(t,i,e,r),o.push(n)),n},releaseProgram:function(t){if(0==--t.usedTimes){const e=o.indexOf(t);o[e]=o[o.length-1],o.pop(),t.destroy()}},programs:o}}function Aa(){let t=new WeakMap;return{get:function(e){let i=t.get(e);return void 0===i&&(i={},t.set(e,i)),i},remove:function(e){t.delete(e)},update:function(e,i,n){t.get(e)[i]=n},dispose:function(){t=new WeakMap}}}function Pa(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Ra(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function La(t){const e=[];let i=0;const n=[],r=[],s={id:-1};function o(n,r,o,a,c,h){let l=e[i];const u=t.get(o);return void 0===l?(l={id:n.id,object:n,geometry:r,material:o,program:u.program||s,groupOrder:a,renderOrder:n.renderOrder,z:c,group:h},e[i]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=o,l.program=u.program||s,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=c,l.group=h),i++,l}return{opaque:n,transparent:r,init:function(){i=0,n.length=0,r.length=0},push:function(t,e,i,s,a,c){const h=o(t,e,i,s,a,c);(!0===i.transparent?r:n).push(h)},unshift:function(t,e,i,s,a,c){const h=o(t,e,i,s,a,c);(!0===i.transparent?r:n).unshift(h)},finish:function(){for(let t=i,n=e.length;t<n;t++){const i=e[t];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Pa),r.length>1&&r.sort(e||Ra)}}}function Oa(t){let e=new WeakMap;return{get:function(i,n){const r=e.get(i);let s;return void 0===r?(s=new La(t),e.set(i,new WeakMap),e.get(i).set(n,s)):(s=r.get(n),void 0===s&&(s=new La(t),r.set(n,s))),s},dispose:function(){e=new WeakMap}}}function Na(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new fn,color:new Dr};break;case"SpotLight":i={position:new fn,direction:new fn,color:new Dr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new fn,color:new Dr,distance:0,decay:0};break;case"HemisphereLight":i={direction:new fn,skyColor:new Dr,groundColor:new Dr};break;case"RectAreaLight":i={color:new Dr,position:new fn,halfWidth:new fn,halfHeight:new fn}}return t[e.id]=i,i}}}let Da=0;function $a(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function ka(t,e){const i=new Na,n=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let i;switch(e.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rn};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rn,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=i,i}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)r.probe.push(new fn);const s=new fn,o=new Hn,a=new Hn;return{setup:function(s){let o=0,a=0,c=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let h=0,l=0,u=0,d=0,p=0,f=0,m=0,g=0;s.sort($a);for(let t=0,e=s.length;t<e;t++){const e=s[t],_=e.color,v=e.intensity,y=e.distance,b=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)o+=_.r*v,a+=_.g*v,c+=_.b*v;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],v);else if(e.isDirectionalLight){const t=i.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,r.directionalShadow[h]=i,r.directionalShadowMap[h]=b,r.directionalShadowMatrix[h]=e.shadow.matrix,f++}r.directional[h]=t,h++}else if(e.isSpotLight){const t=i.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(_).multiplyScalar(v),t.distance=y,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,r.spotShadow[u]=i,r.spotShadowMap[u]=b,r.spotShadowMatrix[u]=e.shadow.matrix,g++}r.spot[u]=t,u++}else if(e.isRectAreaLight){const t=i.get(e);t.color.copy(_).multiplyScalar(v),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[d]=t,d++}else if(e.isPointLight){const t=i.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,i=n.get(e);i.shadowBias=t.bias,i.shadowNormalBias=t.normalBias,i.shadowRadius=t.radius,i.shadowMapSize=t.mapSize,i.shadowCameraNear=t.camera.near,i.shadowCameraFar=t.camera.far,r.pointShadow[l]=i,r.pointShadowMap[l]=b,r.pointShadowMatrix[l]=e.shadow.matrix,m++}r.point[l]=t,l++}else if(e.isHemisphereLight){const t=i.get(e);t.skyColor.copy(e.color).multiplyScalar(v),t.groundColor.copy(e.groundColor).multiplyScalar(v),r.hemi[p]=t,p++}}d>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Xs.LTC_FLOAT_1,r.rectAreaLTC2=Xs.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Xs.LTC_HALF_1,r.rectAreaLTC2=Xs.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=o,r.ambient[1]=a,r.ambient[2]=c;const _=r.hash;_.directionalLength===h&&_.pointLength===l&&_.spotLength===u&&_.rectAreaLength===d&&_.hemiLength===p&&_.numDirectionalShadows===f&&_.numPointShadows===m&&_.numSpotShadows===g||(r.directional.length=h,r.spot.length=u,r.rectArea.length=d,r.point.length=l,r.hemi.length=p,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=m,r.spotShadowMatrix.length=g,_.directionalLength=h,_.pointLength=l,_.spotLength=u,_.rectAreaLength=d,_.hemiLength=p,_.numDirectionalShadows=f,_.numPointShadows=m,_.numSpotShadows=g,r.version=Da++)},setupView:function(t,e){let i=0,n=0,c=0,h=0,l=0;const u=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=r.directional[i];t.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(u),i++}else if(d.isSpotLight){const t=r.spot[c];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(u),c++}else if(d.isRectAreaLight){const t=r.rectArea[h];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),a.identity(),o.copy(d.matrixWorld),o.premultiply(u),a.extractRotation(o),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),h++}else if(d.isPointLight){const t=r.point[n];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(u),n++}else if(d.isHemisphereLight){const t=r.hemi[l];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(u),t.direction.normalize(),l++}}},state:r}}function za(t,e){const i=new ka(t,e),n=[],r=[];return{init:function(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:function(){i.setup(n)},setupLightsView:function(t){i.setupView(n,t)},pushLight:function(t){n.push(t)},pushShadow:function(t){r.push(t)}}}function Fa(t,e){let i=new WeakMap;return{get:function(n,r=0){let s;return!1===i.has(n)?(s=new za(t,e),i.set(n,[]),i.get(n).push(s)):r>=i.get(n).length?(s=new za(t,e),i.get(n).push(s)):s=i.get(n)[r],s},dispose:function(){i=new WeakMap}}}function Ba(t){zr.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function ja(t){zr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new fn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}Ba.prototype=Object.create(zr.prototype),Ba.prototype.constructor=Ba,Ba.prototype.isMeshDepthMaterial=!0,Ba.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},ja.prototype=Object.create(zr.prototype),ja.prototype.constructor=ja,ja.prototype.isMeshDistanceMaterial=!0,ja.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};function Ha(t,e,i){let n=new Us;const r=new rn,s=new rn,o=new un,a=[],c=[],h={},l={0:1,1:0,2:2},u=new Os({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new rn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=u.clone();d.defines.HORIZONTAL_PASS=1;const p=new hs;p.setAttribute("position",new Hr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new Es(p,u),m=this;function g(i,n){const r=e.update(f);u.uniforms.shadow_pass.value=i.map.texture,u.uniforms.resolution.value=i.mapSize,u.uniforms.radius.value=i.radius,t.setRenderTarget(i.mapPass),t.clear(),t.renderBufferDirect(n,null,r,u,f,null),d.uniforms.shadow_pass.value=i.mapPass.texture,d.uniforms.resolution.value=i.mapSize,d.uniforms.radius.value=i.radius,t.setRenderTarget(i.map),t.clear(),t.renderBufferDirect(n,null,r,d,f,null)}function _(t,e,i){const n=t<<0|e<<1|i<<2;let r=a[n];return void 0===r&&(r=new Ba({depthPacking:3201,morphTargets:t,skinning:e}),a[n]=r),r}function v(t,e,i){const n=t<<0|e<<1|i<<2;let r=c[n];return void 0===r&&(r=new ja({morphTargets:t,skinning:e}),c[n]=r),r}function y(e,i,n,r,s,o,a){let c=null,u=_,d=e.customDepthMaterial;if(!0===r.isPointLight&&(u=v,d=e.customDistanceMaterial),void 0===d){let t=!1;!0===n.morphTargets&&(t=i.morphAttributes&&i.morphAttributes.position&&i.morphAttributes.position.length>0);let r=!1;!0===e.isSkinnedMesh&&(!0===n.skinning?r=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e));c=u(t,r,!0===e.isInstancedMesh)}else c=d;if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){const t=c.uuid,e=n.uuid;let i=h[t];void 0===i&&(i={},h[t]=i);let r=i[e];void 0===r&&(r=c.clone(),i[e]=r),c=r}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:l[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,!0===r.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(r.matrixWorld),c.nearDistance=s,c.farDistance=o),c}function b(i,r,s,o,a){if(!1===i.visible)return;if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===a)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,i.matrixWorld);const n=e.update(i),r=i.material;if(Array.isArray(r)){const e=n.groups;for(let c=0,h=e.length;c<h;c++){const h=e[c],l=r[h.materialIndex];if(l&&l.visible){const e=y(i,n,l,o,s.near,s.far,a);t.renderBufferDirect(s,null,n,e,i,h)}}}else if(r.visible){const e=y(i,n,r,o,s.near,s.far,a);t.renderBufferDirect(s,null,n,e,i,null)}}const c=i.children;for(let t=0,e=c.length;t<e;t++)b(c[t],r,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,a,c){if(!1===m.enabled)return;if(!1===m.autoUpdate&&!1===m.needsUpdate)return;if(0===e.length)return;const h=t.getRenderTarget(),l=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let h=0,l=e.length;h<l;h++){const l=e[h],u=l.shadow;if(void 0===u){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;r.copy(u.mapSize);const p=u.getFrameExtents();if(r.multiply(p),s.copy(u.mapSize),(r.x>i||r.y>i)&&(r.x>i&&(s.x=Math.floor(i/p.x),r.x=s.x*p.x,u.mapSize.x=s.x),r.y>i&&(s.y=Math.floor(i/p.y),r.y=s.y*p.y,u.mapSize.y=s.y)),null===u.map&&!u.isPointLightShadow&&3===this.type){const t={minFilter:Ai,magFilter:Ai,format:zi};u.map=new dn(r.x,r.y,t),u.map.texture.name=l.name+".shadowMap",u.mapPass=new dn(r.x,r.y,t),u.camera.updateProjectionMatrix()}if(null===u.map){const t={minFilter:Ii,magFilter:Ii,format:zi};u.map=new dn(r.x,r.y,t),u.map.texture.name=l.name+".shadowMap",u.camera.updateProjectionMatrix()}t.setRenderTarget(u.map),t.clear();const f=u.getViewportCount();for(let t=0;t<f;t++){const e=u.getViewport(t);o.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(o),u.updateMatrices(l,t),n=u.getFrustum(),b(a,c,u.camera,l,this.type)}u.isPointLightShadow||3!==this.type||g(u,c),u.needsUpdate=!1}m.needsUpdate=!1,t.setRenderTarget(h,l,u)}}function Ua(t,e,i){const n=i.isWebGL2;const r=new function(){let e=!1;const i=new un;let n=null;const r=new un(0,0,0,0);return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,s,o,a){!0===a&&(e*=o,n*=o,s*=o),i.set(e,n,s,o),!1===r.equals(i)&&(t.clearColor(e,n,s,o),r.copy(i))},reset:function(){e=!1,n=null,r.set(-1,0,0,0)}}},s=new function(){let e=!1,i=null,n=null,r=null;return{setTest:function(t){t?O(2929):N(2929)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}},o=new function(){let e=!1,i=null,n=null,r=null,s=null,o=null,a=null,c=null,h=null;return{setTest:function(t){e||(t?O(2960):N(2960))},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,o){n===e&&r===i&&s===o||(t.stencilFunc(e,i,o),n=e,r=i,s=o)},setOp:function(e,i,n){o===e&&a===i&&c===n||(t.stencilOp(e,i,n),o=e,a=i,c=n)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,i=null,n=null,r=null,s=null,o=null,a=null,c=null,h=null}}};let a={},c=null,h=null,l=null,u=null,d=null,p=null,f=null,m=null,g=null,_=!1,v=null,y=null,b=null,x=null,w=null;const S=t.getParameter(35661);let M=!1,T=0;const C=t.getParameter(7938);-1!==C.indexOf("WebGL")?(T=parseFloat(/^WebGL (\d)/.exec(C)[1]),M=T>=1):-1!==C.indexOf("OpenGL ES")&&(T=parseFloat(/^OpenGL ES (\d)/.exec(C)[1]),M=T>=2);let E=null,I={};const A=new un,P=new un;function R(e,i,n){const r=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<n;e++)t.texImage2D(i+e,0,6408,1,1,0,6408,5121,r);return s}const L={};function O(e){!0!==a[e]&&(t.enable(e),a[e]=!0)}function N(e){!1!==a[e]&&(t.disable(e),a[e]=!1)}L[3553]=R(3553,3553,1),L[34067]=R(34067,34069,6),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),O(2929),s.setFunc(3),z(!1),F(1),O(2884),k(0);const D={[Mi]:32774,101:32778,102:32779};if(n)D[103]=32775,D[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(D[103]=t.MIN_EXT,D[104]=t.MAX_EXT)}const $={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function k(e,i,n,r,s,o,a,c){if(0!==e){if(h||(O(3042),h=!0),5===e)s=s||i,o=o||n,a=a||r,i===u&&s===f||(t.blendEquationSeparate(D[i],D[s]),u=i,f=s),n===d&&r===p&&o===m&&a===g||(t.blendFuncSeparate($[n],$[r],$[o],$[a]),d=n,p=r,m=o,g=a),l=e,_=null;else if(e!==l||c!==_){if(u===Mi&&f===Mi||(t.blendEquation(32774),u=Mi,f=Mi),c)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}d=null,p=null,m=null,g=null,l=e,_=c}}else h&&(N(3042),h=!1)}function z(e){v!==e&&(e?t.frontFace(2304):t.frontFace(2305),v=e)}function F(e){0!==e?(O(2884),e!==y&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):N(2884),y=e}function B(e,i,n){e?(O(32823),x===i&&w===n||(t.polygonOffset(i,n),x=i,w=n)):N(32823)}function j(e){void 0===e&&(e=33984+S-1),E!==e&&(t.activeTexture(e),E=e)}return{buffers:{color:r,depth:s,stencil:o},enable:O,disable:N,useProgram:function(e){return c!==e&&(t.useProgram(e),c=e,!0)},setBlending:k,setMaterial:function(t,e){2===t.side?N(2884):O(2884);let i=1===t.side;e&&(i=!i),z(i),1===t.blending&&!1===t.transparent?k(0):k(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),r.setMask(t.colorWrite);const n=t.stencilWrite;o.setTest(n),n&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),B(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:z,setCullFace:F,setLineWidth:function(e){e!==b&&(M&&t.lineWidth(e),b=e)},setPolygonOffset:B,setScissorTest:function(t){t?O(3089):N(3089)},activeTexture:j,bindTexture:function(e,i){null===E&&j();let n=I[E];void 0===n&&(n={type:void 0,texture:void 0},I[E]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||L[e]),n.type=e,n.texture=i)},unbindTexture:function(){const e=I[E];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===A.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),A.copy(e))},viewport:function(e){!1===P.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),P.copy(e))},reset:function(){a={},E=null,I={},c=null,h=null,l=null,u=null,d=null,p=null,f=null,m=null,g=null,_=!1,v=null,y=null,b=null,x=null,w=null,r.reset(),s.reset(),o.reset()}}}function Va(t,e,i,n,r,s,o){const a=r.isWebGL2,c=r.maxTextures,h=r.maxCubemapSize,l=r.maxTextureSize,u=r.maxSamples,d=new WeakMap;let p,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function m(t,e){return f?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,i,n){let r=1;if((t.width>n||t.height>n)&&(r=n/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const n=e?nn.floorPowerOfTwo:Math.floor,s=n(r*t.width),o=n(r*t.height);void 0===p&&(p=m(s,o));const a=i?m(s,o):p;a.width=s,a.height=o;return a.getContext("2d").drawImage(t,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+s+"x"+o+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function _(t){return nn.isPowerOfTwo(t.width)&&nn.isPowerOfTwo(t.height)}function v(t,e){return t.generateMipmaps&&e&&t.minFilter!==Ii&&t.minFilter!==Ai}function y(e,i,r,s){t.generateMipmap(e);n.get(i).__maxMipLevel=Math.log(Math.max(r,s))*Math.LOG2E}function b(i,n,r){if(!1===a)return n;if(null!==i){if(void 0!==t[i])return t[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}let s=n;return 6403===n&&(5126===r&&(s=33326),5131===r&&(s=33325),5121===r&&(s=33321)),6407===n&&(5126===r&&(s=34837),5131===r&&(s=34843),5121===r&&(s=32849)),6408===n&&(5126===r&&(s=34836),5131===r&&(s=34842),5121===r&&(s=32856)),33325!==s&&33326!==s&&34842!==s&&34836!==s||e.get("EXT_color_buffer_float"),s}function x(t){return t===Ii||1004===t||1005===t?9728:9729}function w(e){const i=e.target;i.removeEventListener("dispose",w),function(e){const i=n.get(e);if(void 0===i.__webglInit)return;t.deleteTexture(i.__webglTexture),n.remove(e)}(i),i.isVideoTexture&&d.delete(i),o.memory.textures--}function S(e){const i=e.target;i.removeEventListener("dispose",S),function(e){const i=n.get(e),r=n.get(e.texture);if(!e)return;void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(i.__webglFramebuffer[e]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[e]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&t.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer);n.remove(e.texture),n.remove(e)}(i),o.memory.textures--}let M=0;function T(t,e){const r=n.get(t);if(t.isVideoTexture&&function(t){const e=o.render.frame;d.get(t)!==e&&(d.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){const i=t.image;if(void 0===i)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==i.complete)return void R(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+e),i.bindTexture(3553,r.__webglTexture)}function C(e,r){const o=n.get(e);e.version>0&&o.__version!==e.version?function(e,n,r){if(6!==n.image.length)return;P(e,n),i.activeTexture(33984+r),i.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment);const o=n&&(n.isCompressedTexture||n.image[0].isCompressedTexture),c=n.image[0]&&n.image[0].isDataTexture,l=[];for(let t=0;t<6;t++)l[t]=o||c?c?n.image[t].image:n.image[t]:g(n.image[t],!1,!0,h);const u=l[0],d=_(u)||a,p=s.convert(n.format),f=s.convert(n.type),m=b(n.internalFormat,p,f);let x;if(A(34067,n,d),o){for(let t=0;t<6;t++){x=l[t].mipmaps;for(let e=0;e<x.length;e++){const r=x[e];n.format!==zi&&n.format!==ki?null!==p?i.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+t,e,m,r.width,r.height,0,p,f,r.data)}}e.__maxMipLevel=x.length-1}else{x=n.mipmaps;for(let t=0;t<6;t++)if(c){i.texImage2D(34069+t,0,m,l[t].width,l[t].height,0,p,f,l[t].data);for(let e=0;e<x.length;e++){const n=x[e].image[t].image;i.texImage2D(34069+t,e+1,m,n.width,n.height,0,p,f,n.data)}}else{i.texImage2D(34069+t,0,m,p,f,l[t]);for(let e=0;e<x.length;e++){const n=x[e];i.texImage2D(34069+t,e+1,m,p,f,n.image[t])}}e.__maxMipLevel=x.length}v(n,d)&&y(34067,n,u.width,u.height);e.__version=n.version,n.onUpdate&&n.onUpdate(n)}(o,e,r):(i.activeTexture(33984+r),i.bindTexture(34067,o.__webglTexture))}const E={[Ti]:10497,[Ci]:33071,[Ei]:33648},I={[Ii]:9728,1004:9984,1005:9986,[Ai]:9729,1007:9985,[Pi]:9987};function A(i,s,o){o?(t.texParameteri(i,10242,E[s.wrapS]),t.texParameteri(i,10243,E[s.wrapT]),32879!==i&&35866!==i||t.texParameteri(i,32882,E[s.wrapR]),t.texParameteri(i,10240,I[s.magFilter]),t.texParameteri(i,10241,I[s.minFilter])):(t.texParameteri(i,10242,33071),t.texParameteri(i,10243,33071),32879!==i&&35866!==i||t.texParameteri(i,32882,33071),s.wrapS===Ci&&s.wrapT===Ci||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(i,10240,x(s.magFilter)),t.texParameteri(i,10241,x(s.minFilter)),s.minFilter!==Ii&&s.minFilter!==Ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const c=e.get("EXT_texture_filter_anisotropic");if(c){if(s.type===Ni&&null===e.get("OES_texture_float_linear"))return;if(s.type===Di&&null===(a||e.get("OES_texture_half_float_linear")))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(t.texParameterf(i,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function P(e,i){void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",w),e.__webglTexture=t.createTexture(),o.memory.textures++)}function R(e,n,r){let o=3553;n.isDataTexture2DArray&&(o=35866),n.isDataTexture3D&&(o=32879),P(e,n),i.activeTexture(33984+r),i.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment);const c=function(t){return!a&&(t.wrapS!==Ci||t.wrapT!==Ci||t.minFilter!==Ii&&t.minFilter!==Ai)}(n)&&!1===_(n.image),h=g(n.image,c,!1,l),u=_(h)||a,d=s.convert(n.format);let p,f=s.convert(n.type),m=b(n.internalFormat,d,f);A(o,n,u);const x=n.mipmaps;if(n.isDepthTexture)m=6402,a?m=n.type===Ni?36012:n.type===Oi?33190:n.type===$i?35056:33189:n.type===Ni&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),n.format===Fi&&6402===m&&n.type!==Li&&n.type!==Oi&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Li,f=s.convert(n.type)),n.format===Bi&&6402===m&&(m=34041,n.type!==$i&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=$i,f=s.convert(n.type))),i.texImage2D(3553,0,m,h.width,h.height,0,d,f,null);else if(n.isDataTexture)if(x.length>0&&u){for(let t=0,e=x.length;t<e;t++)p=x[t],i.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);n.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else i.texImage2D(3553,0,m,h.width,h.height,0,d,f,h.data),e.__maxMipLevel=0;else if(n.isCompressedTexture){for(let t=0,e=x.length;t<e;t++)p=x[t],n.format!==zi&&n.format!==ki?null!==d?i.compressedTexImage2D(3553,t,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);e.__maxMipLevel=x.length-1}else if(n.isDataTexture2DArray)i.texImage3D(35866,0,m,h.width,h.height,h.depth,0,d,f,h.data),e.__maxMipLevel=0;else if(n.isDataTexture3D)i.texImage3D(32879,0,m,h.width,h.height,h.depth,0,d,f,h.data),e.__maxMipLevel=0;else if(x.length>0&&u){for(let t=0,e=x.length;t<e;t++)p=x[t],i.texImage2D(3553,t,m,d,f,p);n.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else i.texImage2D(3553,0,m,d,f,h),e.__maxMipLevel=0;v(n,u)&&y(o,n,h.width,h.height),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}function L(e,r,o,a){const c=s.convert(r.texture.format),h=s.convert(r.texture.type),l=b(r.texture.internalFormat,c,h);i.texImage2D(a,0,l,r.width,r.height,0,c,h,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,o,a,n.get(r.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function O(e,i,n){if(t.bindRenderbuffer(36161,e),i.depthBuffer&&!i.stencilBuffer){let r=33189;if(n){const e=i.depthTexture;e&&e.isDepthTexture&&(e.type===Ni?r=36012:e.type===Oi&&(r=33190));const n=D(i);t.renderbufferStorageMultisample(36161,n,r,i.width,i.height)}else t.renderbufferStorage(36161,r,i.width,i.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(i.depthBuffer&&i.stencilBuffer){if(n){const e=D(i);t.renderbufferStorageMultisample(36161,e,35056,i.width,i.height)}else t.renderbufferStorage(36161,34041,i.width,i.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=s.convert(i.texture.format),r=s.convert(i.texture.type),o=b(i.texture.internalFormat,e,r);if(n){const e=D(i);t.renderbufferStorageMultisample(36161,e,o,i.width,i.height)}else t.renderbufferStorage(36161,o,i.width,i.height)}t.bindRenderbuffer(36161,null)}function N(e){const i=n.get(e),r=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),T(i.depthTexture,0);const r=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===Fi)t.framebufferTexture2D(36160,36096,3553,r,0);else{if(i.depthTexture.format!==Bi)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,r,0)}}(i.__webglFramebuffer,e)}else if(r){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)t.bindFramebuffer(36160,i.__webglFramebuffer[n]),i.__webglDepthbuffer[n]=t.createRenderbuffer(),O(i.__webglDepthbuffer[n],e,!1)}else t.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),O(i.__webglDepthbuffer,e,!1);t.bindFramebuffer(36160,null)}function D(t){return a&&t.isWebGLMultisampleRenderTarget?Math.min(u,t.samples):0}let $=!1,k=!1;this.allocateTextureUnit=function(){const t=M;return t>=c&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+c),M+=1,t},this.resetTextureUnits=function(){M=0},this.setTexture2D=T,this.setTexture2DArray=function(t,e){const r=n.get(t);t.version>0&&r.__version!==t.version?R(r,t,e):(i.activeTexture(33984+e),i.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=n.get(t);t.version>0&&r.__version!==t.version?R(r,t,e):(i.activeTexture(33984+e),i.bindTexture(32879,r.__webglTexture))},this.setTextureCube=C,this.setupRenderTarget=function(e){const r=n.get(e),c=n.get(e.texture);e.addEventListener("dispose",S),c.__webglTexture=t.createTexture(),o.memory.textures++;const h=!0===e.isWebGLCubeRenderTarget,l=!0===e.isWebGLMultisampleRenderTarget,u=_(e)||a;if(!a||e.texture.format!==ki||e.texture.type!==Ni&&e.texture.type!==Di||(e.texture.format=zi,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){r.__webglFramebuffer=[];for(let e=0;e<6;e++)r.__webglFramebuffer[e]=t.createFramebuffer()}else if(r.__webglFramebuffer=t.createFramebuffer(),l)if(a){r.__webglMultisampledFramebuffer=t.createFramebuffer(),r.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,r.__webglColorRenderbuffer);const i=s.convert(e.texture.format),n=s.convert(e.texture.type),o=b(e.texture.internalFormat,i,n),a=D(e);t.renderbufferStorageMultisample(36161,a,o,e.width,e.height),t.bindFramebuffer(36160,r.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,r.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(r.__webglDepthRenderbuffer=t.createRenderbuffer(),O(r.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){i.bindTexture(34067,c.__webglTexture),A(34067,e.texture,u);for(let t=0;t<6;t++)L(r.__webglFramebuffer[t],e,36064,34069+t);v(e.texture,u)&&y(34067,e.texture,e.width,e.height),i.bindTexture(34067,null)}else i.bindTexture(3553,c.__webglTexture),A(3553,e.texture,u),L(r.__webglFramebuffer,e,36064,3553),v(e.texture,u)&&y(3553,e.texture,e.width,e.height),i.bindTexture(3553,null);e.depthBuffer&&N(e)},this.updateRenderTargetMipmap=function(t){const e=t.texture;if(v(e,_(t)||a)){const r=t.isWebGLCubeRenderTarget?34067:3553,s=n.get(e).__webglTexture;i.bindTexture(r,s),y(r,e,t.width,t.height),i.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(a){const i=n.get(e);t.bindFramebuffer(36008,i.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,i.__webglFramebuffer);const r=e.width,s=e.height;let o=16384;e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024),t.blitFramebuffer(0,0,r,s,0,0,r,s,o,9728),t.bindFramebuffer(36160,i.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===$&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),$=!0),t=t.texture),T(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===k&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),k=!0),t=t.texture),C(t,e)}}function Ga(t,e,i){const n=i.isWebGL2;return{convert:function(t){let i;if(t===Ri)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(t===Li)return 5123;if(1013===t)return 5124;if(t===Oi)return 5125;if(t===Ni)return 5126;if(t===Di)return n?5131:(i=e.get("OES_texture_half_float"),null!==i?i.HALF_FLOAT_OES:null);if(1021===t)return 6406;if(t===ki)return 6407;if(t===zi)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(t===Fi)return 6402;if(t===Bi)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(i=e.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(33776===t)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(i=e.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(35840===t)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return i=e.get("WEBGL_compressed_texture_etc1"),null!==i?i.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(i=e.get("WEBGL_compressed_texture_etc"),null!==i)){if(37492===t)return i.COMPRESSED_RGB8_ETC2;if(37496===t)return i.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?(i=e.get("WEBGL_compressed_texture_astc"),null!==i?t:null):36492===t?(i=e.get("EXT_texture_compression_bptc"),null!==i?t:null):t===$i?n?34042:(i=e.get("WEBGL_depth_texture"),null!==i?i.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function qa(t=[]){Ds.call(this),this.cameras=t}function Wa(){pr.call(this),this.type="Group"}function Xa(){this._targetRay=null,this._grip=null,this._hand=null}function Ya(t,e){const i=this;let n=null,r=1,s=null,o="local-floor",a=null;const c=[],h=new Map,l=new Ds;l.layers.enable(1),l.viewport=new un;const u=new Ds;u.layers.enable(2),u.viewport=new un;const d=[l,u],p=new qa;p.layers.enable(1),p.layers.enable(2);let f=null,m=null;function g(t){const e=h.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function _(){h.forEach((function(t,e){t.disconnect(e)})),h.clear(),f=null,m=null,t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),S.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function v(t){const e=n.inputSources;for(let t=0;t<c.length;t++)h.set(e[t],c[t]);for(let e=0;e<t.removed.length;e++){const i=t.removed[e],n=h.get(i);n&&(n.dispatchEvent({type:"disconnected",data:i}),h.delete(i))}for(let e=0;e<t.added.length;e++){const i=t.added[e],n=h.get(i);n&&n.dispatchEvent({type:"connected",data:i})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=c[t];return void 0===e&&(e=new Xa,c[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=c[t];return void 0===e&&(e=new Xa,c[t]=e),e.getGripSpace()},this.getHand=function(t){let e=c[t];return void 0===e&&(e=new Xa,c[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){o=t,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getSession=function(){return n},this.setSession=async function(t){if(n=t,null!==n){n.addEventListener("select",g),n.addEventListener("selectstart",g),n.addEventListener("selectend",g),n.addEventListener("squeeze",g),n.addEventListener("squeezestart",g),n.addEventListener("squeezeend",g),n.addEventListener("end",_),n.addEventListener("inputsourceschange",v);const t=e.getContextAttributes();!0!==t.xrCompatible&&await e.makeXRCompatible();const a={antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:r},c=new XRWebGLLayer(n,e,a);n.updateRenderState({baseLayer:c}),s=await n.requestReferenceSpace(o),S.setContext(n),S.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};const y=new fn,b=new fn;function x(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.getCamera=function(t){p.near=u.near=l.near=t.near,p.far=u.far=l.far=t.far,f===p.near&&m===p.far||(n.updateRenderState({depthNear:p.near,depthFar:p.far}),f=p.near,m=p.far);const e=t.parent,i=p.cameras;x(p,e);for(let t=0;t<i.length;t++)x(i[t],e);t.matrixWorld.copy(p.matrixWorld),t.matrix.copy(p.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);const r=t.children;for(let t=0,e=r.length;t<e;t++)r[t].updateMatrixWorld(!0);return 2===i.length?function(t,e,i){y.setFromMatrixPosition(e.matrixWorld),b.setFromMatrixPosition(i.matrixWorld);const n=y.distanceTo(b),r=e.projectionMatrix.elements,s=i.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),c=(r[9]+1)/r[5],h=(r[9]-1)/r[5],l=(r[8]-1)/r[0],u=(s[8]+1)/s[0],d=o*l,p=o*u,f=n/(-l+u),m=f*-l;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=o+f,_=a+f,v=d-m,x=p+(n-m),w=c*a/_*g,S=h*a/_*g;t.projectionMatrix.makePerspective(v,x,w,S,g,_)}(p,l,u):p.projectionMatrix.copy(l.projectionMatrix),p};let w=null;const S=new Vs;S.setAnimationLoop((function(e,i){if(a=i.getViewerPose(s),null!==a){const e=a.views,i=n.renderState.baseLayer;t.setFramebuffer(i.framebuffer);let r=!1;e.length!==p.cameras.length&&(p.cameras.length=0,r=!0);for(let t=0;t<e.length;t++){const n=e[t],s=i.getViewport(n),o=d[t];o.matrix.fromArray(n.transform.matrix),o.projectionMatrix.fromArray(n.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===t&&p.matrix.copy(o.matrix),!0===r&&p.cameras.push(o)}}const r=n.inputSources;for(let t=0;t<c.length;t++){const e=c[t],n=r[t];e.update(n,i,s)}w&&w(e,i)})),this.setAnimationLoop=function(t){w=t},this.dispose=function(){}}function Za(t){function e(e,i){e.opacity.value=i.opacity,i.color&&e.diffuse.value.copy(i.color),i.emissive&&e.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(e.map.value=i.map),i.alphaMap&&(e.alphaMap.value=i.alphaMap),i.specularMap&&(e.specularMap.value=i.specularMap);const n=t.get(i).envMap;if(n){e.envMap.value=n,e.flipEnvMap.value=n.isCubeTexture&&n._needsFlipEnvMap?-1:1,e.reflectivity.value=i.reflectivity,e.refractionRatio.value=i.refractionRatio;const r=t.get(n).__maxMipLevel;void 0!==r&&(e.maxMipLevel.value=r)}let r,s;i.lightMap&&(e.lightMap.value=i.lightMap,e.lightMapIntensity.value=i.lightMapIntensity),i.aoMap&&(e.aoMap.value=i.aoMap,e.aoMapIntensity.value=i.aoMapIntensity),i.map?r=i.map:i.specularMap?r=i.specularMap:i.displacementMap?r=i.displacementMap:i.normalMap?r=i.normalMap:i.bumpMap?r=i.bumpMap:i.roughnessMap?r=i.roughnessMap:i.metalnessMap?r=i.metalnessMap:i.alphaMap?r=i.alphaMap:i.emissiveMap?r=i.emissiveMap:i.clearcoatMap?r=i.clearcoatMap:i.clearcoatNormalMap?r=i.clearcoatNormalMap:i.clearcoatRoughnessMap&&(r=i.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),i.aoMap?s=i.aoMap:i.lightMap&&(s=i.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),e.uv2Transform.value.copy(s.matrix))}function i(e,i){e.roughness.value=i.roughness,e.metalness.value=i.metalness,i.roughnessMap&&(e.roughnessMap.value=i.roughnessMap),i.metalnessMap&&(e.metalnessMap.value=i.metalnessMap),i.emissiveMap&&(e.emissiveMap.value=i.emissiveMap),i.bumpMap&&(e.bumpMap.value=i.bumpMap,e.bumpScale.value=i.bumpScale,1===i.side&&(e.bumpScale.value*=-1)),i.normalMap&&(e.normalMap.value=i.normalMap,e.normalScale.value.copy(i.normalScale),1===i.side&&e.normalScale.value.negate()),i.displacementMap&&(e.displacementMap.value=i.displacementMap,e.displacementScale.value=i.displacementScale,e.displacementBias.value=i.displacementBias);t.get(i).envMap&&(e.envMapIntensity.value=i.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,n,r,s){n.isMeshBasicMaterial?e(t,n):n.isMeshLambertMaterial?(e(t,n),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,n)):n.isMeshToonMaterial?(e(t,n),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap);e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,n)):n.isMeshPhongMaterial?(e(t,n),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,n)):n.isMeshStandardMaterial?(e(t,n),n.isMeshPhysicalMaterial?function(t,e){i(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen);e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap);e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap);e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate());t.transmission.value=e.transmission,e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap)}(t,n):i(t,n)):n.isMeshMatcapMaterial?(e(t,n),function(t,e){e.matcap&&(t.matcap.value=e.matcap);e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,n)):n.isMeshDepthMaterial?(e(t,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,n)):n.isMeshDistanceMaterial?(e(t,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,n)):n.isMeshNormalMaterial?(e(t,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1));e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate());e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,n)):n.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,n),n.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,n)):n.isPointsMaterial?function(t,e,i,n){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*i,t.scale.value=.5*n,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);let r;e.map?r=e.map:e.alphaMap&&(r=e.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,n,r,s):n.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);let i;e.map?i=e.map:e.alphaMap&&(i=e.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}(t,n):n.isShadowMaterial?(t.color.value.copy(n.color),t.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function Ja(t){const e=void 0!==(t=t||{}).canvas?t.canvas:function(){const t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.style.display="block",t}(),i=void 0!==t.context?t.context:null,n=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,s=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,c=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,h=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let u=null,d=null;const p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Xi,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const f=this;let m=!1,g=null,_=0,v=0,y=null,b=null,x=-1,w=null;const S=new un,M=new un;let T=null,C=e.width,E=e.height,I=1,A=null,P=null;const R=new un(0,0,C,E),L=new un(0,0,C,E);let O=!1;const N=new Us;let D=!1,$=!1;const k=new Hn,z=new fn,F={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function B(){return null===y?I:1}let j,H,U,V,G,q,W,X,Y,Z,J,K,Q,tt,et,it,nt,rt,st,ot,at,ct=i;function ht(t,i){for(let n=0;n<t.length;n++){const r=t[n],s=e.getContext(r,i);if(null!==s)return s}return null}try{const t={alpha:n,depth:r,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:l};if(e.addEventListener("webglcontextlost",pt,!1),e.addEventListener("webglcontextrestored",ft,!1),null===ct){const e=["webgl2","webgl","experimental-webgl"];if(!0===f.isWebGL1Renderer&&e.shift(),ct=ht(e,t),null===ct)throw ht(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ct.getShaderPrecisionFormat&&(ct.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function lt(){j=new io(ct),H=new Qs(ct,j,t),j.init(H),ot=new Ga(ct,j,H),U=new Ua(ct,j,H),U.scissor(M.copy(L).multiplyScalar(I).floor()),U.viewport(S.copy(R).multiplyScalar(I).floor()),V=new so(ct),G=new Aa,q=new Va(ct,j,U,G,H,ot,V),W=new eo(f),X=new Gs(ct,H),at=new Js(ct,j,X,H),Y=new no(ct,X,V,at),Z=new ho(ct,Y,X,V),nt=new co(ct),et=new to(G),J=new Ia(f,W,j,H,at,et),K=new Za(G),Q=new Oa(G),tt=new Fa(j,H),it=new Zs(f,W,U,Z,a),rt=new Ks(ct,j,V,H),st=new ro(ct,j,V,H),V.programs=J.programs,f.capabilities=H,f.extensions=j,f.properties=G,f.renderLists=Q,f.state=U,f.info=V}lt();const ut=new Ya(f,ct);this.xr=ut;const dt=new Ha(f,Z,H.maxTextureSize);function pt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function ft(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1,lt()}function mt(t){const e=t.target;e.removeEventListener("dispose",mt),function(t){gt(t),G.remove(t)}(e)}function gt(t){const e=G.get(t).program;void 0!==e&&J.releaseProgram(e)}this.shadowMap=dt,this.getContext=function(){return ct},this.getContextAttributes=function(){return ct.getContextAttributes()},this.forceContextLoss=function(){const t=j.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=j.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(t){void 0!==t&&(I=t,this.setSize(C,E,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new rn),t.set(C,E)},this.setSize=function(t,i,n){ut.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(C=t,E=i,e.width=Math.floor(t*I),e.height=Math.floor(i*I),!1!==n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new rn),t.set(C*I,E*I).floor()},this.setDrawingBufferSize=function(t,i,n){C=t,E=i,I=n,e.width=Math.floor(t*n),e.height=Math.floor(i*n),this.setViewport(0,0,t,i)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new un),t.copy(S)},this.getViewport=function(t){return t.copy(R)},this.setViewport=function(t,e,i,n){t.isVector4?R.set(t.x,t.y,t.z,t.w):R.set(t,e,i,n),U.viewport(S.copy(R).multiplyScalar(I).floor())},this.getScissor=function(t){return t.copy(L)},this.setScissor=function(t,e,i,n){t.isVector4?L.set(t.x,t.y,t.z,t.w):L.set(t,e,i,n),U.scissor(M.copy(L).multiplyScalar(I).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(t){U.setScissorTest(O=t)},this.setOpaqueSort=function(t){A=t},this.setTransparentSort=function(t){P=t},this.getClearColor=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),t=new Dr),t.copy(it.getClearColor())},this.setClearColor=function(){it.setClearColor.apply(it,arguments)},this.getClearAlpha=function(){return it.getClearAlpha()},this.setClearAlpha=function(){it.setClearAlpha.apply(it,arguments)},this.clear=function(t,e,i){let n=0;(void 0===t||t)&&(n|=16384),(void 0===e||e)&&(n|=256),(void 0===i||i)&&(n|=1024),ct.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",pt,!1),e.removeEventListener("webglcontextrestored",ft,!1),Q.dispose(),tt.dispose(),G.dispose(),W.dispose(),Z.dispose(),at.dispose(),ut.dispose(),vt.stop()},this.renderBufferImmediate=function(t,e){at.initAttributes();const i=G.get(t);t.hasPositions&&!i.position&&(i.position=ct.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=ct.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=ct.createBuffer()),t.hasColors&&!i.color&&(i.color=ct.createBuffer());const n=e.getAttributes();t.hasPositions&&(ct.bindBuffer(34962,i.position),ct.bufferData(34962,t.positionArray,35048),at.enableAttribute(n.position),ct.vertexAttribPointer(n.position,3,5126,!1,0,0)),t.hasNormals&&(ct.bindBuffer(34962,i.normal),ct.bufferData(34962,t.normalArray,35048),at.enableAttribute(n.normal),ct.vertexAttribPointer(n.normal,3,5126,!1,0,0)),t.hasUvs&&(ct.bindBuffer(34962,i.uv),ct.bufferData(34962,t.uvArray,35048),at.enableAttribute(n.uv),ct.vertexAttribPointer(n.uv,2,5126,!1,0,0)),t.hasColors&&(ct.bindBuffer(34962,i.color),ct.bufferData(34962,t.colorArray,35048),at.enableAttribute(n.color),ct.vertexAttribPointer(n.color,3,5126,!1,0,0)),at.disableUnusedAttributes(),ct.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,s){null===e&&(e=F);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=St(t,e,n,r);U.setMaterial(n,o);let c=i.index;const h=i.attributes.position;if(null===c){if(void 0===h||0===h.count)return}else if(0===c.count)return;let l,u=1;!0===n.wireframe&&(c=Y.getWireframeAttribute(i),u=2),(n.morphTargets||n.morphNormals)&&nt.update(r,i,n,a),at.setup(r,n,a,i,c);let d=rt;null!==c&&(l=X.get(c),d=st,d.setIndex(l));const p=null!==c?c.count:h.count,f=i.drawRange.start*u,m=i.drawRange.count*u,g=null!==s?s.start*u:0,_=null!==s?s.count*u:1/0,v=Math.max(f,g),y=Math.min(p,f+m,g+_)-1,b=Math.max(0,y-v+1);if(0!==b){if(r.isMesh)!0===n.wireframe?(U.setLineWidth(n.wireframeLinewidth*B()),d.setMode(1)):d.setMode(4);else if(r.isLine){let t=n.linewidth;void 0===t&&(t=1),U.setLineWidth(t*B()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(v,b,r.count);else if(i.isInstancedBufferGeometry){const t=Math.min(i.instanceCount,i._maxInstanceCount);d.renderInstances(v,b,t)}else d.render(v,b)}},this.compile=function(t,e){d=tt.get(t),d.init(),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights();const i=new WeakMap;t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];!1===i.has(s)&&(wt(s,t,e),i.set(s))}else!1===i.has(n)&&(wt(n,t,e),i.set(n))}))};let _t=null;const vt=new Vs;function yt(t,e,i,n){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)i=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||N.intersectsSprite(t)){n&&z.setFromMatrixPosition(t.matrixWorld).applyMatrix4(k);const e=Z.update(t),r=t.material;r.visible&&u.push(t,e,r,i,z.z,null)}}else if(t.isImmediateRenderObject)n&&z.setFromMatrixPosition(t.matrixWorld).applyMatrix4(k),u.push(t,null,t.material,i,z.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==V.render.frame&&(t.skeleton.update(),t.skeleton.frame=V.render.frame),!t.frustumCulled||N.intersectsObject(t))){n&&z.setFromMatrixPosition(t.matrixWorld).applyMatrix4(k);const e=Z.update(t),r=t.material;if(Array.isArray(r)){const n=e.groups;for(let s=0,o=n.length;s<o;s++){const o=n[s],a=r[o.materialIndex];a&&a.visible&&u.push(t,e,a,i,z.z,o)}}else r.visible&&u.push(t,e,r,i,z.z,null)}const r=t.children;for(let t=0,s=r.length;t<s;t++)yt(r[t],e,i,n)}function bt(t,e,i){const n=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.object,a=s.geometry,c=null===n?s.material:n,h=s.group;if(i.isArrayCamera){const t=i.cameras;for(let i=0,n=t.length;i<n;i++){const n=t[i];o.layers.test(n.layers)&&(U.viewport(S.copy(n.viewport)),d.setupLightsView(n),xt(o,e,n,a,c,h))}}else xt(o,e,i,a,c,h)}}function xt(t,e,i,n,r,s){if(t.onBeforeRender(f,e,i,n,r,s),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){const n=St(i,e,r,t);U.setMaterial(r),at.reset(),function(t,e){t.render((function(t){f.renderBufferImmediate(t,e)}))}(t,n)}else f.renderBufferDirect(i,e,n,r,t,s);t.onAfterRender(f,e,i,n,r,s)}function wt(t,e,i){!0!==e.isScene&&(e=F);const n=G.get(t),r=d.state.lights,s=d.state.shadowsArray,o=r.state.version,a=J.getParameters(t,r.state,s,e,i),c=J.getProgramCacheKey(a);let h=n.program,l=!0;if(n.environment=t.isMeshStandardMaterial?e.environment:null,n.fog=e.fog,n.envMap=W.get(t.envMap||n.environment),void 0===h)t.addEventListener("dispose",mt);else if(h.cacheKey!==c)gt(t);else if(n.lightsStateVersion!==o)l=!1;else{if(void 0!==a.shaderID)return;l=!1}l&&(a.uniforms=J.getUniforms(t),t.onBeforeCompile(a,f),h=J.acquireProgram(a,c),n.program=h,n.uniforms=a.uniforms,n.outputEncoding=a.outputEncoding);const u=n.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=et.numPlanes,n.numIntersection=et.numIntersection,u.clippingPlanes=et.uniform),n.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),n.lightsStateVersion=o,n.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotShadowMatrix.value=r.state.spotShadowMatrix,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);const p=n.program.getUniforms(),m=aa.seqWithValue(p.seq,u);n.uniformsList=m}function St(t,e,i,n){!0!==e.isScene&&(e=F),q.resetTextureUnits();const r=e.fog,s=i.isMeshStandardMaterial?e.environment:null,o=null===y?f.outputEncoding:y.texture.encoding,a=W.get(i.envMap||s),c=G.get(i),h=d.state.lights;if(!0===D&&(!0===$||t!==w)){const e=t===w&&i.id===x;et.setState(i,t,e)}i.version===c.__version?i.fog&&c.fog!==r||c.environment!==s||c.needsLights&&c.lightsStateVersion!==h.state.version?wt(i,e,n):void 0===c.numClippingPlanes||c.numClippingPlanes===et.numPlanes&&c.numIntersection===et.numIntersection?(c.outputEncoding!==o||c.envMap!==a)&&wt(i,e,n):wt(i,e,n):(wt(i,e,n),c.__version=i.version);let l=!1,u=!1,p=!1;const m=c.program,g=m.getUniforms(),_=c.uniforms;if(U.useProgram(m.program)&&(l=!0,u=!0,p=!0),i.id!==x&&(x=i.id,u=!0),l||w!==t){if(g.setValue(ct,"projectionMatrix",t.projectionMatrix),H.logarithmicDepthBuffer&&g.setValue(ct,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),w!==t&&(w=t,u=!0,p=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const e=g.map.cameraPosition;void 0!==e&&e.setValue(ct,z.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&g.setValue(ct,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||i.skinning)&&g.setValue(ct,"viewMatrix",t.matrixWorldInverse)}if(i.skinning){g.setOptional(ct,n,"bindMatrix"),g.setOptional(ct,n,"bindMatrixInverse");const t=n.skeleton;if(t){const e=t.bones;if(H.floatVertexTextures){if(null===t.boneTexture){let i=Math.sqrt(4*e.length);i=nn.ceilPowerOfTwo(i),i=Math.max(i,4);const n=new Float32Array(i*i*4);n.set(t.boneMatrices);const r=new Bs(n,i,i,zi,Ni);t.boneMatrices=n,t.boneTexture=r,t.boneTextureSize=i}g.setValue(ct,"boneTexture",t.boneTexture,q),g.setValue(ct,"boneTextureSize",t.boneTextureSize)}else g.setOptional(ct,t,"boneMatrices")}}var v,b;return(u||c.receiveShadow!==n.receiveShadow)&&(c.receiveShadow=n.receiveShadow,g.setValue(ct,"receiveShadow",n.receiveShadow)),u&&(g.setValue(ct,"toneMappingExposure",f.toneMappingExposure),c.needsLights&&(b=p,(v=_).ambientLightColor.needsUpdate=b,v.lightProbe.needsUpdate=b,v.directionalLights.needsUpdate=b,v.directionalLightShadows.needsUpdate=b,v.pointLights.needsUpdate=b,v.pointLightShadows.needsUpdate=b,v.spotLights.needsUpdate=b,v.spotLightShadows.needsUpdate=b,v.rectAreaLights.needsUpdate=b,v.hemisphereLights.needsUpdate=b),r&&i.fog&&K.refreshFogUniforms(_,r),K.refreshMaterialUniforms(_,i,I,E),aa.upload(ct,c.uniformsList,_,q)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(aa.upload(ct,c.uniformsList,_,q),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&g.setValue(ct,"center",n.center),g.setValue(ct,"modelViewMatrix",n.modelViewMatrix),g.setValue(ct,"normalMatrix",n.normalMatrix),g.setValue(ct,"modelMatrix",n.matrixWorld),m}vt.setAnimationLoop((function(t){ut.isPresenting||_t&&_t(t)})),"undefined"!=typeof window&&vt.setContext(window),this.setAnimationLoop=function(t){_t=t,ut.setAnimationLoop(t),null===t?vt.stop():vt.start()},this.render=function(t,e){let i,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===m)return;at.resetDefaultState(),x=-1,w=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===ut.enabled&&!0===ut.isPresenting&&(e=ut.getCamera(e)),!0===t.isScene&&t.onBeforeRender(f,t,e,i||y),d=tt.get(t,p.length),d.init(),p.push(d),k.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),N.setFromProjectionMatrix(k),$=this.localClippingEnabled,D=et.init(this.clippingPlanes,$,e),u=Q.get(t,e),u.init(),yt(t,e,0,f.sortObjects),u.finish(),!0===f.sortObjects&&u.sort(A,P),!0===D&&et.beginShadows();const r=d.state.shadowsArray;dt.render(r,t,e),d.setupLights(),d.setupLightsView(e),!0===D&&et.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),it.render(u,t,e,n);const s=u.opaque,o=u.transparent;s.length>0&&bt(s,t,e),o.length>0&&bt(o,t,e),!0===t.isScene&&t.onAfterRender(f,t,e),null!==y&&(q.updateRenderTargetMipmap(y),q.updateMultisampleRenderTarget(y)),U.buffers.depth.setTest(!0),U.buffers.depth.setMask(!0),U.buffers.color.setMask(!0),U.setPolygonOffset(!1),p.pop(),d=p.length>0?p[p.length-1]:null,u=null},this.setFramebuffer=function(t){g!==t&&null===y&&ct.bindFramebuffer(36160,t),g=t},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return v},this.getRenderList=function(){return u},this.setRenderList=function(t){u=t},this.getRenderTarget=function(){return y},this.setRenderTarget=function(t,e=0,i=0){y=t,_=e,v=i,t&&void 0===G.get(t).__webglFramebuffer&&q.setupRenderTarget(t);let n=g,r=!1;if(t){const i=G.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(n=i[e],r=!0):n=t.isWebGLMultisampleRenderTarget?G.get(t).__webglMultisampledFramebuffer:i,S.copy(t.viewport),M.copy(t.scissor),T=t.scissorTest}else S.copy(R).multiplyScalar(I).floor(),M.copy(L).multiplyScalar(I).floor(),T=O;if(b!==n&&(ct.bindFramebuffer(36160,n),b=n),U.viewport(S),U.scissor(M),U.setScissorTest(T),r){const n=G.get(t.texture);ct.framebufferTexture2D(36160,36064,34069+e,n.__webglTexture,i)}},this.readRenderTargetPixels=function(t,e,i,n,r,s,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=G.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){let o=!1;a!==b&&(ct.bindFramebuffer(36160,a),o=!0);try{const a=t.texture,c=a.format,h=a.type;if(c!==zi&&ot.convert(c)!==ct.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const l=h===Di&&(j.has("EXT_color_buffer_half_float")||H.isWebGL2&&j.has("EXT_color_buffer_float"));if(!(h===Ri||ot.convert(h)===ct.getParameter(35738)||h===Ni&&(H.isWebGL2||j.has("OES_texture_float")||j.has("WEBGL_color_buffer_float"))||l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ct.checkFramebufferStatus(36160)?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&ct.readPixels(e,i,n,r,ot.convert(c),ot.convert(h),s):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{o&&ct.bindFramebuffer(36160,b)}}},this.copyFramebufferToTexture=function(t,e,i=0){const n=Math.pow(2,-i),r=Math.floor(e.image.width*n),s=Math.floor(e.image.height*n),o=ot.convert(e.format);q.setTexture2D(e,0),ct.copyTexImage2D(3553,i,o,t.x,t.y,r,s,0),U.unbindTexture()},this.copyTextureToTexture=function(t,e,i,n=0){const r=e.image.width,s=e.image.height,o=ot.convert(i.format),a=ot.convert(i.type);q.setTexture2D(i,0),ct.pixelStorei(37440,i.flipY),ct.pixelStorei(37441,i.premultiplyAlpha),ct.pixelStorei(3317,i.unpackAlignment),e.isDataTexture?ct.texSubImage2D(3553,n,t.x,t.y,r,s,o,a,e.image.data):e.isCompressedTexture?ct.compressedTexSubImage2D(3553,n,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):ct.texSubImage2D(3553,n,t.x,t.y,o,a,e.image),0===n&&i.generateMipmaps&&ct.generateMipmap(3553),U.unbindTexture()},this.initTexture=function(t){q.setTexture2D(t,0),U.unbindTexture()},this.resetState=function(){U.reset(),at.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ka(t){Ja.call(this,t)}qa.prototype=Object.assign(Object.create(Ds.prototype),{constructor:qa,isArrayCamera:!0}),Wa.prototype=Object.assign(Object.create(pr.prototype),{constructor:Wa,isGroup:!0}),Object.assign(Xa.prototype,{constructor:Xa,getHandSpace:function(){return null===this._hand&&(this._hand=new Wa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Wa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Wa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,e,i){let n=null,r=null,s=null;const o=this._targetRay,a=this._grip,c=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(c&&t.hand){s=!0;for(const n of t.hand.values()){const t=e.getJointPose(n,i);if(void 0===c.joints[n.jointName]){const t=new Wa;t.matrixAutoUpdate=!1,t.visible=!1,c.joints[n.jointName]=t,c.add(t)}const r=c.joints[n.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const n=c.joints["index-finger-tip"],r=c.joints["thumb-tip"],o=n.position.distanceTo(r.position),a=.02,h=.005;c.inputState.pinching&&o>a+h?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&o<=a-h&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&(n=e.getPose(t.targetRaySpace,i),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),null!==a&&t.gripSpace&&(r=e.getPose(t.gripSpace,i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)));return null!==o&&(o.visible=null!==n),null!==a&&(a.visible=null!==r),null!==c&&(c.visible=null!==s),this}}),Object.assign(Ya.prototype,Qi.prototype),Ka.prototype=Object.assign(Object.create(Ja.prototype),{constructor:Ka,isWebGL1Renderer:!0});class Qa extends pr{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.environment&&(e.object.environment=this.environment.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}function tc(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Zi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=nn.generateUUID()}Object.defineProperty(tc.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(tc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(let n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e=0){return this.array.set(t,e),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=nn.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new tc(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=nn.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const ec=new fn;function ic(t,e,i,n){this.name="",this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}function nc(t){zr.call(this),this.type="SpriteMaterial",this.color=new Dr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let rc;Object.defineProperties(ic.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(ic.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let e=0,i=this.data.count;e<i;e++)ec.x=this.getX(e),ec.y=this.getY(e),ec.z=this.getZ(e),ec.applyMatrix4(t),this.setXYZ(e,ec.x,ec.y,ec.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return new Hr(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new ic(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const i=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[i+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),nc.prototype=Object.create(zr.prototype),nc.prototype.constructor=nc,nc.prototype.isSpriteMaterial=!0,nc.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const sc=new fn,oc=new fn,ac=new fn,cc=new rn,hc=new rn,lc=new Hn,uc=new fn,dc=new fn,pc=new fn,fc=new rn,mc=new rn,gc=new rn;function _c(t){if(pr.call(this),this.type="Sprite",void 0===rc){rc=new hs;const t=new tc(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);rc.setIndex([0,1,2,0,2,3]),rc.setAttribute("position",new ic(t,3,0,!1)),rc.setAttribute("uv",new ic(t,2,3,!1))}this.geometry=rc,this.material=void 0!==t?t:new nc,this.center=new rn(.5,.5)}function vc(t,e,i,n,r,s){cc.subVectors(t,i).addScalar(.5).multiply(n),void 0!==r?(hc.x=s*cc.x-r*cc.y,hc.y=r*cc.x+s*cc.y):hc.copy(cc),t.copy(e),t.x+=hc.x,t.y+=hc.y,t.applyMatrix4(lc)}_c.prototype=Object.assign(Object.create(pr.prototype),{constructor:_c,isSprite:!0,raycast:function(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),oc.setFromMatrixScale(this.matrixWorld),lc.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),ac.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&oc.multiplyScalar(-ac.z);const i=this.material.rotation;let n,r;0!==i&&(r=Math.cos(i),n=Math.sin(i));const s=this.center;vc(uc.set(-.5,-.5,0),ac,s,oc,n,r),vc(dc.set(.5,-.5,0),ac,s,oc,n,r),vc(pc.set(.5,.5,0),ac,s,oc,n,r),fc.set(0,0),mc.set(1,0),gc.set(1,1);let o=t.ray.intersectTriangle(uc,dc,pc,!1,sc);if(null===o&&(vc(dc.set(-.5,.5,0),ac,s,oc,n,r),mc.set(0,1),o=t.ray.intersectTriangle(uc,pc,dc,!1,sc),null===o))return;const a=t.ray.origin.distanceTo(sc);a<t.near||a>t.far||e.push({distance:a,point:sc.clone(),uv:Ir.getUV(sc,uc,dc,pc,fc,mc,gc,new rn),face:null,object:this})},copy:function(t){return pr.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const yc=new fn,bc=new fn;function xc(){pr.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}xc.prototype=Object.assign(Object.create(pr.prototype),{constructor:xc,isLOD:!0,copy:function(t){pr.prototype.copy.call(this,t,!1);const e=t.levels;for(let t=0,i=e.length;t<i;t++){const i=e[t];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,e=0){e=Math.abs(e);const i=this.levels;let n;for(n=0;n<i.length&&!(e<i[n].distance);n++);return i.splice(n,0,{distance:e,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const e=this.levels;if(e.length>0){let i,n;for(i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object}return null},raycast:function(t,e){if(this.levels.length>0){yc.setFromMatrixPosition(this.matrixWorld);const i=t.ray.origin.distanceTo(yc);this.getObjectForDistance(i).raycast(t,e)}},update:function(t){const e=this.levels;if(e.length>1){yc.setFromMatrixPosition(t.matrixWorld),bc.setFromMatrixPosition(this.matrixWorld);const i=yc.distanceTo(bc)/t.zoom;let n,r;for(e[0].object.visible=!0,n=1,r=e.length;n<r&&i>=e[n].distance;n++)e[n-1].object.visible=!1,e[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)e[n].object.visible=!1}},toJSON:function(t){const e=pr.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const i=this.levels;for(let t=0,n=i.length;t<n;t++){const n=i[t];e.object.levels.push({object:n.object.uuid,distance:n.distance})}return e}});const wc=new fn,Sc=new un,Mc=new un,Tc=new fn,Cc=new Hn;function Ec(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Es.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Hn,this.bindMatrixInverse=new Hn}function Ic(){pr.call(this),this.type="Bone"}Ec.prototype=Object.assign(Object.create(Es.prototype),{constructor:Ec,isSkinnedMesh:!0,copy:function(t){return Es.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new un,e=this.geometry.attributes.skinWeight;for(let i=0,n=e.count;i<n;i++){t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.w=e.getW(i);const n=1/t.manhattanLength();n!==1/0?t.multiplyScalar(n):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Es.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(t,e){const i=this.skeleton,n=this.geometry;Sc.fromBufferAttribute(n.attributes.skinIndex,t),Mc.fromBufferAttribute(n.attributes.skinWeight,t),wc.fromBufferAttribute(n.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const n=Mc.getComponent(t);if(0!==n){const r=Sc.getComponent(t);Cc.multiplyMatrices(i.bones[r].matrixWorld,i.boneInverses[r]),e.addScaledVector(Tc.copy(wc).applyMatrix4(Cc),n)}}return e.applyMatrix4(this.bindMatrixInverse)}}),Ic.prototype=Object.assign(Object.create(pr.prototype),{constructor:Ic,isBone:!0});const Ac=new Hn,Pc=new Hn;function Rc(t=[],e=[]){this.uuid=nn.generateUUID(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(Rc.prototype,{init:function(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new Hn)}},calculateInverses:function(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new Hn;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}},pose:function(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}},update:function(){const t=this.bones,e=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let n=0,r=t.length;n<r;n++){const r=t[n]?t[n].matrixWorld:Pc;Ac.multiplyMatrices(r,e[n]),Ac.toArray(i,16*n)}null!==n&&(n.needsUpdate=!0)},clone:function(){return new Rc(this.bones,this.boneInverses)},getBoneByName:function(t){for(let e=0,i=this.bones.length;e<i;e++){const i=this.bones[e];if(i.name===t)return i}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(t,e){this.uuid=t.uuid;for(let i=0,n=t.bones.length;i<n;i++){const n=t.bones[i];let r=e[n];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),r=new Ic),this.bones.push(r),this.boneInverses.push((new Hn).fromArray(t.boneInverses[i]))}return this.init(),this},toJSON:function(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,i=this.boneInverses;for(let n=0,r=e.length;n<r;n++){const r=e[n];t.bones.push(r.uuid);const s=i[n];t.boneInverses.push(s.toArray())}return t}});const Lc=new Hn,Oc=new Hn,Nc=[],Dc=new Es;function $c(t,e,i){Es.call(this,t,e),this.instanceMatrix=new Hr(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}function kc(t){zr.call(this),this.type="LineBasicMaterial",this.color=new Dr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}$c.prototype=Object.assign(Object.create(Es.prototype),{constructor:$c,isInstancedMesh:!0,copy:function(t){return Es.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this},getColorAt:function(t,e){e.fromArray(this.instanceColor.array,3*t)},getMatrixAt:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,e){const i=this.matrixWorld,n=this.count;if(Dc.geometry=this.geometry,Dc.material=this.material,void 0!==Dc.material)for(let r=0;r<n;r++){this.getMatrixAt(r,Lc),Oc.multiplyMatrices(i,Lc),Dc.matrixWorld=Oc,Dc.raycast(t,Nc);for(let t=0,i=Nc.length;t<i;t++){const i=Nc[t];i.instanceId=r,i.object=this,e.push(i)}Nc.length=0}},setColorAt:function(t,e){null===this.instanceColor&&(this.instanceColor=new Hr(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)},setMatrixAt:function(t,e){e.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}}),kc.prototype=Object.create(zr.prototype),kc.prototype.constructor=kc,kc.prototype.isLineBasicMaterial=!0,kc.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const zc=new fn,Fc=new fn,Bc=new Hn,jc=new jn,Hc=new On;function Uc(t=new hs,e=new kc){pr.call(this),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}Uc.prototype=Object.assign(Object.create(pr.prototype),{constructor:Uc,isLine:!0,copy:function(t){return pr.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,i=[0];for(let t=1,n=e.count;t<n;t++)zc.fromBufferAttribute(e,t-1),Fc.fromBufferAttribute(e,t),i[t]=i[t-1],i[t]+=zc.distanceTo(Fc);t.setAttribute("lineDistance",new Jr(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(t,e){const i=this.geometry,n=this.matrixWorld,r=t.params.Line.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),Hc.copy(i.boundingSphere),Hc.applyMatrix4(n),Hc.radius+=r,!1===t.ray.intersectsSphere(Hc))return;Bc.copy(n).invert(),jc.copy(t.ray).applyMatrix4(Bc);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,a=new fn,c=new fn,h=new fn,l=new fn,u=this.isLineSegments?2:1;if(i.isBufferGeometry){const n=i.index,r=i.attributes.position;if(null!==n){const i=n.array;for(let n=0,s=i.length-1;n<s;n+=u){const s=i[n],u=i[n+1];a.fromBufferAttribute(r,s),c.fromBufferAttribute(r,u);if(jc.distanceSqToSegment(a,c,l,h)>o)continue;l.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(l);d<t.near||d>t.far||e.push({distance:d,point:h.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else for(let i=0,n=r.count-1;i<n;i+=u){a.fromBufferAttribute(r,i),c.fromBufferAttribute(r,i+1);if(jc.distanceSqToSegment(a,c,l,h)>o)continue;l.applyMatrix4(this.matrixWorld);const n=t.ray.origin.distanceTo(l);n<t.near||n>t.far||e.push({distance:n,point:h.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,i=Object.keys(e);if(i.length>0){const t=e[i[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=t.length;e<i;e++){const i=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Vc=new fn,Gc=new fn;function qc(t,e){Uc.call(this,t,e),this.type="LineSegments"}function Wc(t,e){Uc.call(this,t,e),this.type="LineLoop"}function Xc(t){zr.call(this),this.type="PointsMaterial",this.color=new Dr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}qc.prototype=Object.assign(Object.create(Uc.prototype),{constructor:qc,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,i=[];for(let t=0,n=e.count;t<n;t+=2)Vc.fromBufferAttribute(e,t),Gc.fromBufferAttribute(e,t+1),i[t]=0===t?0:i[t-1],i[t+1]=i[t]+Vc.distanceTo(Gc);t.setAttribute("lineDistance",new Jr(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}),Wc.prototype=Object.assign(Object.create(Uc.prototype),{constructor:Wc,isLineLoop:!0}),Xc.prototype=Object.create(zr.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isPointsMaterial=!0,Xc.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const Yc=new Hn,Zc=new jn,Jc=new On,Kc=new fn;function Qc(t=new hs,e=new Xc){pr.call(this),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}function th(t,e,i,n,r,s,o){const a=Zc.distanceSqToPoint(t);if(a<i){const i=new fn;Zc.closestPointToPoint(t,i),i.applyMatrix4(n);const c=r.ray.origin.distanceTo(i);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:i,index:e,face:null,object:o})}}function eh(t,e,i,n,r,s,o,a,c){hn.call(this,t,e,i,n,r,s,o,a,c),this.format=void 0!==o?o:ki,this.minFilter=void 0!==s?s:Ai,this.magFilter=void 0!==r?r:Ai,this.generateMipmaps=!1;const h=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){h.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}function ih(t,e,i,n,r,s,o,a,c,h,l,u){hn.call(this,null,s,o,a,c,h,n,r,l,u),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function nh(t,e,i,n,r,s,o,a,c){hn.call(this,t,e,i,n,r,s,o,a,c),this.needsUpdate=!0}function rh(t,e,i,n,r,s,o,a,c,h){if((h=void 0!==h?h:Fi)!==Fi&&h!==Bi)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&h===Fi&&(i=Li),void 0===i&&h===Bi&&(i=$i),hn.call(this,null,n,r,s,o,a,h,i,c),this.image={width:t,height:e},this.magFilter=void 0!==o?o:Ii,this.minFilter=void 0!==a?a:Ii,this.flipY=!1,this.generateMipmaps=!1}Qc.prototype=Object.assign(Object.create(pr.prototype),{constructor:Qc,isPoints:!0,copy:function(t){return pr.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,e){const i=this.geometry,n=this.matrixWorld,r=t.params.Points.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),Jc.copy(i.boundingSphere),Jc.applyMatrix4(n),Jc.radius+=r,!1===t.ray.intersectsSphere(Jc))return;Yc.copy(n).invert(),Zc.copy(t.ray).applyMatrix4(Yc);const s=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s;if(i.isBufferGeometry){const r=i.index,s=i.attributes.position;if(null!==r){const i=r.array;for(let r=0,a=i.length;r<a;r++){const a=i[r];Kc.fromBufferAttribute(s,a),th(Kc,a,o,n,t,e,this)}}else for(let i=0,r=s.count;i<r;i++)Kc.fromBufferAttribute(s,i),th(Kc,i,o,n,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,i=Object.keys(e);if(i.length>0){const t=e[i[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=t.length;e<i;e++){const i=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),eh.prototype=Object.assign(Object.create(hn.prototype),{constructor:eh,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const t=this.image;!1==="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ih.prototype=Object.create(hn.prototype),ih.prototype.constructor=ih,ih.prototype.isCompressedTexture=!0,nh.prototype=Object.create(hn.prototype),nh.prototype.constructor=nh,nh.prototype.isCanvasTexture=!0,rh.prototype=Object.create(hn.prototype),rh.prototype.constructor=rh,rh.prototype.isDepthTexture=!0;class sh extends hs{constructor(t=1,e=8,i=0,n=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},e=Math.max(3,e);const r=[],s=[],o=[],a=[],c=new fn,h=new rn;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let r=0,l=3;r<=e;r++,l+=3){const u=i+r/e*n;c.x=t*Math.cos(u),c.y=t*Math.sin(u),s.push(c.x,c.y,c.z),o.push(0,0,1),h.x=(s[l]/t+1)/2,h.y=(s[l+1]/t+1)/2,a.push(h.x,h.y)}for(let t=1;t<=e;t++)r.push(t,t+1,0);this.setIndex(r),this.setAttribute("position",new Jr(s,3)),this.setAttribute("normal",new Jr(o,3)),this.setAttribute("uv",new Jr(a,2))}}new fn,new fn,new fn,new Ir;const oh=function(t,e,i){i=i||2;const n=e&&e.length,r=n?e[0]*i:t.length;let s=ah(t,0,r,i,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,h,l,u,d,p;if(n&&(s=function(t,e,i,n){const r=[];let s,o,a,c,h;for(s=0,o=e.length;s<o;s++)a=e[s]*n,c=s<o-1?e[s+1]*n:t.length,h=ah(t,a,c,n,!1),h===h.next&&(h.steiner=!0),r.push(vh(h));for(r.sort(fh),s=0;s<r.length;s++)mh(r[s],i),i=ch(i,i.next);return i}(t,e,s,i)),t.length>80*i){a=h=t[0],c=l=t[1];for(let e=i;e<r;e+=i)u=t[e],d=t[e+1],u<a&&(a=u),d<c&&(c=d),u>h&&(h=u),d>l&&(l=d);p=Math.max(h-a,l-c),p=0!==p?1/p:0}return hh(s,o,i,a,c,p),o};function ah(t,e,i,n,r){let s,o;if(r===function(t,e,i,n){let r=0;for(let s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}(t,e,i,n)>0)for(s=e;s<i;s+=n)o=Ih(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=Ih(s,t[s],t[s+1],o);return o&&wh(o,o.next)&&(Ah(o),o=o.next),o}function ch(t,e){if(!t)return t;e||(e=t);let i,n=t;do{if(i=!1,n.steiner||!wh(n,n.next)&&0!==xh(n.prev,n,n.next))n=n.next;else{if(Ah(n),n=e=n.prev,n===n.next)break;i=!0}}while(i||n!==e);return e}function hh(t,e,i,n,r,s,o){if(!t)return;!o&&s&&function(t,e,i,n){let r=t;do{null===r.z&&(r.z=_h(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,i,n,r,s,o,a,c,h=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<h&&(a++,n=n.nextZ,n);e++);for(c=h;a>0||c>0&&n;)0!==a&&(0===c||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,h*=2}while(o>1)}(r)}(t,n,r,s);let a,c,h=t;for(;t.prev!==t.next;)if(a=t.prev,c=t.next,s?uh(t,n,r,s):lh(t))e.push(a.i/i),e.push(t.i/i),e.push(c.i/i),Ah(t),t=c.next,h=c.next;else if((t=c)===h){o?1===o?hh(t=dh(ch(t),e,i),e,i,n,r,s,2):2===o&&ph(t,e,i,n,r,s):hh(ch(t),e,i,n,r,s,1);break}}function lh(t){const e=t.prev,i=t,n=t.next;if(xh(e,i,n)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(yh(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&xh(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function uh(t,e,i,n){const r=t.prev,s=t,o=t.next;if(xh(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,c=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,u=_h(a,c,e,i,n),d=_h(h,l,e,i,n);let p=t.prevZ,f=t.nextZ;for(;p&&p.z>=u&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&yh(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&xh(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&yh(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&xh(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&yh(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&xh(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&yh(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&xh(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function dh(t,e,i){let n=t;do{const r=n.prev,s=n.next.next;!wh(r,s)&&Sh(r,n,n.next,s)&&Ch(r,s)&&Ch(s,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(s.i/i),Ah(n),Ah(n.next),n=t=s),n=n.next}while(n!==t);return ch(n)}function ph(t,e,i,n,r,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&bh(o,t)){let a=Eh(o,t);return o=ch(o,o.next),a=ch(a,a.next),hh(o,e,i,n,r,s),void hh(a,e,i,n,r,s)}t=t.next}o=o.next}while(o!==t)}function fh(t,e){return t.x-e.x}function mh(t,e){if(e=function(t,e){let i=e;const n=t.x,r=t.y;let s,o=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){const t=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=n&&t>o){if(o=t,t===n){if(r===i.y)return i;if(r===i.next.y)return i.next}s=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!s)return null;if(n===o)return s;const a=s,c=s.x,h=s.y;let l,u=1/0;i=s;do{n>=i.x&&i.x>=c&&n!==i.x&&yh(r<h?n:o,r,c,h,r<h?o:n,r,i.x,i.y)&&(l=Math.abs(r-i.y)/(n-i.x),Ch(i,t)&&(l<u||l===u&&(i.x>s.x||i.x===s.x&&gh(s,i)))&&(s=i,u=l)),i=i.next}while(i!==a);return s}(t,e)){const i=Eh(e,t);ch(e,e.next),ch(i,i.next)}}function gh(t,e){return xh(t.prev,t,e.prev)<0&&xh(e.next,t,t.next)<0}function _h(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function vh(t){let e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function yh(t,e,i,n,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(n-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(r-o)*(n-a)>=0}function bh(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Sh(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(Ch(t,e)&&Ch(e,t)&&function(t,e){let i=t,n=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(xh(t.prev,t,e.prev)||xh(t,e.prev,e))||wh(t,e)&&xh(t.prev,t,t.next)>0&&xh(e.prev,e,e.next)>0)}function xh(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function wh(t,e){return t.x===e.x&&t.y===e.y}function Sh(t,e,i,n){const r=Th(xh(t,e,i)),s=Th(xh(t,e,n)),o=Th(xh(i,n,t)),a=Th(xh(i,n,e));return r!==s&&o!==a||(!(0!==r||!Mh(t,i,e))||(!(0!==s||!Mh(t,n,e))||(!(0!==o||!Mh(i,t,n))||!(0!==a||!Mh(i,e,n)))))}function Mh(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Th(t){return t>0?1:t<0?-1:0}function Ch(t,e){return xh(t.prev,t,t.next)<0?xh(t,e,t.next)>=0&&xh(t,t.prev,e)>=0:xh(t,e,t.prev)<0||xh(t,t.next,e)<0}function Eh(t,e){const i=new Ph(t.i,t.x,t.y),n=new Ph(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function Ih(t,e,i,n){const r=new Ph(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Ah(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ph(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const Rh={area:function(t){const e=t.length;let i=0;for(let n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return Rh.area(t)<0},triangulateShape:function(t,e){const i=[],n=[],r=[];Lh(t),Oh(i,t);let s=t.length;e.forEach(Lh);for(let t=0;t<e.length;t++)n.push(s),s+=e[t].length,Oh(i,e[t]);const o=oh(i,n);for(let t=0;t<o.length;t+=3)r.push(o.slice(t,t+3));return r}};function Lh(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Oh(t,e){for(let i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}class Nh extends hs{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const i=this,n=[],r=[];for(let e=0,i=t.length;e<i;e++){s(t[e])}function s(t){const s=[],o=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let c=void 0!==e.depth?e.depth:100,h=void 0===e.bevelEnabled||e.bevelEnabled,l=void 0!==e.bevelThickness?e.bevelThickness:6,u=void 0!==e.bevelSize?e.bevelSize:l-2,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:Dh;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=e.amount);let g,_,v,y,b,x=!1;f&&(g=f.getSpacedPoints(a),x=!0,h=!1,_=f.computeFrenetFrames(a,!1),v=new fn,y=new fn,b=new fn),h||(p=0,l=0,u=0,d=0);const w=t.extractPoints(o);let S=w.shape;const M=w.holes;if(!Rh.isClockWise(S)){S=S.reverse();for(let t=0,e=M.length;t<e;t++){const e=M[t];Rh.isClockWise(e)&&(M[t]=e.reverse())}}const T=Rh.triangulateShape(S,M),C=S;for(let t=0,e=M.length;t<e;t++){const e=M[t];S=S.concat(e)}function E(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}const I=S.length,A=T.length;function P(t,e,i){let n,r,s;const o=t.x-e.x,a=t.y-e.y,c=i.x-t.x,h=i.y-t.y,l=o*o+a*a,u=o*h-a*c;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(l),d=Math.sqrt(c*c+h*h),p=e.x-a/u,f=e.y+o/u,m=((i.x-h/d-p)*h-(i.y+c/d-f)*c)/(o*h-a*c);n=p+o*m-t.x,r=f+a*m-t.y;const g=n*n+r*r;if(g<=2)return new rn(n,r);s=Math.sqrt(g/2)}else{let t=!1;o>Number.EPSILON?c>Number.EPSILON&&(t=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(h)&&(t=!0),t?(n=-a,r=o,s=Math.sqrt(l)):(n=o,r=a,s=Math.sqrt(l/2))}return new rn(n/s,r/s)}const R=[];for(let t=0,e=C.length,i=e-1,n=t+1;t<e;t++,i++,n++)i===e&&(i=0),n===e&&(n=0),R[t]=P(C[t],C[i],C[n]);const L=[];let O,N=R.concat();for(let t=0,e=M.length;t<e;t++){const e=M[t];O=[];for(let t=0,i=e.length,n=i-1,r=t+1;t<i;t++,n++,r++)n===i&&(n=0),r===i&&(r=0),O[t]=P(e[t],e[n],e[r]);L.push(O),N=N.concat(O)}for(let t=0;t<p;t++){const e=t/p,i=l*Math.cos(e*Math.PI/2),n=u*Math.sin(e*Math.PI/2)+d;for(let t=0,e=C.length;t<e;t++){const e=E(C[t],R[t],n);k(e.x,e.y,-i)}for(let t=0,e=M.length;t<e;t++){const e=M[t];O=L[t];for(let t=0,r=e.length;t<r;t++){const r=E(e[t],O[t],n);k(r.x,r.y,-i)}}}const D=u+d;for(let t=0;t<I;t++){const e=h?E(S[t],N[t],D):S[t];x?(y.copy(_.normals[0]).multiplyScalar(e.x),v.copy(_.binormals[0]).multiplyScalar(e.y),b.copy(g[0]).add(y).add(v),k(b.x,b.y,b.z)):k(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<I;e++){const i=h?E(S[e],N[e],D):S[e];x?(y.copy(_.normals[t]).multiplyScalar(i.x),v.copy(_.binormals[t]).multiplyScalar(i.y),b.copy(g[t]).add(y).add(v),k(b.x,b.y,b.z)):k(i.x,i.y,c/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,i=l*Math.cos(e*Math.PI/2),n=u*Math.sin(e*Math.PI/2)+d;for(let t=0,e=C.length;t<e;t++){const e=E(C[t],R[t],n);k(e.x,e.y,c+i)}for(let t=0,e=M.length;t<e;t++){const e=M[t];O=L[t];for(let t=0,r=e.length;t<r;t++){const r=E(e[t],O[t],n);x?k(r.x,r.y+g[a-1].y,g[a-1].x+i):k(r.x,r.y,c+i)}}}function $(t,e){let i=t.length;for(;--i>=0;){const n=i;let r=i-1;r<0&&(r=t.length-1);for(let t=0,i=a+2*p;t<i;t++){const i=I*t,s=I*(t+1);F(e+n+i,e+r+i,e+r+s,e+n+s)}}}function k(t,e,i){s.push(t),s.push(e),s.push(i)}function z(t,e,r){B(t),B(e),B(r);const s=n.length/3,o=m.generateTopUV(i,n,s-3,s-2,s-1);j(o[0]),j(o[1]),j(o[2])}function F(t,e,r,s){B(t),B(e),B(s),B(e),B(r),B(s);const o=n.length/3,a=m.generateSideWallUV(i,n,o-6,o-3,o-2,o-1);j(a[0]),j(a[1]),j(a[3]),j(a[1]),j(a[2]),j(a[3])}function B(t){n.push(s[3*t+0]),n.push(s[3*t+1]),n.push(s[3*t+2])}function j(t){r.push(t.x),r.push(t.y)}!function(){const t=n.length/3;if(h){let t=0,e=I*t;for(let t=0;t<A;t++){const i=T[t];z(i[2]+e,i[1]+e,i[0]+e)}t=a+2*p,e=I*t;for(let t=0;t<A;t++){const i=T[t];z(i[0]+e,i[1]+e,i[2]+e)}}else{for(let t=0;t<A;t++){const e=T[t];z(e[2],e[1],e[0])}for(let t=0;t<A;t++){const e=T[t];z(e[0]+I*a,e[1]+I*a,e[2]+I*a)}}i.addGroup(t,n.length/3-t,0)}(),function(){const t=n.length/3;let e=0;$(C,e),e+=C.length;for(let t=0,i=M.length;t<i;t++){const i=M[t];$(i,e),e+=i.length}i.addGroup(t,n.length/3-t,1)}()}this.setAttribute("position",new Jr(n,3)),this.setAttribute("uv",new Jr(r,2)),this.computeVertexNormals()}toJSON(){const t=hs.prototype.toJSON.call(this);return function(t,e,i){if(i.shapes=[],Array.isArray(t))for(let e=0,n=t.length;e<n;e++){const n=t[e];i.shapes.push(n.uuid)}else i.shapes.push(t.uuid);void 0!==e.extrudePath&&(i.options.extrudePath=e.extrudePath.toJSON());return i}(this.parameters.shapes,this.parameters.options,t)}}const Dh={generateTopUV:function(t,e,i,n,r){const s=e[3*i],o=e[3*i+1],a=e[3*n],c=e[3*n+1],h=e[3*r],l=e[3*r+1];return[new rn(s,o),new rn(a,c),new rn(h,l)]},generateSideWallUV:function(t,e,i,n,r,s){const o=e[3*i],a=e[3*i+1],c=e[3*i+2],h=e[3*n],l=e[3*n+1],u=e[3*n+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*s],g=e[3*s+1],_=e[3*s+2];return Math.abs(a-l)<.01?[new rn(o,1-c),new rn(h,1-u),new rn(d,1-f),new rn(m,1-_)]:[new rn(a,1-c),new rn(l,1-u),new rn(p,1-f),new rn(g,1-_)]}};function $h(t,e,i){hs.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i};const n=[],r=[],s=[],o=[],a=1e-5,c=new fn,h=new fn,l=new fn,u=new fn,d=new fn;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const p=e+1;for(let n=0;n<=i;n++){const p=n/i;for(let i=0;i<=e;i++){const n=i/e;t(n,p,h),r.push(h.x,h.y,h.z),n-a>=0?(t(n-a,p,l),u.subVectors(h,l)):(t(n+a,p,l),u.subVectors(l,h)),p-a>=0?(t(n,p-a,l),d.subVectors(h,l)):(t(n,p+a,l),d.subVectors(l,h)),c.crossVectors(u,d).normalize(),s.push(c.x,c.y,c.z),o.push(n,p)}}for(let t=0;t<i;t++)for(let i=0;i<e;i++){const e=t*p+i,r=t*p+i+1,s=(t+1)*p+i+1,o=(t+1)*p+i;n.push(e,r,o),n.push(r,s,o)}this.setIndex(n),this.setAttribute("position",new Jr(r,3)),this.setAttribute("normal",new Jr(s,3)),this.setAttribute("uv",new Jr(o,2))}$h.prototype=Object.create(hs.prototype),$h.prototype.constructor=$h;class kh extends hs{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const i=[],n=[],r=[],s=[];let o=0,a=0;if(!1===Array.isArray(t))c(t);else for(let e=0;e<t.length;e++)c(t[e]),this.addGroup(o,a,e),o+=a,a=0;function c(t){const o=n.length/3,c=t.extractPoints(e);let h=c.shape;const l=c.holes;!1===Rh.isClockWise(h)&&(h=h.reverse());for(let t=0,e=l.length;t<e;t++){const e=l[t];!0===Rh.isClockWise(e)&&(l[t]=e.reverse())}const u=Rh.triangulateShape(h,l);for(let t=0,e=l.length;t<e;t++){const e=l[t];h=h.concat(e)}for(let t=0,e=h.length;t<e;t++){const e=h[t];n.push(e.x,e.y,0),r.push(0,0,1),s.push(e.x,e.y)}for(let t=0,e=u.length;t<e;t++){const e=u[t],n=e[0]+o,r=e[1]+o,s=e[2]+o;i.push(n,r,s),a+=3}}this.setIndex(i),this.setAttribute("position",new Jr(n,3)),this.setAttribute("normal",new Jr(r,3)),this.setAttribute("uv",new Jr(s,2))}toJSON(){const t=hs.prototype.toJSON.call(this);return function(t,e){if(e.shapes=[],Array.isArray(t))for(let i=0,n=t.length;i<n;i++){const n=t[i];e.shapes.push(n.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}}class zh extends hs{constructor(t=1,e=8,i=6,n=0,r=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));const a=Math.min(s+o,Math.PI);let c=0;const h=[],l=new fn,u=new fn,d=[],p=[],f=[],m=[];for(let d=0;d<=i;d++){const g=[],_=d/i;let v=0;0==d&&0==s?v=.5/e:d==i&&a==Math.PI&&(v=-.5/e);for(let i=0;i<=e;i++){const a=i/e;l.x=-t*Math.cos(n+a*r)*Math.sin(s+_*o),l.y=t*Math.cos(s+_*o),l.z=t*Math.sin(n+a*r)*Math.sin(s+_*o),p.push(l.x,l.y,l.z),u.copy(l).normalize(),f.push(u.x,u.y,u.z),m.push(a+v,1-_),g.push(c++)}h.push(g)}for(let t=0;t<i;t++)for(let n=0;n<e;n++){const e=h[t][n+1],r=h[t][n],o=h[t+1][n],c=h[t+1][n+1];(0!==t||s>0)&&d.push(e,r,c),(t!==i-1||a<Math.PI)&&d.push(r,o,c)}this.setIndex(d),this.setAttribute("position",new Jr(p,3)),this.setAttribute("normal",new Jr(f,3)),this.setAttribute("uv",new Jr(m,2))}}function Fh(t){zr.call(this),this.type="ShadowMaterial",this.color=new Dr(0),this.transparent=!0,this.setValues(t)}function Bh(t){Os.call(this,t),this.type="RawShaderMaterial"}function jh(t){zr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Dr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function Hh(t){jh.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new rn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=nn.clamp(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function Uh(t){zr.call(this),this.type="MeshPhongMaterial",this.color=new Dr(16777215),this.specular=new Dr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Vh(t){zr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Dr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Gh(t){zr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function qh(t){zr.call(this),this.type="MeshLambertMaterial",this.color=new Dr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Dr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Wh(t){zr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Dr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Xh(t){kc.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Fh.prototype=Object.create(zr.prototype),Fh.prototype.constructor=Fh,Fh.prototype.isShadowMaterial=!0,Fh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this},Bh.prototype=Object.create(Os.prototype),Bh.prototype.constructor=Bh,Bh.prototype.isRawShaderMaterial=!0,jh.prototype=Object.create(zr.prototype),jh.prototype.constructor=jh,jh.prototype.isMeshStandardMaterial=!0,jh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},Hh.prototype=Object.create(jh.prototype),Hh.prototype.constructor=Hh,Hh.prototype.isMeshPhysicalMaterial=!0,Hh.prototype.copy=function(t){return jh.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new Dr).copy(t.sheen):this.sheen=null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},Uh.prototype=Object.create(zr.prototype),Uh.prototype.constructor=Uh,Uh.prototype.isMeshPhongMaterial=!0,Uh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Vh.prototype=Object.create(zr.prototype),Vh.prototype.constructor=Vh,Vh.prototype.isMeshToonMaterial=!0,Vh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Gh.prototype=Object.create(zr.prototype),Gh.prototype.constructor=Gh,Gh.prototype.isMeshNormalMaterial=!0,Gh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},qh.prototype=Object.create(zr.prototype),qh.prototype.constructor=qh,qh.prototype.isMeshLambertMaterial=!0,qh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Wh.prototype=Object.create(zr.prototype),Wh.prototype.constructor=Wh,Wh.prototype.isMeshMatcapMaterial=!0,Wh.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Xh.prototype=Object.create(kc.prototype),Xh.prototype.constructor=Xh,Xh.prototype.isLineDashedMaterial=!0,Xh.prototype.copy=function(t){return kc.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Yh=Object.freeze({__proto__:null,ShadowMaterial:Fh,SpriteMaterial:nc,RawShaderMaterial:Bh,ShaderMaterial:Os,PointsMaterial:Xc,MeshPhysicalMaterial:Hh,MeshStandardMaterial:jh,MeshPhongMaterial:Uh,MeshToonMaterial:Vh,MeshNormalMaterial:Gh,MeshLambertMaterial:qh,MeshDepthMaterial:Ba,MeshDistanceMaterial:ja,MeshBasicMaterial:Fr,MeshMatcapMaterial:Wh,LineDashedMaterial:Xh,LineBasicMaterial:kc,Material:zr});const Zh={arraySlice:function(t,e,i){return Zh.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,i=new Array(e);for(let t=0;t!==e;++t)i[t]=t;return i.sort((function(e,i){return t[e]-t[i]})),i},sortedArray:function(t,e,i){const n=t.length,r=new t.constructor(n);for(let s=0,o=0;o!==n;++s){const n=i[s]*e;for(let i=0;i!==e;++i)r[o++]=t[n+i]}return r},flattenJSON:function(t,e,i,n){let r=1,s=t[0];for(;void 0!==s&&void 0===s[n];)s=t[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),i.push.apply(i,o)),s=t[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(i,i.length)),s=t[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),i.push(o)),s=t[r++]}while(void 0!==s)},subclip:function(t,e,i,n,r=30){const s=t.clone();s.name=e;const o=[];for(let t=0;t<s.tracks.length;++t){const e=s.tracks[t],a=e.getValueSize(),c=[],h=[];for(let t=0;t<e.times.length;++t){const s=e.times[t]*r;if(!(s<i||s>=n)){c.push(e.times[t]);for(let i=0;i<a;++i)h.push(e.values[t*a+i])}}0!==c.length&&(e.times=Zh.convertArray(c,e.times.constructor),e.values=Zh.convertArray(h,e.values.constructor),o.push(e))}s.tracks=o;let a=1/0;for(let t=0;t<s.tracks.length;++t)a>s.tracks[t].times[0]&&(a=s.tracks[t].times[0]);for(let t=0;t<s.tracks.length;++t)s.tracks[t].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,i=t,n=30){n<=0&&(n=30);const r=i.tracks.length,s=e/n;for(let e=0;e<r;++e){const n=i.tracks[e],r=n.ValueTypeName;if("bool"===r||"string"===r)continue;const o=t.tracks.find((function(t){return t.name===n.name&&t.ValueTypeName===r}));if(void 0===o)continue;let a=0;const c=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=c/3);let h=0;const l=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=l/3);const u=n.times.length-1;let d;if(s<=n.times[0]){const t=a,e=c-a;d=Zh.arraySlice(n.values,t,e)}else if(s>=n.times[u]){const t=u*c+a,e=t+c-a;d=Zh.arraySlice(n.values,t,e)}else{const t=n.createInterpolant(),e=a,i=c-a;t.evaluate(s),d=Zh.arraySlice(t.resultBuffer,e,i)}if("quaternion"===r){(new pn).fromArray(d).normalize().conjugate().toArray(d)}const p=o.times.length;for(let t=0;t<p;++t){const e=t*l+h;if("quaternion"===r)pn.multiplyQuaternionsFlat(o.values,e,d,0,o.values,e);else{const t=l-2*h;for(let i=0;i<t;++i)o.values[e+i]-=d[i]}}}return t.blendMode=2501,t}};function Jh(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function Kh(t,e,i,n){Jh.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Qh(t,e,i,n){Jh.call(this,t,e,i,n)}function tl(t,e,i,n){Jh.call(this,t,e,i,n)}function el(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Zh.convertArray(e,this.TimeBufferType),this.values=Zh.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function il(t,e,i){el.call(this,t,e,i)}function nl(t,e,i,n){el.call(this,t,e,i,n)}function rl(t,e,i,n){el.call(this,t,e,i,n)}function sl(t,e,i,n){Jh.call(this,t,e,i,n)}function ol(t,e,i,n){el.call(this,t,e,i,n)}function al(t,e,i,n){el.call(this,t,e,i,n)}function cl(t,e,i,n){el.call(this,t,e,i,n)}function hl(t,e=-1,i,n=2500){this.name=t,this.tracks=i,this.duration=e,this.blendMode=n,this.uuid=nn.generateUUID(),this.duration<0&&this.resetDuration()}function ll(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return rl;case"vector":case"vector2":case"vector3":case"vector4":return cl;case"color":return nl;case"quaternion":return ol;case"bool":case"boolean":return il;case"string":return al}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],i=[];Zh.flattenJSON(t.keys,e,i,"value"),t.times=e,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(Jh.prototype,{evaluate:function(t){const e=this.parameterPositions;let i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{let s;i:{n:if(!(t<n)){for(let s=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===s)break;if(r=n,n=e[++i],t<n)break e}s=e.length;break i}if(t>=r)break t;{const o=e[1];t<o&&(i=2,r=o);for(let s=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===s)break;if(n=r,r=e[--i-1],t>=r)break e}s=i,i=0}}for(;i<s;){const n=i+s>>>1;t<e[n]?s=n:i=n+1}if(n=e[i],r=e[i-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n;for(let t=0;t!==n;++t)e[t]=i[r+t];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Jh.prototype,{beforeStart_:Jh.prototype.copySampleValue_,afterEnd_:Jh.prototype.copySampleValue_}),Kh.prototype=Object.assign(Object.create(Jh.prototype),{constructor:Kh,DefaultSettings_:{endingStart:Vi,endingEnd:Vi},intervalChanged_:function(t,e,i){const n=this.parameterPositions;let r=t-2,s=t+1,o=n[r],a=n[s];if(void 0===o)switch(this.getSettings_().endingStart){case Gi:r=t,o=2*e-i;break;case qi:r=n.length-2,o=e+n[r]-n[r+1];break;default:r=t,o=i}if(void 0===a)switch(this.getSettings_().endingEnd){case Gi:s=t,a=2*i-e;break;case qi:s=1,a=i+n[1]-n[0];break;default:s=t-1,a=e}const c=.5*(i-e),h=this.valueSize;this._weightPrev=c/(e-o),this._weightNext=c/(a-i),this._offsetPrev=r*h,this._offsetNext=s*h},interpolate_:function(t,e,i,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,c=a-o,h=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,_=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,y=d*m-d*f;for(let t=0;t!==o;++t)r[t]=g*s[h+t]+_*s[c+t]+v*s[a+t]+y*s[l+t];return r}}),Qh.prototype=Object.assign(Object.create(Jh.prototype),{constructor:Qh,interpolate_:function(t,e,i,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,c=a-o,h=(i-e)/(n-e),l=1-h;for(let t=0;t!==o;++t)r[t]=s[c+t]*l+s[a+t]*h;return r}}),tl.prototype=Object.assign(Object.create(Jh.prototype),{constructor:tl,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(el,{toJSON:function(t){const e=t.constructor;let i;if(void 0!==e.toJSON)i=e.toJSON(t);else{i={name:t.name,times:Zh.convertArray(t.times,Array),values:Zh.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(i.interpolation=e)}return i.type=t.ValueTypeName,i}}),Object.assign(el.prototype,{constructor:el,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Hi,InterpolantFactoryMethodDiscrete:function(t){return new tl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Qh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Kh(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let e;switch(t){case ji:e=this.InterpolantFactoryMethodDiscrete;break;case Hi:e=this.InterpolantFactoryMethodLinear;break;case Ui:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ji;case this.InterpolantFactoryMethodLinear:return Hi;case this.InterpolantFactoryMethodSmooth:return Ui}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]+=t}return this},scale:function(t){if(1!==t){const e=this.times;for(let i=0,n=e.length;i!==n;++i)e[i]*=t}return this},trim:function(t,e){const i=this.times,n=i.length;let r=0,s=n-1;for(;r!==n&&i[r]<t;)++r;for(;-1!==s&&i[s]>e;)--s;if(++s,0!==r||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=Zh.arraySlice(i,r,s),this.values=Zh.arraySlice(this.values,r*t,s*t)}return this},validate:function(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let e=0;e!==r;e++){const n=i[e];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,n),t=!1;break}if(null!==s&&s>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,n,s),t=!1;break}s=n}if(void 0!==n&&Zh.isTypedArray(n))for(let e=0,i=n.length;e!==i;++e){const i=n[e];if(isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,i),t=!1;break}}return t},optimize:function(){const t=Zh.arraySlice(this.times),e=Zh.arraySlice(this.values),i=this.getValueSize(),n=this.getInterpolation()===Ui,r=t.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=t[o];if(a!==t[o+1]&&(1!==o||a!==t[0]))if(n)r=!0;else{const t=o*i,n=t-i,s=t+i;for(let o=0;o!==i;++o){const i=e[t+o];if(i!==e[n+o]||i!==e[s+o]){r=!0;break}}}if(r){if(o!==s){t[s]=t[o];const n=o*i,r=s*i;for(let t=0;t!==i;++t)e[r+t]=e[n+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*i,n=s*i,o=0;o!==i;++o)e[n+o]=e[t+o];++s}return s!==t.length?(this.times=Zh.arraySlice(t,0,s),this.values=Zh.arraySlice(e,0,s*i)):(this.times=t,this.values=e),this},clone:function(){const t=Zh.arraySlice(this.times,0),e=Zh.arraySlice(this.values,0),i=new(0,this.constructor)(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}}),il.prototype=Object.assign(Object.create(el.prototype),{constructor:il,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ji,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),nl.prototype=Object.assign(Object.create(el.prototype),{constructor:nl,ValueTypeName:"color"}),rl.prototype=Object.assign(Object.create(el.prototype),{constructor:rl,ValueTypeName:"number"}),sl.prototype=Object.assign(Object.create(Jh.prototype),{constructor:sl,interpolate_:function(t,e,i,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(i-e)/(n-e);let c=t*o;for(let t=c+o;c!==t;c+=4)pn.slerpFlat(r,0,s,c-o,s,c,a);return r}}),ol.prototype=Object.assign(Object.create(el.prototype),{constructor:ol,ValueTypeName:"quaternion",DefaultInterpolation:Hi,InterpolantFactoryMethodLinear:function(t){return new sl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),al.prototype=Object.assign(Object.create(el.prototype),{constructor:al,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ji,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),cl.prototype=Object.assign(Object.create(el.prototype),{constructor:cl,ValueTypeName:"vector"}),Object.assign(hl,{parse:function(t){const e=[],i=t.tracks,n=1/(t.fps||1);for(let t=0,r=i.length;t!==r;++t)e.push(ll(i[t]).scale(n));const r=new hl(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r},toJSON:function(t){const e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,n=i.length;t!==n;++t)e.push(el.toJSON(i[t]));return n},CreateFromMorphTargetSequence:function(t,e,i,n){const r=e.length,s=[];for(let t=0;t<r;t++){let o=[],a=[];o.push((t+r-1)%r,t,(t+1)%r),a.push(0,1,0);const c=Zh.getKeyframeOrder(o);o=Zh.sortedArray(o,1,c),a=Zh.sortedArray(a,1,c),n||0!==o[0]||(o.push(r),a.push(a[0])),s.push(new rl(".morphTargetInfluences["+e[t].name+"]",o,a).scale(1/i))}return new hl(t,-1,s)},findByName:function(t,e){let i=t;if(!Array.isArray(t)){const e=t;i=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<i.length;t++)if(i[t].name===e)return i[t];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){const n={},r=/^([\w-]*?)([\d]+)$/;for(let e=0,i=t.length;e<i;e++){const i=t[e],s=i.name.match(r);if(s&&s.length>1){const t=s[1];let e=n[t];e||(n[t]=e=[]),e.push(i)}}const s=[];for(const t in n)s.push(hl.CreateFromMorphTargetSequence(t,n[t],e,i));return s},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(t,e,i,n,r){if(0!==i.length){const s=[],o=[];Zh.flattenJSON(i,s,o,n),0!==s.length&&r.push(new t(e,s,o))}},n=[],r=t.name||"default",s=t.fps||30,o=t.blendMode;let a=t.length||-1;const c=t.hierarchy||[];for(let t=0;t<c.length;t++){const r=c[t].keys;if(r&&0!==r.length)if(r[0].morphTargets){const t={};let e;for(e=0;e<r.length;e++)if(r[e].morphTargets)for(let i=0;i<r[e].morphTargets.length;i++)t[r[e].morphTargets[i]]=-1;for(const i in t){const t=[],s=[];for(let n=0;n!==r[e].morphTargets.length;++n){const n=r[e];t.push(n.time),s.push(n.morphTarget===i?1:0)}n.push(new rl(".morphTargetInfluence["+i+"]",t,s))}a=t.length*(s||1)}else{const s=".bones["+e[t].name+"]";i(cl,s+".position",r,"pos",n),i(ol,s+".quaternion",r,"rot",n),i(cl,s+".scale",r,"scl",n)}}if(0===n.length)return null;return new hl(r,a,n,o)}}),Object.assign(hl.prototype,{resetDuration:function(){let t=0;for(let e=0,i=this.tracks.length;e!==i;++e){const i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new hl(this.name,this.duration,t,this.blendMode)},toJSON:function(){return hl.toJSON(this)}});const ul={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};const dl=new function(t,e,i){const n=this;let r,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===s&&void 0!==n.onStart&&n.onStart(t,o,a),s=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,a),o===a&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return c.push(t,e),this},this.removeHandler=function(t){const e=c.indexOf(t);return-1!==e&&c.splice(e,2),this},this.getHandler=function(t){for(let e=0,i=c.length;e<i;e+=2){const i=c[e],n=c[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return n}return null}};function pl(t){this.manager=void 0!==t?t:dl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(pl.prototype,{load:function(){},loadAsync:function(t,e){const i=this;return new Promise((function(n,r){i.load(t,n,e,r)}))},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const fl={};function ml(t){pl.call(this,t)}function gl(t){pl.call(this,t)}function _l(t){pl.call(this,t)}function vl(t){pl.call(this,t)}function yl(t){pl.call(this,t)}function bl(t){pl.call(this,t)}function xl(t){pl.call(this,t)}function wl(){this.type="Curve",this.arcLengthDivisions=200}function Sl(t,e,i,n,r,s,o,a){wl.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=s||2*Math.PI,this.aClockwise=o||!1,this.aRotation=a||0}function Ml(t,e,i,n,r,s){Sl.call(this,t,e,i,i,n,r,s),this.type="ArcCurve"}function Tl(){let t=0,e=0,i=0,n=0;function r(r,s,o,a){t=r,e=o,i=-3*r+3*s-2*o-a,n=2*r-2*s+o+a}return{initCatmullRom:function(t,e,i,n,s){r(e,i,s*(i-t),s*(n-e))},initNonuniformCatmullRom:function(t,e,i,n,s,o,a){let c=(e-t)/s-(i-t)/(s+o)+(i-e)/o,h=(i-e)/o-(n-e)/(o+a)+(n-i)/a;c*=o,h*=o,r(e,i,c,h)},calc:function(r){const s=r*r;return t+e*r+i*s+n*(s*r)}}}ml.prototype=Object.assign(Object.create(pl.prototype),{constructor:ml,load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ul.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;if(void 0!==fl[t])return void fl[t].push({onLoad:e,onProgress:i,onError:n});const o=t.match(/^data:(.*?)(;base64)?,(.*)$/);let a;if(o){const i=o[1],s=!!o[2];let a=o[3];a=decodeURIComponent(a),s&&(a=atob(a));try{let n;const s=(this.responseType||"").toLowerCase();switch(s){case"arraybuffer":case"blob":const t=new Uint8Array(a.length);for(let e=0;e<a.length;e++)t[e]=a.charCodeAt(e);n="blob"===s?new Blob([t.buffer],{type:i}):t.buffer;break;case"document":const e=new DOMParser;n=e.parseFromString(a,i);break;case"json":n=JSON.parse(a);break;default:n=a}setTimeout((function(){e&&e(n),r.manager.itemEnd(t)}),0)}catch(e){setTimeout((function(){n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}),0)}}else{fl[t]=[],fl[t].push({onLoad:e,onProgress:i,onError:n}),a=new XMLHttpRequest,a.open("GET",t,!0),a.addEventListener("load",(function(e){const i=this.response,n=fl[t];if(delete fl[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ul.add(t,i);for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onLoad&&e.onLoad(i)}r.manager.itemEnd(t)}else{for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}}),!1),a.addEventListener("progress",(function(e){const i=fl[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onProgress&&n.onProgress(e)}}),!1),a.addEventListener("error",(function(e){const i=fl[t];delete fl[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onError&&n.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}),!1),a.addEventListener("abort",(function(e){const i=fl[t];delete fl[t];for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onError&&n.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}),!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeader)a.setRequestHeader(t,this.requestHeader[t]);a.send(null)}return r.manager.itemStart(t),a},setResponseType:function(t){return this.responseType=t,this},setMimeType:function(t){return this.mimeType=t,this}}),gl.prototype=Object.assign(Object.create(pl.prototype),{constructor:gl,load:function(t,e,i,n){const r=this,s=new ml(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(i){try{e(r.parse(JSON.parse(i)))}catch(e){n?n(e):console.error(e),r.manager.itemError(t)}}),i,n)},parse:function(t){const e=[];for(let i=0;i<t.length;i++){const n=hl.parse(t[i]);e.push(n)}return e}}),_l.prototype=Object.assign(Object.create(pl.prototype),{constructor:_l,load:function(t,e,i,n){const r=this,s=[],o=new ih,a=new ml(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(r.withCredentials);let c=0;function h(h){a.load(t[h],(function(t){const i=r.parse(t,!0);s[h]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},c+=1,6===c&&(1===i.mipmapCount&&(o.minFilter=Ai),o.image=s,o.format=i.format,o.needsUpdate=!0,e&&e(o))}),i,n)}if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)h(e);else a.load(t,(function(t){const i=r.parse(t,!0);if(i.isCubemap){const t=i.mipmaps.length/i.mipmapCount;for(let e=0;e<t;e++){s[e]={mipmaps:[]};for(let t=0;t<i.mipmapCount;t++)s[e].mipmaps.push(i.mipmaps[e*i.mipmapCount+t]),s[e].format=i.format,s[e].width=i.width,s[e].height=i.height}o.image=s}else o.image.width=i.width,o.image.height=i.height,o.mipmaps=i.mipmaps;1===i.mipmapCount&&(o.minFilter=Ai),o.format=i.format,o.needsUpdate=!0,e&&e(o)}),i,n);return o}}),vl.prototype=Object.assign(Object.create(pl.prototype),{constructor:vl,load:function(t,e,i,n){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ul.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function a(){o.removeEventListener("load",a,!1),o.removeEventListener("error",c,!1),ul.add(t,this),e&&e(this),r.manager.itemEnd(t)}function c(e){o.removeEventListener("load",a,!1),o.removeEventListener("error",c,!1),n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}return o.addEventListener("load",a,!1),o.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}}),yl.prototype=Object.assign(Object.create(pl.prototype),{constructor:yl,load:function(t,e,i,n){const r=new zs,s=new vl(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(i){s.load(t[i],(function(t){r.images[i]=t,o++,6===o&&(r.needsUpdate=!0,e&&e(r))}),void 0,n)}for(let e=0;e<t.length;++e)a(e);return r}}),bl.prototype=Object.assign(Object.create(pl.prototype),{constructor:bl,load:function(t,e,i,n){const r=this,s=new Bs,o=new ml(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(t,(function(t){const i=r.parse(t);i&&(void 0!==i.image?s.image=i.image:void 0!==i.data&&(s.image.width=i.width,s.image.height=i.height,s.image.data=i.data),s.wrapS=void 0!==i.wrapS?i.wrapS:Ci,s.wrapT=void 0!==i.wrapT?i.wrapT:Ci,s.magFilter=void 0!==i.magFilter?i.magFilter:Ai,s.minFilter=void 0!==i.minFilter?i.minFilter:Ai,s.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.encoding&&(s.encoding=i.encoding),void 0!==i.flipY&&(s.flipY=i.flipY),void 0!==i.format&&(s.format=i.format),void 0!==i.type&&(s.type=i.type),void 0!==i.mipmaps&&(s.mipmaps=i.mipmaps,s.minFilter=Pi),1===i.mipmapCount&&(s.minFilter=Ai),s.needsUpdate=!0,e&&e(s,i))}),i,n),s}}),xl.prototype=Object.assign(Object.create(pl.prototype),{constructor:xl,load:function(t,e,i,n){const r=new hn,s=new vl(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,(function(i){r.image=i;const n=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);r.format=n?ki:zi,r.needsUpdate=!0,void 0!==e&&e(r)}),i,n),r}}),Object.assign(wl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){const i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let i,n=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)i=this.getPoint(s/t),r+=i.distanceTo(n),e.push(r),n=i;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){const i=this.getLengths();let n=0;const r=i.length;let s;s=e||t*i[r-1];let o,a=0,c=r-1;for(;a<=c;)if(n=Math.floor(a+(c-a)/2),o=i[n]-s,o<0)a=n+1;else{if(!(o>0)){c=n;break}c=n-1}if(n=c,i[n]===s)return n/(r-1);const h=i[n];return(n+(s-h)/(i[n+1]-h))/(r-1)},getTangent:function(t,e){const i=1e-4;let n=t-i,r=t+i;n<0&&(n=0),r>1&&(r=1);const s=this.getPoint(n),o=this.getPoint(r),a=e||(s.isVector2?new rn:new fn);return a.copy(o).sub(s).normalize(),a},getTangentAt:function(t,e){const i=this.getUtoTmapping(t);return this.getTangent(i,e)},computeFrenetFrames:function(t,e){const i=new fn,n=[],r=[],s=[],o=new fn,a=new Hn;for(let e=0;e<=t;e++){const i=e/t;n[e]=this.getTangentAt(i,new fn),n[e].normalize()}r[0]=new fn,s[0]=new fn;let c=Number.MAX_VALUE;const h=Math.abs(n[0].x),l=Math.abs(n[0].y),u=Math.abs(n[0].z);h<=c&&(c=h,i.set(1,0,0)),l<=c&&(c=l,i.set(0,1,0)),u<=c&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],o),s[0].crossVectors(n[0],r[0]);for(let e=1;e<=t;e++){if(r[e]=r[e-1].clone(),s[e]=s[e-1].clone(),o.crossVectors(n[e-1],n[e]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(nn.clamp(n[e-1].dot(n[e]),-1,1));r[e].applyMatrix4(a.makeRotationAxis(o,t))}s[e].crossVectors(n[e],r[e])}if(!0===e){let e=Math.acos(nn.clamp(r[0].dot(r[t]),-1,1));e/=t,n[0].dot(o.crossVectors(r[0],r[t]))>0&&(e=-e);for(let i=1;i<=t;i++)r[i].applyMatrix4(a.makeRotationAxis(n[i],e*i)),s[i].crossVectors(n[i],r[i])}return{tangents:n,normals:r,binormals:s}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Sl.prototype=Object.create(wl.prototype),Sl.prototype.constructor=Sl,Sl.prototype.isEllipseCurve=!0,Sl.prototype.getPoint=function(t,e){const i=e||new rn,n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=s?0:n),!0!==this.aClockwise||s||(r===n?r=-n:r-=n);const o=this.aStartAngle+t*r;let a=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),i=a-this.aX,n=c-this.aY;a=i*t-n*e+this.aX,c=i*e+n*t+this.aY}return i.set(a,c)},Sl.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Sl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Sl.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ml.prototype=Object.create(Sl.prototype),Ml.prototype.constructor=Ml,Ml.prototype.isArcCurve=!0;const Cl=new fn,El=new Tl,Il=new Tl,Al=new Tl;function Pl(t=[],e=!1,i="centripetal",n=.5){wl.call(this),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=n}function Rl(t,e,i,n,r){const s=.5*(n-e),o=.5*(r-i),a=t*t;return(2*i-2*n+s+o)*(t*a)+(-3*i+3*n-2*s-o)*a+s*t+i}function Ll(t,e,i,n){return function(t,e){const i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,i)+function(t,e){return t*t*e}(t,n)}function Ol(t,e,i,n,r){return function(t,e){const i=1-t;return i*i*i*e}(t,e)+function(t,e){const i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*e}(t,n)+function(t,e){return t*t*t*e}(t,r)}function Nl(t=new rn,e=new rn,i=new rn,n=new rn){wl.call(this),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=i,this.v3=n}function Dl(t=new fn,e=new fn,i=new fn,n=new fn){wl.call(this),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=n}function $l(t=new rn,e=new rn){wl.call(this),this.type="LineCurve",this.v1=t,this.v2=e}function kl(t=new fn,e=new fn){wl.call(this),this.type="LineCurve3",this.v1=t,this.v2=e}function zl(t=new rn,e=new rn,i=new rn){wl.call(this),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=i}function Fl(t=new fn,e=new fn,i=new fn){wl.call(this),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}function Bl(t=[]){wl.call(this),this.type="SplineCurve",this.points=t}Pl.prototype=Object.create(wl.prototype),Pl.prototype.constructor=Pl,Pl.prototype.isCatmullRomCurve3=!0,Pl.prototype.getPoint=function(t,e=new fn){const i=e,n=this.points,r=n.length,s=(r-(this.closed?0:1))*t;let o,a,c=Math.floor(s),h=s-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:0===h&&c===r-1&&(c=r-2,h=1),this.closed||c>0?o=n[(c-1)%r]:(Cl.subVectors(n[0],n[1]).add(n[0]),o=Cl);const l=n[c%r],u=n[(c+1)%r];if(this.closed||c+2<r?a=n[(c+2)%r]:(Cl.subVectors(n[r-1],n[r-2]).add(n[r-1]),a=Cl),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(l),t),i=Math.pow(l.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(a),t);i<1e-4&&(i=1),e<1e-4&&(e=i),n<1e-4&&(n=i),El.initNonuniformCatmullRom(o.x,l.x,u.x,a.x,e,i,n),Il.initNonuniformCatmullRom(o.y,l.y,u.y,a.y,e,i,n),Al.initNonuniformCatmullRom(o.z,l.z,u.z,a.z,e,i,n)}else"catmullrom"===this.curveType&&(El.initCatmullRom(o.x,l.x,u.x,a.x,this.tension),Il.initCatmullRom(o.y,l.y,u.y,a.y,this.tension),Al.initCatmullRom(o.z,l.z,u.z,a.z,this.tension));return i.set(El.calc(h),Il.calc(h),Al.calc(h)),i},Pl.prototype.copy=function(t){wl.prototype.copy.call(this,t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Pl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);t.points=[];for(let e=0,i=this.points.length;e<i;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Pl.prototype.fromJSON=function(t){wl.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push((new fn).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Nl.prototype=Object.create(wl.prototype),Nl.prototype.constructor=Nl,Nl.prototype.isCubicBezierCurve=!0,Nl.prototype.getPoint=function(t,e=new rn){const i=e,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(Ol(t,n.x,r.x,s.x,o.x),Ol(t,n.y,r.y,s.y,o.y)),i},Nl.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Nl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Nl.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Dl.prototype=Object.create(wl.prototype),Dl.prototype.constructor=Dl,Dl.prototype.isCubicBezierCurve3=!0,Dl.prototype.getPoint=function(t,e=new fn){const i=e,n=this.v0,r=this.v1,s=this.v2,o=this.v3;return i.set(Ol(t,n.x,r.x,s.x,o.x),Ol(t,n.y,r.y,s.y,o.y),Ol(t,n.z,r.z,s.z,o.z)),i},Dl.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Dl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Dl.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},$l.prototype=Object.create(wl.prototype),$l.prototype.constructor=$l,$l.prototype.isLineCurve=!0,$l.prototype.getPoint=function(t,e=new rn){const i=e;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},$l.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},$l.prototype.getTangent=function(t,e){const i=e||new rn;return i.copy(this.v2).sub(this.v1).normalize(),i},$l.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},$l.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},$l.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},kl.prototype=Object.create(wl.prototype),kl.prototype.constructor=kl,kl.prototype.isLineCurve3=!0,kl.prototype.getPoint=function(t,e=new fn){const i=e;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},kl.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},kl.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},kl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},kl.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},zl.prototype=Object.create(wl.prototype),zl.prototype.constructor=zl,zl.prototype.isQuadraticBezierCurve=!0,zl.prototype.getPoint=function(t,e=new rn){const i=e,n=this.v0,r=this.v1,s=this.v2;return i.set(Ll(t,n.x,r.x,s.x),Ll(t,n.y,r.y,s.y)),i},zl.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},zl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},zl.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Fl.prototype=Object.create(wl.prototype),Fl.prototype.constructor=Fl,Fl.prototype.isQuadraticBezierCurve3=!0,Fl.prototype.getPoint=function(t,e=new fn){const i=e,n=this.v0,r=this.v1,s=this.v2;return i.set(Ll(t,n.x,r.x,s.x),Ll(t,n.y,r.y,s.y),Ll(t,n.z,r.z,s.z)),i},Fl.prototype.copy=function(t){return wl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Fl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Fl.prototype.fromJSON=function(t){return wl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Bl.prototype=Object.create(wl.prototype),Bl.prototype.constructor=Bl,Bl.prototype.isSplineCurve=!0,Bl.prototype.getPoint=function(t,e=new rn){const i=e,n=this.points,r=(n.length-1)*t,s=Math.floor(r),o=r-s,a=n[0===s?s:s-1],c=n[s],h=n[s>n.length-2?n.length-1:s+1],l=n[s>n.length-3?n.length-1:s+2];return i.set(Rl(o,a.x,c.x,h.x,l.x),Rl(o,a.y,c.y,h.y,l.y)),i},Bl.prototype.copy=function(t){wl.prototype.copy.call(this,t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push(i.clone())}return this},Bl.prototype.toJSON=function(){const t=wl.prototype.toJSON.call(this);t.points=[];for(let e=0,i=this.points.length;e<i;e++){const i=this.points[e];t.points.push(i.toArray())}return t},Bl.prototype.fromJSON=function(t){wl.prototype.fromJSON.call(this,t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const i=t.points[e];this.points.push((new rn).fromArray(i))}return this};var jl=Object.freeze({__proto__:null,ArcCurve:Ml,CatmullRomCurve3:Pl,CubicBezierCurve:Nl,CubicBezierCurve3:Dl,EllipseCurve:Sl,LineCurve:$l,LineCurve3:kl,QuadraticBezierCurve:zl,QuadraticBezierCurve3:Fl,SplineCurve:Bl});function Hl(){wl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Ul(t){Hl.call(this),this.type="Path",this.currentPoint=new rn,t&&this.setFromPoints(t)}function Vl(t){Ul.call(this,t),this.uuid=nn.generateUUID(),this.type="Shape",this.holes=[]}function Gl(t,e=1){pr.call(this),this.type="Light",this.color=new Dr(t),this.intensity=e}function ql(t,e,i){Gl.call(this,t,i),this.type="HemisphereLight",this.position.copy(pr.DefaultUp),this.updateMatrix(),this.groundColor=new Dr(e)}function Wl(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new rn(512,512),this.map=null,this.mapPass=null,this.matrix=new Hn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Us,this._frameExtents=new rn(1,1),this._viewportCount=1,this._viewports=[new un(0,0,1,1)]}function Xl(){Wl.call(this,new Ds(50,1,.5,500)),this.focus=1}function Yl(t,e,i,n,r,s){Gl.call(this,t,e),this.type="SpotLight",this.position.copy(pr.DefaultUp),this.updateMatrix(),this.target=new pr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==s?s:1,this.shadow=new Xl}function Zl(){Wl.call(this,new Ds(90,1,.5,500)),this._frameExtents=new rn(4,2),this._viewportCount=6,this._viewports=[new un(2,1,1,1),new un(0,1,1,1),new un(3,1,1,1),new un(1,1,1,1),new un(3,0,1,1),new un(1,0,1,1)],this._cubeDirections=[new fn(1,0,0),new fn(-1,0,0),new fn(0,0,1),new fn(0,0,-1),new fn(0,1,0),new fn(0,-1,0)],this._cubeUps=[new fn(0,1,0),new fn(0,1,0),new fn(0,1,0),new fn(0,1,0),new fn(0,0,1),new fn(0,0,-1)]}function Jl(t,e,i,n){Gl.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Zl}function Kl(t=-1,e=1,i=1,n=-1,r=.1,s=2e3){Ns.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}function Ql(){Wl.call(this,new Kl(-5,5,5,-5,.5,500))}function tu(t,e){Gl.call(this,t,e),this.type="DirectionalLight",this.position.copy(pr.DefaultUp),this.updateMatrix(),this.target=new pr,this.shadow=new Ql}function eu(t,e){Gl.call(this,t,e),this.type="AmbientLight"}function iu(t,e,i,n){Gl.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}Hl.prototype=Object.assign(Object.create(wl.prototype),{constructor:Hl,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new $l(e,t))},getPoint:function(t){const e=t*this.getLength(),i=this.getCurveLengths();let n=0;for(;n<i.length;){if(i[n]>=e){const t=i[n]-e,r=this.curves[n],s=r.getLength(),o=0===s?0:1-t/s;return r.getPointAt(o)}n++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t=40){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t=12){const e=[];let i;for(let n=0,r=this.curves;n<r.length;n++){const s=r[n],o=s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let t=0;t<a.length;t++){const n=a[t];i&&i.equals(n)||(e.push(n),i=n)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e},copy:function(t){wl.prototype.copy.call(this,t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){const t=wl.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t},fromJSON:function(t){wl.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const i=t.curves[e];this.curves.push((new jl[i.type]).fromJSON(i))}return this}}),Ul.prototype=Object.assign(Object.create(Hl.prototype),{constructor:Ul,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){const i=new $l(this.currentPoint.clone(),new rn(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,i,n){const r=new zl(this.currentPoint.clone(),new rn(t,e),new rn(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this},bezierCurveTo:function(t,e,i,n,r,s){const o=new Nl(this.currentPoint.clone(),new rn(t,e),new rn(i,n),new rn(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this},splineThru:function(t){const e=new Bl([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,i,n,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,i,n,r,s),this},absarc:function(t,e,i,n,r,s){return this.absellipse(t,e,i,i,n,r,s),this},ellipse:function(t,e,i,n,r,s,o,a){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(t+c,e+h,i,n,r,s,o,a),this},absellipse:function(t,e,i,n,r,s,o,a){const c=new Sl(t,e,i,n,r,s,o,a);if(this.curves.length>0){const t=c.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this},copy:function(t){return Hl.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Hl.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Hl.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Vl.prototype=Object.assign(Object.create(Ul.prototype),{constructor:Vl,getPointsHoles:function(t){const e=[];for(let i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Ul.prototype.copy.call(this,t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const i=t.holes[e];this.holes.push(i.clone())}return this},toJSON:function(){const t=Ul.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t},fromJSON:function(t){Ul.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const i=t.holes[e];this.holes.push((new Ul).fromJSON(i))}return this}}),Gl.prototype=Object.assign(Object.create(pr.prototype),{constructor:Gl,isLight:!0,copy:function(t){return pr.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const e=pr.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),ql.prototype=Object.assign(Object.create(Gl.prototype),{constructor:ql,isHemisphereLight:!0,copy:function(t){return Gl.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Wl.prototype,{_projScreenMatrix:new Hn,_lightPositionWorld:new fn,_lookTarget:new fn,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const e=this.camera,i=this.matrix,n=this._projScreenMatrix,r=this._lookTarget,s=this._lightPositionWorld;s.setFromMatrixPosition(t.matrixWorld),e.position.copy(s),r.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r),e.updateMatrixWorld(),n.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(e.projectionMatrix),i.multiply(e.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Xl.prototype=Object.assign(Object.create(Wl.prototype),{constructor:Xl,isSpotLightShadow:!0,updateMatrices:function(t){const e=this.camera,i=2*nn.RAD2DEG*t.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;i===e.fov&&n===e.aspect&&r===e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix()),Wl.prototype.updateMatrices.call(this,t)}}),Yl.prototype=Object.assign(Object.create(Gl.prototype),{constructor:Yl,isSpotLight:!0,copy:function(t){return Gl.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Zl.prototype=Object.assign(Object.create(Wl.prototype),{constructor:Zl,isPointLightShadow:!0,updateMatrices:function(t,e=0){const i=this.camera,n=this.matrix,r=this._lightPositionWorld,s=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(t.matrixWorld),i.position.copy(r),s.copy(i.position),s.add(this._cubeDirections[e]),i.up.copy(this._cubeUps[e]),i.lookAt(s),i.updateMatrixWorld(),n.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),Jl.prototype=Object.assign(Object.create(Gl.prototype),{constructor:Jl,isPointLight:!0,copy:function(t){return Gl.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Kl.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Kl,isOrthographicCamera:!0,copy:function(t,e){return Ns.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=i-t,s=i+t,o=n+e,a=n-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,o-=e*this.view.offsetY,a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(t){const e=pr.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Ql.prototype=Object.assign(Object.create(Wl.prototype),{constructor:Ql,isDirectionalLightShadow:!0,updateMatrices:function(t){Wl.prototype.updateMatrices.call(this,t)}}),tu.prototype=Object.assign(Object.create(Gl.prototype),{constructor:tu,isDirectionalLight:!0,copy:function(t){return Gl.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),eu.prototype=Object.assign(Object.create(Gl.prototype),{constructor:eu,isAmbientLight:!0}),iu.prototype=Object.assign(Object.create(Gl.prototype),{constructor:iu,isRectAreaLight:!0,copy:function(t){return Gl.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const e=Gl.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}});class nu{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new fn)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const i=t.x,n=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*n),e.addScaledVector(s[2],.488603*r),e.addScaledVector(s[3],.488603*i),e.addScaledVector(s[4],i*n*1.092548),e.addScaledVector(s[5],n*r*1.092548),e.addScaledVector(s[6],.315392*(3*r*r-1)),e.addScaledVector(s[7],i*r*1.092548),e.addScaledVector(s[8],.546274*(i*i-n*n)),e}getIrradianceAt(t,e){const i=t.x,n=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*n),e.addScaledVector(s[2],1.023328*r),e.addScaledVector(s[3],1.023328*i),e.addScaledVector(s[4],.858086*i*n),e.addScaledVector(s[5],.858086*n*r),e.addScaledVector(s[6],.743125*r*r-.247708),e.addScaledVector(s[7],.858086*i*r),e.addScaledVector(s[8],.429043*(i*i-n*n)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(t.coefficients[i],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let i=0;i<9;i++)this.coefficients[i].lerp(t.coefficients[i],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const i=this.coefficients;for(let n=0;n<9;n++)i[n].fromArray(t,e+3*n);return this}toArray(t=[],e=0){const i=this.coefficients;for(let n=0;n<9;n++)i[n].toArray(t,e+3*n);return t}static getBasisAt(t,e){const i=t.x,n=t.y,r=t.z;e[0]=.282095,e[1]=.488603*n,e[2]=.488603*r,e[3]=.488603*i,e[4]=1.092548*i*n,e[5]=1.092548*n*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*i*r,e[8]=.546274*(i*i-n*n)}}function ru(t,e){Gl.call(this,void 0,e),this.type="LightProbe",this.sh=void 0!==t?t:new nu}function su(t){pl.call(this,t),this.textures={}}ru.prototype=Object.assign(Object.create(Gl.prototype),{constructor:ru,isLightProbe:!0,copy:function(t){return Gl.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const e=Gl.prototype.toJSON.call(this,t);return e.object.sh=this.sh.toArray(),e}}),su.prototype=Object.assign(Object.create(pl.prototype),{constructor:su,load:function(t,e,i,n){const r=this,s=new ml(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(i){try{e(r.parse(JSON.parse(i)))}catch(e){n?n(e):console.error(e),r.manager.itemError(t)}}),i,n)},parse:function(t){const e=this.textures;function i(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}const n=new Yh[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&void 0!==n.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.sheen&&(n.sheen=(new Dr).setHex(t.sheen)),void 0!==t.emissive&&void 0!==n.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==n.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearcoat&&(n.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(n.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(n.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(n.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(n.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(n.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(n.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(n.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(n.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(n.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(n.morphNormals=t.morphNormals),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.vertexTangents&&(n.vertexTangents=t.vertexTangents),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.toneMapped&&(n.toneMapped=t.toneMapped),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?n.vertexColors=t.vertexColors>0:n.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const e in t.uniforms){const r=t.uniforms[e];switch(n.uniforms[e]={},r.type){case"t":n.uniforms[e].value=i(r.value);break;case"c":n.uniforms[e].value=(new Dr).setHex(r.value);break;case"v2":n.uniforms[e].value=(new rn).fromArray(r.value);break;case"v3":n.uniforms[e].value=(new fn).fromArray(r.value);break;case"v4":n.uniforms[e].value=(new un).fromArray(r.value);break;case"m3":n.uniforms[e].value=(new sn).fromArray(r.value);break;case"m4":n.uniforms[e].value=(new Hn).fromArray(r.value);break;default:n.uniforms[e].value=r.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const e in t.extensions)n.extensions[e]=t.extensions[e];if(void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=i(t.map)),void 0!==t.matcap&&(n.matcap=i(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=i(t.alphaMap)),void 0!==t.bumpMap&&(n.bumpMap=i(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=i(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),n.normalScale=(new rn).fromArray(e)}return void 0!==t.displacementMap&&(n.displacementMap=i(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=i(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=i(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=i(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=i(t.specularMap)),void 0!==t.envMap&&(n.envMap=i(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(n.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(n.lightMap=i(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=i(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=i(t.gradientMap)),void 0!==t.clearcoatMap&&(n.clearcoatMap=i(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=i(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(n.clearcoatNormalMap=i(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(n.clearcoatNormalScale=(new rn).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(n.transmission=t.transmission),void 0!==t.transmissionMap&&(n.transmissionMap=i(t.transmissionMap)),n},setTextures:function(t){return this.textures=t,this}});const ou=function(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)};function au(){hs.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function cu(t,e,i,n){"number"==typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Hr.call(this,t,e,i),this.meshPerAttribute=n||1}function hu(t){pl.call(this,t)}function lu(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),pl.call(this,t),this.options={premultiplyAlpha:"none"}}function uu(){this.type="ShapePath",this.color=new Dr,this.subPaths=[],this.currentPath=null}au.prototype=Object.assign(Object.create(hs.prototype),{constructor:au,isInstancedBufferGeometry:!0,copy:function(t){return hs.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=hs.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),cu.prototype=Object.assign(Object.create(Hr.prototype),{constructor:cu,isInstancedBufferAttribute:!0,copy:function(t){return Hr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Hr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),hu.prototype=Object.assign(Object.create(pl.prototype),{constructor:hu,load:function(t,e,i,n){const r=this,s=new ml(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(i){try{e(r.parse(JSON.parse(i)))}catch(e){n?n(e):console.error(e),r.manager.itemError(t)}}),i,n)},parse:function(t){const e={},i={};function n(t,n){if(void 0!==e[n])return e[n];const r=t.interleavedBuffers[n],s=function(t,e){if(void 0!==i[e])return i[e];const n=t.arrayBuffers[e],r=new Uint32Array(n).buffer;return i[e]=r,r}(t,r.buffer),o=new tc(es(r.type,s),r.stride);return o.uuid=r.uuid,e[n]=o,o}const r=t.isInstancedBufferGeometry?new au:new hs,s=t.data.index;if(void 0!==s){const t=es(s.type,s.array);r.setIndex(new Hr(t,1))}const o=t.data.attributes;for(const e in o){const i=o[e];let s;if(i.isInterleavedBufferAttribute){s=new ic(n(t.data,i.data),i.itemSize,i.offset,i.normalized)}else{const t=es(i.type,i.array);s=new(i.isInstancedBufferAttribute?cu:Hr)(t,i.itemSize,i.normalized)}void 0!==i.name&&(s.name=i.name),r.setAttribute(e,s)}const a=t.data.morphAttributes;if(a)for(const e in a){const i=a[e],s=[];for(let e=0,r=i.length;e<r;e++){const r=i[e];let o;if(r.isInterleavedBufferAttribute){o=new ic(n(t.data,r.data),r.itemSize,r.offset,r.normalized)}else{o=new Hr(es(r.type,r.array),r.itemSize,r.normalized)}void 0!==r.name&&(o.name=r.name),s.push(o)}r.morphAttributes[e]=s}t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const c=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==c)for(let t=0,e=c.length;t!==e;++t){const e=c[t];r.addGroup(e.start,e.count,e.materialIndex)}const h=t.data.boundingSphere;if(void 0!==h){const t=new fn;void 0!==h.center&&t.fromArray(h.center),r.boundingSphere=new On(t,h.radius)}return t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}}),lu.prototype=Object.assign(Object.create(pl.prototype),{constructor:lu,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=ul.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(t,o).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,r.options)})).then((function(i){ul.add(t,i),e&&e(i),r.manager.itemEnd(t)})).catch((function(e){n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}),Object.assign(uu.prototype,{moveTo:function(t,e){return this.currentPath=new Ul,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},lineTo:function(t,e){return this.currentPath.lineTo(t,e),this},quadraticCurveTo:function(t,e,i,n){return this.currentPath.quadraticCurveTo(t,e,i,n),this},bezierCurveTo:function(t,e,i,n,r,s){return this.currentPath.bezierCurveTo(t,e,i,n,r,s),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,e){function i(t){const e=[];for(let i=0,n=t.length;i<n;i++){const n=t[i],r=new Vl;r.curves=n.curves,e.push(r)}return e}function n(t,e){const i=e.length;let n=!1;for(let r=i-1,s=0;s<i;r=s++){let i=e[r],o=e[s],a=o.x-i.x,c=o.y-i.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(i=e[s],a=-a,o=e[r],c=-c),t.y<i.y||t.y>o.y)continue;if(t.y===i.y){if(t.x===i.x)return!0}else{const e=c*(t.x-i.x)-a*(t.y-i.y);if(0===e)return!0;if(e<0)continue;n=!n}}else{if(t.y!==i.y)continue;if(o.x<=t.x&&t.x<=i.x||i.x<=t.x&&t.x<=o.x)return!0}}return n}const r=Rh.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===e)return i(s);let o,a,c;const h=[];if(1===s.length)return a=s[0],c=new Vl,c.curves=a.curves,h.push(c),h;let l=!r(s[0].getPoints());l=t?!l:l;const u=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let e=0,i=s.length;e<i;e++)a=s[e],p=a.getPoints(),o=r(p),o=t?!o:o,o?(!l&&d[g]&&g++,d[g]={s:new Vl,p:p},d[g].s.curves=a.curves,l&&g++,m[g]=[]):m[g].push({h:a,p:p[0]});if(!d[0])return i(s);if(d.length>1){let t=!1;const e=[];for(let t=0,e=d.length;t<e;t++)u[t]=[];for(let i=0,r=d.length;i<r;i++){const r=m[i];for(let s=0;s<r.length;s++){const o=r[s];let a=!0;for(let r=0;r<d.length;r++)n(o.p,d[r].p)&&(i!==r&&e.push({froms:i,tos:r,hole:s}),a?(a=!1,u[r].push(o)):t=!0);a&&u[i].push(o)}}e.length>0&&(t||(m=u))}for(let t=0,e=d.length;t<e;t++){c=d[t].s,h.push(c),f=m[t];for(let t=0,e=f.length;t<e;t++)c.holes.push(f[t].h)}return h}});class du{constructor(t){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=t}generateShapes(t,e=100){const i=[],n=function(t,e,i){const n=Array.from?Array.from(t):String(t).split(""),r=e/i.resolution,s=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*r,o=[];let a=0,c=0;for(let t=0;t<n.length;t++){const e=n[t];if("\n"===e)a=0,c-=s;else{const t=pu(e,r,a,c,i);a+=t.offsetX,o.push(t.path)}}return o}(t,e,this.data);for(let t=0,e=n.length;t<e;t++)Array.prototype.push.apply(i,n[t].toShapes());return i}}function pu(t,e,i,n,r){const s=r.glyphs[t]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+r.familyName+".");const o=new uu;let a,c,h,l,u,d,p,f;if(s.o){const t=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let r=0,s=t.length;r<s;){switch(t[r++]){case"m":a=t[r++]*e+i,c=t[r++]*e+n,o.moveTo(a,c);break;case"l":a=t[r++]*e+i,c=t[r++]*e+n,o.lineTo(a,c);break;case"q":h=t[r++]*e+i,l=t[r++]*e+n,u=t[r++]*e+i,d=t[r++]*e+n,o.quadraticCurveTo(u,d,h,l);break;case"b":h=t[r++]*e+i,l=t[r++]*e+n,u=t[r++]*e+i,d=t[r++]*e+n,p=t[r++]*e+i,f=t[r++]*e+n,o.bezierCurveTo(u,d,p,f,h,l)}}}return{offsetX:s.ha*e,path:o}}function fu(t){pl.call(this,t)}let mu;fu.prototype=Object.assign(Object.create(pl.prototype),{constructor:fu,load:function(t,e,i,n){const r=this,s=new ml(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(t){let i;try{i=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}const n=r.parse(i);e&&e(n)}),i,n)},parse:function(t){return new du(t)}});const gu=function(){return void 0===mu&&(mu=new(window.AudioContext||window.webkitAudioContext)),mu};function _u(t){pl.call(this,t)}function vu(t,e,i){ru.call(this,void 0,i);const n=(new Dr).set(t),r=(new Dr).set(e),s=new fn(n.r,n.g,n.b),o=new fn(r.r,r.g,r.b),a=Math.sqrt(Math.PI),c=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(c)}function yu(t,e){ru.call(this,void 0,e);const i=(new Dr).set(t);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}_u.prototype=Object.assign(Object.create(pl.prototype),{constructor:_u,load:function(t,e,i,n){const r=this,s=new ml(r.manager);s.setResponseType("arraybuffer"),s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(i){try{const t=i.slice(0);gu().decodeAudioData(t,(function(t){e(t)}))}catch(e){n?n(e):console.error(e),r.manager.itemError(t)}}),i,n)}}),vu.prototype=Object.assign(Object.create(ru.prototype),{constructor:vu,isHemisphereLightProbe:!0,copy:function(t){return ru.prototype.copy.call(this,t),this},toJSON:function(t){return ru.prototype.toJSON.call(this,t)}}),yu.prototype=Object.assign(Object.create(ru.prototype),{constructor:yu,isAmbientLightProbe:!0,copy:function(t){return ru.prototype.copy.call(this,t),this},toJSON:function(t){return ru.prototype.toJSON.call(this,t)}});const bu=new Hn,xu=new Hn;Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ds,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ds,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep;const i=t.projectionMatrix.clone(),n=e.eyeSep/2,r=n*e.near/e.focus,s=e.near*Math.tan(nn.DEG2RAD*e.fov*.5)/e.zoom;let o,a;xu.elements[12]=-n,bu.elements[12]=n,o=-s*e.aspect+r,a=s*e.aspect+r,i.elements[0]=2*e.near/(a-o),i.elements[8]=(a+o)/(a-o),this.cameraL.projectionMatrix.copy(i),o=-s*e.aspect-r,a=s*e.aspect-r,i.elements[0]=2*e.near/(a-o),i.elements[8]=(a+o)/(a-o),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(xu),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(bu)}});function wu(t,e,i){let n,r,s;switch(this.binding=t,this.valueSize=i,e){case"quaternion":n=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:n=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(wu.prototype,{accumulate:function(t,e){const i=this.buffer,n=this.valueSize,r=t*n+n;let s=this.cumulativeWeight;if(0===s){for(let t=0;t!==n;++t)i[r+t]=i[t];s=e}else{s+=e;const t=e/s;this._mixBufferRegion(i,r,0,t,n)}this.cumulativeWeight=s},accumulateAdditive:function(t){const e=this.buffer,i=this.valueSize,n=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,n,0,t,i),this.cumulativeWeightAdditive+=t},apply:function(t){const e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(i,n,t,1-r,e)}s>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*e,1,e);for(let t=e,r=e+e;t!==r;++t)if(i[t]!==i[t+e]){o.setValue(i,n);break}},saveOriginalState:function(){const t=this.binding,e=this.buffer,i=this.valueSize,n=i*this._origIndex;t.getValue(e,n);for(let t=i,r=n;t!==r;++t)e[t]=e[n+t%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let i=t;i<e;i++)this.buffer[i]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[e+i]=this.buffer[t+i]},_select:function(t,e,i,n,r){if(n>=.5)for(let n=0;n!==r;++n)t[e+n]=t[i+n]},_slerp:function(t,e,i,n){pn.slerpFlat(t,e,t,e,t,i,n)},_slerpAdditive:function(t,e,i,n,r){const s=this._workIndex*r;pn.multiplyQuaternionsFlat(t,s,t,e,t,i),pn.slerpFlat(t,e,t,e,t,s,n)},_lerp:function(t,e,i,n,r){const s=1-n;for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]*s+t[i+o]*n}},_lerpAdditive:function(t,e,i,n,r){for(let s=0;s!==r;++s){const r=e+s;t[r]=t[r]+t[i+s]*n}}});const Su="\\[\\]\\.:\\/",Mu=new RegExp("[\\[\\]\\.:\\/]","g"),Tu="[^\\[\\]\\.:\\/]",Cu="[^"+Su.replace("\\.","")+"]",Eu=/((?:WC+[\/:])*)/.source.replace("WC",Tu),Iu=/(WCOD+)?/.source.replace("WCOD",Cu),Au=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Tu),Pu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Tu),Ru=new RegExp("^"+Eu+Iu+Au+Pu+"$"),Lu=["material","materials","bones"];function Ou(t,e,i){const n=i||Nu.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function Nu(t,e,i){this.path=e,this.parsedPath=i||Nu.parseTrackName(e),this.node=Nu.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(Ou.prototype,{getValue:function(t,e){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(Nu,{Composite:Ou,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new Nu.Composite(t,e,i):new Nu(t,e,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Mu,"")},parseTrackName:function(t){const e=Ru.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){const t=i.nodeName.substring(n+1);-1!==Lu.indexOf(t)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=t)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){const i=function(t){for(let n=0;n<t.length;n++){const r=t[n];if(r.name===e||r.uuid===e)return r;const s=i(r.children);if(s)return s}return null},n=i(t.children);if(n)return n}return null}}),Object.assign(Nu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){const i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){let t=this.node;const e=this.parsedPath,i=e.objectName,n=e.propertyName;let r=e.propertyIndex;if(t||(t=Nu.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(i){let n=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===n){n=e;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==n){if(void 0===t[n])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[n]}}const s=t[n];if(void 0===s){const i=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+n+" but it wasn't found.",t)}let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Nu.prototype,{_getValue_unbound:Nu.prototype.getValue,_setValue_unbound:Nu.prototype.setValue}),Object.assign(function(){this.uuid=nn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,e=this._indicesByUUID,i=this._paths,n=this._parsedPaths,r=this._bindings,s=r.length;let o,a=t.length,c=this.nCachedObjects_;for(let h=0,l=arguments.length;h!==l;++h){const l=arguments[h],u=l.uuid;let d=e[u];if(void 0===d){d=a++,e[u]=d,t.push(l);for(let t=0,e=s;t!==e;++t)r[t].push(new Nu(l,i[t],n[t]))}else if(d<c){o=t[d];const a=--c,h=t[a];e[h.uuid]=d,t[d]=h,e[u]=a,t[a]=l;for(let t=0,e=s;t!==e;++t){const e=r[t],s=e[a];let o=e[d];e[d]=s,void 0===o&&(o=new Nu(l,i[t],n[t])),e[a]=o}}else t[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c},remove:function(){const t=this._objects,e=this._indicesByUUID,i=this._bindings,n=i.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,c=e[a];if(void 0!==c&&c>=r){const s=r++,h=t[s];e[h.uuid]=c,t[c]=h,e[a]=s,t[s]=o;for(let t=0,e=n;t!==e;++t){const e=i[t],n=e[s],r=e[c];e[c]=n,e[s]=r}}}this.nCachedObjects_=r},uncache:function(){const t=this._objects,e=this._indicesByUUID,i=this._bindings,n=i.length;let r=this.nCachedObjects_,s=t.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,c=e[a];if(void 0!==c)if(delete e[a],c<r){const o=--r,a=t[o],h=--s,l=t[h];e[a.uuid]=c,t[c]=a,e[l.uuid]=o,t[o]=l,t.pop();for(let t=0,e=n;t!==e;++t){const e=i[t],n=e[o],r=e[h];e[c]=n,e[o]=r,e.pop()}}else{const r=--s,o=t[r];r>0&&(e[o.uuid]=c),t[c]=o,t.pop();for(let t=0,e=n;t!==e;++t){const e=i[t];e[c]=e[r],e.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){const i=this._bindingsIndicesByPath;let n=i[t];const r=this._bindings;if(void 0!==n)return r[n];const s=this._paths,o=this._parsedPaths,a=this._objects,c=a.length,h=this.nCachedObjects_,l=new Array(c);n=r.length,i[t]=n,s.push(t),o.push(e),r.push(l);for(let i=h,n=a.length;i!==n;++i){const n=a[i];l[i]=new Nu(n,t,e)}return l},unsubscribe_:function(t){const e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){const n=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];e[t[o]]=i,s[i]=a,s.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}});class Du{constructor(t,e,i=null,n=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=i,this.blendMode=n;const r=e.tracks,s=r.length,o=new Array(s),a={endingStart:Vi,endingEnd:Vi};for(let t=0;t!==s;++t){const e=r[t].createInterpolant(null);o[t]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){const i=this._clip.duration,n=t._clip.duration,r=n/i,s=i/n;t.warp(1,r,e),this.warp(s,1,e)}return this}crossFadeTo(t,e,i){return t.crossFadeFrom(this,e,i)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,i){const n=this._mixer,r=n.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=r,a[1]=r+i,c[0]=t/s,c[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,i,n){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const n=(t-r)*i;if(n<0||0===i)return;this._startTime=null,e=i*n}e*=this._updateTimeScale(t);const s=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case 2501:for(let i=0,n=t.length;i!==n;++i)t[i].evaluate(s),e[i].accumulateAdditive(o);break;case Wi:default:for(let i=0,r=t.length;i!==r;++i)t[i].evaluate(s),e[i].accumulate(n,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const i=this._weightInterpolant;if(null!==i){const n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const i=this._timeScaleInterpolant;if(null!==i){e*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,i=this.loop;let n=this.time+t,r=this._loopCount;const s=2202===i;if(0===t)return-1===r?n:s&&1==(1&r)?e-n:n;if(2200===i){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(n>=e)n=e;else{if(!(n<0)){this.time=n;break t}n=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),n>=e||n<0){const i=Math.floor(n/e);n-=e*i,r+=Math.abs(i);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=t>0?e:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=n;if(s&&1==(1&r))return e-n}return n}_setEndings(t,e,i){const n=this._interpolantSettings;i?(n.endingStart=Gi,n.endingEnd=Gi):(n.endingStart=t?this.zeroSlopeAtStart?Gi:Vi:qi,n.endingEnd=e?this.zeroSlopeAtEnd?Gi:Vi:qi)}_scheduleFading(t,e,i){const n=this._mixer,r=n.time;let s=this._weightInterpolant;null===s&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=e,o[1]=r+t,a[1]=i,this}}function $u(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}$u.prototype=Object.assign(Object.create(Qi.prototype),{constructor:$u,_bindAction:function(t,e){const i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,s=t._propertyBindings,o=t._interpolants,a=i.uuid,c=this._bindingsByRootAndName;let h=c[a];void 0===h&&(h={},c[a]=h);for(let t=0;t!==r;++t){const r=n[t],c=r.name;let l=h[c];if(void 0!==l)s[t]=l;else{if(l=s[t],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,c));continue}const n=e&&e._propertyBindings[t].binding.parsedPath;l=new wu(Nu.create(i,c,n),r.ValueTypeName,r.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,c),s[t]=l}o[t].resultBuffer=l.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){const n=this._actions,r=this._actionsByClip;let s=r[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{const e=s.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=n.length,n.push(t),s.actionByRoot[i]=t},_removeInactiveAction:function(t){const e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,c=a[a.length-1],h=t._byClipCacheIndex;c._byClipCacheIndex=h,a[h]=c,a.pop(),t._byClipCacheIndex=null;delete o.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete s[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const e=t._propertyBindings;for(let t=0,i=e.length;t!==i;++t){const i=e[t];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){const e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackAction:function(t){const e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_addInactiveBinding:function(t,e,i){const n=this._bindingsByRootAndName,r=this._bindings;let s=n[e];void 0===s&&(s={},n[e]=s),s[i]=t,t._cacheIndex=r.length,r.push(t)},_removeInactiveBinding:function(t){const e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,s=this._bindingsByRootAndName,o=s[n],a=e[e.length-1],c=t._cacheIndex;a._cacheIndex=c,e[c]=a,e.pop(),delete o[r],0===Object.keys(o).length&&delete s[n]},_lendBinding:function(t){const e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackBinding:function(t){const e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_lendControlInterpolant:function(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let i=t[e];return void 0===i&&(i=new Qh(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){const e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e,i){const n=e||this._root,r=n.uuid;let s="string"==typeof t?hl.findByName(n,t):t;const o=null!==s?s.uuid:t,a=this._actionsByClip[o];let c=null;if(void 0===i&&(i=null!==s?s.blendMode:Wi),void 0!==a){const t=a.actionByRoot[r];if(void 0!==t&&t.blendMode===i)return t;c=a.knownActions[0],null===s&&(s=c._clip)}if(null===s)return null;const h=new Du(this,s,e,i);return this._bindAction(h,c),this._addInactiveAction(h,o,r),h},existingAction:function(t,e){const i=e||this._root,n=i.uuid,r="string"==typeof t?hl.findByName(i,t):t,s=r?r.uuid:t,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[n]||null},stopAllAction:function(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this},update:function(t){t*=this.timeScale;const e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),s=this._accuIndex^=1;for(let o=0;o!==i;++o){e[o]._update(n,t,r,s)}const o=this._bindings,a=this._nActiveBindings;for(let t=0;t!==a;++t)o[t].apply(s);return this},setTime:function(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){const t=r.knownActions;for(let i=0,n=t.length;i!==n;++i){const n=t[i];this._deactivateAction(n);const r=n._cacheIndex,s=e[e.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,s._cacheIndex=r,e[r]=s,e.pop(),this._removeInactiveBindingsForAction(n)}delete n[i]}},uncacheRoot:function(t){const e=t.uuid,i=this._actionsByClip;for(const t in i){const n=i[t].actionByRoot[e];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}const n=this._bindingsByRootAndName[e];if(void 0!==n)for(const t in n){const e=n[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}},uncacheAction:function(t,e){const i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}});class ku{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new ku(void 0===this.value.clone?this.value:this.value.clone())}}function zu(t,e,i){tc.call(this,t,e),this.meshPerAttribute=i||1}function Fu(t,e,i,n,r){this.buffer=t,this.type=e,this.itemSize=i,this.elementSize=n,this.count=r,this.version=0}function Bu(t,e,i,n){this.ray=new jn(t,e),this.near=i||0,this.far=n||1/0,this.camera=null,this.layers=new Qn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ju(t,e){return t.distance-e.distance}function Hu(t,e,i,n){if(t.layers.test(e.layers)&&t.raycast(e,i),!0===n){const n=t.children;for(let t=0,r=n.length;t<r;t++)Hu(n[t],e,i,!0)}}zu.prototype=Object.assign(Object.create(tc.prototype),{constructor:zu,isInstancedInterleavedBuffer:!0,copy:function(t){return tc.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const e=tc.prototype.clone.call(this,t);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(t){const e=tc.prototype.toJSON.call(this,t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(Fu.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Fu.prototype,{isGLBufferAttribute:!0,setBuffer:function(t){return this.buffer=t,this},setType:function(t,e){return this.type=t,this.elementSize=e,this},setItemSize:function(t){return this.itemSize=t,this},setCount:function(t){return this.count=t,this}}),Object.assign(Bu.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)},intersectObject:function(t,e,i){const n=i||[];return Hu(t,this,n,e),n.sort(ju),n},intersectObjects:function(t,e,i){const n=i||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(let i=0,r=t.length;i<r;i++)Hu(t[i],this,n,e);return n.sort(ju),n}});const Uu=new rn;function Vu(t){pr.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Vu.prototype=Object.create(pr.prototype),Vu.prototype.constructor=Vu,Vu.prototype.isImmediateRenderObject=!0;const Gu=new Fr({side:1,depthWrite:!1,depthTest:!1});function qu(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Pl.call(this,t),this.type="catmullrom"}new Es(new As,Gu),wl.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(wl.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Ul.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),qu.prototype=Object.create(Pl.prototype),Object.assign(qu.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Object.assign(pl.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ou(t)}}),pl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(class{constructor(t,e){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==t?t:new rn(1/0,1/0),this.max=void 0!==e?e:new rn(-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=Uu.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new rn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new rn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new rn),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new rn),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Uu.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(_n.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(On.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Us.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Object.assign(nn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),nn.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),nn.ceilPowerOfTwo(t)}}),Object.assign(sn.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),Object.assign(Hn.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new fn).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,n,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,s)},getInverse:function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()}}),_r.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Object.assign(pn.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(jn.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Ir.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Ir,{barycoordFromPoint:function(t,e,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ir.getBarycoord(t,e,i,n,r)},normal:function(t,e,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ir.getNormal(t,e,i,n)}}),Object.assign(Vl.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Nh(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new kh(this,t)}}),Object.assign(rn.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(fn.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(un.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(pr.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(pr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Es.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Es.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(xc.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Rc.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Ec.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(wl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Ds.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Gl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Hr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ji},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ji)}}}),Object.assign(Hr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Ji:Zi),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(hs.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Hr(arguments[1],arguments[2])))},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(hs.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(au.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(Bu.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(tc.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Ji},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(tc.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Ji:Zi),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Nh.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(Qa.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(ku.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(zr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Dr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Uh.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Hh.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(Os.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Ja.prototype,{clearTarget:function(t,e,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,i,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Ja.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?3001:Xi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Ha.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(dn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(class extends pr{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new _u).load(t,(function(t){e.setBuffer(t)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),ks.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},ks.prototype.clear=function(t,e,i,n){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,i,n)},an.crossOrigin=void 0,an.loadTexture=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new xl;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,i,void 0,n);return e&&(s.mapping=e),s},an.loadTextureCube=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new yl;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,i,void 0,n);return e&&(s.mapping=e),s},an.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},an.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"125"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="125");const Wu=Math.PI/180,Xu=180/Math.PI,Yu=6378137,Zu=6356752.31424518;function Ju(t,e,i,n,r,s){const o=Qu(t,e,i);return function(t,e,i,n,r,s){const o=Qu(n,r,s),a=[t-o[0],e-o[1],i-o[2]];n*=Wu,r*=Wu;const c=Math.cos(n),h=Math.sin(n),l=Math.cos(r),u=Math.sin(r),d=-h*a[0]+c*a[1],p=-u*c*a[0]-u*h*a[1]+l*a[2],f=l*c*a[0]+l*h*a[1]+u*a[2];return[d,p,f]}(o[0],o[1],o[2],n,r,s)}function Ku(t,e,i,n,r,s){const o=function(t,e,i,n,r,s){const o=Qu(n,r,s);n*=Wu,r*=Wu;const a=Math.cos(n),c=Math.sin(n),h=Math.cos(r),l=Math.sin(r),u=-c*t-l*a*e+h*a*i+o[0],d=a*t-l*c*e+h*c*i+o[1],p=h*e+l*i+o[2];return[u,d,p]}(t,e,i,n,r,s);return function(t,e,i){const n=Yu,r=Zu,s=n*n,o=r*r,a=s-o,c=Math.sqrt(a/s),h=Math.sqrt(a/o),l=Math.sqrt(t*t+e*e),u=Math.atan2(i*n,l*r),d=Math.sin(u),p=Math.cos(u),f=Math.atan2(e,t),m=Math.atan2(i+h*h*r*d*d*d,l-c*c*n*p*p*p),g=Math.sin(m),_=Math.cos(m),v=n/Math.sqrt(1-c*c*g*g);return[f*Xu,m*Xu,l/_-v]}(o[0],o[1],o[2])}function Qu(t,e,i){const n=Yu,r=Zu;t*=Wu,e*=Wu;const s=Math.cos(t),o=Math.sin(t),a=Math.cos(e),c=Math.sin(e),h=n*n,l=r*r,u=1/Math.sqrt(h*a*a+l*c*c),d=(h*u+i)*a;return[d*s,d*o,(l*u+i)*c]}class td{boundingBoxCorners(t,e){const i=Ku(-e,-e,0,t.lng,t.lat,0),n=Ku(e,e,0,t.lng,t.lat,0);return[{lat:i[1],lng:i[0]},{lat:n[1],lng:n[0]}]}rotationFromCompass(t,e){let i=0,n=0,r=0;switch(e){case 1:i=Math.PI/2;break;case 3:i=-Math.PI/2,r=Math.PI;break;case 6:n=-Math.PI/2,r=-Math.PI/2;break;case 8:n=Math.PI/2,r=Math.PI/2}const s=(new Hn).makeRotationZ(r),o=new Zn(i,n,t*Math.PI/180,"XYZ"),a=(new Hn).makeRotationFromEuler(o),c=(new un).setAxisAngleFromRotationMatrix(a.multiply(s));return c.multiplyScalar(c.w).toArray().slice(0,3)}}class ed{constructor(t){if(!t)throw new Error(`Incorrect core image data ${t}`);this._cache=null,this._core=t,this._spatial=null}get assetsCached(){return null!=this._core&&null!=this._spatial&&null!=this._cache&&null!=this._cache.image&&null!=this._cache.mesh}get cameraParameters(){return this._spatial.camera_parameters}get cameraType(){return this._spatial.camera_type}get capturedAt(){return this._spatial.captured_at}get clusterId(){return this._spatial.cluster?this._spatial.cluster.id:null}get clusterUrl(){return this._spatial.cluster?this._spatial.cluster.url:null}get compassAngle(){return null!=this._spatial.computed_compass_angle?this._spatial.computed_compass_angle:this._spatial.compass_angle}get complete(){return null!=this._spatial}get computedAltitude(){return this._spatial.computed_altitude}get computedCompassAngle(){return this._spatial.computed_compass_angle}get computedLngLat(){return this._core.computed_geometry}get creatorId(){return this._spatial.creator.id}get creatorUsername(){return this._spatial.creator.username}get exifOrientation(){return this._spatial.exif_orientation}get height(){return this._spatial.height}get image(){return this._cache.image}get image$(){return this._cache.image$}get id(){return this._core.id}get lngLat(){return null!=this._core.computed_geometry?this._core.computed_geometry:this._core.geometry}get merged(){return null!=this._spatial&&null!=this._spatial.merge_id}get mergeId(){return this._spatial.merge_id}get mesh(){return this._cache.mesh}get originalAltitude(){return this._spatial.altitude}get originalCompassAngle(){return this._spatial.compass_angle}get originalLngLat(){return this._core.geometry}get ownerId(){return this._spatial.owner?this._spatial.owner.id:null}get private(){return this._spatial.private}get qualityScore(){return this._spatial.quality_score}get rotation(){return this._spatial.computed_rotation}get scale(){return this._spatial.atomic_scale}get sequenceId(){return this._core.sequence?this._core.sequence.id:null}get sequenceEdges(){return this._cache.sequenceEdges}get sequenceEdges$(){return this._cache.sequenceEdges$}get spatialEdges(){return this._cache.spatialEdges}get spatialEdges$(){return this._cache.spatialEdges$}get width(){return this._spatial.width}cacheAssets$(){return this._cache.cacheAssets$(this._spatial,this.merged).pipe(rt((()=>this)))}cacheImage$(){return this._cache.cacheImage$(this._spatial).pipe(rt((()=>this)))}cacheSequenceEdges(t){this._cache.cacheSequenceEdges(t)}cacheSpatialEdges(t){this._cache.cacheSpatialEdges(t)}dispose(){null!=this._cache&&(this._cache.dispose(),this._cache=null),this._core=null,this._spatial=null}initializeCache(t){if(null!=this._cache)throw new Error(`Image cache already initialized (${this.id}).`);this._cache=t}makeComplete(t){if(null==t)throw new Error("Fill can not be null.");this._spatial=t}resetSequenceEdges(){this._cache.resetSequenceEdges()}resetSpatialEdges(){this._cache.resetSpatialEdges()}uncache(){null!=this._cache&&(this._cache.dispose(),this._cache=null)}}class id{constructor(t){this._disposed=!1,this._provider=t,this._image=null,this._mesh=null,this._sequenceEdges={cached:!1,edges:[]},this._spatialEdges={cached:!1,edges:[]},this._imageChanged$=new T,this._image$=this._imageChanged$.pipe(ni(null),Ue(1),E()),this._iamgeSubscription=this._image$.subscribe(),this._sequenceEdgesChanged$=new T,this._sequenceEdges$=this._sequenceEdgesChanged$.pipe(ni(this._sequenceEdges),Ue(1),E()),this._sequenceEdgesSubscription=this._sequenceEdges$.subscribe((()=>{})),this._spatialEdgesChanged$=new T,this._spatialEdges$=this._spatialEdgesChanged$.pipe(ni(this._spatialEdges),Ue(1),E()),this._spatialEdgesSubscription=this._spatialEdges$.subscribe((()=>{})),this._cachingAssets$=null}get image(){return this._image}get image$(){return this._image$}get mesh(){return this._mesh}get sequenceEdges(){return this._sequenceEdges}get sequenceEdges$(){return this._sequenceEdges$}get spatialEdges(){return this._spatialEdges}get spatialEdges$(){return this._spatialEdges$}cacheAssets$(t,e){return null!=this._cachingAssets$||(this._cachingAssets$=gt(this._cacheImage$(t),this._cacheMesh$(t,e)).pipe(rt((([t,e])=>(this._image=t,this._mesh=e,this))),Me((()=>{this._cachingAssets$=null})),Ue(1),E()),this._cachingAssets$.pipe(Ee((t=>!!t._image))).subscribe((()=>{this._imageChanged$.next(this._image)}),(()=>{}))),this._cachingAssets$}cacheImage$(t){if(null!=this._image)return G(this);const e=this._cacheImage$(t).pipe(Ee((t=>!!t)),pi((t=>{this._disposeImage(),this._image=t})),rt((()=>this)),Ue(1),E());return e.subscribe((()=>{this._imageChanged$.next(this._image)}),(()=>{})),e}cacheSequenceEdges(t){this._sequenceEdges={cached:!0,edges:t},this._sequenceEdgesChanged$.next(this._sequenceEdges)}cacheSpatialEdges(t){this._spatialEdges={cached:!0,edges:t},this._spatialEdgesChanged$.next(this._spatialEdges)}dispose(){this._iamgeSubscription.unsubscribe(),this._sequenceEdgesSubscription.unsubscribe(),this._spatialEdgesSubscription.unsubscribe(),this._disposeImage(),this._mesh=null,this._sequenceEdges={cached:!1,edges:[]},this._spatialEdges={cached:!1,edges:[]},this._imageChanged$.next(null),this._sequenceEdgesChanged$.next(this._sequenceEdges),this._spatialEdgesChanged$.next(this._spatialEdges),this._disposed=!0,null!=this._imageAborter&&(this._imageAborter(),this._imageAborter=null),null!=this._meshAborter&&(this._meshAborter(),this._meshAborter=null)}resetSequenceEdges(){this._sequenceEdges={cached:!1,edges:[]},this._sequenceEdgesChanged$.next(this._sequenceEdges)}resetSpatialEdges(){this._spatialEdges={cached:!1,edges:[]},this._spatialEdgesChanged$.next(this._spatialEdges)}_cacheImage$(t){return b.create((e=>{const i=new Promise(((t,e)=>{this._imageAborter=e})),n=t.thumb.url;if(n)this._provider.getImageBuffer(n,i).then((t=>{this._imageAborter=null;const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{if(this._disposed){window.URL.revokeObjectURL(i.src);const t=`Image load was aborted (${n})`;e.error(new Error(t))}else e.next(i),e.complete()},i.onerror=()=>{this._imageAborter=null,e.error(new Error(`Failed to load image (${n})`))};const r=new Blob([t]);i.src=window.URL.createObjectURL(r)}),(t=>{this._imageAborter=null,e.error(t)}));else{const i=t.thumb.id,r=`Incorrect thumb URL for ${t.id} (${i}, ${n})`;e.error(new Error(r))}}))}_cacheMesh$(t,e){return b.create((i=>{if(!e)return i.next(this._createEmptyMesh()),void i.complete();const n=t.mesh.url;if(!n){const e=t.mesh.id,r=`Incorrect mesh URL for ${t.id} (${e}, ${n})`;return console.warn(r),i.next(this._createEmptyMesh()),void i.complete()}const r=new Promise(((t,e)=>{this._meshAborter=e}));this._provider.getMesh(n,r).then((t=>{this._meshAborter=null,this._disposed||(i.next(t),i.complete())}),(t=>{this._meshAborter=null,console.error(t),i.next(this._createEmptyMesh()),i.complete()}))}))}_createEmptyMesh(){return{faces:[],vertices:[]}}_disposeImage(){null!=this._image&&window.URL.revokeObjectURL(this._image.src),this._image=null}}class nd{constructor(t){this._id=t.id,this._imageIds=t.image_ids}get id(){return this._id}get imageIds(){return this._imageIds}dispose(){this._id=null,this._imageIds=null}findNext(t){let e=this._imageIds.indexOf(t);return e+1>=this._imageIds.length||-1===e?null:this._imageIds[e+1]}findPrev(t){let e=this._imageIds.indexOf(t);return 0===e||-1===e?null:this._imageIds[e-1]}}class rd{constructor(){this.sphericalPreferredDistance=2,this.sphericalMotion=2,this.sphericalSequencePenalty=1,this.sphericalMergeCCPenalty=4,this.stepPreferredDistance=4,this.stepMotion=3,this.stepRotation=4,this.stepSequencePenalty=2,this.stepMergeCCPenalty=6,this.similarDistance=2,this.similarRotation=3,this.turnDistance=4,this.turnMotion=2,this.turnSequencePenalty=1,this.turnMergeCCPenalty=4}}var sd;t.NavigationDirection=void 0,(sd=t.NavigationDirection||(t.NavigationDirection={}))[sd.Next=0]="Next",sd[sd.Prev=1]="Prev",sd[sd.StepLeft=2]="StepLeft",sd[sd.StepRight=3]="StepRight",sd[sd.StepForward=4]="StepForward",sd[sd.StepBackward=5]="StepBackward",sd[sd.TurnLeft=6]="TurnLeft",sd[sd.TurnRight=7]="TurnRight",sd[sd.TurnU=8]="TurnU",sd[sd.Spherical=9]="Spherical",sd[sd.Similar=10]="Similar";class od{constructor(){this.steps={},this.turns={},this.spherical={},this.steps[t.NavigationDirection.StepForward]={direction:t.NavigationDirection.StepForward,motionChange:0,useFallback:!0},this.steps[t.NavigationDirection.StepBackward]={direction:t.NavigationDirection.StepBackward,motionChange:Math.PI,useFallback:!0},this.steps[t.NavigationDirection.StepLeft]={direction:t.NavigationDirection.StepLeft,motionChange:Math.PI/2,useFallback:!1},this.steps[t.NavigationDirection.StepRight]={direction:t.NavigationDirection.StepRight,motionChange:-Math.PI/2,useFallback:!1},this.turns[t.NavigationDirection.TurnLeft]={direction:t.NavigationDirection.TurnLeft,directionChange:Math.PI/2,motionChange:Math.PI/4},this.turns[t.NavigationDirection.TurnRight]={direction:t.NavigationDirection.TurnRight,directionChange:-Math.PI/2,motionChange:-Math.PI/4},this.turns[t.NavigationDirection.TurnU]={direction:t.NavigationDirection.TurnU,directionChange:Math.PI,motionChange:null},this.spherical[t.NavigationDirection.StepForward]={direction:t.NavigationDirection.StepForward,directionChange:0,next:t.NavigationDirection.StepLeft,prev:t.NavigationDirection.StepRight},this.spherical[t.NavigationDirection.StepBackward]={direction:t.NavigationDirection.StepBackward,directionChange:Math.PI,next:t.NavigationDirection.StepRight,prev:t.NavigationDirection.StepLeft},this.spherical[t.NavigationDirection.StepLeft]={direction:t.NavigationDirection.StepLeft,directionChange:Math.PI/2,next:t.NavigationDirection.StepBackward,prev:t.NavigationDirection.StepForward},this.spherical[t.NavigationDirection.StepRight]={direction:t.NavigationDirection.StepRight,directionChange:-Math.PI/2,next:t.NavigationDirection.StepForward,prev:t.NavigationDirection.StepBackward}}}class ad{constructor(){this.sphericalMinDistance=.1,this.sphericalMaxDistance=20,this.sphericalPreferredDistance=5,this.sphericalMaxItems=4,this.sphericalMaxStepTurnChange=Math.PI/8,this.rotationMaxDistance=this.turnMaxRigDistance,this.rotationMaxDirectionChange=Math.PI/6,this.rotationMaxVerticalDirectionChange=Math.PI/8,this.similarMaxDirectionChange=Math.PI/8,this.similarMaxDistance=12,this.similarMinTimeDifference=432e5,this.stepMaxDistance=20,this.stepMaxDirectionChange=Math.PI/6,this.stepMaxDrift=Math.PI/6,this.stepPreferredDistance=4,this.turnMaxDistance=15,this.turnMaxDirectionChange=2*Math.PI/9,this.turnMaxRigDistance=.65,this.turnMinRigDirectionChange=Math.PI/6}get maxDistance(){return Math.max(this.sphericalMaxDistance,this.similarMaxDistance,this.stepMaxDistance,this.turnMaxDistance)}}class cd extends Error{constructor(t){super(t),Object.setPrototypeOf(this,cd.prototype),this.name="MapillaryError"}}class hd extends cd{constructor(t){super(null!=t?t:"The argument is not valid."),Object.setPrototypeOf(this,hd.prototype),this.name="ArgumentMapillaryError"}}class ld{constructor(){this._epsilon=1e-9}azimuthalToBearing(t){return-t+Math.PI/2}degToRad(t){return Math.PI*t/180}radToDeg(t){return 180*t/Math.PI}rotationMatrix(t){let e=new fn(t[0],t[1],t[2]),i=e.length();return i>0&&e.normalize(),(new Hn).makeRotationAxis(e,i)}rotate(t,e){let i=new fn(t[0],t[1],t[2]),n=this.rotationMatrix(e);return i.applyMatrix4(n),i}opticalCenter(t,e){let i=[-t[0],-t[1],-t[2]],n=[-e[0],-e[1],-e[2]];return this.rotate(n,i)}viewingDirection(t){let e=[-t[0],-t[1],-t[2]];return this.rotate([0,0,1],e)}wrap(t,e,i){if(i<e)throw new Error("Invalid arguments: max must be larger than min.");let n=i-e;for(;t>i||t<e;)t>i?t-=n:t<e&&(t+=n);return t}wrapAngle(t){return this.wrap(t,-Math.PI,Math.PI)}clamp(t,e,i){return t<e?e:t>i?i:t}angleBetweenVector2(t,e,i,n){let r=Math.atan2(n,i)-Math.atan2(e,t);return this.wrapAngle(r)}angleDifference(t,e){let i=e-t;return this.wrapAngle(i)}relativeRotationAngle(t,e){let i=this.rotationMatrix([-t[0],-t[1],-t[2]]),n=this.rotationMatrix(e),r=i.multiply(n).elements,s=r[0]+r[5]+r[10];return Math.acos(Math.max(Math.min((s-1)/2,1),-1))}angleToPlane(t,e){let i=(new fn).fromArray(t),n=i.length();if(n<this._epsilon)return 0;let r=i.dot((new fn).fromArray(e));return Math.asin(r/n)}azimuthal(t,e){const i=(new fn).fromArray(t),n=(new fn).fromArray(e),r=i.clone().dot(n),s=i.clone().sub(n.clone().multiplyScalar(r));return Math.atan2(s.y,s.x)}distanceFromLngLat(t,e,i,n){let r=this.degToRad(n-e),s=this.degToRad(i-t),o=Math.sin(r/2)*Math.sin(r/2)+Math.cos(this.degToRad(e))*Math.cos(this.degToRad(n))*Math.sin(s/2)*Math.sin(s/2);return 12742e3*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}}const ud=new ld;function dd(t){return"spherical"===t}function pd(t){return"fisheye"===t}function fd(t,e,i){const n=Ju(t.lng,t.lat,t.alt,i.lng,i.lat,i.alt),r=ud.rotate(n,e);return[-r.x,-r.y,-r.z]}function md(t,e,i,n,r){const s=[];for(let t=0;t<e.length;++t){const r=e[t],o=i[t];for(let t=0;t<=n;++t)s.push([r[0]+o[0]*t/n,r[1]+o[1]*t/n])}const o=new Ns;o.up.copy(t.upVector()),o.position.copy((new fn).fromArray(t.unprojectSfM([0,0],0))),o.lookAt((new fn).fromArray(t.unprojectSfM([0,0],10))),o.updateMatrix(),o.updateMatrixWorld(!0);return s.map((e=>{const i=t.unprojectBasic(e,1e4),n=r.worldToCamera(i,o);return[Math.abs(n[0]/n[2]),Math.abs(n[1]/n[2])]}))}class gd{constructor(t,e,i){this._spatial=new ld,this._settings=null!=t?t:new ad,this._directions=null!=e?e:new od,this._coefficients=null!=i?i:new rd}getPotentialEdges(t,e,i){if(!t.complete)throw new hd("Image has to be full.");if(!t.merged)return[];let n=this._spatial.viewingDirection(t.rotation),r=this._spatial.angleToPlane(n.toArray(),[0,0,1]),s=[];for(let o of e){if(!o.merged||o.id===t.id)continue;let e=Ju(o.lngLat.lng,o.lngLat.lat,o.computedAltitude,t.lngLat.lng,t.lngLat.lat,t.computedAltitude),a=new fn(e[0],e[1],e[2]),c=a.length();if(c>this._settings.maxDistance&&i.indexOf(o.id)<0)continue;let h=this._spatial.angleBetweenVector2(n.x,n.y,a.x,a.y),l=this._spatial.angleToPlane(a.toArray(),[0,0,1]),u=this._spatial.viewingDirection(o.rotation),d=this._spatial.angleBetweenVector2(n.x,n.y,u.x,u.y),p=this._spatial.angleToPlane(u.toArray(),[0,0,1])-r,f=this._spatial.relativeRotationAngle(t.rotation,o.rotation),m=this._spatial.angleBetweenVector2(1,0,a.x,a.y),g=null!=o.sequenceId&&null!=t.sequenceId&&o.sequenceId===t.sequenceId,_=o.mergeId===t.mergeId,v=o.creatorId===t.creatorId,y={capturedAt:o.capturedAt,directionChange:d,distance:c,spherical:dd(o.cameraType),id:o.id,motionChange:h,rotation:f,sameMergeCC:_,sameSequence:g,sameUser:v,sequenceId:o.sequenceId,verticalDirectionChange:p,verticalMotion:l,worldMotionAzimuth:m};s.push(y)}return s}computeSequenceEdges(e,i){if(!e.complete)throw new hd("Image has to be full.");if(e.sequenceId!==i.id)throw new hd("Image and sequence does not correspond.");let n=[],r=i.findNext(e.id);null!=r&&n.push({data:{direction:t.NavigationDirection.Next,worldMotionAzimuth:Number.NaN},source:e.id,target:r});let s=i.findPrev(e.id);return null!=s&&n.push({data:{direction:t.NavigationDirection.Prev,worldMotionAzimuth:Number.NaN},source:e.id,target:s}),n}computeSimilarEdges(e,i){if(!e.complete)throw new hd("Image has to be full.");let n=dd(e.cameraType),r={};for(let t of i)if(null!=t.sequenceId&&!t.sameSequence){if(n){if(!t.spherical)continue}else if(!t.spherical&&Math.abs(t.directionChange)>this._settings.similarMaxDirectionChange)continue;t.distance>this._settings.similarMaxDistance||t.sameUser&&Math.abs(t.capturedAt-e.capturedAt)<this._settings.similarMinTimeDifference||(null==r[t.sequenceId]&&(r[t.sequenceId]=[]),r[t.sequenceId].push(t))}let s=[],o=dd(e.cameraType)?t=>t.distance:t=>this._coefficients.similarDistance*t.distance+this._coefficients.similarRotation*t.rotation;for(let t in r){if(!r.hasOwnProperty(t))continue;let e=Number.MAX_VALUE,i=null;for(let n of r[t]){let t=o(n);t<e&&(e=t,i=n)}null!=i&&s.push(i)}return s.map((i=>({data:{direction:t.NavigationDirection.Similar,worldMotionAzimuth:i.worldMotionAzimuth},source:e.id,target:i.id})))}computeStepEdges(t,e,i,n){if(!t.complete)throw new hd("Image has to be full.");let r=[];if(dd(t.cameraType))return r;for(let s in this._directions.steps){if(!this._directions.steps.hasOwnProperty(s))continue;let o=this._directions.steps[s],a=Number.MAX_VALUE,c=null,h=null;for(let t of e){if(t.spherical)continue;if(Math.abs(t.directionChange)>this._settings.stepMaxDirectionChange)continue;let e=this._spatial.angleDifference(o.motionChange,t.motionChange),r=this._spatial.angleDifference(t.directionChange,e),s=Math.max(Math.abs(e),Math.abs(r));if(Math.abs(s)>this._settings.stepMaxDrift)continue;let l=t.id;if(!o.useFallback||l!==i&&l!==n||(h=t),t.distance>this._settings.stepMaxDistance)continue;e=Math.sqrt(e*e+t.verticalMotion*t.verticalMotion);let u=this._coefficients.stepPreferredDistance*Math.abs(t.distance-this._settings.stepPreferredDistance)/this._settings.stepMaxDistance+this._coefficients.stepMotion*e/this._settings.stepMaxDrift+this._coefficients.stepRotation*t.rotation/this._settings.stepMaxDirectionChange+this._coefficients.stepSequencePenalty*(t.sameSequence?0:1)+this._coefficients.stepMergeCCPenalty*(t.sameMergeCC?0:1);u<a&&(a=u,c=t)}c=null==c?h:c,null!=c&&r.push({data:{direction:o.direction,worldMotionAzimuth:c.worldMotionAzimuth},source:t.id,target:c.id})}return r}computeTurnEdges(e,i){if(!e.complete)throw new hd("Image has to be full.");let n=[];if(dd(e.cameraType))return n;for(let r in this._directions.turns){if(!this._directions.turns.hasOwnProperty(r))continue;let s=this._directions.turns[r],o=Number.MAX_VALUE,a=null;for(let e of i){if(e.spherical)continue;if(e.distance>this._settings.turnMaxDistance)continue;let i,n=s.direction!==t.NavigationDirection.TurnU&&e.distance<this._settings.turnMaxRigDistance&&Math.abs(e.directionChange)>this._settings.turnMinRigDirectionChange,r=this._spatial.angleDifference(s.directionChange,e.directionChange);if(n&&e.directionChange*s.directionChange>0&&Math.abs(e.directionChange)<Math.abs(s.directionChange))i=-Math.PI/2+Math.abs(e.directionChange);else{if(Math.abs(r)>this._settings.turnMaxDirectionChange)continue;let t=s.motionChange?this._spatial.angleDifference(s.motionChange,e.motionChange):0;t=Math.sqrt(t*t+e.verticalMotion*e.verticalMotion),i=this._coefficients.turnDistance*e.distance/this._settings.turnMaxDistance+this._coefficients.turnMotion*t/Math.PI+this._coefficients.turnSequencePenalty*(e.sameSequence?0:1)+this._coefficients.turnMergeCCPenalty*(e.sameMergeCC?0:1)}i<o&&(o=i,a=e)}null!=a&&n.push({data:{direction:s.direction,worldMotionAzimuth:a.worldMotionAzimuth},source:e.id,target:a.id})}return n}computePerspectiveToSphericalEdges(e,i){if(!e.complete)throw new hd("Image has to be full.");if(dd(e.cameraType))return[];let n=Number.MAX_VALUE,r=null;for(let t of i){if(!t.spherical)continue;let e=this._coefficients.sphericalPreferredDistance*Math.abs(t.distance-this._settings.sphericalPreferredDistance)/this._settings.sphericalMaxDistance+this._coefficients.sphericalMotion*Math.abs(t.motionChange)/Math.PI+this._coefficients.sphericalMergeCCPenalty*(t.sameMergeCC?0:1);e<n&&(n=e,r=t)}return null==r?[]:[{data:{direction:t.NavigationDirection.Spherical,worldMotionAzimuth:r.worldMotionAzimuth},source:e.id,target:r.id}]}computeSphericalEdges(e,i){if(!e.complete)throw new hd("Image has to be full.");if(!dd(e.cameraType))return[];let n=[],r=[],s=[];for(let t of i)if(!(t.distance>this._settings.sphericalMaxDistance))if(t.spherical){if(t.distance<this._settings.sphericalMinDistance)continue;r.push(t)}else for(let e in this._directions.spherical){if(!this._directions.spherical.hasOwnProperty(e))continue;let i=this._directions.spherical[e],n=this._spatial.angleDifference(t.directionChange,t.motionChange),r=this._spatial.angleDifference(i.directionChange,n);if(!(Math.abs(r)>this._settings.sphericalMaxStepTurnChange)){s.push([i.direction,t]);break}}let o=Math.PI/this._settings.sphericalMaxItems,a=[],c=[];for(let i=0;i<this._settings.sphericalMaxItems;i++){let s=i/this._settings.sphericalMaxItems*2*Math.PI,h=Number.MAX_VALUE,l=null;for(let t of r){let e=this._spatial.angleDifference(s,t.motionChange);if(Math.abs(e)>o)continue;let i=Number.MAX_VALUE;for(let e of a){let n=Math.abs(this._spatial.angleDifference(e,t.motionChange));n<i&&(i=n)}if(i<=o)continue;let n=this._coefficients.sphericalPreferredDistance*Math.abs(t.distance-this._settings.sphericalPreferredDistance)/this._settings.sphericalMaxDistance+this._coefficients.sphericalMotion*Math.abs(e)/o+this._coefficients.sphericalSequencePenalty*(t.sameSequence?0:1)+this._coefficients.sphericalMergeCCPenalty*(t.sameMergeCC?0:1);n<h&&(h=n,l=t)}null!=l?(a.push(l.motionChange),n.push({data:{direction:t.NavigationDirection.Spherical,worldMotionAzimuth:l.worldMotionAzimuth},source:e.id,target:l.id})):c.push(s)}let h={};h[t.NavigationDirection.Spherical]=a,h[t.NavigationDirection.StepForward]=[],h[t.NavigationDirection.StepLeft]=[],h[t.NavigationDirection.StepBackward]=[],h[t.NavigationDirection.StepRight]=[];for(let i of c){let r=[];for(let a in this._directions.spherical){if(!this._directions.spherical.hasOwnProperty(a))continue;let c=this._directions.spherical[a],l=h[t.NavigationDirection.Spherical].concat(h[c.direction]).concat(h[c.prev]).concat(h[c.next]),u=Number.MAX_VALUE,d=null;for(let t of s){if(t[0]!==c.direction)continue;let e=this._spatial.angleDifference(i,t[1].motionChange);if(Math.abs(e)>o)continue;let n=Number.MAX_VALUE;for(let e of l){let i=Math.abs(this._spatial.angleDifference(e,t[1].motionChange));i<n&&(n=i)}if(n<=o)continue;let r=this._coefficients.sphericalPreferredDistance*Math.abs(t[1].distance-this._settings.sphericalPreferredDistance)/this._settings.sphericalMaxDistance+this._coefficients.sphericalMotion*Math.abs(e)/o+this._coefficients.sphericalMergeCCPenalty*(t[1].sameMergeCC?0:1);r<u&&(u=r,d=t)}null!=d&&(r.push(d),n.push({data:{direction:d[0],worldMotionAzimuth:d[1].worldMotionAzimuth},source:e.id,target:d[1].id}))}for(let t of r)h[t[0]].push(t[1].motionChange)}return n}}class _d extends cd{constructor(t){super(t),Object.setPrototypeOf(this,_d.prototype),this.name="GraphMapillaryError"}}class vd{constructor(t,e,i,n,r,s){this._api=t,this._cachedNodes={},this._cachedNodeTiles={},this._cachedSequenceNodes={},this._cachedSpatialEdges={},this._cachedTiles={},this._cachingFill$={},this._cachingFull$={},this._cachingSequenceNodes$={},this._cachingSequences$={},this._cachingSpatialArea$={},this._cachingTiles$={},this._changed$=new T,this._filterCreator=null!=r?r:new Si,this._filter=this._filterCreator.createFilter(void 0),this._filterSubject$=new T,this._filter$=At(G(this._filter),this._filterSubject$).pipe(Ue(1),E()),this._filterSubscription=this._filter$.subscribe((()=>{})),this._defaultAlt=2,this._edgeCalculator=null!=n?n:new gd,this._graphCalculator=null!=i?i:new td,this._configuration=null!=s?s:{maxSequences:50,maxUnusedImages:100,maxUnusedPreStoredImages:30,maxUnusedTiles:20},this._nodes={},this._nodeIndex=null!=e?e:new vd._spatialIndex(16),this._nodeIndexTiles={},this._nodeToTile={},this._preStored={},this._requiredNodeTiles={},this._requiredSpatialArea={},this._sequences={},this._tileThreshold=20}static register(t){vd._spatialIndex=t}get api(){return this._api}get changed$(){return this._changed$}get filter$(){return this._filter$}cacheBoundingBox$(t,e){const i=this._api.data.geometry.bboxToCellIds(t,e).filter((t=>!(t in this._cachedTiles))).map((t=>t in this._cachingTiles$?this._cachingTiles$[t]:this._cacheTile$(t)));return 0===i.length&&i.push(G(this)),bt(i).pipe(Et(),Re(),Mt((()=>{const i=this._nodeIndex.search({maxX:e.lng,maxY:e.lat,minX:t.lng,minY:t.lat}).map((t=>t.node)),n=[],r=[];for(const t of i)t.complete?n.push(t):r.push(t.id);const s=[];for(;r.length>0;)s.push(r.splice(0,200));return Ot(G(n),bt(s.map((t=>this._api.getSpatialImages$(t).pipe(rt((t=>{const e=[];for(const i of t){if(!this.hasNode(i.node_id))continue;const t=this.getNode(i.node_id);t.complete||this._makeFull(t,i.node),e.push(t)}return e})))))).pipe(Et()))})),De(((t,e)=>t.concat(e))))}cacheCell$(t){return(t in this._cachedTiles?G(this):t in this._cachingTiles$?this._cachingTiles$[t]:this._cacheTile$(t)).pipe(Mt((()=>{const e=this._cachedTiles[t];e.accessed=(new Date).getTime();const i=e.nodes,n=[],r=[];for(const t of i)t.complete?n.push(t):r.push(t.id);const s=[];for(;r.length>0;)s.push(r.splice(0,200));return Ot(G(n),bt(s.map((t=>this._api.getSpatialImages$(t).pipe(rt((t=>{const e=[];for(const i of t){if(!i.node){console.warn(`Image is empty (${i.node})`);continue}const t=i.node_id;if(!this.hasNode(t))continue;const n=this.getNode(t);n.complete||this._makeFull(n,i.node),e.push(n)}return e})))))).pipe(Et()))})),De(((t,e)=>t.concat(e))))}cacheFill$(t){if(t in this._cachingFull$)throw new _d(`Cannot fill node while caching full (${t}).`);if(!this.hasNode(t))throw new _d(`Cannot fill node that does not exist in graph (${t}).`);if(t in this._cachingFill$)return this._cachingFill$[t];const e=this.getNode(t);if(e.complete)throw new _d(`Cannot fill node that is already full (${t}).`);return this._cachingFill$[t]=this._api.getSpatialImages$([t]).pipe(pi((t=>{for(const i of t)i.node||console.warn(`Image is empty ${i.node_id}`),e.complete||this._makeFull(e,i.node),delete this._cachingFill$[i.node_id]})),rt((()=>this)),Me((()=>{t in this._cachingFill$&&delete this._cachingFill$[t],this._changed$.next(this)})),He(),E()),this._cachingFill$[t]}cacheFull$(t){if(t in this._cachingFull$)return this._cachingFull$[t];if(this.hasNode(t))throw new _d(`Cannot cache full node that already exist in graph (${t}).`);return this._cachingFull$[t]=this._api.getImages$([t]).pipe(pi((e=>{for(const i of e){if(!i.node)throw new _d(`Image does not exist (${t}, ${i.node}).`);const e=i.node_id;if(this.hasNode(e)){const e=this.getNode(t);e.complete||this._makeFull(e,i.node)}else{if(null==i.node.sequence.id)throw new _d(`Image has no sequence key (${t}).`);const n=new ed(i.node);this._makeFull(n,i.node);const r=this._api.data.geometry.lngLatToCellId(n.originalLngLat);this._preStore(r,n),this._setNode(n),delete this._cachingFull$[e]}}})),rt((()=>this)),Me((()=>{t in this._cachingFull$&&delete this._cachingFull$[t],this._changed$.next(this)})),He(),E()),this._cachingFull$[t]}cacheNodeSequence$(t){if(!this.hasNode(t))throw new _d(`Cannot cache sequence edges of node that does not exist in graph (${t}).`);let e=this.getNode(t);if(e.sequenceId in this._sequences)throw new _d(`Sequence already cached (${t}), (${e.sequenceId}).`);return this._cacheSequence$(e.sequenceId)}cacheSequence$(t){if(t in this._sequences)throw new _d(`Sequence already cached (${t})`);return this._cacheSequence$(t)}cacheSequenceEdges(t){let e=this.getNode(t);if(!(e.sequenceId in this._sequences))throw new _d(`Sequence is not cached (${t}), (${e.sequenceId})`);let i=this._sequences[e.sequenceId].sequence,n=this._edgeCalculator.computeSequenceEdges(e,i);e.cacheSequenceEdges(n)}cacheSequenceNodes$(t,e){if(!this.hasSequence(t))throw new _d(`Cannot cache sequence nodes of sequence that does not exist in graph (${t}).`);if(this.hasSequenceNodes(t))throw new _d(`Sequence nodes already cached (${t}).`);const i=this.getSequence(t);if(i.id in this._cachingSequenceNodes$)return this._cachingSequenceNodes$[i.id];const n=[],r=i.imageIds.slice();if(e&&r.length>50){const t=r.indexOf(e),i=Math.max(0,Math.min(t-25,r.length-50));n.push(r.splice(i,50))}for(;r.length>0;)n.push(r.splice(0,200));let s=n.length;const o=bt(n).pipe(Mt((t=>this._api.getImages$(t).pipe(pi((t=>{for(const e of t){if(!e.node){console.warn(`Image empty (${e.node_id})`);continue}const t=e.node_id;if(this.hasNode(t)){const i=this.getNode(t);i.complete||this._makeFull(i,e.node)}else{null==e.node.sequence.id&&console.warn(`Sequence missing, discarding node (${e.node_id})`);const t=new ed(e.node);this._makeFull(t,e.node);const i=this._api.data.geometry.lngLatToCellId(t.originalLngLat);this._preStore(i,t),this._setNode(t)}}s--})),rt((()=>this)))),6),Re(),Me((()=>{delete this._cachingSequenceNodes$[i.id],0===s&&(this._cachedSequenceNodes[i.id]=!0)})),He(),E());return this._cachingSequenceNodes$[i.id]=o,o}cacheSpatialArea$(t){if(!this.hasNode(t))throw new _d(`Cannot cache spatial area of node that does not exist in graph (${t}).`);if(t in this._cachedSpatialEdges)throw new _d(`Image already spatially cached (${t}).`);if(!(t in this._requiredSpatialArea))throw new _d(`Spatial area not determined (${t}).`);let e=this._requiredSpatialArea[t];if(0===Object.keys(e.cacheNodes).length)throw new _d(`Spatial nodes already cached (${t}).`);if(t in this._cachingSpatialArea$)return this._cachingSpatialArea$[t];let i=[];for(;e.cacheKeys.length>0;)i.push(e.cacheKeys.splice(0,200));let n=i.length,r=[];for(let s of i){let i=this._api.getSpatialImages$(s).pipe(pi((i=>{for(const t of i){if(!t.node){console.warn(`Image is empty (${t.node_id})`);continue}const i=t.node_id,n=e.cacheNodes[i];n.complete?delete e.cacheNodes[i]:(this._makeFull(n,t.node),delete e.cacheNodes[i])}0==--n&&delete this._cachingSpatialArea$[t]})),rt((()=>this)),te((i=>{for(let t of s)t in e.all&&delete e.all[t],t in e.cacheNodes&&delete e.cacheNodes[t];throw 0==--n&&delete this._cachingSpatialArea$[t],i})),Me((()=>{0===Object.keys(e.cacheNodes).length&&this._changed$.next(this)})),He(),E());r.push(i)}return this._cachingSpatialArea$[t]=r,r}cacheSpatialEdges(t){if(t in this._cachedSpatialEdges)throw new _d(`Spatial edges already cached (${t}).`);let e=this.getNode(t),i=this._sequences[e.sequenceId].sequence,n=[],r=i.findPrev(e.id);null!=r&&n.push(r);let s=i.findNext(e.id);null!=s&&n.push(s);let o=this._requiredSpatialArea[t].all,a=[],c=this._filter;for(let t in o){if(!o.hasOwnProperty(t))continue;let e=o[t];c(e)&&a.push(e)}let h=this._edgeCalculator.getPotentialEdges(e,a,n),l=this._edgeCalculator.computeStepEdges(e,h,r,s);l=l.concat(this._edgeCalculator.computeTurnEdges(e,h)),l=l.concat(this._edgeCalculator.computeSphericalEdges(e,h)),l=l.concat(this._edgeCalculator.computePerspectiveToSphericalEdges(e,h)),l=l.concat(this._edgeCalculator.computeSimilarEdges(e,h)),e.cacheSpatialEdges(l),this._cachedSpatialEdges[t]=e,delete this._requiredSpatialArea[t],delete this._cachedNodeTiles[t]}cacheTiles$(t){if(t in this._cachedNodeTiles)throw new _d(`Tiles already cached (${t}).`);if(t in this._cachedSpatialEdges)throw new _d(`Spatial edges already cached so tiles considered cached (${t}).`);if(!(t in this._requiredNodeTiles))throw new _d(`Tiles have not been determined (${t}).`);let e=this._requiredNodeTiles[t];if(0===e.cache.length&&0===e.caching.length)throw new _d(`Tiles already cached (${t}).`);if(!this.hasNode(t))throw new _d(`Cannot cache tiles of node that does not exist in graph (${t}).`);let i=e.cache.slice();e.caching=this._requiredNodeTiles[t].caching.concat(i),e.cache=[];let n=[];for(let i of e.caching){const r=i in this._cachingTiles$?this._cachingTiles$[i]:this._cacheTile$(i);n.push(r.pipe(pi((n=>{let r=e.caching.indexOf(i);r>-1&&e.caching.splice(r,1),0===e.caching.length&&0===e.cache.length&&(delete this._requiredNodeTiles[t],this._cachedNodeTiles[t]=!0)})),te((n=>{let r=e.caching.indexOf(i);throw r>-1&&e.caching.splice(r,1),0===e.caching.length&&0===e.cache.length&&(delete this._requiredNodeTiles[t],this._cachedNodeTiles[t]=!0),n})),Me((()=>{this._changed$.next(this)})),He(),E()))}return n}initializeCache(t){if(t in this._cachedNodes)throw new _d(`Image already in cache (${t}).`);const e=this.getNode(t),i=this._api.data;e.initializeCache(new id(i));const n=(new Date).getTime();this._cachedNodes[t]={accessed:n,node:e},this._updateCachedTileAccess(t,n)}isCachingFill(t){return t in this._cachingFill$}isCachingFull(t){return t in this._cachingFull$}isCachingNodeSequence(t){return this.getNode(t).sequenceId in this._cachingSequences$}isCachingSequence(t){return t in this._cachingSequences$}isCachingSequenceNodes(t){return t in this._cachingSequenceNodes$}isCachingTiles(t){return t in this._requiredNodeTiles&&0===this._requiredNodeTiles[t].cache.length&&this._requiredNodeTiles[t].caching.length>0}hasInitializedCache(t){return t in this._cachedNodes}hasNode(t){let e=(new Date).getTime();return this._updateCachedNodeAccess(t,e),this._updateCachedTileAccess(t,e),t in this._nodes}hasNodeSequence(t){let e=this.getNode(t).sequenceId,i=e in this._sequences;return i&&(this._sequences[e].accessed=(new Date).getTime()),i}hasSequence(t){let e=t in this._sequences;return e&&(this._sequences[t].accessed=(new Date).getTime()),e}hasSequenceNodes(t){return t in this._cachedSequenceNodes}hasSpatialArea(t){if(!this.hasNode(t))throw new _d(`Spatial area nodes cannot be determined if node not in graph (${t}).`);if(t in this._cachedSpatialEdges)return!0;if(t in this._requiredSpatialArea)return 0===Object.keys(this._requiredSpatialArea[t].cacheNodes).length;let e=this.getNode(t),i=this._graphCalculator.boundingBoxCorners(e.lngLat,this._tileThreshold),n=this._nodeIndex.search({maxX:i[1].lng,maxY:i[1].lat,minX:i[0].lng,minY:i[0].lat}),r={all:{},cacheKeys:[],cacheNodes:{}};for(let t of n)r.all[t.node.id]=t.node,t.node.complete||(r.cacheKeys.push(t.node.id),r.cacheNodes[t.node.id]=t.node);return this._requiredSpatialArea[t]=r,0===r.cacheKeys.length}hasTiles(t){if(t in this._cachedNodeTiles)return!0;if(t in this._cachedSpatialEdges)return!0;if(!this.hasNode(t))throw new _d(`Image does not exist in graph (${t}).`);let e={cache:[],caching:[]};if(t in this._requiredNodeTiles)e=this._requiredNodeTiles[t];else{const i=this.getNode(t),[n,r]=this._graphCalculator.boundingBoxCorners(i.lngLat,this._tileThreshold);e.cache=this._api.data.geometry.bboxToCellIds(n,r).filter((t=>!(t in this._cachedTiles))),e.cache.length>0&&(this._requiredNodeTiles[t]=e)}return 0===e.cache.length&&0===e.caching.length}getNode(t){let e=(new Date).getTime();return this._updateCachedNodeAccess(t,e),this._updateCachedTileAccess(t,e),this._nodes[t]}getSequence(t){let e=this._sequences[t];return e.accessed=(new Date).getTime(),e.sequence}resetSpatialEdges(){let t=Object.keys(this._cachedSpatialEdges);for(let e of t){this._cachedSpatialEdges[e].resetSpatialEdges(),delete this._cachedSpatialEdges[e]}}reset(t){const e=[];for(const i of t){if(!this.hasNode(i))throw new Error(`Image does not exist ${i}`);const t=this.getNode(i);t.resetSequenceEdges(),t.resetSpatialEdges(),e.push(t)}for(let e of Object.keys(this._cachedNodes))-1===t.indexOf(e)&&(this._cachedNodes[e].node.dispose(),delete this._cachedNodes[e]);this._cachedNodeTiles={},this._cachedSpatialEdges={},this._cachedTiles={},this._cachingFill$={},this._cachingFull$={},this._cachingSequences$={},this._cachingSpatialArea$={},this._cachingTiles$={},this._nodes={},this._nodeToTile={},this._preStored={};for(const t of e){this._nodes[t.id]=t;const e=this._api.data.geometry.lngLatToCellId(t.originalLngLat);this._preStore(e,t)}this._requiredNodeTiles={},this._requiredSpatialArea={},this._sequences={},this._nodeIndexTiles={},this._nodeIndex.clear()}setFilter(t){this._filter=this._filterCreator.createFilter(t),this._filterSubject$.next(this._filter)}uncache(t,e,i){const n={};this._addNewKeys(n,this._cachingFull$),this._addNewKeys(n,this._cachingFill$),this._addNewKeys(n,this._cachingSpatialArea$),this._addNewKeys(n,this._requiredNodeTiles),this._addNewKeys(n,this._requiredSpatialArea);for(const e of t)e in n||(n[e]=!0);const r=this._tileThreshold,s=this._graphCalculator,o=this._api.data.geometry,a=new Set(e);for(let t in n){if(!n.hasOwnProperty(t))continue;const e=this._nodes[t],[i,c]=s.boundingBoxCorners(e.lngLat,r),h=o.bboxToCellIds(i,c);for(const t of h)a.has(t)||a.add(t)}const c=[];for(let t in this._cachedTiles)this._cachedTiles.hasOwnProperty(t)&&!a.has(t)&&c.push([t,this._cachedTiles[t]]);const h=c.sort(((t,e)=>e[1].accessed-t[1].accessed)).slice(this._configuration.maxUnusedTiles).map((t=>t[0]));for(let t of h)this._uncacheTile(t,i);const l=[],u=[];for(let t in this._preStored){if(!this._preStored.hasOwnProperty(t)||t in this._cachingTiles$)continue;const e=this._preStored[t];for(let r in e)e.hasOwnProperty(r)&&!(r in n)&&e[r].sequenceId!==i&&(r in this._cachedNodes?l.push([this._cachedNodes[r],t]):u.push([r,t]))}const d=l.sort((([t],[e])=>e.accessed-t.accessed)).slice(this._configuration.maxUnusedPreStoredImages).map((([t,e])=>[t.node.id,e]));this._uncachePreStored(u),this._uncachePreStored(d);const p=[];for(let t in this._cachedNodes)this._cachedNodes.hasOwnProperty(t)&&!(t in n)&&p.push(this._cachedNodes[t]);const f=p.sort(((t,e)=>e.accessed-t.accessed)).slice(this._configuration.maxUnusedImages);for(const t of f){t.node.uncache();const e=t.node.id;delete this._cachedNodes[e],e in this._cachedNodeTiles&&delete this._cachedNodeTiles[e],e in this._cachedSpatialEdges&&delete this._cachedSpatialEdges[e]}const m=[];for(let t in this._sequences)this._sequences.hasOwnProperty(t)&&!(t in this._cachingSequences$)&&t!==i&&m.push(this._sequences[t]);const g=m.sort(((t,e)=>e.accessed-t.accessed)).slice(this._configuration.maxSequences);for(const t of g){const e=t.sequence.id;delete this._sequences[e],e in this._cachedSequenceNodes&&delete this._cachedSequenceNodes[e],t.sequence.dispose()}}updateCells$(t){const e=this._cachedTiles,i=this._cachingTiles$;return bt(t).pipe(Mt((t=>t in e?this._updateCell$(t):t in i?i[t].pipe(te((()=>G(this))),Mt((()=>this._updateCell$(t)))):B())))}unsubscribe(){this._filterSubscription.unsubscribe()}_addNewKeys(t,e){for(let i in e)e.hasOwnProperty(i)&&this.hasNode(i)&&(i in t||(t[i]=!0))}_cacheSequence$(t){return t in this._cachingSequences$||(this._cachingSequences$[t]=this._api.getSequence$(t).pipe(pi((e=>{e?(e.id in this._sequences||(this._sequences[e.id]={accessed:(new Date).getTime(),sequence:new nd(e)}),delete this._cachingSequences$[t]):console.warn(`Sequence does not exist (${t})`)})),rt((()=>this)),Me((()=>{t in this._cachingSequences$&&delete this._cachingSequences$[t],this._changed$.next(this)})),He(),E())),this._cachingSequences$[t]}_cacheTile$(t){return this._cachingTiles$[t]=this._api.getCoreImages$(t).pipe(pi((e=>{if(t in this._cachedTiles)return;const i=e.images;this._nodeIndexTiles[t]=[],this._cachedTiles[t]={accessed:(new Date).getTime(),nodes:[]};const n=this._cachedTiles[t].nodes,r=this._removeFromPreStore(t);for(const e of i){if(!e)break;if(null==e.sequence.id){console.warn(`Sequence missing, discarding node (${e.id})`);continue}if(null!=r&&e.id in r){const i=r[e.id];delete r[e.id],n.push(i);const s={lat:i.lngLat.lat,lng:i.lngLat.lng,node:i};this._nodeIndex.insert(s),this._nodeIndexTiles[t].push(s),this._nodeToTile[i.id]=t;continue}const i=new ed(e);n.push(i);const s={lat:i.lngLat.lat,lng:i.lngLat.lng,node:i};this._nodeIndex.insert(s),this._nodeIndexTiles[t].push(s),this._nodeToTile[i.id]=t,this._setNode(i)}delete this._cachingTiles$[t]})),rt((()=>this)),te((e=>{throw delete this._cachingTiles$[t],e})),He(),E()),this._cachingTiles$[t]}_makeFull(t,e){null==e.computed_altitude&&(e.computed_altitude=this._defaultAlt),null==e.computed_rotation&&(e.computed_rotation=this._graphCalculator.rotationFromCompass(e.compass_angle,e.exif_orientation)),t.makeComplete(e)}_preStore(t,e){t in this._preStored||(this._preStored[t]={}),this._preStored[t][e.id]=e}_removeFromPreStore(t){let e=null;return t in this._preStored&&(e=this._preStored[t],delete this._preStored[t]),e}_setNode(t){let e=t.id;if(this.hasNode(e))throw new _d(`Image already exist (${e}).`);this._nodes[e]=t}_uncacheTile(t,e){for(let i of this._cachedTiles[t].nodes){let n=i.id;delete this._nodeToTile[n],n in this._cachedNodes&&delete this._cachedNodes[n],n in this._cachedNodeTiles&&delete this._cachedNodeTiles[n],n in this._cachedSpatialEdges&&delete this._cachedSpatialEdges[n],i.sequenceId===e?(this._preStore(t,i),i.uncache()):(delete this._nodes[n],i.sequenceId in this._cachedSequenceNodes&&delete this._cachedSequenceNodes[i.sequenceId],i.dispose())}for(let e of this._nodeIndexTiles[t])this._nodeIndex.remove(e);delete this._nodeIndexTiles[t],delete this._cachedTiles[t]}_uncachePreStored(t){let e={};for(let[i,n]of t){i in this._nodes&&delete this._nodes[i],i in this._cachedNodes&&delete this._cachedNodes[i];let t=this._preStored[n][i];t.sequenceId in this._cachedSequenceNodes&&delete this._cachedSequenceNodes[t.sequenceId],delete this._preStored[n][i],t.dispose(),e[n]=!0}for(let t in e)e.hasOwnProperty(t)&&0===Object.keys(this._preStored[t]).length&&delete this._preStored[t]}_updateCachedTileAccess(t,e){t in this._nodeToTile&&(this._cachedTiles[this._nodeToTile[t]].accessed=e)}_updateCachedNodeAccess(t,e){t in this._cachedNodes&&(this._cachedNodes[t].accessed=e)}_updateCell$(t){return this._api.getCoreImages$(t).pipe(Mt((e=>{if(!(t in this._cachedTiles))return B();const i=this._nodeIndex,n=this._nodeIndexTiles[t],r=this._nodeToTile,s=this._cachedTiles[t];s.accessed=(new Date).getTime();const o=s.nodes,a=e.images;for(const e of a){if(null==e)break;if(this.hasNode(e.id))continue;if(null==e.sequence.id){console.warn(`Sequence missing, discarding node (${e.id})`);continue}const s=new ed(e);o.push(s);const a={lat:s.lngLat.lat,lng:s.lngLat.lng,node:s};i.insert(a),n.push(a),r[s.id]=t,this._setNode(s)}return G(t)})),te((t=>(console.error(t),B()))))}}class yd{constructor(){this._hash={},this._index=new yd._spatialIndex(16),this._indexChanged$=new T,this._updated$=new T}static register(t){yd._spatialIndex=t}get changed$(){return this._indexChanged$}get updated$(){return this._updated$}add(t){const e=[],i=this._hash,n=this._index;for(const r of t){const t=r.id;t in i&&(n.remove(i[t]),e.push(r));const s={lat:r.lngLat.lat,lng:r.lngLat.lng,marker:r};i[t]=s,n.insert(s)}e.length>0&&this._updated$.next(e),t.length>e.length&&this._indexChanged$.next(this)}has(t){return t in this._hash}get(t){return this.has(t)?this._hash[t].marker:void 0}getAll(){return this._index.all().map((t=>t.marker))}remove(t){const e=this._hash,i=this._index;let n=!1;for(const r of t){if(!(r in e))continue;const t=e[r];i.remove(t),delete e[r],n=!0}n&&this._indexChanged$.next(this)}removeAll(){this._hash={},this._index.clear(),this._indexChanged$.next(this)}search([t,e]){return this._index.search({maxX:e.lng,maxY:e.lat,minX:t.lng,minY:t.lat}).map((t=>t.marker))}update(t){const e=this._hash,i=this._index,n=t.id;if(!(n in e))return;i.remove(e[n]);const r={lat:t.lngLat.lat,lng:t.lngLat.lng,marker:t};e[n]=r,i.insert(r)}}function bd(t,e,i,n,r){xd(t,e,i||0,n||t.length-1,r||Sd)}function xd(t,e,i,n,r){for(;n>i;){if(n-i>600){var s=n-i+1,o=e-i+1,a=Math.log(s),c=.5*Math.exp(2*a/3),h=.5*Math.sqrt(a*c*(s-c)/s)*(o-s/2<0?-1:1);xd(t,e,Math.max(i,Math.floor(e-o*c/s+h)),Math.min(n,Math.floor(e+(s-o)*c/s+h)),r)}var l=t[e],u=i,d=n;for(wd(t,i,e),r(t[n],l)>0&&wd(t,i,n);u<d;){for(wd(t,u,d),u++,d--;r(t[u],l)<0;)u++;for(;r(t[d],l)>0;)d--}0===r(t[i],l)?wd(t,i,d):wd(t,++d,n),d<=e&&(i=d+1),e<=d&&(n=d-1)}}function wd(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function Sd(t,e){return t<e?-1:t>e?1:0}function Md(t,e,i){if(!i)return e.indexOf(t);for(let n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function Td(t,e){Cd(t,0,t.children.length,e,t)}function Cd(t,e,i,n,r){r||(r=Dd(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s=e;s<i;s++){const e=t.children[s];Ed(r,t.leaf?n(e):e)}return r}function Ed(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Id(t,e){return t.minX-e.minX}function Ad(t,e){return t.minY-e.minY}function Pd(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Rd(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Ld(t,e){const i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,s-n)}function Od(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Nd(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Dd(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function $d(t,e,i,n,r){const s=[e,i];for(;s.length;){if((i=s.pop())-(e=s.pop())<=n)continue;const o=e+Math.ceil((i-e)/n/2)*n;bd(t,o,e,i,r),s.push(e,o,o,i)}}class kd extends class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!Nd(t,e))return i;const n=this.toBBox,r=[];for(;e;){for(let s=0;s<e.children.length;s++){const o=e.children[s],a=e.leaf?n(o):o;Nd(t,a)&&(e.leaf?i.push(o):Od(t,a)?this._all(o,i):r.push(o))}e=r.pop()}return i}collides(t){let e=this.data;if(!Nd(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const r=e.children[n],s=e.leaf?this.toBBox(r):r;if(Nd(t,s)){if(e.leaf||Od(t,s))return!0;i.push(r)}}e=i.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Dd([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),r=[],s=[];let o,a,c;for(;i||r.length;){if(i||(i=r.pop(),a=r[r.length-1],o=s.pop(),c=!0),i.leaf){const n=Md(t,i.children,e);if(-1!==n)return i.children.splice(n,1),r.push(i),this._condense(r),this}c||i.leaf||!Od(i,n)?a?(o++,i=a.children[o],c=!1):i=null:(r.push(i),s.push(o),o=0,a=i,i=i.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const r=i-e+1;let s,o=this._maxEntries;if(r<=o)return s=Dd(t.slice(e,i+1)),Td(s,this.toBBox),s;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),s=Dd([]),s.leaf=!1,s.height=n;const a=Math.ceil(r/o),c=a*Math.ceil(Math.sqrt(o));$d(t,e,i,c,this.compareMinX);for(let r=e;r<=i;r+=c){const e=Math.min(r+c-1,i);$d(t,r,e,a,this.compareMinY);for(let i=r;i<=e;i+=a){const r=Math.min(i+a-1,e);s.children.push(this._build(t,i,r,n-1))}}return Td(s,this.toBBox),s}_chooseSubtree(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){let i,n=1/0,o=1/0;for(let a=0;a<e.children.length;a++){const c=e.children[a],h=Pd(c),l=(r=t,s=c,(Math.max(s.maxX,r.maxX)-Math.min(s.minX,r.minX))*(Math.max(s.maxY,r.maxY)-Math.min(s.minY,r.minY))-h);l<o?(o=l,n=h<n?h:n,i=c):l===o&&h<n&&(n=h,i=c)}e=i||e.children[0]}var r,s;return e}_insert(t,e,i){const n=i?t:this.toBBox(t),r=[],s=this._chooseSubtree(n,this.data,e,r);for(s.children.push(t),Ed(s,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)}_split(t,e){const i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);const s=this._chooseSplitIndex(i,r,n),o=Dd(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,Td(i,this.toBBox),Td(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)}_splitRoot(t,e){this.data=Dd([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Td(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,r=1/0,s=1/0;for(let o=e;o<=i-e;o++){const e=Cd(t,0,o,this.toBBox),a=Cd(t,o,i,this.toBBox),c=Ld(e,a),h=Pd(e)+Pd(a);c<r?(r=c,n=o,s=h<s?h:s):c===r&&h<s&&(s=h,n=o)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:Id,r=t.leaf?this.compareMinY:Ad;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const r=this.toBBox,s=Cd(t,0,e,r),o=Cd(t,i-e,i,r);let a=Rd(s)+Rd(o);for(let n=e;n<i-e;n++){const e=t.children[n];Ed(s,t.leaf?r(e):e),a+=Rd(s)}for(let n=i-e-1;n>=e;n--){const e=t.children[n];Ed(o,t.leaf?r(e):e),a+=Rd(o)}return a}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)Ed(e[n],t)}_condense(t){for(let e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():Td(t[i],this.toBBox)}}{compareMinX(t,e){return t.lng-e.lng}compareMinY(t,e){return t.lat-e.lat}toBBox(t){return{minX:t.lng,minY:t.lat,maxX:t.lng,maxY:t.lat}}}var zd,Fd=Bd;function Bd(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=i,this.p2y=n}Bd.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Bd.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Bd.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Bd.prototype.solveCurveX=function(t,e){var i,n,r,s,o;for(void 0===e&&(e=1e-6),r=t,o=0;o<8;o++){if(s=this.sampleCurveX(r)-t,Math.abs(s)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=s/a}if((r=t)<(i=0))return i;if(r>(n=1))return n;for(;i<n;){if(s=this.sampleCurveX(r),Math.abs(s-t)<e)return r;t>s?i=r:n=r,r=.5*(n-i)+i}return r},Bd.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))},t.TransitionMode=void 0,(zd=t.TransitionMode||(t.TransitionMode={}))[zd.Default=0]="Default",zd[zd.Instantaneous=1]="Instantaneous";class jd{constructor(t){null!=t?(this._position=(new fn).fromArray(t.unprojectSfM([0,0],0)),this._lookat=(new fn).fromArray(t.unprojectSfM([0,0],10)),this._up=t.upVector(),this._focal=this._getFocal(t)):(this._position=new fn(0,0,0),this._lookat=new fn(1,0,0),this._up=new fn(0,0,1),this._focal=1)}get position(){return this._position}get lookat(){return this._lookat}get up(){return this._up}get focal(){return this._focal}set focal(t){this._focal=t}lerpCameras(t,e,i){this._position.subVectors(e.position,t.position).multiplyScalar(i).add(t.position),this._lookat.subVectors(e.lookat,t.lookat).multiplyScalar(i).add(t.lookat),this._up.subVectors(e.up,t.up).multiplyScalar(i).add(t.up),this._focal=(1-i)*t.focal+i*e.focal}copy(t){this._position.copy(t.position),this._lookat.copy(t.lookat),this._up.copy(t.up),this._focal=t.focal}clone(){let t=new jd;return t.position.copy(this._position),t.lookat.copy(this._lookat),t.up.copy(this._up),t.focal=this._focal,t}diff(t){let e=this._position.distanceToSquared(t.position),i=this._lookat.distanceToSquared(t.lookat),n=this._up.distanceToSquared(t.up),r=100*Math.abs(this._focal-t.focal);return Math.max(e,i,n,r)}_getFocal(t){return dd(t.cameraType)?.5/Math.tan(Math.PI/2):t.focal}}class Hd{constructor(t,e,i,n,r,s,o,a,c,h){this._orientation=this._getValue(t,1);let l=null!=o?o.width:4,u=null!=o?o.height:3,d=this._orientation<5;this._width=this._getValue(e,d?l:u),this._height=this._getValue(i,d?u:l),this._basicAspect=d?this._width/this._height:this._height/this._width,this._basicWidth=d?e:i,this._basicHeight=d?i:e;const p=this._getCameraParameters(c,h),f=p[0],m=p[1],g=p[2];this._focal=this._getValue(f,1),this._scale=this._getValue(n,0),this._worldToCamera=this.createWorldToCamera(r,s),this._worldToCameraInverse=(new Hn).copy(this._worldToCamera).invert(),this._scaledWorldToCamera=this._createScaledWorldToCamera(this._worldToCamera,this._scale),this._scaledWorldToCameraInverse=(new Hn).copy(this._scaledWorldToCamera).invert(),this._basicWorldToCamera=this._createBasicWorldToCamera(this._worldToCamera,t),this._textureScale=a||[1,1],this._ck1=m||0,this._ck2=g||0,this._cameraType=h||"perspective",this._radialPeak=this._getRadialPeak(this._ck1,this._ck2)}get ck1(){return this._ck1}get ck2(){return this._ck2}get cameraType(){return this._cameraType}get basicAspect(){return this._basicAspect}get basicHeight(){return this._basicHeight}get basicRt(){return this._basicWorldToCamera}get basicWidth(){return this._basicWidth}get focal(){return this._focal}get height(){return this._height}get orientation(){return this._orientation}get rt(){return this._worldToCamera}get srt(){return this._scaledWorldToCamera}get srtInverse(){return this._scaledWorldToCameraInverse}get scale(){return this._scale}get hasValidScale(){return this._scale>.01&&this._scale<50}get radialPeak(){return this._radialPeak}get width(){return this._width}upVector(){let t=this._worldToCamera.elements;switch(this._orientation){case 1:return new fn(-t[1],-t[5],-t[9]);case 3:return new fn(t[1],t[5],t[9]);case 6:return new fn(-t[0],-t[4],-t[8]);case 8:return new fn(t[0],t[4],t[8]);default:return new fn(-t[1],-t[5],-t[9])}}projectorMatrix(){let t=this._normalizedToTextureMatrix(),e=this._focal,i=(new Hn).set(e,0,0,0,0,e,0,0,0,0,0,0,0,0,1,0);return t.multiply(i),t.multiply(this._worldToCamera),t}projectBasic(t){let e=this.projectSfM(t);return this._sfmToBasic(e)}unprojectBasic(t,e,i){let n=this._basicToSfm(t);return this.unprojectSfM(n,e,i)}projectSfM(t){let e=new un(t[0],t[1],t[2],1);return e.applyMatrix4(this._worldToCamera),this._bearingToSfm([e.x,e.y,e.z])}unprojectSfM(t,e,i){const n=this._sfmToBearing(t),r=(i&&!dd(this._cameraType)?new un(e*n[0]/n[2],e*n[1]/n[2],e,1):new un(e*n[0],e*n[1],e*n[2],1)).applyMatrix4(this._worldToCameraInverse);return[r.x/r.w,r.y/r.w,r.z/r.w]}_sfmToBearing(t){if(dd(this._cameraType)){let e=2*t[0]*Math.PI,i=2*-t[1]*Math.PI;return[Math.cos(i)*Math.sin(e),-Math.sin(i),Math.cos(i)*Math.cos(e)]}if(pd(this._cameraType)){let[e,i]=[t[0]/this._focal,t[1]/this._focal];const n=Math.sqrt(e*e+i*i);let r=n/this._distortionFromDistortedRadius(n,this._ck1,this._ck2,this._radialPeak),s=Math.cos(r),o=Math.sin(r);const a=n>1e-8?1/n:1;return[o*e*a,o*i*a,s]}{let[e,i]=[t[0]/this._focal,t[1]/this._focal];const n=Math.sqrt(e*e+i*i);let r=this._distortionFromDistortedRadius(n,this._ck1,this._ck2,this._radialPeak);let s=new fn(e/r,i/r,1);return s.normalize(),[s.x,s.y,s.z]}}_distortionFromDistortedRadius(t,e,i,n){let r=1;for(let s=0;s<10;s++){let s=t/r;s>n&&(s=n),r=1+e*Math.pow(s,2)+i*Math.pow(s,4)}return r}_bearingToSfm(t){if(dd(this._cameraType)){let e=t[0],i=t[1],n=t[2],r=Math.atan2(e,n),s=Math.atan2(-i,Math.sqrt(e*e+n*n));return[r/(2*Math.PI),-s/(2*Math.PI)]}if(pd(this._cameraType)){if(t[2]>0){const[e,i,n]=t,r=Math.sqrt(e*e+i*i);let s=Math.atan2(r,n);s>this._radialPeak&&(s=this._radialPeak);const o=1+Math.pow(s,2)*(this._ck1+Math.pow(s,2)*this._ck2),a=this._focal*o*s/r;return[a*e,a*i]}return[t[0]<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,t[1]<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY]}if(t[2]>0){let[e,i]=[t[0]/t[2],t[1]/t[2]],n=e*e+i*i;const r=Math.pow(this._radialPeak,2);n>r&&(n=r);const s=1+this._ck1*n+this._ck2*Math.pow(n,2);return[this._focal*s*e,this._focal*s*i]}return[t[0]<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,t[1]<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY]}_basicToSfm(t){let e,i;switch(this._orientation){case 1:e=t[0],i=t[1];break;case 3:e=1-t[0],i=1-t[1];break;case 6:e=t[1],i=1-t[0];break;case 8:e=1-t[1],i=t[0];break;default:e=t[0],i=t[1]}let n=this._width,r=this._height,s=Math.max(n,r);return[e*n/s-n/s/2,i*r/s-r/s/2]}_sfmToBasic(t){let e,i,n=this._width,r=this._height,s=Math.max(n,r),o=(t[0]+n/s/2)/n*s,a=(t[1]+r/s/2)/r*s;switch(this._orientation){case 1:e=o,i=a;break;case 3:e=1-o,i=1-a;break;case 6:e=1-a,i=o;break;case 8:e=a,i=1-o;break;default:e=o,i=a}return[e,i]}_getValue(t,e){return null!=t&&t>0?t:e}_getCameraParameters(t,e){if(dd(e))return[];if(!t||0===t.length)return[1,0,0];const i=3-t.length;return i<=0?t:t.concat(new Array(i).fill(0))}createWorldToCamera(t,e){const i=new fn(t[0],t[1],t[2]),n=i.length();n>0&&i.normalize();const r=new Hn;return r.makeRotationAxis(i,n),r.setPosition(new fn(e[0],e[1],e[2])),r}_createScaledWorldToCamera(t,e){const i=t.clone(),n=i.elements;return n[12]=e*n[12],n[13]=e*n[13],n[14]=e*n[14],i.scale(new fn(e,e,e)),i}_createBasicWorldToCamera(t,e){const i=new fn(0,0,1);let n=0;switch(e){case 3:n=Math.PI;break;case 6:n=Math.PI/2;break;case 8:n=3*Math.PI/2}return(new Hn).makeRotationAxis(i,n).multiply(t)}_getRadialPeak(t,e){const i=5*e,n=3*t,r=Math.pow(n,2)-4*i*1;if(r<0)return;const s=(-n-Math.sqrt(r))/2/i,o=(-n+Math.sqrt(r))/2/i,a=Math.min(s,o),c=Math.max(s,o);return a>0?Math.sqrt(a):c>0?Math.sqrt(c):void 0}_normalizedToTextureMatrix(){const t=Math.max(this._width,this._height),e=this._orientation<5?this._textureScale[0]:this._textureScale[1],i=this._orientation<5?this._textureScale[1]:this._textureScale[0],n=t/this._width*e,r=t/this._height*i;switch(this._orientation){case 1:return(new Hn).set(n,0,0,.5,0,-r,0,.5,0,0,1,0,0,0,0,1);case 3:return(new Hn).set(-n,0,0,.5,0,r,0,.5,0,0,1,0,0,0,0,1);case 6:return(new Hn).set(0,-r,0,.5,-n,0,0,.5,0,0,1,0,0,0,0,1);case 8:return(new Hn).set(0,r,0,.5,n,0,0,.5,0,0,1,0,0,0,0,1);default:return(new Hn).set(n,0,0,.5,0,-r,0,.5,0,0,1,0,0,0,0,1)}}}class Ud{constructor(t){this._spatial=new ld,this._referenceThreshold=.01,this._transitionMode=t.transitionMode,this._reference=t.reference,this._alpha=t.alpha,this._camera=t.camera.clone(),this._zoom=t.zoom,this._currentIndex=t.currentIndex,this._trajectory=t.trajectory.slice(),this._trajectoryTransforms=[],this._trajectoryCameras=[];for(let t of this._trajectory){let e=this._imageToTranslation(t,this._reference),i=new Hd(t.exifOrientation,t.width,t.height,t.scale,t.rotation,e,t.image,void 0,t.cameraParameters,t.cameraType);this._trajectoryTransforms.push(i),this._trajectoryCameras.push(new jd(i))}this._currentImage=this._trajectory.length>0?this._trajectory[this._currentIndex]:null,this._previousImage=this._trajectory.length>1&&this.currentIndex>0?this._trajectory[this._currentIndex-1]:null,this._currentCamera=this._trajectoryCameras.length>0?this._trajectoryCameras[this._currentIndex].clone():new jd,this._previousCamera=this._trajectoryCameras.length>1&&this.currentIndex>0?this._trajectoryCameras[this._currentIndex-1].clone():this._currentCamera.clone()}get reference(){return this._reference}get alpha(){return this._getAlpha()}get camera(){return this._camera}get zoom(){return this._zoom}get trajectory(){return this._trajectory}get currentIndex(){return this._currentIndex}get currentImage(){return this._currentImage}get previousImage(){return this._previousImage}get currentCamera(){return this._currentCamera}get currentTransform(){return this._trajectoryTransforms.length>0?this._trajectoryTransforms[this.currentIndex]:null}get previousTransform(){return this._trajectoryTransforms.length>1&&this.currentIndex>0?this._trajectoryTransforms[this.currentIndex-1]:null}get motionless(){return this._motionless}get transitionMode(){return this._transitionMode}move(t){}moveTo(t){}rotate(t){}rotateUnbounded(t){}rotateWithoutInertia(t){}rotateBasic(t){}rotateBasicUnbounded(t){}rotateBasicWithoutInertia(t){}rotateToBasic(t){}setSpeed(t){}zoomIn(t,e){}update(t){}setCenter(t){}setZoom(t){}dolly(t){}orbit(t){}setViewMatrix(t){}truck(t){}append(t){if(t.length<1)throw Error("Trajectory can not be empty");this._currentIndex<0?this.set(t):(this._trajectory=this._trajectory.concat(t),this._appendToTrajectories(t))}prepend(t){if(t.length<1)throw Error("Trajectory can not be empty");this._trajectory=t.slice().concat(this._trajectory),this._currentIndex+=t.length,this._setCurrentImage(),this._setReference(this._currentImage)?this._setTrajectories():this._prependToTrajectories(t),this._setCurrentCamera()}remove(t){if(t<0)throw Error("n must be a positive integer");if(this._currentIndex-1<t)throw Error("Current and previous images can not be removed");for(let e=0;e<t;e++)this._trajectory.shift(),this._trajectoryTransforms.shift(),this._trajectoryCameras.shift(),this._currentIndex--;this._setCurrentImage()}clearPrior(){this._currentIndex>0&&this.remove(this._currentIndex-1)}clear(){this.cut(),this._currentIndex>0&&this.remove(this._currentIndex-1)}cut(){for(;this._trajectory.length-1>this._currentIndex;)this._trajectory.pop(),this._trajectoryTransforms.pop(),this._trajectoryCameras.pop()}set(t){this._setTrajectory(t),this._setCurrentImage(),this._setReference(this._currentImage),this._setTrajectories(),this._setCurrentCamera()}getCenter(){return null!=this._currentImage?this.currentTransform.projectBasic(this._camera.lookat.toArray()):[.5,.5]}setTransitionMode(t){this._transitionMode=t}_getAlpha(){return 1}_setCurrent(){this._setCurrentImage(),this._setReference(this._currentImage)&&this._setTrajectories(),this._setCurrentCamera()}_setCurrentCamera(){this._currentCamera=this._trajectoryCameras[this._currentIndex].clone(),this._previousCamera=this._currentIndex>0?this._trajectoryCameras[this._currentIndex-1].clone():this._currentCamera.clone()}_motionlessTransition(){return null!=this._currentImage&&null!=this._previousImage&&(this._transitionMode===t.TransitionMode.Instantaneous||!(this._currentImage.merged&&this._previousImage.merged&&this._withinOriginalDistance()&&this._sameConnectedComponent()))}_setReference(t){return!(Math.abs(t.lngLat.lat-this.reference.lat)<this._referenceThreshold&&Math.abs(t.lngLat.lng-this.reference.lng)<this._referenceThreshold)&&(!(null!=this._previousImage&&!this._motionlessTransition())&&(this._reference.lat=t.lngLat.lat,this._reference.lng=t.lngLat.lng,this._reference.alt=t.computedAltitude,!0))}_setCurrentImage(){this._currentImage=this._trajectory.length>0?this._trajectory[this._currentIndex]:null,this._previousImage=this._currentIndex>0?this._trajectory[this._currentIndex-1]:null}_setTrajectory(t){if(t.length<1)throw new hd("Trajectory can not be empty");null!=this._currentImage?(this._trajectory=[this._currentImage].concat(t),this._currentIndex=1):(this._trajectory=t.slice(),this._currentIndex=0)}_setTrajectories(){this._trajectoryTransforms.length=0,this._trajectoryCameras.length=0,this._appendToTrajectories(this._trajectory)}_appendToTrajectories(t){for(let e of t){if(!e.assetsCached)throw new hd("Assets must be cached when image is added to trajectory");let t=this._imageToTranslation(e,this.reference),i=new Hd(e.exifOrientation,e.width,e.height,e.scale,e.rotation,t,e.image,void 0,e.cameraParameters,e.cameraType);this._trajectoryTransforms.push(i),this._trajectoryCameras.push(new jd(i))}}_prependToTrajectories(t){for(let e of t.reverse()){if(!e.assetsCached)throw new hd("Assets must be cached when added to trajectory");let t=this._imageToTranslation(e,this.reference),i=new Hd(e.exifOrientation,e.width,e.height,e.scale,e.rotation,t,e.image,void 0,e.cameraParameters,e.cameraType);this._trajectoryTransforms.unshift(i),this._trajectoryCameras.unshift(new jd(i))}}_imageToTranslation(t,e){return fd({alt:t.computedAltitude,lat:t.lngLat.lat,lng:t.lngLat.lng},t.rotation,e)}_sameConnectedComponent(){let t=this._currentImage,e=this._previousImage;return!!t&&!!e&&t.mergeId===e.mergeId}_withinOriginalDistance(){let t=this._currentImage,e=this._previousImage;return!t||!e||this._spatial.distanceFromLngLat(t.originalLngLat.lng,t.originalLngLat.lat,e.originalLngLat.lng,e.originalLngLat.lat)<25}}class Vd{constructor(t,e){this._phi=t,this._theta=e}get phi(){return this._phi}set phi(t){this._phi=t}get theta(){return this._theta}set theta(t){this._theta=t}get isZero(){return 0===this._phi&&0===this._theta}copy(t){this._phi=t.phi,this._theta=t.theta}lerp(t,e){this._phi=(1-e)*this._phi+e*t.phi,this._theta=(1-e)*this._theta+e*t.theta}multiply(t){this._phi*=t,this._theta*=t}threshold(t){this._phi=Math.abs(this._phi)>t?this._phi:0,this._theta=Math.abs(this._theta)>t?this._theta:0}lengthSquared(){return this._phi*this._phi+this._theta*this._theta}reset(){this._phi=0,this._theta=0}}class Gd extends Ud{constructor(t){super(t),this._animationSpeed=1/40,this._rotationDelta=new Vd(0,0),this._requestedRotationDelta=null,this._basicRotation=[0,0],this._requestedBasicRotation=null,this._requestedBasicRotationUnbounded=null,this._rotationAcceleration=.86,this._rotationIncreaseAlpha=.97,this._rotationDecreaseAlpha=.9,this._rotationThreshold=.001,this._unboundedRotationAlpha=.8,this._desiredZoom=t.zoom,this._minZoom=0,this._maxZoom=3,this._lookatDepth=10,this._desiredLookat=null,this._desiredCenter=null}rotate(t){null!=this._currentImage&&(0===t.phi&&0===t.theta||(this._desiredZoom=this._zoom,this._desiredLookat=null,this._requestedBasicRotation=null,null!=this._requestedRotationDelta?(this._requestedRotationDelta.phi=this._requestedRotationDelta.phi+t.phi,this._requestedRotationDelta.theta=this._requestedRotationDelta.theta+t.theta):this._requestedRotationDelta=new Vd(t.phi,t.theta)))}rotateUnbounded(t){if(null==this._currentImage)return;if(this._requestedBasicRotation=null,this._requestedRotationDelta=null,this._applyRotation(t,this._currentCamera),this._applyRotation(t,this._previousCamera),!this._desiredLookat)return;const e=(new pn).setFromUnitVectors(this._currentCamera.up,new fn(0,0,1)),i=e.clone().invert(),n=(new fn).copy(this._desiredLookat).sub(this._camera.position).applyQuaternion(e),r=n.length();let s=Math.atan2(n.y,n.x);s+=t.phi;let o=Math.atan2(Math.sqrt(n.x*n.x+n.y*n.y),n.z);o+=t.theta,o=Math.max(.1,Math.min(Math.PI-.1,o)),n.x=Math.sin(o)*Math.cos(s),n.y=Math.sin(o)*Math.sin(s),n.z=Math.cos(o),n.applyQuaternion(i),this._desiredLookat.copy(this._camera.position).add(n.multiplyScalar(r))}rotateWithoutInertia(t){if(null==this._currentImage)return;this._desiredZoom=this._zoom,this._desiredLookat=null,this._requestedBasicRotation=null,this._requestedRotationDelta=null;const e=Math.PI/(10*Math.pow(2,this._zoom)),i={phi:this._spatial.clamp(t.phi,-e,e),theta:this._spatial.clamp(t.theta,-e,e)};this._applyRotation(i,this._currentCamera),this._applyRotation(i,this._previousCamera)}rotateBasic(t){if(null!=this._currentImage)if(this._desiredZoom=this._zoom,this._desiredLookat=null,this._requestedRotationDelta=null,null!=this._requestedBasicRotation){this._requestedBasicRotation[0]+=t[0],this._requestedBasicRotation[1]+=t[1];let e=.05/Math.pow(2,this._zoom);this._requestedBasicRotation[0]=this._spatial.clamp(this._requestedBasicRotation[0],-e,e),this._requestedBasicRotation[1]=this._spatial.clamp(this._requestedBasicRotation[1],-e,e)}else this._requestedBasicRotation=t.slice()}rotateBasicUnbounded(t){null!=this._currentImage&&(null!=this._requestedBasicRotationUnbounded?(this._requestedBasicRotationUnbounded[0]+=t[0],this._requestedBasicRotationUnbounded[1]+=t[1]):this._requestedBasicRotationUnbounded=t.slice())}rotateBasicWithoutInertia(t){if(null==this._currentImage)return;this._desiredZoom=this._zoom,this._desiredLookat=null,this._requestedRotationDelta=null,this._requestedBasicRotation=null;const e=.05/Math.pow(2,this._zoom),i=t.slice();i[0]=this._spatial.clamp(i[0],-e,e),i[1]=this._spatial.clamp(i[1],-e,e),this._applyRotationBasic(i)}rotateToBasic(t){if(null==this._currentImage)return;this._desiredZoom=this._zoom,this._desiredLookat=null,t[0]=this._spatial.clamp(t[0],0,1),t[1]=this._spatial.clamp(t[1],0,1);let e=this.currentTransform.unprojectBasic(t,this._lookatDepth);this._currentCamera.lookat.fromArray(e)}zoomIn(t,e){if(null==this._currentImage)return;this._desiredZoom=Math.max(this._minZoom,Math.min(this._maxZoom,this._desiredZoom+t));let i=this.currentTransform.projectBasic(this._currentCamera.lookat.toArray()),n=i[0],r=i[1],s=Math.pow(2,this._zoom),o=Math.pow(2,this._desiredZoom),a=e[0],c=e[1];dd(this.currentTransform.cameraType)&&(a-n>.5?a-=1:n-a>.5&&(a=1+a));let h=a-s/o*(a-n),l=c-s/o*(c-r);dd(this._currentImage.cameraType)?(h=this._spatial.wrap(h+this._basicRotation[0],0,1),l=this._spatial.clamp(l+this._basicRotation[1],.05,.95)):(h=this._spatial.clamp(h,0,1),l=this._spatial.clamp(l,0,1)),this._desiredLookat=(new fn).fromArray(this.currentTransform.unprojectBasic([h,l],this._lookatDepth))}setCenter(t){this._desiredLookat=null,this._requestedRotationDelta=null,this._requestedBasicRotation=null,this._desiredZoom=this._zoom;let e=[this._spatial.clamp(t[0],0,1),this._spatial.clamp(t[1],0,1)];if(null==this._currentImage)return void(this._desiredCenter=e);this._desiredCenter=null;let i=(new fn).fromArray(this.currentTransform.unprojectBasic(e,this._lookatDepth)),n=null!=this.previousTransform?this.previousTransform:this.currentTransform,r=(new fn).fromArray(n.unprojectBasic(e,this._lookatDepth));this._currentCamera.lookat.copy(i),this._previousCamera.lookat.copy(r)}setZoom(t){this._desiredLookat=null,this._requestedRotationDelta=null,this._requestedBasicRotation=null,this._zoom=this._spatial.clamp(t,this._minZoom,this._maxZoom),this._desiredZoom=this._zoom}_applyRotation(t,e){if(null==e)return;let i=(new pn).setFromUnitVectors(e.up,new fn(0,0,1)),n=i.clone().invert(),r=new fn;r.copy(e.lookat).sub(e.position),r.applyQuaternion(i);let s=r.length(),o=Math.atan2(r.y,r.x);o+=t.phi;let a=Math.atan2(Math.sqrt(r.x*r.x+r.y*r.y),r.z);a+=t.theta,a=Math.max(.1,Math.min(Math.PI-.1,a)),r.x=Math.sin(a)*Math.cos(o),r.y=Math.sin(a)*Math.sin(o),r.z=Math.cos(a),r.applyQuaternion(n),e.lookat.copy(e.position).add(r.multiplyScalar(s))}_applyRotationBasic(t){let e=this._currentImage,i=null!=this._previousImage?this.previousImage:this.currentImage,n=this._currentCamera,r=this._previousCamera,s=this.currentTransform,o=null!=this.previousTransform?this.previousTransform:this.currentTransform,a=s.projectBasic(n.lookat.toArray()),c=o.projectBasic(r.lookat.toArray());dd(e.cameraType)?(a[0]=this._spatial.wrap(a[0]+t[0],0,1),a[1]=this._spatial.clamp(a[1]+t[1],.05,.95)):(a[0]=this._spatial.clamp(a[0]+t[0],0,1),a[1]=this._spatial.clamp(a[1]+t[1],0,1)),dd(i.cameraType)?(c[0]=this._spatial.wrap(c[0]+t[0],0,1),c[1]=this._spatial.clamp(c[1]+t[1],.05,.95)):(c[0]=this._spatial.clamp(c[0]+t[0],0,1),c[1]=this._spatial.clamp(a[1]+t[1],0,1));let h=s.unprojectBasic(a,this._lookatDepth);n.lookat.fromArray(h);let l=o.unprojectBasic(c,this._lookatDepth);r.lookat.fromArray(l)}_updateZoom(t){let e=this._desiredZoom-this._zoom,i=e>0?1:e<0?-1:0;0!==e&&(Math.abs(e)<.002?(this._zoom=this._desiredZoom,null!=this._desiredLookat&&(this._desiredLookat=null)):this._zoom+=i*Math.max(Math.abs(5*t*e),.002))}_updateLookat(t){if(null===this._desiredLookat)return;let e=this._desiredLookat.distanceToSquared(this._currentCamera.lookat);Math.abs(e)<1e-6?(this._currentCamera.lookat.copy(this._desiredLookat),this._desiredLookat=null):this._currentCamera.lookat.lerp(this._desiredLookat,5*t)}_updateRotation(){if(null!=this._requestedRotationDelta){let t=this._rotationDelta.lengthSquared();return this._requestedRotationDelta.lengthSquared()>t?this._rotationDelta.lerp(this._requestedRotationDelta,this._rotationIncreaseAlpha):this._rotationDelta.lerp(this._requestedRotationDelta,this._rotationDecreaseAlpha),void(this._requestedRotationDelta=null)}if(this._rotationDelta.isZero)return;const t=dd(this.currentImage.cameraType)?1:this._alpha;this._rotationDelta.multiply(this._rotationAcceleration*t),this._rotationDelta.threshold(this._rotationThreshold)}_updateRotationBasic(){if(null!=this._requestedBasicRotation){let t=this._basicRotation[0],e=this._basicRotation[1],i=this._requestedBasicRotation[0],n=this._requestedBasicRotation[1];return Math.abs(i)>Math.abs(t)?this._basicRotation[0]=(1-this._rotationIncreaseAlpha)*t+this._rotationIncreaseAlpha*i:this._basicRotation[0]=(1-this._rotationDecreaseAlpha)*t+this._rotationDecreaseAlpha*i,Math.abs(n)>Math.abs(e)?this._basicRotation[1]=(1-this._rotationIncreaseAlpha)*e+this._rotationIncreaseAlpha*n:this._basicRotation[1]=(1-this._rotationDecreaseAlpha)*e+this._rotationDecreaseAlpha*n,void(this._requestedBasicRotation=null)}if(null!=this._requestedBasicRotationUnbounded){let t=this._requestedBasicRotationUnbounded[0],e=this._requestedBasicRotationUnbounded[1];if(Math.abs(t)>0&&(this._basicRotation[0]=(1-this._unboundedRotationAlpha)*this._basicRotation[0]+this._unboundedRotationAlpha*t),Math.abs(e)>0&&(this._basicRotation[1]=(1-this._unboundedRotationAlpha)*this._basicRotation[1]+this._unboundedRotationAlpha*e),null!=this._desiredLookat){let i=this.currentTransform.projectBasic(this._desiredLookat.toArray());i[0]+=t,i[1]+=e,this._desiredLookat=(new fn).fromArray(this.currentTransform.unprojectBasic(i,this._lookatDepth))}this._requestedBasicRotationUnbounded=null}0===this._basicRotation[0]&&0===this._basicRotation[1]||(this._basicRotation[0]=this._rotationAcceleration*this._basicRotation[0],this._basicRotation[1]=this._rotationAcceleration*this._basicRotation[1],Math.abs(this._basicRotation[0])<this._rotationThreshold/Math.pow(2,this._zoom)&&Math.abs(this._basicRotation[1])<this._rotationThreshold/Math.pow(2,this._zoom)&&(this._basicRotation=[0,0]))}_clearRotation(){dd(this._currentImage.cameraType)||(null!=this._requestedRotationDelta&&(this._requestedRotationDelta=null),this._rotationDelta.isZero||this._rotationDelta.reset(),null!=this._requestedBasicRotation&&(this._requestedBasicRotation=null),(this._basicRotation[0]>0||this._basicRotation[1]>0)&&(this._basicRotation=[0,0]))}_setDesiredCenter(){if(null==this._desiredCenter)return;let t=(new fn).fromArray(this.currentTransform.unprojectBasic(this._desiredCenter,this._lookatDepth)).sub(this._currentCamera.position);this._currentCamera.lookat.copy(this._currentCamera.position.clone().add(t)),this._previousCamera.lookat.copy(this._previousCamera.position.clone().add(t)),this._desiredCenter=null}_setDesiredZoom(){this._desiredZoom=dd(this._currentImage.cameraType)||null==this._previousImage?this._zoom:0}}class qd extends Gd{constructor(t){super(t),this._adjustCameras(),this._motionless=this._motionlessTransition(),this._baseAlpha=this._alpha,this._speedCoefficient=1,this._unitBezier=new qd._interpolator(.74,.67,.38,.96),this._useBezier=!1}static register(t){qd._interpolator=t}append(t){let e=0===this._trajectory.length;e&&this._resetTransition(),super.append(t),e&&(this._setDesiredCenter(),this._setDesiredZoom())}prepend(t){let e=0===this._trajectory.length;e&&this._resetTransition(),super.prepend(t),e&&(this._setDesiredCenter(),this._setDesiredZoom())}set(t){super.set(t),this._desiredLookat=null,this._resetTransition(),this._clearRotation(),this._setDesiredCenter(),this._setDesiredZoom(),this._trajectory.length<3&&(this._useBezier=!0)}setSpeed(t){this._speedCoefficient=this._spatial.clamp(t,0,10)}update(t){1===this._alpha&&this._currentIndex+this._alpha<this._trajectory.length&&(this._currentIndex+=1,this._useBezier=this._trajectory.length<3&&this._currentIndex+1===this._trajectory.length,this._setCurrent(),this._resetTransition(),this._clearRotation(),this._desiredZoom=dd(this._currentImage.cameraType)?this._zoom:0,this._desiredLookat=null);let e=this._animationSpeed*(60/t);this._baseAlpha=Math.min(1,this._baseAlpha+this._speedCoefficient*e),this._useBezier?this._alpha=this._unitBezier.solve(this._baseAlpha):this._alpha=this._baseAlpha,this._updateRotation(),this._rotationDelta.isZero||(this._applyRotation(this._rotationDelta,this._previousCamera),this._applyRotation(this._rotationDelta,this._currentCamera)),this._updateRotationBasic(),0===this._basicRotation[0]&&0===this._basicRotation[1]||this._applyRotationBasic(this._basicRotation),this._updateZoom(e),this._updateLookat(e),this._camera.lerpCameras(this._previousCamera,this._currentCamera,this.alpha)}_getAlpha(){return this._motionless?Math.ceil(this._alpha):this._alpha}_setCurrentCamera(){super._setCurrentCamera(),this._adjustCameras()}_adjustCameras(){if(null==this._previousImage)return;let t=this._camera.lookat.clone().sub(this._camera.position);this._previousCamera.lookat.copy(t.clone().add(this._previousCamera.position)),dd(this._currentImage.cameraType)&&this._currentCamera.lookat.copy(t.clone().add(this._currentCamera.position))}_resetTransition(){this._alpha=0,this._baseAlpha=0,this._motionless=this._motionlessTransition()}}class Wd{constructor(t,e){this._components={};for(const i in Wd.registeredComponents){if(!Wd.registeredComponents.hasOwnProperty(i))continue;const n=Wd.registeredComponents[i];this._components[i]={active:!1,component:new n(i,t,e)}}this._coverComponent=new Wd.registeredCoverComponent("cover",t,e),this._coverComponent.activate(),this._coverActivated=!0}static register(t){void 0===Wd.registeredComponents[t.componentName]&&(Wd.registeredComponents[t.componentName]=t)}static registerCover(t){Wd.registeredCoverComponent=t}get coverActivated(){return this._coverActivated}activateCover(){if(!this._coverActivated){this._coverActivated=!0;for(const t in this._components){if(!this._components.hasOwnProperty(t))continue;const e=this._components[t];e.active&&e.component.deactivate()}}}deactivateCover(){if(this._coverActivated){this._coverActivated=!1;for(const t in this._components){if(!this._components.hasOwnProperty(t))continue;const e=this._components[t];e.active&&e.component.activate()}}}activate(t){this._checkName(t),this._components[t].active=!0,this._coverActivated||this.get(t).activate()}configure(t,e){this._checkName(t),this.get(t).configure(e)}deactivate(t){this._checkName(t),this._components[t].active=!1,this._coverActivated||this.get(t).deactivate()}get(t){return this._components[t].component}getCover(){return this._coverComponent}remove(){this._coverComponent.deactivate();for(const t in this._components)this._components.hasOwnProperty(t)&&this._components[t].component.deactivate()}_checkName(t){if(!(t in this._components))throw new hd(`Component does not exist: ${t}`)}}Wd.registeredComponents={};var Xd=Array.isArray,Yd=Object.prototype.toString,Zd=Xd||function(t){return"[object Array]"===Yd.call(t)};var Jd="2";Qd.NONE=0,Qd.VTEXT=1,Qd.VNODE=2,Qd.WIDGET=3,Qd.PROPS=4,Qd.ORDER=5,Qd.INSERT=6,Qd.REMOVE=7,Qd.THUNK=8;var Kd=Qd;function Qd(t,e,i){this.type=Number(t),this.vNode=e,this.patch=i}Qd.prototype.version=Jd,Qd.prototype.type="VirtualPatch";var tp=function(t){return t&&"VirtualNode"===t.type&&t.version===Jd};var ep=function(t){return t&&"VirtualText"===t.type&&t.version===Jd};var ip=function(t){return t&&"Widget"===t.type};var np=function(t){return t&&"Thunk"===t.type};var rp=function(t,e){var i=t,n=e;np(e)&&(n=sp(e,t));np(t)&&(i=sp(t,null));return{a:i,b:n}};function sp(t,e){var i=t.vnode;if(i||(i=t.vnode=t.render(e)),!(tp(i)||ep(i)||ip(i)))throw new Error("thunk did not return a valid node");return i}var op=function(t){return"object"==typeof t&&null!==t},ap=function(t){return t&&("function"==typeof t.hook&&!t.hasOwnProperty("hook")||"function"==typeof t.unhook&&!t.hasOwnProperty("unhook"))};var cp=function t(e,i){var n;for(var r in e){r in i||((n=n||{})[r]=void 0);var s=e[r],o=i[r];if(s!==o)if(op(s)&&op(o))if(hp(o)!==hp(s))(n=n||{})[r]=o;else if(ap(o))(n=n||{})[r]=o;else{var a=t(s,o);a&&((n=n||{})[r]=a)}else(n=n||{})[r]=o}for(var c in i)c in e||((n=n||{})[c]=i[c]);return n};function hp(t){return Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__?t.__proto__:t.constructor?t.constructor.prototype:void 0}function lp(t,e){var i={a:t};return up(t,e,i,0),i}function up(t,e,i,n){if(t!==e){var r=i[n],s=!1;if(np(t)||np(e))fp(t,e,i,n);else if(null==e)ip(t)||(dp(t,i,n),r=i[n]),r=vp(r,new Kd(Kd.REMOVE,t,e));else if(tp(e))if(tp(t))if(t.tagName===e.tagName&&t.namespace===e.namespace&&t.key===e.key){var o=cp(t.properties,e.properties);o&&(r=vp(r,new Kd(Kd.PROPS,t,o))),r=function(t,e,i,n,r){for(var s=t.children,o=function(t,e){var i=_p(e),n=i.keys,r=i.free;if(r.length===e.length)return{children:e,moves:null};var s=_p(t),o=s.keys;if(s.free.length===t.length)return{children:e,moves:null};for(var a=[],c=0,h=r.length,l=0,u=0;u<t.length;u++){var d,p=t[u];p.key?n.hasOwnProperty(p.key)?(d=n[p.key],a.push(e[d])):(d=u-l++,a.push(null)):c<h?(d=r[c++],a.push(e[d])):(d=u-l++,a.push(null))}for(var f=c>=r.length?e.length:r[c],m=0;m<e.length;m++){var g=e[m];g.key?o.hasOwnProperty(g.key)||a.push(g):m>=f&&a.push(g)}for(var _,v=a.slice(),y=0,b=[],x=[],w=0;w<e.length;){var S=e[w];for(_=v[y];null===_&&v.length;)b.push(gp(v,y,null)),_=v[y];_&&_.key===S.key?(y++,w++):S.key?(_&&_.key&&n[_.key]!==w+1?(b.push(gp(v,y,_.key)),(_=v[y])&&_.key===S.key?y++:x.push({key:S.key,to:w})):x.push({key:S.key,to:w}),w++):_&&_.key&&b.push(gp(v,y,_.key))}for(;y<v.length;)_=v[y],b.push(gp(v,y,_&&_.key));if(b.length===l&&!x.length)return{children:a,moves:null};return{children:a,moves:{removes:b,inserts:x}}}(s,e.children),a=o.children,c=s.length,h=a.length,l=c>h?c:h,u=0;u<l;u++){var d=s[u],p=a[u];r+=1,d?up(d,p,i,r):p&&(n=vp(n,new Kd(Kd.INSERT,null,p))),tp(d)&&d.count&&(r+=d.count)}o.moves&&(n=vp(n,new Kd(Kd.ORDER,t,o.moves)));return n}(t,e,i,r,n)}else r=vp(r,new Kd(Kd.VNODE,t,e)),s=!0;else r=vp(r,new Kd(Kd.VNODE,t,e)),s=!0;else ep(e)?ep(t)?t.text!==e.text&&(r=vp(r,new Kd(Kd.VTEXT,t,e))):(r=vp(r,new Kd(Kd.VTEXT,t,e)),s=!0):ip(e)&&(ip(t)||(s=!0),r=vp(r,new Kd(Kd.WIDGET,t,e)));r&&(i[n]=r),s&&dp(t,i,n)}}function dp(t,e,i){mp(t,e,i),pp(t,e,i)}function pp(t,e,i){if(ip(t))"function"==typeof t.destroy&&(e[i]=vp(e[i],new Kd(Kd.REMOVE,t,null)));else if(tp(t)&&(t.hasWidgets||t.hasThunks))for(var n=t.children,r=n.length,s=0;s<r;s++){var o=n[s];pp(o,e,i+=1),tp(o)&&o.count&&(i+=o.count)}else np(t)&&fp(t,null,e,i)}function fp(t,e,i,n){var r=rp(t,e),s=lp(r.a,r.b);(function(t){for(var e in t)if("a"!==e)return!0;return!1})(s)&&(i[n]=new Kd(Kd.THUNK,null,s))}function mp(t,e,i){if(tp(t)){if(t.hooks&&(e[i]=vp(e[i],new Kd(Kd.PROPS,t,function(t){var e={};for(var i in t)e[i]=void 0;return e}(t.hooks)))),t.descendantHooks||t.hasThunks)for(var n=t.children,r=n.length,s=0;s<r;s++){var o=n[s];mp(o,e,i+=1),tp(o)&&o.count&&(i+=o.count)}}else np(t)&&fp(t,null,e,i)}function gp(t,e,i){return t.splice(e,1),{from:e,key:i}}function _p(t){for(var e={},i=[],n=t.length,r=0;r<n;r++){var s=t[r];s.key?e[s.key]=r:i.push(r)}return{keys:e,free:i}}function vp(t,e){return t?(Zd(t)?t.push(e):t=[t,e],t):e}var yp=lp,bp="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function xp(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})})),e}function wp(t){var e={exports:{}};return t(e,e.exports),e.exports}var Sp=Array.prototype.slice,Mp=function(t,e){"length"in t||(t=[t]);t=Sp.call(t);for(;t.length;){var i=t.shift(),n=e(i);if(n)return n;i.childNodes&&i.childNodes.length&&(t=Sp.call(i.childNodes).concat(t))}};var Tp=Cp;function Cp(t,e){if(!(this instanceof Cp))return new Cp(t,e);this.data=t,this.nodeValue=t,this.length=t.length,this.ownerDocument=e||null}Cp.prototype.nodeType=8,Cp.prototype.nodeName="#comment",Cp.prototype.toString=function(){return"[object Comment]"};var Ep=Ip;function Ip(t,e){if(!(this instanceof Ip))return new Ip(t);this.data=t||"",this.length=this.data.length,this.ownerDocument=e||null}Ip.prototype.type="DOMTextNode",Ip.prototype.nodeType=3,Ip.prototype.nodeName="#text",Ip.prototype.toString=function(){return this.data},Ip.prototype.replaceData=function(t,e,i){var n=this.data,r=n.substring(0,t),s=n.substring(t+e,n.length);this.data=r+i+s,this.length=this.data.length};var Ap=function(t){var e=this,i=t.type;t.target||(t.target=e);e.listeners||(e.listeners={});var n=e.listeners[i];if(n)return n.forEach((function(i){t.currentTarget=e,"function"==typeof i?i(t):i.handleEvent(t)}));e.parentNode&&e.parentNode.dispatchEvent(t)};var Pp=function(t,e){var i=this;i.listeners||(i.listeners={});i.listeners[t]||(i.listeners[t]=[]);-1===i.listeners[t].indexOf(e)&&i.listeners[t].push(e)};var Rp=function(t,e){var i=this;if(!i.listeners)return;if(!i.listeners[t])return;var n=i.listeners[t],r=n.indexOf(e);-1!==r&&n.splice(r,1)};var Lp=Np,Op=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function Np(t){switch(t.nodeType){case 3:return kp(t.data);case 8:return"\x3c!--"+t.data+"--\x3e";default:return function(t){var e=[],i=t.tagName;"http://www.w3.org/1999/xhtml"===t.namespaceURI&&(i=i.toLowerCase());e.push("<"+i+function(t){var e=[];for(var i in t)Dp(t,i)&&e.push({name:i,value:t[i]});for(var n in t._attributes)for(var r in t._attributes[n]){var s=t._attributes[n][r],o=(s.prefix?s.prefix+":":"")+r;e.push({name:o,value:s.value})}t.className&&e.push({name:"class",value:t.className});return e.length?$p(e):""}(t)+function(t){var e=t.dataset,i=[];for(var n in e)i.push({name:"data-"+n,value:e[n]});return i.length?$p(i):""}(t)),Op.indexOf(i)>-1?e.push(" />"):(e.push(">"),t.childNodes.length?e.push.apply(e,t.childNodes.map(Np)):t.textContent||t.innerText?e.push(kp(t.textContent||t.innerText)):t.innerHTML&&e.push(t.innerHTML),e.push("</"+i+">"));return e.join("")}(t)}}function Dp(t,e){var i=typeof t[e];return"style"===e&&Object.keys(t.style).length>0||t.hasOwnProperty(e)&&("string"===i||"boolean"===i||"number"===i)&&"nodeName"!==e&&"className"!==e&&"tagName"!==e&&"textContent"!==e&&"innerText"!==e&&"namespaceURI"!==e&&"innerHTML"!==e}function $p(t){var e=[];return t.forEach((function(t){var i=t.name,n=t.value;"style"===i&&(n=function(t){if("string"==typeof t)return t;var e="";return Object.keys(t).forEach((function(i){var n=t[i];i=i.replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()})),e+=i+":"+n+";"})),e}(n)),e.push(i+'="'+(kp(n).replace(/"/g,"&quot;")+'"'))})),e.length?" "+e.join(" "):""}function kp(t){var e="";return"string"==typeof t?e=t:t&&(e=t.toString()),e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var zp="http://www.w3.org/1999/xhtml",Fp=Bp;function Bp(t,e,i){if(!(this instanceof Bp))return new Bp(t);var n=void 0===i?zp:i||null;this.tagName=n===zp?String(t).toUpperCase():t,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=e||null,this.namespaceURI=n,this._attributes={},"INPUT"===this.tagName&&(this.type="text")}Bp.prototype.type="DOMElement",Bp.prototype.nodeType=1,Bp.prototype.appendChild=function(t){return t.parentNode&&t.parentNode.removeChild(t),this.childNodes.push(t),t.parentNode=this,t},Bp.prototype.replaceChild=function(t,e){t.parentNode&&t.parentNode.removeChild(t);var i=this.childNodes.indexOf(e);return e.parentNode=null,this.childNodes[i]=t,t.parentNode=this,e},Bp.prototype.removeChild=function(t){var e=this.childNodes.indexOf(t);return this.childNodes.splice(e,1),t.parentNode=null,t},Bp.prototype.insertBefore=function(t,e){t.parentNode&&t.parentNode.removeChild(t);var i=null==e?-1:this.childNodes.indexOf(e);return i>-1?this.childNodes.splice(i,0,t):this.childNodes.push(t),t.parentNode=this,t},Bp.prototype.setAttributeNS=function(t,e,i){var n=null,r=e,s=e.indexOf(":");(s>-1&&(n=e.substr(0,s),r=e.substr(s+1)),"INPUT"===this.tagName&&"type"===e)?this.type=i:(this._attributes[t]||(this._attributes[t]={}))[r]={value:i,prefix:n}},Bp.prototype.getAttributeNS=function(t,e){var i=this._attributes[t],n=i&&i[e]&&i[e].value;return"INPUT"===this.tagName&&"type"===e?this.type:"string"!=typeof n?null:n},Bp.prototype.removeAttributeNS=function(t,e){var i=this._attributes[t];i&&delete i[e]},Bp.prototype.hasAttributeNS=function(t,e){var i=this._attributes[t];return!!i&&e in i},Bp.prototype.setAttribute=function(t,e){return this.setAttributeNS(null,t,e)},Bp.prototype.getAttribute=function(t){return this.getAttributeNS(null,t)},Bp.prototype.removeAttribute=function(t){return this.removeAttributeNS(null,t)},Bp.prototype.hasAttribute=function(t){return this.hasAttributeNS(null,t)},Bp.prototype.removeEventListener=Rp,Bp.prototype.addEventListener=Pp,Bp.prototype.dispatchEvent=Ap,Bp.prototype.focus=function(){},Bp.prototype.toString=function(){return Lp(this)},Bp.prototype.getElementsByClassName=function(t){var e=t.split(" "),i=[];return Mp(this,(function(t){if(1===t.nodeType){var n=(t.className||"").split(" ");e.every((function(t){return-1!==n.indexOf(t)}))&&i.push(t)}})),i},Bp.prototype.getElementsByTagName=function(t){t=t.toLowerCase();var e=[];return Mp(this.childNodes,(function(i){1!==i.nodeType||"*"!==t&&i.tagName.toLowerCase()!==t||e.push(i)})),e},Bp.prototype.contains=function(t){return Mp(this,(function(e){return t===e}))||!1};var jp=Hp;function Hp(t){if(!(this instanceof Hp))return new Hp;this.childNodes=[],this.parentNode=null,this.ownerDocument=t||null}Hp.prototype.type="DocumentFragment",Hp.prototype.nodeType=11,Hp.prototype.nodeName="#document-fragment",Hp.prototype.appendChild=Fp.prototype.appendChild,Hp.prototype.replaceChild=Fp.prototype.replaceChild,Hp.prototype.removeChild=Fp.prototype.removeChild,Hp.prototype.toString=function(){return this.childNodes.map((function(t){return String(t)})).join("")};var Up=Vp;function Vp(t){}Vp.prototype.initEvent=function(t,e,i){this.type=t,this.bubbles=e,this.cancelable=i},Vp.prototype.preventDefault=function(){};var Gp=qp;function qp(){if(!(this instanceof qp))return new qp;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var Wp=qp.prototype;Wp.createTextNode=function(t){return new Ep(t,this)},Wp.createElementNS=function(t,e){var i=null===t?null:String(t);return new Fp(e,this,i)},Wp.createElement=function(t){return new Fp(t,this)},Wp.createDocumentFragment=function(){return new jp(this)},Wp.createEvent=function(t){return new Up(t)},Wp.createComment=function(t){return new Tp(t,this)},Wp.getElementById=function(t){return t=String(t),Mp(this.childNodes,(function(e){if(String(e.id)===t)return e}))||null},Wp.getElementsByClassName=Fp.prototype.getElementsByClassName,Wp.getElementsByTagName=Fp.prototype.getElementsByTagName,Wp.contains=Fp.prototype.contains,Wp.removeEventListener=Rp,Wp.addEventListener=Pp,Wp.dispatchEvent=Ap;var Xp,Yp=new Gp,Zp=void 0!==bp?bp:"undefined"!=typeof window?window:{};"undefined"!=typeof document?Xp=document:(Xp=Zp["__GLOBAL_DOCUMENT_CACHE@4"])||(Xp=Zp["__GLOBAL_DOCUMENT_CACHE@4"]=Yp);var Jp=Xp,Kp=function(t,e,i){for(var n in e){var r=e[n];void 0===r?Qp(t,n,r,i):ap(r)?(Qp(t,n,r,i),r.hook&&r.hook(t,n,i?i[n]:void 0)):op(r)?tf(t,e,i,n,r):t[n]=r}};function Qp(t,e,i,n){if(n){var r=n[e];if(ap(r))r.unhook&&r.unhook(t,e,i);else if("attributes"===e)for(var s in r)t.removeAttribute(s);else if("style"===e)for(var o in r)t.style[o]="";else t[e]="string"==typeof r?"":null}}function tf(t,e,i,n,r){var s=i?i[n]:void 0;if("attributes"!==n)if(s&&op(s)&&ef(s)!==ef(r))t[n]=r;else{op(t[n])||(t[n]={});var o="style"===n?"":void 0;for(var a in r){var c=r[a];t[n][a]=void 0===c?o:c}}else for(var h in r){var l=r[h];void 0===l?t.removeAttribute(h):t.setAttribute(h,l)}}function ef(t){return Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__?t.__proto__:t.constructor?t.constructor.prototype:void 0}var nf=function t(e,i){var n=i&&i.document||Jp,r=i?i.warn:null;if(e=rp(e).a,ip(e))return e.init();if(ep(e))return n.createTextNode(e.text);if(!tp(e))return r&&r("Item is not a valid virtual dom node",e),null;var s=null===e.namespace?n.createElement(e.tagName):n.createElementNS(e.namespace,e.tagName),o=e.properties;Kp(s,o);for(var a=e.children,c=0;c<a.length;c++){var h=t(a[c],i);h&&s.appendChild(h)}return s};var rf={},sf=function(t,e,i,n){return i&&0!==i.length?(i.sort(cf),of(t,e,i,n,0)):{}};function of(t,e,i,n,r){if(n=n||{},t){af(i,r,r)&&(n[r]=t);var s=e.children;if(s)for(var o=t.childNodes,a=0;a<e.children.length;a++){r+=1;var c=s[a]||rf,h=r+(c.count||0);af(i,r,h)&&of(o[a],c,i,n,r),r=h}}return n}function af(t,e,i){if(0===t.length)return!1;for(var n,r,s=0,o=t.length-1;s<=o;){if(r=t[n=(o+s)/2>>0],s===o)return r>=e&&r<=i;if(r<e)s=n+1;else{if(!(r>i))return!0;o=n-1}}return!1}function cf(t,e){return t>e?1:-1}var hf=function(t,e){if(ip(t)&&ip(e))return"name"in t&&"name"in e?t.id===e.id:t.init===e.init;return!1};var lf=function(t,e,i){var n=t.type,r=t.vNode,s=t.patch;switch(n){case Kd.REMOVE:return function(t,e){var i=t.parentNode;i&&i.removeChild(t);return uf(t,e),null}(e,r);case Kd.INSERT:return function(t,e,i){var n=i.render(e,i);t&&t.appendChild(n);return t}(e,s,i);case Kd.VTEXT:return function(t,e,i,n){var r;if(3===t.nodeType)t.replaceData(0,t.length,i.text),r=t;else{var s=t.parentNode;r=n.render(i,n),s&&r!==t&&s.replaceChild(r,t)}return r}(e,0,s,i);case Kd.WIDGET:return function(t,e,i,n){var r,s=hf(e,i);r=s?i.update(e,t)||t:n.render(i,n);var o=t.parentNode;o&&r!==t&&o.replaceChild(r,t);s||uf(t,e);return r}(e,r,s,i);case Kd.VNODE:return function(t,e,i,n){var r=t.parentNode,s=n.render(i,n);r&&s!==t&&r.replaceChild(s,t);return s}(e,0,s,i);case Kd.ORDER:return function(t,e){for(var i,n,r,s=t.childNodes,o={},a=0;a<e.removes.length;a++)i=s[(n=e.removes[a]).from],n.key&&(o[n.key]=i),t.removeChild(i);for(var c=s.length,h=0;h<e.inserts.length;h++)i=o[(r=e.inserts[h]).key],t.insertBefore(i,r.to>=c++?null:s[r.to])}(e,s),e;case Kd.PROPS:return Kp(e,s,r.properties),e;case Kd.THUNK:return function(t,e){t&&e&&t!==e&&t.parentNode&&t.parentNode.replaceChild(e,t);return e}(e,i.patch(e,s,i));default:return e}};function uf(t,e){"function"==typeof e.destroy&&ip(e)&&e.destroy(t)}function df(t,e,i){var n=function(t){var e=[];for(var i in t)"a"!==i&&e.push(Number(i));return e}(e);if(0===n.length)return t;var r=sf(t,e.a,n),s=t.ownerDocument;i.document||s===Jp||(i.document=s);for(var o=0;o<n.length;o++){var a=n[o];t=pf(t,r[a],e[a],i)}return t}function pf(t,e,i,n){if(!e)return t;var r;if(Zd(i))for(var s=0;s<i.length;s++)r=lf(i[s],e,n),e===t&&(t=r);else r=lf(i,e,n),e===t&&(t=r);return t}var ff=function t(e,i,n){return(n=n||{}).patch=n.patch&&n.patch!==t?n.patch:df,n.render=n.render||nf,n.patch(e,i,n)},mf=vf,gf={},_f=[];function vf(t,e,i,n,r){this.tagName=t,this.properties=e||gf,this.children=i||_f,this.key=null!=n?String(n):void 0,this.namespace="string"==typeof r?r:null;var s,o=i&&i.length||0,a=0,c=!1,h=!1,l=!1;for(var u in e)if(e.hasOwnProperty(u)){var d=e[u];ap(d)&&d.unhook&&(s||(s={}),s[u]=d)}for(var p=0;p<o;p++){var f=i[p];tp(f)?(a+=f.count||0,!c&&f.hasWidgets&&(c=!0),!h&&f.hasThunks&&(h=!0),l||!f.hooks&&!f.descendantHooks||(l=!0)):!c&&ip(f)?"function"==typeof f.destroy&&(c=!0):!h&&np(f)&&(h=!0)}this.count=o+a,this.hasWidgets=c,this.hasThunks=h,this.hooks=s,this.descendantHooks=l}vf.prototype.version=Jd,vf.prototype.type="VirtualNode";var yf=bf;function bf(t){this.text=String(t)}bf.prototype.version=Jd,bf.prototype.type="VirtualText";
/*!
     * Cross-Browser Split 1.1.1
     * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
     * Available under the MIT License
     * ECMAScript compliant, uniform cross-browser split method
     */
var xf,wf,Sf,Mf=(wf=String.prototype.split,Sf=/()??/.exec("")[1]===xf,function(t,e,i){if("[object RegExp]"!==Object.prototype.toString.call(e))return wf.call(t,e,i);var n,r,s,o,a=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),h=0;for(e=new RegExp(e.source,c+"g"),t+="",Sf||(n=new RegExp("^"+e.source+"$(?!\\s)",c)),i=i===xf?-1>>>0:i>>>0;(r=e.exec(t))&&!((s=r.index+r[0].length)>h&&(a.push(t.slice(h,r.index)),!Sf&&r.length>1&&r[0].replace(n,(function(){for(var t=1;t<arguments.length-2;t++)arguments[t]===xf&&(r[t]=xf)})),r.length>1&&r.index<t.length&&Array.prototype.push.apply(a,r.slice(1)),o=r[0].length,h=s,a.length>=i));)e.lastIndex===r.index&&e.lastIndex++;return h===t.length?!o&&e.test("")||a.push(""):a.push(t.slice(h)),a.length>i?a.slice(0,i):a}),Tf=/([\.#]?[a-zA-Z0-9\u007F-\uFFFF_:-]+)/,Cf=/^\.|#/,Ef=function(t,e){if(!t)return"DIV";var i,n,r,s,o=!e.hasOwnProperty("id"),a=Mf(t,Tf),c=null;Cf.test(a[1])&&(c="DIV");for(s=0;s<a.length;s++)(n=a[s])&&(r=n.charAt(0),c?"."===r?(i=i||[]).push(n.substring(1,n.length)):"#"===r&&o&&(e.id=n.substring(1,n.length)):c=n);i&&(e.className&&i.push(e.className),e.className=i.join(" "));return e.namespace?c:c.toUpperCase()};var If=Af;function Af(t){if(!(this instanceof Af))return new Af(t);this.value=t}Af.prototype.hook=function(t,e){t[e]!==this.value&&(t[e]=this.value)};var Pf="undefined"!=typeof window?window:void 0!==bp?bp:{},Rf=function(t,e){if(t in Pf)return Pf[t];return Pf[t]=e,e};(function(t,e,i){var n="__INDIVIDUAL_ONE_VERSION_"+t,r=Rf(n+"_ENFORCE_SINGLETON",e);if(r!==e)throw new Error("Can only have one copy of "+t+".\nYou already have version "+r+" installed.\nThis means you cannot install version "+e);Rf(n,i)})("ev-store","7");var Lf="__EV_STORE_KEY@7",Of=function(t){var e=t[Lf];e||(e=t[Lf]={});return e};var Nf=Df;function Df(t){if(!(this instanceof Df))return new Df(t);this.value=t}function $f(t,e,i,n){if("string"==typeof t)e.push(new yf(t));else if("number"==typeof t)e.push(new yf(String(t)));else if(kf(t))e.push(t);else{if(!Zd(t)){if(null==t)return;throw function(t){var e=new Error;return e.type="virtual-hyperscript.unexpected.virtual-element",e.message="Unexpected virtual child passed to h().\nExpected a VNode / Vthunk / VWidget / string but:\ngot:\n"+zf(t.foreignObject)+".\nThe parent vnode is:\n"+zf(t.parentVnode),e.foreignObject=t.foreignObject,e.parentVnode=t.parentVnode,e}({foreignObject:t,parentVnode:{tagName:i,properties:n}})}for(var r=0;r<t.length;r++)$f(t[r],e,i,n)}}function kf(t){return tp(t)||ep(t)||ip(t)||np(t)}function zf(t){try{return JSON.stringify(t,null,"    ")}catch(e){return String(t)}}Df.prototype.hook=function(t,e){Of(t)[e.substr(3)]=this.value},Df.prototype.unhook=function(t,e){Of(t)[e.substr(3)]=void 0};var Ff,Bf,jf={diff:yp,patch:ff,h:function(t,e,i){var n,r,s,o,a=[];!i&&(c=e,"string"==typeof c||Zd(c)||kf(c))&&(i=e,r={});var c;n=Ef(t,r=r||e||{}),r.hasOwnProperty("key")&&(s=r.key,r.key=void 0);r.hasOwnProperty("namespace")&&(o=r.namespace,r.namespace=void 0);"INPUT"!==n||o||!r.hasOwnProperty("value")||void 0===r.value||ap(r.value)||(r.value=If(r.value));(function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];if(ap(i))continue;"ev-"===e.substr(0,3)&&(t[e]=Nf(i))}})(r),null!=i&&$f(i,a,n,r);return new mf(n,r,a,s,o)},create:nf,VNode:mf,VText:yf};class Hf{constructor(){this._events={}}on(t,e){this._events[t]=this._events[t]||[],this._events[t].push(e)}off(t,e){if(t){if(this._listens(t)){const i=this._events[t].indexOf(e);i>=0&&this._events[t].splice(i,1),this._events[t].length||delete this._events[t]}}else this._events={}}fire(t,e){if(this._listens(t))for(const i of this._events[t])i(e)}_listens(t){return t in this._events}}class Uf{constructor(){this._subscriptions=[]}push(t){this._subscriptions.push(t)}unsubscribe(){for(const t of this._subscriptions)t.unsubscribe();this._subscriptions=[]}}class Vf extends Hf{constructor(t,e,i){super(),this._activated$=new O(!1),this._configurationSubject$=new T,this._activated=!1,this._container=e,this._name=t,this._navigator=i,this._subscriptions=new Uf,this._configuration$=this._configurationSubject$.pipe(ni(this.defaultConfiguration),Le(((t,e)=>{for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t})),Ue(1),E()),this._configuration$.subscribe((()=>{}))}get activated(){return this._activated}get activated$(){return this._activated$}get defaultConfiguration(){return this._getDefaultConfiguration()}get configuration$(){return this._configuration$}get name(){return this._name}activate(t){this._activated||(void 0!==t&&this._configurationSubject$.next(t),this._activated=!0,this._activate(),this._activated$.next(!0))}configure(t){this._configurationSubject$.next(t)}deactivate(){this._activated&&(this._activated=!1,this._deactivate(),this._container.domRenderer.clear(this._name),this._container.glRenderer.clear(this._name),this._activated$.next(!1))}fire(t,e){super.fire(t,e)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}resize(){}}!function(t){t[t.Hidden=0]="Hidden",t[t.Loading=1]="Loading",t[t.Visible=2]="Visible"}(Ff||(Ff={}));class Gf extends Vf{constructor(t,e,i){super(t,e,i)}_activate(){const t=this.configuration$.pipe(Ee((t=>!!t.id)),Nt((t=>!t.src)),ri((t=>this._getImageSrc$(t.id).pipe(te((t=>(console.error(t),B())))))),Ue(1),E()),e=this._subscriptions;e.push(t.pipe(rt((t=>({src:t})))).subscribe((t=>{this._configurationSubject$.next(t)}))),e.push(gt(this.configuration$,t).pipe(Nt((([t,e])=>!!t.src&&t.src!==e)),Ee()).subscribe((([,t])=>{window.URL.revokeObjectURL(t)}))),e.push(this._configuration$.pipe(ue(void 0,(t=>t.state)),ri((t=>gt(G(t.state),this._navigator.stateService.currentImage$))),ri((([t,e])=>{const i=gt(G(e.id),e.image$.pipe(Nt((t=>!!t)),rt((t=>t.src))));return t===Ff.Visible?i.pipe(Ee()):i})),ue((([t,e],[i,n])=>t===i&&e===n)),rt((([t,e])=>({id:t,src:e})))).subscribe(this._configurationSubject$)),e.push(gt(this._configuration$,this._container.configurationService.exploreUrl$,this._container.renderService.size$).pipe(rt((([t,e,i])=>{if(!t.src)return{name:this._name,vNode:jf.h("div",[])};const n=i.width<=640||i.height<=480?".mapillary-cover-compact":"";if(t.state===Ff.Hidden){const e=jf.h("div.mapillary-cover-container.mapillary-cover-done"+n,[this._getCoverBackgroundVNode(t)]);return{name:this._name,vNode:e}}const r=jf.h("div.mapillary-cover-container"+n,[this._getCoverButtonVNode(t,e)]);return{name:this._name,vNode:r}}))).subscribe(this._container.domRenderer.render$))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{state:Ff.Visible}}_getCoverButtonVNode(t,e){const i=t.state===Ff.Loading?"div.mapillary-cover.mapillary-cover-loading":"div.mapillary-cover",n=jf.h("div.mapillary-cover-button",[jf.h("div.mapillary-cover-button-icon",[])]),r=jf.h("a.mapillary-cover-logo",{href:e,target:"_blank"},[]),s=jf.h("div.mapillary-cover-indicator",{onclick:()=>{this.configure({state:Ff.Loading})}},[]);return jf.h(i,[this._getCoverBackgroundVNode(t),s,n,r])}_getCoverBackgroundVNode(t){const e={style:{backgroundImage:`url(${t.src})`}},i=[];return t.state===Ff.Loading&&i.push(jf.h("div.mapillary-cover-spinner",{},[])),jf.h("div.mapillary-cover-background",e,i)}_getImageSrc$(t){return b.create((e=>{this._navigator.api.getImages$([t]).subscribe((i=>{for(const n of i)if(n.node_id===t)return void this._navigator.api.data.getImageBuffer(n.node.thumb.url).then((i=>{const n=new Image;n.crossOrigin="Anonymous",n.onload=()=>{e.next(n.src),e.complete()},n.onerror=()=>{e.error(new Error(`Failed to load cover image (${t})`))};const r=new Blob([i]);n.src=window.URL.createObjectURL(r)}),(t=>{e.error(t)}));e.error(new cd(`Non existent cover key: ${t}`))}),(t=>{e.error(t)}))}))}}Gf.componentName="cover";class qf extends Vf{_activate(){this._subscriptions.push(gt(this._container.configurationService.exploreUrl$,this._navigator.stateService.currentImage$,this._container.renderService.size$).pipe(rt((([t,e,i])=>{const n=this._makeAttribution(e.creatorUsername,t,e.id,e.capturedAt,i.width);return{name:this._name,vNode:n}}))).subscribe(this._container.domRenderer.render$))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{}}makeImageUrl(t,e){return`${t}/app/?pKey=${e}&focus=photo`}_makeAttribution(t,e,i,n,r){const s=r<=640,o=this._makeDate(n,s),a=this._makeBy(t,e,i,s),c=s?".mapillary-attribution-compact":"";return jf.h("div.mapillary-attribution-container"+c,{},[...a,o])}_makeBy(t,e,i,n){const r=jf.h("div.mapillary-attribution-logo",[]);return t?this._makeCreatorBy(r,t,e,i,n):this._makeGeneralBy(r,e,i,n)}_makeCreatorBy(t,e,i,n,r){const s=jf.h("a.mapillary-attribution-icon-container",{href:i,rel:"noreferrer",target:"_blank"},[t]),o=r?`${e}`:`image by ${e}`,a=jf.h("div.mapillary-attribution-username",{textContent:o},[]);return[s,jf.h("a.mapillary-attribution-image-container",{href:this.makeImageUrl(i,n),rel:"noreferrer",target:"_blank"},[a])]}_makeGeneralBy(t,e,i,n){const r=jf.h("div.mapillary-attribution-username",{textContent:"images by"},[]),s=[jf.h("div.mapillary-attribution-icon-container",{},[t]),jf.h("div.mapillary-attribution-username",{textContent:"contributors"},[])];n||s.unshift(r);return[jf.h("a.mapillary-attribution-image-container",{href:this.makeImageUrl(e,i),rel:"noreferrer",target:"_blank"},s)]}_makeDate(t,e){const i=new Date(t).toDateString().split(" "),n=(i.length>3?e?[i[3]]:[i[1],i[2]+",",i[3]]:i).join(" ");return jf.h("div.mapillary-attribution-date",{textContent:n},[])}}qf.componentName="attribution";class Wf{constructor(){this._unprojectDepth=200}basicToCanvas(t,e,i,n,r){const s=n.unprojectBasic([t,e],this._unprojectDepth);return this.projectToCanvas(s,i,r)}basicToCanvasSafe(t,e,i,n,r){const s=this.basicToViewportSafe(t,e,n,r);if(null===s)return null;return this.viewportToCanvas(s[0],s[1],i)}basicToViewport(t,e,i,n){const r=i.unprojectBasic([t,e],this._unprojectDepth);return this.projectToViewport(r,n)}basicToViewportSafe(t,e,i,n){const r=i.unprojectBasic([t,e],this._unprojectDepth);if(this.worldToCamera(r,n)[2]>0)return null;return this.projectToViewport(r,n)}cameraToViewport(t,e){const i=(new fn).fromArray(t).applyMatrix4(e.projectionMatrix);return[i.x,i.y]}canvasPosition(t,e){const i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}canvasToBasic(t,e,i,n,r){const s=this.unprojectFromCanvas(t,e,i,r).toArray();return n.projectBasic(s)}canvasToViewport(t,e,i){const[n,r]=this.containerToCanvas(i);return[2*t/n-1,1-2*e/r]}containerToCanvas(t){return[t.offsetWidth,t.offsetHeight]}getBasicDistances(t,e){const i=this.viewportToBasic(-1,1,t,e),n=this.viewportToBasic(1,1,t,e),r=this.viewportToBasic(1,-1,t,e),s=this.viewportToBasic(-1,-1,t,e);let o=0,a=0,c=0,h=0;return i[1]<0&&n[1]<0&&(o=i[1]>n[1]?-i[1]:-n[1]),n[0]>1&&r[0]>1&&(a=n[0]<r[0]?n[0]-1:r[0]-1),r[1]>1&&s[1]>1&&(c=r[1]<s[1]?r[1]-1:s[1]-1),s[0]<0&&i[0]<0&&(h=s[0]>i[0]?-s[0]:-i[0]),[o,a,c,h]}getPixelDistances(t,e,i){const n=this.viewportToBasic(-1,1,e,i),r=this.viewportToBasic(1,1,e,i),s=this.viewportToBasic(1,-1,e,i),o=this.viewportToBasic(-1,-1,e,i);let a=0,c=0,h=0,l=0;const[u,d]=this.containerToCanvas(t);if(n[1]<0&&r[1]<0){const s=n[1]>r[1]?n[0]:r[0],o=this.basicToCanvas(s,0,t,e,i);a=o[1]>0?o[1]:0}if(r[0]>1&&s[0]>1){const n=r[0]<s[0]?r[1]:s[1],o=this.basicToCanvas(1,n,t,e,i);c=o[0]<u?u-o[0]:0}if(s[1]>1&&o[1]>1){const n=s[1]<o[1]?s[0]:o[0],r=this.basicToCanvas(n,1,t,e,i);h=r[1]<d?d-r[1]:0}if(o[0]<0&&n[0]<0){const r=o[0]>n[0]?o[1]:n[1],s=this.basicToCanvas(0,r,t,e,i);l=s[0]>0?s[0]:0}return[a,c,h,l]}insideElement(t,e){const i=e.getBoundingClientRect(),n=i.left+e.clientLeft,r=n+e.clientWidth,s=i.top+e.clientTop,o=s+e.clientHeight;return t.clientX>n&&t.clientX<r&&t.clientY>s&&t.clientY<o}projectToCanvas(t,e,i){const n=this.projectToViewport(t,i);return this.viewportToCanvas(n[0],n[1],e)}projectToCanvasSafe(t,e,i){if(this.worldToCamera(t,i)[2]>0)return null;const n=this.projectToViewport(t,i);return this.viewportToCanvas(n[0],n[1],e)}projectToViewport(t,e){const i=new fn(t[0],t[1],t[2]).project(e);return[i.x,i.y]}unprojectFromCanvas(t,e,i,n){const r=this.canvasToViewport(t,e,i);return this.unprojectFromViewport(r[0],r[1],n)}unprojectFromViewport(t,e,i){return new fn(t,e,1).unproject(i)}viewportToBasic(t,e,i,n){const r=new fn(t,e,1).unproject(n).toArray();return i.projectBasic(r)}viewportToCanvas(t,e,i){const[n,r]=this.containerToCanvas(i);return[n*(t+1)/2,-r*(e-1)/2]}worldToCamera(t,e){return new fn(t[0],t[1],t[2]).applyMatrix4(e.matrixWorldInverse).toArray()}}t.ComponentSize=void 0,(Bf=t.ComponentSize||(t.ComponentSize={}))[Bf.Automatic=0]="Automatic",Bf[Bf.Large=1]="Large",Bf[Bf.Small=2]="Small";class Xf extends Vf{constructor(t,e,i){super(t,e,i),this._spatial=new ld,this._viewportCoords=new Wf,this._svgNamespace="http://www.w3.org/2000/svg",this._distinctThreshold=Math.PI/360,this._animationSpeed=.075,this._unitBezier=new Fd(.74,.67,.38,.96)}_activate(){const e=this._subscriptions,i=this._container.renderService.renderCamera$.pipe(rt((t=>{let e=this._spatial.degToRad(t.perspective.fov),i=t.perspective.aspect===Number.POSITIVE_INFINITY?Math.PI:2*Math.atan(t.perspective.aspect*Math.tan(.5*e));return[this._spatial.azimuthalToBearing(t.rotation.phi),i]})),ue(((t,e)=>Math.abs(e[0]-t[0])<this._distinctThreshold&&Math.abs(e[1]-t[1])<this._distinctThreshold))),n=gt(this._navigator.stateService.currentState$.pipe(ue(void 0,(t=>t.state.currentImage.id))),this._navigator.panService.panImages$).pipe(rt((([t,e])=>{const i=t.state.currentImage,n=t.state.currentTransform;if(dd(i.cameraType))return[Math.PI,Math.PI];const r=this._computeProjectedPoints(n),s=this._spatial.degToRad(this._computeHorizontalFov(r));let o=s/2,a=s/2;for(const[t,,n]of e){const e=this._spatial.wrap(t.compassAngle-i.compassAngle,-180,180);e<0?o=this._spatial.degToRad(Math.abs(e))+n/2:a=this._spatial.degToRad(Math.abs(e))+n/2}return[o,a]})),ue((([t,e],[i,n])=>Math.abs(i-t)<this._distinctThreshold&&Math.abs(n-e)<this._distinctThreshold))),r=gt(this._navigator.stateService.currentState$.pipe(ue(void 0,(t=>t.state.currentImage.id))),this._container.renderService.bearing$).pipe(rt((([t,e])=>this._spatial.degToRad(t.state.currentImage.compassAngle-e)))),s=new T,o=s.pipe(Le(((t,e)=>e(t)),{alpha:0,curr:[0,0,0],prev:[0,0,0]}),rt((t=>{const e=this._unitBezier.solve(t.alpha),i=t.curr,n=t.prev;return[this._interpolate(n[0],i[0],e),this._interpolate(n[1],i[1],e)]})));e.push(n.pipe(rt((t=>e=>{const i=this._unitBezier.solve(e.alpha),n=e.curr,r=e.prev,s=[this._interpolate(r[0],n[0],i),this._interpolate(r[1],n[1],i)];return{alpha:0,curr:t.slice(),prev:s}}))).subscribe(s)),e.push(n.pipe(ri((()=>this._container.renderService.renderCameraFrame$.pipe(Je(1),Le((t=>t+this._animationSpeed),0),li((t=>t<=1+this._animationSpeed)),rt((t=>Math.min(t,1)))))),rt((t=>e=>({alpha:t,curr:e.curr.slice(),prev:e.prev.slice()})))).subscribe(s));const a=gt(r,o).pipe(rt((([t,e])=>[t,e[0],e[1]])));e.push(gt(i,a,this._configuration$,this._container.renderService.size$).pipe(rt((([[e,i],[n,r,s],o,a])=>{const c=this._createBackground(e),h=this._createFovIndicator(r,s,n),l=this._createNorth(e),u=this._createCircleSectorCompass(this._createCircleSector(Math.max(Math.PI/20,i),"#FFF")),d=o.size===t.ComponentSize.Small||o.size===t.ComponentSize.Automatic&&a.width<640?".mapillary-bearing-compact":"";return{name:this._name,vNode:jf.h("div.mapillary-bearing-indicator-container"+d,{oncontextmenu:t=>{t.preventDefault()}},[c,h,l,u])}}))).subscribe(this._container.domRenderer.render$))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{size:t.ComponentSize.Automatic}}_createFovIndicator(t,e,i){const n=this._createFovArc(t,e),r=jf.h("g",{attributes:{transform:"translate(18,18)"},namespace:this._svgNamespace},[n]);return jf.h("svg",{attributes:{viewBox:"0 0 36 36"},namespace:this._svgNamespace,style:{height:"36px",left:"2px",position:"absolute",top:"2px",transform:`rotateZ(${this._spatial.radToDeg(i)}deg)`,width:"36px"}},[r])}_createFovArc(t,e){const i=16.75,n=t+e;if(n>2*Math.PI-Math.PI/90)return jf.h("circle",{attributes:{cx:"0",cy:"0","fill-opacity":"0",r:"16.75",stroke:"#FFF","stroke-width":"2.5"},namespace:this._svgNamespace},[]);let r=-Math.PI/2-t,s=r+n,o=i*Math.cos(r),a=i*Math.sin(r),c=i*Math.cos(s),h=i*Math.sin(s),l=`M ${o} ${a} A 16.75 16.75 0 ${n>=Math.PI?1:0} 1 ${c} ${h}`;return jf.h("path",{attributes:{d:l,"fill-opacity":"0",stroke:"#FFF","stroke-width":"2.5"},namespace:this._svgNamespace},[])}_createCircleSectorCompass(t){let e=jf.h("g",{attributes:{transform:"translate(1,1)"},namespace:this._svgNamespace},[t]);return jf.h("svg",{attributes:{viewBox:"0 0 2 2"},namespace:this._svgNamespace,style:{height:"26px",left:"7px",position:"absolute",top:"7px",width:"26px"}},[e])}_createCircleSector(t,e){if(t>2*Math.PI-Math.PI/90)return jf.h("circle",{attributes:{cx:"0",cy:"0",fill:e,r:"1"},namespace:this._svgNamespace},[]);let i=-Math.PI/2-t/2,n=i+t,r=Math.cos(i),s=Math.sin(i),o=Math.cos(n),a=Math.sin(n),c=`M 0 0 ${r} ${s} A 1 1 0 ${t>=Math.PI?1:0} 1 ${o} ${a}`;return jf.h("path",{attributes:{d:c,fill:e},namespace:this._svgNamespace},[])}_createNorth(t){const e=jf.h("div.mapillary-bearing-north",[]);return jf.h("div.mapillary-bearing-north-container",{style:{transform:`rotateZ(${this._spatial.radToDeg(-t)}deg)`}},[e])}_createBackground(t){return jf.h("div.mapillary-bearing-indicator-background",{style:{transform:`rotateZ(${this._spatial.radToDeg(-t)}deg)`}},[jf.h("div.mapillary-bearing-indicator-background-circle",[]),jf.h("div.mapillary-bearing-indicator-background-arrow-container",[jf.h("div.mapillary-bearing-indicator-background-arrow",[])])])}_computeProjectedPoints(t){return md(t,[[1,0]],[[0,.5]],12,this._viewportCoords)}_computeHorizontalFov(t){const e=t.map((t=>this._coordToFov(t[0])));return Math.min(...e)}_coordToFov(t){return this._spatial.radToDeg(2*Math.atan(t))}_interpolate(t,e,i){return(1-i)*t+i*e}}Xf.componentName="bearing";class Yf extends Vf{constructor(t,e,i){super(t,e,i)}_activate(){const e=this._subscriptions;e.push(gt(this._navigator.stateService.currentImage$.pipe(ri((t=>t.sequenceEdges$)),Nt((t=>t.cached))),this._configuration$).pipe(ri((e=>{let i=e[0],n=e[1],r=Math.max(0,Math.min(4,n.depth.sequence));return Ot(this._cache$(i.edges,t.NavigationDirection.Next,r),this._cache$(i.edges,t.NavigationDirection.Prev,r)).pipe(te((t=>(console.error("Failed to cache sequence edges.",t),B()))))}))).subscribe((()=>{}))),e.push(gt(this._navigator.stateService.currentImage$.pipe(ri((t=>gt(G(t),t.spatialEdges$.pipe(Nt((t=>t.cached))))))),this._configuration$).pipe(ri((([[e,i],n])=>{let r=i.edges,s=n.depth,o=Math.max(0,Math.min(2,s.spherical)),a=dd(e.cameraType)?0:Math.max(0,Math.min(3,s.step)),c=dd(e.cameraType)?0:Math.max(0,Math.min(1,s.turn)),h=this._cache$(r,t.NavigationDirection.Spherical,o);return Ot(this._cache$(r,t.NavigationDirection.StepForward,a),this._cache$(r,t.NavigationDirection.StepBackward,a),this._cache$(r,t.NavigationDirection.StepLeft,a),this._cache$(r,t.NavigationDirection.StepRight,a),h,this._cache$(r,t.NavigationDirection.TurnLeft,c),this._cache$(r,t.NavigationDirection.TurnRight,c),this._cache$(r,t.NavigationDirection.TurnU,c)).pipe(te((t=>(console.error("Failed to cache spatial edges.",t),B()))))}))).subscribe((()=>{})))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{depth:{spherical:1,sequence:2,step:1,turn:0}}}_cache$(t,e,i){return Ft(G(t),G(i)).pipe(xe((t=>{let i=t[0],n=t[1],r=[];if(n>0)for(let t of i)t.data.direction===e&&r.push(Ft(this._navigator.graphService.cacheImage$(t.target).pipe(Mt((t=>this._imageToEdges$(t,e)))),G(n-1)));return bt(r).pipe(Et())})),Je(1))}_imageToEdges$(e,i){return([t.NavigationDirection.Next,t.NavigationDirection.Prev].indexOf(i)>-1?e.sequenceEdges$:e.spatialEdges$).pipe(Ee((t=>t.cached)),rt((t=>t.edges)))}}Yf.componentName="cache";class Zf extends cd{constructor(t){super(null!=t?t:"The request was cancelled."),Object.setPrototypeOf(this,Zf.prototype),this.name="CancelMapillaryError"}}class Jf{constructor(t,e){this._spatial=new ld,this._minThresholdWidth=320,this._maxThresholdWidth=1480,this._minThresholdHeight=240,this._maxThresholdHeight=820,this._configure(t),this._resize(e),this._reset()}get minWidth(){return this._minWidth}get maxWidth(){return this._maxWidth}get containerWidth(){return this._containerWidth}get containerWidthCss(){return this._containerWidthCss}get containerMarginCss(){return this._containerMarginCss}get containerLeftCss(){return this._containerLeftCss}get containerHeight(){return this._containerHeight}get containerHeightCss(){return this._containerHeightCss}get containerBottomCss(){return this._containerBottomCss}get stepCircleSize(){return this._stepCircleSize}get stepCircleSizeCss(){return this._stepCircleSizeCss}get stepCircleMarginCss(){return this._stepCircleMarginCss}get turnCircleSize(){return this._turnCircleSize}get turnCircleSizeCss(){return this._turnCircleSizeCss}get outerRadius(){return this._outerRadius}get innerRadius(){return this._innerRadius}get shadowOffset(){return this._shadowOffset}configure(t){this._configure(t),this._reset()}resize(t){this._resize(t),this._reset()}angleToCoordinates(t){return[Math.cos(t),Math.sin(t)]}relativeAngleToCoordiantes(t,e){let i=this._spatial.wrapAngle(t-e);return this.angleToCoordinates(i)}_configure(t){this._minWidth=t.minWidth,this._maxWidth=this._getMaxWidth(t.minWidth,t.maxWidth)}_resize(t){this._elementWidth=t.width,this._elementHeight=t.height}_reset(){this._containerWidth=this._getContainerWidth(this._elementWidth,this._elementHeight),this._containerHeight=this._getContainerHeight(this.containerWidth),this._stepCircleSize=this._getStepCircleDiameter(this._containerHeight),this._turnCircleSize=this._getTurnCircleDiameter(this.containerHeight),this._outerRadius=this._getOuterRadius(this._containerHeight),this._innerRadius=this._getInnerRadius(this._containerHeight),this._shadowOffset=3,this._containerWidthCss=this._numberToCssPixels(this._containerWidth),this._containerMarginCss=this._numberToCssPixels(-.5*this._containerWidth),this._containerLeftCss=this._numberToCssPixels(Math.floor(.5*this._elementWidth)),this._containerHeightCss=this._numberToCssPixels(this._containerHeight),this._containerBottomCss=this._numberToCssPixels(Math.floor(-.08*this._containerHeight)),this._stepCircleSizeCss=this._numberToCssPixels(this._stepCircleSize),this._stepCircleMarginCss=this._numberToCssPixels(-.5*this._stepCircleSize),this._turnCircleSizeCss=this._numberToCssPixels(this._turnCircleSize)}_getContainerWidth(t,e){let i=(t-this._minThresholdWidth)/(this._maxThresholdWidth-this._minThresholdWidth),n=(e-this._minThresholdHeight)/(this._maxThresholdHeight-this._minThresholdHeight),r=Math.max(0,Math.min(1,Math.min(i,n)));return r=.04*Math.round(25*r),this._minWidth+r*(this._maxWidth-this._minWidth)}_getContainerHeight(t){return.77*t}_getStepCircleDiameter(t){return.34*t}_getTurnCircleDiameter(t){return.3*t}_getOuterRadius(t){return.31*t}_getInnerRadius(t){return.125*t}_numberToCssPixels(t){return t+"px"}_getMaxWidth(t,e){return t>e?t:e}}class Kf{constructor(e,i){this._isEdge=!1,this._spatial=new ld,this._calculator=new Jf(e,i),this._image=null,this._rotation={phi:0,theta:0},this._epsilon=.5*Math.PI/180,this._highlightKey=null,this._distinguishSequence=!1,this._needsRender=!1,this._stepEdges=[],this._turnEdges=[],this._sphericalEdges=[],this._sequenceEdgeKeys=[],this._stepDirections=[t.NavigationDirection.StepForward,t.NavigationDirection.StepBackward,t.NavigationDirection.StepLeft,t.NavigationDirection.StepRight],this._turnDirections=[t.NavigationDirection.TurnLeft,t.NavigationDirection.TurnRight,t.NavigationDirection.TurnU],this._turnNames={},this._turnNames[t.NavigationDirection.TurnLeft]="mapillary-direction-turn-left",this._turnNames[t.NavigationDirection.TurnRight]="mapillary-direction-turn-right",this._turnNames[t.NavigationDirection.TurnU]="mapillary-direction-turn-around";let n=!!document.documentMode;this._isEdge=!n&&!!window.StyleMedia}get needsRender(){return this._needsRender}render(t){this._needsRender=!1;let e=this._rotation,i=[],n=[];return dd(this._image.cameraType)?i=i.concat(this._createSphericalArrows(t,e)):(i=i.concat(this._createPerspectiveToSphericalArrows(t,e)),i=i.concat(this._createStepArrows(t,e)),n=n.concat(this._createTurnArrows(t))),this._getContainer(i,n,e)}setEdges(t,e){this._setEdges(t,e),this._setNeedsRender()}setImage(t){this._image=t,this._clearEdges(),this._setNeedsRender()}setRenderCamera(t){let e=t.rotation;Math.abs(e.phi-this._rotation.phi)<this._epsilon||(this._rotation=e,this._setNeedsRender())}setConfiguration(t){let e=!1;this._highlightKey===t.highlightId&&this._distinguishSequence===t.distinguishSequence||(this._highlightKey=t.highlightId,this._distinguishSequence=t.distinguishSequence,e=!0),this._calculator.minWidth===t.minWidth&&this._calculator.maxWidth===t.maxWidth||(this._calculator.configure(t),e=!0),e&&this._setNeedsRender()}resize(t){this._calculator.resize(t),this._setNeedsRender()}_setNeedsRender(){null!=this._image&&(this._needsRender=!0)}_clearEdges(){this._stepEdges=[],this._turnEdges=[],this._sphericalEdges=[],this._sequenceEdgeKeys=[]}_setEdges(e,i){this._stepEdges=[],this._turnEdges=[],this._sphericalEdges=[],this._sequenceEdgeKeys=[];for(let i of e.edges){let e=i.data.direction;this._stepDirections.indexOf(e)>-1?this._stepEdges.push(i):this._turnDirections.indexOf(e)>-1?this._turnEdges.push(i):i.data.direction===t.NavigationDirection.Spherical&&this._sphericalEdges.push(i)}if(this._distinguishSequence&&null!=i){let t=this._sphericalEdges.concat(this._stepEdges).concat(this._turnEdges);for(let e of t){let t=e.target;for(let e of i.imageIds)if(e===t){this._sequenceEdgeKeys.push(t);break}}}}_createSphericalArrows(t,e){let i=[];for(let n of this._sphericalEdges)i.push(this._createVNodeByKey(t,n.target,n.data.worldMotionAzimuth,e,this._calculator.outerRadius,"mapillary-direction-arrow-spherical"));for(let n of this._stepEdges)i.push(this._createSphericalToPerspectiveArrow(t,n.target,n.data.worldMotionAzimuth,e,n.data.direction));return i}_createSphericalToPerspectiveArrow(e,i,n,r,s){let o=Math.PI/8,a=r.phi;switch(s){case t.NavigationDirection.StepBackward:a=r.phi-Math.PI;break;case t.NavigationDirection.StepLeft:a=r.phi+Math.PI/2;break;case t.NavigationDirection.StepRight:a=r.phi-Math.PI/2}return Math.abs(this._spatial.wrapAngle(n-a))<o?this._createVNodeByKey(e,i,n,r,this._calculator.outerRadius,"mapillary-direction-arrow-step"):this._createVNodeInactive(i,n,r)}_createPerspectiveToSphericalArrows(t,e){let i=[];for(let n of this._sphericalEdges)i.push(this._createVNodeByKey(t,n.target,n.data.worldMotionAzimuth,e,this._calculator.innerRadius,"mapillary-direction-arrow-spherical",!0));return i}_createStepArrows(t,e){let i=[];for(let n of this._stepEdges)i.push(this._createVNodeByDirection(t,n.target,n.data.worldMotionAzimuth,e,n.data.direction));return i}_createTurnArrows(t){let e=[];for(let i of this._turnEdges){let n=i.data.direction,r=this._turnNames[n];e.push(this._createVNodeByTurn(t,i.target,r,n))}return e}_createVNodeByKey(t,e,i,n,r,s,o){return this._createVNode(e,i,n,r,s,"mapillary-direction-circle",(i=>{t.moveTo$(e).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))}),o)}_createVNodeByDirection(t,e,i,n,r){return this._createVNode(e,i,n,this._calculator.outerRadius,"mapillary-direction-arrow-step","mapillary-direction-circle",(e=>{t.moveDir$(r).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))}))}_createVNodeByTurn(e,i,n,r){let s={height:this._calculator.turnCircleSizeCss,transform:"rotate(0)",width:this._calculator.turnCircleSizeCss};switch(r){case t.NavigationDirection.TurnLeft:s.left="5px",s.top="5px";break;case t.NavigationDirection.TurnRight:s.right="5px",s.top="5px";break;case t.NavigationDirection.TurnU:s.left="5px",s.bottom="5px"}let o={attributes:{"data-id":i},onclick:t=>{e.moveDir$(r).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))},style:s},a="mapillary-direction-turn-circle";this._sequenceEdgeKeys.indexOf(i)>-1&&(a+="-sequence"),this._highlightKey===i&&(a+="-highlight");let c=jf.h(`div.${n}`,{},[]);return jf.h("div."+a,o,[c])}_createVNodeInactive(t,e,i){return this._createVNode(t,e,i,this._calculator.outerRadius,"mapillary-direction-arrow-inactive","mapillary-direction-circle-inactive")}_createVNode(t,e,i,n,r,s,o,a){let c=this._calculator.angleToCoordinates(e-i.phi),h=Math.round(-n*c[1]+.5*this._calculator.containerWidth),l=Math.round(-n*c[0]+.5*this._calculator.containerHeight),u=this._calculator.relativeAngleToCoordiantes(e,i.phi),d=this._calculator.shadowOffset,p=`drop-shadow(${-d*u[1]}px ${d*u[0]}px 1px rgba(0,0,0,0.8))`,f={style:{"-webkit-filter":p,filter:p}},m=jf.h("div."+r,f,[]),g=-this._spatial.radToDeg(e-i.phi),_=a?`translate(${h}px, ${l}px) rotate(${g}deg) translateZ(-0.01px)`:`translate(${h}px, ${l}px) rotate(${g}deg)`,v={attributes:{"data-id":t},onclick:o,style:{height:this._calculator.stepCircleSizeCss,marginLeft:this._calculator.stepCircleMarginCss,marginTop:this._calculator.stepCircleMarginCss,transform:_,width:this._calculator.stepCircleSizeCss}};return this._sequenceEdgeKeys.indexOf(t)>-1&&(s+="-sequence"),this._highlightKey===t&&(s+="-highlight"),jf.h("div."+s,v,[m])}_getContainer(t,e,i){let n=this._isEdge?"rotateX(60deg)":`perspective(${this._calculator.containerWidthCss}) rotateX(60deg)`,r={oncontextmenu:t=>{t.preventDefault()},style:{bottom:this._calculator.containerBottomCss,height:this._calculator.containerHeightCss,left:this._calculator.containerLeftCss,marginLeft:this._calculator.containerMarginCss,transform:n,width:this._calculator.containerWidthCss}};return jf.h("div.mapillary-direction-perspective",r,e.concat(t))}}class Qf extends Vf{constructor(t,e,i,n){super(t,e,i),this._renderer=n||new Kf(this.defaultConfiguration,{height:e.container.offsetHeight,width:e.container.offsetWidth}),this._hoveredIdSubject$=new T,this._hoveredId$=this._hoveredIdSubject$.pipe(Ze())}fire(t,e){super.fire(t,e)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}_activate(){const t=this._subscriptions;t.push(this._configuration$.subscribe((t=>{this._renderer.setConfiguration(t)}))),t.push(this._container.renderService.size$.subscribe((t=>{this._renderer.resize(t)}))),t.push(this._navigator.stateService.currentImage$.pipe(pi((t=>{this._container.domRenderer.render$.next({name:this._name,vNode:jf.h("div",{},[])}),this._renderer.setImage(t)})),bi(this._configuration$),ri((([t,e])=>gt(t.spatialEdges$,e.distinguishSequence?this._navigator.graphService.cacheSequence$(t.sequenceId).pipe(te((e=>(console.error(`Failed to cache sequence (${t.sequenceId})`,e),G(null))))):G(null))))).subscribe((([t,e])=>{this._renderer.setEdges(t,e)}))),t.push(this._container.renderService.renderCameraFrame$.pipe(pi((t=>{this._renderer.setRenderCamera(t)})),rt((()=>this._renderer)),Nt((t=>t.needsRender)),rt((t=>({name:this._name,vNode:t.render(this._navigator)})))).subscribe(this._container.domRenderer.render$)),t.push(gt(this._container.domRenderer.element$,this._container.renderService.renderCamera$,this._container.mouseService.mouseMove$.pipe(ni(null)),this._container.mouseService.mouseUp$.pipe(ni(null))).pipe(rt((([t])=>{let e=t.getElementsByClassName("mapillary-direction-perspective");for(let t=0;t<e.length;t++){let i=e.item(t).querySelector(":hover");if(null!=i&&i.hasAttribute("data-id"))return i.getAttribute("data-id")}return null})),ue()).subscribe(this._hoveredIdSubject$)),t.push(this._hoveredId$.subscribe((t=>{const e="hover",i={id:t,target:this,type:e};this.fire(e,i)})))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{distinguishSequence:!1,maxWidth:460,minWidth:260}}}Qf.componentName="direction";class tm{}tm.fisheye={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D projectorTex;\nuniform float opacity;\nuniform float focal;\nuniform float k1;\nuniform float k2;\nuniform float scale_x;\nuniform float scale_y;\nuniform float radial_peak;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    float x = vRstq.x;\n    float y = vRstq.y;\n    float z = vRstq.z;\n\n    float r = sqrt(x * x + y * y);\n    float theta = atan(r, z);\n\n    if (radial_peak > 0. && theta > radial_peak) {\n        theta = radial_peak;\n    }\n\n    float theta2 = theta * theta;\n    float theta_d = theta * (1.0 + theta2 * (k1 + theta2 * k2));\n    float s = focal * theta_d / r;\n\n    float u = scale_x * s * x + 0.5;\n    float v = -scale_y * s * y + 0.5;\n\n    vec4 baseColor;\n    if (u >= 0. && u <= 1. && v >= 0. && v <= 1.) {\n        baseColor = texture2D(projectorTex, vec2(u, v));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.fisheyeCurtain={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D projectorTex;\nuniform float opacity;\nuniform float focal;\nuniform float k1;\nuniform float k2;\nuniform float scale_x;\nuniform float scale_y;\nuniform float radial_peak;\nuniform float curtain;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    float x = vRstq.x;\n    float y = vRstq.y;\n    float z = vRstq.z;\n\n    float r2 = sqrt(x * x + y * y);\n    float theta = atan(r2, z);\n\n    if (radial_peak > 0. && theta > radial_peak) {\n        theta = radial_peak;\n    }\n\n    float theta2 = theta * theta;\n    float theta_d = theta * (1.0 + theta2 * (k1 + theta2 * k2));\n    float s = focal * theta_d / r2;\n\n    float u = scale_x * s * x + 0.5;\n    float v = -scale_y * s * y + 0.5;\n\n    vec4 baseColor;\n    if ((u < curtain || curtain >= 1.0) && u >= 0. && u <= 1. && v >= 0. && v <= 1.) {\n        baseColor = texture2D(projectorTex, vec2(u, v));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.perspective={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D projectorTex;\nuniform float opacity;\nuniform float focal;\nuniform float k1;\nuniform float k2;\nuniform float scale_x;\nuniform float scale_y;\nuniform float radial_peak;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    float x = vRstq.x / vRstq.z;\n    float y = vRstq.y / vRstq.z;\n    float r2 = x * x + y * y;\n\n    if (radial_peak > 0. && r2 > radial_peak * sqrt(r2)) {\n        r2 = radial_peak * radial_peak;\n    }\n\n    float d = 1.0 + k1 * r2 + k2 * r2 * r2;\n    float u = scale_x * focal * d * x + 0.5;\n    float v = - scale_y * focal * d * y + 0.5;\n\n    vec4 baseColor;\n    if (u >= 0. && u <= 1. && v >= 0. && v <= 1.) {\n        baseColor = texture2D(projectorTex, vec2(u, v));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.perspectiveCurtain={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D projectorTex;\nuniform float opacity;\nuniform float focal;\nuniform float k1;\nuniform float k2;\nuniform float scale_x;\nuniform float scale_y;\nuniform float radial_peak;\nuniform float curtain;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    float x = vRstq.x / vRstq.z;\n    float y = vRstq.y / vRstq.z;\n    float r2 = x * x + y * y;\n\n    if (radial_peak > 0. && r2 > radial_peak * sqrt(r2)) {\n        r2 = radial_peak * radial_peak;\n    }\n\n    float d = 1.0 + k1 * r2 + k2 * r2 * r2;\n    float u = scale_x * focal * d * x + 0.5;\n    float v = - scale_y * focal * d * y + 0.5;\n\n    vec4 baseColor;\n    if ((u < curtain || curtain >= 1.0) && u >= 0. && u <= 1. && v >= 0. && v <= 1.) {\n        baseColor = texture2D(projectorTex, vec2(u, v));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.perspectiveDistorted={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D projectorTex;\nuniform float opacity;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    float u = vRstq.x / vRstq.w;\n    float v = vRstq.y / vRstq.w;\n\n    vec4 baseColor;\n    if (u >= 0. && u <= 1. && v >= 0. && v <= 1.) {\n        baseColor = texture2D(projectorTex, vec2(u, v));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.perspectiveDistortedCurtain={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\nuniform sampler2D projectorTex;\nuniform float opacity;\nuniform float curtain;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    float u = vRstq.x / vRstq.w;\n    float v = vRstq.y / vRstq.w;\n\n    vec4 baseColor;\n    if ((u < curtain || curtain >= 1.0) && u >= 0. && u <= 1. && v >= 0. && v <= 1.) {\n        baseColor = texture2D(projectorTex, vec2(u, v));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.spherical={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#define tau 6.28318530718\n\nuniform sampler2D projectorTex;\nuniform float opacity;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vec3 b = normalize(vRstq.xyz);\n    float lat = -asin(b.y);\n    float lng = atan(b.x, b.z);\n    float x = lng / tau + 0.5;\n    float y = lat / tau * 2.0 + 0.5;\n    vec4 baseColor = texture2D(projectorTex, vec2(x, y));\n    baseColor.a = opacity;\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},tm.sphericalCurtain={fragment:"\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#define tau 6.28318530718\n\nuniform sampler2D projectorTex;\nuniform float curtain;\nuniform float opacity;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vec3 b = normalize(vRstq.xyz);\n    float lat = -asin(b.y);\n    float lng = atan(b.x, b.z);\n    float x = lng / tau + 0.5;\n    float y = lat / tau * 2.0 + 0.5;\n\n    bool inverted = curtain < 0.5;\n\n    float curtainMin = inverted ? curtain + 0.5 : curtain - 0.5;\n    float curtainMax = curtain;\n\n    bool insideCurtain = inverted ?\n        x > curtainMin || x < curtainMax :\n        x > curtainMin && x < curtainMax;\n\n    vec4 baseColor;\n    if (insideCurtain) {\n        baseColor = texture2D(projectorTex, vec2(x, y));\n        baseColor.a = opacity;\n    } else {\n        baseColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n\n    gl_FragColor = baseColor;\n}\n",vertex:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform mat4 projectorMat;\n\nvarying vec4 vRstq;\n\nvoid main()\n{\n    vRstq = projectorMat * vec4(position, 1.0);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"};class em{constructor(t,e){this._imagePlaneDepth=null!=t?t:200,this._imageSphereRadius=null!=e?e:200}createMesh(t,e){return dd(e.cameraType)?this._createImageSphere(t,e):pd(e.cameraType)?this._createImagePlaneFisheye(t,e):this._createImagePlane(t,e)}createFlatMesh(t,e,i,n,r,s){let o=this._createTexture(t.image),a=new Os(this._createDistortedPlaneMaterialParameters(e,o));return new Es(this._getFlatImagePlaneGeoFromBasic(e,i,n,r,s),a)}createCurtainMesh(t,e){return dd(e.cameraType)?this._createSphereCurtainMesh(t,e):pd(e.cameraType)?this._createCurtainMeshFisheye(t,e):this._createCurtainMesh(t,e)}createDistortedCurtainMesh(t,e){return this._createDistortedCurtainMesh(t,e)}_createCurtainMesh(t,e){let i=this._createTexture(t.image),n=new Os(this._createCurtainPlaneMaterialParameters(e,i));return new Es(this._useMesh(e,t)?this._getImagePlaneGeo(e,t):this._getRegularFlatImagePlaneGeo(e),n)}_createCurtainMeshFisheye(t,e){let i=this._createTexture(t.image),n=new Os(this._createCurtainPlaneMaterialParametersFisheye(e,i));return new Es(this._useMesh(e,t)?this._getImagePlaneGeoFisheye(e,t):this._getRegularFlatImagePlaneGeo(e),n)}_createDistortedCurtainMesh(t,e){let i=this._createTexture(t.image),n=new Os(this._createDistortedCurtainPlaneMaterialParameters(e,i));return new Es(this._getRegularFlatImagePlaneGeo(e),n)}_createSphereCurtainMesh(t,e){let i=this._createTexture(t.image),n=new Os(this._createCurtainSphereMaterialParameters(e,i));return this._useMesh(e,t)?new Es(this._getImageSphereGeo(e,t),n):new Es(this._getFlatImageSphereGeo(e),n)}_createImageSphere(t,e){let i=this._createTexture(t.image),n=new Os(this._createSphereMaterialParameters(e,i));return this._useMesh(e,t)?new Es(this._getImageSphereGeo(e,t),n):new Es(this._getFlatImageSphereGeo(e),n)}_createImagePlane(t,e){let i=this._createTexture(t.image),n=new Os(this._createPlaneMaterialParameters(e,i));return new Es(this._useMesh(e,t)?this._getImagePlaneGeo(e,t):this._getRegularFlatImagePlaneGeo(e),n)}_createImagePlaneFisheye(t,e){let i=this._createTexture(t.image),n=new Os(this._createPlaneMaterialParametersFisheye(e,i));return new Es(this._useMesh(e,t)?this._getImagePlaneGeoFisheye(e,t):this._getRegularFlatImagePlaneGeoFisheye(e),n)}_createSphereMaterialParameters(t,e){return{depthWrite:!1,fragmentShader:tm.spherical.fragment,side:2,transparent:!0,uniforms:{opacity:{value:1},projectorMat:{value:t.rt},projectorTex:{value:e}},vertexShader:tm.spherical.vertex}}_createCurtainSphereMaterialParameters(t,e){return{depthWrite:!1,fragmentShader:tm.sphericalCurtain.fragment,side:2,transparent:!0,uniforms:{curtain:{value:1},opacity:{value:1},projectorMat:{value:t.rt},projectorTex:{value:e}},vertexShader:tm.sphericalCurtain.vertex}}_createPlaneMaterialParameters(t,e){return{depthWrite:!1,fragmentShader:tm.perspective.fragment,side:2,transparent:!0,uniforms:{focal:{value:t.focal},k1:{value:t.ck1},k2:{value:t.ck2},opacity:{value:1},projectorMat:{value:t.basicRt},projectorTex:{value:e},radial_peak:{value:t.radialPeak?t.radialPeak:0},scale_x:{value:Math.max(t.basicHeight,t.basicWidth)/t.basicWidth},scale_y:{value:Math.max(t.basicWidth,t.basicHeight)/t.basicHeight}},vertexShader:tm.perspective.vertex}}_createPlaneMaterialParametersFisheye(t,e){return{depthWrite:!1,fragmentShader:tm.fisheye.fragment,side:2,transparent:!0,uniforms:{focal:{value:t.focal},k1:{value:t.ck1},k2:{value:t.ck2},opacity:{value:1},projectorMat:{value:t.basicRt},projectorTex:{value:e},radial_peak:{value:t.radialPeak?t.radialPeak:0},scale_x:{value:Math.max(t.basicHeight,t.basicWidth)/t.basicWidth},scale_y:{value:Math.max(t.basicWidth,t.basicHeight)/t.basicHeight}},vertexShader:tm.fisheye.vertex}}_createCurtainPlaneMaterialParametersFisheye(t,e){return{depthWrite:!1,fragmentShader:tm.fisheyeCurtain.fragment,side:2,transparent:!0,uniforms:{curtain:{value:1},focal:{value:t.focal},k1:{value:t.ck1},k2:{value:t.ck2},opacity:{value:1},projectorMat:{value:t.basicRt},projectorTex:{value:e},radial_peak:{value:t.radialPeak?t.radialPeak:0},scale_x:{value:Math.max(t.basicHeight,t.basicWidth)/t.basicWidth},scale_y:{value:Math.max(t.basicWidth,t.basicHeight)/t.basicHeight}},vertexShader:tm.fisheyeCurtain.vertex}}_createCurtainPlaneMaterialParameters(t,e){return{depthWrite:!1,fragmentShader:tm.perspectiveCurtain.fragment,side:2,transparent:!0,uniforms:{curtain:{value:1},focal:{value:t.focal},k1:{value:t.ck1},k2:{value:t.ck2},opacity:{value:1},projectorMat:{value:t.basicRt},projectorTex:{value:e},radial_peak:{value:t.radialPeak?t.radialPeak:0},scale_x:{value:Math.max(t.basicHeight,t.basicWidth)/t.basicWidth},scale_y:{value:Math.max(t.basicWidth,t.basicHeight)/t.basicHeight}},vertexShader:tm.perspectiveCurtain.vertex}}_createDistortedCurtainPlaneMaterialParameters(t,e){return{depthWrite:!1,fragmentShader:tm.perspectiveDistortedCurtain.fragment,side:2,transparent:!0,uniforms:{curtain:{value:1},opacity:{value:1},projectorMat:{value:t.projectorMatrix()},projectorTex:{value:e}},vertexShader:tm.perspectiveDistortedCurtain.vertex}}_createDistortedPlaneMaterialParameters(t,e){return{depthWrite:!1,fragmentShader:tm.perspectiveDistorted.fragment,side:2,transparent:!0,uniforms:{opacity:{value:1},projectorMat:{value:t.projectorMatrix()},projectorTex:{value:e}},vertexShader:tm.perspectiveDistorted.vertex}}_createTexture(t){let e=new hn(t);return e.minFilter=Ai,e.needsUpdate=!0,e}_useMesh(t,e){return e.mesh.vertices.length&&t.hasValidScale}_getImageSphereGeo(t,e){const i=t.srtInverse;let n=5*t.scale,r=this._imageSphereRadius*t.scale,s=e.mesh.vertices,o=s.length/3,a=new Float32Array(s.length);for(let t=0;t<o;++t){let e=3*t,o=s[e+0],c=s[e+1],h=s[e+2],l=Math.sqrt(o*o+c*c+h*h),u=Math.max(n,Math.min(l,r))/l,d=new fn(o*u,c*u,h*u);d.applyMatrix4(i),a[e+0]=d.x,a[e+1]=d.y,a[e+2]=d.z}let c=e.mesh.faces,h=new Uint16Array(c.length);for(let t=0;t<c.length;++t)h[t]=c[t];let l=new hs;return l.setAttribute("position",new Hr(a,3)),l.setIndex(new Hr(h,1)),l}_getImagePlaneGeo(t,e){const i=t.srtInverse;let n=5*t.scale,r=this._imagePlaneDepth*t.scale,s=e.mesh.vertices,o=s.length/3,a=new Float32Array(s.length);for(let t=0;t<o;++t){let e=3*t,o=s[e+0],c=s[e+1],h=s[e+2];t<4&&(o*=3,c*=3);let l=Math.max(n,Math.min(h,r)),u=l/h,d=new fn(o*u,c*u,l);d.applyMatrix4(i),a[e+0]=d.x,a[e+1]=d.y,a[e+2]=d.z}let c=e.mesh.faces,h=new Uint16Array(c.length);for(let t=0;t<c.length;++t)h[t]=c[t];let l=new hs;return l.setAttribute("position",new Hr(a,3)),l.setIndex(new Hr(h,1)),l}_getImagePlaneGeoFisheye(t,e){const i=t.srtInverse;let n=5*t.scale,r=this._imagePlaneDepth*t.scale,s=e.mesh.vertices,o=s.length/3,a=new Float32Array(s.length);for(let t=0;t<o;++t){let e=3*t,o=s[e+0],c=s[e+1],h=s[e+2],l=Math.sqrt(o*o+c*c+h*h),u=Math.max(n,Math.min(l,r))/l,d=new fn(o*u,c*u,h*u);d.applyMatrix4(i),a[e+0]=d.x,a[e+1]=d.y,a[e+2]=d.z}let c=e.mesh.faces,h=new Uint16Array(c.length);for(let t=0;t<c.length;++t)h[t]=c[t];let l=new hs;return l.setAttribute("position",new Hr(a,3)),l.setIndex(new Hr(h,1)),l}_getFlatImageSphereGeo(t){const e=new zh(this._imageSphereRadius,20,40),i=t.rt.clone().invert();return e.applyMatrix4(i),e}_getRegularFlatImagePlaneGeo(t){let e=t.width,i=t.height,n=Math.max(e,i),r=e/2/n,s=i/2/n;return this._getFlatImagePlaneGeo(t,r,s)}_getFlatImagePlaneGeo(t,e,i){let n=[];return n.push(t.unprojectSfM([-e,-i],this._imagePlaneDepth)),n.push(t.unprojectSfM([e,-i],this._imagePlaneDepth)),n.push(t.unprojectSfM([e,i],this._imagePlaneDepth)),n.push(t.unprojectSfM([-e,i],this._imagePlaneDepth)),this._createFlatGeometry(n)}_getRegularFlatImagePlaneGeoFisheye(t){let e=t.width,i=t.height,n=Math.max(e,i),r=e/2/n,s=i/2/n;return this._getFlatImagePlaneGeoFisheye(t,r,s)}_getFlatImagePlaneGeoFisheye(t,e,i){let n=[];return n.push(t.unprojectSfM([-e,-i],this._imagePlaneDepth)),n.push(t.unprojectSfM([e,-i],this._imagePlaneDepth)),n.push(t.unprojectSfM([e,i],this._imagePlaneDepth)),n.push(t.unprojectSfM([-e,i],this._imagePlaneDepth)),this._createFlatGeometry(n)}_getFlatImagePlaneGeoFromBasic(t,e,i,n,r){let s=[];return s.push(t.unprojectBasic([e,n],this._imagePlaneDepth)),s.push(t.unprojectBasic([i,n],this._imagePlaneDepth)),s.push(t.unprojectBasic([i,r],this._imagePlaneDepth)),s.push(t.unprojectBasic([e,r],this._imagePlaneDepth)),this._createFlatGeometry(s)}_createFlatGeometry(t){let e=new Float32Array(12);for(let i=0;i<t.length;i++){let n=3*i;e[n+0]=t[i][0],e[n+1]=t[i][1],e[n+2]=t[i][2]}let i=new Uint16Array(6);i[0]=0,i[1]=1,i[2]=3,i[3]=1,i[4]=2,i[5]=3;let n=new hs;return n.setAttribute("position",new Hr(e,3)),n.setIndex(new Hr(i,1)),n}}class im{constructor(){this._planes={},this._planesOld={},this._planesPeriphery={},this._scene=new Qa,this._sceneOld=new Qa,this._scenePeriphery=new Qa}get planes(){return this._planes}get planesOld(){return this._planesOld}get planesPeriphery(){return this._planesPeriphery}get scene(){return this._scene}get sceneOld(){return this._sceneOld}get scenePeriphery(){return this._scenePeriphery}updateImagePlanes(t){this._dispose(this._planesOld,this.sceneOld);for(const t in this._planes){if(!this._planes.hasOwnProperty(t))continue;const e=this._planes[t];this._scene.remove(e),this._sceneOld.add(e)}for(const e in t)t.hasOwnProperty(e)&&this._scene.add(t[e]);this._planesOld=this._planes,this._planes=t}addImagePlanes(t){for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];this._scene.add(i),this._planes[e]=i}}addImagePlanesOld(t){for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];this._sceneOld.add(i),this._planesOld[e]=i}}setImagePlanes(t){this._clear(),this.addImagePlanes(t)}addPeripheryPlanes(t){for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];this._scenePeriphery.add(i),this._planesPeriphery[e]=i}}setPeripheryPlanes(t){this._clearPeriphery(),this.addPeripheryPlanes(t)}setImagePlanesOld(t){this._clearOld(),this.addImagePlanesOld(t)}clear(){this._clear(),this._clearOld()}_clear(){this._dispose(this._planes,this._scene),this._planes={}}_clearOld(){this._dispose(this._planesOld,this._sceneOld),this._planesOld={}}_clearPeriphery(){this._dispose(this._planesPeriphery,this._scenePeriphery),this._planesPeriphery={}}_dispose(t,e){for(const i in t){if(!t.hasOwnProperty(i))continue;const n=t[i];e.remove(n),n.geometry.dispose(),n.material.dispose();let r=n.material.uniforms.projectorTex.value;null!=r&&r.dispose()}}}class nm{constructor(){this._factory=new em,this._scene=new im,this._alpha=0,this._alphaOld=0,this._fadeOutSpeed=.05,this._currentKey=null,this._previousKey=null,this._providerDisposers={},this._frameId=0,this._needsRender=!1}get frameId(){return this._frameId}get needsRender(){return this._needsRender}indicateNeedsRender(){this._needsRender=!0}addPeripheryPlane(t,e){const i=this._factory.createMesh(t,e),n={};n[t.id]=i,this._scene.addPeripheryPlanes(n),this._needsRender=!0}clearPeripheryPlanes(){this._scene.setPeripheryPlanes({}),this._needsRender=!0}updateFrame(t){this._updateFrameId(t.id),this._needsRender=this._updateAlpha(t.state.alpha)||this._needsRender,this._needsRender=this._updateAlphaOld(t.state.alpha)||this._needsRender,this._needsRender=this._updateImagePlanes(t.state)||this._needsRender}setTextureProvider(t,e){if(t!==this._currentKey)return;let i=e.textureCreated$.subscribe((t=>{this._updateTexture(t)})),n=e.textureUpdated$.subscribe((t=>{this._needsRender=!0}));if(t in this._providerDisposers){(0,this._providerDisposers[t])(),delete this._providerDisposers[t]}this._providerDisposers[t]=()=>{i.unsubscribe(),n.unsubscribe(),e.dispose()}}updateTextureImage(t,e){this._needsRender=!0;const i=this._extend({},this._scene.planes,this._scene.planesOld,this._scene.planesPeriphery);for(const n in i){if(!i.hasOwnProperty(n))continue;if(n!==e.id)continue;let r=i[n].material.uniforms.projectorTex.value;r.image=t,r.needsUpdate=!0}}render(t,e){const i=this._scene.planes,n=this._scene.planesOld,r=this._scene.planesPeriphery,s=Object.keys(n).length?1:this._alpha,o=Object.keys(n).length?1:Math.floor(this._alpha);for(const t in i){if(!i.hasOwnProperty(t))continue;i[t].material.uniforms.opacity.value=s}for(const t in n){if(!n.hasOwnProperty(t))continue;n[t].material.uniforms.opacity.value=this._alphaOld}for(const t in r){if(!r.hasOwnProperty(t))continue;r[t].material.uniforms.opacity.value=o}e.render(this._scene.scenePeriphery,t),e.render(this._scene.scene,t),e.render(this._scene.sceneOld,t);for(const t in i){if(!i.hasOwnProperty(t))continue;i[t].material.uniforms.opacity.value=this._alpha}e.render(this._scene.scene,t)}clearNeedsRender(){this._needsRender=!1}dispose(){this._scene.clear()}_updateFrameId(t){this._frameId=t}_updateAlpha(t){return t!==this._alpha&&(this._alpha=t,!0)}_updateAlphaOld(t){return!(t<1||0===this._alphaOld)&&(this._alphaOld=Math.max(0,this._alphaOld-this._fadeOutSpeed),!0)}_updateImagePlanes(t){if(null==t.currentImage||t.currentImage.id===this._currentKey)return!1;let e=null!=t.previousImage?t.previousImage.id:null,i=t.currentImage.id;if(this._previousKey!==e&&this._previousKey!==i&&this._previousKey in this._providerDisposers){(0,this._providerDisposers[this._previousKey])(),delete this._providerDisposers[this._previousKey]}if(null!=e){if(e!==this._currentKey&&e!==this._previousKey){let i=this._factory.createMesh(t.previousImage,t.previousTransform);const n={};n[e]=i,this._scene.updateImagePlanes(n)}this._previousKey=e}this._currentKey=i;let n=this._factory.createMesh(t.currentImage,t.currentTransform);const r={};return r[i]=n,this._scene.updateImagePlanes(r),this._alphaOld=1,!0}_updateTexture(t){this._needsRender=!0;const e=this._scene.planes;for(const i in e){if(!e.hasOwnProperty(i))continue;let n=e[i].material,r=n.uniforms.projectorTex.value;n.uniforms.projectorTex.value=null,r.dispose(),n.uniforms.projectorTex.value=t}}_extend(t,...e){for(const i of e)for(const e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t}}var rm;!function(t){t[t.Background=0]="Background",t[t.Opaque=1]="Opaque"}(rm||(rm={}));class sm{constructor(t){this._api=t,this._urls$=new Map}getImage$(t){let e;const i=new Promise(((t,i)=>{e=i}));return[b.create((n=>{this._api.data.getImageBuffer(t,i).then((t=>{e=null;const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{window.URL.revokeObjectURL(i.src),n.next(i),n.complete()},i.onerror=()=>{e=null,window.URL.revokeObjectURL(i.src),n.error(new Error("Failed to load image tile"))};const r=new Blob([t]);i.src=window.URL.createObjectURL(r)}),(t=>{e=null,n.error(t)}))})),()=>{e&&e()}]}getURLs$(t,e){const i=this._inventId(t,e);if(this._urls$.has(i))return this._urls$.get(i);const n={imageId:t,z:e},r=this._api.getImageTiles$(n).pipe(rt((t=>t.node)),Me((()=>{this._urls$.delete(i)})),He(),E());return this._urls$.set(i,r),r}_inventId(t,e){return`${t}-${e}`}}class om{constructor(){this._tiles=new Map,this._urlLevels=new Set,this._urls=new Map}add(t,e){if(this._tiles.has(t))throw new Error(`Image tile already stored (${t})`);this._tiles.set(t,e)}addURLs(t,e){const i=this._urls;for(const t of e){const e=this.inventId(t);if(this._urls.has(e))throw new Error(`URL already stored (${e})`);i.set(e,t.url)}this._urlLevels.add(t)}dispose(){this._tiles.forEach((t=>window.URL.revokeObjectURL(t.src))),this._tiles.clear(),this._urls.clear(),this._urlLevels.clear()}get(t){return this._tiles.get(t)}getURL(t){return this._urls.get(t)}has(t){return this._tiles.has(t)}hasURL(t){return this._urls.has(t)}hasURLLevel(t){return this._urlLevels.has(t)}inventId(t){return`${t.z}-${t.x}-${t.y}`}}class am{constructor(){this._viewportCoords=new Wf}computeRegionOfInterest(t,e,i){const n=this._viewportBoundaryPoints(4),r=this._viewportPointsBoundingBox(n,t,i);this._clipBoundingBox(r);const s=2/e.width,o=2/e.height,a=[[-.5*s,.5*o],[.5*s,.5*o],[.5*s,-.5*o],[-.5*s,-.5*o]],c=this._viewportPointsBoundingBox(a,t,i),h=c.minX<c.maxX;return{bbox:r,pixelHeight:c.maxY-c.minY,pixelWidth:c.maxX-c.minX+(h?0:1)}}_viewportBoundaryPoints(t){const e=[],i=[[-1,1],[1,1],[1,-1],[-1,-1]],n=[[2,0],[0,-2],[-2,0],[0,2]];for(let r=0;r<4;++r){const s=i[r],o=n[r];for(let i=0;i<t;++i)e.push([s[0]+o[0]*i/t,s[1]+o[1]*i/t])}return e}_viewportPointsBoundingBox(t,e,i){const n=t.map((t=>this._viewportCoords.viewportToBasic(t[0],t[1],i,e.perspective)));return dd(i.cameraType)?this._boundingBoxSpherical(n):this._boundingBox(n)}_boundingBox(t){const e={maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY};for(let i=0;i<t.length;++i)e.minX=Math.min(e.minX,t[i][0]),e.maxX=Math.max(e.maxX,t[i][0]),e.minY=Math.min(e.minY,t[i][1]),e.maxY=Math.max(e.maxY,t[i][1]);return e}_boundingBoxSpherical(t){const e=[],i=[];for(let n=0;n<t.length;++n)e.push(t[n][0]),i.push(t[n][1]);e.sort(((t,e)=>this._sign(t-e))),i.sort(((t,e)=>this._sign(t-e)));const n=this._intervalSpherical(e);return{maxX:n[1],maxY:i[i.length-1],minX:n[0],minY:i[0]}}_intervalSpherical(t){let e=0,i=-1;for(let n=0;n<t.length-1;++n){const r=t[n+1]-t[n];r>e&&(e=r,i=n)}return t[0]+1-t[t.length-1]>e?[t[0],t[t.length-1]]:[t[i+1],t[i]]}_clipBoundingBox(t){t.minX=Math.max(0,Math.min(1,t.minX)),t.maxX=Math.max(0,Math.min(1,t.maxX)),t.minY=Math.max(0,Math.min(1,t.minY)),t.maxY=Math.max(0,Math.min(1,t.maxY))}_sign(t){return t>0?1:t<0?-1:0}}function cm(t,e,i){return Math.max(e,Math.min(i,t))}function hm(t){return 1024/lm(t)}function lm(t){return Math.pow(2,t.z-t.max)}function um(t){return Math.ceil(function(t){const e=Math.max(t.w,t.h);return Math.log(e)/Math.log(2)}(t))}function dm(t,e,i){const n=hm(i),r=e.w,s=e.h,o=Math.ceil(r/n)-1,a=Math.ceil(s/n)-1;return{x:cm(Math.floor(r*t[0]/n),0,o),y:cm(Math.floor(s*t[1]/n),0,a)}}function pm(t,e,i){const n=1024*(1/lm(i)),r=n*t.x,s=n*t.y,o=Math.min(n,e.w-r);return{h:Math.min(n,e.h-s),x:r,y:s,w:o}}function fm(t,e,i){return i*t<=e&&e<i*(t+1)}function mm(t,e){if(t.z===e.z)return t.x===e.x&&t.y===e.y;const i=t.z<e.z?t:e,n=t.z<e.z?e:t,r=1/lm({max:n.z,z:i.z}),s=fm(i.x,n.x,r),o=fm(i.y,n.y,r);return s&&o}function gm(t){return t.w>0&&t.h>0}class _m{constructor(t,e,i,n,r,s,o){const a={h:i,w:e};gm(a)||console.warn(`Original image size (${e}, ${i}) is invalid (${t}). Tiles will not be loaded.`),this._imageId=t,this._size=a,this._level={max:um(this._size),z:-1},this._holder=new Uf,this._updated$=new T,this._createdSubject$=new T,this._created$=this._createdSubject$.pipe(Ue(1),E()),this._holder.push(this._created$.subscribe((()=>{}))),this._hasSubject$=new T,this._has$=this._hasSubject$.pipe(ni(!1),Ue(1),E()),this._holder.push(this._has$.subscribe((()=>{}))),this._renderedLevel=new Set,this._rendered=new Map,this._subscriptions=new Map,this._urlSubscriptions=new Map,this._loader=r,this._store=s,this._background=n,this._renderer=o,this._aborts=[],this._render=null,this._disposed=!1}get disposed(){return this._disposed}get hasTexture$(){return this._has$}get id(){return this._imageId}get textureUpdated$(){return this._updated$}get textureCreated$(){return this._created$}abort(){this._subscriptions.forEach((t=>t.unsubscribe())),this._subscriptions.clear();for(const t of this._aborts)t();this._aborts=[]}dispose(){this._disposed?console.warn(`Texture already disposed (${this._imageId})`):(this._urlSubscriptions.forEach((t=>t.unsubscribe())),this._urlSubscriptions.clear(),this.abort(),null!=this._render&&(this._render.target.dispose(),this._render.target=null,this._render.camera=null,this._render=null),this._store.dispose(),this._holder.unsubscribe(),this._renderedLevel.clear(),this._background=null,this._renderer=null,this._disposed=!0)}setRegionOfInterest(t){if(!gm(this._size))return;const e=1/t.pixelWidth,i=function(t,e,i){return Math.max(e,Math.min(i,um(t)))}({h:1/t.pixelHeight,w:e},11,this._level.max);i!==this._level.z&&(this.abort(),this._level.z=i,this._renderedLevel.clear(),this._rendered.forEach(((t,e)=>{t.z===i&&this._renderedLevel.add(e)}))),null==this._render&&this._initRender();const n=function(t,e,i,n){const r=[];if(t.x>e.x){const s=hm(n),o=Math.ceil(i.w/s)-1;for(let e=t.x;e<=o;e++)r.push(e);for(let t=0;t<=e.x;t++)r.push(t)}else for(let i=t.x;i<=e.x;i++)r.push(i);const s=[];for(const i of r)for(let n=t.y;n<=e.y;n++)s.push({x:i,y:n});return s}(dm([t.bbox.minX,t.bbox.minY],this._size,this._level),dm([t.bbox.maxX,t.bbox.maxY],this._size,this._level),this._size,this._level);this._fetchTiles(i,n)}_fetchTile(t){const e=this._loader.getImage$(t.url),i=e[0],n=e[1];this._aborts.push(n);const r=this._store.inventId(t),s=i.subscribe((e=>{const i=pm(t,this._size,this._level);this._renderToTarget(i,e),this._subscriptions.delete(r),this._removeFromArray(n,this._aborts),this._markRendered(t),this._store.add(r,e),this._updated$.next(!0)}),(t=>{this._subscriptions.delete(r),this._removeFromArray(n,this._aborts),console.error(t)}));s.closed||this._subscriptions.set(r,s)}_fetchTiles(t,e){const i=(this._store.hasURLLevel(t)?G(void 0):this._loader.getURLs$(this._imageId,t).pipe(pi((e=>{this._store.hasURLLevel(t)||this._store.addURLs(t,e)})))).subscribe((()=>{if(t===this._level.z){for(const i of e){const e={x:i.x,y:i.y,z:t,url:null},n=this._store.inventId(e);if(!this._renderedLevel.has(n)&&!this._subscriptions.has(n))if(this._store.has(n)){const t=pm(i,this._size,this._level);this._renderToTarget(t,this._store.get(n)),this._markRendered(e),this._updated$.next(!0)}else e.url=this._store.getURL(n),this._fetchTile(e)}this._urlSubscriptions.delete(t)}}),(e=>{this._urlSubscriptions.delete(t),console.error(e)}));i.closed||this._urlSubscriptions.set(t,i)}_initRender(){const t=this._size.w/2,e=this._size.h/2,i=new Kl(-t,t,e,-e,-1,1);i.position.z=1;const n=this._renderer.getContext(),r=n.getParameter(n.MAX_TEXTURE_SIZE),s=Math.max(this._size.w,this._size.h),o=r>s?1:r/s,a=Math.floor(o*this._size.w),c=Math.floor(o*this._size.h),h=new dn(a,c,{depthBuffer:!1,format:ki,magFilter:Ai,minFilter:Ai,stencilBuffer:!1});this._render={camera:i,target:h};const l=pm({x:0,y:0},this._size,{max:this._level.max,z:0});this._renderToTarget(l,this._background),this._createdSubject$.next(h.texture),this._hasSubject$.next(!0)}_markRendered(t){const e=Array.from(this._rendered.entries()).filter((([e,i])=>i.z!==t.z));for(const[i,n]of e)mm(t,n)&&this._rendered.delete(i);const i=this._store.inventId(t);this._rendered.set(i,t),this._renderedLevel.add(i)}_removeFromArray(t,e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}_renderToTarget(t,e){const i=new hn(e);i.minFilter=Ai,i.needsUpdate=!0;const n=new qs(t.w,t.h),r=new Fr({map:i,side:0}),s=new Es(n,r);s.position.x=-this._size.w/2+t.x+t.w/2,s.position.y=this._size.h/2-t.y-t.h/2;const o=new Qa;o.add(s);const a=this._renderer.getRenderTarget();this._renderer.resetState(),this._renderer.setRenderTarget(this._render.target),this._renderer.render(o,this._render.camera),this._renderer.setRenderTarget(a),o.remove(s),n.dispose(),r.dispose(),i.dispose()}}var vm,ym,bm,xm,wm,Sm;!function(t){t[t.Custom=0]="Custom",t[t.Earth=1]="Earth",t[t.Traversing=2]="Traversing",t[t.Waiting=3]="Waiting",t[t.WaitingInteractively=4]="WaitingInteractively"}(vm||(vm={}));class Mm extends Vf{constructor(t,e,i){super(t,e,i),this._imageTileLoader=new sm(i.api),this._roiCalculator=new am,this._rendererOperation$=new T,this._rendererCreator$=new T,this._rendererDisposer$=new T,this._renderer$=this._rendererOperation$.pipe(Le(((t,e)=>e(t)),null),Nt((t=>null!=t)),ue(void 0,(t=>t.frameId))),this._rendererCreator$.pipe(rt((()=>t=>{if(null!=t)throw new Error("Multiple image plane states can not be created at the same time");return new nm}))).subscribe(this._rendererOperation$),this._rendererDisposer$.pipe(rt((()=>t=>(t.dispose(),null)))).subscribe(this._rendererOperation$)}_activate(){const t=this._subscriptions;t.push(this._renderer$.pipe(rt((t=>{const e={name:this._name,renderer:{frameId:t.frameId,needsRender:t.needsRender,render:t.render.bind(t),pass:rm.Background}};return t.clearNeedsRender(),e}))).subscribe(this._container.glRenderer.render$)),this._rendererCreator$.next(null),t.push(this._navigator.stateService.currentState$.pipe(rt((t=>e=>(e.updateFrame(t),e)))).subscribe(this._rendererOperation$));const e=this._container.configurationService.imageTiling$.pipe(ri((t=>t?this._navigator.stateService.currentState$:new T)),ue(void 0,(t=>t.state.currentImage.id)),bi(this._container.glRenderer.webGLRenderer$),rt((([t,e])=>{const i=t.state,n=i.currentImage,r=i.currentTransform;return new _m(n.id,r.basicWidth,r.basicHeight,n.image,this._imageTileLoader,new om,e)})),Ue(1),E());t.push(e.subscribe((()=>{}))),t.push(e.pipe(rt((t=>e=>(e.setTextureProvider(t.id,t),e)))).subscribe(this._rendererOperation$)),t.push(e.pipe(ze()).subscribe((t=>{t[0].abort()})));const i=this._container.configurationService.imageTiling$.pipe(ri((t=>t?gt(this._navigator.stateService.state$,this._navigator.stateService.inTranslation$):new T)),ri((([t,e])=>(t===vm.Traversing||t===vm.Waiting||t===vm.WaitingInteractively)&&!e?this._container.renderService.renderCameraFrame$:B())),rt((t=>({camera:t,height:t.size.height.valueOf(),lookat:t.camera.lookat.clone(),width:t.size.width.valueOf(),zoom:t.zoom.valueOf()}))),ze(),rt((([t,e])=>{const i=t.width===e.width&&t.height===e.height&&t.zoom===e.zoom&&t.lookat.equals(e.lookat);return{camera:e.camera,stalled:i}})),ue(((t,e)=>t.stalled===e.stalled)),Nt((t=>t.stalled)),bi(this._container.renderService.size$,this._navigator.stateService.currentTransform$));t.push(e.pipe(ri((t=>i.pipe(rt((([e,i,n])=>{const r=e.camera,s=(new Wf).viewportToBasic(0,0,n,r.perspective);if(!(s[0]<0||s[1]<0||s[0]>1||s[1]>1))return[this._roiCalculator.computeRegionOfInterest(r,i,n),t]})),Nt((t=>!!t))))),Nt((t=>!t[1].disposed))).subscribe((([t,e])=>{e.setRegionOfInterest(t)})));const n=e.pipe(ri((t=>t.hasTexture$)),ni(!1),Ue(1),E());t.push(n.subscribe((()=>{}))),t.push(this._navigator.panService.panImages$.pipe(Nt((t=>0===t.length)),rt((()=>t=>(t.clearPeripheryPlanes(),t)))).subscribe(this._rendererOperation$));const r=this._navigator.panService.panImages$.pipe(ri((t=>bt(t).pipe(Mt((([t,e])=>gt(this._navigator.graphService.cacheImage$(t.id).pipe(te((e=>(console.error(`Failed to cache periphery image (${t.id})`,e),B())))),G(e))))))),Ze());t.push(r.pipe(rt((([t,e])=>i=>(i.addPeripheryPlane(t,e),i)))).subscribe(this._rendererOperation$)),t.push(r.pipe(Mt((([t])=>t.cacheImage$().pipe(te((()=>B()))))),rt((t=>e=>(e.updateTextureImage(t.image,t),e)))).subscribe(this._rendererOperation$));const s=this._navigator.stateService.currentState$.pipe(rt((t=>t.state.alpha<1)),ue()),o=gt(this._container.mouseService.active$,this._container.touchService.active$,this._navigator.stateService.inMotion$,s).pipe(rt((([t,e,i,n])=>!(t||e||i||n))),Nt((t=>t)));t.push(this._navigator.stateService.state$.pipe(ri((t=>t===vm.Traversing?this._navigator.panService.panImages$:B())),ri((t=>o.pipe(bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentImage$,this._navigator.stateService.currentTransform$),Mt((([,e,i,n])=>G([e,i,n,t])))))),ri((([t,e,i,n])=>{const r=t.camera.lookat.clone().sub(t.camera.position),s=[(new ld).viewingDirection(e.rotation).angleTo(r),void 0],o=(new Wf).viewportToBasic(0,0,i,t.perspective);o[0]>=0&&o[0]<=1&&o[1]>=0&&o[1]<=1&&(s[0]=Number.NEGATIVE_INFINITY);for(const[t]of n){const e=(new ld).viewingDirection(t.rotation).angleTo(r);e<s[0]&&(s[0]=e,s[1]=t.id)}return s[1]?this._navigator.moveTo$(s[1]).pipe(te((()=>B()))):B()}))).subscribe())}_deactivate(){this._rendererDisposer$.next(null),this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{}}}Mm.componentName="image";class Tm{constructor(t,e,i){this._component=t,this._container=e,this._navigator=i,this._enabled=!1}get isEnabled(){return this._enabled}enable(){!this._enabled&&this._component.activated&&(this._enable(),this._enabled=!0,this._component.configure(this._getConfiguration(!0)))}disable(){this._enabled&&(this._disable(),this._enabled=!1,this._component.activated&&this._component.configure(this._getConfiguration(!1)))}}class Cm extends Tm{_enable(){const e=this._navigator.stateService.currentImage$.pipe(ri((t=>t.sequenceEdges$)));this._keyDownSubscription=this._container.keyboardService.keyDown$.pipe(bi(e)).subscribe((([e,i])=>{let n=null;switch(e.keyCode){case 38:n=t.NavigationDirection.Next;break;case 40:n=t.NavigationDirection.Prev;break;default:return}if(e.preventDefault(),e.altKey&&!e.shiftKey&&i.cached)for(const t of i.edges)if(t.data.direction===n)return void this._navigator.moveTo$(t.target).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))}))}_disable(){this._keyDownSubscription.unsubscribe()}_getConfiguration(t){return{keySequenceNavigation:t}}}class Em extends Tm{constructor(t,e,i,n){super(t,e,i),this._spatial=n}_enable(){const e=this._navigator.stateService.currentImage$.pipe(ri((t=>t.spatialEdges$)));this._keyDownSubscription=this._container.keyboardService.keyDown$.pipe(bi(e,this._navigator.stateService.currentState$)).subscribe((([e,i,n])=>{let r=dd(n.state.currentImage.cameraType),s=null;switch(e.keyCode){case 37:s=e.shiftKey&&!r?t.NavigationDirection.TurnLeft:t.NavigationDirection.StepLeft;break;case 38:s=e.shiftKey&&!r?t.NavigationDirection.Spherical:t.NavigationDirection.StepForward;break;case 39:s=e.shiftKey&&!r?t.NavigationDirection.TurnRight:t.NavigationDirection.StepRight;break;case 40:s=e.shiftKey&&!r?t.NavigationDirection.TurnU:t.NavigationDirection.StepBackward;break;default:return}if(e.preventDefault(),!(e.altKey||!i.cached||e.shiftKey&&r))if(r){const e={};e[t.NavigationDirection.StepBackward]=Math.PI,e[t.NavigationDirection.StepForward]=0,e[t.NavigationDirection.StepLeft]=Math.PI/2,e[t.NavigationDirection.StepRight]=-Math.PI/2;const r=this._rotationFromCamera(n.state.camera).phi,o=this._spatial.wrapAngle(r+e[s]),a=Math.PI/4,c=i.edges.filter((e=>e.data.direction===t.NavigationDirection.Spherical||e.data.direction===s));let h=Number.MAX_VALUE,l=null;for(const t of c){const e=Math.abs(this._spatial.wrapAngle(t.data.worldMotionAzimuth-o));e<Math.min(h,a)&&(h=e,l=t.target)}if(null==l)return;this._moveTo(l)}else this._moveDir(s,i)}))}_disable(){this._keyDownSubscription.unsubscribe()}_getConfiguration(t){return{keySpatialNavigation:t}}_moveDir(t,e){for(const i of e.edges)if(i.data.direction===t)return void this._moveTo(i.target)}_moveTo(t){this._navigator.moveTo$(t).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))}_rotationFromCamera(t){let e=t.lookat.clone().sub(t.position),i=e.clone().dot(t.up),n=e.clone().sub(t.up.clone().multiplyScalar(i));return{phi:Math.atan2(n.y,n.x),theta:Math.PI/2-this._spatial.angleToPlane(e.toArray(),[0,0,1])}}}class Im extends Tm{constructor(t,e,i,n){super(t,e,i),this._viewportCoords=n}_enable(){this._keyDownSubscription=this._container.keyboardService.keyDown$.pipe(bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$)).subscribe((([t,e,i])=>{if(t.altKey||t.ctrlKey||t.metaKey)return;let n=0;switch(t.key){case"+":n=1;break;case"-":n=-1;break;default:return}t.preventDefault();const r=this._viewportCoords.unprojectFromViewport(0,0,e.perspective),s=i.projectBasic(r.toArray());this._navigator.stateService.zoomIn(n,s)}))}_disable(){this._keyDownSubscription.unsubscribe()}_getConfiguration(t){return{keyZoom:t}}}class Am extends Tm{_enable(){this._keyDownSubscription=this._container.keyboardService.keyDown$.pipe(bi(this._navigator.playService.playing$,this._navigator.playService.direction$,this._navigator.playService.speed$,this._navigator.stateService.currentImage$.pipe(ri((t=>t.sequenceEdges$))),this._navigator.stateService.state$.pipe(rt((t=>t===vm.Earth)),ue()))).subscribe((([e,i,n,r,s,o])=>{if(!(e.altKey||e.ctrlKey||e.metaKey)){switch(e.key){case"D":if(!e.shiftKey)return;const a=i?null:n===t.NavigationDirection.Next?t.NavigationDirection.Prev:n===t.NavigationDirection.Prev?t.NavigationDirection.Next:null;null!=a&&this._navigator.playService.setDirection(a);break;case" ":if(e.shiftKey)return;if(!o)if(i)this._navigator.playService.stop();else for(let t of s.edges)t.data.direction===n&&this._navigator.playService.play();break;case"<":this._navigator.playService.setSpeed(r-.05);break;case">":this._navigator.playService.setSpeed(r+.05);break;default:return}e.preventDefault()}}))}_disable(){this._keyDownSubscription.unsubscribe()}_getConfiguration(t){return{keyPlay:t}}}class Pm extends Vf{constructor(t,e,i){super(t,e,i),this._keyPlayHandler=new Am(this,e,i),this._keySequenceNavigationHandler=new Cm(this,e,i),this._keySpatialNavigationHandler=new Em(this,e,i,new ld),this._keyZoomHandler=new Im(this,e,i,new Wf)}get keyPlay(){return this._keyPlayHandler}get keySequenceNavigation(){return this._keySequenceNavigationHandler}get keySpatialNavigation(){return this._keySpatialNavigationHandler}get keyZoom(){return this._keyZoomHandler}_activate(){this._subscriptions.push(this._configuration$.subscribe((t=>{t.keyPlay?this._keyPlayHandler.enable():this._keyPlayHandler.disable(),t.keySequenceNavigation?this._keySequenceNavigationHandler.enable():this._keySequenceNavigationHandler.disable(),t.keySpatialNavigation?this._keySpatialNavigationHandler.enable():this._keySpatialNavigationHandler.disable(),t.keyZoom?this._keyZoomHandler.enable():this._keyZoomHandler.disable()})))}_deactivate(){this._subscriptions.unsubscribe(),this._keyPlayHandler.disable(),this._keySequenceNavigationHandler.disable(),this._keySpatialNavigationHandler.disable(),this._keyZoomHandler.disable()}_getDefaultConfiguration(){return{keyPlay:!0,keySequenceNavigation:!0,keySpatialNavigation:!0,keyZoom:!0}}}Pm.componentName="keyboard";class Rm{constructor(t,e){this._needsRender=!1,this._interactiveObjects=[],this._markers={},this._objectMarkers={},this._raycaster=e||new Bu,this._scene=t||new Qa}get markers(){return this._markers}get needsRender(){return this._needsRender}add(t,e){t.id in this._markers&&this._dispose(t.id),t.createGeometry(e),this._scene.add(t.geometry),this._markers[t.id]=t;for(let e of t.getInteractiveObjects())this._interactiveObjects.push(e),this._objectMarkers[e.uuid]=t.id;this._needsRender=!0}clear(){for(const t in this._markers)this._markers.hasOwnProperty&&this._dispose(t);this._needsRender=!0}get(t){return this._markers[t]}getAll(){return Object.keys(this._markers).map((t=>this._markers[t]))}has(t){return t in this._markers}intersectObjects([t,e],i){this._raycaster.setFromCamera(new rn(t,e),i);const n=this._raycaster.intersectObjects(this._interactiveObjects);for(const t of n)if(t.object.uuid in this._objectMarkers)return this._objectMarkers[t.object.uuid];return null}lerpAltitude(t,e,i){t in this._markers&&(this._markers[t].lerpAltitude(e,i),this._needsRender=!0)}remove(t){t in this._markers&&(this._dispose(t),this._needsRender=!0)}render(t,e){e.render(this._scene,t),this._needsRender=!1}update(t,e,i){if(!(t in this._markers))return;this._markers[t].updatePosition(e,i),this._needsRender=!0}_dispose(t){const e=this._markers[t];this._scene.remove(e.geometry);for(let i of e.getInteractiveObjects()){const e=this._interactiveObjects.indexOf(i);-1!==e?this._interactiveObjects.splice(e,1):console.warn(`Object does not exist (${i.id}) for ${t}`),delete this._objectMarkers[i.uuid]}e.disposeGeometry(),delete this._markers[t]}}class Lm extends Vf{constructor(t,e,i){super(t,e,i),this._graphCalculator=new td,this._markerScene=new Rm,this._markerSet=new yd,this._viewportCoords=new Wf,this._relativeGroundAltitude=-2}add(t){this._markerSet.add(t)}fire(t,e){super.fire(t,e)}get(t){return this._markerSet.get(t)}getAll(){return this._markerSet.getAll()}getMarkerIdAt(t){return new Promise(((e,i)=>{this._container.renderService.renderCamera$.pipe(Ee(),rt((e=>{const i=this._viewportCoords.canvasToViewport(t[0],t[1],this._container.container);return this._markerScene.intersectObjects(i,e.perspective)}))).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}has(t){return this._markerSet.has(t)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}remove(t){this._markerSet.remove(t)}removeAll(){this._markerSet.removeAll()}_activate(){const t=this._navigator.stateService.currentState$.pipe(rt((t=>t.state.camera.position.z+this._relativeGroundAltitude)),ue(((t,e)=>Math.abs(t-e)<.01)),Ue(1),E()),e=gt(t,this._navigator.stateService.reference$).pipe(Ee(),rt((()=>{})),Ue(1),E()),i=this._configuration$.pipe(rt((t=>({visibleBBoxSize:Math.max(1,Math.min(200,t.visibleBBoxSize))})))),n=this._navigator.stateService.currentImage$.pipe(rt((t=>t.lngLat)),Ue(1),E()),r=gt(i,n).pipe(rt((([t,e])=>this._graphCalculator.boundingBoxCorners(e,t.visibleBBoxSize/2))),Ue(1),E()),s=gt(At(G(this._markerSet),this._markerSet.changed$),r).pipe(rt((([t,e])=>t.search(e)))),o=this._subscriptions;o.push(e.pipe(ri((()=>s.pipe(bi(this._navigator.stateService.reference$,t))))).subscribe((([t,e,i])=>{const n=this._markerScene,r=n.markers,s=Object.assign({},r);for(const o of t)if(o.id in r)delete s[o.id];else{const t=Ju(o.lngLat.lng,o.lngLat.lat,e.alt+i,e.lng,e.lat,e.alt);n.add(o,t)}for(const t in s)s.hasOwnProperty(t)&&n.remove(t)}))),o.push(e.pipe(ri((()=>this._markerSet.updated$.pipe(bi(r,this._navigator.stateService.reference$,t))))).subscribe((([t,[e,i],n,r])=>{const s=this._markerScene;for(const o of t){const t=s.has(o.id),a=o.lngLat.lat>e.lat&&o.lngLat.lat<i.lat&&o.lngLat.lng>e.lng&&o.lngLat.lng<i.lng;if(a){const t=Ju(o.lngLat.lng,o.lngLat.lat,n.alt+r,n.lng,n.lat,n.alt);s.add(o,t)}else!a&&t&&s.remove(o.id)}}))),o.push(this._navigator.stateService.reference$.pipe(Je(1),bi(t)).subscribe((([t,e])=>{const i=this._markerScene;for(const n of i.getAll()){const r=Ju(n.lngLat.lng,n.lngLat.lat,t.alt+e,t.lng,t.lat,t.alt);i.update(n.id,r)}}))),o.push(t.pipe(Je(1),bi(this._navigator.stateService.reference$,n)).subscribe((([t,e,i])=>{const n=this._markerScene,r=Ju(i.lng,i.lat,e.alt+t,e.lng,e.lat,e.alt);for(const i of n.getAll()){const s=Ju(i.lngLat.lng,i.lngLat.lat,e.alt+t,e.lng,e.lat,e.alt),o=s[0]-r[0],a=s[1]-r[1],c=Math.sqrt(o*o+a*a);c>50||n.lerpAltitude(i.id,t,Math.min(1,Math.max(0,1.2-1.2*c/50)))}}))),o.push(this._navigator.stateService.currentState$.pipe(rt((t=>{const e=this._markerScene;return{name:this._name,renderer:{frameId:t.id,needsRender:e.needsRender,render:e.render.bind(e),pass:rm.Opaque}}}))).subscribe(this._container.glRenderer.render$));const a=gt(this._container.renderService.renderCamera$,this._container.mouseService.mouseMove$).pipe(rt((([t,e])=>{const i=this._container.container,[n,r]=this._viewportCoords.canvasPosition(e,i),s=this._viewportCoords.canvasToViewport(n,r,i);return this._markerScene.intersectObjects(s,t.perspective)})),Ue(1),E()),c=this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseDragStart$).pipe(rt((()=>!0))),h=this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseDragEnd$).pipe(rt((()=>!1))),l=Ot(c,h).pipe(ni(!1));o.push(Ot(c.pipe(bi(a)),gt(h,G(null))).pipe(ni([!1,null]),ze()).subscribe((([t,e])=>{const i=e[0],n=i?"markerdragstart":"markerdragend",r=i?e[1]:t[1],s={marker:this._markerScene.get(r),target:this,type:n};this.fire(n,s)})));const u=Ot(this._container.mouseService.mouseDown$.pipe(rt((()=>!0))),this._container.mouseService.documentMouseUp$.pipe(rt((()=>!1)))).pipe(ni(!1));o.push(gt(this._container.mouseService.active$,a.pipe(ue()),u,l).pipe(rt((([t,e,i,n])=>!t&&null!=e&&i||n)),ue()).subscribe((t=>{t?(this._container.mouseService.claimMouse(this._name,1),this._container.mouseService.claimWheel(this._name,1)):(this._container.mouseService.unclaimMouse(this._name),this._container.mouseService.unclaimWheel(this._name))})));const d=this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseDragStart$).pipe(bi(a,this._container.renderService.renderCamera$),rt((([t,e,i])=>{const n=this._markerScene.get(e),r=this._container.container,[s,o]=this._viewportCoords.projectToCanvas(n.geometry.position.toArray(),r,i.perspective),[a,c]=this._viewportCoords.canvasPosition(t,r);return[n,[a-s,c-o],i]})),Ue(1),E());o.push(this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseDrag$).pipe(bi(d,this._navigator.stateService.reference$,i)).subscribe((([t,[e,i,n],r,s])=>{if(!this._markerScene.has(e.id))return;const o=this._container.container,[a,c]=this._viewportCoords.canvasPosition(t,o),h=a-i[0],l=c-i[1],[u,d]=this._viewportCoords.canvasToViewport(h,l,o),p=new fn(u,d,1).unproject(n.perspective).sub(n.perspective.position).normalize(),f=Math.min(this._relativeGroundAltitude/p.z,s.visibleBBoxSize/2-.1);if(f<0)return;const m=p.clone().multiplyScalar(f).add(n.perspective.position);m.z=n.perspective.position.z+this._relativeGroundAltitude;const[g,_]=Ku(m.x,m.y,m.z,r.lng,r.lat,r.alt);this._markerScene.update(e.id,m.toArray(),{lat:_,lng:g}),this._markerSet.update(e);const v="markerposition",y={marker:e,target:this,type:v};this.fire(v,y)})))}_deactivate(){this._subscriptions.unsubscribe(),this._markerScene.clear()}_getDefaultConfiguration(){return{visibleBBoxSize:100}}}function Om(t,e){return t.x<=Math.max(e.p1.x,e.p2.x)&&t.x>=Math.min(e.p1.x,e.p2.x)&&t.y>=Math.max(e.p1.y,e.p2.y)&&t.y>=Math.min(e.p1.y,e.p2.y)}function Nm(t,e){const i=t.p2.x-t.p1.x,n=t.p2.y-t.p1.y,r=e.p2.x-e.p1.x,s=e.p2.y-e.p1.y,o=i*s-n*r;return o*o<1e-10*(i*i+n*n)*(r*r+s*s)}function Dm(t,e,i){const n=(e.y-t.y)*(i.x-e.x)-(i.y-e.y)*(e.x-t.x);return(r=n)>0?1:r<0?-1:0;var r}function $m(t,e){if(Nm(t,e))return!1;const i=Dm(t.p1,t.p2,e.p1),n=Dm(t.p1,t.p2,e.p2),r=Dm(e.p1,e.p2,t.p1),s=Dm(e.p1,e.p2,t.p2);return i!==n&&r!==s||(!(0!==i||!Om(e.p1,t))||(!(0!==n||!Om(e.p2,t))||(!(0!==r||!Om(t.p1,e))||!(0!==s||!Om(t.p2,e)))))}function km(t,e){if(Nm(t,e))return;const i=t.p1.x,n=t.p2.x,r=t.p1.y,s=t.p2.y,o=e.p1.x,a=e.p2.x,c=e.p1.y,h=e.p2.y,l=(i-n)*(c-h)-(r-s)*(o-a);return{x:((i*s-r*n)*(o-a)-(i-n)*(o*h-c*a))/l,y:((i*s-r*n)*(c-h)-(r-s)*(o*h-c*a))/l}}function zm(t,e){return t>=-1&&t<=1&&e>=-1&&e<=1}function Fm(t,e){return t>=0&&t<=1&&e>=0&&e<=1}function Bm(t,e,i){const n=function(t){let e=[],i=[[0,0],[1,0],[1,1],[0,1]],n=[[1,0],[0,1],[-1,0],[0,-1]];for(let r=0;r<4;++r){let s=i[r],o=n[r];for(let i=0;i<t;++i)e.push([s[0]+o[0]*i/t,s[1]+o[1]*i/t])}return e}(100).map((n=>i.basicToViewportSafe(n[0],n[1],t,e))),r=[],s=[{x:-1,y:1},{x:1,y:1},{x:1,y:-1},{x:-1,y:-1}],o=[!1,!1,!1,!1];for(let t=0;t<n.length;t++){const e=n[t],i=n[(t+1)%n.length];if(null===e)continue;if(null===i){zm(e[0],e[1])&&r.push(e);continue}const[a,c]=e,[h,l]=i;if(zm(a,c))if(zm(h,l))r.push(e);else for(let t=0;t<4;t++){const i={p1:{x:a,y:c},p2:{x:h,y:l}},n={p1:s[t],p2:s[(t+1)%4]};if($m(i,n)){const s=km(i,n);r.push(e,[s.x,s.y]),o[t]=!0}}}const[a,c]=i.viewportToBasic(-1,1,t,e),[h,l]=i.viewportToBasic(1,1,t,e),[u,d]=i.viewportToBasic(1,-1,t,e),[p,f]=i.viewportToBasic(-1,-1,t,e);Fm(a,c)&&(o[3]=o[0]=!0),Fm(h,l)&&(o[0]=o[1]=!0),Fm(u,d)&&(o[1]=o[2]=!0),Fm(p,f)&&(o[2]=o[3]=!0);const m=[-1,-1,1,1];for(let t of r){const e=t[0],i=t[1];e>m[1]&&(m[1]=e),e<m[3]&&(m[3]=e),i>m[0]&&(m[0]=i),i<m[2]&&(m[2]=i)}const g=[1,1,-1,-1],_=[];for(let t=0;t<4;t++)o[t]?_.push(0):_.push(Math.abs(g[t]-m[t]));return _}Lm.componentName="marker";class jm extends Tm{constructor(t,e,i,n,r){super(t,e,i),this._spatial=r,this._viewportCoords=n}_enable(){const t=this._navigator.stateService.currentState$.pipe(rt((t=>t.state.alpha<1)),ue());this._bounceSubscription=gt(t,this._navigator.stateService.inTranslation$,this._container.mouseService.active$,this._container.touchService.active$).pipe(rt((t=>t[0]||t[1]||t[2]||t[3])),ue(),ri((t=>t?B():gt(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$.pipe(Ee())))),bi(this._navigator.panService.panImages$)).subscribe((([[t,e],i])=>{if(!e.hasValidScale&&t.camera.focal<.1)return;if(0===t.perspective.aspect||t.perspective.aspect===Number.POSITIVE_INFINITY)return;const n=Bm(e,t.perspective,this._viewportCoords),r=this._viewportCoords.viewportToBasic(0,0,e,t.perspective);(r[0]<0||r[0]>1)&&i.length>0&&(n[0]=n[2]=0);for(const[,e]of i){const i=Bm(e,t.perspective,this._viewportCoords);for(let t=1;t<n.length;t+=2)i[t]<n[t]&&(n[t]=i[t])}if(Math.max(...n)<.01)return;const s=n[1]-n[3],o=n[0]-n[2],a=this._viewportCoords.unprojectFromViewport(0,0,t.perspective).sub(t.perspective.position),c=this._viewportCoords.unprojectFromViewport(s,0,t.perspective).sub(t.perspective.position),h=this._viewportCoords.unprojectFromViewport(0,o,t.perspective).sub(t.perspective.position);let l=(s>0?1:-1)*c.angleTo(a),u=(o>0?1:-1)*h.angleTo(a);const d=Math.PI/60;l=this._spatial.clamp(.1*l,-d,d),u=this._spatial.clamp(.1*u,-d,d),this._navigator.stateService.rotateUnbounded({phi:l,theta:u})}))}_disable(){this._bounceSubscription.unsubscribe()}_getConfiguration(){return{}}}class Hm{static filteredPairwiseMouseDrag$(t,e){return this._filteredPairwiseMouseDrag$(t,e,e.mouseDragStart$,e.mouseDrag$,e.mouseDragEnd$)}static filteredPairwiseMouseRightDrag$(t,e){return this._filteredPairwiseMouseDrag$(t,e,e.mouseRightDragStart$,e.mouseRightDrag$,e.mouseRightDragEnd$)}static _filteredPairwiseMouseDrag$(t,e,i,n,r){return e.filtered$(t,i).pipe(ri((i=>Ot(At(G(i),e.filtered$(t,n)),e.filtered$(t,r).pipe(rt((()=>null)))).pipe(li((t=>!!t)),ni(null)))),ze(),Nt((t=>null!=t[0]&&null!=t[1])))}}class Um extends Tm{constructor(t,e,i,n,r){super(t,e,i),this._spatial=r,this._viewportCoords=n}_enable(){let t=this._container.mouseService.filtered$(this._component.name,this._container.mouseService.mouseDragStart$).pipe(rt((()=>!0)),Ze()),e=this._container.mouseService.filtered$(this._component.name,this._container.mouseService.mouseDragEnd$).pipe(rt((()=>!1)),Ze());this._activeMouseSubscription=Ot(t,e).subscribe(this._container.mouseService.activate$);const i=Ot(t,e).pipe(ri((t=>t?this._container.mouseService.documentMouseMove$:B())));this._preventDefaultSubscription=Ot(i,this._container.touchService.touchMove$).subscribe((t=>{t.preventDefault()}));let n=this._container.touchService.singleTouchDragStart$.pipe(rt((()=>!0))),r=this._container.touchService.singleTouchDragEnd$.pipe(rt((()=>!1)));this._activeTouchSubscription=Ot(n,r).subscribe(this._container.touchService.activate$);const s=this._navigator.stateService.currentState$.pipe(rt((t=>dd(t.state.currentImage.cameraType)||t.state.imagesAhead<1)),ue(),ri((t=>{if(!t)return B();const e=Hm.filteredPairwiseMouseDrag$(this._component.name,this._container.mouseService),i=Ot(this._container.touchService.singleTouchDragStart$,this._container.touchService.singleTouchDrag$,this._container.touchService.singleTouchDragEnd$.pipe(rt((()=>null)))).pipe(rt((t=>null!=t&&t.touches.length>0?t.touches[0]:null)),ze(),Nt((t=>null!=t[0]&&null!=t[1])));return Ot(e,i)})),bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$,this._navigator.panService.panImages$),rt((([t,e,i,n])=>{let r=t[0],s=t[1],o=s.clientX-r.clientX,a=s.clientY-r.clientY,c=this._container.container,[h,l]=this._viewportCoords.canvasPosition(s,c),u=this._viewportCoords.unprojectFromCanvas(h,l,c,e.perspective).sub(e.perspective.position),d=this._viewportCoords.unprojectFromCanvas(h-o,l,c,e.perspective).sub(e.perspective.position),p=this._viewportCoords.unprojectFromCanvas(h,l-a,c,e.perspective).sub(e.perspective.position),f=(o>0?1:-1)*d.angleTo(u),m=(a>0?-1:1)*p.angleTo(u);const g=Bm(i,e.perspective,this._viewportCoords);for(const[,t]of n){const i=Bm(t,e.perspective,this._viewportCoords);for(let t=0;t<g.length;t++)i[t]<g[t]&&(g[t]=i[t])}return g[0]>0&&m<0&&(m/=Math.max(1,200*g[0])),g[2]>0&&m>0&&(m/=Math.max(1,200*g[2])),g[1]>0&&f<0&&(f/=Math.max(1,200*g[1])),g[3]>0&&f>0&&(f/=Math.max(1,200*g[3])),{phi:f,theta:m}})),Ze());var o;this._rotateWithoutInertiaSubscription=s.subscribe((t=>{this._navigator.stateService.rotateWithoutInertia(t)})),this._rotateSubscription=s.pipe(Le(((t,e)=>(this._drainBuffer(t),t.push([Date.now(),e]),t)),[]),(o=Ot(this._container.mouseService.filtered$(this._component.name,this._container.mouseService.mouseDragEnd$),this._container.touchService.singleTouchDragEnd$),function(t){return t.lift(new We(o))}),rt((t=>{const e=this._drainBuffer(t.slice()),i={phi:0,theta:0};for(const t of e)i.phi+=t[1].phi,i.theta+=t[1].theta;const n=e.length;n>0&&(i.phi/=n,i.theta/=n);const r=Math.PI/18;return i.phi=this._spatial.clamp(i.phi,-r,r),i.theta=this._spatial.clamp(i.theta,-r,r),i}))).subscribe((t=>{this._navigator.stateService.rotate(t)}))}_disable(){this._activeMouseSubscription.unsubscribe(),this._activeTouchSubscription.unsubscribe(),this._preventDefaultSubscription.unsubscribe(),this._rotateSubscription.unsubscribe(),this._rotateWithoutInertiaSubscription.unsubscribe(),this._activeMouseSubscription=null,this._activeTouchSubscription=null,this._preventDefaultSubscription=null,this._rotateSubscription=null}_getConfiguration(t){return{dragPan:t}}_drainBuffer(t){const e=Date.now();for(;t.length>0&&e-t[0][0]>50;)t.shift();return t}}class Vm extends Tm{constructor(t,e,i,n,r){super(t,e,i),this._spatial=r,this._viewportCoords=n,this._subscriptions=new Uf}_enable(){const t=this._navigator.stateService.state$.pipe(rt((t=>t===vm.Earth)),Ue(1),E()),e=this._subscriptions;e.push(t.pipe(ri((t=>t?this._container.mouseService.mouseWheel$:B()))).subscribe((t=>{t.preventDefault()}))),e.push(t.pipe(ri((t=>t?Hm.filteredPairwiseMouseDrag$(this._component.name,this._container.mouseService).pipe(Nt((([t,e])=>!(t.ctrlKey&&e.ctrlKey)))):B())),bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$),rt((([[t,e],i,n])=>{const r=[0,0,1],s=[0,0,-2],o=this._planeIntersection(e,r,s,i.perspective,this._container.container),a=this._planeIntersection(t,r,s,i.perspective,this._container.container);if(!o||!a)return null;return(new fn).subVectors(o,a).multiplyScalar(-1).toArray()})),Nt((t=>!!t))).subscribe((t=>{this._navigator.stateService.truck(t)}))),e.push(t.pipe(ri((t=>t?Hm.filteredPairwiseMouseDrag$(this._component.name,this._container.mouseService).pipe(Nt((([t,e])=>t.ctrlKey&&e.ctrlKey))):B())),rt((([t,e])=>this._mousePairToRotation(t,e)))).subscribe((t=>{this._navigator.stateService.orbit(t)}))),e.push(t.pipe(ri((t=>t?Hm.filteredPairwiseMouseRightDrag$(this._component.name,this._container.mouseService).pipe(Nt((([t,e])=>!t.ctrlKey&&!e.ctrlKey))):B())),rt((([t,e])=>this._mousePairToRotation(t,e)))).subscribe((t=>{this._navigator.stateService.orbit(t)}))),e.push(t.pipe(ri((t=>t?this._container.mouseService.filteredWheel$(this._component.name,this._container.mouseService.mouseWheel$):B())),rt((t=>{let e=t.deltaY;1===t.deltaMode?e*=40:2===t.deltaMode&&(e*=800);return-e/this._viewportCoords.containerToCanvas(this._container.container)[1]}))).subscribe((t=>{this._navigator.stateService.dolly(t)})))}_disable(){this._subscriptions.unsubscribe()}_getConfiguration(){return{}}_eventToViewport(t,e){const i=this._viewportCoords.canvasPosition(t,e);return this._viewportCoords.canvasToViewport(i[0],i[1],e)}_mousePairToRotation(t,e){const[i,n]=this._eventToViewport(e,this._container.container),[r,s]=this._eventToViewport(t,this._container.container);return{phi:(r-i)*Math.PI,theta:(n-s)*Math.PI/2}}_planeIntersection(t,e,i,n,r){const[s,o]=this._viewportCoords.canvasPosition(t,r),a=this._viewportCoords.unprojectFromCanvas(s,o,r,n).sub(n.position).normalize();if(Math.abs(this._spatial.angleToPlane(a.toArray(),e))<Math.PI/90)return null;const c=n.position.clone(),h=(new fn).fromArray(e),l=(new fn).fromArray(i),u=(new fn).subVectors(l,c).dot(h)/a.clone().dot(h),d=(new fn).addVectors(c,a.multiplyScalar(u));return this._viewportCoords.worldToCamera(d.toArray(),n)[2]>0?null:d}}class Gm extends Tm{constructor(t,e,i,n){super(t,e,i),this._viewportCoords=n}_enable(){this._container.mouseService.claimWheel(this._component.name,0),this._preventDefaultSubscription=this._container.mouseService.mouseWheel$.subscribe((t=>{t.preventDefault()})),this._zoomSubscription=this._container.mouseService.filteredWheel$(this._component.name,this._container.mouseService.mouseWheel$).pipe(bi(this._navigator.stateService.currentState$,((t,e)=>[t,e])),Nt((t=>{let e=t[1].state;return dd(e.currentImage.cameraType)||e.imagesAhead<1})),rt((t=>t[0])),bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$,((t,e,i)=>[t,e,i]))).subscribe((t=>{let e=t[0],i=t[1],n=t[2],r=this._container.container,[s,o]=this._viewportCoords.canvasPosition(e,r),a=this._viewportCoords.unprojectFromCanvas(s,o,r,i.perspective),c=n.projectBasic(a.toArray()),h=e.deltaY;1===e.deltaMode?h*=40:2===e.deltaMode&&(h*=800);let l=-3*h/this._viewportCoords.containerToCanvas(r)[1];this._navigator.stateService.zoomIn(l,c)}))}_disable(){this._container.mouseService.unclaimWheel(this._component.name),this._preventDefaultSubscription.unsubscribe(),this._zoomSubscription.unsubscribe(),this._preventDefaultSubscription=null,this._zoomSubscription=null}_getConfiguration(t){return{scrollZoom:t}}}class qm extends Tm{constructor(t,e,i,n){super(t,e,i),this._viewportCoords=n}_enable(){this._preventDefaultSubscription=this._container.touchService.pinch$.subscribe((t=>{t.originalEvent.preventDefault()}));let t=this._container.touchService.pinchStart$.pipe(rt((t=>!0))),e=this._container.touchService.pinchEnd$.pipe(rt((t=>!1)));this._activeSubscription=Ot(t,e).subscribe(this._container.touchService.activate$),this._zoomSubscription=this._container.touchService.pinch$.pipe(bi(this._navigator.stateService.currentState$),Nt((t=>{let e=t[1].state;return dd(e.currentImage.cameraType)||e.imagesAhead<1})),rt((t=>t[0])),bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$)).subscribe((([t,e,i])=>{let n=this._container.container,[r,s]=this._viewportCoords.canvasPosition(t,n),o=this._viewportCoords.unprojectFromCanvas(r,s,n,e.perspective),a=i.projectBasic(o.toArray());const[c,h]=this._viewportCoords.containerToCanvas(n);let l=3*t.distanceChange/Math.min(c,h);this._navigator.stateService.zoomIn(l,a)}))}_disable(){this._activeSubscription.unsubscribe(),this._preventDefaultSubscription.unsubscribe(),this._zoomSubscription.unsubscribe(),this._preventDefaultSubscription=null,this._zoomSubscription=null}_getConfiguration(t){return{touchZoom:t}}}class Wm extends Vf{constructor(t,e,i){super(t,e,i);const n=new ld,r=new Wf;this._bounceHandler=new jm(this,e,i,r,n),this._dragPanHandler=new Um(this,e,i,r,n),this._earthControlHandler=new Vm(this,e,i,r,n),this._scrollZoomHandler=new Gm(this,e,i,r),this._touchZoomHandler=new qm(this,e,i,r)}get dragPan(){return this._dragPanHandler}get earthControl(){return this._earthControlHandler}get scrollZoom(){return this._scrollZoomHandler}get touchZoom(){return this._touchZoomHandler}_activate(){this._bounceHandler.enable(),this._subscriptions.push(this._configuration$.subscribe((t=>{t.dragPan?this._dragPanHandler.enable():this._dragPanHandler.disable(),t.earthControl?this._earthControlHandler.enable():this._earthControlHandler.disable(),t.scrollZoom?this._scrollZoomHandler.enable():this._scrollZoomHandler.disable(),t.touchZoom?this._touchZoomHandler.enable():this._touchZoomHandler.disable()}))),this._container.mouseService.claimMouse(this._name,0)}_deactivate(){this._container.mouseService.unclaimMouse(this._name),this._subscriptions.unsubscribe(),this._bounceHandler.disable(),this._dragPanHandler.disable(),this._earthControlHandler.disable(),this._scrollZoomHandler.disable(),this._touchZoomHandler.disable()}_getDefaultConfiguration(){return{dragPan:!0,earthControl:!0,scrollZoom:!0,touchZoom:!0}}}Wm.componentName="pointer";class Xm{constructor(t){this._document=t||document}get document(){return this._document}createElement(t,e,i){const n=this._document.createElement(t);return e&&(n.className=e),i&&i.appendChild(n),n}}class Ym extends Vf{constructor(t,e,i,n){super(t,e,i),this._dom=n||new Xm,this._popups=[],this._added$=new T,this._popups$=new T}add(t){for(const e of t)-1===this._popups.indexOf(e)&&(this._popups.push(e),this._activated&&e.setParentContainer(this._popupContainer));this._added$.next(t),this._popups$.next(this._popups)}getAll(){return this._popups.slice()}remove(t){for(const e of t)this._remove(e);this._popups$.next(this._popups)}removeAll(){for(const t of this._popups.slice())this._remove(t);this._popups$.next(this._popups)}_activate(){this._popupContainer=this._dom.createElement("div","mapillary-popup-container",this._container.container);for(const t of this._popups)t.setParentContainer(this._popupContainer);const t=this._subscriptions;t.push(gt(this._container.renderService.renderCamera$,this._container.renderService.size$,this._navigator.stateService.currentTransform$).subscribe((([t,e,i])=>{for(const n of this._popups)n.update(t,e,i)})));const e=this._popups$.pipe(ni(this._popups),ri((t=>bt(t).pipe(Mt((t=>t.changed$))))),rt((t=>[t])));t.push(Ot(this._added$,e).pipe(bi(this._container.renderService.renderCamera$,this._container.renderService.size$,this._navigator.stateService.currentTransform$)).subscribe((([t,e,i,n])=>{for(const r of t)r.update(e,i,n)})))}_deactivate(){this._subscriptions.unsubscribe();for(const t of this._popups)t.remove();this._container.container.removeChild(this._popupContainer),delete this._popupContainer}_getDefaultConfiguration(){return{}}_remove(t){const e=this._popups.indexOf(t);if(-1===e)return;const i=this._popups.splice(e,1)[0];this._activated&&i.remove()}}Ym.componentName="popup",function(t){t[t.Sequence=0]="Sequence",t[t.Spatial=1]="Spatial"}(ym||(ym={})),function(t){t[t.Default=0]="Default",t[t.Playback=1]="Playback",t[t.Timeline=2]="Timeline"}(bm||(bm={}));class Zm{constructor(t){this._container=t,this._minThresholdWidth=320,this._maxThresholdWidth=1480,this._minThresholdHeight=240,this._maxThresholdHeight=820,this._stepperDefaultWidth=108,this._controlsDefaultWidth=88,this._defaultHeight=30,this._expandControls=!1,this._mode=bm.Default,this._speed=.5,this._changingSpeed=!1,this._index=null,this._changingPosition=!1,this._mouseEnterDirection$=new T,this._mouseLeaveDirection$=new T,this._notifyChanged$=new T,this._notifyChangingPositionChanged$=new T,this._notifySpeedChanged$=new T,this._notifyIndexChanged$=new T}get changed$(){return this._notifyChanged$}get changingPositionChanged$(){return this._notifyChangingPositionChanged$}get speed$(){return this._notifySpeedChanged$}get index$(){return this._notifyIndexChanged$}get mouseEnterDirection$(){return this._mouseEnterDirection$}get mouseLeaveDirection$(){return this._mouseLeaveDirection$}activate(){this._changingSubscription||(this._changingSubscription=Ot(this._container.mouseService.documentMouseUp$,this._container.touchService.touchEnd$.pipe(Nt((t=>0===t.touches.length)))).subscribe((()=>{this._changingSpeed&&(this._changingSpeed=!1),this._changingPosition&&this._setChangingPosition(!1)})))}deactivate(){this._changingSubscription&&(this._changingSpeed=!1,this._changingPosition=!1,this._expandControls=!1,this._mode=bm.Default,this._changingSubscription.unsubscribe(),this._changingSubscription=null)}render(t,e,i,n,r,s,o,a,c){if(!1===e.visible)return jf.h("div.mapillary-sequence-container",{},[]);const h=this._createStepper(t,e,o,i,a,c),l=this._createSequenceControls(i),u=this._createPlaybackControls(i,n,a,e),d=this._createTimelineControls(i,r,s);return jf.h("div.mapillary-sequence-container",[h,l,u,d])}getContainerWidth(t,e){let i=e.minWidth,n=e.maxWidth;n<i&&(n=i);let r=(t.width-this._minThresholdWidth)/(this._maxThresholdWidth-this._minThresholdWidth),s=(t.height-this._minThresholdHeight)/(this._maxThresholdHeight-this._minThresholdHeight);return i+Math.max(0,Math.min(1,Math.min(r,s)))*(n-i)}_createPositionInput(t,e){this._index=t;const i=t=>{this._index=Number(t.target.value),this._notifyIndexChanged$.next(this._index)},n=this._container.domContainer.getBoundingClientRect(),r=t=>{t.stopPropagation(),this._setChangingPosition(!0)},s=t=>{!0===this._changingPosition&&t.stopPropagation()},o={max:null!=e?e:1,min:0,onchange:i,oninput:i,onkeydown:t=>{"ArrowDown"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"ArrowUp"!==t.key||t.preventDefault()},onpointerdown:r,onpointermove:s,ontouchmove:s,ontouchstart:r,style:{width:`${Math.max(276,Math.min(410,5+.8*n.width))-65}px`},type:"range",value:null!=t?t:0},a=null==t||null==e||e<=1;a&&(o.disabled="true");const c=jf.h("input.mapillary-sequence-position",o,[]),h=a?".mapillary-sequence-position-container-inactive":".mapillary-sequence-position-container";return jf.h("div"+h,[c])}_createSpeedInput(t){this._speed=t;const e=t=>{this._speed=Number(t.target.value)/1e3,this._notifySpeedChanged$.next(this._speed)},i=this._container.domContainer.getBoundingClientRect(),n=Math.max(276,Math.min(410,5+.8*i.width))-160,r=t=>{this._changingSpeed=!0,t.stopPropagation()},s=t=>{!0===this._changingSpeed&&t.stopPropagation()},o=jf.h("input.mapillary-sequence-speed",{max:1e3,min:0,onchange:e,oninput:e,onkeydown:t=>{"ArrowDown"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"ArrowUp"!==t.key||t.preventDefault()},onpointerdown:r,onpointermove:s,ontouchmove:s,ontouchstart:r,style:{width:`${n}px`},type:"range",value:1e3*t},[]);return jf.h("div.mapillary-sequence-speed-container",[o])}_createPlaybackControls(e,i,n,r){if(this._mode!==bm.Playback)return jf.h("div.mapillary-sequence-playback",[]);const s=jf.h("div.mapillary-sequence-switch-icon.mapillary-sequence-icon-visible",[]),o=r.direction===t.NavigationDirection.Next?t.NavigationDirection.Prev:t.NavigationDirection.Next,a=r.playing,c={onclick:()=>{a||n.configure({direction:o})}},h=r.playing?".mapillary-sequence-switch-button-inactive":".mapillary-sequence-switch-button",l=jf.h("div"+h,c,[s]),u=jf.h("div.mapillary-sequence-slow-icon.mapillary-sequence-icon-visible",[]),d=jf.h("div.mapillary-sequence-slow-container",[u]),p=jf.h("div.mapillary-sequence-fast-icon.mapillary-sequence-icon-visible",[]),f=jf.h("div.mapillary-sequence-fast-container",[p]),m=jf.h("div.mapillary-sequence-close-icon.mapillary-sequence-icon-visible",[]),g={onclick:()=>{this._mode=bm.Default,this._notifyChanged$.next(this)}},_=jf.h("div.mapillary-sequence-close-button",g,[m]),v=[l,d,this._createSpeedInput(i),f,_],y={style:{top:`${Math.round(e/this._stepperDefaultWidth*this._defaultHeight+10)}px`}};return jf.h("div.mapillary-sequence-playback",y,v)}_createPlayingButton(e,i,n,r,s){let o=r.direction===t.NavigationDirection.Next&&null!=e||r.direction===t.NavigationDirection.Prev&&null!=i;o=o&&n;let a={onclick:r.playing?()=>{s.stop()}:o?()=>{s.play()}:null},c={};r.direction===t.NavigationDirection.Prev&&(c.style={transform:"rotate(180deg) translate(50%, 50%)"});let h=jf.h("div.mapillary-sequence-icon",c,[]),l=r.playing?"mapillary-sequence-stop":o?"mapillary-sequence-play":"mapillary-sequence-play-inactive";return jf.h("div."+l,a,[h])}_createSequenceControls(t){const e=Math.round(8/this._stepperDefaultWidth*t),i={onclick:()=>{this._expandControls=!this._expandControls,this._mode=bm.Default,this._notifyChanged$.next(this)},style:{"border-bottom-right-radius":`${e}px`,"border-top-right-radius":`${e}px`}},n=jf.h("div.mapillary-sequence-expander-bar",[]),r=jf.h("div.mapillary-sequence-expander-button",i,[n]),s=this._mode===bm.Playback?".mapillary-sequence-fast-icon-gray.mapillary-sequence-icon-visible":".mapillary-sequence-fast-icon",o=jf.h("div"+s,[]),a={onclick:()=>{this._mode=this._mode===bm.Playback?bm.Default:bm.Playback,this._notifyChanged$.next(this)}},c=jf.h("div.mapillary-sequence-playback-button",a,[o]),h=this._mode===bm.Timeline?".mapillary-sequence-timeline-icon-gray.mapillary-sequence-icon-visible":".mapillary-sequence-timeline-icon",l=jf.h("div"+h,[]),u={onclick:()=>{this._mode=this._mode===bm.Timeline?bm.Default:bm.Timeline,this._notifyChanged$.next(this)}},d=jf.h("div.mapillary-sequence-timeline-button",u,[l]),p={style:{height:this._defaultHeight/this._stepperDefaultWidth*t+"px",transform:`translate(${t/2+2}px, 0)`,width:this._controlsDefaultWidth/this._stepperDefaultWidth*t+"px"}},f=".mapillary-sequence-controls"+(this._expandControls?".mapillary-sequence-controls-expanded":"");return jf.h("div"+f,p,[c,d,r])}_createSequenceArrows(e,i,n,r,s){let o={onclick:null!=e?()=>{s.moveDir$(t.NavigationDirection.Next).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))}:null,onpointerenter:()=>{this._mouseEnterDirection$.next(t.NavigationDirection.Next)},onpointerleave:()=>{this._mouseLeaveDirection$.next(t.NavigationDirection.Next)}};const a=Math.round(8/this._stepperDefaultWidth*n);let c={onclick:null!=i?()=>{s.moveDir$(t.NavigationDirection.Prev).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))}:null,onpointerenter:()=>{this._mouseEnterDirection$.next(t.NavigationDirection.Prev)},onpointerleave:()=>{this._mouseLeaveDirection$.next(t.NavigationDirection.Prev)},style:{"border-bottom-left-radius":`${a}px`,"border-top-left-radius":`${a}px`}},h=this._getStepClassName(t.NavigationDirection.Next,e,r.highlightId),l=this._getStepClassName(t.NavigationDirection.Prev,i,r.highlightId),u=jf.h("div.mapillary-sequence-icon",[]),d=jf.h("div.mapillary-sequence-icon",[]);return[jf.h("div."+l,c,[d]),jf.h("div."+h,o,[u])]}_createStepper(e,i,n,r,s,o){let a=null,c=null;for(let i of e.edges)i.data.direction===t.NavigationDirection.Next&&(a=i.target),i.data.direction===t.NavigationDirection.Prev&&(c=i.target);const h=this._createPlayingButton(a,c,n,i,s),l=this._createSequenceArrows(a,c,r,i,o);l.splice(1,0,h);const u={oncontextmenu:t=>{t.preventDefault()},style:{height:this._defaultHeight/this._stepperDefaultWidth*r+"px",width:r+"px"}};return jf.h("div.mapillary-sequence-stepper",u,l)}_createTimelineControls(t,e,i){if(this._mode!==bm.Timeline)return jf.h("div.mapillary-sequence-timeline",[]);const n=this._createPositionInput(e,i),r=jf.h("div.mapillary-sequence-close-icon.mapillary-sequence-icon-visible",[]),s={onclick:()=>{this._mode=bm.Default,this._notifyChanged$.next(this)}},o=jf.h("div.mapillary-sequence-close-button",s,[r]),a={style:{top:`${Math.round(t/this._stepperDefaultWidth*this._defaultHeight+10)}px`}};return jf.h("div.mapillary-sequence-timeline",a,[n,o])}_getStepClassName(e,i,n){let r=e===t.NavigationDirection.Next?"mapillary-sequence-step-next":"mapillary-sequence-step-prev";return null==i?r+="-inactive":n===i&&(r+="-highlight"),r}_setChangingPosition(t){this._changingPosition=t,this._notifyChangingPositionChanged$.next(t)}}class Jm extends Vf{constructor(t,e,i,n,r){super(t,e,i),this._sequenceDOMRenderer=n||new Zm(e),this._scheduler=r,this._containerWidth$=new T,this._hoveredIdSubject$=new T,this._hoveredId$=this._hoveredIdSubject$.pipe(Ze()),this._navigator.playService.playing$.pipe(Je(1),bi(this._configuration$)).subscribe((([t,e])=>{const i="playing",n={playing:t,target:this,type:i};this.fire(i,n),t!==e.playing&&(t?this.play():this.stop())})),this._navigator.playService.direction$.pipe(Je(1),bi(this._configuration$)).subscribe((([t,e])=>{t!==e.direction&&this.configure({direction:t})}))}fire(t,e){super.fire(t,e)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}play(){this.configure({playing:!0})}stop(){this.configure({playing:!1})}_activate(){this._sequenceDOMRenderer.activate();const t=this._navigator.stateService.currentImage$.pipe(ri((t=>t.sequenceEdges$)),Ue(1),E()),e=this._navigator.stateService.currentImage$.pipe(ue(void 0,(t=>t.sequenceId)),ri((t=>At(G(null),this._navigator.graphService.cacheSequence$(t.sequenceId).pipe(Ve(3),te((t=>(console.error("Failed to cache sequence",t),G(null)))))))),ni(null),Ue(1),E()),i=this._subscriptions;i.push(e.subscribe());const n=this._sequenceDOMRenderer.index$.pipe(bi(e),rt((([t,e])=>null!=e?e.imageIds[t]:null)),Nt((t=>!!t)),ue(),He(),E());i.push(Ot(n.pipe(re(100,this._scheduler)),n.pipe(Wt(400,this._scheduler))).pipe(ue(),ri((t=>this._navigator.moveTo$(t).pipe(te((()=>B())))))).subscribe()),i.push(this._sequenceDOMRenderer.changingPositionChanged$.pipe(Nt((t=>t))).subscribe((()=>{this._navigator.graphService.setGraphMode(ym.Sequence)}))),i.push(this._sequenceDOMRenderer.changingPositionChanged$.pipe(Nt((t=>!t))).subscribe((()=>{this._navigator.graphService.setGraphMode(ym.Spatial)}))),this._navigator.graphService.graphMode$.pipe(ri((t=>t===ym.Spatial?this._navigator.stateService.currentImage$.pipe(ve(2)):B())),Nt((t=>!t.spatialEdges.cached)),ri((t=>this._navigator.graphService.cacheImage$(t.id).pipe(te((()=>B())))))).subscribe(),i.push(this._sequenceDOMRenderer.changingPositionChanged$.pipe(Nt((t=>t))).subscribe((()=>{this._navigator.playService.stop()}))),i.push(gt(this._navigator.graphService.graphMode$,this._sequenceDOMRenderer.changingPositionChanged$.pipe(ni(!1),ue())).pipe(bi(this._navigator.stateService.currentImage$),ri((([[t,e],i])=>e&&t===ym.Sequence?this._navigator.graphService.cacheSequenceImages$(i.sequenceId,i.id).pipe(Ve(3),te((t=>(console.error("Failed to cache sequence images.",t),B())))):B()))).subscribe());const r=e.pipe(ri((t=>{if(!t)return G({index:null,max:null});let e=!0;return this._sequenceDOMRenderer.changingPositionChanged$.pipe(ni(!1),ue(),ri((t=>{const i=!t&&e?0:1;return e=!1,t?n:this._navigator.stateService.currentImage$.pipe(rt((t=>t.id)),ue(),Je(i))})),rt((e=>{const i=t.imageIds.indexOf(e);return-1===i?{index:null,max:null}:{index:i,max:t.imageIds.length-1}})))}))),s=this._navigator.stateService.state$.pipe(rt((t=>t===vm.Earth)),ue());i.push(gt(t,this._configuration$,this._containerWidth$,this._sequenceDOMRenderer.changed$.pipe(ni(this._sequenceDOMRenderer)),this._navigator.playService.speed$,r,s).pipe(rt((([t,e,i,,n,r,s])=>{const o=this._sequenceDOMRenderer.render(t,e,i,n,r.index,r.max,!s,this,this._navigator);return{name:this._name,vNode:o}}))).subscribe(this._container.domRenderer.render$)),i.push(this._sequenceDOMRenderer.speed$.subscribe((t=>{this._navigator.playService.setSpeed(t)}))),i.push(this._configuration$.pipe(rt((t=>t.direction)),ue()).subscribe((t=>{this._navigator.playService.setDirection(t)}))),i.push(gt(this._container.renderService.size$,this._configuration$.pipe(ue(((t,e)=>t[0]===e[0]&&t[1]===e[1]),(t=>[t.minWidth,t.maxWidth])))).pipe(rt((([t,e])=>this._sequenceDOMRenderer.getContainerWidth(t,e)))).subscribe(this._containerWidth$)),i.push(this._configuration$.pipe(rt((t=>t.playing)),ue()).subscribe((t=>{t?this._navigator.playService.play():this._navigator.playService.stop()}))),i.push(this._sequenceDOMRenderer.mouseEnterDirection$.pipe(ri((e=>At(t.pipe(rt((t=>{for(let i of t.edges)if(i.data.direction===e)return i.target;return null})),ai(this._sequenceDOMRenderer.mouseLeaveDirection$)),G(null)))),ue()).subscribe(this._hoveredIdSubject$)),i.push(this._hoveredId$.subscribe((t=>{const e="hover",i={id:t,target:this,type:e};this.fire(e,i)})))}_deactivate(){this._subscriptions.unsubscribe(),this._sequenceDOMRenderer.deactivate()}_getDefaultConfiguration(){return{direction:t.NavigationDirection.Next,maxWidth:108,minWidth:70,playing:!1,visible:!0}}}Jm.componentName="sequence",t.SliderConfigurationMode=void 0,(xm=t.SliderConfigurationMode||(t.SliderConfigurationMode={}))[xm.Motion=0]="Motion",xm[xm.Stationary=1]="Stationary";class Km{constructor(){this._factory=new em,this._scene=new im,this._spatial=new ld,this._currentKey=null,this._previousKey=null,this._disabled=!1,this._curtain=1,this._frameId=0,this._needsRender=!1,this._mode=null,this._currentProviderDisposers={},this._previousProviderDisposers={}}get disabled(){return this._disabled}get frameId(){return this._frameId}get needsRender(){return this._needsRender}setTextureProvider(t,e){this._setTextureProvider(t,this._currentKey,e,this._currentProviderDisposers,this._updateTexture.bind(this))}setTextureProviderPrev(t,e){this._setTextureProvider(t,this._previousKey,e,this._previousProviderDisposers,this._updateTexturePrev.bind(this))}update(t,e){this._updateFrameId(t.id),this._updateImagePlanes(t.state,e)}updateCurtain(t){this._curtain!==t&&(this._curtain=t,this._updateCurtain(),this._needsRender=!0)}updateTexture(t,e){const i=e.id===this._currentKey?this._scene.planes:e.id===this._previousKey?this._scene.planesOld:{};if(0!==Object.keys(i).length){this._needsRender=!0;for(const e in i){if(!i.hasOwnProperty(e))continue;let n=i[e].material.uniforms.projectorTex.value;n.image=t,n.needsUpdate=!0}}}updateTextureImage(t,e){if(this._currentKey!==e.id)return;this._needsRender=!0;const i=this._scene.planes;for(const e in i){if(!i.hasOwnProperty(e))continue;let n=i[e].material.uniforms.projectorTex.value;n.image=t,n.needsUpdate=!0}}render(t,e){this.disabled||e.render(this._scene.sceneOld,t),e.render(this._scene.scene,t),this._needsRender=!1}dispose(){this._scene.clear();for(const t in this._currentProviderDisposers)this._currentProviderDisposers.hasOwnProperty(t)&&this._currentProviderDisposers[t]();for(const t in this._previousProviderDisposers)this._previousProviderDisposers.hasOwnProperty(t)&&this._previousProviderDisposers[t]();this._currentProviderDisposers={},this._previousProviderDisposers={}}_getBasicCorners(t,e){let i,n;return t>e?(i=.5,n=.5*t/e):(i=.5*e/t,n=.5),[[.5-i,.5-n],[.5+i,.5+n]]}_setDisabled(t){this._disabled=null==t.currentImage||null==t.previousImage||dd(t.currentImage.cameraType)&&!dd(t.previousImage.cameraType)}_setTextureProvider(t,e,i,n,r){if(t!==e)return;let s=i.textureCreated$.subscribe(r),o=i.textureUpdated$.subscribe((t=>{this._needsRender=!0}));if(t in n){(0,n[t])(),delete n[t]}n[t]=()=>{s.unsubscribe(),o.unsubscribe(),i.dispose()}}_updateCurtain(){const t=this._scene.planes;for(const e in t){if(!t.hasOwnProperty(e))continue;let i=t[e].material;i.uniforms.curtain&&(i.uniforms.curtain.value=this._curtain)}}_updateFrameId(t){this._frameId=t}_updateImagePlanes(e,i){const n=null!=e.currentImage&&this._currentKey!==e.currentImage.id,r=null!=e.previousImage&&this._previousKey!==e.previousImage.id,s=this._mode!==i;if(!(n||r||s))return;this._setDisabled(e),this._needsRender=!0,this._mode=i;const o=e.motionless||i===t.SliderConfigurationMode.Stationary||dd(e.currentImage.cameraType);if((this.disabled||r)&&this._previousKey in this._previousProviderDisposers&&(this._previousProviderDisposers[this._previousKey](),delete this._previousProviderDisposers[this._previousKey]),this.disabled)this._scene.setImagePlanesOld({});else if(r||s){const t=e.previousImage;this._previousKey=t.id;const i=e.currentTransform.rt.elements;let n=[i[12],i[13],i[14]];const r=e.currentTransform.basicAspect,s=e.previousTransform.basicAspect,a=r>s?[1,s/r]:[r/s,1];let c=e.currentImage.rotation,h=e.currentImage.width,l=e.currentImage.height;dd(t.cameraType)&&(c=e.previousImage.rotation,n=this._spatial.rotate(this._spatial.opticalCenter(e.currentImage.rotation,n).toArray(),c).multiplyScalar(-1).toArray(),h=e.previousImage.width,l=e.previousImage.height);const u=new Hd(e.currentImage.exifOrientation,h,l,e.currentImage.scale,c,n,t.image,a,e.currentImage.cameraParameters,e.currentImage.cameraType);let d;if(dd(t.cameraType))d=this._factory.createMesh(t,o||dd(e.currentImage.cameraType)?u:e.previousTransform);else if(o){const[[t,i],[n,o]]=this._getBasicCorners(r,s);d=this._factory.createFlatMesh(e.previousImage,u,t,n,i,o)}else d=this._factory.createMesh(e.previousImage,e.previousTransform);const p={};p[t.id]=d,this._scene.setImagePlanesOld(p)}if(n||s){this._currentKey in this._currentProviderDisposers&&(this._currentProviderDisposers[this._currentKey](),delete this._currentProviderDisposers[this._currentKey]),this._currentKey=e.currentImage.id;const t={};dd(e.currentImage.cameraType)?t[e.currentImage.id]=this._factory.createCurtainMesh(e.currentImage,e.currentTransform):t[e.currentImage.id]=o?this._factory.createDistortedCurtainMesh(e.currentImage,e.currentTransform):this._factory.createCurtainMesh(e.currentImage,e.currentTransform),this._scene.setImagePlanes(t),this._updateCurtain()}}_updateTexture(t){this._needsRender=!0;const e=this._scene.planes;for(const i in e){if(!e.hasOwnProperty(i))continue;let n=e[i].material,r=n.uniforms.projectorTex.value;n.uniforms.projectorTex.value=null,r.dispose(),n.uniforms.projectorTex.value=t}}_updateTexturePrev(t){this._needsRender=!0;const e=this._scene.planesOld;for(const i in e){if(!e.hasOwnProperty(i))continue;let n=e[i].material,r=n.uniforms.projectorTex.value;n.uniforms.projectorTex.value=null,r.dispose(),n.uniforms.projectorTex.value=t}}}class Qm{constructor(t){this._container=t,this._interacting=!1,this._notifyModeChanged$=new T,this._notifyPositionChanged$=new T,this._stopInteractionSubscription=null}get mode$(){return this._notifyModeChanged$}get position$(){return this._notifyPositionChanged$}activate(){this._stopInteractionSubscription||(this._stopInteractionSubscription=Ot(this._container.mouseService.documentMouseUp$,this._container.touchService.touchEnd$.pipe(Nt((t=>0===t.touches.length)))).subscribe((t=>{this._interacting&&(this._interacting=!1)})))}deactivate(){this._stopInteractionSubscription&&(this._interacting=!1,this._stopInteractionSubscription.unsubscribe(),this._stopInteractionSubscription=null)}render(t,e,i,n,r){const s=[];if(r){s.push(jf.h("div.mapillary-slider-border",[]));const r=!(i||n);r&&(s.push(this._createModeButton(e)),s.push(this._createModeButton2d(e))),s.push(this._createPositionInput(t,r))}const o=this._container.domContainer.getBoundingClientRect(),a=Math.max(215,Math.min(400,o.width-100));return jf.h("div.mapillary-slider-container",{style:{width:`${a}px`}},s)}_createModeButton(e){const i={onclick:()=>{e!==t.SliderConfigurationMode.Motion&&this._notifyModeChanged$.next(t.SliderConfigurationMode.Motion)}},n=e===t.SliderConfigurationMode.Stationary?"mapillary-slider-mode-button-inactive":"mapillary-slider-mode-button";return jf.h("div."+n,i,[jf.h("div.mapillary-slider-mode-icon",[])])}_createModeButton2d(e){const i={onclick:()=>{e!==t.SliderConfigurationMode.Stationary&&this._notifyModeChanged$.next(t.SliderConfigurationMode.Stationary)}},n=e===t.SliderConfigurationMode.Motion?"mapillary-slider-mode-button-2d-inactive":"mapillary-slider-mode-button-2d";return jf.h("div."+n,i,[jf.h("div.mapillary-slider-mode-icon-2d",[])])}_createPositionInput(t,e){const i=t=>{this._notifyPositionChanged$.next(Number(t.target.value)/1e3)},n=t=>{this._interacting=!0,t.stopPropagation()},r=t=>{this._interacting&&t.stopPropagation()},s=this._container.domContainer.getBoundingClientRect(),o=Math.max(215,Math.min(400,s.width-105))-84+(e?0:52),a=jf.h("input.mapillary-slider-position",{max:1e3,min:0,onchange:i,oninput:i,onkeydown:t=>{"ArrowDown"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key&&"ArrowUp"!==t.key||t.preventDefault()},onpointerdown:n,onpointermove:r,ontouchmove:r,ontouchstart:n,style:{width:`${o}px`},type:"range",value:1e3*t},[]);return jf.h("div.mapillary-slider-position-container",[a])}}class tg extends Vf{constructor(t,e,i,n){super(t,e,i),this._viewportCoords=n||new Wf,this._domRenderer=new Qm(e),this._imageTileLoader=new sm(i.api),this._roiCalculator=new am,this._spatial=new ld,this._glRendererOperation$=new T,this._glRendererCreator$=new T,this._glRendererDisposer$=new T,this._glRenderer$=this._glRendererOperation$.pipe(Le(((t,e)=>e(t)),null),Nt((t=>null!=t)),ue(void 0,(t=>t.frameId))),this._glRendererCreator$.pipe(rt((()=>t=>{if(null!=t)throw new Error("Multiple slider states can not be created at the same time");return new Km}))).subscribe(this._glRendererOperation$),this._glRendererDisposer$.pipe(rt((()=>t=>(t.dispose(),null)))).subscribe(this._glRendererOperation$)}_activate(){const e=this._subscriptions;e.push(this._domRenderer.mode$.subscribe((t=>{this.configure({mode:t})}))),e.push(this._glRenderer$.pipe(rt((t=>({name:this._name,renderer:{frameId:t.frameId,needsRender:t.needsRender,render:t.render.bind(t),pass:rm.Background}})))).subscribe(this._container.glRenderer.render$));const i=At(this.configuration$.pipe(rt((t=>null!=t.initialPosition?t.initialPosition:1)),Ee()),this._domRenderer.position$),n=this.configuration$.pipe(rt((t=>t.mode)),ue()),r=this._navigator.stateService.currentState$.pipe(rt((t=>t.state.motionless)),ue()),s=this._navigator.stateService.currentState$.pipe(rt((t=>dd(t.state.currentImage.cameraType))),ue()),o=gt(this._configuration$.pipe(rt((t=>t.sliderVisible))),this._navigator.stateService.currentState$.pipe(rt((t=>!(null==t.state.currentImage||null==t.state.previousImage||dd(t.state.currentImage.cameraType)&&!dd(t.state.previousImage.cameraType)))),ue())).pipe(rt((([t,e])=>t&&e)),ue());this._waitSubscription=gt(n,r,s,o).pipe(bi(this._navigator.stateService.state$)).subscribe((([[e,i,n,r],s])=>{const o=r&&(i||e===t.SliderConfigurationMode.Stationary||n);o&&s!==vm.WaitingInteractively?this._navigator.stateService.waitInteractively():o||s===vm.Waiting||this._navigator.stateService.wait()})),e.push(gt(i,n,r,s,o).subscribe((([e,i,n,r])=>{n||i===t.SliderConfigurationMode.Stationary||r?this._navigator.stateService.moveTo(1):this._navigator.stateService.moveTo(e)}))),e.push(gt(i,n,r,s,o,this._container.renderService.size$).pipe(rt((([t,e,i,n,r])=>({name:this._name,vNode:this._domRenderer.render(t,e,i,n,r)})))).subscribe(this._container.domRenderer.render$)),this._glRendererCreator$.next(null),e.push(gt(i,s,o,this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$).pipe(rt((([t,e,i,n,r])=>{if(!e)return i?t:1;const s=this._viewportCoords.viewportToBasic(-1.15,0,r,n.perspective),o=this._viewportCoords.viewportToBasic(1.15,0,r,n.perspective),a=o[0]<s[0]?o[0]+1:o[0],c=s[0]+t*(a-s[0]);return c>1?c-1:c})),rt((t=>e=>(e.updateCurtain(t),e)))).subscribe(this._glRendererOperation$)),e.push(gt(this._navigator.stateService.currentState$,n).pipe(rt((([t,e])=>i=>(i.update(t,e),i)))).subscribe(this._glRendererOperation$)),e.push(this._configuration$.pipe(Nt((t=>null!=t.ids)),ri((t=>Ft(Ft(this._catchCacheImage$(t.ids.background),this._catchCacheImage$(t.ids.foreground)).pipe(rt((t=>({background:t[0],foreground:t[1]})))),this._navigator.stateService.currentState$.pipe(Ee())).pipe(rt((t=>({images:t[0],state:t[1].state}))))))).subscribe((t=>{null!=t.state.currentImage&&null!=t.state.previousImage&&t.state.currentImage.id===t.images.foreground.id&&t.state.previousImage.id===t.images.background.id||(t.state.currentImage.id!==t.images.background.id?t.state.currentImage.id!==t.images.foreground.id||1!==t.state.trajectory.length?(this._navigator.stateService.setImages([t.images.background]),this._navigator.stateService.setImages([t.images.foreground])):this._navigator.stateService.prependImages([t.images.background]):this._navigator.stateService.setImages([t.images.foreground]))}),(t=>{console.error(t)})));const a=this._container.configurationService.imageTiling$.pipe(ri((t=>t?this._navigator.stateService.currentState$:new T)),ue(void 0,(t=>t.state.currentImage.id)),bi(this._container.glRenderer.webGLRenderer$,this._container.renderService.size$),rt((([t,e,i])=>{const n=t.state;Math.max(i.width,i.height);const r=n.currentImage,s=n.currentTransform;return new _m(r.id,s.basicWidth,s.basicHeight,r.image,this._imageTileLoader,new om,e)})),Ue(1),E());e.push(a.subscribe((()=>{}))),e.push(a.pipe(rt((t=>e=>(e.setTextureProvider(t.id,t),e)))).subscribe(this._glRendererOperation$)),e.push(a.pipe(ze()).subscribe((t=>{t[0].abort()})));const c=this._container.configurationService.imageTiling$.pipe(ri((t=>t?gt(this._container.renderService.renderCameraFrame$,this._container.renderService.size$.pipe(re(250))):new T)),rt((([t,e])=>[t.camera.position.clone(),t.camera.lookat.clone(),t.zoom.valueOf(),e.height.valueOf(),e.width.valueOf()])),ze(),ti((t=>t[1][2]-t[0][2]<0||0===t[1][2])),rt((t=>{let e=t[0][0].equals(t[1][0]),i=t[0][1].equals(t[1][1]),n=t[0][2]===t[1][2],r=t[0][3]===t[1][3],s=t[0][4]===t[1][4];return e&&i&&n&&r&&s})),ue(),Nt((t=>t)),ri((()=>this._container.renderService.renderCameraFrame$.pipe(Ee()))),bi(this._container.renderService.size$,this._navigator.stateService.currentTransform$));e.push(a.pipe(ri((t=>c.pipe(rt((([e,i,n])=>[this._roiCalculator.computeRegionOfInterest(e,i,n),t]))))),Nt((t=>!t[1].disposed))).subscribe((t=>{let e=t[0];t[1].setRegionOfInterest(e)})));const h=a.pipe(ri((t=>t.hasTexture$)),ni(!1),Ue(1),E());e.push(h.subscribe((()=>{})));const l=this._container.configurationService.imageTiling$.pipe(ri((t=>t?this._navigator.stateService.currentState$:new T)),Nt((t=>!!t.state.previousImage)),ue(void 0,(t=>t.state.previousImage.id)),bi(this._container.glRenderer.webGLRenderer$,this._container.renderService.size$),rt((([t,e,i])=>{const n=t.state,r=n.previousImage,s=n.previousTransform;return new _m(r.id,s.basicWidth,s.basicHeight,r.image,this._imageTileLoader,new om,e)})),Ue(1),E());e.push(l.subscribe((()=>{}))),e.push(l.pipe(rt((t=>e=>(e.setTextureProviderPrev(t.id,t),e)))).subscribe(this._glRendererOperation$)),e.push(l.pipe(ze()).subscribe((t=>{t[0].abort()})));const u=this._container.configurationService.imageTiling$.pipe(ri((t=>t?gt(this._container.renderService.renderCameraFrame$,this._container.renderService.size$.pipe(re(250))):new T)),rt((([t,e])=>[t.camera.position.clone(),t.camera.lookat.clone(),t.zoom.valueOf(),e.height.valueOf(),e.width.valueOf()])),ze(),ti((t=>t[1][2]-t[0][2]<0||0===t[1][2])),rt((t=>{let e=t[0][0].equals(t[1][0]),i=t[0][1].equals(t[1][1]),n=t[0][2]===t[1][2],r=t[0][3]===t[1][3],s=t[0][4]===t[1][4];return e&&i&&n&&r&&s})),ue(),Nt((t=>t)),ri((()=>this._container.renderService.renderCameraFrame$.pipe(Ee()))),bi(this._container.renderService.size$,this._navigator.stateService.currentTransform$));e.push(l.pipe(ri((t=>u.pipe(rt((([e,i,n])=>[this._roiCalculator.computeRegionOfInterest(e,i,n),t]))))),Nt((t=>!t[1].disposed)),bi(this._navigator.stateService.currentState$)).subscribe((([[t,e],i])=>{let n=null;if(dd(i.state.previousImage.cameraType))if(dd(i.state.currentImage.cameraType)){const e=this._spatial.viewingDirection(i.state.currentImage.rotation),r=this._spatial.viewingDirection(i.state.previousImage.rotation),s=this._spatial.angleBetweenVector2(e.x,e.y,r.x,r.y)/(2*Math.PI);n={bbox:{maxX:this._spatial.wrap(t.bbox.maxX+s,0,1),maxY:t.bbox.maxY,minX:this._spatial.wrap(t.bbox.minX+s,0,1),minY:t.bbox.minY},pixelHeight:t.pixelHeight,pixelWidth:t.pixelWidth}}else{const e=this._spatial.viewingDirection(i.state.currentImage.rotation),r=this._spatial.viewingDirection(i.state.previousImage.rotation),s=this._spatial.angleBetweenVector2(e.x,e.y,r.x,r.y)/(2*Math.PI),o=this._spatial.angleToPlane(e.toArray(),[0,0,1]),a=(this._spatial.angleToPlane(r.toArray(),[0,0,1])-o)/(2*Math.PI),c=i.state.currentTransform,h=Math.max(c.basicWidth,c.basicHeight),l=h>0?2*Math.atan(.5*c.basicWidth/(h*c.focal)):Math.PI/3,u=h>0?2*Math.atan(.5*c.basicHeight/(h*c.focal)):Math.PI/3,d=l/(2*Math.PI),p=u/Math.PI,f=(t.bbox.maxX-t.bbox.minX)*d,m=(t.bbox.maxY-t.bbox.minY)*p,g=t.pixelWidth*d,_=t.pixelHeight*p,v=(t.bbox.minX+t.bbox.maxX)/2-.5,y=(t.bbox.minY+t.bbox.maxY)/2-.5,b=.5+s+d*v-f/2,x=.5+s+d*v+f/2,w=.5+a+p*y-m/2,S=.5+a+p*y+m/2;n={bbox:{maxX:this._spatial.wrap(x,0,1),maxY:S,minX:this._spatial.wrap(b,0,1),minY:w},pixelHeight:_,pixelWidth:g}}else{const e=i.state.currentTransform.basicAspect,r=i.state.previousTransform.basicAspect,[[s,o],[a,c]]=this._getBasicCorners(e,r),h=a-s,l=c-o,u=t.pixelWidth/h,d=t.pixelHeight/l,p=(h-1)/(2*h)+t.bbox.minX/h,f=(h-1)/(2*h)+t.bbox.maxX/h,m=(l-1)/(2*l)+t.bbox.minY/l,g={maxX:f,maxY:(l-1)/(2*l)+t.bbox.maxY/l,minX:p,minY:m};this._clipBoundingBox(g),n={bbox:g,pixelHeight:d,pixelWidth:u}}e.setRegionOfInterest(n)})));const d=l.pipe(ri((t=>t.hasTexture$)),ni(!1),Ue(1),E());e.push(d.subscribe((()=>{})))}_deactivate(){this._waitSubscription.unsubscribe(),this._navigator.stateService.state$.pipe(Ee()).subscribe((t=>{t!==vm.Traversing&&this._navigator.stateService.traverse()})),this._glRendererDisposer$.next(null),this._domRenderer.deactivate(),this._subscriptions.unsubscribe(),this.configure({ids:null})}_getDefaultConfiguration(){return{initialPosition:1,mode:t.SliderConfigurationMode.Motion,sliderVisible:!0}}_catchCacheImage$(t){return this._navigator.graphService.cacheImage$(t).pipe(te((e=>(console.error(`Failed to cache slider image (${t})`,e),B()))))}_getBasicCorners(t,e){let i,n;return t>e?(i=.5,n=.5*t/e):(i=.5*e/t,n=.5),[[.5-i,.5-n],[.5+i,.5+n]]}_clipBoundingBox(t){t.minX=Math.max(0,Math.min(1,t.minX)),t.maxX=Math.max(0,Math.min(1,t.maxX)),t.minY=Math.max(0,Math.min(1,t.minY)),t.maxY=Math.max(0,Math.min(1,t.maxY))}}tg.componentName="slider";class eg{constructor(e,i){this._subscriptions=new Uf,this._graphService=e,this._stateService=i;const n=this._subscriptions;this._directionSubject$=new T,this._direction$=this._directionSubject$.pipe(ni(t.NavigationDirection.Next),Ue(1),E()),n.push(this._direction$.subscribe()),this._playing=!1,this._playingSubject$=new T,this._playing$=this._playingSubject$.pipe(ni(this._playing),Ue(1),E()),n.push(this._playing$.subscribe()),this._speed=.5,this._speedSubject$=new T,this._speed$=this._speedSubject$.pipe(ni(this._speed),Ue(1),E()),n.push(this._speed$.subscribe()),this._imagesAhead=this._mapImagesAhead(this._mapSpeed(this._speed)),this._bridging$=null}get playing(){return this._playing}get direction$(){return this._direction$}get playing$(){return this._playing$}get speed$(){return this._speed$}play(){if(this._playing)return;this._stateService.cutImages();const e=this._setSpeed(this._speed);this._stateService.setSpeed(e),this._graphModeSubscription=this._speed$.pipe(rt((t=>t>eg.sequenceSpeed?ym.Sequence:ym.Spatial)),ue()).subscribe((t=>{this._graphService.setGraphMode(t)})),this._cacheSubscription=gt(this._stateService.currentImage$.pipe(rt((t=>[t.sequenceId,t.id])),ue(void 0,(([t])=>t))),this._graphService.graphMode$,this._direction$).pipe(ri((([[e,i],n,r])=>{if(r!==t.NavigationDirection.Next&&r!==t.NavigationDirection.Prev)return G([void 0,r]);return gt((n===ym.Sequence?this._graphService.cacheSequenceImages$(e,i):this._graphService.cacheSequence$(e)).pipe(Ve(3),te((t=>(console.error(t),G(void 0))))),G(r))})),ri((([e,i])=>{if(void 0===e)return B();const n=e.imageIds.slice();return i===t.NavigationDirection.Prev&&n.reverse(),this._stateService.currentState$.pipe(rt((t=>[t.state.trajectory[t.state.trajectory.length-1].id,t.state.imagesAhead])),Le((([t,e],[i,r])=>{void 0===t&&(t=i);const s=n.length-1;if(r>=this._imagesAhead||n[s]===t)return[t,[]];const o=n.indexOf(i),a=n.indexOf(t)+1,c=Math.min(s,o+this._imagesAhead-r)+1;return c<=a?[t,[]]:[n[c-1],n.slice(a,c)]}),[void 0,[]]),Mt((([t,e])=>bt(e))))})),Mt((t=>this._graphService.cacheImage$(t).pipe(te((()=>B())))),6)).subscribe(),this._playingSubscription=this._stateService.currentState$.pipe(Nt((t=>t.state.imagesAhead<this._imagesAhead)),ue(void 0,(t=>t.state.lastImage.id)),rt((t=>{const e=t.state.lastImage,i=t.state.trajectory;let n;for(let t=i.length-2;t>=0;t--){const r=i[t];if(r.sequenceId!==e.sequenceId)break;if(r.capturedAt!==e.capturedAt){n=r.capturedAt<e.capturedAt;break}}return[t.state.lastImage,n]})),bi(this._direction$),ri((([[e,i],n])=>Ft(([t.NavigationDirection.Next,t.NavigationDirection.Prev].indexOf(n)>-1?e.sequenceEdges$:e.spatialEdges$).pipe(Ee((t=>t.cached)),yi(15e3)),G(n)).pipe(rt((([t,e])=>{for(let i of t.edges)if(i.data.direction===e)return i.target;return null})),ri((t=>null!=t?this._graphService.cacheImage$(t):B())))))).subscribe((t=>{this._stateService.appendImagess([t])}),(t=>{console.error(t),this.stop()})),this._clearSubscription=this._stateService.currentImage$.pipe(Xt(1,10)).subscribe((t=>{this._stateService.clearPriorImages()})),this._setPlaying(!0);const i=this._stateService.currentState$.pipe(rt((t=>t.state)),ue((([t,e],[i,n])=>t===i&&e===n),(t=>[t.currentImage.id,t.lastImage.id])),Nt((t=>t.currentImage.id===t.lastImage.id&&t.currentIndex===t.trajectory.length-1)),rt((t=>t.currentImage)));this._stopSubscription=gt(i,this._direction$).pipe(ri((([e,i])=>{const n=([t.NavigationDirection.Next,t.NavigationDirection.Prev].indexOf(i)>-1?e.sequenceEdges$:e.spatialEdges$).pipe(Ee((t=>t.cached)),yi(15e3),te((t=>(console.error(t),G({cached:!1,edges:[]})))));return gt(G(i),n).pipe(rt((([t,e])=>{for(const i of e.edges)if(i.data.direction===t)return!0;return!1})))})),Mt((t=>t||!this._bridging$?G(t):this._bridging$.pipe(rt((t=>null!=t)),te((t=>(console.error(t),G(!1))))))),Ee((t=>!t))).subscribe(void 0,void 0,(()=>{this.stop()})),this._stopSubscription.closed&&(this._stopSubscription=null),this._earthSubscription=this._stateService.state$.pipe(rt((t=>t===vm.Earth)),ue(),Ee((t=>t))).subscribe(void 0,void 0,(()=>{this.stop()})),this._earthSubscription.closed&&(this._earthSubscription=null)}dispose(){this.stop(),this._subscriptions.unsubscribe()}setDirection(t){this._directionSubject$.next(t)}setSpeed(t){if((t=Math.max(0,Math.min(1,t)))===this._speed)return;const e=this._setSpeed(t);this._playing&&this._stateService.setSpeed(e),this._speedSubject$.next(this._speed)}stop(){this._playing&&(this._stopSubscription&&(this._stopSubscription.closed||this._stopSubscription.unsubscribe(),this._stopSubscription=null),this._earthSubscription&&(this._earthSubscription.closed||this._earthSubscription.unsubscribe(),this._earthSubscription=null),this._graphModeSubscription.unsubscribe(),this._graphModeSubscription=null,this._cacheSubscription.unsubscribe(),this._cacheSubscription=null,this._playingSubscription.unsubscribe(),this._playingSubscription=null,this._clearSubscription.unsubscribe(),this._clearSubscription=null,this._stateService.setSpeed(1),this._stateService.cutImages(),this._graphService.setGraphMode(ym.Spatial),this._setPlaying(!1))}_mapSpeed(t){const e=2*t-1;return Math.pow(10,e)-.2*e}_mapImagesAhead(t){return Math.round(Math.max(10,Math.min(50,8+6*t)))}_setPlaying(t){this._playing=t,this._playingSubject$.next(t)}_setSpeed(t){this._speed=t;const e=this._mapSpeed(this._speed);return this._imagesAhead=this._mapImagesAhead(e),e}}eg.sequenceSpeed=.54,t.CameraVisualizationMode=void 0,(wm=t.CameraVisualizationMode||(t.CameraVisualizationMode={}))[wm.Hidden=0]="Hidden",wm[wm.Homogeneous=1]="Homogeneous",wm[wm.Cluster=2]="Cluster",wm[wm.ConnectedComponent=3]="ConnectedComponent",wm[wm.Sequence=4]="Sequence",t.OriginalPositionMode=void 0,(Sm=t.OriginalPositionMode||(t.OriginalPositionMode={}))[Sm.Hidden=0]="Hidden",Sm[Sm.Altitude=1]="Altitude",Sm[Sm.Flat=2]="Flat";class ig extends Qc{constructor(t){super(),this._originalSize=t.originalSize;const e=t.cluster,i=t.scale,n=t.translation;this._makeAttributes(e),this.material.size=i*this._originalSize,this.material.vertexColors=!0,this.material.needsUpdate=!0,this.matrixAutoUpdate=!1,this.position.fromArray(n),this.updateMatrix(),this.updateMatrixWorld(!1)}dispose(){this.geometry.dispose(),this.material.dispose()}resize(t){this.material.size=t*this._originalSize,this.material.needsUpdate=!0}_makeAttributes(t){const e=[],i=[],n=t.points;for(const t in n){if(!n.hasOwnProperty(t))continue;const r=n[t];e.push(...r.coordinates);const s=r.color;i.push(s[0]),i.push(s[1]),i.push(s[2])}const r=this.geometry;r.setAttribute("position",new Hr(new Float32Array(e),3)),r.setAttribute("color",new Hr(new Float32Array(i),3))}}class ng extends Uc{constructor(t){super(),this._makeAttributes(t),this.matrixAutoUpdate=!1,this.updateMatrix(),this.updateMatrixWorld(!1)}dispose(){this.geometry.dispose(),this.material.dispose()}_makeAttributes(t){const e=t.slice();e.push(t[0]);let i=0;const n=new Float32Array(3*(t.length+1));for(const t of e)n[i++]=t[0],n[i++]=t[1],n[i++]=t[2];this.geometry.setAttribute("position",new Hr(n,3))}}function rg(t,e){return t===e}function sg(t){const e=function(t){return Math.pow(2,t)}(t)/2;return{min:[-e,-e,-e],max:[e,e,e]}}class og{constructor(t,e,i,n){this.level=t,this.leafLevel=e,this.boundingBox=i,this.parent=n,this.children=[],this.items=[],n&&n.children.push(this)}get isEmpty(){return!(this.children.length||this.items.length)}add(t){const e=this;if(!e.boundingBox.containsPoint(t.position))throw new Error("Item not contained in node");if(rg(e.level,e.leafLevel))return e.items.push(t),this;for(const i of e.children)if(i.boundingBox.containsPoint(t.position))return i.add(t);for(const i of e._generateBoundingBoxes())if(i.containsPoint(t.position)){return new og(e.level-1,e.leafLevel,i,e).add(t)}throw new Error("Item not contained in children")}intersect(t,e,i){if(t.intersectBox(this.boundingBox,e))if(rg(this.level,this.leafLevel))i.push(this);else for(const n of this.children)n.intersect(t,e,i)}remove(t){const e=this.items.indexOf(t);if(e<0)throw new Error(`Item does not exist ${t.uuid}`);this.items.splice(e,1)}traverse(){const t=this;if(!t.isEmpty)return;const e=t.parent;if(!e)return;const i=e.children.indexOf(t);if(i<0)throw new Error("Corrupt octree");e.children.splice(i,1),this.parent=null,e.traverse()}_generateBoundingBoxes(){const t=this.boundingBox.min,e=(this.boundingBox.max.x-t.x)/2,i=[[t.x,t.y+e,t.z+e],[t.x+e,t.y+e,t.z+e],[t.x,t.y,t.z+e],[t.x+e,t.y,t.z+e],[t.x,t.y+e,t.z],[t.x+e,t.y+e,t.z],[t.x,t.y,t.z],[t.x+e,t.y,t.z]],n=[];for(const[t,r,s]of i)n.push(new _n(new fn(t,r,s),new fn(t+e,r+e,s+e)));return n}}class ag{constructor(t,e){if(this.rootLevel=t,this.leafLevel=e,e>t)throw new Error;this._index=new Map,this._root=this._makeRoot()}get root(){return this._root}add(t){if(!this.root.boundingBox.containsPoint(t.position))return void console.warn(`Object outside bounding box ${t.uuid}`);const e=this._root.add(t);this._index.set(t.uuid,e)}has(t){return this._index.has(t.uuid)}intersect(t){const e=[],i=new fn;return this._root.intersect(t,i,e),e.map((t=>t.items)).reduce(((t,e)=>(t.push(...e),t)),[])}reset(){this._root=this._makeRoot(),this._index.clear()}remove(t){if(!this.has(t))throw new Error(`Frame does not exist ${t.uuid}`);const e=this._index.get(t.uuid);e.remove(t),e.traverse(),this._index.delete(t.uuid)}_makeRoot(){const t=this.rootLevel,e=sg(t),i=new _n((new fn).fromArray(e.min),(new fn).fromArray(e.max));return new og(t,this.leafLevel,i)}}class cg{constructor(t,e){this._objects=[],this._objectImageMap=new Map,this._octree=null!=t?t:new ag(14,6),this._raycaster=null!=e?e:new Bu,this._interactiveLayer=1,this._raycaster=e||new Bu(void 0,void 0,1,1e4),this._lineThreshold=.2,this._largeLineThreshold=.4,this._raycaster.params.Line.threshold=this._lineThreshold,this._raycaster.layers.set(this._interactiveLayer)}get interactiveLayer(){return this._interactiveLayer}get octree(){return this._octree}get raycaster(){return this._raycaster}add(t,e){const i=t.uuid;this._objectImageMap.set(i,e),this._objects.push(t),this._octree.add(t)}intersectObjects(t,e){this._raycaster.setFromCamera((new rn).fromArray(t),e);const i=this._octree.intersect(this.raycaster.ray),n=this._raycaster.intersectObjects(i),r=this._objectImageMap;for(const t of n){const e=t.object.uuid;if(r.has(e))return r.get(e)}return null}remove(t){const e=this._objects,i=e.indexOf(t);if(-1!==i){const n=e.splice(i,1);for(const t of n)this._objectImageMap.delete(t.uuid);this._octree.remove(t)}else console.warn("Object does not exist")}resetIntersectionThreshold(t){this._raycaster.params.Line.threshold=t?this._largeLineThreshold:this._lineThreshold}}class hg extends Uc{constructor(t){super(t.geometry,t.material);const e=t.mode,i=t.originalOrigin,n=t.transform.unprojectBasic([0,0],0);this._relativeAltitude=i[2]-n[2],this._makeAttributes(n,i,e),this.matrixAutoUpdate=!1,this.position.fromArray(n),this.updateMatrix(),this.updateMatrixWorld(!1)}dispose(){this.geometry.dispose(),this.material.dispose()}setMode(t){const e=this.geometry.attributes.position;e.array[5]=this._modeToAltitude(t),e.needsUpdate=!0,this.geometry.computeBoundingSphere()}_makeAttributes(t,e,i){const n=new Float32Array(6);n[0]=0,n[1]=0,n[2]=0,n[3]=e[0]-t[0],n[4]=e[1]-t[1],n[5]=this._modeToAltitude(i);const r=new Hr(n,3);this.geometry.setAttribute("position",r),r.needsUpdate=!0,this.geometry.computeBoundingSphere()}_modeToAltitude(e){return e===t.OriginalPositionMode.Altitude?this._relativeAltitude:0}}class lg extends qc{constructor(t){super(t.geometry,t.material);const e=t.color,i=t.size,n=t.scale,r=t.transform,s=r.unprojectBasic([0,0],0),o=this._makePositions(i,r,s);this._makeAttributes(o,e),this.geometry.computeBoundingSphere(),this.geometry.computeBoundingBox(),this.matrixAutoUpdate=!1,this.position.fromArray(s),this.scale.set(n,n,n),this.updateMatrix(),this.updateMatrixWorld(!1)}dispose(){this.geometry.dispose(),this.material.dispose()}setColor(t){return this._updateColorAttribute(t),this}resize(t){return this.scale.set(t,t,t),this.updateMatrix(),this.updateMatrixWorld(!1),this}_makeAttributes(t,e){const i=this.geometry,n=new Hr(new Float32Array(t),3);i.setAttribute("position",n),n.needsUpdate=!0;const r=new Hr(new Float32Array(t.length),3);i.setAttribute("color",r),this._updateColorAttribute(e)}_updateColorAttribute(t){const[e,i,n]=new Dr(t).toArray(),r=this.geometry.attributes.color,s=r.array,o=s.length;let a=0;for(let t=0;t<o;t++)s[a++]=e,s[a++]=i,s[a++]=n;r.needsUpdate=!0}}class ug extends lg{_makePositions(t,e,i){const n=[];n.push(...this._makeAxis(t,e,i)),n.push(...this._makeLat(.5,10,t,e,i));for(const r of[0,.25,.5,.75])n.push(...this._makeLng(r,10,t,e,i));return n}_makeAxis(t,e,i){const n=e.unprojectBasic([.5,1],.8*t),r=e.unprojectBasic([.5,0],1.2*t);return[n[0]-i[0],n[1]-i[1],n[2]-i[2],r[0]-i[0],r[1]-i[1],r[2]-i[2]]}_makeLat(t,e,i,n,r){const s=.8*i,[o,a,c]=r,h=[],l=n.unprojectBasic([0,t],s);l[0]-=o,l[1]-=a,l[2]-=c,h.push(...l);for(let i=1;i<=e;i++){const r=n.unprojectBasic([i/e,t],s);r[0]-=o,r[1]-=a,r[2]-=c,h.push(...r,...r)}return h.push(...l),h}_makeLng(t,e,i,n,r){const s=.8*i,[o,a,c]=r,h=[],l=n.unprojectBasic([t,0],s);l[0]-=o,l[1]-=a,l[2]-=c,h.push(...l);for(let i=0;i<=e;i++){const r=n.unprojectBasic([t,i/e],s);r[0]-=o,r[1]-=a,r[2]-=c,h.push(...r,...r)}return h.push(...l),h}}class dg extends lg{_makePositions(t,e,i){const n=[];return n.push(...this._makeDiags(t,e,i)),n.push(...this._makeFrame(t,8,e,i)),n}_makeDiags(t,e,i){const n=t,[r,s,o]=i,a=[0,0,0],c=[];for(const t of[[0,0],[1,0],[1,1],[0,1]]){const i=e.unprojectBasic(t,n,!0);i[0]-=r,i[1]-=s,i[2]-=o,c.push(...a,...i)}return c}_makeFrame(t,e,i,n){const r=[];r.push(...this._subsample([0,1],[0,0],e)),r.push(...this._subsample([0,0],[1,0],e)),r.push(...this._subsample([1,0],[1,1],e));const s=t,[o,a,c]=n,h=[];for(const t of r){const e=i.unprojectBasic(t,s,!0);e[0]-=o,e[1]-=a,e[2]-=c,h.push(...e)}return h}_interpolate(t,e,i){return t+i*(e-t)}_subsample(t,e,i){if(i<1)return[t,e];const n=[];n.push(t);for(let r=0;r<=i;r++){const s=[];for(let n=0;n<3;n++)s.push(this._interpolate(t[n],e[n],r/(i+1)));n.push(s),n.push(s)}return n.push(e),n}}class pg{constructor(t,e,i){this.id=t,this._scene=e,this._intersection=i,this.cameras=new pr,this.keys=[],this._positionLines={},this._positions=new pr,this._cameraFrames={},this._clusters=new Map,this._connectedComponents=new Map,this._sequences=new Map,this._props={},this.clusterVisibles={},this._frameMaterial=new kc({fog:!1,vertexColors:!0}),this._positionMaterial=new kc({fog:!1,color:16711680}),this._scene.add(this.cameras,this._positions)}addImage(t){const e=t.image,i=e.id;if(this.hasImage(i))throw new Error(`Image exists ${i}`);const n=t.idMap.ccId;this._connectedComponents.has(n)||this._connectedComponents.set(n,[]);const r=t.idMap.clusterId;this._clusters.has(r)||this._clusters.set(r,[]);const s=t.idMap.sequenceId;this._sequences.has(s)||this._sequences.set(s,[]),this._props[i]={image:e,ids:{ccId:n,clusterId:r,sequenceId:s}},this.keys.push(i)}applyCameraColor(t,e){this._cameraFrames[t].setColor(e)}applyCameraSize(t){for(const e of this.cameras.children)e.resize(t)}applyFilter(t){var e;const i=this.clusterVisibles;for(const t in i)i.hasOwnProperty(t)&&(i[t]=!1);const n=this._cameraFrames,r=this._positionLines,s=this._intersection.interactiveLayer;for(const o of Object.values(this._props)){const a=o.image,c=t(a),h=a.id;r[h].visible=c;const l=n[h];this._setCameraVisibility(l,c,s),i[e=o.ids.clusterId]||(i[e]=c)}}applyPositionMode(e){this._positions.visible=e!==t.OriginalPositionMode.Hidden;for(const t of this._positions.children)t.setMode(e)}dispose(){this._disposeCameras(),this._disposePositions(),this._scene=null,this._intersection=null}getCamerasByMode(e){if(e===t.CameraVisualizationMode.Cluster)return this._clusters;if(e===t.CameraVisualizationMode.ConnectedComponent)return this._connectedComponents;if(e===t.CameraVisualizationMode.Sequence)return this._sequences;const i=t.CameraVisualizationMode,n=i[i.Homogeneous],r=new Map;return r.set(n,this.cameras.children),r}getColorId(e,i){const n=this._props[e],r=t.CameraVisualizationMode;switch(i){case r.Cluster:return n.ids.clusterId;case r.ConnectedComponent:return n.ids.ccId;case r.Sequence:return n.ids.sequenceId;default:return r[r.Homogeneous]}}hasImage(t){return-1!==this.keys.indexOf(t)}visualize(t){var e,i;const n=t.id,r=t.visible,s=t.transform,o={color:t.color,material:this._frameMaterial,scale:t.scale,size:t.maxSize,transform:s},a=dd(s.cameraType)?new ug(o):new dg(o),c=this._intersection.interactiveLayer;this._setCameraVisibility(a,r,c),this.cameras.add(a),this._cameraFrames[n]=a;this._intersection.add(a,n);const h=this._props[n].ids;(e=this.clusterVisibles)[i=h.clusterId]||(e[i]=r),this._connectedComponents.get(h.ccId).push(a),this._clusters.get(h.clusterId).push(a),this._sequences.get(h.sequenceId).push(a);const l={material:this._positionMaterial,mode:t.positionMode,originalOrigin:t.originalPosition,transform:s},u=new hg(l);u.visible=r,this._positions.add(u),this._positionLines[n]=u}_disposeCameras(){const t=this._intersection,e=this.cameras;for(const i of e.children.slice())i.dispose(),t.remove(i),e.remove(i);this._scene.remove(this.cameras)}_disposePositions(){const t=this._positions;for(const e of t.children.slice())e.dispose(),t.remove(e);this._scene.remove(this._positions)}_setCameraVisibility(t,e,i){t.visible=e,e?t.layers.enable(i):t.layers.disable(i)}}class fg{constructor(){this._colors=new Map;const e=t.CameraVisualizationMode;this._colors.set(e[e.Homogeneous],"#FFFFFF")}getColor(t){const e=this._colors;return e.has(t)||e.set(t,this._randomColor()),e.get(t)}_randomColor(){return`hsl(${Math.floor(360*Math.random())}, 100%, 50%)`}}function mg(e){return e!==t.CameraVisualizationMode.Hidden}class gg{constructor(e,i){this._rayNearScale=1.1,this._originalPointSize=2,this._originalCameraSize=2,this._imageCellMap=new Map,this._scene=i||new Qa,this._scene.autoUpdate=!1,this._intersection=new cg,this._assets=new fg,this._needsRender=!1,this._images={},this._cells={},this._cellClusters={},this._clusters={},this._cameraVisualizationMode=e.cameraVisualizationMode?e.cameraVisualizationMode:t.CameraVisualizationMode.Homogeneous,this._cameraSize=e.cameraSize,this._pointSize=e.pointSize,this._pointsVisible=e.pointsVisible,this._positionMode=e.originalPositionMode,this._cellsVisible=e.cellsVisible,this._hoveredId=null,this._selectedId=null,this._colors={hover:"#FF0000",select:"#FF8000"},this._filter=()=>!0}get needsRender(){return this._needsRender}get intersection(){return this._intersection}addCluster(t,e,i){if(this.hasCluster(t.id,i))return;const n=t.id;if(!(n in this._clusters)){this._clusters[n]={points:new pr,cellIds:[]};const i=this._getClusterVisible(n);this._clusters[n].points.visible=i,this._clusters[n].points.add(new ig({cluster:t,originalSize:this._originalPointSize,scale:this._pointSize,translation:e})),this._scene.add(this._clusters[n].points)}-1===this._clusters[n].cellIds.indexOf(i)&&this._clusters[n].cellIds.push(i),i in this._cellClusters||(this._cellClusters[i]={keys:[]}),-1===this._cellClusters[i].keys.indexOf(n)&&this._cellClusters[i].keys.push(n),this._needsRender=!0}addImage(t,e,i,n){var r,s,o;const a=t.id,c={clusterId:null!==(r=t.clusterId)&&void 0!==r?r:"NO_CLUSTER_ID",sequenceId:null!==(s=t.sequenceId)&&void 0!==s?s:"NO_SEQUENCE_ID",ccId:null!==(o=t.mergeId)&&void 0!==o?o:"NO_MERGE_ID"};if(!(n in this._images)){const t=new pg(n,this._scene,this._intersection);t.cameras.visible=mg(this._cameraVisualizationMode),t.applyPositionMode(this._positionMode),this._images[n]=t}const h=this._images[n];if(h.hasImage(a))return;h.addImage({idMap:c,image:t});const l=h.getColorId(a,this._cameraVisualizationMode),u=this._assets.getColor(l),d=this._filter(t);if(h.visualize({id:a,color:u,positionMode:this._positionMode,scale:this._cameraSize,transform:e,visible:d,maxSize:this._originalCameraSize,originalPosition:i}),this._imageCellMap.set(a,n),a===this._selectedId&&this._highlight(a,this._colors.select,this._cameraVisualizationMode),c.clusterId in this._clusters){const t=this._getClusterVisible(c.clusterId);this._clusters[c.clusterId].points.visible=t}this._needsRender=!0}addCell(t,e){if(this.hasCell(e))return;const i=new ng(t);this._cells[e]=new pr,this._cells[e].visible=this._cellsVisible,this._cells[e].add(i),this._scene.add(this._cells[e]),this._needsRender=!0}deactivate(){this._filter=()=>!0,this._selectedId=null,this._hoveredId=null,this.uncache()}hasCluster(t,e){return t in this._clusters&&-1!==this._clusters[t].cellIds.indexOf(e)}hasCell(t){return t in this._cells}hasImage(t,e){return e in this._images&&this._images[e].hasImage(t)}setCameraSize(t){if(Math.abs(t-this._cameraSize)<.001)return;const e=this._images;for(const i of Object.keys(e))e[i].applyCameraSize(t);this._intersection.raycaster.near=this._getNear(t),this._cameraSize=t,this._needsRender=!0}setFilter(t){this._filter=t;const e={};for(const i of Object.values(this._images)){i.applyFilter(t);const n=i.clusterVisibles;for(const t in n)n.hasOwnProperty(t)&&(t in e||(e[t]=!1),e[t]||(e[t]=n[t]))}const i=this._pointsVisible;for(const t in e){if(!e.hasOwnProperty(t))continue;e[t]&&(e[t]=i);const n=e[t];t in this._clusters&&(this._clusters[t].points.visible=n)}this._needsRender=!0}setHoveredImage(t){if(null!=t&&!this._imageCellMap.has(t))throw new cd(`Image does not exist: ${t}`);this._hoveredId!==t&&(this._needsRender=!0,null!=this._hoveredId&&(this._hoveredId===this._selectedId?this._highlight(this._hoveredId,this._colors.select,this._cameraVisualizationMode):this._resetCameraColor(this._hoveredId)),this._highlight(t,this._colors.hover,this._cameraVisualizationMode),this._hoveredId=t)}setNavigationState(t){this._intersection.resetIntersectionThreshold(t)}setPointSize(t){if(Math.abs(t-this._pointSize)<.001)return;const e=this._clusters;for(const i in e)if(e.hasOwnProperty(i))for(const n of e[i].points.children)n.resize(t);this._pointSize=t,this._needsRender=!0}setPointVisibility(t){if(t!==this._pointsVisible){for(const e in this._clusters)this._clusters.hasOwnProperty(e)&&(this._clusters[e].points.visible=t);this._pointsVisible=t,this._needsRender=!0}}setPositionMode(t){if(t!==this._positionMode){for(const e of Object.values(this._images))e.applyPositionMode(t);this._positionMode=t,this._needsRender=!0}}setSelectedImage(t){this._selectedId!==t&&(this._needsRender=!0,null!=this._selectedId&&this._resetCameraColor(this._selectedId),this._highlight(t,this._colors.select,this._cameraVisualizationMode),this._selectedId=t)}setCellVisibility(t){if(t!==this._cellsVisible){for(const e in this._cells)this._cells.hasOwnProperty(e)&&(this._cells[e].visible=t);this._cellsVisible=t,this._needsRender=!0}}setCameraVisualizationMode(t){if(t===this._cameraVisualizationMode)return;const e=mg(t),i=this._assets;for(const n of Object.values(this._images)){n.cameras.visible=e;n.getCamerasByMode(t).forEach(((t,e)=>{const n=i.getColor(e);for(const e of t)e.setColor(n)}))}this._highlight(this._hoveredId,this._colors.hover,t),this._highlight(this._selectedId,this._colors.select,t),this._cameraVisualizationMode=t,this._needsRender=!0}render(t,e){e.render(this._scene,t),this._needsRender=!1}uncache(t){for(const e of Object.keys(this._cellClusters))t&&-1!==t.indexOf(e)||this._disposeReconstruction(e);for(const e of Object.keys(this._images)){if(t&&-1!==t.indexOf(e))continue;const i=this._imageCellMap,n=this._images[e].keys;for(const t of n)i.delete(t);this._images[e].dispose(),delete this._images[e]}for(const e of Object.keys(this._cells))t&&-1!==t.indexOf(e)||this._disposeCell(e);this._needsRender=!0}_getClusterVisible(t){if(!this._pointsVisible)return!1;let e=!1;for(const i of Object.values(this._images)){const n=i.clusterVisibles;t in n&&(e||(e=n[t]))}return e}_disposePoints(t){for(const e of this._cellClusters[t].keys){if(!(e in this._clusters))continue;const i=this._clusters[e].cellIds.indexOf(t);if(-1!==i&&(this._clusters[e].cellIds.splice(i,1),!(this._clusters[e].cellIds.length>0))){for(const t of this._clusters[e].points.children.slice())t.dispose();this._scene.remove(this._clusters[e].points),delete this._clusters[e]}}}_disposeReconstruction(t){this._disposePoints(t),delete this._cellClusters[t]}_disposeCell(t){const e=this._cells[t];for(const t of e.children.slice())t.dispose(),e.remove(t);this._scene.remove(e),delete this._cells[t]}_getNear(t){const e=this._rayNearScale*this._originalCameraSize*t;return Math.max(1,e)}_resetCameraColor(t){const e=this._imageCellMap;if(null==t||!e.has(t))return;const i=e.get(t),n=this._images[i],r=n.getColorId(t,this._cameraVisualizationMode),s=this._assets.getColor(r);n.applyCameraColor(t,s)}_highlight(e,i,n){const r=this._imageCellMap;if(null==e||!r.has(e))return;const s=r.get(e);i=n===t.CameraVisualizationMode.Homogeneous?i:"#FFFFFF",this._images[s].applyCameraColor(e,i)}}class _g{constructor(t,e){this._graphService=t,this._data=e,this._cells={},this._cacheRequests={},this._clusters={},this._clusterCells={},this._cellClusters={},this._cachingCells$={},this._cachingClusters$={}}cacheClusters$(t){if(!this.hasCell(t))throw new Error("Cannot cache reconstructions of a non-existing cell.");if(this.hasClusters(t))throw new Error("Cannot cache reconstructions that already exists.");if(this.isCachingClusters(t))return this._cachingClusters$[t];const e=this.getCell(t).filter((t=>!!t.clusterId&&!!t.clusterUrl)).map((t=>({key:t.clusterId,url:t.clusterUrl}))),i=Array.from(new Map(e.map((t=>[t.key,t]))).values());let n;this._cellClusters[t]=i,this._cacheRequests[t]=[];const r=new Promise(((t,e)=>{n=e}));return this._cacheRequests[t].push(n),this._cachingClusters$[t]=this._cacheClusters$(i,t,r).pipe(Me((()=>{t in this._cachingClusters$&&delete this._cachingClusters$[t],t in this._cacheRequests&&delete this._cacheRequests[t]})),He(),E()),this._cachingClusters$[t]}cacheCell$(t){if(this.hasCell(t))throw new Error("Cannot cache cell that already exists.");return this.isCachingCell(t)||(this._cachingCells$[t]=this._graphService.cacheCell$(t).pipe(te((t=>(console.error(t),B()))),Nt((()=>!(t in this._cells))),pi((e=>{this._cells[t]=[],this._cells[t].push(...e),delete this._cachingCells$[t]})),Me((()=>{t in this._cachingCells$&&delete this._cachingCells$[t]})),He(),E())),this._cachingCells$[t]}isCachingClusters(t){return t in this._cachingClusters$}isCachingCell(t){return t in this._cachingCells$}hasClusters(t){if(t in this._cachingClusters$||!(t in this._cellClusters))return!1;for(const e of this._cellClusters[t])if(!(e.key in this._clusters))return!1;return!0}hasCell(t){return!(t in this._cachingCells$)&&t in this._cells}getClusters(t){return t in this._cellClusters?this._cellClusters[t].map((t=>this._clusters[t.key])).filter((t=>!!t)):[]}getCell(t){return t in this._cells?this._cells[t]:[]}uncache(t){for(let e of Object.keys(this._cacheRequests))if(!t||-1===t.indexOf(e)){for(const t of this._cacheRequests[e])t();delete this._cacheRequests[e]}for(let e of Object.keys(this._cellClusters))if(!t||-1===t.indexOf(e)){for(const t of this._cellClusters[e]){if(!(t.key in this._clusterCells))continue;const i=this._clusterCells[t.key].indexOf(e);-1!==i&&(this._clusterCells[t.key].splice(i,1),this._clusterCells[t.key].length>0||(delete this._clusterCells[t.key],delete this._clusters[t.key]))}delete this._cellClusters[e]}for(let e of Object.keys(this._cells))t&&-1!==t.indexOf(e)||delete this._cells[e]}updateCell$(t){if(!this.hasCell(t))throw new Error("Cannot update cell that does not exists.");return this._graphService.cacheCell$(t).pipe(te((t=>(console.error(t),B()))),Nt((()=>t in this._cells)),pi((e=>{this._cells[t]=[],this._cells[t].push(...e)})),He(),E())}updateClusters$(t){if(!this.hasCell(t))throw new Error("Cannot update reconstructions of a non-existing cell.");if(!this.hasClusters(t))throw new Error("Cannot update reconstructions for cell that is not cached.");const e=this.getCell(t).filter((t=>!!t.clusterId&&!!t.clusterUrl)).map((t=>({key:t.clusterId,url:t.clusterUrl}))),i=Array.from(new Map(e.map((t=>[t.key,t]))).values()).filter((t=>!(t.key in this._clusters)));return this._cellClusters[t].push(...i),this._cacheClusters$(i,t,null)}_cacheClusters$(t,e,i){return bt(t).pipe(Mt((t=>this._hasCluster(t.key)?G(this._getCluster(t.key)):this._getCluster$(t.url,t.key,i).pipe(te((t=>(t instanceof Zf||console.error(t),B()))))),6),Nt((()=>e in this._cellClusters)),pi((t=>{this._hasCluster(t.id)||(this._clusters[t.id]=t),t.id in this._clusterCells||(this._clusterCells[t.id]=[]),-1===this._clusterCells[t.id].indexOf(e)&&this._clusterCells[t.id].push(e)})))}_getCluster(t){return this._clusters[t]}_getCluster$(t,e,i){return b.create((n=>{this._data.getCluster(t,i).then((t=>{t.id=e,n.next(t),n.complete()}),(t=>{n.error(t)}))}))}_hasCluster(t){return t in this._clusters}}function vg(t,e,i){const n=new Set;return n.add(t),yg(n,[t],0,e,i),Array.from(n)}function yg(t,e,i,n,r){if(i>=n)return;const s=[];for(const t of e){const e=r.getAdjacent(t);s.push(...e)}const o=[];for(const e of s)t.has(e)||(t.add(e),o.push(e));yg(t,o,i+1,n,r)}class bg extends Vf{constructor(t,e,i){super(t,e,i),this._cache=new _g(i.graphService,i.api.data),this._scene=new gg(this._getDefaultConfiguration()),this._viewportCoords=new Wf,this._spatial=new ld}getFrameIdAt(t){return new Promise(((e,i)=>{this._container.renderService.renderCamera$.pipe(Ee(),rt((e=>{const i=this._viewportCoords.canvasToViewport(t[0],t[1],this._container.container);return this._scene.intersection.intersectObjects(i,e.perspective)}))).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}_activate(){this._navigator.cacheService.configure({cellDepth:3});const t=this._subscriptions;t.push(this._navigator.stateService.reference$.subscribe((()=>{this._scene.uncache()}))),t.push(this._navigator.graphService.filter$.subscribe((t=>{this._scene.setFilter(t)})));const e=this._container.renderService.bearing$.pipe(rt((t=>6*Math.floor(t/6))),ue(),Ue(1),E()),i=this._navigator.stateService.currentImage$.pipe(rt((t=>this._navigator.api.data.geometry.lngLatToCellId(t.originalLngLat))),ue(),Ue(1),E()),n=this._configuration$.pipe(rt((t=>this._spatial.clamp(t.cellGridDepth,1,3))),ue(),Ue(1),E()),r=gt(this._navigator.playService.playing$,this._navigator.playService.speed$).pipe(rt((([t,e])=>t&&e>eg.sequenceSpeed)),ue(),Ue(1),E()),s=this._navigator.stateService.state$.pipe(rt((t=>function(t){return t===vm.Custom||t===vm.Earth}(t))),ue(),Ue(1),E());t.push(s.subscribe((t=>{this._scene.setNavigationState(t)})));const o=gt(s,r,e,n,this._navigator.stateService.currentImage$).pipe(ue((([t,e,i,n,r],[s,o,a,c,h])=>{if(t!==s)return!1;const l=r.id===h.id&&e===o&&n===c;return t?l:l&&i===a})),ne((([t,e,i,n,r])=>{if(t){const t=this._navigator.api.data.geometry,i=t.lngLatToCellId(r.originalLngLat);return G(e?[i]:vg(i,n,t))}const s=e?30:90;return G(this._cellsInFov(r,i,s))})),ri((t=>bt(t).pipe(Mt((t=>(this._cache.hasCell(t)?G(this._cache.getCell(t)):this._cache.cacheCell$(t)).pipe(rt((e=>({id:t,images:e}))))),6)))));t.push(o.pipe(bi(this._navigator.stateService.reference$)).subscribe((([t,e])=>{this._scene.hasCell(t.id)||this._scene.addCell(this._cellToTopocentric(t.id,e),t.id)}))),t.push(o.pipe(bi(this._navigator.stateService.reference$)).subscribe((([t,e])=>{this._addSceneImages(t,e)}))),t.push(o.pipe(ne((t=>{const e=t.id;let i;return i=this._cache.hasClusters(e)?bt(this._cache.getClusters(e)):this._cache.isCachingClusters(e)?this._cache.cacheClusters$(e).pipe(Re(null,{}),ri((()=>bt(this._cache.getClusters(e))))):this._cache.hasCell(e)?this._cache.cacheClusters$(e):B(),gt(G(e),i)})),bi(this._navigator.stateService.reference$)).subscribe((([[t,e],i])=>{this._scene.hasCluster(e.id,t)||this._scene.addCluster(e,this._computeTranslation(e,i),t)}))),t.push(this._configuration$.pipe(rt((t=>(t.cameraSize=this._spatial.clamp(t.cameraSize,.01,1),t.pointSize=this._spatial.clamp(t.pointSize,.01,1),{cameraSize:t.cameraSize,cameraVisualizationMode:t.cameraVisualizationMode,cellsVisible:t.cellsVisible,originalPositionMode:t.originalPositionMode,pointSize:t.pointSize,pointsVisible:t.pointsVisible}))),ue(((t,e)=>t.cameraSize===e.cameraSize&&t.cameraVisualizationMode===e.cameraVisualizationMode&&t.cellsVisible===e.cellsVisible&&t.originalPositionMode===e.originalPositionMode&&t.pointSize===e.pointSize&&t.pointsVisible===e.pointsVisible))).subscribe((t=>{this._scene.setCameraSize(t.cameraSize),this._scene.setPointSize(t.pointSize),this._scene.setPointVisibility(t.pointsVisible),this._scene.setCellVisibility(t.cellsVisible);const e=t.cameraVisualizationMode;this._scene.setCameraVisualizationMode(e);const i=t.originalPositionMode;this._scene.setPositionMode(i)}))),t.push(gt(i,n).subscribe((([t,e])=>{const i=vg(t,e,this._navigator.api.data.geometry);this._scene.uncache(i),this._cache.uncache(i)}))),t.push(this._navigator.playService.playing$.pipe(ri((t=>t?B():this._container.mouseService.dblClick$)),bi(this._container.renderService.renderCamera$),ri((([t,e])=>{const i=this._container.container,[n,r]=this._viewportCoords.canvasPosition(t,i),s=this._viewportCoords.canvasToViewport(n,r,i),o=this._scene.intersection.intersectObjects(s,e.perspective);return o?this._navigator.moveTo$(o).pipe(te((()=>B()))):B()}))).subscribe());const a=gt(this._configuration$,this._navigator.stateService.state$).pipe(rt((([t,e])=>(t.cameraSize=this._spatial.clamp(t.cameraSize,.01,1),{size:t.cameraSize,visible:mg(t.cameraVisualizationMode),state:e}))),ue(((t,e)=>t.size===e.size&&t.visible===e.visible&&t.state===e.state))),c=this._container.mouseService.mouseMove$.pipe(Ue(1),E());t.push(c.subscribe());const h=Ot(this._container.mouseService.mouseEnter$,this._container.mouseService.mouseLeave$,this._container.mouseService.windowBlur$);t.push(gt(this._navigator.playService.playing$,h,s,this._navigator.graphService.filter$).pipe(ri((([t,e])=>t||"pointerenter"!==e.type?gt(G(e),G(null),G(null)):gt(At(c.pipe(ve(1)),this._container.mouseService.mouseMove$),this._container.renderService.renderCamera$,a)))).subscribe((([t,e])=>{if("pointermove"!==t.type)return void this._scene.setHoveredImage(null);const i=this._container.container,[n,r]=this._viewportCoords.canvasPosition(t,i),s=this._viewportCoords.canvasToViewport(n,r,i),o=this._scene.intersection.intersectObjects(s,e.perspective);this._scene.setHoveredImage(o)}))),t.push(this._navigator.stateService.currentId$.subscribe((t=>{this._scene.setSelectedImage(t)}))),t.push(this._navigator.stateService.currentState$.pipe(rt((t=>{const e=this._scene;return{name:this._name,renderer:{frameId:t.id,needsRender:e.needsRender,render:e.render.bind(e),pass:rm.Opaque}}}))).subscribe(this._container.glRenderer.render$));const l=this._navigator.graphService.dataAdded$.pipe(Nt((t=>this._cache.hasCell(t))),Mt((t=>this._cache.updateCell$(t).pipe(rt((e=>({id:t,images:e}))),bi(this._navigator.stateService.reference$)))),He(),E());t.push(l.subscribe((([t,e])=>{this._addSceneImages(t,e)}))),t.push(l.pipe(ne((([t])=>{const e=t.id,i=this._cache;let n;return n=i.hasClusters(e)?i.updateClusters$(e):i.isCachingClusters(e)?this._cache.cacheClusters$(e).pipe(Re(null,{}),ri((()=>bt(i.updateClusters$(e))))):B(),gt(G(e),n)})),bi(this._navigator.stateService.reference$)).subscribe((([[t,e],i])=>{this._scene.hasCluster(e.id,t)||this._scene.addCluster(e,this._computeTranslation(e,i),t)})))}_deactivate(){this._subscriptions.unsubscribe(),this._cache.uncache(),this._scene.deactivate(),this._navigator.cacheService.configure()}_getDefaultConfiguration(){return{cameraSize:.1,cameraVisualizationMode:t.CameraVisualizationMode.Homogeneous,cellGridDepth:1,originalPositionMode:t.OriginalPositionMode.Hidden,pointSize:.1,pointsVisible:!0,cellsVisible:!1}}_addSceneImages(t,e){const i=t.id,n=t.images;for(const t of n)this._scene.hasImage(t.id,i)||this._scene.addImage(t,this._createTransform(t,e),this._computeOriginalPosition(t,e),i)}_cellsInFov(t,e,i){const n=this._spatial,r=this._navigator.api.data.geometry,s=r.lngLatToCellId(t.originalLngLat),o=[s],a=i/2,c=r.getAdjacent(s);for(const i of c){const s=r.getVertices(i);for(const r of s){const[s,c]=Ju(r.lng,r.lat,0,t.lngLat.lng,t.lngLat.lat,0),h=Math.atan2(c,s),l=n.radToDeg(n.azimuthalToBearing(h));Math.abs(l-e)<a&&o.push(i)}}return o}_computeOriginalPosition(t,e){return Ju(t.originalLngLat.lng,t.originalLngLat.lat,null!=t.originalAltitude?t.originalAltitude:t.computedAltitude,e.lng,e.lat,e.alt)}_cellToTopocentric(t,e){return this._navigator.api.data.geometry.getVertices(t).map((t=>Ju(t.lng,t.lat,-2,e.lng,e.lat,e.alt)))}_computeTranslation(t,e){return Ju(t.reference.lng,t.reference.lat,t.reference.alt,e.lng,e.lat,e.alt)}_createTransform(t,e){const i=fd({alt:t.computedAltitude,lat:t.lngLat.lat,lng:t.lngLat.lng},t.rotation,e);return new Hd(t.exifOrientation,t.width,t.height,t.scale,t.rotation,i,void 0,void 0,t.cameraParameters,t.cameraType)}}bg.componentName="spatial";class xg{constructor(){this._notifyChanged$=new T}get changed$(){return this._notifyChanged$}}class wg extends cd{constructor(t){super(null!=t?t:"The provided geometry value is incorrect"),Object.setPrototypeOf(this,wg.prototype),this.name="GeometryTagError"}}class Sg extends xg{constructor(t){super();if(t.length<2)throw new wg("A points geometry must have two or more positions.");this._points=[];for(const e of t){if(e[0]<0||e[0]>1||e[1]<0||e[1]>1)throw new wg("Basic coordinates of points must be on the interval [0, 1].");this._points.push(e.slice())}}get points(){return this._points}addPoint2d(t){const e=[Math.max(0,Math.min(1,t[0])),Math.max(0,Math.min(1,t[1]))];this._points.push(e),this._notifyChanged$.next(this)}getPoint2d(t){return this._points[t].slice()}removePoint2d(t){if(t<0||t>=this._points.length||this._points.length<3)throw new wg("Index for removed point must be valid.");this._points.splice(t,1),this._notifyChanged$.next(this)}setVertex2d(t,e,i){this.setPoint2d(t,e,i)}setPoint2d(t,e,i){const n=[Math.max(0,Math.min(1,e[0])),Math.max(0,Math.min(1,e[1]))];this._points[t]=n,this._notifyChanged$.next(this)}getPoints3d(t){return this._getPoints3d(this._points,t)}getPoint3d(t,e){return e.unprojectBasic(this._points[t],200)}getPoints2d(){return this._points.slice()}getCentroid2d(t){if(!t)throw new wg("Get centroid must be called with a transform for points geometries.");const[e,i,n,r]=this.getRect2d(t);return[e<n?(e+n)/2:(e+n+1)/2%1,(i+r)/2]}getCentroid3d(t){let e=this.getCentroid2d();return t.unprojectBasic(e,200)}getRect2d(t){let e=1,i=0,n=1,r=0;const s=this._points;for(const t of s)t[0]<e&&(e=t[0]),t[0]>i&&(i=t[0]),t[1]<n&&(n=t[1]),t[1]>r&&(r=t[1]);if(dd(t.cameraType)){const t=[];for(let e=0;e<s.length;e++)t[e]=e;t.sort(((t,e)=>s[t][0]<s[e][0]?-1:s[t][0]>s[e][0]?1:t<e?-1:1));let n=s[t[0]][0]+1-s[t[t.length-1]][0],r=0;for(let e=0;e<t.length-1;e++){const i=t[e],o=t[e+1],a=s[o][0]-s[i][0];a>n&&(n=a,r=e+1)}r>0&&(e=s[t[r]][0],i=s[t[r-1]][0])}return[e,n,i,r]}setCentroid2d(t,e){throw new Error("Not implemented")}_getPoints3d(t,e){return t.map((t=>e.unprojectBasic(t,200)))}}class Mg{constructor(t,e,i){this._geometry=t,this._transform=e,this._viewportCoords=i||new Wf,this._aborted$=new T,this._created$=new T,this._glObjectsChanged$=new T,this._geometryChangedSubscription=this._geometry.changed$.subscribe((()=>{this._onGeometryChanged(),this._glObjectsChanged$.next(this)}))}get geometry(){return this._geometry}get glObjects(){return this._glObjects}get aborted$(){return this._aborted$}get created$(){return this._created$}get glObjectsChanged$(){return this._glObjectsChanged$}get geometryChanged$(){return this._geometry.changed$.pipe(rt((()=>this)))}dispose(){this._geometryChangedSubscription.unsubscribe()}_canvasToTransform(t){return`translate(-50%,-50%) translate(${Math.round(t[0])}px,${Math.round(t[1])}px)`}_colorToBackground(t){return"#"+("000000"+t.toString(16)).substr(-6)}_createOutine(t,e){const i=this._getLinePositions(t),n=new hs;n.setAttribute("position",new Hr(i,3));return new Uc(n,new kc({color:e,linewidth:1}))}_disposeLine(t){null!=t&&(t.geometry.dispose(),t.material.dispose())}_getLinePositions(t){const e=t.length,i=new Float32Array(3*e);for(let n=0;n<e;++n){const e=3*n,r=t[n];i[e]=r[0],i[e+1]=r[1],i[e+2]=r[2]}return i}}var Tg=Eg,Cg=Eg;function Eg(t,e,i){i=i||2;var n,r,s,o,a,c,h,l=e&&e.length,u=l?e[0]*i:t.length,d=Ig(t,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(l&&(d=function(t,e,i,n){var r,s,o,a=[];for(r=0,s=e.length;r<s;r++)(o=Ig(t,e[r]*n,r<s-1?e[r+1]*n:t.length,n,!1))===o.next&&(o.steiner=!0),a.push(Fg(o));for(a.sort(Dg),r=0;r<a.length;r++)$g(a[r],i),i=Ag(i,i.next);return i}(t,e,d,i)),t.length>80*i){n=s=t[0],r=o=t[1];for(var f=i;f<u;f+=i)(a=t[f])<n&&(n=a),(c=t[f+1])<r&&(r=c),a>s&&(s=a),c>o&&(o=c);h=0!==(h=Math.max(s-n,o-r))?1/h:0}return Pg(d,p,i,n,r,h),p}function Ig(t,e,i,n,r){var s,o;if(r===Kg(t,e,i,n)>0)for(s=e;s<i;s+=n)o=Yg(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=Yg(s,t[s],t[s+1],o);return o&&Ug(o,o.next)&&(Zg(o),o=o.next),o}function Ag(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!Ug(n,n.next)&&0!==Hg(n.prev,n,n.next))n=n.next;else{if(Zg(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function Pg(t,e,i,n,r,s,o){if(t){!o&&s&&function(t,e,i,n){var r=t;do{null===r.z&&(r.z=zg(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,s,o,a,c,h=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<h&&(a++,n=n.nextZ);e++);for(c=h;a>0||c>0&&n;)0!==a&&(0===c||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,h*=2}while(o>1)}(r)}(t,n,r,s);for(var a,c,h=t;t.prev!==t.next;)if(a=t.prev,c=t.next,s?Lg(t,n,r,s):Rg(t))e.push(a.i/i),e.push(t.i/i),e.push(c.i/i),Zg(t),t=c.next,h=c.next;else if((t=c)===h){o?1===o?Pg(t=Og(Ag(t),e,i),e,i,n,r,s,2):2===o&&Ng(t,e,i,n,r,s):Pg(Ag(t),e,i,n,r,s,1);break}}}function Rg(t){var e=t.prev,i=t,n=t.next;if(Hg(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(Bg(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&Hg(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Lg(t,e,i,n){var r=t.prev,s=t,o=t.next;if(Hg(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,c=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,h=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,u=zg(a,c,e,i,n),d=zg(h,l,e,i,n),p=t.prevZ,f=t.nextZ;p&&p.z>=u&&f&&f.z<=d;){if(p!==t.prev&&p!==t.next&&Bg(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Hg(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&Bg(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Hg(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&Bg(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Hg(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&Bg(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Hg(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Og(t,e,i){var n=t;do{var r=n.prev,s=n.next.next;!Ug(r,s)&&Vg(r,n,n.next,s)&&Wg(r,s)&&Wg(s,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(s.i/i),Zg(n),Zg(n.next),n=t=s),n=n.next}while(n!==t);return Ag(n)}function Ng(t,e,i,n,r,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&jg(o,a)){var c=Xg(o,a);return o=Ag(o,o.next),c=Ag(c,c.next),Pg(o,e,i,n,r,s),void Pg(c,e,i,n,r,s)}a=a.next}o=o.next}while(o!==t)}function Dg(t,e){return t.x-e.x}function $g(t,e){if(e=function(t,e){var i,n=e,r=t.x,s=t.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o){if(o=a,a===r){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===o)return i;var c,h=i,l=i.x,u=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=l&&r!==n.x&&Bg(s<u?r:o,s,l,u,s<u?o:r,s,n.x,n.y)&&(c=Math.abs(s-n.y)/(r-n.x),Wg(n,t)&&(c<d||c===d&&(n.x>i.x||n.x===i.x&&kg(i,n)))&&(i=n,d=c)),n=n.next}while(n!==h);return i}(t,e)){var i=Xg(e,t);Ag(e,e.next),Ag(i,i.next)}}function kg(t,e){return Hg(t.prev,t,e.prev)<0&&Hg(e.next,t,t.next)<0}function zg(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Fg(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Bg(t,e,i,n,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(n-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(r-o)*(n-a)>=0}function jg(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Vg(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(Wg(t,e)&&Wg(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(Hg(t.prev,t,e.prev)||Hg(t,e.prev,e))||Ug(t,e)&&Hg(t.prev,t,t.next)>0&&Hg(e.prev,e,e.next)>0)}function Hg(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Ug(t,e){return t.x===e.x&&t.y===e.y}function Vg(t,e,i,n){var r=qg(Hg(t,e,i)),s=qg(Hg(t,e,n)),o=qg(Hg(i,n,t)),a=qg(Hg(i,n,e));return r!==s&&o!==a||(!(0!==r||!Gg(t,i,e))||(!(0!==s||!Gg(t,n,e))||(!(0!==o||!Gg(i,t,n))||!(0!==a||!Gg(i,e,n)))))}function Gg(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function qg(t){return t>0?1:t<0?-1:0}function Wg(t,e){return Hg(t.prev,t,t.next)<0?Hg(t,e,t.next)>=0&&Hg(t,t.prev,e)>=0:Hg(t,e,t.prev)<0||Hg(t,t.next,e)<0}function Xg(t,e){var i=new Jg(t.i,t.x,t.y),n=new Jg(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function Yg(t,e,i,n){var r=new Jg(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Zg(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Jg(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Kg(t,e,i,n){for(var r=0,s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}Eg.deviation=function(t,e,i,n){var r=e&&e.length,s=r?e[0]*i:t.length,o=Math.abs(Kg(t,0,s,i));if(r)for(var a=0,c=e.length;a<c;a++){var h=e[a]*i,l=a<c-1?e[a+1]*i:t.length;o-=Math.abs(Kg(t,h,l,i))}var u=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,p=n[a+1]*i,f=n[a+2]*i;u+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},Eg.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[r][s][o]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i},Tg.default=Cg;function Qg(t,e){return t<e?-1:t>e?1:0}var t_=xp(Object.freeze({__proto__:null,default:class{constructor(t=[],e=Qg){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,n=e[t];for(;t>0;){const r=t-1>>1,s=e[r];if(i(n,s)>=0)break;e[t]=s,t=r}e[t]=n}_down(t){const{data:e,compare:i}=this,n=this.length>>1,r=e[t];for(;t<n;){let n=1+(t<<1),s=e[n];const o=n+1;if(o<this.length&&i(e[o],s)<0&&(n=o,s=e[o]),i(s,r)>=0)break;e[t]=s,t=n}e[t]=r}}}));t_.default&&(t_=t_.default);var e_=n_,i_=n_;function n_(t,e,i){var n,r,s,o;e=e||1;for(var a=0;a<t[0].length;a++){var c=t[0][a];(!a||c[0]<n)&&(n=c[0]),(!a||c[1]<r)&&(r=c[1]),(!a||c[0]>s)&&(s=c[0]),(!a||c[1]>o)&&(o=c[1])}var h=s-n,l=o-r,u=Math.min(h,l),d=u/2;if(0===u){var p=[n,r];return p.distance=0,p}for(var f=new t_(void 0,r_),m=n;m<s;m+=u)for(var g=r;g<o;g+=u)f.push(new s_(m+d,g+d,d,t));var _=function(t){for(var e=0,i=0,n=0,r=t[0],s=0,o=r.length,a=o-1;s<o;a=s++){var c=r[s],h=r[a],l=c[0]*h[1]-h[0]*c[1];i+=(c[0]+h[0])*l,n+=(c[1]+h[1])*l,e+=3*l}return 0===e?new s_(r[0][0],r[0][1],0,t):new s_(i/e,n/e,0,t)}(t),v=new s_(n+h/2,r+l/2,0,t);v.d>_.d&&(_=v);for(var y=f.length;f.length;){var b=f.pop();b.d>_.d&&(_=b,i&&console.log("found best %d after %d probes",Math.round(1e4*b.d)/1e4,y)),b.max-_.d<=e||(d=b.h/2,f.push(new s_(b.x-d,b.y-d,d,t)),f.push(new s_(b.x+d,b.y-d,d,t)),f.push(new s_(b.x-d,b.y+d,d,t)),f.push(new s_(b.x+d,b.y+d,d,t)),y+=4)}i&&(console.log("num probes: "+y),console.log("best distance: "+_.d));var x=[_.x,_.y];return x.distance=_.d,x}function r_(t,e){return e.max-t.max}function s_(t,e,i,n){this.x=t,this.y=e,this.h=i,this.d=function(t,e,i){for(var n=!1,r=1/0,s=0;s<i.length;s++)for(var o=i[s],a=0,c=o.length,h=c-1;a<c;h=a++){var l=o[a],u=o[h];l[1]>e!=u[1]>e&&t<(u[0]-l[0])*(e-l[1])/(u[1]-l[1])+l[0]&&(n=!n),r=Math.min(r,o_(t,e,l,u))}return 0===r?0:(n?1:-1)*Math.sqrt(r)}(t,e,n),this.max=this.d+this.h*Math.SQRT2}function o_(t,e,i,n){var r=i[0],s=i[1],o=n[0]-r,a=n[1]-s;if(0!==o||0!==a){var c=((t-r)*o+(e-s)*a)/(o*o+a*a);c>1?(r=n[0],s=n[1]):c>0&&(r+=o*c,s+=a*c)}return(o=t-r)*o+(a=e-s)*a}function a_(t,e){return t>e?1:t<e?-1:0}e_.default=i_;class c_{constructor(t=a_,e=!1){this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!e}rotateLeft(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e}rotateRight(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e}_splay(t){for(;t.parent;){var e=t.parent;e.parent?e.left===t&&e.parent.left===e?(this.rotateRight(e.parent),this.rotateRight(e)):e.right===t&&e.parent.right===e?(this.rotateLeft(e.parent),this.rotateLeft(e)):e.left===t&&e.parent.right===e?(this.rotateRight(e),this.rotateLeft(e)):(this.rotateLeft(e),this.rotateRight(e)):e.left===t?this.rotateRight(e):this.rotateLeft(e)}}splay(t){for(var e,i,n,r,s;t.parent;)(i=(e=t.parent).parent)&&i.parent?((n=i.parent).left===i?n.left=t:n.right=t,t.parent=n):(t.parent=null,this._root=t),r=t.left,s=t.right,t===e.left?(i&&(i.left===e?(e.right?(i.left=e.right,i.left.parent=i):i.left=null,e.right=i,i.parent=e):(r?(i.right=r,r.parent=i):i.right=null,t.left=i,i.parent=t)),s?(e.left=s,s.parent=e):e.left=null,t.right=e,e.parent=t):(i&&(i.right===e?(e.left?(i.right=e.left,i.right.parent=i):i.right=null,e.left=i,i.parent=e):(s?(i.left=s,s.parent=i):i.left=null,t.right=i,i.parent=t)),r?(e.right=r,r.parent=e):e.right=null,t.left=e,e.parent=t)}replace(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)}minNode(t=this._root){if(t)for(;t.left;)t=t.left;return t}maxNode(t=this._root){if(t)for(;t.right;)t=t.right;return t}insert(t,e){var i=this._root,n=null,r=this._compare;if(this._noDuplicates)for(;i;){if(n=i,0===r(i.key,t))return;i=r(i.key,t)<0?i.right:i.left}else for(;i;)n=i,i=r(i.key,t)<0?i.right:i.left;return i={key:t,data:e,left:null,right:null,parent:n},n?r(n.key,i.key)<0?n.right=i:n.left=i:this._root=i,this.splay(i),this._size++,i}find(t){for(var e=this._root,i=this._compare;e;){var n=i(e.key,t);if(n<0)e=e.right;else{if(!(n>0))return e;e=e.left}}return null}contains(t){for(var e=this._root,i=this._compare;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1}remove(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var i=this.minNode(e.right);i.parent!==e&&(this.replace(i,i.right),i.right=e.right,i.right.parent=i),this.replace(e,i),i.left=e.left,i.left.parent=i}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0}removeNode(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0}erase(t){var e=this.find(t);if(e){this.splay(e);var i=e.left,n=e.right,r=null;i&&(i.parent=null,r=this.maxNode(i),this.splay(r),this._root=r),n&&(i?r.right=n:this._root=n,n.parent=r),this._size--}}pop(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e}next(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e}prev(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e}forEach(t){for(var e=this._root,i=[],n=!1,r=0;!n;)e?(i.push(e),e=e.left):i.length>0?(t(e=i.pop(),r++),e=e.right):n=!0;return this}range(t,e,i,n){const r=[],s=this._compare;let o,a=this._root;for(;0!==r.length||a;)if(a)r.push(a),a=a.left;else{if(a=r.pop(),o=s(a.key,e),o>0)break;if(s(a.key,t)>=0&&i.call(n,a))return this;a=a.right}return this}keys(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.key),t=t.right):n=!0;return i}values(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.data),t=t.right):n=!0;return i}at(t){for(var e=this._root,i=[],n=!1,r=0;!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null}load(t=[],e=[],i=!1){if(0!==this._size)throw new Error("bulk-load: tree is not empty");const n=t.length;return i&&l_(t,e,0,n-1,this._compare),this._root=h_(null,t,e,0,n),this._size=n,this}min(){var t=this.minNode(this._root);return t?t.key:null}max(){var t=this.maxNode(this._root);return t?t.key:null}isEmpty(){return null===this._root}get size(){return this._size}static createTree(t,e,i,n,r){return new c_(i,r).load(t,e,n)}}function h_(t,e,i,n,r){const s=r-n;if(s>0){const o=n+Math.floor(s/2),a={key:e[o],data:i[o],parent:t};return a.left=h_(a,e,i,n,o),a.right=h_(a,e,i,o+1,r),a}return null}function l_(t,e,i,n,r){if(i>=n)return;const s=t[i+n>>1];let o=i-1,a=n+1;for(;;){do{o++}while(r(t[o],s)<0);do{a--}while(r(t[a],s)>0);if(o>=a)break;let i=t[o];t[o]=t[a],t[a]=i,i=e[o],e[o]=e[a],e[a]=i}l_(t,e,i,a,r),l_(t,e,a+1,n,r)}function u_(t,e,i){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!d_(e,i)||e.isVertical()?e.prevInResult:e));let n=d_(t,i);t.resultTransition=n?function(t,e){let i,n=!t.inOut,r=!t.otherInOut;switch(e){case 0:i=n&&r;break;case 1:i=n||r;break;case 3:i=n^r;break;case 2:i=t.isSubject?n&&!r:r&&!n}return i?1:-1}(t,i):0}function d_(t,e){switch(t.type){case 0:switch(e){case 0:return!t.otherInOut;case 1:return t.otherInOut;case 2:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case 3:return!0}break;case 2:return 0===e||1===e;case 3:return 2===e;case 1:return!1}return!1}class p_{constructor(t,e,i,n,r){this.left=e,this.point=t,this.otherEvent=i,this.isSubject=n,this.type=r||0,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0}isBelow(t){const e=this.point,i=this.otherEvent.point;return this.left?(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])>0:(i[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(i[1]-t[1])>0}isAbove(t){return!this.isBelow(t)}isVertical(){return this.point[0]===this.otherEvent.point[0]}get inResult(){return 0!==this.resultTransition}clone(){const t=new p_(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.contourId=this.contourId,t.resultTransition=this.resultTransition,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t}}function f_(t,e){return t[0]===e[0]&&t[1]===e[1]}const m_=134217729;function g_(t,e,i,n,r){let s,o,a,c,h=e[0],l=n[0],u=0,d=0;l>h==l>-h?(s=h,h=e[++u]):(s=l,l=n[++d]);let p=0;if(u<t&&d<i)for(l>h==l>-h?(o=h+s,a=s-(o-h),h=e[++u]):(o=l+s,a=s-(o-l),l=n[++d]),s=o,0!==a&&(r[p++]=a);u<t&&d<i;)l>h==l>-h?(o=s+h,c=o-s,a=s-(o-c)+(h-c),h=e[++u]):(o=s+l,c=o-s,a=s-(o-c)+(l-c),l=n[++d]),s=o,0!==a&&(r[p++]=a);for(;u<t;)o=s+h,c=o-s,a=s-(o-c)+(h-c),h=e[++u],s=o,0!==a&&(r[p++]=a);for(;d<i;)o=s+l,c=o-s,a=s-(o-c)+(l-c),l=n[++d],s=o,0!==a&&(r[p++]=a);return 0===s&&0!==p||(r[p++]=s),p}function __(t){return new Float64Array(t)}const v_=__(4),y_=__(8),b_=__(12),x_=__(16),w_=__(4);function S_(t,e,i,n,r,s){const o=(e-s)*(i-r),a=(t-r)*(n-s),c=o-a;if(0===o||0===a||o>0!=a>0)return c;const h=Math.abs(o+a);return Math.abs(c)>=33306690738754716e-32*h?c:-function(t,e,i,n,r,s,o){let a,c,h,l,u,d,p,f,m,g,_,v,y,b,x,w,S,M;const T=t-r,C=i-r,E=e-s,I=n-s;b=T*I,d=m_*T,p=d-(d-T),f=T-p,d=m_*I,m=d-(d-I),g=I-m,x=f*g-(b-p*m-f*m-p*g),w=E*C,d=m_*E,p=d-(d-E),f=E-p,d=m_*C,m=d-(d-C),g=C-m,S=f*g-(w-p*m-f*m-p*g),_=x-S,u=x-_,v_[0]=x-(_+u)+(u-S),v=b+_,u=v-b,y=b-(v-u)+(_-u),_=y-w,u=y-_,v_[1]=y-(_+u)+(u-w),M=v+_,u=M-v,v_[2]=v-(M-u)+(_-u),v_[3]=M;let A=function(t,e){let i=e[0];for(let n=1;n<t;n++)i+=e[n];return i}(4,v_),P=22204460492503146e-32*o;if(A>=P||-A>=P)return A;if(u=t-T,a=t-(T+u)+(u-r),u=i-C,h=i-(C+u)+(u-r),u=e-E,c=e-(E+u)+(u-s),u=n-I,l=n-(I+u)+(u-s),0===a&&0===c&&0===h&&0===l)return A;if(P=11093356479670487e-47*o+33306690738754706e-32*Math.abs(A),A+=T*l+I*a-(E*h+C*c),A>=P||-A>=P)return A;b=a*I,d=m_*a,p=d-(d-a),f=a-p,d=m_*I,m=d-(d-I),g=I-m,x=f*g-(b-p*m-f*m-p*g),w=c*C,d=m_*c,p=d-(d-c),f=c-p,d=m_*C,m=d-(d-C),g=C-m,S=f*g-(w-p*m-f*m-p*g),_=x-S,u=x-_,w_[0]=x-(_+u)+(u-S),v=b+_,u=v-b,y=b-(v-u)+(_-u),_=y-w,u=y-_,w_[1]=y-(_+u)+(u-w),M=v+_,u=M-v,w_[2]=v-(M-u)+(_-u),w_[3]=M;const R=g_(4,v_,4,w_,y_);b=T*l,d=m_*T,p=d-(d-T),f=T-p,d=m_*l,m=d-(d-l),g=l-m,x=f*g-(b-p*m-f*m-p*g),w=E*h,d=m_*E,p=d-(d-E),f=E-p,d=m_*h,m=d-(d-h),g=h-m,S=f*g-(w-p*m-f*m-p*g),_=x-S,u=x-_,w_[0]=x-(_+u)+(u-S),v=b+_,u=v-b,y=b-(v-u)+(_-u),_=y-w,u=y-_,w_[1]=y-(_+u)+(u-w),M=v+_,u=M-v,w_[2]=v-(M-u)+(_-u),w_[3]=M;const L=g_(R,y_,4,w_,b_);b=a*l,d=m_*a,p=d-(d-a),f=a-p,d=m_*l,m=d-(d-l),g=l-m,x=f*g-(b-p*m-f*m-p*g),w=c*h,d=m_*c,p=d-(d-c),f=c-p,d=m_*h,m=d-(d-h),g=h-m,S=f*g-(w-p*m-f*m-p*g),_=x-S,u=x-_,w_[0]=x-(_+u)+(u-S),v=b+_,u=v-b,y=b-(v-u)+(_-u),_=y-w,u=y-_,w_[1]=y-(_+u)+(u-w),M=v+_,u=M-v,w_[2]=v-(M-u)+(_-u),w_[3]=M;const O=g_(L,b_,4,w_,x_);return x_[O-1]}(t,e,i,n,r,s,h)}function M_(t,e,i){const n=S_(t[0],t[1],e[0],e[1],i[0],i[1]);return n>0?-1:n<0?1:0}function T_(t,e){const i=t.point,n=e.point;return i[0]>n[0]?1:i[0]<n[0]?-1:i[1]!==n[1]?i[1]>n[1]?1:-1:function(t,e,i,n){if(t.left!==e.left)return t.left?1:-1;if(0!==M_(i,t.otherEvent.point,e.otherEvent.point))return t.isBelow(e.otherEvent.point)?-1:1;return!t.isSubject&&e.isSubject?1:-1}(t,e,i)}function C_(t,e,i){const n=new p_(e,!1,t,t.isSubject),r=new p_(e,!0,t.otherEvent,t.isSubject);return f_(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),n.contourId=r.contourId=t.contourId,T_(r,t.otherEvent)>0&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=n,i.push(r),i.push(n),i}function E_(t,e){return t[0]*e[1]-t[1]*e[0]}function I_(t,e){return t[0]*e[0]+t[1]*e[1]}function A_(t,e,i){const n=function(t,e,i,n,r){const s=[e[0]-t[0],e[1]-t[1]],o=[n[0]-i[0],n[1]-i[1]];function a(t,e,i){return[t[0]+e*i[0],t[1]+e*i[1]]}const c=[i[0]-t[0],i[1]-t[1]];let h=E_(s,o),l=h*h;const u=I_(s,s);if(l>0){const e=E_(c,o)/h;if(e<0||e>1)return null;const n=E_(c,s)/h;return n<0||n>1?null:0===e||1===e?r?null:[a(t,e,s)]:0===n||1===n?r?null:[a(i,n,o)]:[a(t,e,s)]}if(h=E_(c,s),l=h*h,l>0)return null;const d=I_(s,c)/u,p=d+I_(s,o)/u,f=Math.min(d,p),m=Math.max(d,p);return f<=1&&m>=0?1===f?r?null:[a(t,f>0?f:0,s)]:0===m?r?null:[a(t,m<1?m:1,s)]:r&&0===f&&1===m?null:[a(t,f>0?f:0,s),a(t,m<1?m:1,s)]:null}(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=n?n.length:0;if(0===r)return 0;if(1===r&&(f_(t.point,e.point)||f_(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return f_(t.point,n[0])||f_(t.otherEvent.point,n[0])||C_(t,n[0],i),f_(e.point,n[0])||f_(e.otherEvent.point,n[0])||C_(e,n[0],i),1;const s=[];let o=!1,a=!1;return f_(t.point,e.point)?o=!0:1===T_(t,e)?s.push(e,t):s.push(t,e),f_(t.otherEvent.point,e.otherEvent.point)?a=!0:1===T_(t.otherEvent,e.otherEvent)?s.push(e.otherEvent,t.otherEvent):s.push(t.otherEvent,e.otherEvent),o&&a||o?(e.type=1,t.type=e.inOut===t.inOut?2:3,o&&!a&&C_(s[1].otherEvent,s[0].point,i),2):a?(C_(s[0],s[1].point,i),3):s[0]!==s[3].otherEvent?(C_(s[0],s[1].point,i),C_(s[1],s[2].point,i),3):(C_(s[0],s[1].point,i),C_(s[3].otherEvent,s[2].point,i),3)}function P_(t,e){if(t===e)return 0;if(0!==M_(t.point,t.otherEvent.point,e.point)||0!==M_(t.point,t.otherEvent.point,e.otherEvent.point))return f_(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===T_(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;{let i=t.point,n=e.point;if(i[0]===n[0]&&i[1]===n[1])return i=t.otherEvent.point,n=e.otherEvent.point,i[0]===n[0]&&i[1]===n[1]?0:t.contourId>e.contourId?1:-1}return 1===T_(t,e)?1:-1}class R_{constructor(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null}isExterior(){return null==this.holeOf}}function L_(t,e,i,n){let r,s=t+1,o=e[t].point;const a=e.length;for(s<a&&(r=e[s].point);s<a&&r[0]===o[0]&&r[1]===o[1];){if(!i[s])return s;s++,r=e[s].point}for(s=t-1;i[s]&&s>n;)s--;return s}function O_(t,e,i){const n=new R_;if(null!=t.prevInResult){const r=t.prevInResult,s=r.outputContourId;if(r.resultTransition>0){const t=e[s];if(null!=t.holeOf){const r=t.holeOf;e[r].holeIds.push(i),n.holeOf=r,n.depth=e[s].depth}else e[s].holeIds.push(i),n.holeOf=s,n.depth=e[s].depth+1}else n.holeOf=null,n.depth=e[s].depth}else n.holeOf=null,n.depth=0;return n}function N_(t){let e,i;const n=function(t){let e,i,n,r;const s=[];for(i=0,n=t.length;i<n;i++)e=t[i],(e.left&&e.inResult||!e.left&&e.otherEvent.inResult)&&s.push(e);let o=!1;for(;!o;)for(o=!0,i=0,n=s.length;i<n;i++)i+1<n&&1===T_(s[i],s[i+1])&&(r=s[i],s[i]=s[i+1],s[i+1]=r,o=!1);for(i=0,n=s.length;i<n;i++)e=s[i],e.otherPos=i;for(i=0,n=s.length;i<n;i++)e=s[i],e.left||(r=e.otherPos,e.otherPos=e.otherEvent.otherPos,e.otherEvent.otherPos=r);return s}(t),r={},s=[];for(e=0,i=n.length;e<i;e++){if(r[e])continue;const t=s.length,i=O_(n[e],s,t),o=e=>{r[e]=!0,n[e].outputContourId=t};let a=e,c=e;const h=n[e].point;for(i.points.push(h);o(a),a=n[a].otherPos,o(a),i.points.push(n[a].point),a=L_(a,n,r,c),a!=c;);s.push(i)}return s}var D_=k_,$_=k_;function k_(t,e){if(!(this instanceof k_))return new k_(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||z_,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}function z_(t,e){return t<e?-1:t>e?1:0}k_.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var r=t-1>>1,s=e[r];if(i(n,s)>=0)break;e[t]=s,t=r}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length>>1,r=e[t];t<n;){var s=1+(t<<1),o=s+1,a=e[s];if(o<this.length&&i(e[o],a)<0&&(s=o,a=e[o]),i(a,r)>=0)break;e[t]=a,t=s}e[t]=r}},D_.default=$_;const F_=Math.max,B_=Math.min;let j_=0;function H_(t,e,i,n,r,s){let o,a,c,h,l,u;for(o=0,a=t.length-1;o<a;o++){if(c=t[o],h=t[o+1],l=new p_(c,!1,void 0,e),u=new p_(h,!1,l,e),l.otherEvent=u,c[0]===h[0]&&c[1]===h[1])continue;l.contourId=u.contourId=i,s||(l.isExteriorRing=!1,u.isExteriorRing=!1),T_(l,u)>0?u.left=!0:l.left=!0;const a=c[0],d=c[1];r[0]=B_(r[0],a),r[1]=B_(r[1],d),r[2]=F_(r[2],a),r[3]=F_(r[3],d),n.push(l),n.push(u)}}const U_=[];function V_(t,e,i){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);let n=function(t,e,i){let n=null;return t.length*e.length==0&&(0===i?n=U_:2===i?n=t:1!==i&&3!==i||(n=0===t.length?e:t)),n}(t,e,i);if(n)return n===U_?null:n;const r=[1/0,1/0,-1/0,-1/0],s=[1/0,1/0,-1/0,-1/0],o=function(t,e,i,n,r){const s=new D_(null,T_);let o,a,c,h,l,u;for(c=0,h=t.length;c<h;c++)for(o=t[c],l=0,u=o.length;l<u;l++)a=0===l,a&&j_++,H_(o[l],!0,j_,s,i,a);for(c=0,h=e.length;c<h;c++)for(o=e[c],l=0,u=o.length;l<u;l++)a=0===l,2===r&&(a=!1),a&&j_++,H_(o[l],!1,j_,s,n,a);return s}(t,e,r,s,i);if(n=function(t,e,i,n,r){let s=null;return(i[0]>n[2]||n[0]>i[2]||i[1]>n[3]||n[1]>i[3])&&(0===r?s=U_:2===r?s=t:1!==r&&3!==r||(s=t.concat(e))),s}(t,e,r,s,i),n)return n===U_?null:n;const a=N_(function(t,e,i,n,r,s){const o=new c_(P_),a=[],c=Math.min(n[2],r[2]);let h,l,u;for(;0!==t.length;){let e=t.pop();if(a.push(e),0===s&&e.point[0]>c||2===s&&e.point[0]>n[2])break;if(e.left){l=h=o.insert(e),u=o.minNode(),h=h!==u?o.prev(h):null,l=o.next(l);const i=h?h.key:null;let n;if(u_(e,i,s),l&&2===A_(e,l.key,t)&&(u_(e,i,s),u_(e,l.key,s)),h&&2===A_(h.key,e,t)){let t=h;t=t!==u?o.prev(t):null,n=t?t.key:null,u_(i,n,s),u_(e,i,s)}}else e=e.otherEvent,l=h=o.find(e),h&&l&&(h=h!==u?o.prev(h):null,l=o.next(l),o.remove(e),l&&h&&A_(h.key,l.key,t))}return a}(o,0,0,r,s,i)),c=[];for(let t=0;t<a.length;t++){let e=a[t];if(e.isExterior()){let t=[e.points];for(let i=0;i<e.holeIds.length;i++){let n=e.holeIds[i];t.push(a[n].points)}c.push(t)}}return c}class G_ extends xg{constructor(){super(),this._subsampleThreshold=.005}_getPoleOfInaccessibility2d(t){return e_([t],.03)}_project(t,e){const i=this._createCamera(e.upVector().toArray(),e.unprojectSfM([0,0],0),e.unprojectSfM([0,0],10));return this._deunproject(t,e,i)}_subsample(t,e=this._subsampleThreshold){const i=[],n=t.length;for(let r=0;r<n;r++){const s=t[r],o=t[(r+1)%n];i.push(s);const a=Math.sqrt(Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2)),c=Math.floor(a/e),h=1/(c+1);for(let t=1;t<=c;t++){const e=t*h,n=[(1-e)*s[0]+e*o[0],(1-e)*s[1]+e*o[1]];i.push(n)}}return i}_triangulate(t,e,i,n){let r=[t.slice(0,-1)];for(let t of null!=i?i:[])r.push(t.slice(0,-1));let s=e.slice(0,-1);for(let t of null!=n?n:[])s=s.concat(t.slice(0,-1));let o=Tg.flatten(r),a=Tg(o.vertices,o.holes,o.dimensions),c=[];for(let t=0;t<a.length;++t){let e=s[a[t]];c.push(e[0]),c.push(e[1]),c.push(e[2])}return c}_triangulateSpherical(t,e,i){const n=[],r=1e-9;for(let s=0;s<3;s++)for(let o=0;o<3;o++){const a=s/3+(0===s?-1e-9:r),c=o/3+(0===o?-1e-9:r),h=(s+1)/3+r,l=(o+1)/3+r,u=[[a,c],[a,l],[h,l],[h,c],[a,c]],d=[(2*s+1)/6,(2*o+1)/6];n.push(...this._triangulateSubarea(t,e,u,d,i))}return n}_unproject(t,e,i=200){return t.map((t=>e.unprojectBasic(t,i)))}_createCamera(t,e,i){const n=new Ns;return n.up.copy((new fn).fromArray(t)),n.position.copy((new fn).fromArray(e)),n.lookAt((new fn).fromArray(i)),n.updateMatrix(),n.updateMatrixWorld(!0),n}_deunproject(t,e,i){return t.map((t=>{const n=e.unprojectBasic(t,1e4),r=new fn(n[0],n[1],n[2]).applyMatrix4(i.matrixWorldInverse);return[r.x/r.z,r.y/r.z]}))}_triangulateSubarea(t,e,i,n,r){const s=V_([t,...e],[i],0);if(!s)return[];const o=[],a=this._subsampleThreshold,c=this._createCamera(r.upVector().toArray(),r.unprojectSfM([0,0],0),r.unprojectBasic(n,10));for(const t of s){const e=this._subsample(t[0],a),i=this._deunproject(e,r,c),n=this._unproject(e,r),s=[],h=[];for(let e=1;e<t.length;e++){let i=this._subsample(t[e],a);const n=this._deunproject(i,r,c),o=this._unproject(i,r);s.push(n),h.push(o)}o.push(...this._triangulate(i,n,s,h))}return o}}class q_ extends G_{constructor(t){if(super(),4!==t.length)throw new wg("Rectangle needs to have four values.");if(t[1]>t[3])throw new wg("Basic Y coordinates values can not be inverted.");for(let e of t)if(e<0||e>1)throw new wg("Basic coordinates must be on the interval [0, 1].");this._anchorIndex=void 0,this._rect=t.slice(0,4),this._inverted=this._rect[0]>this._rect[2]}get anchorIndex(){return this._anchorIndex}get inverted(){return this._inverted}get rect(){return this._rect}initializeAnchorIndexing(t){if(void 0!==this._anchorIndex)throw new wg("Anchor indexing is already initialized.");if(t<0||t>3)throw new wg(`Invalid anchor index: ${t}.`);this._anchorIndex=void 0===t?0:t}terminateAnchorIndexing(){this._anchorIndex=void 0}setOppositeVertex2d(t,e){if(void 0===this._anchorIndex)throw new wg("Anchor indexing needs to be initialized.");const i=[Math.max(0,Math.min(1,t[0])),Math.max(0,Math.min(1,t[1]))],n=this._rect.slice(),r=0===this._anchorIndex?[n[0],n[3]]:1===this._anchorIndex?[n[0],n[1]]:2===this._anchorIndex?[n[2],n[1]]:[n[2],n[3]];if(dd(e.cameraType)){const t=this._anchorIndex<2?i[0]-n[2]:i[0]-n[0];!this._inverted&&this._anchorIndex<2&&i[0]<.25&&n[2]>.75&&t<-.5||!this._inverted&&this._anchorIndex>=2&&i[0]<.25&&n[2]>.75&&t<-.5?(this._inverted=!0,this._anchorIndex=r[1]>i[1]?0:1):this._inverted&&this._anchorIndex>=2&&i[0]<.25&&n[0]>.75&&t<-.5?(this._inverted=!1,this._anchorIndex=r[0]>i[0]?r[1]>i[1]?3:2:r[1]>i[1]?0:1):!this._inverted&&this._anchorIndex>=2&&i[0]>.75&&n[0]<.25&&t>.5||!this._inverted&&this._anchorIndex<2&&i[0]>.75&&n[0]<.25&&t>.5?(this._inverted=!0,this._anchorIndex=r[1]>i[1]?3:2):this._inverted&&this._anchorIndex<2&&i[0]>.75&&n[2]<.25&&t>.5?(this._inverted=!1,this._anchorIndex=r[0]>i[0]?r[1]>i[1]?3:2:r[1]>i[1]?0:1):this._inverted&&this._anchorIndex<2&&i[0]>n[0]?(this._inverted=!1,this._anchorIndex=r[1]>i[1]?0:1):this._inverted&&this._anchorIndex>=2&&i[0]<n[2]?(this._inverted=!1,this._anchorIndex=r[1]>i[1]?3:2):this._inverted?this._anchorIndex<2?this._anchorIndex=r[1]>i[1]?0:1:this._anchorIndex=r[1]>i[1]?3:2:this._anchorIndex=r[0]<=i[0]&&r[1]>i[1]?0:r[0]<=i[0]&&r[1]<=i[1]?1:r[0]>i[0]&&r[1]<=i[1]?2:3;const e=[];0===this._anchorIndex?(e[0]=r[0],e[1]=i[1],e[2]=i[0],e[3]=r[1]):1===this._anchorIndex?(e[0]=r[0],e[1]=r[1],e[2]=i[0],e[3]=i[1]):2===this._anchorIndex?(e[0]=i[0],e[1]=r[1],e[2]=r[0],e[3]=i[1]):(e[0]=i[0],e[1]=i[1],e[2]=r[0],e[3]=r[1]),(!this._inverted&&e[0]>e[2]||this._inverted&&e[0]<e[2])&&(e[0]=n[0],e[2]=n[2]),e[1]>e[3]&&(e[1]=n[1],e[3]=n[3]),this._rect[0]=e[0],this._rect[1]=e[1],this._rect[2]=e[2],this._rect[3]=e[3]}else{this._anchorIndex=r[0]<=i[0]&&r[1]>i[1]?0:r[0]<=i[0]&&r[1]<=i[1]?1:r[0]>i[0]&&r[1]<=i[1]?2:3;const t=[];0===this._anchorIndex?(t[0]=r[0],t[1]=i[1],t[2]=i[0],t[3]=r[1]):1===this._anchorIndex?(t[0]=r[0],t[1]=r[1],t[2]=i[0],t[3]=i[1]):2===this._anchorIndex?(t[0]=i[0],t[1]=r[1],t[2]=r[0],t[3]=i[1]):(t[0]=i[0],t[1]=i[1],t[2]=r[0],t[3]=r[1]),t[0]>t[2]&&(t[0]=n[0],t[2]=n[2]),t[1]>t[3]&&(t[1]=n[1],t[3]=n[3]),this._rect[0]=t[0],this._rect[1]=t[1],this._rect[2]=t[2],this._rect[3]=t[3]}this._notifyChanged$.next(this)}setVertex2d(t,e,i){let n=this._rect.slice(),r=[Math.max(0,Math.min(1,e[0])),Math.max(0,Math.min(1,e[1]))],s=[];if(0===t?(s[0]=r[0],s[1]=n[1],s[2]=n[2],s[3]=r[1]):1===t?(s[0]=r[0],s[1]=r[1],s[2]=n[2],s[3]=n[3]):2===t?(s[0]=n[0],s[1]=r[1],s[2]=r[0],s[3]=n[3]):3===t&&(s[0]=n[0],s[1]=n[1],s[2]=r[0],s[3]=r[1]),dd(i.cameraType)){let e=t<2&&r[0]>.75&&n[0]<.25||t>=2&&this._inverted&&r[0]>.75&&n[2]<.25,i=t<2&&this._inverted&&r[0]<.25&&n[0]>.75||t>=2&&r[0]<.25&&n[2]>.75;e||i?this._inverted=!this._inverted:(s[0]-n[0]<-.25&&(s[0]=n[0]),s[2]-n[2]>.25&&(s[2]=n[2])),(!this._inverted&&s[0]>s[2]||this._inverted&&s[0]<s[2])&&(s[0]=n[0],s[2]=n[2])}else s[0]>s[2]&&(s[0]=n[0],s[2]=n[2]);s[1]>s[3]&&(s[1]=n[1],s[3]=n[3]),this._rect[0]=s[0],this._rect[1]=s[1],this._rect[2]=s[2],this._rect[3]=s[3],this._notifyChanged$.next(this)}setCentroid2d(t,e){let i=this._rect.slice(),n=i[0],r=this._inverted?i[2]+1:i[2],s=i[1],o=i[3],a=n+(r-n)/2,c=s+(o-s)/2,h=0;if(dd(e.cameraType))h=this._inverted?t[0]+1-a:t[0]-a;else{let e=-n,i=1-r;h=Math.max(e,Math.min(i,t[0]-a))}let l=-s,u=1-o,d=Math.max(l,Math.min(u,t[1]-c));this._rect[0]=i[0]+h,this._rect[1]=i[1]+d,this._rect[2]=i[2]+h,this._rect[3]=i[3]+d,this._rect[0]<0?(this._rect[0]+=1,this._inverted=!this._inverted):this._rect[0]>1&&(this._rect[0]-=1,this._inverted=!this._inverted),this._rect[2]<0?(this._rect[2]+=1,this._inverted=!this._inverted):this._rect[2]>1&&(this._rect[2]-=1,this._inverted=!this._inverted),this._notifyChanged$.next(this)}getPoints3d(t){return this._getPoints2d().map((e=>t.unprojectBasic(e,200)))}getVertex2d(t){return this._rectToVertices2d(this._rect)[t]}getNonAdjustedVertex2d(t){return this._rectToNonAdjustedVertices2d(this._rect)[t]}getVertex3d(t,e){return e.unprojectBasic(this._rectToVertices2d(this._rect)[t],200)}getVertices2d(){return this._rectToVertices2d(this._rect)}getVertices3d(t){return this._rectToVertices2d(this._rect).map((e=>t.unprojectBasic(e,200)))}getCentroid2d(){const t=this._rect;return[(t[0]+(this._inverted?t[2]+1:t[2]))/2,(t[1]+t[3])/2]}getCentroid3d(t){const e=this.getCentroid2d();return t.unprojectBasic(e,200)}getPoleOfInaccessibility2d(){return this._getPoleOfInaccessibility2d(this._rectToVertices2d(this._rect))}getPoleOfInaccessibility3d(t){let e=this._getPoleOfInaccessibility2d(this._rectToVertices2d(this._rect));return t.unprojectBasic(e,200)}getTriangles3d(t){return dd(t.cameraType)?[]:this._triangulate(this._project(this._getPoints2d(),t),this.getPoints3d(t))}validate(t){let e=this._rect;return!(!this._inverted&&t[0]<e[0]||t[0]-e[2]>.25||t[1]<e[1])}_getPoints2d(){let t=this._rectToVertices2d(this._rect),e=t.length-1,i=[];for(let n=0;n<e;++n){let e=t[n][0],r=t[n][1],s=(t[n+1][0]-e)/9,o=(t[n+1][1]-r)/9;for(let t=0;t<10;++t){let n=[e+t*s,r+t*o];i.push(n)}}return i}_rectToVertices2d(t){return[[t[0],t[3]],[t[0],t[1]],[this._inverted?t[2]+1:t[2],t[1]],[this._inverted?t[2]+1:t[2],t[3]],[t[0],t[3]]]}_rectToNonAdjustedVertices2d(t){return[[t[0],t[3]],[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]]}}class W_ extends Mg{constructor(t,e,i,n){super(t,i,n),this._options={color:null==e.color?16777215:e.color,indicateCompleter:null==e.indicateCompleter||e.indicateCompleter},this._rectGeometry=new q_(this._geometry.getRect2d(i)),this._createGlObjects()}create(){this._geometry.points.length<3||(this._geometry.removePoint2d(this._geometry.points.length-1),this._created$.next(this))}dispose(){super.dispose(),this._disposeObjects()}getDOMObjects(t,e){const i={offsetHeight:e.height,offsetWidth:e.width},n=[],r=this._geometry.getPoints2d(),s=r.length;for(let e=0;e<s-1;e++){const o=e,[a,c]=r[e],h=this._viewportCoords.basicToCanvasSafe(a,c,i,this._transform,t);if(!h)continue;const l=t=>{t.stopPropagation(),this._aborted$.next(this)},u=t=>{t.stopPropagation(),this._geometry.removePoint2d(o)},d=this._canvasToTransform(h),p={onclick:0===e&&s<3?l:u,style:{transform:d}};n.push(jf.h("div.mapillary-tag-interactor",p,[]));const f={style:{background:this._colorToBackground(this._options.color),transform:d}};n.push(jf.h("div.mapillary-tag-vertex",f,[]))}if(s>2&&!0===this._options.indicateCompleter){const[e,r]=this._geometry.getCentroid2d(this._transform),s=this._viewportCoords.basicToCanvasSafe(e,r,i,this._transform,t);if(s){const t=t=>{t.stopPropagation(),this._geometry.removePoint2d(this._geometry.points.length-1),this._created$.next(this)},e=this._canvasToTransform(s),i={onclick:t,style:{transform:e}};n.push(jf.h("div.mapillary-tag-completer.mapillary-tag-larger",i,[]));const r={style:{background:this._colorToBackground(this._options.color),transform:e}};n.push(jf.h("div.mapillary-tag-vertex.mapillary-tag-larger",r,[]));const o={style:{transform:e}};n.push(jf.h("div.mapillary-tag-dot",o,[]))}}return n}_onGeometryChanged(){this._disposeObjects(),this._rectGeometry=new q_(this._geometry.getRect2d(this._transform)),this._createGlObjects()}_createGlObjects(){this._glObjects=[];const t=this._rectGeometry.getPoints3d(this._transform);this._outline=this._createOutine(t,this._options.color),this._glObjects.push(this._outline)}_disposeObjects(){this._disposeLine(this._outline),this._outline=null,this._glObjects=null}}class X_ extends G_{constructor(t,e){super();let i=t.length;if(i<3)throw new wg("A polygon must have three or more positions.");if(t[0][0]!==t[i-1][0]||t[0][1]!==t[i-1][1])throw new wg("First and last positions must be equivalent.");this._polygon=[];for(let e of t){if(e[0]<0||e[0]>1||e[1]<0||e[1]>1)throw new wg("Basic coordinates of polygon must be on the interval [0, 1].");this._polygon.push(e.slice())}if(this._holes=[],null!=e)for(let t=0;t<e.length;t++){let i=e[t],n=i.length;if(n<3)throw new wg("A polygon hole must have three or more positions.");if(i[0][0]!==i[n-1][0]||i[0][1]!==i[n-1][1])throw new wg("First and last positions of hole must be equivalent.");this._holes.push([]);for(let e of i){if(e[0]<0||e[0]>1||e[1]<0||e[1]>1)throw new wg("Basic coordinates of hole must be on the interval [0, 1].");this._holes[t].push(e.slice())}}}get polygon(){return this._polygon}get holes(){return this._holes}addVertex2d(t){let e=[Math.max(0,Math.min(1,t[0])),Math.max(0,Math.min(1,t[1]))];this._polygon.splice(this._polygon.length-1,0,e),this._notifyChanged$.next(this)}getVertex2d(t){return this._polygon[t].slice()}removeVertex2d(t){if(t<0||t>=this._polygon.length||this._polygon.length<4)throw new wg("Index for removed vertex must be valid.");if(t>0&&t<this._polygon.length-1)this._polygon.splice(t,1);else{this._polygon.splice(0,1),this._polygon.pop();let t=this._polygon[0].slice();this._polygon.push(t)}this._notifyChanged$.next(this)}setVertex2d(t,e,i){let n=[Math.max(0,Math.min(1,e[0])),Math.max(0,Math.min(1,e[1]))];0===t||t===this._polygon.length-1?(this._polygon[0]=n.slice(),this._polygon[this._polygon.length-1]=n.slice()):this._polygon[t]=n.slice(),this._notifyChanged$.next(this)}setCentroid2d(t,e){let i=this._polygon.map((t=>t[0])),n=this._polygon.map((t=>t[1])),r=Math.min.apply(Math,i),s=Math.max.apply(Math,i),o=Math.min.apply(Math,n),a=Math.max.apply(Math,n),c=this.getCentroid2d(),h=-r,l=1-s,u=-o,d=1-a,p=Math.max(h,Math.min(l,t[0]-c[0])),f=Math.max(u,Math.min(d,t[1]-c[1]));for(let t of this._polygon)t[0]+=p,t[1]+=f;this._notifyChanged$.next(this)}getPoints3d(t){return this._getPoints3d(this._subsample(this._polygon),t)}getVertex3d(t,e){return e.unprojectBasic(this._polygon[t],200)}getVertices2d(){return this._polygon.slice()}getVertices3d(t){return this._getPoints3d(this._polygon,t)}getHolePoints3d(t){return this._holes.map((e=>this._getPoints3d(this._subsample(e),t)))}getHoleVertices3d(t){return this._holes.map((e=>this._getPoints3d(e,t)))}getCentroid2d(){let t=this._polygon,e=0,i=0,n=0;for(let r=0;r<t.length-1;r++){let s=t[r][0],o=t[r][1],a=t[r+1][0],c=t[r+1][1],h=s*c-a*o;e+=h,i+=(s+a)*h,n+=(o+c)*h}return e/=2,i/=6*e,n/=6*e,[i,n]}getCentroid3d(t){let e=this.getCentroid2d();return t.unprojectBasic(e,200)}get3dDomainTriangles3d(t){return this._triangulate(this._project(this._polygon,t),this.getVertices3d(t),this._holes.map((e=>this._project(e,t))),this.getHoleVertices3d(t))}getTriangles3d(t){if(dd(t.cameraType))return this._triangulateSpherical(this._polygon.slice(),this.holes.slice(),t);const e=this._project(this._subsample(this._polygon),t),i=this.getPoints3d(t),n=this._holes.map((e=>this._project(this._subsample(e),t))),r=this.getHolePoints3d(t);return this._triangulate(e,i,n,r)}getPoleOfInaccessibility2d(){return this._getPoleOfInaccessibility2d(this._polygon.slice())}getPoleOfInaccessibility3d(t){let e=this._getPoleOfInaccessibility2d(this._polygon.slice());return t.unprojectBasic(e,200)}_getPoints3d(t,e){return t.map((t=>e.unprojectBasic(t,200)))}}class Y_ extends Mg{constructor(t,e,i,n){super(t,i,n),this._options={color:null==e.color?16777215:e.color},this._createGlObjects()}create(){if(this._geometry instanceof q_)this._created$.next(this);else if(this._geometry instanceof X_){const t=this._geometry;t.removeVertex2d(t.polygon.length-2),this._created$.next(this)}}dispose(){super.dispose(),this._disposeLine(this._outline),this._disposeObjects()}getDOMObjects(t,e){const i=[],n={offsetHeight:e.height,offsetWidth:e.width},r=t=>{t.stopPropagation(),this._aborted$.next(this)};if(this._geometry instanceof q_){const e=this._geometry.anchorIndex,s=void 0===e?1:e,[o,a]=this._geometry.getVertex2d(s),c=this._viewportCoords.basicToCanvasSafe(o,a,n,this._transform,t);if(null!=c){const t=this._colorToBackground(this._options.color),e=this._canvasToTransform(c),n={style:{background:t,transform:e}},s={onclick:r,style:{transform:e}};i.push(jf.h("div.mapillary-tag-interactor",s,[])),i.push(jf.h("div.mapillary-tag-vertex",n,[]))}}else if(this._geometry instanceof X_){const e=this._geometry,[s,o]=e.getVertex2d(0),a=this._viewportCoords.basicToCanvasSafe(s,o,n,this._transform,t);if(null!=a){const t={onclick:e.polygon.length>4?t=>{t.stopPropagation(),e.removeVertex2d(e.polygon.length-2),this._created$.next(this)}:r,style:{transform:this._canvasToTransform(a)}},n=e.polygon.length>4?"mapillary-tag-completer":"mapillary-tag-interactor";i.push(jf.h("div."+n,t,[]))}if(e.polygon.length>3){const[r,s]=e.getVertex2d(e.polygon.length-3),o=this._viewportCoords.basicToCanvasSafe(r,s,n,this._transform,t);if(null!=o){const t={onclick:t=>{t.stopPropagation(),e.removeVertex2d(e.polygon.length-3)},style:{transform:this._canvasToTransform(o)}};i.push(jf.h("div.mapillary-tag-interactor",t,[]))}}const c=e.polygon.slice();c.splice(-2,2);for(const e of c){const r=this._viewportCoords.basicToCanvasSafe(e[0],e[1],n,this._transform,t);if(null!=r){const t={style:{background:this._colorToBackground(this._options.color),transform:this._canvasToTransform(r)}};i.push(jf.h("div.mapillary-tag-vertex",t,[]))}}}return i}addPoint(t){if(this._geometry instanceof q_){if(!this._geometry.validate(t))return;this._created$.next(this)}else if(this._geometry instanceof X_){this._geometry.addVertex2d(t)}}_onGeometryChanged(){this._disposeLine(this._outline),this._disposeObjects(),this._createGlObjects()}_disposeObjects(){this._outline=null,this._glObjects=[]}_createGlObjects(){const t=this._geometry instanceof q_?this._geometry.getPoints3d(this._transform):this._geometry.getVertices3d(this._transform);this._outline=this._createOutine(t,this._options.color),this._glObjects=[this._outline]}}class Z_{constructor(t,e){this._component=t,this._navigator=e,this._tagOperation$=new T,this._createPoints$=new T,this._createPolygon$=new T,this._createRect$=new T,this._delete$=new T,this._tag$=this._tagOperation$.pipe(Le(((t,e)=>e(t)),null),Ze()),this._replayedTag$=this._tag$.pipe(Ue(1),E()),this._replayedTag$.subscribe(),this._createPoints$.pipe(bi(this._component.configuration$,this._navigator.stateService.currentTransform$),rt((([t,e,i])=>()=>{const n=new Sg([[t[0],t[1]],[t[0],t[1]]]);return new W_(n,{color:e.createColor,indicateCompleter:e.indicatePointsCompleter},i)}))).subscribe(this._tagOperation$),this._createRect$.pipe(bi(this._component.configuration$,this._navigator.stateService.currentTransform$),rt((([t,e,i])=>()=>{const n=new q_([t[0],t[1],t[0],t[1]]);return new Y_(n,{color:e.createColor},i)}))).subscribe(this._tagOperation$),this._createPolygon$.pipe(bi(this._component.configuration$,this._navigator.stateService.currentTransform$),rt((([t,e,i])=>()=>{const n=new X_([[t[0],t[1]],[t[0],t[1]],[t[0],t[1]]]);return new Y_(n,{color:e.createColor},i)}))).subscribe(this._tagOperation$),this._delete$.pipe(rt((()=>()=>null))).subscribe(this._tagOperation$)}get createRect$(){return this._createRect$}get createPolygon$(){return this._createPolygon$}get createPoints$(){return this._createPoints$}get delete$(){return this._delete$}get tag$(){return this._tag$}get replayedTag$(){return this._replayedTag$}}class J_{render(t,e,i,n,r){let s=[];for(const e of t)s=s.concat(e.getDOMObjects(i,n,r));return null!=e&&(s=s.concat(e.getDOMObjects(n,r))),jf.h("div.mapillary-tag-container",{},s)}clear(){return jf.h("div",{},[])}}class K_{constructor(t,e){this._createTag=null,this._needsRender=!1,this._raycaster=e||new Bu,this._scene=t||new Qa,this._objectTags={},this._retrievableObjects=[],this._tags={}}get needsRender(){return this._needsRender}add(t){for(let e of t)e.tag.id in this._tags&&this._remove(e.tag.id),this._add(e);this._needsRender=!0}addCreateTag(t){for(const e of t.glObjects)this._scene.add(e);this._createTag={tag:t,objects:t.glObjects},this._needsRender=!0}clear(){for(const t of Object.keys(this._tags))this._remove(t);this._needsRender=!1}get(t){return this.has(t)?this._tags[t].tag:void 0}has(t){return t in this._tags}hasCreateTag(){return null!=this._createTag}intersectObjects([t,e],i){this._raycaster.setFromCamera(new rn(t,e),i);const n=this._raycaster.intersectObjects(this._retrievableObjects),r=[];for(const t of n)t.object.uuid in this._objectTags&&r.push(this._objectTags[t.object.uuid]);return r}remove(t){for(const e of t)this._remove(e);this._needsRender=!0}removeAll(){for(const t of Object.keys(this._tags))this._remove(t);this._needsRender=!0}removeCreateTag(){if(null!=this._createTag){for(const t of this._createTag.objects)this._scene.remove(t);this._createTag.tag.dispose(),this._createTag=null,this._needsRender=!0}}render(t,e){e.render(this._scene,t),this._needsRender=!1}update(){this._needsRender=!0}updateCreateTagObjects(t){if(this._createTag.tag!==t)throw new Error("Create tags do not have the same reference.");for(let t of this._createTag.objects)this._scene.remove(t);for(const e of t.glObjects)this._scene.add(e);this._createTag.objects=t.glObjects,this._needsRender=!0}updateObjects(t){const e=t.tag.id;if(this._tags[e].tag!==t)throw new Error("Tags do not have the same reference.");const i=this._tags[e];this._removeObjects(i),delete this._tags[e],this._add(t),this._needsRender=!0}_add(t){const e=t.tag.id,i={tag:t,objects:[],retrievableObjects:[]};this._tags[e]=i;for(const e of t.getGLObjects())i.objects.push(e),this._scene.add(e);for(const e of t.getRetrievableObjects())i.retrievableObjects.push(e),this._retrievableObjects.push(e),this._objectTags[e.uuid]=t.tag.id}_remove(t){const e=this._tags[t];this._removeObjects(e),e.tag.dispose(),delete this._tags[t]}_removeObjects(t){for(const e of t.objects)this._scene.remove(e);for(const e of t.retrievableObjects){const t=this._retrievableObjects.indexOf(e);-1!==t&&this._retrievableObjects.splice(t,1)}}}var Q_,tv,ev,iv;t.TagMode=void 0,(Q_=t.TagMode||(t.TagMode={}))[Q_.Default=0]="Default",Q_[Q_.CreatePoint=1]="CreatePoint",Q_[Q_.CreatePoints=2]="CreatePoints",Q_[Q_.CreatePolygon=3]="CreatePolygon",Q_[Q_.CreateRect=4]="CreateRect",Q_[Q_.CreateRectDrag=5]="CreateRectDrag",function(t){t[t.None=0]="None",t[t.Centroid=1]="Centroid",t[t.Vertex=2]="Vertex"}(tv||(tv={}));class nv{constructor(t,e,i){this._tag=t,this._transform=e,this._viewportCoords=i||new Wf,this._glObjectsChanged$=new T,this._interact$=new T}get glObjectsChanged$(){return this._glObjectsChanged$}get interact$(){return this._interact$}get tag(){return this._tag}}class rv extends nv{constructor(t,e){super(t,e),this._geometryChangedSubscription=this._tag.geometry.changed$.subscribe((()=>{this._onGeometryChanged()})),this._changedSubscription=this._tag.changed$.subscribe((()=>{this._onTagChanged()&&this._glObjectsChanged$.next(this)}))}dispose(){this._changedSubscription.unsubscribe(),this._geometryChangedSubscription.unsubscribe()}_colorToCss(t){return"#"+("000000"+t.toString(16)).substr(-6)}_createFill(){let t=this._getTriangles(),e=new Float32Array(t),i=new hs;i.setAttribute("position",new Hr(e,3)),i.computeBoundingSphere();let n=new Fr({side:2,transparent:!0});return this._updateFillMaterial(n),new Es(i,n)}_createLine(t){let e=this._getLinePositions(t),i=new hs;i.setAttribute("position",new Hr(e,3)),i.computeBoundingSphere();let n=new kc;this._updateLineBasicMaterial(n);const r=new Uc(i,n);return r.renderOrder=1,r}_createOutline(){return this._createLine(this._getPoints3d())}_disposeFill(){null!=this._fill&&(this._fill.geometry.dispose(),this._fill.material.dispose(),this._fill=null)}_disposeOutline(){null!=this._outline&&(this._outline.geometry.dispose(),this._outline.material.dispose(),this._outline=null)}_getLinePositions(t){let e=t.length,i=new Float32Array(3*e);for(let n=0;n<e;++n){let e=3*n,r=t[n];i[e+0]=r[0],i[e+1]=r[1],i[e+2]=r[2]}return i}_interact(t,e,i){return n=>{let r=n.offsetX-n.target.offsetWidth/2,s=n.offsetY-n.target.offsetHeight/2;this._interact$.next({cursor:e,offsetX:r,offsetY:s,operation:t,tag:this._tag,vertexIndex:i})}}_updateFillGeometry(){let t=this._getTriangles(),e=new Float32Array(t),i=this._fill.geometry,n=i.getAttribute("position");n.array.length===e.length?(n.set(e),n.needsUpdate=!0):(i.deleteAttribute("position"),i.setAttribute("position",new Hr(e,3))),i.computeBoundingSphere()}_updateLine(t,e){let i=this._getLinePositions(e),n=t.geometry,r=n.getAttribute("position");r.set(i),r.needsUpdate=!0,n.computeBoundingSphere()}_updateOulineGeometry(){this._updateLine(this._outline,this._getPoints3d())}}class sv extends rv{constructor(t,e){super(t,e),this._rectGeometry=new q_(this._tag.geometry.getRect2d(e)),this._fill=dd(e.cameraType)?null:this._createFill(),this._outline=this._tag.lineWidth>=1?this._createOutline():null}dispose(){super.dispose(),this._disposeFill(),this._disposeOutline()}getDOMObjects(t,e,i){const n=[],r={offsetHeight:i.height,offsetWidth:i.width};if(!this._tag.editable)return n;const s=this._colorToCss(this._tag.lineColor),o=this._tag.geometry.getPoints2d();for(let t=0;t<o.length;t++){const[i,a]=o[t],c=this._viewportCoords.basicToCanvasSafe(i,a,r,this._transform,e);if(null==c)continue;const h="crosshair",l=this._interact(tv.Vertex,h,t),u=`translate(-50%, -50%) translate(${Math.round(c[0])}px,${Math.round(c[1])}px)`,d={onpointerdown:l,style:{background:s,transform:u,cursor:h}};if(n.push(jf.h("div.mapillary-tag-resizer",d,[])),!this._tag.indicateVertices)continue;const p={style:{background:s,transform:u}};n.push(jf.h("div.mapillary-tag-vertex",p,[]))}return n}getGLObjects(){const t=[];return null!=this._fill&&t.push(this._fill),null!=this._outline&&t.push(this._outline),t}getRetrievableObjects(){return null!=this._fill?[this._fill]:[]}_onGeometryChanged(){this._rectGeometry=new q_(this._tag.geometry.getRect2d(this._transform)),null!=this._fill&&this._updateFillGeometry(),null!=this._outline&&this._updateOulineGeometry()}_onTagChanged(){let t=!1;return null!=this._fill&&this._updateFillMaterial(this._fill.material),null==this._outline?this._tag.lineWidth>=1&&(this._outline=this._createOutline(),t=!0):this._updateOutlineMaterial(),t}_getPoints3d(){return this._rectGeometry.getPoints3d(this._transform)}_getTriangles(){return this._rectGeometry.getTriangles3d(this._transform)}_updateFillMaterial(t){t.color=new Dr(this._tag.fillColor),t.opacity=this._tag.fillOpacity,t.needsUpdate=!0}_updateLineBasicMaterial(t){t.color=new Dr(this._tag.lineColor),t.linewidth=Math.max(this._tag.lineWidth,1),t.visible=this._tag.lineWidth>=1&&this._tag.lineOpacity>0,t.opacity=this._tag.lineOpacity,t.transparent=this._tag.lineOpacity<1,t.needsUpdate=!0}_updateOutlineMaterial(){let t=this._outline.material;this._updateLineBasicMaterial(t)}}class ov extends Hf{constructor(t,e){super(),this._id=t,this._geometry=e,this._notifyChanged$=new T,this._notifyChanged$.subscribe((t=>{const e={target:this,type:"tag"};this.fire("tag",e)})),this._geometry.changed$.subscribe((t=>{const e="geometry",i={target:this,type:e};this.fire(e,i)}))}get id(){return this._id}get geometry(){return this._geometry}get changed$(){return this._notifyChanged$}get geometryChanged$(){return this._geometry.changed$.pipe(rt((()=>this)),Ze())}fire(t,e){super.fire(t,e)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}}class av extends ov{constructor(t,e,i){super(t,e),i=i||{},this._editable=null!=i.editable&&i.editable,this._fillColor=null==i.fillColor?16777215:i.fillColor,this._fillOpacity=null==i.fillOpacity?0:i.fillOpacity,this._indicateVertices=null==i.indicateVertices||i.indicateVertices,this._lineColor=null==i.lineColor?16777215:i.lineColor,this._lineOpacity=null==i.lineOpacity?1:i.lineOpacity,this._lineWidth=null==i.lineWidth?1:i.lineWidth}get editable(){return this._editable}set editable(t){this._editable=t,this._notifyChanged$.next(this)}get fillColor(){return this._fillColor}set fillColor(t){this._fillColor=t,this._notifyChanged$.next(this)}get fillOpacity(){return this._fillOpacity}set fillOpacity(t){this._fillOpacity=t,this._notifyChanged$.next(this)}get geometry(){return this._geometry}get indicateVertices(){return this._indicateVertices}set indicateVertices(t){this._indicateVertices=t,this._notifyChanged$.next(this)}get lineColor(){return this._lineColor}set lineColor(t){this._lineColor=t,this._notifyChanged$.next(this)}get lineOpacity(){return this._lineOpacity}set lineOpacity(t){this._lineOpacity=t,this._notifyChanged$.next(this)}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this._notifyChanged$.next(this)}setOptions(t){this._editable=null==t.editable?this._editable:t.editable,this._indicateVertices=null==t.indicateVertices?this._indicateVertices:t.indicateVertices,this._lineColor=null==t.lineColor?this._lineColor:t.lineColor,this._lineWidth=null==t.lineWidth?this._lineWidth:t.lineWidth,this._fillColor=null==t.fillColor?this._fillColor:t.fillColor,this._fillOpacity=null==t.fillOpacity?this._fillOpacity:t.fillOpacity,this._notifyChanged$.next(this)}}t.TagDomain=void 0,(ev=t.TagDomain||(t.TagDomain={}))[ev.TwoDimensional=0]="TwoDimensional",ev[ev.ThreeDimensional=1]="ThreeDimensional";class cv extends rv{constructor(e,i){super(e,i),this._fill=dd(i.cameraType)?e.domain===t.TagDomain.TwoDimensional&&e.geometry instanceof X_?this._createFill():null:this._createFill(),this._holes=this._tag.lineWidth>=1?this._createHoles():[],this._outline=this._tag.lineWidth>=1?this._createOutline():null}dispose(){super.dispose(),this._disposeFill(),this._disposeHoles(),this._disposeOutline()}getDOMObjects(t,e,i){const n=[],r=this._tag.geometry instanceof q_,s=!dd(this._transform.cameraType),o={offsetHeight:i.height,offsetWidth:i.width};if(null!=this._tag.icon&&(r||s)){const[i,r]=this._tag.geometry instanceof q_?this._tag.geometry.getVertex2d(this._tag.iconIndex):this._tag.geometry.getPoleOfInaccessibility2d(),s=this._viewportCoords.basicToCanvasSafe(i,r,o,this._transform,e);if(null!=s){const e=()=>{this._interact$.next({offsetX:0,offsetY:0,operation:tv.None,tag:this._tag})};if(t.loaded){const i=t.getDOMSprite(this._tag.icon,this._tag.iconFloat),r={onclick:t=>{t.stopPropagation(),this._tag.click$.next(this._tag)},onpointerdown:e,style:{transform:`translate(${Math.round(s[0])}px,${Math.round(s[1])}px)`}};n.push(jf.h("div.mapillary-tag-symbol",r,[i]))}}}else if(null!=this._tag.text&&(r||s)){const[t,i]=this._tag.geometry instanceof q_?this._tag.geometry.getVertex2d(3):this._tag.geometry.getPoleOfInaccessibility2d(),r=this._viewportCoords.basicToCanvasSafe(t,i,o,this._transform,e);if(null!=r){const t=Math.round(r[0]),e=Math.round(r[1]),i=this._tag.geometry instanceof q_?`translate(${t}px,${e}px)`:`translate(-50%, -50%) translate(${t}px,${e}px)`,s={onpointerdown:()=>{this._interact$.next({offsetX:0,offsetY:0,operation:tv.None,tag:this._tag})},style:{color:this._colorToCss(this._tag.textColor),transform:i},textContent:this._tag.text};n.push(jf.h("span.mapillary-tag-symbol",s,[]))}}if(!this._tag.editable)return n;const a=this._colorToCss(this._tag.lineColor);if(this._tag.geometry instanceof q_){const[t,i]=this._tag.geometry.getCentroid2d(),r=this._viewportCoords.basicToCanvasSafe(t,i,o,this._transform,e);if(null!=r){const t={onpointerdown:this._interact(tv.Centroid,"move"),style:{background:a,transform:`translate(-50%, -50%) translate(${Math.round(r[0])}px,${Math.round(r[1])}px)`}};n.push(jf.h("div.mapillary-tag-mover",t,[]))}}const c=this._tag.geometry.getVertices2d();for(let t=0;t<c.length-1;t++){if(r&&(null!=this._tag.icon&&t===this._tag.iconIndex||null==this._tag.icon&&null!=this._tag.text&&3===t))continue;const[i,s]=c[t],h=this._viewportCoords.basicToCanvasSafe(i,s,o,this._transform,e);if(null==h)continue;const l=r?t%2==0?"nesw-resize":"nwse-resize":"crosshair",u=this._interact(tv.Vertex,l,t),d=`translate(-50%, -50%) translate(${Math.round(h[0])}px,${Math.round(h[1])}px)`,p={onpointerdown:u,style:{background:a,transform:d,cursor:l}};if(n.push(jf.h("div.mapillary-tag-resizer",p,[])),!this._tag.indicateVertices)continue;const f={style:{background:a,transform:d}};n.push(jf.h("div.mapillary-tag-vertex",f,[]))}return n}getGLObjects(){const t=[];null!=this._fill&&t.push(this._fill);for(const e of this._holes)t.push(e);return null!=this._outline&&t.push(this._outline),t}getRetrievableObjects(){return null!=this._fill?[this._fill]:[]}_onGeometryChanged(){null!=this._fill&&this._updateFillGeometry(),this._holes.length>0&&this._updateHoleGeometries(),null!=this._outline&&this._updateOulineGeometry()}_onTagChanged(){let t=!1;return null!=this._fill&&this._updateFillMaterial(this._fill.material),null==this._outline?this._tag.lineWidth>=1&&(this._holes=this._createHoles(),this._outline=this._createOutline(),t=!0):(this._updateHoleMaterials(),this._updateOutlineMaterial()),t}_getPoints3d(){return this._in3dDomain()?this._tag.geometry.getVertices3d(this._transform):this._tag.geometry.getPoints3d(this._transform)}_getTriangles(){return this._in3dDomain()?this._tag.geometry.get3dDomainTriangles3d(this._transform):this._tag.geometry.getTriangles3d(this._transform)}_updateFillMaterial(t){t.color=new Dr(this._tag.fillColor),t.opacity=this._tag.fillOpacity,t.needsUpdate=!0}_updateLineBasicMaterial(t){t.color=new Dr(this._tag.lineColor),t.linewidth=Math.max(this._tag.lineWidth,1),t.visible=this._tag.lineWidth>=1&&this._tag.lineOpacity>0,t.opacity=this._tag.lineOpacity,t.transparent=this._tag.lineOpacity<1,t.needsUpdate=!0}_createHoles(){let t=[];if(this._tag.geometry instanceof X_){let e=this._getHoles3d();for(let i of e){let e=this._createLine(i);t.push(e)}}return t}_disposeHoles(){for(let t of this._holes)t.geometry.dispose(),t.material.dispose();this._holes=[]}_getHoles3d(){const t=this._tag.geometry;return this._in3dDomain()?t.getHoleVertices3d(this._transform):t.getHolePoints3d(this._transform)}_in3dDomain(){return this._tag.geometry instanceof X_&&this._tag.domain===t.TagDomain.ThreeDimensional}_updateHoleGeometries(){let t=this._getHoles3d();if(t.length!==this._holes.length)throw new Error("Changing the number of holes is not supported.");for(let e=0;e<this._holes.length;e++){let i=t[e],n=this._holes[e];this._updateLine(n,i)}}_updateHoleMaterials(){for(const t of this._holes)this._updateLineBasicMaterial(t.material)}_updateOutlineMaterial(){this._updateLineBasicMaterial(this._outline.material)}}t.Alignment=void 0,(iv=t.Alignment||(t.Alignment={}))[iv.Bottom=0]="Bottom",iv[iv.BottomLeft=1]="BottomLeft",iv[iv.BottomRight=2]="BottomRight",iv[iv.Center=3]="Center",iv[iv.Left=4]="Left",iv[iv.Right=5]="Right",iv[iv.Top=6]="Top",iv[iv.TopLeft=7]="TopLeft",iv[iv.TopRight=8]="TopRight";class hv extends ov{constructor(e,i,n){super(e,i);const r=null!=(n=n||{}).domain&&i instanceof X_?n.domain:t.TagDomain.TwoDimensional,s=this._twoDimensionalPolygon(r,i);this._domain=r,this._editable=null!=n.editable&&!s&&n.editable,this._fillColor=null==n.fillColor?16777215:n.fillColor,this._fillOpacity=null==n.fillOpacity?0:n.fillOpacity,this._icon=void 0===n.icon?null:n.icon,this._iconFloat=null==n.iconFloat?t.Alignment.Center:n.iconFloat,this._iconIndex=null==n.iconIndex?3:n.iconIndex,this._indicateVertices=null==n.indicateVertices||n.indicateVertices,this._lineColor=null==n.lineColor?16777215:n.lineColor,this._lineOpacity=null==n.lineOpacity?1:n.lineOpacity,this._lineWidth=null==n.lineWidth?1:n.lineWidth,this._text=void 0===n.text?null:n.text,this._textColor=null==n.textColor?16777215:n.textColor,this._click$=new T,this._click$.subscribe((()=>{const t="click",e={target:this,type:t};this.fire(t,e)}))}get click$(){return this._click$}get domain(){return this._domain}get editable(){return this._editable}set editable(t){this._twoDimensionalPolygon(this._domain,this._geometry)||(this._editable=t,this._notifyChanged$.next(this))}get fillColor(){return this._fillColor}set fillColor(t){this._fillColor=t,this._notifyChanged$.next(this)}get fillOpacity(){return this._fillOpacity}set fillOpacity(t){this._fillOpacity=t,this._notifyChanged$.next(this)}get geometry(){return this._geometry}get icon(){return this._icon}set icon(t){this._icon=t,this._notifyChanged$.next(this)}get iconFloat(){return this._iconFloat}set iconFloat(t){this._iconFloat=t,this._notifyChanged$.next(this)}get iconIndex(){return this._iconIndex}set iconIndex(t){this._iconIndex=t,this._notifyChanged$.next(this)}get indicateVertices(){return this._indicateVertices}set indicateVertices(t){this._indicateVertices=t,this._notifyChanged$.next(this)}get lineColor(){return this._lineColor}set lineColor(t){this._lineColor=t,this._notifyChanged$.next(this)}get lineOpacity(){return this._lineOpacity}set lineOpacity(t){this._lineOpacity=t,this._notifyChanged$.next(this)}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this._notifyChanged$.next(this)}get text(){return this._text}set text(t){this._text=t,this._notifyChanged$.next(this)}get textColor(){return this._textColor}set textColor(t){this._textColor=t,this._notifyChanged$.next(this)}fire(t,e){super.fire(t,e)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}setOptions(t){const e=this._twoDimensionalPolygon(this._domain,this._geometry);this._editable=e||null==t.editable?this._editable:t.editable,this._icon=void 0===t.icon?this._icon:t.icon,this._iconFloat=null==t.iconFloat?this._iconFloat:t.iconFloat,this._iconIndex=null==t.iconIndex?this._iconIndex:t.iconIndex,this._indicateVertices=null==t.indicateVertices?this._indicateVertices:t.indicateVertices,this._lineColor=null==t.lineColor?this._lineColor:t.lineColor,this._lineWidth=null==t.lineWidth?this._lineWidth:t.lineWidth,this._fillColor=null==t.fillColor?this._fillColor:t.fillColor,this._fillOpacity=null==t.fillOpacity?this._fillOpacity:t.fillOpacity,this._text=void 0===t.text?this._text:t.text,this._textColor=null==t.textColor?this._textColor:t.textColor,this._notifyChanged$.next(this)}_twoDimensionalPolygon(e,i){return e!==t.TagDomain.ThreeDimensional&&i instanceof X_}}class lv extends nv{dispose(){}getDOMObjects(e,i,n){const r=this._tag,s={offsetHeight:n.height,offsetWidth:n.width},o=[],[a,c]=r.geometry.getCentroid2d(),h=this._viewportCoords.basicToCanvasSafe(a,c,s,this._transform,i);if(null!=h){const i=t=>{this._interact$.next({offsetX:0,offsetY:0,operation:tv.None,tag:r})},n=Math.round(h[0]),s=Math.round(h[1]);if(null!=r.icon){if(e.loaded){const a=e.getDOMSprite(r.icon,t.Alignment.Bottom),c={onpointerdown:i,style:{pointerEvents:"all",transform:`translate(${n}px,${s+8}px)`}};o.push(jf.h("div",c,[a]))}}else if(null!=r.text){const t=`translate(-50%,0%) translate(${n}px,${s+8}px)`,e={onpointerdown:i,style:{color:this._colorToCss(r.textColor),transform:t},textContent:r.text};o.push(jf.h("span.mapillary-tag-symbol",e,[]))}const a=this._interact(tv.Centroid,r,"move"),c=this._colorToCss(r.color),l=`translate(-50%,-50%) translate(${n}px,${s}px)`;if(r.editable){let t={onpointerdown:a,style:{background:c,transform:l}};o.push(jf.h("div.mapillary-tag-spot-interactor",t,[]))}const u={style:{background:c,transform:l}};o.push(jf.h("div.mapillary-tag-vertex",u,[]))}return o}getGLObjects(){return[]}getRetrievableObjects(){return[]}_colorToCss(t){return"#"+("000000"+t.toString(16)).substr(-6)}_interact(t,e,i,n){return r=>{const s=r.offsetX-r.target.offsetWidth/2,o=r.offsetY-r.target.offsetHeight/2;this._interact$.next({cursor:i,offsetX:s,offsetY:o,operation:t,tag:e,vertexIndex:n})}}}class uv extends ov{constructor(t,e,i){super(t,e),i=i||{},this._color=null==i.color?16777215:i.color,this._editable=null!=i.editable&&i.editable,this._icon=void 0===i.icon?null:i.icon,this._text=void 0===i.text?null:i.text,this._textColor=null==i.textColor?16777215:i.textColor}get color(){return this._color}set color(t){this._color=t,this._notifyChanged$.next(this)}get editable(){return this._editable}set editable(t){this._editable=t,this._notifyChanged$.next(this)}get icon(){return this._icon}set icon(t){this._icon=t,this._notifyChanged$.next(this)}get text(){return this._text}set text(t){this._text=t,this._notifyChanged$.next(this)}get textColor(){return this._textColor}set textColor(t){this._textColor=t,this._notifyChanged$.next(this)}setOptions(t){this._color=null==t.color?this._color:t.color,this._editable=null==t.editable?this._editable:t.editable,this._icon=void 0===t.icon?this._icon:t.icon,this._text=void 0===t.text?this._text:t.text,this._textColor=null==t.textColor?this._textColor:t.textColor,this._notifyChanged$.next(this)}}class dv{constructor(){this._active=!1,this._hash={},this._hashDeactivated={},this._notifyChanged$=new T}get active(){return this._active}get changed$(){return this._notifyChanged$}activate(t){if(!this._active){for(const e in this._hashDeactivated){if(!this._hashDeactivated.hasOwnProperty(e))continue;const i=this._hashDeactivated[e];this._add(i,t)}this._hashDeactivated={},this._active=!0,this._notifyChanged$.next(this)}}deactivate(){if(this._active){for(const t in this._hash)this._hash.hasOwnProperty(t)&&(this._hashDeactivated[t]=this._hash[t].tag);this._hash={},this._active=!1}}add(t,e){this._assertActivationState(!0);for(const i of t)this._add(i,e);this._notifyChanged$.next(this)}addDeactivated(t){this._assertActivationState(!1);for(const e of t){if(!(e instanceof hv||e instanceof uv||e instanceof av))throw new Error("Tag type not supported");this._hashDeactivated[e.id]=e}}get(t){return this.has(t)?this._hash[t]:void 0}getAll(){const t=this._hash;return Object.keys(t).map((e=>t[e]))}getAllDeactivated(){const t=this._hashDeactivated;return Object.keys(t).map((e=>t[e]))}getDeactivated(t){return this.hasDeactivated(t)?this._hashDeactivated[t]:void 0}has(t){return t in this._hash}hasDeactivated(t){return t in this._hashDeactivated}remove(t){this._assertActivationState(!0);const e=this._hash;for(const i of t)i in e&&delete e[i];this._notifyChanged$.next(this)}removeAll(){this._assertActivationState(!0),this._hash={},this._notifyChanged$.next(this)}removeAllDeactivated(){this._assertActivationState(!1),this._hashDeactivated={}}removeDeactivated(t){this._assertActivationState(!1);const e=this._hashDeactivated;for(const i of t)i in e&&delete e[i]}_add(t,e){if(t instanceof hv)this._hash[t.id]=new cv(t,e);else if(t instanceof uv)this._hash[t.id]=new lv(t,e);else{if(!(t instanceof av))throw new Error("Tag type not supported");this._hash[t.id]=new sv(t,e)}}_assertActivationState(t){if(t!==this._active)throw new Error("Tag set not in correct state for operation.")}}class pv extends xg{constructor(t){super();let e=t[0],i=t[1];if(e<0||e>1||i<0||i>1)throw new wg("Basic coordinates must be on the interval [0, 1].");this._point=t.slice()}get point(){return this._point}getCentroid2d(){return this._point.slice()}getCentroid3d(t){return t.unprojectBasic(this._point,200)}setCentroid2d(t,e){let i=[Math.max(0,Math.min(1,t[0])),Math.max(0,Math.min(1,t[1]))];this._point[0]=i[0],this._point[1]=i[1],this._notifyChanged$.next(this)}}class fv extends Tm{constructor(t,e,i,n){super(t,e,i),this._name=`${this._component.name}-${this._getNameExtension()}`,this._viewportCoords=n}_getConfiguration(t){return{}}_mouseEventToBasic(t,e,i,n,r,s){r=null!=r?r:0,s=null!=s?s:0;const[o,a]=this._viewportCoords.canvasPosition(t,e);return this._viewportCoords.canvasToBasic(o-r,a-s,e,n,i.perspective)}}class mv extends fv{constructor(t,e,i,n,r){super(t,e,i,n),this._tagCreator=r,this._geometryCreated$=new T}get geometryCreated$(){return this._geometryCreated$}_enable(){this._enableCreate(),this._container.container.classList.add("component-tag-create")}_disable(){this._container.container.classList.remove("component-tag-create"),this._disableCreate()}_validateBasic(t){const e=t[0],i=t[1];return 0<=e&&e<=1&&0<=i&&i<=1}_mouseEventToBasic$(t){return t.pipe(bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$),rt((([t,e,i])=>this._mouseEventToBasic(t,this._container.container,e,i))))}}class gv extends mv{_enableCreate(){this._container.mouseService.deferPixels(this._name,4),this._geometryCreatedSubscription=this._mouseEventToBasic$(this._container.mouseService.proximateClick$).pipe(Nt(this._validateBasic),rt((t=>new pv(t)))).subscribe(this._geometryCreated$)}_disableCreate(){this._container.mouseService.undeferPixels(this._name),this._geometryCreatedSubscription.unsubscribe()}_getNameExtension(){return"create-point"}}class _v extends mv{_enableCreate(){this._container.mouseService.deferPixels(this._name,4);const t=this._navigator.stateService.currentTransform$.pipe(rt((()=>{})),Ue(1),E());this._deleteSubscription=t.pipe(Je(1)).subscribe(this._tagCreator.delete$);const e=this._mouseEventToBasic$(this._container.mouseService.proximateClick$).pipe(Ze());this._createSubscription=t.pipe(ri((()=>e.pipe(Nt(this._validateBasic),ve(1))))).subscribe(this._create$),this._setVertexSubscription=this._tagCreator.tag$.pipe(ri((t=>t?gt(G(t),Ot(this._container.mouseService.mouseMove$,this._container.mouseService.domMouseMove$),this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$):B()))).subscribe((([t,e,i,n])=>{const r=this._mouseEventToBasic(e,this._container.container,i,n);this._setVertex2d(t,r,n)})),this._addPointSubscription=this._tagCreator.tag$.pipe(ri((t=>t?gt(G(t),e):B()))).subscribe((([t,e])=>{this._addPoint(t,e)})),this._geometryCreateSubscription=this._tagCreator.tag$.pipe(ri((t=>t?t.created$.pipe(rt((t=>t.geometry))):B()))).subscribe(this._geometryCreated$)}_disableCreate(){this._container.mouseService.undeferPixels(this._name),this._tagCreator.delete$.next(null),this._addPointSubscription.unsubscribe(),this._createSubscription.unsubscribe(),this._deleteSubscription.unsubscribe(),this._geometryCreateSubscription.unsubscribe(),this._setVertexSubscription.unsubscribe()}}class vv extends _v{get _create$(){return this._tagCreator.createPoints$}_addPoint(t,e){t.geometry.addPoint2d(e)}_getNameExtension(){return"create-points"}_setVertex2d(t,e,i){t.geometry.setPoint2d(t.geometry.points.length-1,e,i)}}class yv extends _v{get _create$(){return this._tagCreator.createPolygon$}_addPoint(t,e){t.addPoint(e)}_getNameExtension(){return"create-polygon"}_setVertex2d(t,e,i){t.geometry.setVertex2d(t.geometry.polygon.length-2,e,i)}}class bv extends _v{get _create$(){return this._tagCreator.createRect$}_addPoint(t,e){const i=t.geometry;i.validate(e)||(e=i.getNonAdjustedVertex2d(3)),t.addPoint(e)}_enable(){super._enable(),this._initializeAnchorIndexingSubscription=this._tagCreator.tag$.pipe(Nt((t=>!!t))).subscribe((t=>{t.geometry.initializeAnchorIndexing()}))}_disable(){super._disable(),this._initializeAnchorIndexingSubscription.unsubscribe()}_getNameExtension(){return"create-rect"}_setVertex2d(t,e,i){t.geometry.setOppositeVertex2d(e,i)}}class xv extends mv{_enableCreate(){this._container.mouseService.claimMouse(this._name,2),this._deleteSubscription=this._navigator.stateService.currentTransform$.pipe(rt((t=>null)),Je(1)).subscribe(this._tagCreator.delete$),this._createSubscription=this._mouseEventToBasic$(this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseDragStart$)).pipe(Nt(this._validateBasic)).subscribe(this._tagCreator.createRect$),this._initializeAnchorIndexingSubscription=this._tagCreator.tag$.pipe(Nt((t=>!!t))).subscribe((t=>{t.geometry.initializeAnchorIndexing()}));const t=gt(Ot(this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseMove$),this._container.mouseService.filtered$(this._name,this._container.mouseService.domMouseMove$)),this._container.renderService.renderCamera$).pipe(bi(this._navigator.stateService.currentTransform$),rt((([[t,e],i])=>this._mouseEventToBasic(t,this._container.container,e,i))));this._setVertexSubscription=this._tagCreator.tag$.pipe(ri((e=>e?gt(G(e),t,this._navigator.stateService.currentTransform$):B()))).subscribe((([t,e,i])=>{t.geometry.setOppositeVertex2d(e,i)}));const e=this._container.mouseService.mouseDragEnd$.pipe(bi(this._mouseEventToBasic$(this._container.mouseService.filtered$(this._name,this._container.mouseService.mouseDrag$)).pipe(Nt(this._validateBasic)),((t,e)=>e)),Ze());this._addPointSubscription=this._tagCreator.tag$.pipe(ri((t=>t?gt(G(t),e):B()))).subscribe((([t,e])=>{const i=t.geometry;i.validate(e)||(e=i.getNonAdjustedVertex2d(3)),t.addPoint(e)})),this._geometryCreatedSubscription=this._tagCreator.tag$.pipe(ri((t=>t?t.created$.pipe(rt((t=>t.geometry))):B()))).subscribe(this._geometryCreated$)}_disableCreate(){this._container.mouseService.unclaimMouse(this._name),this._tagCreator.delete$.next(null),this._addPointSubscription.unsubscribe(),this._createSubscription.unsubscribe(),this._deleteSubscription.unsubscribe(),this._geometryCreatedSubscription.unsubscribe(),this._initializeAnchorIndexingSubscription.unsubscribe(),this._setVertexSubscription.unsubscribe()}_getNameExtension(){return"create-rect-drag"}}class wv extends fv{constructor(t,e,i,n,r){super(t,e,i,n),this._tagSet=r}_enable(){const t=this._tagSet.changed$.pipe(rt((t=>t.getAll())),ri((t=>bt(t).pipe(Mt((t=>t.interact$))))),ri((t=>At(G(t),this._container.mouseService.documentMouseUp$.pipe(rt((()=>({offsetX:0,offsetY:0,operation:tv.None,tag:null}))),Ee())))),Ze());Ot(this._container.mouseService.mouseMove$,this._container.mouseService.domMouseMove$).pipe(Ze()),this._claimMouseSubscription=t.pipe(ri((t=>t.tag?this._container.mouseService.domMouseDragStart$:B()))).subscribe((()=>{this._container.mouseService.claimMouse(this._name,3)})),this._cursorSubscription=t.pipe(rt((t=>t.cursor)),ue()).subscribe((t=>{const e=["crosshair","move","nesw-resize","nwse-resize"];for(const t of e)this._container.container.classList.remove(`component-tag-edit-${t}`);t&&this._container.container.classList.add(`component-tag-edit-${t}`)})),this._unclaimMouseSubscription=this._container.mouseService.filtered$(this._name,this._container.mouseService.domMouseDragEnd$).subscribe((t=>{this._container.mouseService.unclaimMouse(this._name)})),this._preventDefaultSubscription=t.pipe(ri((t=>t.tag?this._container.mouseService.documentMouseMove$:B()))).subscribe((t=>{t.preventDefault()})),this._updateGeometrySubscription=t.pipe(ri((t=>{if(t.operation===tv.None||!t.tag)return B();return gt(this._container.mouseService.filtered$(this._name,this._container.mouseService.domMouseDrag$).pipe(Nt((t=>this._viewportCoords.insideElement(t,this._container.container)))),this._container.renderService.renderCamera$).pipe(bi(G(t),this._navigator.stateService.currentTransform$,(([t,e],i,n)=>[t,e,i,n])))}))).subscribe((([t,e,i,n])=>{const r=this._mouseEventToBasic(t,this._container.container,e,n,i.offsetX,i.offsetY),s=i.tag.geometry;i.operation===tv.Centroid?s.setCentroid2d(r,n):i.operation===tv.Vertex&&s.setVertex2d(i.vertexIndex,r,n)}))}_disable(){this._claimMouseSubscription.unsubscribe(),this._cursorSubscription.unsubscribe(),this._preventDefaultSubscription.unsubscribe(),this._unclaimMouseSubscription.unsubscribe(),this._updateGeometrySubscription.unsubscribe()}_getNameExtension(){return"edit-vertex"}}class Sv extends Vf{constructor(t,e,i){super(t,e,i),this._tagDomRenderer=new J_,this._tagScene=new K_,this._tagSet=new dv,this._tagCreator=new Z_(this,i),this._viewportCoords=new Wf,this._createHandlers={CreatePoint:new gv(this,e,i,this._viewportCoords,this._tagCreator),CreatePoints:new vv(this,e,i,this._viewportCoords,this._tagCreator),CreatePolygon:new yv(this,e,i,this._viewportCoords,this._tagCreator),CreateRect:new bv(this,e,i,this._viewportCoords,this._tagCreator),CreateRectDrag:new xv(this,e,i,this._viewportCoords,this._tagCreator),Default:void 0},this._editVertexHandler=new wv(this,e,i,this._viewportCoords,this._tagSet),this._renderTags$=this._tagSet.changed$.pipe(rt((t=>{const e=t.getAll();return e.sort(((t,e)=>{const i=t.tag.id,n=e.tag.id;return i<n?-1:i>n?1:0})),e})),Ze()),this._tagChanged$=this._renderTags$.pipe(ri((t=>bt(t).pipe(Mt((t=>Ot(t.tag.changed$,t.tag.geometryChanged$)))))),Ze()),this._renderTagGLChanged$=this._renderTags$.pipe(ri((t=>bt(t).pipe(Mt((t=>t.glObjectsChanged$))))),Ze()),this._createGeometryChanged$=this._tagCreator.tag$.pipe(ri((t=>null!=t?t.geometryChanged$:B())),Ze()),this._createGLObjectsChanged$=this._tagCreator.tag$.pipe(ri((t=>null!=t?t.glObjectsChanged$:B())),Ze()),this._creatingConfiguration$=this._configuration$.pipe(ue(((t,e)=>t.mode===e.mode),(t=>({createColor:t.createColor,mode:t.mode}))),Ue(1),E()),this._creatingConfiguration$.subscribe((t=>{const e="tagmode",i={mode:t.mode,target:this,type:e};this.fire(e,i)}))}add(t){this._activated?this._navigator.stateService.currentTransform$.pipe(Ee()).subscribe((e=>{this._tagSet.add(t,e);const i=t.map((t=>this._tagSet.get(t.id)));this._tagScene.add(i)})):this._tagSet.addDeactivated(t)}calculateRect(t){return new Promise(((e,i)=>{this._navigator.stateService.currentTransform$.pipe(Ee(),rt((e=>t.getRect2d(e)))).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}create(){this._tagCreator.replayedTag$.pipe(Ee(),Nt((t=>!!t))).subscribe((t=>{t.create()}))}changeMode(t){this.configure({mode:t})}fire(t,e){super.fire(t,e)}get(t){if(this._activated){const e=this._tagSet.get(t);return void 0!==e?e.tag:void 0}return this._tagSet.getDeactivated(t)}getAll(){return this.activated?this._tagSet.getAll().map((t=>t.tag)):this._tagSet.getAllDeactivated()}getTagIdsAt(t){return new Promise(((e,i)=>{this._container.renderService.renderCamera$.pipe(Ee(),rt((e=>{const i=this._viewportCoords.canvasToViewport(t[0],t[1],this._container.container);return this._tagScene.intersectObjects(i,e.perspective)}))).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}has(t){return this._activated?this._tagSet.has(t):this._tagSet.hasDeactivated(t)}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}remove(t){this._activated?(this._tagSet.remove(t),this._tagScene.remove(t)):this._tagSet.removeDeactivated(t)}removeAll(){this._activated?(this._tagSet.removeAll(),this._tagScene.removeAll()):this._tagSet.removeAllDeactivated()}_activate(){this._editVertexHandler.enable();const e=bt(Object.keys(this._createHandlers)).pipe(rt((t=>this._createHandlers[t])),Nt((t=>!!t)),Mt((t=>t.geometryCreated$)),Ze()),i=this._subscriptions;i.push(e.subscribe((t=>{const e="geometrycreate",i={geometry:t,target:this,type:e};this.fire(e,i)}))),i.push(this._tagCreator.tag$.pipe(ti((t=>null==t)),ue()).subscribe((t=>{const e=null!=t?"tagcreatestart":"tagcreateend",i={target:this,type:e};this.fire(e,i)}))),i.push(e.subscribe((()=>{this.changeMode(t.TagMode.Default)}))),i.push(this._creatingConfiguration$.subscribe((e=>{this._disableCreateHandlers();const i=t.TagMode[e.mode],n=this._createHandlers[i];n&&n.enable()}))),i.push(this._renderTags$.subscribe((()=>{const t="tags",e={target:this,type:t};this.fire(t,e)}))),i.push(this._tagCreator.tag$.pipe(ri((t=>null!=t?t.aborted$.pipe(rt((()=>null))):B()))).subscribe((()=>{this.changeMode(t.TagMode.Default)}))),i.push(this._tagCreator.tag$.subscribe((t=>{this._tagScene.hasCreateTag()&&this._tagScene.removeCreateTag(),null!=t&&this._tagScene.addCreateTag(t)}))),i.push(this._createGLObjectsChanged$.subscribe((t=>{this._tagScene.updateCreateTagObjects(t)}))),i.push(this._renderTagGLChanged$.subscribe((t=>{this._tagScene.updateObjects(t)}))),i.push(this._tagChanged$.subscribe((()=>{this._tagScene.update()}))),i.push(gt(this._renderTags$.pipe(ni([]),pi((()=>{this._container.domRenderer.render$.next({name:this._name,vNode:this._tagDomRenderer.clear()})}))),this._container.renderService.renderCamera$,this._container.spriteService.spriteAtlas$,this._container.renderService.size$,this._tagChanged$.pipe(ni(null)),Ot(this._tagCreator.tag$,this._createGeometryChanged$).pipe(ni(null))).pipe(rt((([t,e,i,n,,r])=>({name:this._name,vNode:this._tagDomRenderer.render(t,r,i,e.perspective,n)})))).subscribe(this._container.domRenderer.render$)),i.push(this._navigator.stateService.currentState$.pipe(rt((t=>{const e=this._tagScene;return{name:this._name,renderer:{frameId:t.id,needsRender:e.needsRender,render:e.render.bind(e),pass:rm.Opaque}}}))).subscribe(this._container.glRenderer.render$)),this._navigator.stateService.currentTransform$.pipe(Ee()).subscribe((t=>{this._tagSet.activate(t),this._tagScene.add(this._tagSet.getAll())}))}_deactivate(){this._editVertexHandler.disable(),this._disableCreateHandlers(),this._tagScene.clear(),this._tagSet.deactivate(),this._tagCreator.delete$.next(null),this._subscriptions.unsubscribe(),this._container.container.classList.remove("component-tag-create")}_getDefaultConfiguration(){return{createColor:16777215,indicatePointsCompleter:!0,mode:t.TagMode.Default}}_disableCreateHandlers(){const t=this._createHandlers;for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];i&&i.disable()}}}Sv.componentName="tag";class Mv extends Vf{constructor(t,e,i){super(t,e,i),this._viewportCoords=new Wf,this._zoomDelta$=new T}_activate(){const e=this._subscriptions;e.push(gt(this._navigator.stateService.currentState$,this._navigator.stateService.state$,this._configuration$,this._container.renderService.size$).pipe(rt((([e,i,n,r])=>{const s=e.state.zoom,o=jf.h("div.mapillary-zoom-in-icon",[]),a=s>=3||i===vm.Waiting?jf.h("div.mapillary-zoom-in-button-inactive",[o]):jf.h("div.mapillary-zoom-in-button",{onclick:()=>{this._zoomDelta$.next(1)}},[o]),c=jf.h("div.mapillary-zoom-out-icon",[]),h=s<=0||i===vm.Waiting?jf.h("div.mapillary-zoom-out-button-inactive",[c]):jf.h("div.mapillary-zoom-out-button",{onclick:()=>{this._zoomDelta$.next(-1)}},[c]),l=n.size===t.ComponentSize.Small||n.size===t.ComponentSize.Automatic&&r.width<640?".mapillary-zoom-compact":"";return{name:this._name,vNode:jf.h("div.mapillary-zoom-container"+l,{oncontextmenu:t=>{t.preventDefault()}},[a,h])}}))).subscribe(this._container.domRenderer.render$)),e.push(this._zoomDelta$.pipe(bi(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$)).subscribe((([t,e,i])=>{const n=this._viewportCoords.unprojectFromViewport(0,0,e.perspective),r=i.projectBasic(n.toArray());this._navigator.stateService.zoomIn(t,r)})))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{size:t.ComponentSize.Automatic}}}Mv.componentName="zoom";class Tv extends Vf{constructor(t,e,i,n){super(t,e,i),this._canvasId=`${e.id}-${this._name}`,this._dom=n||new Xm}_activate(){const t=this._container.domRenderer.element$.pipe(rt((()=>this._dom.document.getElementById(this._canvasId))),Nt((t=>!!t)),rt((t=>{const e=t.parentElement,i=e.offsetWidth;return[t,{height:e.offsetHeight,width:i}]})),ue(((t,e)=>t.height===e.height&&t.width===e.width),(([,t])=>t)));this._subscriptions.push(gt(t,this._navigator.stateService.currentImage$).subscribe((([[t,e],i])=>{t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(i.image,0,0,e.width,e.height)}))),this._container.domRenderer.renderAdaptive$.next({name:this._name,vNode:jf.h(`canvas#${this._canvasId}`,[])})}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{}}}Tv.componentName="imagefallback";class Cv extends Vf{constructor(e,i,n){super(e,i,n),this._seqNames={},this._seqNames[t.NavigationDirection[t.NavigationDirection.Prev]]="-prev",this._seqNames[t.NavigationDirection[t.NavigationDirection.Next]]="-next",this._spaTopNames={},this._spaTopNames[t.NavigationDirection[t.NavigationDirection.TurnLeft]]="-turn-left",this._spaTopNames[t.NavigationDirection[t.NavigationDirection.StepLeft]]="-left",this._spaTopNames[t.NavigationDirection[t.NavigationDirection.StepForward]]="-forward",this._spaTopNames[t.NavigationDirection[t.NavigationDirection.StepRight]]="-right",this._spaTopNames[t.NavigationDirection[t.NavigationDirection.TurnRight]]="-turn-right",this._spaBottomNames={},this._spaBottomNames[t.NavigationDirection[t.NavigationDirection.TurnU]]="-turn-around",this._spaBottomNames[t.NavigationDirection[t.NavigationDirection.StepBackward]]="-backward"}_activate(){this._subscriptions.push(gt(this._navigator.stateService.currentImage$,this._configuration$).pipe(ri((([t,e])=>gt(e.sequence?t.sequenceEdges$.pipe(rt((t=>t.edges.map((t=>t.data.direction))))):G([]),!dd(t.cameraType)&&e.spatial?t.spatialEdges$.pipe(rt((t=>t.edges.map((t=>t.data.direction))))):G([])).pipe(rt((([t,e])=>t.concat(e)))))),rt((t=>{const e=this._createArrowRow(this._seqNames,t),i=this._createArrowRow(this._spaTopNames,t),n=this._createArrowRow(this._spaBottomNames,t),r=jf.h("div.mapillary-navigation-sequence",e),s=jf.h("div.NavigationSpatialTop",i),o=jf.h("div.mapillary-navigation-spatial-bottom",n),a=jf.h("div.mapillary-navigation-spatial",[s,o]);return{name:this._name,vNode:jf.h("div.NavigationContainer",[r,a])}}))).subscribe(this._container.domRenderer.render$))}_deactivate(){this._subscriptions.unsubscribe()}_getDefaultConfiguration(){return{sequence:!0,spatial:!0}}_createArrowRow(e,i){const n=[];for(const r in e){if(!e.hasOwnProperty(r))continue;const s=t.NavigationDirection[r];-1!==i.indexOf(s)?n.push(this._createVNode(s,e[r],"visible")):n.push(this._createVNode(s,e[r],"hidden"))}return n}_createVNode(t,e,i){return jf.h(`span.mapillary-navigation-button.mapillary-navigation${e}`,{onclick:()=>{this._navigator.moveDir$(t).subscribe(void 0,(t=>{t instanceof Zf||console.error(t)}))},style:{visibility:i}},[])}}Cv.componentName="navigationfallback";function Ev(t){let e=t.length;for(;--e>=0;)t[e]=0}const Iv=256,Av=286,Pv=30,Rv=15,Lv=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ov=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Nv=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Dv=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$v=new Array(576);Ev($v);const kv=new Array(60);Ev(kv);const zv=new Array(512);Ev(zv);const Fv=new Array(256);Ev(Fv);const Bv=new Array(29);Ev(Bv);const jv=new Array(Pv);function Hv(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}let Uv,Vv,Gv;function qv(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Ev(jv);const Wv=t=>t<256?zv[t]:zv[256+(t>>>7)],Xv=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Yv=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,Xv(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},Zv=(t,e,i)=>{Yv(t,i[2*e],i[2*e+1])},Jv=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},Kv=(t,e,i)=>{const n=new Array(16);let r,s,o=0;for(r=1;r<=Rv;r++)n[r]=o=o+i[r-1]<<1;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=Jv(n[e]++,e))}},Qv=t=>{let e;for(e=0;e<Av;e++)t.dyn_ltree[2*e]=0;for(e=0;e<Pv;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},ty=t=>{t.bi_valid>8?Xv(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},ey=(t,e,i,n)=>{const r=2*e,s=2*i;return t[r]<t[s]||t[r]===t[s]&&n[e]<=n[i]},iy=(t,e,i)=>{const n=t.heap[i];let r=i<<1;for(;r<=t.heap_len&&(r<t.heap_len&&ey(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!ey(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n},ny=(t,e,i)=>{let n,r,s,o,a=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*a]<<8|t.pending_buf[t.d_buf+2*a+1],r=t.pending_buf[t.l_buf+a],a++,0===n?Zv(t,r,e):(s=Fv[r],Zv(t,s+Iv+1,e),o=Lv[s],0!==o&&(r-=Bv[s],Yv(t,r,o)),n--,s=Wv(n),Zv(t,s,i),o=Ov[s],0!==o&&(n-=jv[s],Yv(t,n,o)))}while(a<t.last_lit);Zv(t,256,e)},ry=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,c,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==i[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=h<2?++h:0,i[2*c]=1,t.depth[c]=0,t.opt_len--,r&&(t.static_len-=n[2*c+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)iy(t,i,o);c=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],iy(t,i,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,i[2*c]=i[2*o]+i[2*a],t.depth[c]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,i[2*o+1]=i[2*a+1]=c,t.heap[1]=c++,iy(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,n=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length;let h,l,u,d,p,f,m=0;for(d=0;d<=Rv;d++)t.bl_count[d]=0;for(i[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)l=t.heap[h],d=i[2*i[2*l+1]+1]+1,d>c&&(d=c,m++),i[2*l+1]=d,l>n||(t.bl_count[d]++,p=0,l>=a&&(p=o[l-a]),f=i[2*l],t.opt_len+=f*(d+p),s&&(t.static_len+=f*(r[2*l+1]+p)));if(0!==m){do{for(d=c-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[c]--,m-=2}while(m>0);for(d=c;0!==d;d--)for(l=t.bl_count[d];0!==l;)u=t.heap[--h],u>n||(i[2*u+1]!==d&&(t.opt_len+=(d-i[2*u+1])*i[2*u],i[2*u+1]=d),l--)}})(t,e),Kv(i,h,t.bl_count)},sy=(t,e,i)=>{let n,r,s=-1,o=e[1],a=0,c=7,h=4;for(0===o&&(c=138,h=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++a<c&&r===o||(a<h?t.bl_tree[2*r]+=a:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,s=r,0===o?(c=138,h=3):r===o?(c=6,h=3):(c=7,h=4))},oy=(t,e,i)=>{let n,r,s=-1,o=e[1],a=0,c=7,h=4;for(0===o&&(c=138,h=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++a<c&&r===o)){if(a<h)do{Zv(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(Zv(t,r,t.bl_tree),a--),Zv(t,16,t.bl_tree),Yv(t,a-3,2)):a<=10?(Zv(t,17,t.bl_tree),Yv(t,a-3,3)):(Zv(t,18,t.bl_tree),Yv(t,a-11,7));a=0,s=r,0===o?(c=138,h=3):r===o?(c=6,h=3):(c=7,h=4)}};let ay=!1;const cy=(t,e,i,n)=>{Yv(t,0+(n?1:0),3),((t,e,i,n)=>{ty(t),n&&(Xv(t,i),Xv(t,~i)),t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i})(t,e,i,!0)};var hy={_tr_init:t=>{ay||((()=>{let t,e,i,n,r;const s=new Array(16);for(i=0,n=0;n<28;n++)for(Bv[n]=i,t=0;t<1<<Lv[n];t++)Fv[i++]=n;for(Fv[i-1]=n,r=0,n=0;n<16;n++)for(jv[n]=r,t=0;t<1<<Ov[n];t++)zv[r++]=n;for(r>>=7;n<Pv;n++)for(jv[n]=r<<7,t=0;t<1<<Ov[n]-7;t++)zv[256+r++]=n;for(e=0;e<=Rv;e++)s[e]=0;for(t=0;t<=143;)$v[2*t+1]=8,t++,s[8]++;for(;t<=255;)$v[2*t+1]=9,t++,s[9]++;for(;t<=279;)$v[2*t+1]=7,t++,s[7]++;for(;t<=287;)$v[2*t+1]=8,t++,s[8]++;for(Kv($v,287,s),t=0;t<Pv;t++)kv[2*t+1]=5,kv[2*t]=Jv(t,5);Uv=new Hv($v,Lv,257,Av,Rv),Vv=new Hv(kv,Ov,0,Pv,Rv),Gv=new Hv(new Array(0),Nv,0,19,7)})(),ay=!0),t.l_desc=new qv(t.dyn_ltree,Uv),t.d_desc=new qv(t.dyn_dtree,Vv),t.bl_desc=new qv(t.bl_tree,Gv),t.bi_buf=0,t.bi_valid=0,Qv(t)},_tr_stored_block:cy,_tr_flush_block:(t,e,i,n)=>{let r,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<Iv;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),ry(t,t.l_desc),ry(t,t.d_desc),o=(t=>{let e;for(sy(t,t.dyn_ltree,t.l_desc.max_code),sy(t,t.dyn_dtree,t.d_desc.max_code),ry(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Dv[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=i+5,i+4<=r&&-1!==e?cy(t,e,i,n):4===t.strategy||s===r?(Yv(t,2+(n?1:0),3),ny(t,$v,kv)):(Yv(t,4+(n?1:0),3),((t,e,i,n)=>{let r;for(Yv(t,e-257,5),Yv(t,i-1,5),Yv(t,n-4,4),r=0;r<n;r++)Yv(t,t.bl_tree[2*Dv[r]+1],3);oy(t,t.dyn_ltree,e-1),oy(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),ny(t,t.dyn_ltree,t.dyn_dtree)),Qv(t),n&&ty(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(Fv[i]+Iv+1)]++,t.dyn_dtree[2*Wv(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{Yv(t,2,3),Zv(t,256,$v),(t=>{16===t.bi_valid?(Xv(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var ly=(t,e,i,n)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{r=r+e[n++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const uy=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var dy=(t,e,i,n)=>{const r=uy,s=n+i;t^=-1;for(let i=n;i<s;i++)t=t>>>8^r[255&(t^e[i])];return-1^t},py={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},fy={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:my,_tr_stored_block:gy,_tr_flush_block:_y,_tr_tally:vy,_tr_align:yy}=hy,{Z_NO_FLUSH:by,Z_PARTIAL_FLUSH:xy,Z_FULL_FLUSH:wy,Z_FINISH:Sy,Z_BLOCK:My,Z_OK:Ty,Z_STREAM_END:Cy,Z_STREAM_ERROR:Ey,Z_DATA_ERROR:Iy,Z_BUF_ERROR:Ay,Z_DEFAULT_COMPRESSION:Py,Z_FILTERED:Ry,Z_HUFFMAN_ONLY:Ly,Z_RLE:Oy,Z_FIXED:Ny,Z_DEFAULT_STRATEGY:Dy,Z_UNKNOWN:$y,Z_DEFLATED:ky}=fy,zy=258,Fy=262,By=103,jy=113,Hy=666,Uy=(t,e)=>(t.msg=py[e],e),Vy=t=>(t<<1)-(t>4?9:0),Gy=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let qy=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const Wy=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},Xy=(t,e)=>{_y(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Wy(t.strm)},Yy=(t,e)=>{t.pending_buf[t.pending++]=e},Zy=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Jy=(t,e,i,n)=>{let r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),i),1===t.state.wrap?t.adler=ly(t.adler,e,r,i):2===t.state.wrap&&(t.adler=dy(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)},Ky=(t,e)=>{let i,n,r=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match;const c=t.strstart>t.w_size-Fy?t.strstart-(t.w_size-Fy):0,h=t.window,l=t.w_mask,u=t.prev,d=t.strstart+zy;let p=h[s+o-1],f=h[s+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(i=e,h[i+o]===f&&h[i+o-1]===p&&h[i]===h[s]&&h[++i]===h[s+1]){s+=2,i++;do{}while(h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&s<d);if(n=zy-(d-s),s=d-zy,n>o){if(t.match_start=e,o=n,n>=a)break;p=h[s+o-1],f=h[s+o]}}}while((e=u[e&l])>c&&0!=--r);return o<=t.lookahead?o:t.lookahead},Qy=t=>{const e=t.w_size;let i,n,r,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Fy)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,i=n;do{r=t.head[--i],t.head[i]=r>=e?r-e:0}while(--n);n=e,i=n;do{r=t.prev[--i],t.prev[i]=r>=e?r-e:0}while(--n);s+=e}if(0===t.strm.avail_in)break;if(n=Jy(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=n,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=qy(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=qy(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Fy&&0!==t.strm.avail_in)},tb=(t,e)=>{let i,n;for(;;){if(t.lookahead<Fy){if(Qy(t),t.lookahead<Fy&&e===by)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=qy(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-Fy&&(t.match_length=Ky(t,i)),t.match_length>=3)if(n=vy(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=qy(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=qy(t,t.ins_h,t.window[t.strstart+1]);else n=vy(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Xy(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Sy?(Xy(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Xy(t,!1),0===t.strm.avail_out)?1:2},eb=(t,e)=>{let i,n,r;for(;;){if(t.lookahead<Fy){if(Qy(t),t.lookahead<Fy&&e===by)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=qy(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-Fy&&(t.match_length=Ky(t,i),t.match_length<=5&&(t.strategy===Ry||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=vy(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=qy(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Xy(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=vy(t,0,t.window[t.strstart-1]),n&&Xy(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=vy(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Sy?(Xy(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Xy(t,!1),0===t.strm.avail_out)?1:2};function ib(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}const nb=[new ib(0,0,0,0,((t,e)=>{let i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Qy(t),0===t.lookahead&&e===by)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,Xy(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-Fy&&(Xy(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Sy?(Xy(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(Xy(t,!1),t.strm.avail_out),1)})),new ib(4,4,8,4,tb),new ib(4,5,16,8,tb),new ib(4,6,32,32,tb),new ib(4,4,16,16,eb),new ib(8,16,32,32,eb),new ib(8,16,128,128,eb),new ib(8,32,128,256,eb),new ib(32,128,258,1024,eb),new ib(32,258,258,4096,eb)];function rb(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ky,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Gy(this.dyn_ltree),Gy(this.dyn_dtree),Gy(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Gy(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Gy(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const sb=t=>{if(!t||!t.state)return Uy(t,Ey);t.total_in=t.total_out=0,t.data_type=$y;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:jy,t.adler=2===e.wrap?0:1,e.last_flush=by,my(e),Ty},ob=t=>{const e=sb(t);var i;return e===Ty&&((i=t.state).window_size=2*i.w_size,Gy(i.head),i.max_lazy_match=nb[i.level].max_lazy,i.good_match=nb[i.level].good_length,i.nice_match=nb[i.level].nice_length,i.max_chain_length=nb[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},ab=(t,e,i,n,r,s)=>{if(!t)return Ey;let o=1;if(e===Py&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>9||i!==ky||n<8||n>15||e<0||e>9||s<0||s>Ny)return Uy(t,Ey);8===n&&(n=9);const a=new rb;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=s,a.method=i,ob(t)};var cb={deflateInit:(t,e)=>ab(t,e,ky,15,8,Dy),deflateInit2:ab,deflateReset:ob,deflateResetKeep:sb,deflateSetHeader:(t,e)=>t&&t.state?2!==t.state.wrap?Ey:(t.state.gzhead=e,Ty):Ey,deflate:(t,e)=>{let i,n;if(!t||!t.state||e>My||e<0)return t?Uy(t,Ey):Ey;const r=t.state;if(!t.output||!t.input&&0!==t.avail_in||r.status===Hy&&e!==Sy)return Uy(t,0===t.avail_out?Ay:Ey);r.strm=t;const s=r.last_flush;if(r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,Yy(r,31),Yy(r,139),Yy(r,8),r.gzhead?(Yy(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Yy(r,255&r.gzhead.time),Yy(r,r.gzhead.time>>8&255),Yy(r,r.gzhead.time>>16&255),Yy(r,r.gzhead.time>>24&255),Yy(r,9===r.level?2:r.strategy>=Ly||r.level<2?4:0),Yy(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Yy(r,255&r.gzhead.extra.length),Yy(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=dy(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Yy(r,0),Yy(r,0),Yy(r,0),Yy(r,0),Yy(r,0),Yy(r,9===r.level?2:r.strategy>=Ly||r.level<2?4:0),Yy(r,3),r.status=jy);else{let e=ky+(r.w_bits-8<<4)<<8,i=-1;i=r.strategy>=Ly||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=i<<6,0!==r.strstart&&(e|=32),e+=31-e%31,r.status=jy,Zy(r,e),0!==r.strstart&&(Zy(r,t.adler>>>16),Zy(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(t.adler=dy(t.adler,r.pending_buf,r.pending-i,i)),Wy(t),i=r.pending,r.pending!==r.pending_buf_size));)Yy(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(t.adler=dy(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=dy(t.adler,r.pending_buf,r.pending-i,i)),Wy(t),i=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Yy(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>i&&(t.adler=dy(t.adler,r.pending_buf,r.pending-i,i)),0===n&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=dy(t.adler,r.pending_buf,r.pending-i,i)),Wy(t),i=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Yy(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>i&&(t.adler=dy(t.adler,r.pending_buf,r.pending-i,i)),0===n&&(r.status=By)}else r.status=By;if(r.status===By&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Wy(t),r.pending+2<=r.pending_buf_size&&(Yy(r,255&t.adler),Yy(r,t.adler>>8&255),t.adler=0,r.status=jy)):r.status=jy),0!==r.pending){if(Wy(t),0===t.avail_out)return r.last_flush=-1,Ty}else if(0===t.avail_in&&Vy(e)<=Vy(s)&&e!==Sy)return Uy(t,Ay);if(r.status===Hy&&0!==t.avail_in)return Uy(t,Ay);if(0!==t.avail_in||0!==r.lookahead||e!==by&&r.status!==Hy){let i=r.strategy===Ly?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Qy(t),0===t.lookahead)){if(e===by)return 1;break}if(t.match_length=0,i=vy(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Xy(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Sy?(Xy(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Xy(t,!1),0===t.strm.avail_out)?1:2})(r,e):r.strategy===Oy?((t,e)=>{let i,n,r,s;const o=t.window;for(;;){if(t.lookahead<=zy){if(Qy(t),t.lookahead<=zy&&e===by)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){s=t.strstart+zy;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);t.match_length=zy-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=vy(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=vy(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Xy(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Sy?(Xy(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Xy(t,!1),0===t.strm.avail_out)?1:2})(r,e):nb[r.level].func(r,e);if(3!==i&&4!==i||(r.status=Hy),1===i||3===i)return 0===t.avail_out&&(r.last_flush=-1),Ty;if(2===i&&(e===xy?yy(r):e!==My&&(gy(r,0,0,!1),e===wy&&(Gy(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Wy(t),0===t.avail_out))return r.last_flush=-1,Ty}return e!==Sy?Ty:r.wrap<=0?Cy:(2===r.wrap?(Yy(r,255&t.adler),Yy(r,t.adler>>8&255),Yy(r,t.adler>>16&255),Yy(r,t.adler>>24&255),Yy(r,255&t.total_in),Yy(r,t.total_in>>8&255),Yy(r,t.total_in>>16&255),Yy(r,t.total_in>>24&255)):(Zy(r,t.adler>>>16),Zy(r,65535&t.adler)),Wy(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Ty:Cy)},deflateEnd:t=>{if(!t||!t.state)return Ey;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==By&&e!==jy&&e!==Hy?Uy(t,Ey):(t.state=null,e===jy?Uy(t,Iy):Ty)},deflateSetDictionary:(t,e)=>{let i=e.length;if(!t||!t.state)return Ey;const n=t.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return Ey;if(1===r&&(t.adler=ly(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===r&&(Gy(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}const s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Qy(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=qy(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,Qy(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,n.wrap=r,Ty},deflateInfo:"pako deflate (from Nodeca project)"};const hb=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var lb=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)hb(i,e)&&(t[e]=i[e])}}return t},ub=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,r=t.length;e<r;e++){let r=t[e];i.set(r,n),n+=r.length}return i};let db=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){db=!1}const pb=new Uint8Array(256);for(let t=0;t<256;t++)pb[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;pb[254]=pb[254]=1;var fb=t=>{let e,i,n,r,s,o=t.length,a=0;for(r=0;r<o;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},mb=(t,e)=>{let i,n;const r=e||t.length,s=new Array(2*r);for(n=0,i=0;i<r;){let e=t[i++];if(e<128){s[n++]=e;continue}let o=pb[e];if(o>4)s[n++]=65533,i+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&i<r;)e=e<<6|63&t[i++],o--;o>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&db)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i})(s,n)},gb=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+pb[t[i]]>e?i:e};var _b=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const vb=Object.prototype.toString,{Z_NO_FLUSH:yb,Z_SYNC_FLUSH:bb,Z_FULL_FLUSH:xb,Z_FINISH:wb,Z_OK:Sb,Z_STREAM_END:Mb,Z_DEFAULT_COMPRESSION:Tb,Z_DEFAULT_STRATEGY:Cb,Z_DEFLATED:Eb}=fy;function Ib(t){this.options=lb({level:Tb,method:Eb,chunkSize:16384,windowBits:15,memLevel:8,strategy:Cb},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _b,this.strm.avail_out=0;let i=cb.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==Sb)throw new Error(py[i]);if(e.header&&cb.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?fb(e.dictionary):"[object ArrayBuffer]"===vb.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=cb.deflateSetDictionary(this.strm,t),i!==Sb)throw new Error(py[i]);this._dict_set=!0}}Ib.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?wb:yb,"string"==typeof t?i.input=fb(t):"[object ArrayBuffer]"===vb.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(s===bb||s===xb)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=cb.deflate(i,s),r===Mb)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=cb.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Sb;if(0!==i.avail_out){if(s>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},Ib.prototype.onData=function(t){this.chunks.push(t)},Ib.prototype.onEnd=function(t){t===Sb&&(this.result=ub(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ab=function(t,e){let i,n,r,s,o,a,c,h,l,u,d,p,f,m,g,_,v,y,b,x,w,S,M,T;const C=t.state;i=t.next_in,M=t.input,n=i+(t.avail_in-5),r=t.next_out,T=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),a=C.dmax,c=C.wsize,h=C.whave,l=C.wnext,u=C.window,d=C.hold,p=C.bits,f=C.lencode,m=C.distcode,g=(1<<C.lenbits)-1,_=(1<<C.distbits)-1;t:do{p<15&&(d+=M[i++]<<p,p+=8,d+=M[i++]<<p,p+=8),v=f[d&g];e:for(;;){if(y=v>>>24,d>>>=y,p-=y,y=v>>>16&255,0===y)T[r++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=f[(65535&v)+(d&(1<<y)-1)];continue e}if(32&y){C.mode=12;break t}t.msg="invalid literal/length code",C.mode=30;break t}b=65535&v,y&=15,y&&(p<y&&(d+=M[i++]<<p,p+=8),b+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=M[i++]<<p,p+=8,d+=M[i++]<<p,p+=8),v=m[d&_];i:for(;;){if(y=v>>>24,d>>>=y,p-=y,y=v>>>16&255,!(16&y)){if(0==(64&y)){v=m[(65535&v)+(d&(1<<y)-1)];continue i}t.msg="invalid distance code",C.mode=30;break t}if(x=65535&v,y&=15,p<y&&(d+=M[i++]<<p,p+=8,p<y&&(d+=M[i++]<<p,p+=8)),x+=d&(1<<y)-1,x>a){t.msg="invalid distance too far back",C.mode=30;break t}if(d>>>=y,p-=y,y=r-s,x>y){if(y=x-y,y>h&&C.sane){t.msg="invalid distance too far back",C.mode=30;break t}if(w=0,S=u,0===l){if(w+=c-y,y<b){b-=y;do{T[r++]=u[w++]}while(--y);w=r-x,S=T}}else if(l<y){if(w+=c+l-y,y-=l,y<b){b-=y;do{T[r++]=u[w++]}while(--y);if(w=0,l<b){y=l,b-=y;do{T[r++]=u[w++]}while(--y);w=r-x,S=T}}}else if(w+=l-y,y<b){b-=y;do{T[r++]=u[w++]}while(--y);w=r-x,S=T}for(;b>2;)T[r++]=S[w++],T[r++]=S[w++],T[r++]=S[w++],b-=3;b&&(T[r++]=S[w++],b>1&&(T[r++]=S[w++]))}else{w=r-x;do{T[r++]=T[w++],T[r++]=T[w++],T[r++]=T[w++],b-=3}while(b>2);b&&(T[r++]=T[w++],b>1&&(T[r++]=T[w++]))}break}}break}}while(i<n&&r<o);b=p>>3,i-=b,p-=b<<3,d&=(1<<p)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<o?o-r+257:257-(r-o),C.hold=d,C.bits=p};const Pb=15,Rb=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Lb=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ob=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Nb=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Db=(t,e,i,n,r,s,o,a)=>{const c=a.bits;let h,l,u,d,p,f,m=0,g=0,_=0,v=0,y=0,b=0,x=0,w=0,S=0,M=0,T=null,C=0;const E=new Uint16Array(16),I=new Uint16Array(16);let A,P,R,L=null,O=0;for(m=0;m<=Pb;m++)E[m]=0;for(g=0;g<n;g++)E[e[i+g]]++;for(y=c,v=Pb;v>=1&&0===E[v];v--);if(y>v&&(y=v),0===v)return r[s++]=20971520,r[s++]=20971520,a.bits=1,0;for(_=1;_<v&&0===E[_];_++);for(y<_&&(y=_),w=1,m=1;m<=Pb;m++)if(w<<=1,w-=E[m],w<0)return-1;if(w>0&&(0===t||1!==v))return-1;for(I[1]=0,m=1;m<Pb;m++)I[m+1]=I[m]+E[m];for(g=0;g<n;g++)0!==e[i+g]&&(o[I[e[i+g]]++]=g);if(0===t?(T=L=o,f=19):1===t?(T=Rb,C-=257,L=Lb,O-=257,f=256):(T=Ob,L=Nb,f=-1),M=0,g=0,m=_,p=s,b=y,x=0,u=-1,S=1<<y,d=S-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){A=m-x,o[g]<f?(P=0,R=o[g]):o[g]>f?(P=L[O+o[g]],R=T[C+o[g]]):(P=96,R=0),h=1<<m-x,l=1<<b,_=l;do{l-=h,r[p+(M>>x)+l]=A<<24|P<<16|R|0}while(0!==l);for(h=1<<m-1;M&h;)h>>=1;if(0!==h?(M&=h-1,M+=h):M=0,g++,0==--E[m]){if(m===v)break;m=e[i+o[g]]}if(m>y&&(M&d)!==u){for(0===x&&(x=y),p+=_,b=m-x,w=1<<b;b+x<v&&(w-=E[b+x],!(w<=0));)b++,w<<=1;if(S+=1<<b,1===t&&S>852||2===t&&S>592)return 1;u=M&d,r[u]=y<<24|b<<16|p-s|0}}return 0!==M&&(r[p+M]=m-x<<24|64<<16|0),a.bits=y,0};const{Z_FINISH:$b,Z_BLOCK:kb,Z_TREES:zb,Z_OK:Fb,Z_STREAM_END:Bb,Z_NEED_DICT:jb,Z_STREAM_ERROR:Hb,Z_DATA_ERROR:Ub,Z_MEM_ERROR:Vb,Z_BUF_ERROR:Gb,Z_DEFLATED:qb}=fy,Wb=12,Xb=30,Yb=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Zb(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Jb=t=>{if(!t||!t.state)return Hb;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Fb},Kb=t=>{if(!t||!t.state)return Hb;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Jb(t)},Qb=(t,e)=>{let i;if(!t||!t.state)return Hb;const n=t.state;return e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Hb:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,Kb(t))},tx=(t,e)=>{if(!t)return Hb;const i=new Zb;t.state=i,i.window=null;const n=Qb(t,e);return n!==Fb&&(t.state=null),n};let ex,ix,nx=!0;const rx=t=>{if(nx){ex=new Int32Array(512),ix=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Db(1,t.lens,0,288,ex,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Db(2,t.lens,0,32,ix,0,t.work,{bits:5}),nx=!1}t.lencode=ex,t.lenbits=9,t.distcode=ix,t.distbits=5},sx=(t,e,i,n)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(i-n,i-n+r),s.wnext),(n-=r)?(s.window.set(e.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var ox={inflateReset:Kb,inflateReset2:Qb,inflateResetKeep:Jb,inflateInit:t=>tx(t,15),inflateInit2:tx,inflate:(t,e)=>{let i,n,r,s,o,a,c,h,l,u,d,p,f,m,g,_,v,y,b,x,w,S,M=0;const T=new Uint8Array(4);let C,E;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return Hb;i=t.state,i.mode===Wb&&(i.mode=13),o=t.next_out,r=t.output,c=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,h=i.hold,l=i.bits,u=a,d=c,S=Fb;t:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;l<16;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(2&i.wrap&&35615===h){i.check=0,T[0]=255&h,T[1]=h>>>8&255,i.check=dy(i.check,T,2,0),h=0,l=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",i.mode=Xb;break}if((15&h)!==qb){t.msg="unknown compression method",i.mode=Xb;break}if(h>>>=4,l-=4,w=8+(15&h),0===i.wbits)i.wbits=w;else if(w>i.wbits){t.msg="invalid window size",i.mode=Xb;break}i.dmax=1<<i.wbits,t.adler=i.check=1,i.mode=512&h?10:Wb,h=0,l=0;break;case 2:for(;l<16;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(i.flags=h,(255&i.flags)!==qb){t.msg="unknown compression method",i.mode=Xb;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Xb;break}i.head&&(i.head.text=h>>8&1),512&i.flags&&(T[0]=255&h,T[1]=h>>>8&255,i.check=dy(i.check,T,2,0)),h=0,l=0,i.mode=3;case 3:for(;l<32;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}i.head&&(i.head.time=h),512&i.flags&&(T[0]=255&h,T[1]=h>>>8&255,T[2]=h>>>16&255,T[3]=h>>>24&255,i.check=dy(i.check,T,4,0)),h=0,l=0,i.mode=4;case 4:for(;l<16;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}i.head&&(i.head.xflags=255&h,i.head.os=h>>8),512&i.flags&&(T[0]=255&h,T[1]=h>>>8&255,i.check=dy(i.check,T,2,0)),h=0,l=0,i.mode=5;case 5:if(1024&i.flags){for(;l<16;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}i.length=h,i.head&&(i.head.extra_len=h),512&i.flags&&(T[0]=255&h,T[1]=h>>>8&255,i.check=dy(i.check,T,2,0)),h=0,l=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(p=i.length,p>a&&(p=a),p&&(i.head&&(w=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(s,s+p),w)),512&i.flags&&(i.check=dy(i.check,n,p,s)),a-=p,s+=p,i.length-=p),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===a)break t;p=0;do{w=n[s+p++],i.head&&w&&i.length<65536&&(i.head.name+=String.fromCharCode(w))}while(w&&p<a);if(512&i.flags&&(i.check=dy(i.check,n,p,s)),a-=p,s+=p,w)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===a)break t;p=0;do{w=n[s+p++],i.head&&w&&i.length<65536&&(i.head.comment+=String.fromCharCode(w))}while(w&&p<a);if(512&i.flags&&(i.check=dy(i.check,n,p,s)),a-=p,s+=p,w)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;l<16;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(h!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Xb;break}h=0,l=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Wb;break;case 10:for(;l<32;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}t.adler=i.check=Yb(h),h=0,l=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,i.hold=h,i.bits=l,jb;t.adler=i.check=1,i.mode=Wb;case Wb:if(e===kb||e===zb)break t;case 13:if(i.last){h>>>=7&l,l-=7&l,i.mode=27;break}for(;l<3;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}switch(i.last=1&h,h>>>=1,l-=1,3&h){case 0:i.mode=14;break;case 1:if(rx(i),i.mode=20,e===zb){h>>>=2,l-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=Xb}h>>>=2,l-=2;break;case 14:for(h>>>=7&l,l-=7&l;l<32;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Xb;break}if(i.length=65535&h,h=0,l=0,i.mode=15,e===zb)break t;case 15:i.mode=16;case 16:if(p=i.length,p){if(p>a&&(p=a),p>c&&(p=c),0===p)break t;r.set(n.subarray(s,s+p),o),a-=p,s+=p,c-=p,o+=p,i.length-=p;break}i.mode=Wb;break;case 17:for(;l<14;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(i.nlen=257+(31&h),h>>>=5,l-=5,i.ndist=1+(31&h),h>>>=5,l-=5,i.ncode=4+(15&h),h>>>=4,l-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Xb;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;l<3;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}i.lens[I[i.have++]]=7&h,h>>>=3,l-=3}for(;i.have<19;)i.lens[I[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},S=Db(0,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,S){t.msg="invalid code lengths set",i.mode=Xb;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;M=i.lencode[h&(1<<i.lenbits)-1],g=M>>>24,_=M>>>16&255,v=65535&M,!(g<=l);){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(v<16)h>>>=g,l-=g,i.lens[i.have++]=v;else{if(16===v){for(E=g+2;l<E;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(h>>>=g,l-=g,0===i.have){t.msg="invalid bit length repeat",i.mode=Xb;break}w=i.lens[i.have-1],p=3+(3&h),h>>>=2,l-=2}else if(17===v){for(E=g+3;l<E;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}h>>>=g,l-=g,w=0,p=3+(7&h),h>>>=3,l-=3}else{for(E=g+7;l<E;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}h>>>=g,l-=g,w=0,p=11+(127&h),h>>>=7,l-=7}if(i.have+p>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Xb;break}for(;p--;)i.lens[i.have++]=w}}if(i.mode===Xb)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Xb;break}if(i.lenbits=9,C={bits:i.lenbits},S=Db(1,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,S){t.msg="invalid literal/lengths set",i.mode=Xb;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},S=Db(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,S){t.msg="invalid distances set",i.mode=Xb;break}if(i.mode=20,e===zb)break t;case 20:i.mode=21;case 21:if(a>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,i.hold=h,i.bits=l,Ab(t,d),o=t.next_out,r=t.output,c=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,h=i.hold,l=i.bits,i.mode===Wb&&(i.back=-1);break}for(i.back=0;M=i.lencode[h&(1<<i.lenbits)-1],g=M>>>24,_=M>>>16&255,v=65535&M,!(g<=l);){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(_&&0==(240&_)){for(y=g,b=_,x=v;M=i.lencode[x+((h&(1<<y+b)-1)>>y)],g=M>>>24,_=M>>>16&255,v=65535&M,!(y+g<=l);){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}h>>>=y,l-=y,i.back+=y}if(h>>>=g,l-=g,i.back+=g,i.length=v,0===_){i.mode=26;break}if(32&_){i.back=-1,i.mode=Wb;break}if(64&_){t.msg="invalid literal/length code",i.mode=Xb;break}i.extra=15&_,i.mode=22;case 22:if(i.extra){for(E=i.extra;l<E;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}i.length+=h&(1<<i.extra)-1,h>>>=i.extra,l-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;M=i.distcode[h&(1<<i.distbits)-1],g=M>>>24,_=M>>>16&255,v=65535&M,!(g<=l);){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(0==(240&_)){for(y=g,b=_,x=v;M=i.distcode[x+((h&(1<<y+b)-1)>>y)],g=M>>>24,_=M>>>16&255,v=65535&M,!(y+g<=l);){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}h>>>=y,l-=y,i.back+=y}if(h>>>=g,l-=g,i.back+=g,64&_){t.msg="invalid distance code",i.mode=Xb;break}i.offset=v,i.extra=15&_,i.mode=24;case 24:if(i.extra){for(E=i.extra;l<E;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}i.offset+=h&(1<<i.extra)-1,h>>>=i.extra,l-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Xb;break}i.mode=25;case 25:if(0===c)break t;if(p=d-c,i.offset>p){if(p=i.offset-p,p>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Xb;break}p>i.wnext?(p-=i.wnext,f=i.wsize-p):f=i.wnext-p,p>i.length&&(p=i.length),m=i.window}else m=r,f=o-i.offset,p=i.length;p>c&&(p=c),c-=p,i.length-=p;do{r[o++]=m[f++]}while(--p);0===i.length&&(i.mode=21);break;case 26:if(0===c)break t;r[o++]=i.length,c--,i.mode=21;break;case 27:if(i.wrap){for(;l<32;){if(0===a)break t;a--,h|=n[s++]<<l,l+=8}if(d-=c,t.total_out+=d,i.total+=d,d&&(t.adler=i.check=i.flags?dy(i.check,r,d,o-d):ly(i.check,r,d,o-d)),d=c,(i.flags?h:Yb(h))!==i.check){t.msg="incorrect data check",i.mode=Xb;break}h=0,l=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;l<32;){if(0===a)break t;a--,h+=n[s++]<<l,l+=8}if(h!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Xb;break}h=0,l=0}i.mode=29;case 29:S=Bb;break t;case Xb:S=Ub;break t;case 31:return Vb;case 32:default:return Hb}return t.next_out=o,t.avail_out=c,t.next_in=s,t.avail_in=a,i.hold=h,i.bits=l,(i.wsize||d!==t.avail_out&&i.mode<Xb&&(i.mode<27||e!==$b))&&sx(t,t.output,t.next_out,d-t.avail_out),u-=t.avail_in,d-=t.avail_out,t.total_in+=u,t.total_out+=d,i.total+=d,i.wrap&&d&&(t.adler=i.check=i.flags?dy(i.check,r,d,t.next_out-d):ly(i.check,r,d,t.next_out-d)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Wb?128:0)+(20===i.mode||15===i.mode?256:0),(0===u&&0===d||e===$b)&&S===Fb&&(S=Gb),S},inflateEnd:t=>{if(!t||!t.state)return Hb;let e=t.state;return e.window&&(e.window=null),t.state=null,Fb},inflateGetHeader:(t,e)=>{if(!t||!t.state)return Hb;const i=t.state;return 0==(2&i.wrap)?Hb:(i.head=e,e.done=!1,Fb)},inflateSetDictionary:(t,e)=>{const i=e.length;let n,r,s;return t&&t.state?(n=t.state,0!==n.wrap&&11!==n.mode?Hb:11===n.mode&&(r=1,r=ly(r,e,i,0),r!==n.check)?Ub:(s=sx(t,e,i,i),s?(n.mode=31,Vb):(n.havedict=1,Fb))):Hb},inflateInfo:"pako inflate (from Nodeca project)"};var ax=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const cx=Object.prototype.toString,{Z_NO_FLUSH:hx,Z_FINISH:lx,Z_OK:ux,Z_STREAM_END:dx,Z_NEED_DICT:px,Z_STREAM_ERROR:fx,Z_DATA_ERROR:mx,Z_MEM_ERROR:gx}=fy;function _x(t){this.options=lb({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _b,this.strm.avail_out=0;let i=ox.inflateInit2(this.strm,e.windowBits);if(i!==ux)throw new Error(py[i]);if(this.header=new ax,ox.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=fb(e.dictionary):"[object ArrayBuffer]"===cx.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=ox.inflateSetDictionary(this.strm,e.dictionary),i!==ux)))throw new Error(py[i])}function vx(t,e){const i=new _x(e);if(i.push(t),i.err)throw i.msg||py[i.err];return i.result}_x.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?lx:hx,"[object ArrayBuffer]"===cx.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),s=ox.inflate(i,o),s===px&&r&&(s=ox.inflateSetDictionary(i,r),s===ux?s=ox.inflate(i,o):s===mx&&(s=px));i.avail_in>0&&s===dx&&i.state.wrap>0&&0!==t[i.next_in];)ox.inflateReset(i),s=ox.inflate(i,o);switch(s){case fx:case mx:case px:case gx:return this.onEnd(s),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||s===dx))if("string"===this.options.to){let t=gb(i.output,i.next_out),e=i.next_out-t,r=mb(i.output,t);i.next_out=e,i.avail_out=n-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(s!==ux||0!==a){if(s===dx)return s=ox.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},_x.prototype.onData=function(t){this.chunks.push(t)},_x.prototype.onEnd=function(t){t===ux&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=ub(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var yx={Inflate:_x,inflate:vx,inflateRaw:function(t,e){return(e=e||{}).raw=!0,vx(t,e)},ungzip:vx,constants:fy};const{Inflate:bx,inflate:xx,inflateRaw:wx,ungzip:Sx}=yx;var Mx=xx,Tx=function(t,e,i,n,r){var s,o,a=8*r-n-1,c=(1<<a)-1,h=c>>1,l=-7,u=i?r-1:0,d=i?-1:1,p=t[e+u];for(u+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=256*s+t[e+u],u+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=256*o+t[e+u],u+=d,l-=8);if(0===s)s=1-h;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=h}return(p?-1:1)*o*Math.pow(2,s-n)},Cx=function(t,e,i,n,r,s){var o,a,c,h=8*s-r-1,l=(1<<h)-1,u=l>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+u>=1?d/c:d*Math.pow(2,1-u))*c>=2&&(o++,c/=2),o+u>=l?(a=0,o=l):o+u>=1?(a=(e*c-1)*Math.pow(2,r),o+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;t[i+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,h+=r;h>0;t[i+p]=255&o,p+=f,o/=256,h-=8);t[i+p-f]|=128*m},Ex=Ix;
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ix(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ix.Varint=0,Ix.Fixed64=1,Ix.Bytes=2,Ix.Fixed32=5;var Ax=4294967296,Px=1/Ax,Rx="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Lx(t){return t.type===Ix.Bytes?t.readVarint()+t.pos:t.pos+1}function Ox(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Nx(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function Dx(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function $x(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function kx(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function zx(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Fx(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Bx(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function jx(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Hx(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function Ux(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Vx(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Gx(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function qx(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Wx(t){const e=Mx(t,{to:"string"});return JSON.parse(e)}function Xx(t,e){return Yx(t,"GET","arraybuffer",[],null,e)}function Yx(t,e,i,n,r,s){const o=new XMLHttpRequest,a=new Promise(((s,a)=>{o.open(e,t,!0);for(const t of n)o.setRequestHeader(t.name,t.value);o.responseType=i,o.timeout=15e3,o.onload=()=>{var e;if(200!==o.status){const i=null!==(e=o.response)&&void 0!==e?e:new cd(`Response status error: ${t}`);a(i)}o.response||a(new cd(`Response empty: ${t}`)),s(o.response)},o.onerror=()=>{a(new cd(`Request error: ${t}`))},o.ontimeout=()=>{a(new cd(`Request timeout: ${t}`))},o.onabort=()=>{a(new cd(`Request aborted: ${t}`))},o.send("POST"===e?r:null)}));return s&&s.catch((()=>{o.abort()})),a}function Zx(t){return new Ex(t).readFields(Jx,{faces:[],vertices:[]})}function Jx(t,e,i){1===t?e.vertices.push(i.readFloat()):2===t?e.faces.push(i.readVarint()):console.warn(`Unsupported pbf tag (${t})`)}Ix.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,s=this.pos;this.type=7&n,t(r,e,this),this.pos===s&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Vx(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=qx(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Vx(this.buf,this.pos)+Vx(this.buf,this.pos+4)*Ax;return this.pos+=8,t},readSFixed64:function(){var t=Vx(this.buf,this.pos)+qx(this.buf,this.pos+4)*Ax;return this.pos+=8,t},readFloat:function(){var t=Tx(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Tx(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,s=i.buf;if(r=s[i.pos++],n=(112&r)>>4,r<128)return Ox(t,n,e);if(r=s[i.pos++],n|=(127&r)<<3,r<128)return Ox(t,n,e);if(r=s[i.pos++],n|=(127&r)<<10,r<128)return Ox(t,n,e);if(r=s[i.pos++],n|=(127&r)<<17,r<128)return Ox(t,n,e);if(r=s[i.pos++],n|=(127&r)<<24,r<128)return Ox(t,n,e);if(r=s[i.pos++],n|=(1&r)<<31,r<128)return Ox(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Rx?function(t,e,i){return Rx.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){var n="",r=e;for(;r<i;){var s,o,a,c=t[r],h=null,l=c>239?4:c>223?3:c>191?2:1;if(r+l>i)break;1===l?c<128&&(h=c):2===l?128==(192&(s=t[r+1]))&&(h=(31&c)<<6|63&s)<=127&&(h=null):3===l?(s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&((h=(15&c)<<12|(63&s)<<6|63&o)<=2047||h>=55296&&h<=57343)&&(h=null)):4===l&&(s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((h=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,l=1):h>65535&&(h-=65536,n+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),n+=String.fromCharCode(h),r+=l}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ix.Bytes)return t.push(this.readVarint(e));var i=Lx(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ix.Bytes)return t.push(this.readSVarint());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ix.Bytes)return t.push(this.readBoolean());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ix.Bytes)return t.push(this.readFloat());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ix.Bytes)return t.push(this.readDouble());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ix.Bytes)return t.push(this.readFixed32());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ix.Bytes)return t.push(this.readSFixed32());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ix.Bytes)return t.push(this.readFixed64());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ix.Bytes)return t.push(this.readSFixed64());var e=Lx(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ix.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ix.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ix.Fixed32)this.pos+=4;else{if(e!==Ix.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Gx(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Gx(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Gx(this.buf,-1&t,this.pos),Gx(this.buf,Math.floor(t*Px),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Gx(this.buf,-1&t,this.pos),Gx(this.buf,Math.floor(t*Px),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,e),function(t,e){var i=(7&t)<<4;if(e.buf[e.pos++]|=i|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,s=0;s<e.length;s++){if((n=e.charCodeAt(s))>55295&&n<57344){if(!r){n>56319||s+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Nx(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Cx(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Cx(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&Nx(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,Ix.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Dx,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,$x,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Fx,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,kx,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,zx,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Bx,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,jx,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Hx,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Ux,e)},writeBytesField:function(t,e){this.writeTag(t,Ix.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ix.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ix.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ix.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ix.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ix.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ix.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ix.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ix.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ix.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Kx{constructor(){}bboxToCellIds(t,e){throw new cd("Not implemented")}getAdjacent(t){throw new cd("Not implemented")}getVertices(t){throw new cd("Not implemented")}lngLatToCellId(t){throw new cd("Not implemented")}_approxBboxToCellIds(t,e){if(e.lat<=t.lat||e.lng<=t.lng)throw new cd("North east needs to be top right of south west");const i=(t.lat+e.lat)/2,n=(t.lng+e.lng)/2,r=Ju(e.lng,e.lat,0,n,i,0),s=Math.max(r[0],r[1]);return this._lngLatToCellIds({lat:i,lng:n},s)}_enuToGeodetic(t,e){const[i,n]=Ku(t[0],t[1],t[2],e.lng,e.lat,0);return{lat:n,lng:i}}_getLngLatBoundingBoxCorners(t,e){return[[-e,e,0],[e,e,0],[e,-e,0],[-e,-e,0]].map((e=>this._enuToGeodetic(e,t)))}_lngLatToCellIds(t,e){const i=this.lngLatToCellId(t),n=this._getLngLatBoundingBoxCorners(t,e);for(const t of n){if(this.lngLatToCellId(t)!==i)return[i,...this.getAdjacent(i)]}return[i]}}class Qx extends Hf{constructor(t){if(super(),this._geometry=t,!(this._geometry instanceof Kx))throw new cd("The data provider requires a geometry provider base instance.")}get geometry(){return this._geometry}fire(t,e){super.fire(t,e)}getCoreImages(t){return Promise.reject(new cd("Not implemented"))}getCluster(t,e){return Promise.reject(new cd("Not implemented"))}getSpatialImages(t){return Promise.reject(new cd("Not implemented"))}getImages(t){return Promise.reject(new cd("Not implemented"))}getImageBuffer(t,e){return Promise.reject(new cd("Not implemented"))}getImageTiles(t){return Promise.reject(new cd("Not implemented"))}getMesh(t,e){return Promise.reject(new cd("Not implemented"))}getSequence(t){return Promise.reject(new cd("Not implemented"))}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}setAccessToken(t){throw new cd("Not implemented")}}var tw=wp((function(t){
/**
     * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
     * Released under the Apache License, Version 2.0
     * see: https://github.com/dcodeIO/long.js for details
     */
!function(e,i){t&&t.exports?t.exports=i():(e.dcodeIO=e.dcodeIO||{}).Long=i()}(bp,(function(){function t(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function e(t){return!0===(t&&t.__isLong__)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var i={},n={};function r(t,e){var r,s,a;return e?(a=0<=(t>>>=0)&&t<256)&&(s=n[t])?s:(r=o(t,(0|t)<0?-1:0,!0),a&&(n[t]=r),r):(a=-128<=(t|=0)&&t<128)&&(s=i[t])?s:(r=o(t,t<0?-1:0,!1),a&&(i[t]=r),r)}function s(t,e){if(isNaN(t)||!isFinite(t))return e?m:f;if(e){if(t<0)return m;if(t>=u)return b}else{if(t<=-d)return x;if(t+1>=d)return y}return t<0?s(-t,e).neg():o(t%l|0,t/l|0,e)}function o(e,i,n){return new t(e,i,n)}t.fromInt=r,t.fromNumber=s,t.fromBits=o;var a=Math.pow;function c(t,e,i){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return f;if("number"==typeof e?(i=e,e=!1):e=!!e,(i=i||10)<2||36<i)throw RangeError("radix");var n;if((n=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return c(t.substring(1),e,i).neg();for(var r=s(a(i,8)),o=f,h=0;h<t.length;h+=8){var l=Math.min(8,t.length-h),u=parseInt(t.substring(h,h+l),i);if(l<8){var d=s(a(i,l));o=o.mul(d).add(s(u))}else o=(o=o.mul(r)).add(s(u))}return o.unsigned=e,o}function h(e){return e instanceof t?e:"number"==typeof e?s(e):"string"==typeof e?c(e):o(e.low,e.high,e.unsigned)}t.fromString=c,t.fromValue=h;var l=4294967296,u=l*l,d=u/2,p=r(1<<24),f=r(0);t.ZERO=f;var m=r(0,!0);t.UZERO=m;var g=r(1);t.ONE=g;var _=r(1,!0);t.UONE=_;var v=r(-1);t.NEG_ONE=v;var y=o(-1,2147483647,!1);t.MAX_VALUE=y;var b=o(-1,-1,!0);t.MAX_UNSIGNED_VALUE=b;var x=o(0,-2147483648,!1);t.MIN_VALUE=x;var w=t.prototype;return w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var e=s(t),i=this.div(e),n=i.mul(e).sub(this);return i.toString(t)+n.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var r=s(a(t,6),this.unsigned),o=this,c="";;){var h=o.div(r),l=(o.sub(h.mul(r)).toInt()>>>0).toString(t);if((o=h).isZero())return l+c;for(;l.length<6;)l="0"+l;c=""+l+c}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},w.isZero=function(){return 0===this.high&&0===this.low},w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return e(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.greaterThan=function(t){return this.comp(t)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return this.comp(t)>=0},w.gte=w.greaterThanOrEqual,w.compare=function(t){if(e(t)||(t=h(t)),this.eq(t))return 0;var i=this.isNegative(),n=t.isNegative();return i&&!n?-1:!i&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(g)},w.neg=w.negate,w.add=function(t){e(t)||(t=h(t));var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,a=t.high>>>16,c=65535&t.high,l=t.low>>>16,u=0,d=0,p=0,f=0;return p+=(f+=s+(65535&t.low))>>>16,d+=(p+=r+l)>>>16,u+=(d+=n+c)>>>16,u+=i+a,o((p&=65535)<<16|(f&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},w.subtract=function(t){return e(t)||(t=h(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){if(this.isZero())return f;if(e(t)||(t=h(t)),t.isZero())return f;if(this.eq(x))return t.isOdd()?x:f;if(t.eq(x))return this.isOdd()?x:f;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(p)&&t.lt(p))return s(this.toNumber()*t.toNumber(),this.unsigned);var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,a=65535&this.low,c=t.high>>>16,l=65535&t.high,u=t.low>>>16,d=65535&t.low,m=0,g=0,_=0,v=0;return _+=(v+=a*d)>>>16,g+=(_+=r*d)>>>16,_&=65535,g+=(_+=a*u)>>>16,m+=(g+=n*d)>>>16,g&=65535,m+=(g+=r*u)>>>16,g&=65535,m+=(g+=a*l)>>>16,m+=i*d+n*u+r*l+a*c,o((_&=65535)<<16|(v&=65535),(m&=65535)<<16|(g&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(t){if(e(t)||(t=h(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?m:f;var i,n,r;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return m;if(t.gt(this.shru(1)))return _;r=m}else{if(this.eq(x))return t.eq(g)||t.eq(v)?x:t.eq(x)?g:(i=this.shr(1).div(t).shl(1)).eq(f)?t.isNegative()?g:v:(n=this.sub(t.mul(i)),r=i.add(n.div(t)));if(t.eq(x))return this.unsigned?m:f;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=f}for(n=this;n.gte(t);){i=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(i)/Math.LN2),c=o<=48?1:a(2,o-48),l=s(i),u=l.mul(t);u.isNegative()||u.gt(n);)u=(l=s(i-=c,this.unsigned)).mul(t);l.isZero()&&(l=g),r=r.add(l),n=n.sub(u)}return r},w.div=w.divide,w.modulo=function(t){return e(t)||(t=h(t)),this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.not=function(){return o(~this.low,~this.high,this.unsigned)},w.and=function(t){return e(t)||(t=h(t)),o(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return e(t)||(t=h(t)),o(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return e(t)||(t=h(t)),o(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?o(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):o(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?o(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):o(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),0===(t&=63))return this;var i=this.high;return t<32?o(this.low>>>t|i<<32-t,i>>>t,this.unsigned):o(32===t?i:i>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},w.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t}))})),ew=wp((function(t){!function(t){var e=t.S2={L:{}};e.L.LatLng=function(t,e,i){var n=parseFloat(t,10),r=parseFloat(e,10);if(isNaN(n)||isNaN(r))throw new Error("Invalid LatLng object: ("+t+", "+e+")");return!0!==i&&(n=Math.max(Math.min(n,90),-90),r=(r+180)%360+(r<-180||180===r?180:-180)),{lat:n,lng:r}},e.L.LatLng.DEG_TO_RAD=Math.PI/180,e.L.LatLng.RAD_TO_DEG=180/Math.PI,e.LatLngToXYZ=function(t){var i=e.L.LatLng.DEG_TO_RAD,n=t.lat*i,r=t.lng*i,s=Math.cos(n);return[Math.cos(r)*s,Math.sin(r)*s,Math.sin(n)]},e.XYZToLatLng=function(t){var i=e.L.LatLng.RAD_TO_DEG,n=Math.atan2(t[2],Math.sqrt(t[0]*t[0]+t[1]*t[1])),r=Math.atan2(t[1],t[0]);return e.L.LatLng(n*i,r*i)};e.XYZToFaceUV=function(t){var e=function(t){var e=[Math.abs(t[0]),Math.abs(t[1]),Math.abs(t[2])];return e[0]>e[1]?e[0]>e[2]?0:2:e[1]>e[2]?1:2}(t);return t[e]<0&&(e+=3),[e,function(t,e){var i,n;switch(t){case 0:i=e[1]/e[0],n=e[2]/e[0];break;case 1:i=-e[0]/e[1],n=e[2]/e[1];break;case 2:i=-e[0]/e[2],n=-e[1]/e[2];break;case 3:i=e[2]/e[0],n=e[1]/e[0];break;case 4:i=e[2]/e[1],n=-e[0]/e[1];break;case 5:i=-e[1]/e[2],n=-e[0]/e[2];break;default:throw{error:"Invalid face"}}return[i,n]}(e,t)]},e.FaceUVToXYZ=function(t,e){var i=e[0],n=e[1];switch(t){case 0:return[1,i,n];case 1:return[-i,1,n];case 2:return[-i,-n,1];case 3:return[-1,-n,-i];case 4:return[n,-1,-i];case 5:return[n,i,-1];default:throw{error:"Invalid face"}}};var i=function(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))};e.STToUV=function(t){return[i(t[0]),i(t[1])]};var n=function(t){return t>=0?.5*Math.sqrt(1+3*t):1-.5*Math.sqrt(1-3*t)};e.UVToST=function(t){return[n(t[0]),n(t[1])]},e.STToIJ=function(t,e){var i=1<<e,n=function(t){var e=Math.floor(t*i);return Math.max(0,Math.min(i-1,e))};return[n(t[0]),n(t[1])]},e.IJToST=function(t,e,i){var n=1<<e;return[(t[0]+i[0])/n,(t[1]+i[1])/n]};var r=function(t,e,i,n){if(0==n){1==i&&(e.x=t-1-e.x,e.y=t-1-e.y);var r=e.x;e.x=e.y,e.y=r}},s=function(t,e,i,n){var r={a:[[0,"d"],[1,"a"],[3,"b"],[2,"a"]],b:[[2,"b"],[1,"b"],[3,"a"],[0,"c"]],c:[[2,"c"],[3,"d"],[1,"c"],[0,"b"]],d:[[0,"a"],[3,"c"],[1,"d"],[2,"d"]]};"number"!=typeof n&&console.warn(new Error("called pointToHilbertQuadList without face value, defaulting to '0'").stack);for(var s=n%2?"d":"a",o=[],a=i-1;a>=0;a--){var c=1<<a,h=r[s][2*(t&c?1:0)+(e&c?1:0)];o.push(h[0]),s=h[1]}return o};e.S2Cell=function(){},e.S2Cell.FromHilbertQuadKey=function(t){var i,n,s,o,a,c,h=t.split("/"),l=parseInt(h[0]),u=h[1],d=u.length,p={x:0,y:0};for(i=d-1;i>=0;i--)n=d-i,o=0,a=0,"1"===(s=u[i])?a=1:"2"===s?(o=1,a=1):"3"===s&&(o=1),c=Math.pow(2,n-1),r(c,p,o,a),p.x+=c*o,p.y+=c*a;if(l%2==1){var f=p.x;p.x=p.y,p.y=f}return e.S2Cell.FromFaceIJ(parseInt(l),[p.x,p.y],n)},e.S2Cell.FromLatLng=function(t,i){if(!t.lat&&0!==t.lat||!t.lng&&0!==t.lng)throw new Error("Pass { lat: lat, lng: lng } to S2.S2Cell.FromLatLng");var n=e.LatLngToXYZ(t),r=e.XYZToFaceUV(n),s=e.UVToST(r[1]),o=e.STToIJ(s,i);return e.S2Cell.FromFaceIJ(r[0],o,i)},e.S2Cell.FromFaceIJ=function(t,i,n){var r=new e.S2Cell;return r.face=t,r.ij=i,r.level=n,r},e.S2Cell.prototype.toString=function(){return"F"+this.face+"ij["+this.ij[0]+","+this.ij[1]+"]@"+this.level},e.S2Cell.prototype.getLatLng=function(){var t=e.IJToST(this.ij,this.level,[.5,.5]),i=e.STToUV(t),n=e.FaceUVToXYZ(this.face,i);return e.XYZToLatLng(n)},e.S2Cell.prototype.getCornerLatLngs=function(){for(var t=[],i=[[0,0],[0,1],[1,1],[1,0]],n=0;n<4;n++){var r=e.IJToST(this.ij,this.level,i[n]),s=e.STToUV(r),o=e.FaceUVToXYZ(this.face,s);t.push(e.XYZToLatLng(o))}return t},e.S2Cell.prototype.getFaceAndQuads=function(){var t=s(this.ij[0],this.ij[1],this.level,this.face);return[this.face,t]},e.S2Cell.prototype.toHilbertQuadkey=function(){var t=s(this.ij[0],this.ij[1],this.level,this.face);return this.face.toString(10)+"/"+t.join("")},e.latLngToNeighborKeys=e.S2Cell.latLngToNeighborKeys=function(t,i,n){return e.S2Cell.FromLatLng({lat:t,lng:i},n).getNeighbors().map((function(t){return t.toHilbertQuadkey()}))},e.S2Cell.prototype.getNeighbors=function(){var t=function(t,i,n){var r=1<<n;if(i[0]>=0&&i[1]>=0&&i[0]<r&&i[1]<r)return e.S2Cell.FromFaceIJ(t,i,n);var s=e.IJToST(i,n,[.5,.5]),o=e.STToUV(s),a=e.FaceUVToXYZ(t,o),c=e.XYZToFaceUV(a);return t=c[0],o=c[1],s=e.UVToST(o),i=e.STToIJ(s,n),e.S2Cell.FromFaceIJ(t,i,n)},i=this.face,n=this.ij[0],r=this.ij[1],s=this.level;return[t(i,[n-1,r],s),t(i,[n,r-1],s),t(i,[n+1,r],s),t(i,[n,r+1],s)]},e.FACE_BITS=3,e.MAX_LEVEL=30,e.POS_BITS=2*e.MAX_LEVEL+1,e.facePosLevelToId=e.S2Cell.facePosLevelToId=e.fromFacePosLevel=function(i,n,r){var s,o,a,c=t.dcodeIO&&t.dcodeIO.Long||tw;for(r||(r=n.length),n.length>r&&(n=n.substr(0,r)),s=c.fromString(i.toString(10),!0,10).toString(2);s.length<e.FACE_BITS;)s="0"+s;for(o=c.fromString(n,!0,4).toString(2);o.length<2*r;)o="0"+o;for(a=s+o,a+="1";a.length<e.FACE_BITS+e.POS_BITS;)a+="0";return c.fromString(a,!0,2).toString(10)},e.keyToId=e.S2Cell.keyToId=e.toId=e.toCellId=e.fromKey=function(t){var i=t.split("/");return e.fromFacePosLevel(i[0],i[1],i[1].length)},e.idToKey=e.S2Cell.idToKey=e.S2Cell.toKey=e.toKey=e.fromId=e.fromCellId=e.S2Cell.toHilbertQuadkey=e.toHilbertQuadkey=function(i){for(var n=t.dcodeIO&&t.dcodeIO.Long||tw,r=n.fromString(i,!0,10).toString(2);r.length<e.FACE_BITS+e.POS_BITS;)r="0"+r;for(var s=r.lastIndexOf("1"),o=r.substring(0,3),a=r.substring(3,s),c=a.length/2,h=n.fromString(o,!0,2).toString(10),l=n.fromString(a,!0,2).toString(4);l.length<c;)l="0"+l;return h+"/"+l},e.keyToLatLng=e.S2Cell.keyToLatLng=function(t){return e.S2Cell.FromHilbertQuadKey(t).getLatLng()},e.idToLatLng=e.S2Cell.idToLatLng=function(t){var i=e.idToKey(t);return e.keyToLatLng(i)},e.S2Cell.latLngToKey=e.latLngToKey=e.latLngToQuadkey=function(t,i,n){if(isNaN(n)||n<1||n>30)throw new Error("'level' is not a number between 1 and 30 (but it should be)");return e.S2Cell.FromLatLng({lat:t,lng:i},n).toHilbertQuadkey()},e.stepKey=function(e,i){var n,r=t.dcodeIO&&t.dcodeIO.Long||tw,s=e.split("/"),o=s[0],a=s[1],c=s[1].length,h=r.fromString(a,!0,4);i>0?n=h.add(Math.abs(i)):i<0&&(n=h.subtract(Math.abs(i)));var l=n.toString(4);for("0"===l&&console.warning(new Error("face/position wrapping is not yet supported"));l.length<c;)l="0"+l;return o+"/"+l},e.S2Cell.prevKey=e.prevKey=function(t){return e.stepKey(t,-1)},e.S2Cell.nextKey=e.nextKey=function(t){return e.stepKey(t,1)}}(t.exports)}));class iw extends Kx{constructor(t=17){super(),this._level=t}bboxToCellIds(t,e){return this._approxBboxToCellIds(t,e)}getAdjacent(t){const e=ew.S2.idToKey(t),i=e.split("/")[1].length,[n,r,s,o]=this._getNeighbors(e,i),a=[e,n,r,s,o],c=Array.from(new Set([...this._getNeighbors(n,i),...this._getNeighbors(r,i),...this._getNeighbors(s,i),...this._getNeighbors(o,i)].filter((t=>!a.includes(t))))),h=[n,r,s,o];for(const t of c){let e=0;for(const n of this._getNeighbors(t,i))a.includes(n)&&e++;2===e&&h.push(t)}return h.map((t=>ew.S2.keyToId(t)))}getVertices(t){const e=ew.S2.idToKey(t);return ew.S2.S2Cell.FromHilbertQuadKey(e).getCornerLatLngs().map((t=>({lat:t.lat,lng:t.lng})))}lngLatToCellId(t){return this._lngLatToId(t,this._level)}_getNeighbors(t,e){const i=ew.S2.keyToLatLng(t);return ew.S2.latLngToNeighborKeys(i.lat,i.lng,e)}_lngLatToId(t,e){const i=ew.S2.latLngToKey(t.lat,t.lng,e);return ew.S2.keyToId(i)}}class nw{clusterReconstruction(t){const e=t.points,i=1/255;for(const t in e){if(!e.hasOwnProperty(t))continue;const n=e[t].color;n[0]*=i,n[1]*=i,n[2]*=i}const n=t.reference_lla;return{id:null,points:e,reference:{alt:n.altitude,lat:n.latitude,lng:n.longitude}}}coreImage(t){const e=this._geometry(t.geometry),i=this._geometry(t.computed_geometry),n={id:t.sequence};return{computed_geometry:i,geometry:e,id:t.id,sequence:n}}spatialImage(t){var e,i,n,r;t.camera_type=function(t){switch(t){case"equirectangular":case"spherical":return"spherical";case"fisheye":return"fisheye";default:return"perspective"}}(t.camera_type),t.merge_id=t.merge_cc?t.merge_cc.toString():null,t.private=null;const s="spherical"===t.camera_type?t.thumb_2048_url:t.thumb_1024_url;return t.thumb=null!==(e=t.thumb)&&void 0!==e?e:{id:null,url:s},t.cluster=null!==(i=t.sfm_cluster)&&void 0!==i?i:{id:null,url:null},t.creator={id:null,username:null},t.owner=null!==(n=t.owner)&&void 0!==n?n:{id:null},t.mesh=null!==(r=t.mesh)&&void 0!==r?r:{id:null,url:null},t}_geometry(t){const e=null==t?void 0:t.coordinates;return e?{lat:e[1],lng:e[0]}:null}}class rw{constructor(){this.imagesPath="images",this.sequencePath="image_ids",this._imageTilesPath="tiles",this.coreFields=["computed_geometry","geometry","sequence"],this.idFields=["id"],this.spatialFields=["altitude","atomic_scale","camera_parameters","camera_type","captured_at","compass_angle","computed_altitude","computed_compass_angle","computed_rotation","exif_orientation","height","merge_cc","mesh","quality_score","sfm_cluster","thumb_1024_url","thumb_2048_url","width"],this.imageTileFields=["url","z","x","y"]}images(t,e){return`image_ids=${t.join(",")}&fields=${e.join(",")}`}imagesS2(t,e){return`s2=${t}&fields=${e.join(",")}`}imageTiles(t,e){return`z=${t}&fields=${e.join(",")}`}imageTilesPath(t){return`${t}/${this._imageTilesPath}`}sequence(t){return`sequence_id=${t}`}}class sw extends Qx{constructor(t,e,i,n){var r;super(null!=e?e:new iw),this._convert=null!=i?i:new nw,this._query=null!=n?n:new rw,this._method="GET";const s=null!=t?t:{};this._endpoint=null!==(r=s.endpoint)&&void 0!==r?r:"https://graph.mapillary.com",this._accessToken=s.accessToken}getCluster(t,e){return Xx(t,e).then((t=>{const e=Wx(t);if(e.length<1)throw new Error("Cluster reconstruction empty");return this._convert.clusterReconstruction(e[0])}))}getCoreImages(t){const e=[...this._query.idFields,...this._query.coreFields],i=this._query.imagesS2(t,e),n=new URL(this._query.imagesPath,this._endpoint).href;return this._fetchGraphContract(i,n).then((e=>{const i={cell_id:t,images:[]},n=e.data;for(const t of n){const e=this._convert.coreImage(t);i.images.push(e)}return i}))}getImageBuffer(t,e){return Xx(t,e)}getImages(t){const e=[...this._query.idFields,...this._query.coreFields,...this._query.spatialFields],i=this._query.images(t,e),n=new URL(this._query.imagesPath,this._endpoint).href;return this._fetchGraphContract(i,n).then((t=>{const e=[],i=t.data;for(const t of i){const i=this._convert.coreImage(t),n=this._convert.spatialImage(t),r={node:Object.assign({},n,i),node_id:t.id};e.push(r)}return e}))}getImageTiles(t){const e=[...this._query.imageTileFields],i=this._query.imageTiles(t.z,e),n=new URL(this._query.imageTilesPath(t.imageId),this._endpoint).href;return this._fetchGraphContract(i,n).then((e=>({node:e.data,node_id:t.imageId})))}getMesh(t,e){return Xx(t,e).then((t=>Zx(t)))}getSequence(t){const e=this._query.sequence(t),i=new URL(this._query.sequencePath,this._endpoint).href;return this._fetchGraphContract(e,i).then((e=>({id:t,image_ids:e.data.map((t=>t.id))})))}getSpatialImages(t){const e=[...this._query.idFields,...this._query.coreFields,...this._query.spatialFields],i=this._query.images(t,e),n=new URL(this._query.imagesPath,this._endpoint).href;return this._fetchGraphContract(i,n).then((t=>{const e=[],i=t.data;for(const t of i){const i={node:this._convert.spatialImage(t),node_id:t.id};e.push(i)}return e}))}setAccessToken(t){this._accessToken=t}_createHeaders(){const t=[{name:"Accept",value:"application/json"},{name:"Content-Type",value:"application/x-www-form-urlencoded"}];return this._accessToken&&t.push({name:"Authorization",value:`OAuth ${this._accessToken}`}),t}_fetchGraphContract(t,e){return Yx(`${e}?${t}`,this._method,"json",this._createHeaders(),null,null).catch((t=>{const e=this._makeErrorMessage(t);throw new cd(e)}))}_makeErrorMessage(t){const e=t.error;return e?`${e.code} (${e.type}, ${e.fbtrace_id}): ${e.message}`:"Failed to fetch data"}}class ow{constructor(t,e){this._id=t,this._lngLat=e}get id(){return this._id}get geometry(){return this._geometry}get lngLat(){return this._lngLat}createGeometry(t){this._geometry||(this._createGeometry(t),this._geometry.updateMatrixWorld(!0))}disposeGeometry(){this._geometry&&(this._disposeGeometry(),this._geometry=void 0)}getInteractiveObjects(){return this._geometry?this._getInteractiveObjects():[]}lerpAltitude(t,e){this._geometry&&(this._geometry.position.z=(1-e)*this._geometry.position.z+e*t)}updatePosition(t,e){e&&(this._lngLat.lat=e.lat,this._lngLat.lng=e.lng),this._geometry&&(this._geometry.position.fromArray(t),this._geometry.updateMatrixWorld(!0))}}let aw;function cw(){return void 0===aw&&(aw=function(){const t={alpha:!1,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!0},e=document.createElement("canvas");if(e.getContext("webgl2",t))return!0;const i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);if(!i)return!1;const n=["OES_standard_derivatives"],r=i.getSupportedExtensions();for(const t of n)if(-1===r.indexOf(t))return!1;return!0}()),aw}function hw(){return"undefined"!=typeof window&&"undefined"!=typeof document&&!!(Array.prototype&&Array.prototype.concat&&Array.prototype.filter&&Array.prototype.includes&&Array.prototype.indexOf&&Array.prototype.join&&Array.prototype.map&&Array.prototype.push&&Array.prototype.pop&&Array.prototype.reverse&&Array.prototype.shift&&Array.prototype.slice&&Array.prototype.splice&&Array.prototype.sort&&Array.prototype.unshift)&&"Blob"in window&&"URL"in window&&!!(Function.prototype&&Function.prototype.apply&&Function.prototype.bind)&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&"Map"in window&&!!(Object.assign&&Object.keys&&Object.values)&&!!("Promise"in window&&Promise.resolve&&Promise.reject&&Promise.prototype&&Promise.prototype.catch&&Promise.prototype.then)&&"Set"in window}var lw,uw;t.CameraControls=void 0,(lw=t.CameraControls||(t.CameraControls={}))[lw.Custom=0]="Custom",lw[lw.Earth=1]="Earth",lw[lw.Street=2]="Street",t.RenderMode=void 0,(uw=t.RenderMode||(t.RenderMode={}))[uw.Letterbox=0]="Letterbox",uw[uw.Fill=1]="Fill",t.RenderPass=void 0,function(t){t[t.Opaque=0]="Opaque"}(t.RenderPass||(t.RenderPass={}));class dw{constructor(t,e,i,n,r,s){this._container=t,this._observer=i,this._navigator=e,this._options=null!=r?r:{},this._key=n,this._navigable=null==n,this._componentService=s||new Wd(this._container,this._navigator),this._coverComponent=this._componentService.getCover(),this._initializeComponents(),n?(this._initilizeCoverComponent(),this._subscribeCoverComponent()):this._navigator.movedToId$.pipe(Ee((t=>null!=t))).subscribe((t=>{this._key=t,this._componentService.deactivateCover(),this._coverComponent.configure({id:this._key,state:Ff.Hidden}),this._subscribeCoverComponent(),this._navigator.stateService.start(),this._navigator.cacheService.start(),this._navigator.panService.start(),this._observer.startEmit()}))}get navigable(){return this._navigable}get(t){return this._componentService.get(t)}activate(t){this._componentService.activate(t)}activateCover(){this._coverComponent.configure({state:Ff.Visible})}deactivate(t){this._componentService.deactivate(t)}deactivateCover(){this._coverComponent.configure({state:Ff.Loading})}remove(){this._componentService.remove(),null!=this._configurationSubscription&&this._configurationSubscription.unsubscribe()}_initializeComponents(){var t,e;const i=this._options;this._uFalse(null===(t=i.fallback)||void 0===t?void 0:t.image,"imagefallback"),this._uFalse(null===(e=i.fallback)||void 0===e?void 0:e.navigation,"navigationfallback"),this._uFalse(i.marker,"marker"),this._uFalse(i.popup,"popup"),this._uFalse(i.slider,"slider"),this._uFalse(i.spatial,"spatial"),this._uFalse(i.tag,"tag"),this._uTrue(i.attribution,"attribution"),this._uTrue(i.bearing,"bearing"),this._uTrue(i.cache,"cache"),this._uTrue(i.direction,"direction"),this._uTrue(i.image,"image"),this._uTrue(i.keyboard,"keyboard"),this._uTrue(i.pointer,"pointer"),this._uTrue(i.sequence,"sequence"),this._uTrue(i.zoom,"zoom")}_initilizeCoverComponent(){let t=this._options;this._coverComponent.configure({id:this._key}),void 0===t.cover||t.cover?this.activateCover():this.deactivateCover()}_setNavigable(t){this._navigable!==t&&(this._navigable=t,this._observer.navigable$.next(t))}_subscribeCoverComponent(){this._configurationSubscription=this._coverComponent.configuration$.pipe(ue(void 0,(t=>t.state))).subscribe((t=>{t.state===Ff.Loading?this._navigator.stateService.currentId$.pipe(Ee(),ri((e=>{const i=null==e||e!==t.id;return i&&this._setNavigable(!1),i?this._navigator.moveTo$(t.id):this._navigator.stateService.currentImage$.pipe(Ee())}))).subscribe((()=>{this._navigator.stateService.start(),this._navigator.cacheService.start(),this._navigator.panService.start(),this._observer.startEmit(),this._coverComponent.configure({state:Ff.Hidden}),this._componentService.deactivateCover(),this._setNavigable(!0)}),(t=>{console.error("Failed to deactivate cover.",t),this._coverComponent.configure({state:Ff.Visible})})):t.state===Ff.Visible&&(this._observer.stopEmit(),this._navigator.stateService.stop(),this._navigator.cacheService.stop(),this._navigator.playService.stop(),this._navigator.panService.stop(),this._componentService.activateCover(),this._setNavigable(null==t.id))}))}_uFalse(t,e){void 0!==t?"boolean"!=typeof t?(this._componentService.configure(e,t),this._componentService.activate(e)):t?this._componentService.activate(e):this._componentService.deactivate(e):this._componentService.deactivate(e)}_uTrue(t,e){void 0!==t?"boolean"!=typeof t?(this._componentService.configure(e,t),this._componentService.activate(e)):t?this._componentService.activate(e):this._componentService.deactivate(e):this._componentService.activate(e)}}class pw{constructor(e,i,n){this._adaptiveOperation$=new T,this._render$=new T,this._renderAdaptive$=new T,this._subscriptions=new Uf,this._renderService=i,this._currentFrame$=n;const r=this._subscriptions,s=jf.create(jf.h("div.mapillary-dom-renderer",[]));e.appendChild(s),this._offset$=this._adaptiveOperation$.pipe(Le(((t,e)=>e(t)),{elementHeight:e.offsetHeight,elementWidth:e.offsetWidth,imageAspect:0,renderMode:t.RenderMode.Fill}),Nt((t=>t.imageAspect>0&&t.elementWidth>0&&t.elementHeight>0)),rt((e=>{const i=e.elementWidth/e.elementHeight,n=e.imageAspect/i;let r=0,s=0;return e.renderMode===t.RenderMode.Letterbox?e.imageAspect>i?r=e.elementHeight*(1-1/n)/2:s=e.elementWidth*(1-n)/2:e.imageAspect>i?s=-e.elementWidth*(n-1)/2:r=-e.elementHeight*(1/n-1)/2,{bottom:r,left:s,right:s,top:r}})));const o=this._currentFrame$.pipe(Nt((t=>null!=t.state.currentImage)),ue(((t,e)=>t===e),(t=>t.state.currentImage.id)),rt((t=>t.state.currentTransform.basicAspect)),rt((t=>e=>(e.imageAspect=t,e)))).subscribe(this._adaptiveOperation$),a=gt(this._renderAdaptive$.pipe(Le(((t,e)=>(null==e.vNode?delete t[e.name]:t[e.name]=e.vNode,t)),{})),this._offset$).pipe(rt((t=>{const e=[],i=t[0];for(const t in i)i.hasOwnProperty(t)&&e.push(i[t]);const n=t[1],r={style:{bottom:n.bottom+"px",left:n.left+"px","pointer-events":"none",position:"absolute",right:n.right+"px",top:n.top+"px"}};return{name:"mapillary-dom-adaptive-renderer",vNode:jf.h("div.mapillary-dom-adaptive-renderer",r,e)}}))).subscribe(this._render$);this._vNode$=this._render$.pipe(Le(((t,e)=>(null==e.vNode?delete t[e.name]:t[e.name]=e.vNode,t)),{}),rt((t=>{const e=[];for(const i in t)t.hasOwnProperty(i)&&e.push(t[i]);return jf.h("div.mapillary-dom-renderer",e)}))),this._vPatch$=this._vNode$.pipe(Le(((t,e)=>(t.vpatch=jf.diff(t.vNode,e),t.vNode=e,t)),{vNode:jf.h("div.mapillary-dom-renderer",[]),vpatch:null}),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.length;if(0===i)throw new Error("list of properties cannot be empty.");return function(e){return rt(je(t,i))(e)}}("vpatch")),this._element$=this._vPatch$.pipe(Le(((t,e)=>jf.patch(t,e)),s),Ue(1),E()),r.push(o),r.push(a),r.push(this._element$.subscribe((()=>{}))),r.push(this._renderService.size$.pipe(rt((t=>e=>(e.elementWidth=t.width,e.elementHeight=t.height,e)))).subscribe(this._adaptiveOperation$)),r.push(this._renderService.renderMode$.pipe(rt((t=>e=>(e.renderMode=t,e)))).subscribe(this._adaptiveOperation$))}get element$(){return this._element$}get render$(){return this._render$}get renderAdaptive$(){return this._renderAdaptive$}clear(t){this._renderAdaptive$.next({name:t,vNode:null}),this._render$.next({name:t,vNode:null})}remove(){this._subscriptions.unsubscribe()}}class fw{constructor(t,e,i){this._renderFrame$=new T,this._renderCameraOperation$=new T,this._render$=new T,this._clear$=new T,this._renderOperation$=new T,this._rendererOperation$=new T,this._eraserOperation$=new T,this._triggerOperation$=new T,this._subscriptions=new Uf,this._opaqueRender$=new T,this._renderService=i;const n=this._subscriptions;this._renderer$=this._rendererOperation$.pipe(Le(((t,e)=>e(t)),{needsRender:!1,renderer:null}),Nt((t=>!!t.renderer))),this._renderCollection$=this._renderOperation$.pipe(Le(((t,e)=>e(t)),{}),Ze()),this._renderCamera$=this._renderCameraOperation$.pipe(Le(((t,e)=>e(t)),{frameId:-1,needsRender:!1,perspective:null})),this._eraser$=this._eraserOperation$.pipe(ni((t=>t)),Le(((t,e)=>e(t)),{needsRender:!1}));const r=this._triggerOperation$.pipe(ni((t=>t)),Le(((t,e)=>e(t)),{needsRender:!1})),s=new Dr(986895),o=gt(this._renderer$,this._renderCollection$,this._renderCamera$,this._eraser$,r).pipe(rt((([t,e,i,n,r])=>({camera:i,eraser:n,trigger:r,renderer:t,renders:Object.keys(e).map((t=>e[t]))}))),Nt((t=>{let e=t.renderer.needsRender||t.camera.needsRender||t.eraser.needsRender||t.trigger.needsRender;const i=t.camera.frameId;for(const n of t.renders){if(n.frameId!==i)return!1;e=e||n.needsRender}return e})),ue(((t,e)=>t===e),(t=>t.eraser.needsRender||t.trigger.needsRender?-t.camera.frameId:t.camera.frameId))).subscribe((t=>{t.renderer.needsRender=!1,t.camera.needsRender=!1,t.eraser.needsRender=!1,t.trigger.needsRender=!1;const e=t.camera.perspective,i=[],n=[];for(const e of t.renders)e.pass===rm.Background?i.push(e.render):e.pass===rm.Opaque&&n.push(e.render);const r=t.renderer.renderer;r.resetState(),r.setClearColor(s,1),r.clear();for(const t of i)t(e,r);r.clearDepth();for(const t of n)t(e,r);r.resetState(),this._opaqueRender$.next()}));n.push(o),n.push(this._renderFrame$.pipe(rt((t=>e=>(e.frameId=t.frameId,e.perspective=t.perspective,!0===t.changed&&(e.needsRender=!0),e)))).subscribe(this._renderCameraOperation$)),this._renderFrameSubscribe();const a=this._render$.pipe(rt((t=>e=>(e[t.name]=t.renderer,e)))),c=this._clear$.pipe(rt((t=>e=>(delete e[t],e))));n.push(Ot(a,c).subscribe(this._renderOperation$)),this._webGLRenderer$=this._render$.pipe(Ee(),rt((()=>{e.appendChild(t);const n=i.element,r=new Ja({canvas:t});return r.setPixelRatio(window.devicePixelRatio),r.setSize(n.offsetWidth,n.offsetHeight),r.autoClear=!1,r})),Ue(1),E()),n.push(this._webGLRenderer$.subscribe((()=>{})));const h=this._webGLRenderer$.pipe(Ee(),rt((t=>e=>(e.needsRender=!0,e.renderer=t,e)))),l=this._renderService.size$.pipe(rt((t=>e=>(null==e.renderer||(e.renderer.setSize(t.width,t.height),e.needsRender=!0),e)))),u=this._clear$.pipe(rt((()=>t=>(null==t.renderer||(t.needsRender=!0),t))));n.push(Ot(h,l,u).subscribe(this._rendererOperation$));const d=this._renderCollection$.pipe(Nt((t=>0===Object.keys(t).length)),Ze());n.push(d.subscribe((()=>{null!=this._renderFrameSubscription&&(this._renderFrameSubscription.unsubscribe(),this._renderFrameSubscription=null,this._renderFrameSubscribe())}))),n.push(d.pipe(rt((()=>t=>(t.needsRender=!0,t)))).subscribe(this._eraserOperation$))}get render$(){return this._render$}get opaqueRender$(){return this._opaqueRender$}get webGLRenderer$(){return this._webGLRenderer$}clear(t){this._clear$.next(t)}remove(){this._rendererOperation$.next((t=>{if(null!=t.renderer){const e=t.renderer.getContext().getExtension("WEBGL_lose_context");e&&e.loseContext(),t.renderer=null}return t})),null!=this._renderFrameSubscription&&this._renderFrameSubscription.unsubscribe(),this._subscriptions.unsubscribe()}triggerRerender(){this._renderService.renderCameraFrame$.pipe(Je(1),Ee()).subscribe((()=>{this._triggerOperation$.next((t=>(t.needsRender=!0,t)))}))}_renderFrameSubscribe(){this._render$.pipe(Ee(),rt((()=>t=>(t.needsRender=!0,t)))).subscribe((t=>{this._renderCameraOperation$.next(t)})),this._renderFrameSubscription=this._render$.pipe(Ee(),Mt((()=>this._renderService.renderCameraFrame$))).subscribe(this._renderFrame$)}}class mw{constructor(t,e,i){this._spatial=new ld,this._viewportCoords=new Wf,this._size={width:t,height:e},this._initialFov=60,this._alpha=-1,this._renderMode=i,this._zoom=0,this._frameId=-1,this._changed=!1,this._changedForFrame=-1,this._currentImageId=null,this._previousImageId=null,this._currentSpherical=!1,this._previousSpherical=!1,this._state=null,this._currentProjectedPoints=[],this._previousProjectedPoints=[],this._currentFov=this._initialFov,this._previousFov=this._initialFov,this._camera=new jd,this._perspective=new Ds(this._initialFov,this._computeAspect(t,e),.16,1e4),this._perspective.position.copy(this._camera.position),this._perspective.up.copy(this._camera.up),this._perspective.lookAt(this._camera.lookat),this._perspective.updateMatrixWorld(!0),this._perspective.matrixAutoUpdate=!1,this._rotation={phi:0,theta:0}}get alpha(){return this._alpha}get camera(){return this._camera}get changed(){return this._frameId===this._changedForFrame}get frameId(){return this._frameId}get perspective(){return this._perspective}get renderMode(){return this._renderMode}get rotation(){return this._rotation}get zoom(){return this._zoom}get size(){return this._size}getTilt(){return 90-this._spatial.radToDeg(this._rotation.theta)}fovToZoom(t){t=Math.min(90,Math.max(0,t));const e=this._computeCurrentFov(0),i=1===this._alpha?e:this._interpolateFov(e,this._computePreviousFov(0),this._alpha),n=Math.tan(i/2*Math.PI/180),r=Math.tan(t/2*Math.PI/180);return Math.log(n/r)/Math.log(2)}setFrame(t){const e=t.state;e.state!==this._state&&(this._state=e.state,this._state!==vm.Custom&&(this.setRenderMode(this._renderMode),this.setSize(this._size)),this._changed=!0);const i=e.currentImage.id,n=e.previousImage?e.previousImage.id:null;i!==this._currentImageId&&(this._currentImageId=i,this._currentSpherical=dd(e.currentTransform.cameraType),this._currentProjectedPoints=this._computeProjectedPoints(e.currentTransform),this._changed=!0),n!==this._previousImageId&&(this._previousImageId=n,this._previousSpherical=dd(e.previousTransform.cameraType),this._previousProjectedPoints=this._computeProjectedPoints(e.previousTransform),this._changed=!0);const r=e.zoom;r!==this._zoom&&(this._zoom=r,this._changed=!0),this._changed&&(this._currentFov=this._computeCurrentFov(this.zoom),this._previousFov=this._computePreviousFov(this._zoom));const s=e.alpha;if(this._changed||s!==this._alpha){switch(this._alpha=s,this._state){case vm.Earth:this._perspective.fov=60,this._changed=!0;break;case vm.Custom:break;default:this._perspective.fov=this._interpolateFov(this._currentFov,this._previousFov,this._alpha),this._changed=!0}this._state!==vm.Custom&&this._perspective.updateProjectionMatrix()}const o=e.camera;this._camera.diff(o)>1e-9&&(this._camera.copy(o),this._rotation=this._computeRotation(o),this._perspective.up.copy(o.up),this._perspective.position.copy(o.position),this._perspective.matrixAutoUpdate=!0,this._perspective.lookAt(o.lookat),this._perspective.matrixAutoUpdate=!1,this._perspective.updateMatrix(),this._perspective.updateMatrixWorld(!1),this._changed=!0),this._setFrameId(t.id)}setProjectionMatrix(t){this._perspective.projectionMatrix.fromArray(t),this._perspective.projectionMatrixInverse.copy(this._perspective.projectionMatrix).invert(),this._changed=!0}setRenderMode(t){this._renderMode=t,this._state!==vm.Custom&&(this._perspective.fov=this._computeFov(),this._perspective.updateProjectionMatrix(),this._changed=!0)}setSize(t){this._size=t,this._state!==vm.Custom&&(this._perspective.aspect=this._computeAspect(t.width,t.height),this._perspective.fov=this._computeFov(),this._perspective.updateProjectionMatrix(),this._changed=!0)}_computeAspect(t,e){return 0===t?0:t/e}_computeCurrentFov(t){return 0===this._perspective.aspect?0:this._currentImageId?this._currentSpherical?this._yToFov(1,t):this._computeVerticalFov(this._currentProjectedPoints,this._renderMode,t,this.perspective.aspect):this._initialFov}_computeFov(){return this._currentFov=this._computeCurrentFov(this._zoom),this._previousFov=this._computePreviousFov(this._zoom),this._interpolateFov(this._currentFov,this._previousFov,this._alpha)}_computePreviousFov(t){return 0===this._perspective.aspect?0:this._currentImageId?this._previousImageId?this._previousSpherical?this._yToFov(1,t):this._computeVerticalFov(this._previousProjectedPoints,this._renderMode,t,this.perspective.aspect):this._currentFov:this._initialFov}_computeProjectedPoints(t){return md(t,[[.5,0],[1,0]],[[.5,0],[0,.5]],100,this._viewportCoords)}_computeRequiredVerticalFov(t,e,i){const n=Math.max(t[0]/i,t[1]);return this._yToFov(n,e)}_computeRotation(t){let e=t.lookat.clone().sub(t.position),i=t.up.clone();return{phi:this._spatial.azimuthal(e.toArray(),i.toArray()),theta:Math.PI/2-this._spatial.angleToPlane(e.toArray(),[0,0,1])}}_computeVerticalFov(e,i,n,r){const s=e.map((t=>this._computeRequiredVerticalFov(t,n,r)));return i===t.RenderMode.Fill?.995*Math.min(...s):Math.max(...s)}_yToFov(t,e){return 2*Math.atan(t/Math.pow(2,e))*180/Math.PI}_interpolateFov(t,e,i){return i*t+(1-i)*e}_setFrameId(t){this._frameId=t,this._changed&&(this._changed=!1,this._changedForFrame=t)}}class gw{constructor(e,i,n,r){this._subscriptions=new Uf,this._element=e,this._currentFrame$=i,this._spatial=new ld,n=null!=n?n:t.RenderMode.Fill,this._resize$=new T,this._projectionMatrix$=new T,this._renderCameraOperation$=new T,this._size$=new O({height:this._element.offsetHeight,width:this._element.offsetWidth});const s=this._subscriptions;s.push(this._resize$.pipe(rt((()=>({height:this._element.offsetHeight,width:this._element.offsetWidth})))).subscribe(this._size$)),this._renderMode$=new O(n),this._renderCameraHolder$=this._renderCameraOperation$.pipe(ni((t=>t)),Le(((t,e)=>e(t)),null!=r?r:new mw(this._element.offsetWidth,this._element.offsetHeight,n)),Ue(1),E()),this._renderCameraFrame$=this._currentFrame$.pipe(bi(this._renderCameraHolder$),pi((([t,e])=>{e.setFrame(t)})),rt((t=>t[1])),Ue(1),E()),this._renderCamera$=this._renderCameraFrame$.pipe(Nt((t=>t.changed)),Ue(1),E()),this._bearing$=this._renderCamera$.pipe(rt((t=>{let e=this._spatial.radToDeg(this._spatial.azimuthalToBearing(t.rotation.phi));return this._spatial.wrap(e,0,360)})),Ue(1),E()),s.push(this._size$.pipe(Je(1),rt((t=>e=>(e.setSize(t),e)))).subscribe(this._renderCameraOperation$)),s.push(this._renderMode$.pipe(Je(1),rt((t=>e=>(e.setRenderMode(t),e)))).subscribe(this._renderCameraOperation$)),s.push(this._projectionMatrix$.pipe(rt((t=>e=>(e.setProjectionMatrix(t),e)))).subscribe(this._renderCameraOperation$)),s.push(this._bearing$.subscribe((()=>{}))),s.push(this._renderCameraHolder$.subscribe((()=>{}))),s.push(this._size$.subscribe((()=>{}))),s.push(this._renderMode$.subscribe((()=>{}))),s.push(this._renderCamera$.subscribe((()=>{}))),s.push(this._renderCameraFrame$.subscribe((()=>{})))}get bearing$(){return this._bearing$}get element(){return this._element}get projectionMatrix$(){return this._projectionMatrix$}get renderCamera$(){return this._renderCamera$}get renderCameraFrame$(){return this._renderCameraFrame$}get renderMode$(){return this._renderMode$}get resize$(){return this._resize$}get size$(){return this._size$}dispose(){this._subscriptions.unsubscribe()}}class _w{constructor(t){this._keyDown$=Pt(t,"keydown"),this._keyUp$=Pt(t,"keyup")}get keyDown$(){return this._keyDown$}get keyUp$(){return this._keyUp$}}const vw={0:1,2:2};class yw{constructor(t,e,i,n){this._subscriptions=new Uf;const r=this._subscriptions;this._activeSubject$=new O(!1),this._active$=this._activeSubject$.pipe(ue(),Ue(1),E()),this._claimMouse$=new T,this._claimWheel$=new T,this._deferPixelClaims$=new T,this._deferPixels$=this._deferPixelClaims$.pipe(Le(((t,e)=>(null==e.deferPixels?delete t[e.name]:t[e.name]=e.deferPixels,t)),{}),rt((t=>{let e=-1;for(const i in t){if(!t.hasOwnProperty(i))continue;const n=t[i];n>e&&(e=n)}return e})),ni(-1),Ue(1),E()),r.push(this._deferPixels$.subscribe((()=>{}))),this._documentMouseMove$=Pt(n,"pointermove").pipe(Nt(this._isMousePen)),this._documentMouseUp$=Pt(n,"pointerup").pipe(Nt(this._isMousePen)),this._mouseDown$=Pt(e,"pointerdown").pipe(Nt(this._isMousePen)),this._mouseEnter$=Pt(e,"pointerenter").pipe(Nt(this._isMousePen)),this._mouseLeave$=Pt(e,"pointerleave").pipe(Nt(this._isMousePen)),this._mouseMove$=Pt(e,"pointermove").pipe(Nt(this._isMousePen)),this._mouseUp$=Pt(e,"pointerup").pipe(Nt(this._isMousePen)),this._mouseOut$=Pt(e,"pointerout").pipe(Nt(this._isMousePen)),this._mouseOver$=Pt(e,"pointerover").pipe(Nt(this._isMousePen)),this._domMouseDown$=Pt(i,"pointerdown").pipe(Nt(this._isMousePen)),this._domMouseMove$=Pt(i,"pointermove").pipe(Nt(this._isMousePen)),this._click$=Pt(e,"click"),this._contextMenu$=Pt(e,"contextmenu"),this._windowBlur$=Pt(window,"blur"),this._dblClick$=Ot(Pt(t,"click"),Pt(e,"dblclick")).pipe(Xt(3,1),Nt((t=>{const i=t[0],n=t[1],r=t[2];return"click"===i.type&&"click"===n.type&&"dblclick"===r.type&&i.target.parentNode===e&&n.target.parentNode===e})),rt((t=>t[2])),Ze()),r.push(Ot(this._domMouseDown$,this._domMouseMove$,this._dblClick$,this._contextMenu$).subscribe((t=>{t.preventDefault()}))),this._mouseWheel$=Ot(Pt(e,"wheel"),Pt(i,"wheel")).pipe(Ze()),this._consistentContextMenu$=Ot(this._mouseDown$,this._mouseMove$,this._mouseOut$,this._mouseUp$,this._contextMenu$).pipe(Xt(3,1),Nt((t=>"pointerdown"===t[0].type&&"contextmenu"===t[1].type&&"pointerup"===t[2].type)),rt((t=>t[1])),Ze());const s=Ot(this._windowBlur$,this._documentMouseMove$.pipe(Nt((t=>this._buttonReleased(t,0)))),this._documentMouseUp$.pipe(Nt((t=>0===this._mouseButton(t))))).pipe(Ze()),o=this._createMouseDragInitiate$(0,this._mouseDown$,s,!0).pipe(Ze());this._mouseDragStart$=this._createMouseDragStart$(o).pipe(Ze()),this._mouseDrag$=this._createMouseDrag$(o,s).pipe(Ze()),this._mouseDragEnd$=this._createMouseDragEnd$(this._mouseDragStart$,s).pipe(Ze());const a=this._createMouseDragInitiate$(0,this._domMouseDown$,s,!1).pipe(Ze());this._domMouseDragStart$=this._createMouseDragStart$(a).pipe(Ze()),this._domMouseDrag$=this._createMouseDrag$(a,s).pipe(Ze()),this._domMouseDragEnd$=this._createMouseDragEnd$(this._domMouseDragStart$,s).pipe(Ze());const c=Ot(this._windowBlur$,this._documentMouseMove$.pipe(Nt((t=>this._buttonReleased(t,2)))),this._documentMouseUp$.pipe(Nt((t=>2===this._mouseButton(t))))).pipe(Ze()),h=this._createMouseDragInitiate$(2,this._mouseDown$,c,!0).pipe(Ze());this._mouseRightDragStart$=this._createMouseDragStart$(h).pipe(Ze()),this._mouseRightDrag$=this._createMouseDrag$(h,c).pipe(Ze()),this._mouseRightDragEnd$=this._createMouseDragEnd$(this._mouseRightDragStart$,c).pipe(Ze()),this._proximateClick$=this._mouseDown$.pipe(ri((t=>this._click$.pipe(ai(this._createDeferredMouseMove$(t,this._documentMouseMove$)),ve(1)))),Ze()),this._staticClick$=this._mouseDown$.pipe(ri((()=>this._click$.pipe(ai(this._documentMouseMove$),ve(1)))),Ze()),r.push(this._mouseDragStart$.subscribe()),r.push(this._mouseDrag$.subscribe()),r.push(this._mouseDragEnd$.subscribe()),r.push(this._domMouseDragStart$.subscribe()),r.push(this._domMouseDrag$.subscribe()),r.push(this._domMouseDragEnd$.subscribe()),r.push(this._mouseRightDragStart$.subscribe()),r.push(this._mouseRightDrag$.subscribe()),r.push(this._mouseRightDragEnd$.subscribe()),r.push(this._staticClick$.subscribe()),this._mouseOwner$=this._createOwner$(this._claimMouse$).pipe(Ue(1),E()),this._wheelOwner$=this._createOwner$(this._claimWheel$).pipe(Ue(1),E()),r.push(this._mouseOwner$.subscribe((()=>{}))),r.push(this._wheelOwner$.subscribe((()=>{})))}get active$(){return this._active$}get activate$(){return this._activeSubject$}get documentMouseMove$(){return this._documentMouseMove$}get documentMouseUp$(){return this._documentMouseUp$}get domMouseDragStart$(){return this._domMouseDragStart$}get domMouseDrag$(){return this._domMouseDrag$}get domMouseDragEnd$(){return this._domMouseDragEnd$}get domMouseDown$(){return this._domMouseDown$}get domMouseMove$(){return this._domMouseMove$}get mouseOwner$(){return this._mouseOwner$}get mouseDown$(){return this._mouseDown$}get mouseEnter$(){return this._mouseEnter$}get mouseMove$(){return this._mouseMove$}get mouseLeave$(){return this._mouseLeave$}get mouseOut$(){return this._mouseOut$}get mouseOver$(){return this._mouseOver$}get mouseUp$(){return this._mouseUp$}get click$(){return this._click$}get dblClick$(){return this._dblClick$}get contextMenu$(){return this._consistentContextMenu$}get mouseWheel$(){return this._mouseWheel$}get mouseDragStart$(){return this._mouseDragStart$}get mouseDrag$(){return this._mouseDrag$}get mouseDragEnd$(){return this._mouseDragEnd$}get mouseRightDragStart$(){return this._mouseRightDragStart$}get mouseRightDrag$(){return this._mouseRightDrag$}get mouseRightDragEnd$(){return this._mouseRightDragEnd$}get proximateClick$(){return this._proximateClick$}get staticClick$(){return this._staticClick$}get windowBlur$(){return this._windowBlur$}dispose(){this._subscriptions.unsubscribe()}claimMouse(t,e){this._claimMouse$.next({name:t,zindex:e})}unclaimMouse(t){this._claimMouse$.next({name:t,zindex:null})}deferPixels(t,e){this._deferPixelClaims$.next({name:t,deferPixels:e})}undeferPixels(t){this._deferPixelClaims$.next({name:t,deferPixels:null})}claimWheel(t,e){this._claimWheel$.next({name:t,zindex:e})}unclaimWheel(t){this._claimWheel$.next({name:t,zindex:null})}filtered$(t,e){return this._filtered(t,e,this._mouseOwner$)}filteredWheel$(t,e){return this._filtered(t,e,this._wheelOwner$)}_createDeferredMouseMove$(t,e){return e.pipe(rt((e=>{const i=e.clientX-t.clientX,n=e.clientY-t.clientY;return[e,Math.sqrt(i*i+n*n)]})),bi(this._deferPixels$),Nt((([[,t],e])=>t>e)),rt((([[t]])=>t)))}_createMouseDrag$(t,e){return t.pipe(rt((([,t])=>t)),ri((t=>At(G(t),this._documentMouseMove$).pipe(ai(e)))))}_createMouseDragEnd$(t,e){return t.pipe(ri((()=>e.pipe(Ee()))))}_createMouseDragStart$(t){return t.pipe(rt((([t])=>t)))}_createMouseDragInitiate$(t,e,i,n){return e.pipe(Nt((e=>this._mouseButton(e)===t)),ri((t=>gt(G(t),n?this._createDeferredMouseMove$(t,this._documentMouseMove$):this._documentMouseMove$).pipe(ai(i),ve(1)))))}_createOwner$(t){return t.pipe(Le(((t,e)=>(null==e.zindex?delete t[e.name]:t[e.name]=e.zindex,t)),{}),rt((t=>{let e=null,i=-1;for(const n in t)t.hasOwnProperty(n)&&t[n]>i&&(i=t[n],e=n);return e})),ni(null))}_filtered(t,e,i){return e.pipe(bi(i),Nt((([,e])=>e===t)),rt((([t])=>t)))}_mouseButton(t){const e="pointerdown"===t.type||"pointerup"===t.type,i=window.InstallTrigger;return e&&void 0!==i&&2===t.button&&t.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}_buttonReleased(t,e){const i=vw[e];return void 0===t.buttons||(t.buttons&i)!==i}_isMousePen(t){const e=t.pointerType;return"mouse"===e||"pen"===e}}class bw{set json(t){this._json=t}set image(t){this._image=t,this._texture=new hn(this._image),this._texture.minFilter=Ii}get loaded(){return!(!this._image||!this._json)}getGLSprite(t){if(!this.loaded)throw new Error("Sprites cannot be retrieved before the atlas is loaded.");let e=this._json[t];if(!e)return console.warn("Sprite with key"+t+"does not exist in sprite definition."),new pr;let i=this._texture.clone();i.needsUpdate=!0;let n=this._image.width,r=this._image.height;return i.offset.x=e.x/n,i.offset.y=(r-e.y-e.height)/r,i.repeat.x=e.width/n,i.repeat.y=e.height/r,new _c(new nc({map:i}))}getDOMSprite(e,i){if(!this.loaded)throw new Error("Sprites cannot be retrieved before the atlas is loaded.");null==i&&(i=t.Alignment.Center);let n=this._json[e];if(!n)return console.warn("Sprite with key"+e+"does not exist in sprite definition."),jf.h("div",{},[]);let r=n.y,s=n.x+n.width,o=n.y+n.height,a=n.x,c=-n.x,h=-n.y,l=this._image.height,u=this._image.width;switch(i){case t.Alignment.Bottom:case t.Alignment.Center:case t.Alignment.Top:c-=n.width/2;break;case t.Alignment.BottomLeft:case t.Alignment.Left:case t.Alignment.TopLeft:c-=n.width;break;case t.Alignment.BottomRight:case t.Alignment.Right:case t.Alignment.TopRight:}switch(i){case t.Alignment.Center:case t.Alignment.Left:case t.Alignment.Right:h-=n.height/2;break;case t.Alignment.Top:case t.Alignment.TopLeft:case t.Alignment.TopRight:h-=n.height;break;case t.Alignment.Bottom:case t.Alignment.BottomLeft:case t.Alignment.BottomRight:}let d=1/n.pixelRatio;r*=d,s*=d,o*=d,a*=d,c*=d,h*=d,l*=d,u*=d;let p={src:this._image.src,style:{clip:`rect(${r}px, ${s}px, ${o}px, ${a}px)`,height:`${l}px`,left:`${c}px`,position:"absolute",top:`${h}px`,width:`${u}px`}};return jf.h("img",p,[])}}class xw{constructor(t){if(this._retina=window.devicePixelRatio>1,this._spriteAtlasOperation$=new T,this._spriteAtlas$=this._spriteAtlasOperation$.pipe(ni((t=>t)),Le(((t,e)=>e(t)),new bw),Ue(1),E()),this._atlasSubscription=this._spriteAtlas$.subscribe((()=>{})),null==t)return;let e=this._retina?"@2x":"",i=new XMLHttpRequest;i.open("GET",t+e+".png",!0),i.responseType="arraybuffer",i.onload=()=>{let t=new Image;t.onload=()=>{this._spriteAtlasOperation$.next((e=>(e.image=t,e)))};let e=new Blob([i.response]);t.src=window.URL.createObjectURL(e)},i.onerror=i=>{console.error(new Error(`Failed to fetch sprite sheet (${t}${e}.png)`))},i.send();let n=new XMLHttpRequest;n.open("GET",t+e+".json",!0),n.responseType="text",n.onload=()=>{let t=JSON.parse(n.response);this._spriteAtlasOperation$.next((e=>(e.json=t,e)))},n.onerror=i=>{console.error(new Error(`Failed to fetch sheet (${t}${e}.json)`))},n.send()}get spriteAtlas$(){return this._spriteAtlas$}dispose(){this._atlasSubscription.unsubscribe()}}class ww{constructor(t,e){this._subscriptions=new Uf;const i=this._subscriptions;this._activeSubject$=new O(!1),this._active$=this._activeSubject$.pipe(ue(),Ue(1),E()),i.push(Pt(e,"touchmove").subscribe((t=>{t.preventDefault()}))),this._touchStart$=Pt(t,"touchstart"),this._touchMove$=Pt(t,"touchmove"),this._touchEnd$=Pt(t,"touchend"),this._touchCancel$=Pt(t,"touchcancel");const n=this._touchStart$.pipe(Nt((t=>1===t.touches.length&&1===t.targetTouches.length)),Ze());var r;this._doubleTap$=n.pipe((r=()=>n.pipe(Ee(),ri((()=>Ot(kt(300),n).pipe(ve(1))))),function(t){return t.lift(new Kt(r))}),Nt((t=>2===t.length)),rt((t=>t[t.length-1])),Ze()),i.push(this._doubleTap$.subscribe((t=>{t.preventDefault()}))),this._singleTouchMove$=this._touchMove$.pipe(Nt((t=>1===t.touches.length&&1===t.targetTouches.length)),Ze());let s=Ot(this._touchStart$,this._touchEnd$,this._touchCancel$).pipe(Nt((t=>1===t.touches.length&&1===t.targetTouches.length))),o=Ot(this._touchStart$,this._touchEnd$,this._touchCancel$).pipe(Nt((t=>t.touches.length>=1))),a=Ot(this._touchEnd$,this._touchCancel$).pipe(Nt((t=>0===t.touches.length)));this._singleTouchDragStart$=s.pipe(Mt((()=>this._singleTouchMove$.pipe(ai(Ot(a,o)),ve(1))))),this._singleTouchDragEnd$=s.pipe(Mt((()=>Ot(a,o).pipe(Ee())))),this._singleTouchDrag$=s.pipe(ri((()=>this._singleTouchMove$.pipe(Je(1),ai(Ot(o,a))))));let c=Ot(this._touchStart$,this._touchEnd$,this._touchCancel$);this._pinchStart$=c.pipe(Nt((t=>2===t.touches.length&&2===t.targetTouches.length))),this._pinchEnd$=c.pipe(Nt((t=>2!==t.touches.length||2!==t.targetTouches.length))),this._pinchOperation$=new T,this._pinch$=this._pinchOperation$.pipe(Le(((t,e)=>e(t)),{changeX:0,changeY:0,clientX:0,clientY:0,distance:0,distanceChange:0,distanceX:0,distanceY:0,originalEvent:null,pageX:0,pageY:0,screenX:0,screenY:0,touch1:null,touch2:null}));const h=this._touchMove$.pipe(Nt((t=>2===t.touches.length&&2===t.targetTouches.length)),rt((t=>e=>{let i=t.touches[0],n=t.touches[1],r=Math.min(i.clientX,n.clientX),s=Math.max(i.clientX,n.clientX),o=Math.min(i.clientY,n.clientY),a=r+(s-r)/2,c=o+(Math.max(i.clientY,n.clientY)-o)/2,h=a+i.pageX-i.clientX,l=c+i.pageY-i.clientY,u=a+i.screenX-i.clientX,d=c+i.screenY-i.clientY,p=Math.abs(i.clientX-n.clientX),f=Math.abs(i.clientY-n.clientY),m=Math.sqrt(p*p+f*f),g=m-e.distance;return{changeX:p-e.distanceX,changeY:f-e.distanceY,clientX:a,clientY:c,distance:m,distanceChange:g,distanceX:p,distanceY:f,originalEvent:t,pageX:h,pageY:l,screenX:u,screenY:d,touch1:i,touch2:n}}))).subscribe(this._pinchOperation$);i.push(h),this._pinchChange$=this._pinchStart$.pipe(ri((()=>this._pinch$.pipe(Je(1),ai(this._pinchEnd$)))))}get active$(){return this._active$}get activate$(){return this._activeSubject$}get doubleTap$(){return this._doubleTap$}get touchStart$(){return this._touchStart$}get touchMove$(){return this._touchMove$}get touchEnd$(){return this._touchEnd$}get touchCancel$(){return this._touchCancel$}get singleTouchDragStart$(){return this._singleTouchDragStart$}get singleTouchDrag$(){return this._singleTouchDrag$}get singleTouchDragEnd$(){return this._singleTouchDragEnd$}get pinch$(){return this._pinchChange$}get pinchStart$(){return this._pinchStart$}get pinchEnd$(){return this._pinchEnd$}dispose(){this._subscriptions.unsubscribe()}}class Sw{constructor(t){var e,i,n,r;const s=null!==(i=null===(e=null==t?void 0:t.url)||void 0===e?void 0:e.exploreHost)&&void 0!==i?i:"www.mapillary.com",o=`${null!==(r=null===(n=null==t?void 0:t.url)||void 0===n?void 0:n.scheme)&&void 0!==r?r:"https"}://${s}`;this._exploreUrl$=G(o);const a=!1!==(null==t?void 0:t.imageTiling);this._imageTiling$=G(a)}get exploreUrl$(){return this._exploreUrl$}get imageTiling$(){return this._imageTiling$}}class Mw{constructor(t,e,i){var n;if(this._onWindowResize=()=>{this._trackResize&&this.renderService.resize$.next()},this._dom=null!=i?i:new Xm,"string"==typeof t.container){if(this._container=this._dom.document.getElementById(t.container),!this._container)throw new Error(`Container "${t.container}" not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error('Invalid type: "container" must be a String or HTMLElement.');this._container=t.container}this._trackResize=!1!==t.trackResize,this.id=null!==(n=this._container.id)&&void 0!==n?n:"mapillary-fallback-container-id",this._container.classList.add("mapillary-viewer"),this._canvasContainer=this._dom.createElement("div","mapillary-interactive",this._container),this._canvas=this._dom.createElement("canvas","mapillary-canvas"),this._canvas.style.position="absolute",this._canvas.setAttribute("tabindex","0"),this._domContainer=this._dom.createElement("div","mapillary-dom",this._container),this.configurationService=new Sw(t),this.renderService=new gw(this._container,e.currentState$,t.renderMode),this.glRenderer=new fw(this._canvas,this._canvasContainer,this.renderService),this.domRenderer=new pw(this._domContainer,this.renderService,e.currentState$),this.keyboardService=new _w(this._canvasContainer),this.mouseService=new yw(this._container,this._canvasContainer,this._domContainer,document),this.touchService=new ww(this._canvasContainer,this._domContainer),this.spriteService=new xw(t.sprite),window.addEventListener("resize",this._onWindowResize,!1)}get canvas(){return this._canvas.parentNode?this._canvas:null}get canvasContainer(){return this._canvasContainer}get container(){return this._container}get domContainer(){return this._domContainer}remove(){window.removeEventListener("resize",this._onWindowResize,!1),this.spriteService.dispose(),this.touchService.dispose(),this.mouseService.dispose(),this.glRenderer.remove(),this.domRenderer.remove(),this.renderService.dispose(),this._removeNode(this._canvasContainer),this._removeNode(this._domContainer),this._container.classList.remove("mapillary-viewer")}_removeNode(t){t.parentNode&&t.parentNode.removeChild(t)}}class Tw{constructor(t,e,i){this._graphService=t,this._stateService=e,this._api=i,this._subscriptions=new Uf,this._started=!1,this._cellDepth=1}get started(){return this._started}configure(t){this._cellDepth=t?Math.max(1,Math.min(3,t.cellDepth)):1}start(){if(this._started)return;const t=this._subscriptions;t.push(this._stateService.currentState$.pipe(ue(void 0,(t=>t.state.currentImage.id)),rt((t=>{const e=t.state,i=e.trajectory,n=i.map((t=>t.id)),r=i[i.length-1].sequenceId;return[n,e.currentImage.originalLngLat,r]})),Xt(1,5),bi(this._graphService.graphMode$),ri((([t,e])=>{const i=t[0][0],n=t[0][1],r=this._api.data.geometry,s=vg(r.lngLatToCellId(n),this._cellDepth,r),o=e===ym.Sequence?t[0][2]:void 0;return this._graphService.uncache$(i,s,o)}))).subscribe((()=>{}))),t.push(this._graphService.graphMode$.pipe(Je(1),bi(this._stateService.currentState$),ri((([t,e])=>t===ym.Sequence?this._keyToEdges(e.state.currentImage.id,(t=>t.sequenceEdges$)):bt(e.state.trajectory.map((t=>t.id)).slice(e.state.currentIndex)).pipe(Mt((t=>this._keyToEdges(t,(t=>t.spatialEdges$))),6))))).subscribe((()=>{}))),t.push(this._graphService.dataAdded$.pipe(bi(this._stateService.currentId$),ri((([t,e])=>this._graphService.cacheImage$(e)))).subscribe((()=>{}))),this._started=!0}stop(){this._started&&(this._subscriptions.unsubscribe(),this._started=!1)}_keyToEdges(t,e){return this._graphService.cacheImage$(t).pipe(ri(e),Ee((t=>t.cached)),yi(15e3),te((e=>(console.error(`Failed to cache edges (${t}).`,e),B()))))}}class Cw{constructor(){this._loadersSubject$=new T,this._loaders$=this._loadersSubject$.pipe(Le(((t,e)=>(void 0!==e.task&&(t[e.task]=e.loading),t)),{}),ni({}),Ue(1),E())}get loading$(){return this._loaders$.pipe(rt((t=>{for(const e in t)if(t.hasOwnProperty(e)&&t[e])return!0;return!1})),re(100),ue())}taskLoading$(t){return this._loaders$.pipe(rt((e=>!!e[t])),re(100),ue())}startLoading(t){this._loadersSubject$.next({loading:!0,task:t})}stopLoading(t){this._loadersSubject$.next({loading:!1,task:t})}}var Ew;!function(t){t[t.Disabled=0]="Disabled",t[t.Enabled=1]="Enabled",t[t.Started=2]="Started"}(Ew||(Ew={}));class Iw{constructor(t,e,i,n,r,s){this._subscriptions=new Uf,this._graphService=t,this._stateService=e,this._graphCalculator=null!=n?n:new td,this._spatial=null!=r?r:new ld,this._viewportCoords=null!=s?s:new Wf,this._mode=!1!==i?Ew.Enabled:Ew.Disabled,this._panImagesSubject$=new T,this._panImages$=this._panImagesSubject$.pipe(ni([]),Ue(1),E()),this._subscriptions.push(this._panImages$.subscribe())}get panImages$(){return this._panImages$}dispose(){this.stop(),null!=this._panImagesSubscription&&this._panImagesSubscription.unsubscribe(),this._subscriptions.unsubscribe()}enable(){this._mode===Ew.Disabled&&(this._mode=Ew.Enabled,this.start())}disable(){this._mode!==Ew.Disabled&&(this.stop(),this._mode=Ew.Disabled)}start(){if(this._mode!==Ew.Enabled)return;const t=this._stateService.currentImage$.pipe(ri((t=>{if(!t.merged||dd(t.cameraType))return G([]);const e=G(t),i=this._graphCalculator.boundingBoxCorners(t.lngLat,20);return gt(e,this._graphService.cacheBoundingBox$(i[0],i[1]).pipe(te((e=>(console.error(`Failed to cache periphery bounding box (${t.id})`,e),B()))),rt((e=>{if(dd(t.cameraType))return[];const i=[];for(const n of e)n.id!==t.id&&n.mergeId===t.mergeId&&(dd(n.cameraType)||this._distance(n,t)>4||i.push(n));return i})))).pipe(bi(this._stateService.reference$),rt((([[t,e],i])=>{const n=this._spatial.viewingDirection(t.rotation),r=fd({lat:t.lngLat.lat,lng:t.lngLat.lng,alt:t.computedAltitude},t.rotation,i),s=this._createTransform(t,r),o=this._spatial.wrap(this._spatial.azimuthal(n.toArray(),s.upVector().toArray()),0,2*Math.PI),a=this._computeProjectedPoints(s),c=this._computeHorizontalFov(a)/180*Math.PI,h=Math.PI/8;let l,u;for(const r of e){const e=fd({lat:r.lngLat.lat,lng:r.lngLat.lng,alt:r.computedAltitude},r.rotation,i),s=this._createTransform(r,e),a=this._computeProjectedPoints(s),d=this._computeHorizontalFov(a)/180*Math.PI,p=this._spatial.viewingDirection(r.rotation),f=this._spatial.wrap(this._spatial.azimuthal(p.toArray(),s.upVector().toArray()),0,2*Math.PI),m=this._spatial.angleBetweenVector2(n.x,n.y,p.x,p.y);let g=Number.NEGATIVE_INFINITY;g=m>0?o>f?o-2*Math.PI+c/2-(f-d/2):o+c/2-(f-d/2):o<f?f+d/2-(o+2*Math.PI-c/2):f+d/2-(o-c/2);const _=Math.abs(d-g),v=this._distance(r,t)+Math.min(this._timeDifference(r,t),4)+20*Math.abs(g-h)+Math.min(5,1/Math.min(d/c,1))+(g>0?-2*_:0);g>0&&g<.5*c&&g<.5*d&&_>.5*c&&(m>0?l?v<l[0]&&(l=[v,r,s,d]):l=[v,r,s,d]:u?v<u[0]&&(u=[v,r,s,d]):u=[v,r,s,d])}const d=[];return l&&d.push([l[1],l[2],l[3]]),u&&d.push([u[1],u[2],u[3]]),d})),ni([]))})));this._panImagesSubscription=this._stateService.currentState$.pipe(rt((t=>t.state.imagesAhead>0)),ue(),ri((e=>e?G([]):t))).subscribe((t=>{this._panImagesSubject$.next(t)})),this._mode=Ew.Started}stop(){this._mode===Ew.Started&&(this._panImagesSubscription.unsubscribe(),this._panImagesSubject$.next([]),this._mode=Ew.Enabled)}_distance(t,e){const[i,n,r]=Ju(t.lngLat.lng,t.lngLat.lat,t.computedAltitude,e.lngLat.lng,e.lngLat.lat,e.computedAltitude);return Math.sqrt(i*i+n*n+r*r)}_timeDifference(t,e){return Math.abs(t.capturedAt-e.capturedAt)/2592e6}_createTransform(t,e){return new Hd(t.exifOrientation,t.width,t.height,t.scale,t.rotation,e,t.assetsCached?t.image:void 0,void 0,t.cameraParameters,t.cameraType)}_computeProjectedPoints(t){return md(t,[[1,0]],[[0,.5]],20,this._viewportCoords)}_computeHorizontalFov(t){const e=t.map((t=>this._coordToFov(t[0])));return Math.min(...e)}_coordToFov(t){return 2*Math.atan(t)*180/Math.PI}}class Aw{constructor(t){this._data=t}get data(){return this._data}getCoreImages$(t){return this._wrap$(this._data.getCoreImages(t))}getImages$(t){return this._wrap$(this._data.getImages(t))}getImageTiles$(t){return this._wrap$(this._data.getImageTiles(t))}getSequence$(t){return this._wrap$(this._data.getSequence(t))}getSpatialImages$(t){return this._wrap$(this._data.getSpatialImages(t))}setAccessToken(t){this._data.setAccessToken(t)}_wrap$(t){return b.create((e=>{t.then((t=>{e.next(t),e.complete()}),(t=>{e.error(t)}))}))}}class Pw{constructor(t){this._dataAdded$=new T,this._subscriptions=new Uf,this._onDataAdded=t=>{this._graph$.pipe(Ee(),Mt((e=>e.updateCells$(t.cellIds).pipe(pi((()=>{e.resetSpatialEdges()})))))).subscribe((t=>{this._dataAdded$.next(t)}))};const e=this._subscriptions;this._graph$=At(G(t),t.changed$).pipe(Ue(1),E()),e.push(this._graph$.subscribe((()=>{}))),this._graphMode=ym.Spatial,this._graphModeSubject$=new T,this._graphMode$=this._graphModeSubject$.pipe(ni(this._graphMode),Ue(1),E()),e.push(this._graphMode$.subscribe((()=>{}))),this._firstGraphSubjects$=[],this._initializeCacheSubscriptions=[],this._sequenceSubscriptions=[],this._spatialSubscriptions=[],t.api.data.on("datacreate",this._onDataAdded)}get dataAdded$(){return this._dataAdded$}get filter$(){return this._graph$.pipe(Ee(),Mt((t=>t.filter$)))}get graphMode$(){return this._graphMode$}cacheBoundingBox$(t,e){return this._graph$.pipe(Ee(),Mt((i=>i.cacheBoundingBox$(t,e))))}cacheCell$(t){return this._graph$.pipe(Ee(),Mt((e=>e.cacheCell$(t))))}cacheImage$(t){const e=new T;this._firstGraphSubjects$.push(e);const i=e.pipe(Ue(1),E()),n=i.pipe(rt((e=>e.getNode(t))),Mt((t=>t.assetsCached?G(t):t.cacheAssets$())),Ue(1),E());let r;n.subscribe(void 0,(e=>{console.error(`Failed to cache image (${t}).`,e)})),r=this._graph$.pipe(Ee(),Mt((e=>e.isCachingFull(t)||!e.hasNode(t)?e.cacheFull$(t):e.isCachingFill(t)||!e.getNode(t).complete?e.cacheFill$(t):G(e))),pi((e=>{if(!e.hasNode(t))throw new _d(`Failed to cache image (${t})`);e.hasInitializedCache(t)||e.initializeCache(t)})),Me((()=>{null!=r&&(this._removeFromArray(r,this._initializeCacheSubscriptions),this._removeFromArray(e,this._firstGraphSubjects$))}))).subscribe((t=>{e.next(t),e.complete()}),(t=>{e.error(t)})),r.closed||this._initializeCacheSubscriptions.push(r);const s=i.pipe(te((()=>B())),Mt((e=>e.isCachingNodeSequence(t)||!e.hasNodeSequence(t)?e.cacheNodeSequence$(t):G(e))),Ue(1),E());let o;if(o=s.pipe(pi((e=>{e.getNode(t).sequenceEdges.cached||e.cacheSequenceEdges(t)})),Me((()=>{null!=o&&this._removeFromArray(o,this._sequenceSubscriptions)}))).subscribe((()=>{}),(e=>{console.error(`Failed to cache sequence edges (${t}).`,e)})),o.closed||this._sequenceSubscriptions.push(o),this._graphMode===ym.Spatial){let e;e=i.pipe(te((()=>B())),xe((e=>e.hasTiles(t)?B():bt(e.cacheTiles$(t)).pipe(Mt((e=>e.pipe(Mt((e=>e.isCachingTiles(t)?B():G(e))),te((e=>(console.error(`Failed to cache tile data (${t}).`,e),B()))))))))),Ie(1),Mt((e=>e.hasSpatialArea(t)?G(e):bt(e.cacheSpatialArea$(t)).pipe(Mt((e=>e.pipe(te((e=>(console.error(`Failed to cache spatial images (${t}).`,e),B()))))))))),Ie(1),Mt((e=>e.hasNodeSequence(t)?G(e):e.cacheNodeSequence$(t))),pi((e=>{e.getNode(t).spatialEdges.cached||e.cacheSpatialEdges(t)})),Me((()=>{null!=e&&this._removeFromArray(e,this._spatialSubscriptions)}))).subscribe((()=>{}),(e=>{const i=`Failed to cache spatial edges (${t}).`;console.error(i,e)})),e.closed||this._spatialSubscriptions.push(e)}return n.pipe(Ee((t=>t.assetsCached)))}cacheSequence$(t){return this._graph$.pipe(Ee(),Mt((e=>e.isCachingSequence(t)||!e.hasSequence(t)?e.cacheSequence$(t):G(e))),rt((e=>e.getSequence(t))))}cacheSequenceImages$(t,e){return this._graph$.pipe(Ee(),Mt((e=>e.isCachingSequence(t)||!e.hasSequence(t)?e.cacheSequence$(t):G(e))),Mt((i=>i.isCachingSequenceNodes(t)||!i.hasSequenceNodes(t)?i.cacheSequenceNodes$(t,e):G(i))),rt((e=>e.getSequence(t))))}dispose(){this._graph$.pipe(Ee()).subscribe((t=>{t.unsubscribe()})),this._subscriptions.unsubscribe()}setFilter$(t){return this._resetSubscriptions(this._spatialSubscriptions),this._graph$.pipe(Ee(),pi((e=>{e.resetSpatialEdges(),e.setFilter(t)})),rt((()=>{})))}setGraphMode(t){this._graphMode!==t&&(t===ym.Sequence&&this._resetSubscriptions(this._spatialSubscriptions),this._graphMode=t,this._graphModeSubject$.next(this._graphMode))}reset$(t){return this._abortSubjects(this._firstGraphSubjects$),this._resetSubscriptions(this._initializeCacheSubscriptions),this._resetSubscriptions(this._sequenceSubscriptions),this._resetSubscriptions(this._spatialSubscriptions),this._graph$.pipe(Ee(),pi((e=>{e.reset(t)})),rt((()=>{})))}uncache$(t,e,i){return this._graph$.pipe(Ee(),pi((n=>{n.uncache(t,e,i)})),rt((()=>{})))}_abortSubjects(t){for(const e of t.slice())this._removeFromArray(e,t),e.error(new Error("Cache image request was aborted."))}_removeFromArray(t,e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}_resetSubscriptions(t){for(const e of t.slice())this._removeFromArray(e,t),e.closed||e.unsubscribe()}}class Rw{constructor(t){t.requestAnimationFrame?(this._cancelAnimationFrame=t.cancelAnimationFrame.bind(t),this._requestAnimationFrame=t.requestAnimationFrame.bind(t)):t.mozRequestAnimationFrame?(this._cancelAnimationFrame=t.mozCancelAnimationFrame.bind(t),this._requestAnimationFrame=t.mozRequestAnimationFrame.bind(t)):t.webkitRequestAnimationFrame?(this._cancelAnimationFrame=t.webkitCancelAnimationFrame.bind(t),this._requestAnimationFrame=t.webkitRequestAnimationFrame.bind(t)):t.msRequestAnimationFrame?(this._cancelAnimationFrame=t.msCancelAnimationFrame.bind(t),this._requestAnimationFrame=t.msRequestAnimationFrame.bind(t)):t.oRequestAnimationFrame?(this._cancelAnimationFrame=t.oCancelAnimationFrame.bind(t),this._requestAnimationFrame=t.oRequestAnimationFrame.bind(t)):(this._cancelAnimationFrame=t.clearTimeout.bind(t),this._requestAnimationFrame=e=>t.setTimeout(e,1e3/60))}get cancelAnimationFrame(){return this._cancelAnimationFrame}get requestAnimationFrame(){return this._requestAnimationFrame}}class Lw extends Ud{constructor(t){super(t)}setViewMatrix(t){const e=(new Hn).fromArray(t).invert().elements,i=new fn(e[12],e[13],e[14]),n=new fn(-e[8],-e[9],-e[10]),r=new fn(e[4],e[5],e[6]),s=this._camera;s.position.copy(i),s.lookat.copy(i.clone().add(n)),s.up.copy(r);const o=.5/Math.tan(Math.PI/3);s.focal=o}}class Ow extends Ud{constructor(t){super(t);const e=this._camera.position.clone(),i=this._camera.lookat.clone().sub(e).normalize(),n=Math.sqrt(i.x*i.x+i.y*i.y),r=Math.atan2(i.z,n),s=new fn;if(r>-Math.PI/45)s.copy(e),e.add(new fn(i.x,i.y,0).multiplyScalar(-50)),e.z=30;else{const t=e.clone(),n=new fn(0,0,1),r=new fn(0,0,-2),o=(new fn).subVectors(r,t).dot(n)/i.dot(n),a=1e4,c=t.clone().add(i.clone().multiplyScalar(Math.min(a,o)));s.copy(c);const h=e.clone().sub(c).normalize();e.copy(c.add(h.multiplyScalar(Math.max(50,h.length()))))}this._camera.position.copy(e),this._camera.lookat.copy(s),this._camera.up.set(0,0,1)}dolly(t){const e=this._camera,i=e.position.clone().sub(e.lookat),n=i.length()*Math.pow(2,-t),r=Math.max(1,Math.min(n,4e3));i.normalize(),i.multiplyScalar(r),e.position.copy(e.lookat).add(i)}orbit(t){const e=this._camera,i=(new pn).setFromUnitVectors(e.up,new fn(0,0,1)),n=i.clone().invert(),r=e.position.clone().sub(e.lookat);r.applyQuaternion(i);const s=r.length();let o=Math.atan2(r.y,r.x);o+=t.phi;let a=Math.atan2(Math.sqrt(r.x*r.x+r.y*r.y),r.z);a+=t.theta;const c=Math.PI/36;a=Math.max(c,Math.min(Math.PI/2-c,a)),r.x=Math.sin(a)*Math.cos(o),r.y=Math.sin(a)*Math.sin(o),r.z=Math.cos(a),r.applyQuaternion(n),e.position.copy(e.lookat).add(r.multiplyScalar(s))}truck(t){const e=this._camera;e.position.add((new fn).fromArray(t)),e.lookat.add((new fn).fromArray(t))}update(){}}class Nw extends Gd{constructor(t){super(t),this._adjustCameras(),this._motionless=this._motionlessTransition()}prepend(t){super.prepend(t),this._motionless=this._motionlessTransition()}set(t){super.set(t),this._motionless=this._motionlessTransition()}move(t){this._alpha=Math.max(0,Math.min(1,this._alpha+t))}moveTo(t){this._alpha=Math.max(0,Math.min(1,t))}update(t){this._updateRotation(),this._rotationDelta.isZero||(this._applyRotation(this._rotationDelta,this._previousCamera),this._applyRotation(this._rotationDelta,this._currentCamera)),this._updateRotationBasic(),0===this._basicRotation[0]&&0===this._basicRotation[1]||this._applyRotationBasic(this._basicRotation);let e=this._animationSpeed*(60/t);this._updateZoom(e),this._updateLookat(e),this._camera.lerpCameras(this._previousCamera,this._currentCamera,this.alpha)}_getAlpha(){return this._motionless?Math.round(this._alpha):this._alpha}_setCurrentCamera(){super._setCurrentCamera(),this._adjustCameras()}_adjustCameras(){if(null!=this._previousImage){if(dd(this._currentImage.cameraType)){let t=this._camera.lookat.clone().sub(this._camera.position);this._currentCamera.lookat.copy(t.clone().add(this._currentCamera.position))}if(dd(this._previousImage.cameraType)){let t=this._currentCamera.lookat.clone().sub(this._currentCamera.position);this._previousCamera.lookat.copy(t.clone().add(this._previousCamera.position))}}}}class Dw extends Ud{constructor(t){super(t),this._zoom=0,this._adjustCameras(),this._motionless=this._motionlessTransition()}prepend(t){super.prepend(t),this._motionless=this._motionlessTransition()}set(t){super.set(t),this._motionless=this._motionlessTransition()}move(t){this._alpha=Math.max(0,Math.min(1,this._alpha+t))}moveTo(t){this._alpha=Math.max(0,Math.min(1,t))}update(t){this._camera.lerpCameras(this._previousCamera,this._currentCamera,this.alpha)}_getAlpha(){return this._motionless?Math.round(this._alpha):this._alpha}_setCurrentCamera(){super._setCurrentCamera(),this._adjustCameras()}_adjustCameras(){if(null!=this._previousImage){if(dd(this._currentImage.cameraType)){let t=this._camera.lookat.clone().sub(this._camera.position);this._currentCamera.lookat.copy(t.clone().add(this._currentCamera.position))}if(dd(this._previousImage.cameraType)){let t=this._currentCamera.lookat.clone().sub(this._currentCamera.position);this._previousCamera.lookat.copy(t.clone().add(this._previousCamera.position))}}}}class $w{constructor(){const t=vm[vm.Custom],e=vm[vm.Earth],i=vm[vm.Traversing],n=vm[vm.Waiting],r=vm[vm.WaitingInteractively];this._creators=new Map;const s=this._creators;s.set(t,Lw),s.set(e,Ow),s.set(i,qd),s.set(n,Dw),s.set(r,Nw),this._transitions=new Map;const o=this._transitions;o.set(t,[e,i]),o.set(e,[t,i]),o.set(i,[t,e,n,r]),o.set(n,[i,r]),o.set(r,[i,n])}getState(t){if(t instanceof Lw)return vm.Custom;if(t instanceof Ow)return vm.Earth;if(t instanceof qd)return vm.Traversing;if(t instanceof Dw)return vm.Waiting;if(t instanceof Nw)return vm.WaitingInteractively;throw new Error("Invalid state instance")}generate(t,e){return new(this._creators.get(vm[t]))(e)}transition(t,e){if(!this.validate(t,e))throw new Error("Invalid transition");return this.generate(e,t)}validate(t,e){const i=vm[this.getState(t)],n=vm[e],r=this._transitions;return r.has(i)&&r.get(i).includes(n)}}class kw{constructor(e,i){this._transitions=new $w,this._state=this._transitions.generate(e,{alpha:1,camera:new jd,currentIndex:-1,reference:{alt:0,lat:0,lng:0},trajectory:[],transitionMode:null==i?t.TransitionMode.Default:i,zoom:0})}get state(){return this._transitions.getState(this._state)}get reference(){return this._state.reference}get alpha(){return this._state.alpha}get camera(){return this._state.camera}get zoom(){return this._state.zoom}get currentImage(){return this._state.currentImage}get previousImage(){return this._state.previousImage}get currentCamera(){return this._state.currentCamera}get currentTransform(){return this._state.currentTransform}get previousTransform(){return this._state.previousTransform}get trajectory(){return this._state.trajectory}get currentIndex(){return this._state.currentIndex}get lastImage(){return this._state.trajectory[this._state.trajectory.length-1]}get imagesAhead(){return this._state.trajectory.length-1-this._state.currentIndex}get motionless(){return this._state.motionless}custom(){this._transition(vm.Custom)}earth(){this._transition(vm.Earth)}traverse(){this._transition(vm.Traversing)}wait(){this._transition(vm.Waiting)}waitInteractively(){this._transition(vm.WaitingInteractively)}getCenter(){return this._state.getCenter()}setCenter(t){this._state.setCenter(t)}setZoom(t){this._state.setZoom(t)}update(t){this._state.update(t)}append(t){this._state.append(t)}prepend(t){this._state.prepend(t)}remove(t){this._state.remove(t)}clear(){this._state.clear()}clearPrior(){this._state.clearPrior()}cut(){this._state.cut()}set(t){this._state.set(t)}setViewMatrix(t){this._state.setViewMatrix(t)}rotate(t){this._state.rotate(t)}rotateUnbounded(t){this._state.rotateUnbounded(t)}rotateWithoutInertia(t){this._state.rotateWithoutInertia(t)}rotateBasic(t){this._state.rotateBasic(t)}rotateBasicUnbounded(t){this._state.rotateBasicUnbounded(t)}rotateBasicWithoutInertia(t){this._state.rotateBasicWithoutInertia(t)}rotateToBasic(t){this._state.rotateToBasic(t)}move(t){this._state.move(t)}moveTo(t){this._state.moveTo(t)}zoomIn(t,e){this._state.zoomIn(t,e)}setSpeed(t){this._state.setSpeed(t)}setTransitionMode(t){this._state.setTransitionMode(t)}dolly(t){this._state.dolly(t)}orbit(t){this._state.orbit(t)}truck(t){this._state.truck(t)}_transition(t){if(!this._transitions.validate(this._state,t)){const e=this._transitions.getState(this._state);return void console.warn(`Transition not valid (${vm[e]} - ${vm[t]})`)}const e=this._transitions.transition(this._state,t);this._state=e}}class zw{constructor(t,e){this._appendImage$=new T,this._subscriptions=new Uf;const i=this._subscriptions;this._start$=new T,this._frame$=new T,this._fpsSampleRate=30,this._contextOperation$=new O((t=>t)),this._context$=this._contextOperation$.pipe(Le(((t,e)=>e(t)),new kw(t,e)),Ue(1),E()),this._state$=this._context$.pipe(rt((t=>t.state)),ue(),Ue(1),E()),this._fps$=this._start$.pipe(ri((()=>this._frame$.pipe(Xt(1,this._fpsSampleRate),rt((()=>(new Date).getTime())),ze(),rt((t=>Math.max(20,1e3*this._fpsSampleRate/(t[1]-t[0])))),ni(60)))),Ze()),this._currentState$=this._frame$.pipe(bi(this._fps$,this._context$,((t,e,i)=>[t,e,i])),Nt((t=>null!=t[2].currentImage)),pi((t=>{t[2].update(t[1])})),rt((t=>({fps:t[1],id:t[0],state:t[2]}))),Ze()),this._lastState$=this._currentState$.pipe(Ue(1),E());let n=this._currentState$.pipe(ue(void 0,(t=>t.state.currentImage.id)),Ue(1),E()),r=new T;i.push(n.subscribe(r)),this._currentId$=new O(null),i.push(r.pipe(rt((t=>t.state.currentImage.id))).subscribe(this._currentId$)),this._currentImage$=r.pipe(rt((t=>t.state.currentImage)),Ue(1),E()),this._currentCamera$=r.pipe(rt((t=>t.state.currentCamera)),Ue(1),E()),this._currentTransform$=r.pipe(rt((t=>t.state.currentTransform)),Ue(1),E()),this._reference$=r.pipe(rt((t=>t.state.reference)),ue(((t,e)=>t.lat===e.lat&&t.lng===e.lng),(t=>({lat:t.lat,lng:t.lng}))),Ue(1),E()),this._currentImageExternal$=n.pipe(rt((t=>t.state.currentImage)),Ue(1),E()),i.push(this._appendImage$.pipe(rt((t=>e=>(e.append([t]),e)))).subscribe(this._contextOperation$)),this._inMotionOperation$=new T,i.push(n.pipe(rt((()=>!0))).subscribe(this._inMotionOperation$)),i.push(this._inMotionOperation$.pipe(ue(),Nt((t=>t)),ri((()=>this._currentState$.pipe(Nt((t=>0===t.state.imagesAhead)),rt((t=>[t.state.camera.clone(),t.state.zoom])),ze(),rt((t=>{let e=t[0][0],i=t[1][0],n=t[0][1],r=t[1][1];return e.diff(i)>1e-5||Math.abs(n-r)>1e-5})),Ee((t=>!t)))))).subscribe(this._inMotionOperation$)),this._inMotion$=this._inMotionOperation$.pipe(ue(),Ue(1),E()),this._inTranslationOperation$=new T,i.push(n.pipe(rt((()=>!0))).subscribe(this._inTranslationOperation$)),i.push(this._inTranslationOperation$.pipe(ue(),Nt((t=>t)),ri((()=>this._currentState$.pipe(Nt((t=>0===t.state.imagesAhead)),rt((t=>t.state.camera.position.clone())),ze(),rt((t=>0!==t[0].distanceToSquared(t[1]))),Ee((t=>!t)))))).subscribe(this._inTranslationOperation$)),this._inTranslation$=this._inTranslationOperation$.pipe(ue(),Ue(1),E()),i.push(this._state$.subscribe((()=>{}))),i.push(this._currentImage$.subscribe((()=>{}))),i.push(this._currentCamera$.subscribe((()=>{}))),i.push(this._currentTransform$.subscribe((()=>{}))),i.push(this._reference$.subscribe((()=>{}))),i.push(this._currentImageExternal$.subscribe((()=>{}))),i.push(this._lastState$.subscribe((()=>{}))),i.push(this._inMotion$.subscribe((()=>{}))),i.push(this._inTranslation$.subscribe((()=>{}))),this._frameId=null,this._frameGenerator=new Rw(window)}get currentState$(){return this._currentState$}get currentImage$(){return this._currentImage$}get currentId$(){return this._currentId$}get currentImageExternal$(){return this._currentImageExternal$}get currentCamera$(){return this._currentCamera$}get currentTransform$(){return this._currentTransform$}get state$(){return this._state$}get reference$(){return this._reference$}get inMotion$(){return this._inMotion$}get inTranslation$(){return this._inTranslation$}get appendImage$(){return this._appendImage$}dispose(){this.stop(),this._subscriptions.unsubscribe()}custom(){this._inMotionOperation$.next(!0),this._invokeContextOperation((t=>{t.custom()}))}earth(){this._inMotionOperation$.next(!0),this._invokeContextOperation((t=>{t.earth()}))}traverse(){this._inMotionOperation$.next(!0),this._invokeContextOperation((t=>{t.traverse()}))}wait(){this._invokeContextOperation((t=>{t.wait()}))}waitInteractively(){this._invokeContextOperation((t=>{t.waitInteractively()}))}appendImagess(t){this._invokeContextOperation((e=>{e.append(t)}))}prependImages(t){this._invokeContextOperation((e=>{e.prepend(t)}))}removeImages(t){this._invokeContextOperation((e=>{e.remove(t)}))}clearImages(){this._invokeContextOperation((t=>{t.clear()}))}clearPriorImages(){this._invokeContextOperation((t=>{t.clearPrior()}))}cutImages(){this._invokeContextOperation((t=>{t.cut()}))}setImages(t){this._invokeContextOperation((e=>{e.set(t)}))}setViewMatrix(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.setViewMatrix(t)}))}rotate(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotate(t)}))}rotateUnbounded(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotateUnbounded(t)}))}rotateWithoutInertia(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotateWithoutInertia(t)}))}rotateBasic(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotateBasic(t)}))}rotateBasicUnbounded(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotateBasicUnbounded(t)}))}rotateBasicWithoutInertia(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotateBasicWithoutInertia(t)}))}rotateToBasic(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.rotateToBasic(t)}))}move(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.move(t)}))}moveTo(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.moveTo(t)}))}dolly(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.dolly(t)}))}orbit(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.orbit(t)}))}truck(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.truck(t)}))}zoomIn(t,e){this._inMotionOperation$.next(!0),this._invokeContextOperation((i=>{i.zoomIn(t,e)}))}getCenter(){return this._lastState$.pipe(Ee(),rt((t=>t.state.getCenter())))}getZoom(){return this._lastState$.pipe(Ee(),rt((t=>t.state.zoom)))}setCenter(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.setCenter(t)}))}setSpeed(t){this._invokeContextOperation((e=>{e.setSpeed(t)}))}setTransitionMode(t){this._invokeContextOperation((e=>{e.setTransitionMode(t)}))}setZoom(t){this._inMotionOperation$.next(!0),this._invokeContextOperation((e=>{e.setZoom(t)}))}start(){null==this._frameId&&(this._start$.next(null),this._frameId=this._frameGenerator.requestAnimationFrame(this._frame.bind(this)),this._frame$.next(this._frameId))}stop(){null!=this._frameId&&(this._frameGenerator.cancelAnimationFrame(this._frameId),this._frameId=null)}_invokeContextOperation(t){this._contextOperation$.next((e=>(t(e),e)))}_frame(){this._frameId=this._frameGenerator.requestAnimationFrame(this._frame.bind(this)),this._frame$.next(this._frameId)}}function Fw(e){switch(e){case t.CameraControls.Custom:return vm.Custom;case t.CameraControls.Earth:return vm.Earth;case t.CameraControls.Street:return vm.Traversing;default:return null}}class Bw{constructor(e,i,n,r,s,o,a,c){var h;if(i)this._api=i;else if(e.dataProvider){if(!(e.dataProvider instanceof Qx))throw new Error("Incorrect type: 'dataProvider' must extend the DataProviderBase class.");this._api=new Aw(e.dataProvider)}else this._api=new Aw(new sw({accessToken:e.accessToken}));this._graphService=null!=n?n:new Pw(new vd(this.api)),this._loadingName="navigator",this._loadingService=null!=r?r:new Cw;const l=null!==(h=e.cameraControls)&&void 0!==h?h:t.CameraControls.Street;this._stateService=null!=s?s:new zw(Fw(l),e.transitionMode),this._cacheService=null!=o?o:new Tw(this._graphService,this._stateService,this._api),this._playService=null!=a?a:new eg(this._graphService,this._stateService),this._panService=null!=c?c:new Iw(this._graphService,this._stateService,e.combinedPanning),this._idRequested$=new O(null),this._movedToId$=new O(null),this._request$=null,this._requestSubscription=null,this._imageRequestSubscription=null}get api(){return this._api}get cacheService(){return this._cacheService}get graphService(){return this._graphService}get loadingService(){return this._loadingService}get movedToId$(){return this._movedToId$}get panService(){return this._panService}get playService(){return this._playService}get stateService(){return this._stateService}dispose(){this._abortRequest("viewer removed"),this._cacheService.stop(),this._graphService.dispose(),this._panService.dispose(),this._playService.dispose(),this._stateService.dispose()}moveTo$(t){this._abortRequest(`to id ${t}`),this._loadingService.startLoading(this._loadingName);const e=this._moveTo$(t);return this._makeRequest$(e)}moveDir$(e){this._abortRequest(`in dir ${t.NavigationDirection[e]}`),this._loadingService.startLoading(this._loadingName);const i=this.stateService.currentImage$.pipe(Ee(),Mt((i=>([t.NavigationDirection.Next,t.NavigationDirection.Prev].indexOf(e)>-1?i.sequenceEdges$:i.spatialEdges$).pipe(Ee(),rt((t=>{for(let i of t.edges)if(i.data.direction===e)return i.target;return null}))))),Mt((t=>null==t?(this._loadingService.stopLoading(this._loadingName),q(new Error(`Direction (${e}) does not exist for current image.`))):this._moveTo$(t))));return this._makeRequest$(i)}setFilter$(t){return this._stateService.clearImages(),this._movedToId$.pipe(Ee(),Mt((e=>null!=e?this._trajectoryIds$().pipe(Mt((e=>this._graphService.setFilter$(t).pipe(Mt((()=>this._cacheIds$(e)))))),Re()):this._idRequested$.pipe(Ee(),Mt((e=>null!=e?this._graphService.setFilter$(t).pipe(Mt((()=>this._graphService.cacheImage$(e)))):this._graphService.setFilter$(t).pipe(rt((()=>{})))))))),rt((()=>{})))}setAccessToken$(t){return this._abortRequest("to set user token"),this._stateService.clearImages(),this._movedToId$.pipe(Ee(),pi((()=>{this._api.setAccessToken(t)})),Mt((t=>null==t?this._graphService.reset$([]):this._trajectoryIds$().pipe(Mt((t=>this._graphService.reset$(t).pipe(Mt((()=>this._cacheIds$(t)))))),Re(),rt((()=>{}))))))}_cacheIds$(t){return bt(t.map((t=>this._graphService.cacheImage$(t)))).pipe(Et())}_abortRequest(t){null!=this._requestSubscription&&(this._requestSubscription.unsubscribe(),this._requestSubscription=null),null!=this._imageRequestSubscription&&(this._imageRequestSubscription.unsubscribe(),this._imageRequestSubscription=null),null!=this._request$&&(this._request$.isStopped||this._request$.hasError||this._request$.error(new Zf(`Request aborted by a subsequent request ${t}.`)),this._request$=null)}_makeRequest$(t){const e=new J(1);return this._requestSubscription=e.subscribe(void 0,(()=>{})),this._request$=e,this._imageRequestSubscription=t.subscribe((t=>{this._request$=null,e.next(t),e.complete()}),(t=>{this._request$=null,e.error(t)})),e}_moveTo$(t){return this._idRequested$.next(t),this._graphService.cacheImage$(t).pipe(pi((t=>{this._stateService.setImages([t]),this._movedToId$.next(t.id)})),Me((()=>{this._loadingService.stopLoading(this._loadingName)})))}_trajectoryIds$(){return this._stateService.currentState$.pipe(Ee(),rt((t=>t.state.trajectory.map((t=>t.id)))))}}class jw{constructor(t,e){this._spatial=null!=e?e:new ld,this._viewportCoords=null!=t?t:new Wf}basicToCanvas(t,e,i,n){return this._viewportCoords.basicToCanvasSafe(t[0],t[1],e,n,i.perspective)}canvasToBasic(t,e,i,n){let r=this._viewportCoords.canvasToBasic(t[0],t[1],e,n,i.perspective);return(r[0]<0||r[0]>1||r[1]<0||r[1]>1)&&(r=null),r}eventToUnprojection(t,e,i,n,r){const s=this._viewportCoords.canvasPosition(t,e);return this.canvasToUnprojection(s,e,i,n,r)}canvasToUnprojection(t,e,i,n,r){const s=t[0],o=t[1],[a,c]=this._viewportCoords.canvasToViewport(s,o,e),h=new fn(a,c,1).unproject(i.perspective);let l=r.projectBasic(h.toArray());(l[0]<0||l[0]>1||l[1]<0||l[1]>1)&&(l=null);const u=h.clone().sub(i.camera.position).normalize(),d=-2/u.z;let p=null;if(d>0&&d<100&&l){const t=u.clone().multiplyScalar(d).add(i.camera.position),[e,r]=Ku(t.x,t.y,t.z,n.lng,n.lat,n.alt);p={lat:r,lng:e}}return{basicPoint:l,lngLat:p,pixelPoint:[s,o]}}cameraToLngLat(t,e){const i=t.camera.position,[n,r]=Ku(i.x,i.y,i.z,e.lng,e.lat,e.alt);return{lat:r,lng:n}}lngLatToCanvas(t,e,i,n){const r=Ju(t.lng,t.lat,0,n.lng,n.lat,n.alt);return this._viewportCoords.projectToCanvasSafe(r,e,i.perspective)}distanceBetweenLngLats(t,e){return this._spatial.distanceFromLngLat(t.lng,t.lat,e.lng,e.lat)}}class Hw{constructor(t,e,i){this._subscriptions=new Uf,this._emitSubscriptions=new Uf,this._container=i,this._viewer=t,this._navigator=e,this._projection=new jw,this._started=!1,this._navigable$=new T;const n=this._subscriptions;n.push(this._navigable$.subscribe((t=>{const e="navigable",i={navigable:t,target:this._viewer,type:e};this._viewer.fire(e,i)}))),n.push(this._navigator.loadingService.loading$.subscribe((t=>{const e="dataloading",i={loading:t,target:this._viewer,type:e};this._viewer.fire(e,i)}))),n.push(this._container.glRenderer.opaqueRender$.pipe(Ee()).subscribe((()=>{const t="load",e={target:this._viewer,type:t};this._viewer.fire(t,e)})))}get started(){return this._started}get navigable$(){return this._navigable$}get projection(){return this._projection}dispose(){this.stopEmit(),this._subscriptions.unsubscribe()}project$(t){return gt(this._container.renderService.renderCamera$,this._navigator.stateService.currentImage$,this._navigator.stateService.reference$).pipe(Ee(),rt((([e,i,n])=>{if(this._projection.distanceBetweenLngLats(t,i.lngLat)>1e3)return null;const r=this._projection.lngLatToCanvas(t,this._container.container,e,n);return r?[Math.round(r[0]),Math.round(r[1])]:null})))}projectBasic$(t){return gt(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$).pipe(Ee(),rt((([e,i])=>{const n=this._projection.basicToCanvas(t,this._container.container,e,i);return n?[Math.round(n[0]),Math.round(n[1])]:null})))}startEmit(){if(this._started)return;this._started=!0;const t=this._emitSubscriptions;t.push(this._navigator.stateService.currentImageExternal$.subscribe((t=>{const e="image",i={image:t,target:this._viewer,type:e};this._viewer.fire(e,i)}))),t.push(this._navigator.stateService.currentImageExternal$.pipe(ri((t=>t.sequenceEdges$))).subscribe((t=>{const e="sequenceedges",i={status:t,target:this._viewer,type:e};this._viewer.fire(e,i)}))),t.push(this._navigator.stateService.currentImageExternal$.pipe(ri((t=>t.spatialEdges$))).subscribe((t=>{const e="spatialedges",i={status:t,target:this._viewer,type:e};this._viewer.fire(e,i)}))),t.push(gt(this._navigator.stateService.inMotion$,this._container.mouseService.active$,this._container.touchService.active$).pipe(rt((t=>t[0]||t[1]||t[2])),ue()).subscribe((t=>{const e=t?"movestart":"moveend",i={target:this._viewer,type:e};this._viewer.fire(e,i)}))),t.push(this._container.renderService.bearing$.pipe(Wt(100),ue(((t,e)=>Math.abs(e-t)<1))).subscribe((t=>{const e="bearing",i={bearing:t,target:this._viewer,type:e};this._viewer.fire(e,i)})));const e=this._container.mouseService.active$.pipe(ri((t=>t?B():this._container.mouseService.mouseMove$)));t.push(Ot(this._mapMouseEvent$("click",this._container.mouseService.staticClick$),this._mapMouseEvent$("contextmenu",this._container.mouseService.contextMenu$),this._mapMouseEvent$("dblclick",this._container.mouseService.dblClick$),this._mapMouseEvent$("mousedown",this._container.mouseService.mouseDown$),this._mapMouseEvent$("mousemove",e),this._mapMouseEvent$("mouseout",this._container.mouseService.mouseOut$),this._mapMouseEvent$("mouseover",this._container.mouseService.mouseOver$),this._mapMouseEvent$("mouseup",this._container.mouseService.mouseUp$)).pipe(bi(this._container.renderService.renderCamera$,this._navigator.stateService.reference$,this._navigator.stateService.currentTransform$,this._navigator.stateService.state$),rt((([[t,e],i,n,r,s])=>{const o=this._projection.eventToUnprojection(e,this._container.container,i,n,r);return{basicPoint:s===vm.Traversing?o.basicPoint:null,lngLat:o.lngLat,originalEvent:e,pixelPoint:o.pixelPoint,target:this._viewer,type:t}}))).subscribe((t=>{this._viewer.fire(t.type,t)}))),t.push(this._container.renderService.renderCamera$.pipe(ue((([t,e],[i,n])=>this._closeTo(t,i,.01)&&this._closeTo(e,n,.01)),(t=>t.camera.position.toArray()))).subscribe((()=>{const t="position",e={target:this._viewer,type:t};this._viewer.fire(t,e)}))),t.push(this._container.renderService.renderCamera$.pipe(ue((([t,e],[i,n])=>this._closeTo(t,i,.001)&&this._closeTo(e,n,.001)),(t=>[t.rotation.phi,t.rotation.theta]))).subscribe((()=>{const t={target:this._viewer,type:"pov"};this._viewer.fire("pov",t)}))),t.push(this._container.renderService.renderCamera$.pipe(ue(((t,e)=>this._closeTo(t,e,.01)),(t=>t.perspective.fov))).subscribe((()=>{const t={target:this._viewer,type:"fov"};this._viewer.fire("fov",t)})))}stopEmit(){this.started&&(this._emitSubscriptions.unsubscribe(),this._started=!1)}unproject$(t){return gt(this._container.renderService.renderCamera$,this._navigator.stateService.reference$,this._navigator.stateService.currentTransform$).pipe(Ee(),rt((([e,i,n])=>this._projection.canvasToUnprojection(t,this._container.container,e,i,n).lngLat)))}unprojectBasic$(t){return gt(this._container.renderService.renderCamera$,this._navigator.stateService.currentTransform$).pipe(Ee(),rt((([e,i])=>this._projection.canvasToBasic(t,this._container.container,e,i))))}_closeTo(t,e,i){return Math.abs(t-e)<=i}_mapMouseEvent$(t,e){return e.pipe(rt((e=>[t,e])))}}class Uw{constructor(t,e){this._container=t,this._navigator=e,this._renderers={}}add(t,e){const i=new Uf;this._renderers[t.id]={subs:i,renderer:t},i.push(gt([this._container.glRenderer.webGLRenderer$,this._navigator.stateService.reference$]).pipe(ve(1)).subscribe((([i,n])=>{t.onAdd(e,n,i.getContext())}))),i.push(this._container.glRenderer.opaqueRender$.pipe(bi(this._container.renderService.renderCamera$,this._container.glRenderer.webGLRenderer$)).subscribe((([,e,i])=>{const n=i.getContext(),r=e.perspective.matrixWorldInverse,s=e.perspective.projectionMatrix;t.render(n,r.toArray(),s.toArray())}))),i.push(this._navigator.stateService.reference$.pipe(Je(1)).subscribe((i=>{t.onReference(e,i)})))}dispose(t){for(const e of Object.keys(this._renderers))this.remove(e,t)}has(t){return t in this._renderers}remove(t,e){this._renderers[t].subs.unsubscribe();const i=this._renderers[t].renderer;delete this._renderers[t],this._container.glRenderer.webGLRenderer$.subscribe((t=>{i.onRemove(e,t.getContext())}))}}class Vw{constructor(t,e){this._container=t,this._navigator=e,this._controls=null,this._subscriptions=new Uf}attach(t,e){if(this._controls)throw new cd("Custom camera controls already attached");const i=new T,n=i.pipe(ri((()=>this._navigator.stateService.state$)),rt((t=>t===vm.Custom)),ue()),r=this._subscriptions;r.push(n.pipe(ni(!1),ze(),bi(this._navigator.stateService.reference$,this._container.renderService.renderCamera$)).subscribe((([[i,n],r,s])=>{n?t.onActivate(e,s.perspective.matrixWorldInverse.toArray(),s.perspective.projectionMatrix.toArray(),r):i&&t.onDeactivate(e)}))),r.push(n.pipe(ri((t=>t?this._navigator.stateService.currentState$.pipe(Je(1)):B()))).subscribe((i=>{t.onAnimationFrame(e,i.id)}))),r.push(n.pipe(ri((t=>t?this._navigator.stateService.reference$.pipe(Je(1)):B()))).subscribe((i=>t.onReference(e,i)))),r.push(n.pipe(ri((t=>t?this._container.renderService.size$.pipe(Je(1)):B()))).subscribe((()=>t.onResize(e)))),r.push(gt([this._container.glRenderer.webGLRenderer$,this._container.renderService.renderCamera$,this._navigator.stateService.reference$,this._navigator.stateService.state$]).pipe(Ee()).subscribe((()=>{t.onAttach(e,(e=>{this._controls&&t===this._controls&&this._updateViewMatrix(e)}),(e=>{this._controls&&t===this._controls&&this._updateProjectionMatrix(e)})),i.next(),i.complete()}))),this._controls=t}dispose(t){this.detach(t)}detach(t){this._controls&&(this._subscriptions.unsubscribe(),this._navigator.stateService.state$.subscribe((e=>{e===vm.Custom&&this._controls.onDeactivate(t),this._controls.onDetach(t),this._controls=null})))}_updateProjectionMatrix(t){this._navigator.stateService.state$.pipe(Ee()).subscribe((e=>{if(e===vm.Custom)this._container.renderService.projectionMatrix$.next(t);else{const t="Incorrect camera control mode for projection matrix update";console.warn(t)}}))}_updateViewMatrix(t){this._navigator.stateService.state$.pipe(Ee()).subscribe((e=>{if(e===vm.Custom)this._navigator.stateService.setViewMatrix(t);else{const t="Incorrect camera control mode for view matrix update";console.warn(t)}}))}}vd.register(kd),yd.register(kd),qd.register(Fd),Wd.registerCover(Gf),Wd.register(qf),Wd.register(Xf),Wd.register(Yf),Wd.register(Qf),Wd.register(Mm),Wd.register(Pm),Wd.register(Lm),Wd.register(Wm),Wd.register(Ym),Wd.register(Jm),Wd.register(tg),Wd.register(bg),Wd.register(Sv),Wd.register(Mv),Wd.register(Tv),Wd.register(Cv),t.ArgumentMapillaryError=hd,t.BearingComponent=Xf,t.CacheComponent=Yf,t.CancelMapillaryError=Zf,t.CircleMarker=class extends ow{constructor(t,e,i){super(t,e),i=i||{},this._color=null!=i.color?i.color:16777215,this._opacity=null!=i.opacity?i.opacity:.4,this._radius=null!=i.radius?i.radius:1}_createGeometry(t){const e=new Es(new sh(this._radius,16),new Fr({color:this._color,opacity:this._opacity,transparent:!0}));e.up.fromArray([0,0,1]),e.renderOrder=-1;const i=new pr;i.add(e),i.position.fromArray(t),this._geometry=i}_disposeGeometry(){for(let t of this._geometry.children)t.geometry.dispose(),t.material.dispose()}_getInteractiveObjects(){return[]}},t.Component=Vf,t.DataProviderBase=Qx,t.DirectionComponent=Qf,t.DragPanHandler=Um,t.ExtremePointTag=av,t.Geometry=xg,t.GeometryProviderBase=Kx,t.GeometryTagError=wg,t.GraphDataProvider=sw,t.GraphMapillaryError=_d,t.Image=ed,t.KeyPlayHandler=Am,t.KeySequenceNavigationHandler=Cm,t.KeySpatialNavigationHandler=Em,t.KeyZoomHandler=Im,t.KeyboardComponent=Pm,t.MapillaryError=cd,t.Marker=ow,t.MarkerComponent=Lm,t.OutlineTag=hv,t.PointGeometry=pv,t.PointerComponent=Wm,t.PointsGeometry=Sg,t.PolygonGeometry=X_,t.Popup=class{constructor(t,e,i){this._options={},t=t||{},this._options.capturePointer=!1!==t.capturePointer||t.capturePointer,this._options.clean=t.clean,this._options.float=t.float,this._options.offset=t.offset,this._options.opacity=t.opacity,this._options.position=t.position,this._dom=i||new Xm,this._viewportCoords=e||new Wf,this._notifyChanged$=new T}get changed$(){return this._notifyChanged$}remove(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content),this._container&&(this._container.parentNode.removeChild(this._container),delete this._container),this._parentContainer&&delete this._parentContainer}setBasicPoint(t){this._point=t.slice(),this._rect=null,this._notifyChanged$.next(this)}setBasicRect(t){this._rect=t.slice(),this._point=null,this._notifyChanged$.next(this)}setDOMContent(t){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content);const e="mapillary-popup-content"+(!0===this._options.clean?"-clean":"")+(!0===this._options.capturePointer?" mapillary-popup-capture-pointer":"");this._content=this._dom.createElement("div",e,this._container),this._content.appendChild(t),this._notifyChanged$.next(this)}setHTML(t){const e=this._dom.document.createDocumentFragment(),i=this._dom.createElement("body");let n;for(i.innerHTML=t;n=i.firstChild,n;)e.appendChild(n);this.setDOMContent(e)}setText(t){this.setDOMContent(this._dom.document.createTextNode(t))}setParentContainer(t){this._parentContainer=t}update(e,i,n){if(!this._parentContainer||!this._content)return;if(!this._point&&!this._rect)return;if(!this._container){this._container=this._dom.createElement("div","mapillary-popup",this._parentContainer);if(!0!==this._options.clean&&this._options.float!==t.Alignment.Center){const t="mapillary-popup-tip"+(!0===this._options.capturePointer?" mapillary-popup-capture-pointer":"");this._tip=this._dom.createElement("div",t,this._container),this._dom.createElement("div","mapillary-popup-tip-inner",this._tip)}this._container.appendChild(this._content),this._parentContainer.appendChild(this._container),null!=this._options.opacity&&(this._container.style.opacity=this._options.opacity.toString())}let r=null,s=this._alignmentToPopupAligment(this._options.position),o=this._alignmentToPopupAligment(this._options.float);const a=this._container.classList;if(null!=this._point)r=this._viewportCoords.basicToCanvasSafe(this._point[0],this._point[1],{offsetHeight:i.height,offsetWidth:i.width},n,e.perspective);else{const t=["center","top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"];let c=null;for(const e of t)if(a.contains(`mapillary-popup-float-${e}`)){c=e;break}[r,s]=this._rectToPixel(this._rect,s,c,e,i,n),o||(o=s)}if(null==r)return void(this._container.style.display="none");if(this._container.style.display="",!o){const t=this._container.offsetWidth,e=this._container.offsetHeight,n=this._pixelToFloats(r,i,t,e);o=0===n.length?"top":n.join("-")}const c=this._normalizeOffset(this._options.offset);r=[r[0]+c[o][0],r[1]+c[o][1]],r=[Math.round(r[0]),Math.round(r[1])];const h={bottom:"translate(-50%,0)","bottom-left":"translate(-100%,0)","bottom-right":"translate(0,0)",center:"translate(-50%,-50%)",left:"translate(-100%,-50%)",right:"translate(0,-50%)",top:"translate(-50%,-100%)","top-left":"translate(-100%,-100%)","top-right":"translate(0,-100%)"};for(const t in h)h.hasOwnProperty(t)&&a.remove(`mapillary-popup-float-${t}`);a.add(`mapillary-popup-float-${o}`),this._container.style.transform=`${h[o]} translate(${r[0]}px,${r[1]}px)`}_rectToPixel(t,e,i,n,r,s){if(!e){const e=this._container.offsetWidth,o=this._container.offsetHeight,a={bottom:[0,o/2],"bottom-left":[-e/2,o/2],"bottom-right":[e/2,o/2],left:[-e/2,0],right:[e/2,0],top:[0,-o/2],"top-left":[-e/2,-o/2],"top-right":[e/2,-o/2]},c=["top","bottom","left","right"];let h=[0,null,null];for(const l of c){const c=this._pointFromRectPosition(t,l),u=this._viewportCoords.basicToCanvasSafe(c[0],c[1],{offsetHeight:r.height,offsetWidth:r.width},s,n.perspective);if(null==u)continue;const d=a[l],p=[u[0]+d[0],u[1]+d[1]],f=null!=i&&i===l?1:.7;if(0===this._pixelToFloats(p,r,e/f,o/(2*f)).length&&u[0]>0&&u[0]<r.width&&u[1]>0&&u[1]<r.height)return[u,l];const m=Math.max(p[0]-e/2,0),g=Math.min(p[0]+e/2,r.width),_=Math.max(p[1]-o/2,0),v=Math.min(p[1]+o/2,r.height),y=f*Math.max(0,g-m)*Math.max(0,v-_);y>h[0]&&(h[0]=y,h[1]=u,h[2]=l)}if(h[0]>0)return[h[1],h[2]]}const o=this._pointFromRectPosition(t,e);return[this._viewportCoords.basicToCanvasSafe(o[0],o[1],{offsetHeight:r.height,offsetWidth:r.width},s,n.perspective),null!=e?e:"top"]}_alignmentToPopupAligment(e){switch(e){case t.Alignment.Bottom:return"bottom";case t.Alignment.BottomLeft:return"bottom-left";case t.Alignment.BottomRight:return"bottom-right";case t.Alignment.Center:return"center";case t.Alignment.Left:return"left";case t.Alignment.Right:return"right";case t.Alignment.Top:return"top";case t.Alignment.TopLeft:return"top-left";case t.Alignment.TopRight:return"top-right";default:return null}}_normalizeOffset(t){if(null==t)return this._normalizeOffset(0);if("number"==typeof t){const e=t,i=(e>=0?1:-1)*Math.round(Math.sqrt(.5*Math.pow(e,2)));return{bottom:[0,e],"bottom-left":[-i,i],"bottom-right":[i,i],center:[0,0],left:[-e,0],right:[e,0],top:[0,-e],"top-left":[-i,-i],"top-right":[i,-i]}}return{bottom:t.bottom||[0,0],"bottom-left":t.bottomLeft||[0,0],"bottom-right":t.bottomRight||[0,0],center:t.center||[0,0],left:t.left||[0,0],right:t.right||[0,0],top:t.top||[0,0],"top-left":t.topLeft||[0,0],"top-right":t.topRight||[0,0]}}_pixelToFloats(t,e,i,n){const r=[];return t[1]<n?r.push("bottom"):t[1]>e.height-n&&r.push("top"),t[0]<i/2?r.push("right"):t[0]>e.width-i/2&&r.push("left"),r}_pointFromRectPosition(t,e){const i=t[0],n=t[0]<t[2]?t[2]:t[2]+1,r=t[1],s=t[3];switch(e){case"bottom":return[(i+n)/2,s];case"bottom-left":return[i,s];case"bottom-right":return[n,s];case"center":return[(i+n)/2,(r+s)/2];case"left":return[i,(r+s)/2];case"right":return[n,(r+s)/2];case"top":return[(i+n)/2,r];case"top-left":return[i,r];case"top-right":return[n,r];default:return[(i+n)/2,s]}}},t.PopupComponent=Ym,t.RectGeometry=q_,t.S2GeometryProvider=iw,t.ScrollZoomHandler=Gm,t.SequenceComponent=Jm,t.SimpleMarker=class extends ow{constructor(t,e,i){super(t,e),i=i||{},this._ballColor=null!=i.ballColor?i.ballColor:16711680,this._ballOpacity=null!=i.ballOpacity?i.ballOpacity:.8,this._circleToRayAngle=2,this._color=null!=i.color?i.color:16711680,this._interactive=!!i.interactive,this._opacity=null!=i.opacity?i.opacity:.4,this._radius=null!=i.radius?i.radius:1}_createGeometry(t){const e=this._radius,i=this._markerHeight(e),n=new Fr({color:this._color,opacity:this._opacity,transparent:!0,depthWrite:!1}),r=new Es(this._createMarkerGeometry(e,8,8),n),s=new Es(new zh(e/2,8,8),new Fr({color:this._ballColor,opacity:this._ballOpacity,transparent:!0}));s.position.z=i,s.renderOrder=1;const o=new pr;o.add(s),o.add(r),o.position.fromArray(t),this._geometry=o}_disposeGeometry(){for(const t of this._geometry.children)t.geometry.dispose(),t.material.dispose()}_getInteractiveObjects(){return this._interactive?[this._geometry.children[0]]:[]}_markerHeight(t){const e=Math.tan(Math.PI-this._circleToRayAngle);return t*Math.sqrt(1+e*e)}_createMarkerGeometry(t,e,i){const n=this._markerHeight(t),r=this._circleToRayAngle,s=[],o=new Float32Array(3*(e+1)*(i+1));let a=0;for(let c=0;c<=i;++c){const h=[];for(let s=0;s<=e;++s){const l=s/e*Math.PI*2,u=c/i*Math.PI;let d=t;if(u>r){const e=Math.tan(u-r);d=t*Math.sqrt(1+e*e)}const p=3*a,f=Math.sin(u);o[p+0]=d*Math.cos(l)*f,o[p+1]=d*Math.sin(l)*f,o[p+2]=d*Math.cos(u)+n,h.push(a++)}s.push(h)}const c=new Uint16Array(6*e*i);let h=0;for(let t=0;t<i;++t)for(let i=0;i<e;++i){const e=s[t][i+1],n=s[t][i],r=s[t+1][i],o=s[t+1][i+1];c[h++]=e,c[h++]=n,c[h++]=o,c[h++]=n,c[h++]=r,c[h++]=o}const l=new hs,u=new Hr(o,3);return l.setAttribute("position",u),l.setIndex(new Hr(c,1)),l}},t.SliderComponent=tg,t.SpatialComponent=bg,t.SpotTag=uv,t.Tag=ov,t.TagComponent=Sv,t.TouchZoomHandler=qm,t.VertexGeometry=G_,t.Viewer=class extends Hf{constructor(t){super(),this._navigator=new Bw(t),this._container=new Mw(t,this._navigator.stateService),this._observer=new Hw(this,this._navigator,this._container),this._componentController=new dw(this._container,this._navigator,this._observer,t.imageId,t.component),this._customRenderer=new Uw(this._container,this._navigator),this._customCameraControls=new Vw(this._container,this._navigator)}get isNavigable(){return this._componentController.navigable}activateCombinedPanning(){this._navigator.panService.enable()}activateComponent(t){this._componentController.activate(t)}activateCover(){this._componentController.activateCover()}addCustomRenderer(t){this._customRenderer.add(t,this)}attachCustomCameraControls(t){this._customCameraControls.attach(t,this)}deactivateCombinedPanning(){this._navigator.panService.disable()}deactivateComponent(t){this._componentController.deactivate(t)}deactivateCover(){this._componentController.deactivateCover()}detachCustomCameraControls(){this._customCameraControls.detach(this)}fire(t,e){super.fire(t,e)}getBearing(){return new Promise(((t,e)=>{this._container.renderService.bearing$.pipe(Ee()).subscribe((e=>{t(e)}),(t=>{e(t)}))}))}getCameraControls(){return new Promise(((e,i)=>{this._navigator.stateService.state$.pipe(Ee()).subscribe((i=>{switch(i){case vm.Custom:e(t.CameraControls.Custom);break;case vm.Earth:e(t.CameraControls.Earth);break;default:e(t.CameraControls.Street)}}),(t=>{i(t)}))}))}getCanvas(){return this._container.canvas}getCanvasContainer(){return this._container.canvasContainer}getCenter(){return new Promise(((t,e)=>{this._navigator.stateService.getCenter().subscribe((e=>{t(e)}),(t=>{e(t)}))}))}getComponent(t){return this._componentController.get(t)}getContainer(){return this._container.container}getFieldOfView(){return new Promise(((t,e)=>{this._container.renderService.renderCamera$.pipe(Ee()).subscribe((e=>{t(e.perspective.fov)}),(t=>{e(t)}))}))}getImage(){return new Promise(((t,e)=>{this._navigator.stateService.currentImage$.pipe(Ee()).subscribe((e=>{t(e)}),(t=>{e(t)}))}))}getPointOfView(){return new Promise(((t,e)=>{gt(this._container.renderService.renderCamera$,this._container.renderService.bearing$).pipe(Ee()).subscribe((([e,i])=>{t({bearing:i,tilt:e.getTilt()})}),(t=>{e(t)}))}))}getPosition(){return new Promise(((t,e)=>{gt(this._container.renderService.renderCamera$,this._navigator.stateService.reference$).pipe(Ee()).subscribe((([e,i])=>{t(this._observer.projection.cameraToLngLat(e,i))}),(t=>{e(t)}))}))}getZoom(){return new Promise(((t,e)=>{this._navigator.stateService.getZoom().subscribe((e=>{t(e)}),(t=>{e(t)}))}))}hasCustomRenderer(t){return this._customRenderer.has(t)}moveDir(t){const e=this.isNavigable?this._navigator.moveDir$(t):q(new Error("Calling moveDir is not supported when viewer is not navigable."));return new Promise(((t,i)=>{e.subscribe((e=>{t(e)}),(t=>{i(t)}))}))}moveTo(t){const e=this.isNavigable?this._navigator.moveTo$(t):q(new Error("Calling moveTo is not supported when viewer is not navigable."));return new Promise(((t,i)=>{e.subscribe((e=>{t(e)}),(t=>{i(t)}))}))}off(t,e){super.off(t,e)}on(t,e){super.on(t,e)}project(t){return new Promise(((e,i)=>{this._observer.project$(t).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}projectFromBasic(t){return new Promise(((e,i)=>{this._observer.projectBasic$(t).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}remove(){this._customRenderer.dispose(this),this._customCameraControls.dispose(this),this._observer.dispose(),this._componentController.remove(),this._navigator.dispose(),this._container.remove();const t="remove",e={target:this,type:t};this.fire(t,e)}removeCustomRenderer(t){this._customRenderer.remove(t,this)}resize(){this._container.renderService.resize$.next()}setCameraControls(t){const e=Fw(t);e===vm.Traversing?this._navigator.stateService.traverse():e===vm.Earth?this._navigator.stateService.earth():e===vm.Custom?this._navigator.stateService.custom():console.warn(`Unsupported camera control transition (${t})`)}setCenter(t){this._navigator.stateService.setCenter(t)}setFieldOfView(t){this._container.renderService.renderCamera$.pipe(Ee()).subscribe((e=>{const i=e.fovToZoom(t);this._navigator.stateService.setZoom(i)}))}setFilter(t){return new Promise(((e,i)=>{this._navigator.setFilter$(t).subscribe((()=>{e(void 0)}),(t=>{i(t)}))}))}setRenderMode(t){this._container.renderService.renderMode$.next(t)}setTransitionMode(t){this._navigator.stateService.setTransitionMode(t)}setAccessToken(t){const e=this.isNavigable?this._navigator.setAccessToken$(t):q(new Error("Calling setAccessToken is not supported when viewer is not navigable."));return new Promise(((t,i)=>{e.subscribe((()=>{t(void 0)}),(t=>{i(t)}))}))}setZoom(t){this._navigator.stateService.setZoom(t)}triggerRerender(){this._container.glRenderer.triggerRerender()}unproject(t){return new Promise(((e,i)=>{this._observer.unproject$(t).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}unprojectToBasic(t){return new Promise(((e,i)=>{this._observer.unprojectBasic$(t).subscribe((t=>{e(t)}),(t=>{i(t)}))}))}},t.ZoomComponent=Mv,t.decompress=Wx,t.enuToGeodetic=Ku,t.fetchArrayBuffer=Xx,t.geodeticToEnu=Ju,t.isFallbackSupported=hw,t.isSupported=function(){return hw()&&cw()},t.readMeshPbf=Zx,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=mapillary.js.map

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tYXBpbGxhcnktanMvZGlzdC9tYXBpbGxhcnkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiIWZ1bmN0aW9uKHQsZSl7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBtb2R1bGU/ZShleHBvcnRzKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtcImV4cG9ydHNcIl0sZSk6ZSgodD1cInVuZGVmaW5lZFwiIT10eXBlb2YgZ2xvYmFsVGhpcz9nbG9iYWxUaGlzOnR8fHNlbGYpLm1hcGlsbGFyeT17fSl9KHRoaXMsKGZ1bmN0aW9uKHQpe1widXNlIHN0cmljdFwiO1xuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXG5cbiAgICBQZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcbiAgICBwdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXG5cbiAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXG4gICAgUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXG4gICAgQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxuICAgIElORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxuICAgIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXG4gICAgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxuICAgIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi92YXIgZT1mdW5jdGlvbih0LGkpe3JldHVybihlPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbih0LGUpe3QuX19wcm90b19fPWV9fHxmdW5jdGlvbih0LGUpe2Zvcih2YXIgaSBpbiBlKWUuaGFzT3duUHJvcGVydHkoaSkmJih0W2ldPWVbaV0pfSkodCxpKX07ZnVuY3Rpb24gaSh0LGkpe2Z1bmN0aW9uIG4oKXt0aGlzLmNvbnN0cnVjdG9yPXR9ZSh0LGkpLHQucHJvdG90eXBlPW51bGw9PT1pP09iamVjdC5jcmVhdGUoaSk6KG4ucHJvdG90eXBlPWkucHJvdG90eXBlLG5ldyBuKX1mdW5jdGlvbiBuKHQpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHR9dmFyIHI9ITEscz17UHJvbWlzZTp2b2lkIDAsc2V0IHVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcodCl7dCYmKG5ldyBFcnJvcikuc3RhY2s7cj10fSxnZXQgdXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZygpe3JldHVybiByfX07ZnVuY3Rpb24gbyh0KXtzZXRUaW1lb3V0KChmdW5jdGlvbigpe3Rocm93IHR9KSwwKX12YXIgYT17Y2xvc2VkOiEwLG5leHQ6ZnVuY3Rpb24odCl7fSxlcnJvcjpmdW5jdGlvbih0KXtpZihzLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcpdGhyb3cgdDtvKHQpfSxjb21wbGV0ZTpmdW5jdGlvbigpe319LGM9ZnVuY3Rpb24oKXtyZXR1cm4gQXJyYXkuaXNBcnJheXx8ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwibnVtYmVyXCI9PXR5cGVvZiB0Lmxlbmd0aH19KCk7ZnVuY3Rpb24gaCh0KXtyZXR1cm4gbnVsbCE9PXQmJlwib2JqZWN0XCI9PXR5cGVvZiB0fXZhciBsPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXtyZXR1cm4gRXJyb3IuY2FsbCh0aGlzKSx0aGlzLm1lc3NhZ2U9dD90Lmxlbmd0aCtcIiBlcnJvcnMgb2NjdXJyZWQgZHVyaW5nIHVuc3Vic2NyaXB0aW9uOlxcblwiK3QubWFwKChmdW5jdGlvbih0LGUpe3JldHVybiBlKzErXCIpIFwiK3QudG9TdHJpbmcoKX0pKS5qb2luKFwiXFxuICBcIik6XCJcIix0aGlzLm5hbWU9XCJVbnN1YnNjcmlwdGlvbkVycm9yXCIsdGhpcy5lcnJvcnM9dCx0aGlzfXJldHVybiB0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSksdH0oKSx1PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLmNsb3NlZD0hMSx0aGlzLl9wYXJlbnRPclBhcmVudHM9bnVsbCx0aGlzLl9zdWJzY3JpcHRpb25zPW51bGwsdCYmKHRoaXMuX2N0b3JVbnN1YnNjcmliZT0hMCx0aGlzLl91bnN1YnNjcmliZT10KX1yZXR1cm4gdC5wcm90b3R5cGUudW5zdWJzY3JpYmU9ZnVuY3Rpb24oKXt2YXIgZTtpZighdGhpcy5jbG9zZWQpe3ZhciBpPXRoaXMscj1pLl9wYXJlbnRPclBhcmVudHMscz1pLl9jdG9yVW5zdWJzY3JpYmUsbz1pLl91bnN1YnNjcmliZSxhPWkuX3N1YnNjcmlwdGlvbnM7aWYodGhpcy5jbG9zZWQ9ITAsdGhpcy5fcGFyZW50T3JQYXJlbnRzPW51bGwsdGhpcy5fc3Vic2NyaXB0aW9ucz1udWxsLHIgaW5zdGFuY2VvZiB0KXIucmVtb3ZlKHRoaXMpO2Vsc2UgaWYobnVsbCE9PXIpZm9yKHZhciB1PTA7dTxyLmxlbmd0aDsrK3Upe3JbdV0ucmVtb3ZlKHRoaXMpfWlmKG4obykpe3MmJih0aGlzLl91bnN1YnNjcmliZT12b2lkIDApO3RyeXtvLmNhbGwodGhpcyl9Y2F0Y2godCl7ZT10IGluc3RhbmNlb2YgbD9kKHQuZXJyb3JzKTpbdF19fWlmKGMoYSkpe3U9LTE7Zm9yKHZhciBwPWEubGVuZ3RoOysrdTxwOyl7dmFyIGY9YVt1XTtpZihoKGYpKXRyeXtmLnVuc3Vic2NyaWJlKCl9Y2F0Y2godCl7ZT1lfHxbXSx0IGluc3RhbmNlb2YgbD9lPWUuY29uY2F0KGQodC5lcnJvcnMpKTplLnB1c2godCl9fX1pZihlKXRocm93IG5ldyBsKGUpfX0sdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGUpe3ZhciBpPWU7aWYoIWUpcmV0dXJuIHQuRU1QVFk7c3dpdGNoKHR5cGVvZiBlKXtjYXNlXCJmdW5jdGlvblwiOmk9bmV3IHQoZSk7Y2FzZVwib2JqZWN0XCI6aWYoaT09PXRoaXN8fGkuY2xvc2VkfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBpLnVuc3Vic2NyaWJlKXJldHVybiBpO2lmKHRoaXMuY2xvc2VkKXJldHVybiBpLnVuc3Vic2NyaWJlKCksaTtpZighKGkgaW5zdGFuY2VvZiB0KSl7dmFyIG49aTsoaT1uZXcgdCkuX3N1YnNjcmlwdGlvbnM9W25dfWJyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwidW5yZWNvZ25pemVkIHRlYXJkb3duIFwiK2UrXCIgYWRkZWQgdG8gU3Vic2NyaXB0aW9uLlwiKX12YXIgcj1pLl9wYXJlbnRPclBhcmVudHM7aWYobnVsbD09PXIpaS5fcGFyZW50T3JQYXJlbnRzPXRoaXM7ZWxzZSBpZihyIGluc3RhbmNlb2YgdCl7aWYocj09PXRoaXMpcmV0dXJuIGk7aS5fcGFyZW50T3JQYXJlbnRzPVtyLHRoaXNdfWVsc2V7aWYoLTEhPT1yLmluZGV4T2YodGhpcykpcmV0dXJuIGk7ci5wdXNoKHRoaXMpfXZhciBzPXRoaXMuX3N1YnNjcmlwdGlvbnM7cmV0dXJuIG51bGw9PT1zP3RoaXMuX3N1YnNjcmlwdGlvbnM9W2ldOnMucHVzaChpKSxpfSx0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc3Vic2NyaXB0aW9ucztpZihlKXt2YXIgaT1lLmluZGV4T2YodCk7LTEhPT1pJiZlLnNwbGljZShpLDEpfX0sdC5FTVBUWT1mdW5jdGlvbih0KXtyZXR1cm4gdC5jbG9zZWQ9ITAsdH0obmV3IHQpLHR9KCk7ZnVuY3Rpb24gZCh0KXtyZXR1cm4gdC5yZWR1Y2UoKGZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQuY29uY2F0KGUgaW5zdGFuY2VvZiBsP2UuZXJyb3JzOmUpfSksW10pfXZhciBwPWZ1bmN0aW9uKCl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sP1N5bWJvbChcInJ4U3Vic2NyaWJlclwiKTpcIkBAcnhTdWJzY3JpYmVyX1wiK01hdGgucmFuZG9tKCl9KCksZj1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGksbixyKXt2YXIgcz10LmNhbGwodGhpcyl8fHRoaXM7c3dpdGNoKHMuc3luY0Vycm9yVmFsdWU9bnVsbCxzLnN5bmNFcnJvclRocm93bj0hMSxzLnN5bmNFcnJvclRocm93YWJsZT0hMSxzLmlzU3RvcHBlZD0hMSxhcmd1bWVudHMubGVuZ3RoKXtjYXNlIDA6cy5kZXN0aW5hdGlvbj1hO2JyZWFrO2Nhc2UgMTppZighaSl7cy5kZXN0aW5hdGlvbj1hO2JyZWFrfWlmKFwib2JqZWN0XCI9PXR5cGVvZiBpKXtpIGluc3RhbmNlb2YgZT8ocy5zeW5jRXJyb3JUaHJvd2FibGU9aS5zeW5jRXJyb3JUaHJvd2FibGUscy5kZXN0aW5hdGlvbj1pLGkuYWRkKHMpKToocy5zeW5jRXJyb3JUaHJvd2FibGU9ITAscy5kZXN0aW5hdGlvbj1uZXcgbShzLGkpKTticmVha31kZWZhdWx0OnMuc3luY0Vycm9yVGhyb3dhYmxlPSEwLHMuZGVzdGluYXRpb249bmV3IG0ocyxpLG4scil9cmV0dXJuIHN9cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZVtwXT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxlLmNyZWF0ZT1mdW5jdGlvbih0LGksbil7dmFyIHI9bmV3IGUodCxpLG4pO3JldHVybiByLnN5bmNFcnJvclRocm93YWJsZT0hMSxyfSxlLnByb3RvdHlwZS5uZXh0PWZ1bmN0aW9uKHQpe3RoaXMuaXNTdG9wcGVkfHx0aGlzLl9uZXh0KHQpfSxlLnByb3RvdHlwZS5lcnJvcj1mdW5jdGlvbih0KXt0aGlzLmlzU3RvcHBlZHx8KHRoaXMuaXNTdG9wcGVkPSEwLHRoaXMuX2Vycm9yKHQpKX0sZS5wcm90b3R5cGUuY29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLmlzU3RvcHBlZHx8KHRoaXMuaXNTdG9wcGVkPSEwLHRoaXMuX2NvbXBsZXRlKCkpfSxlLnByb3RvdHlwZS51bnN1YnNjcmliZT1mdW5jdGlvbigpe3RoaXMuY2xvc2VkfHwodGhpcy5pc1N0b3BwZWQ9ITAsdC5wcm90b3R5cGUudW5zdWJzY3JpYmUuY2FsbCh0aGlzKSl9LGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3RoaXMuZGVzdGluYXRpb24ubmV4dCh0KX0sZS5wcm90b3R5cGUuX2Vycm9yPWZ1bmN0aW9uKHQpe3RoaXMuZGVzdGluYXRpb24uZXJyb3IodCksdGhpcy51bnN1YnNjcmliZSgpfSxlLnByb3RvdHlwZS5fY29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCksdGhpcy51bnN1YnNjcmliZSgpfSxlLnByb3RvdHlwZS5fdW5zdWJzY3JpYmVBbmRSZWN5Y2xlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fcGFyZW50T3JQYXJlbnRzO3JldHVybiB0aGlzLl9wYXJlbnRPclBhcmVudHM9bnVsbCx0aGlzLnVuc3Vic2NyaWJlKCksdGhpcy5jbG9zZWQ9ITEsdGhpcy5pc1N0b3BwZWQ9ITEsdGhpcy5fcGFyZW50T3JQYXJlbnRzPXQsdGhpc30sZX0odSksbT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSxyLHMpe3ZhciBvLGM9dC5jYWxsKHRoaXMpfHx0aGlzO2MuX3BhcmVudFN1YnNjcmliZXI9ZTt2YXIgaD1jO3JldHVybiBuKGkpP289aTppJiYobz1pLm5leHQscj1pLmVycm9yLHM9aS5jb21wbGV0ZSxpIT09YSYmKG4oKGg9T2JqZWN0LmNyZWF0ZShpKSkudW5zdWJzY3JpYmUpJiZjLmFkZChoLnVuc3Vic2NyaWJlLmJpbmQoaCkpLGgudW5zdWJzY3JpYmU9Yy51bnN1YnNjcmliZS5iaW5kKGMpKSksYy5fY29udGV4dD1oLGMuX25leHQ9byxjLl9lcnJvcj1yLGMuX2NvbXBsZXRlPXMsY31yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24odCl7aWYoIXRoaXMuaXNTdG9wcGVkJiZ0aGlzLl9uZXh0KXt2YXIgZT10aGlzLl9wYXJlbnRTdWJzY3JpYmVyO3MudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyYmZS5zeW5jRXJyb3JUaHJvd2FibGU/dGhpcy5fX3RyeU9yU2V0RXJyb3IoZSx0aGlzLl9uZXh0LHQpJiZ0aGlzLnVuc3Vic2NyaWJlKCk6dGhpcy5fX3RyeU9yVW5zdWIodGhpcy5fbmV4dCx0KX19LGUucHJvdG90eXBlLmVycm9yPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmlzU3RvcHBlZCl7dmFyIGU9dGhpcy5fcGFyZW50U3Vic2NyaWJlcixpPXMudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZztpZih0aGlzLl9lcnJvcilpJiZlLnN5bmNFcnJvclRocm93YWJsZT8odGhpcy5fX3RyeU9yU2V0RXJyb3IoZSx0aGlzLl9lcnJvcix0KSx0aGlzLnVuc3Vic2NyaWJlKCkpOih0aGlzLl9fdHJ5T3JVbnN1Yih0aGlzLl9lcnJvcix0KSx0aGlzLnVuc3Vic2NyaWJlKCkpO2Vsc2UgaWYoZS5zeW5jRXJyb3JUaHJvd2FibGUpaT8oZS5zeW5jRXJyb3JWYWx1ZT10LGUuc3luY0Vycm9yVGhyb3duPSEwKTpvKHQpLHRoaXMudW5zdWJzY3JpYmUoKTtlbHNle2lmKHRoaXMudW5zdWJzY3JpYmUoKSxpKXRocm93IHQ7byh0KX19fSxlLnByb3RvdHlwZS5jb21wbGV0ZT1mdW5jdGlvbigpe3ZhciB0PXRoaXM7aWYoIXRoaXMuaXNTdG9wcGVkKXt2YXIgZT10aGlzLl9wYXJlbnRTdWJzY3JpYmVyO2lmKHRoaXMuX2NvbXBsZXRlKXt2YXIgaT1mdW5jdGlvbigpe3JldHVybiB0Ll9jb21wbGV0ZS5jYWxsKHQuX2NvbnRleHQpfTtzLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcmJmUuc3luY0Vycm9yVGhyb3dhYmxlPyh0aGlzLl9fdHJ5T3JTZXRFcnJvcihlLGkpLHRoaXMudW5zdWJzY3JpYmUoKSk6KHRoaXMuX190cnlPclVuc3ViKGkpLHRoaXMudW5zdWJzY3JpYmUoKSl9ZWxzZSB0aGlzLnVuc3Vic2NyaWJlKCl9fSxlLnByb3RvdHlwZS5fX3RyeU9yVW5zdWI9ZnVuY3Rpb24odCxlKXt0cnl7dC5jYWxsKHRoaXMuX2NvbnRleHQsZSl9Y2F0Y2godCl7aWYodGhpcy51bnN1YnNjcmliZSgpLHMudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyl0aHJvdyB0O28odCl9fSxlLnByb3RvdHlwZS5fX3RyeU9yU2V0RXJyb3I9ZnVuY3Rpb24odCxlLGkpe2lmKCFzLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcpdGhyb3cgbmV3IEVycm9yKFwiYmFkIGNhbGxcIik7dHJ5e2UuY2FsbCh0aGlzLl9jb250ZXh0LGkpfWNhdGNoKGUpe3JldHVybiBzLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmc/KHQuc3luY0Vycm9yVmFsdWU9ZSx0LnN5bmNFcnJvclRocm93bj0hMCwhMCk6KG8oZSksITApfXJldHVybiExfSxlLnByb3RvdHlwZS5fdW5zdWJzY3JpYmU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9wYXJlbnRTdWJzY3JpYmVyO3RoaXMuX2NvbnRleHQ9bnVsbCx0aGlzLl9wYXJlbnRTdWJzY3JpYmVyPW51bGwsdC51bnN1YnNjcmliZSgpfSxlfShmKTt2YXIgZz1mdW5jdGlvbigpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmU3ltYm9sLm9ic2VydmFibGV8fFwiQEBvYnNlcnZhYmxlXCJ9KCk7ZnVuY3Rpb24gXyh0KXtyZXR1cm4gdH1mdW5jdGlvbiB2KCl7Zm9yKHZhciB0PVtdLGU9MDtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXRbZV09YXJndW1lbnRzW2VdO3JldHVybiB5KHQpfWZ1bmN0aW9uIHkodCl7cmV0dXJuIDA9PT10Lmxlbmd0aD9fOjE9PT10Lmxlbmd0aD90WzBdOmZ1bmN0aW9uKGUpe3JldHVybiB0LnJlZHVjZSgoZnVuY3Rpb24odCxlKXtyZXR1cm4gZSh0KX0pLGUpfX12YXIgYj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5faXNTY2FsYXI9ITEsdCYmKHRoaXMuX3N1YnNjcmliZT10KX1yZXR1cm4gdC5wcm90b3R5cGUubGlmdD1mdW5jdGlvbihlKXt2YXIgaT1uZXcgdDtyZXR1cm4gaS5zb3VyY2U9dGhpcyxpLm9wZXJhdG9yPWUsaX0sdC5wcm90b3R5cGUuc3Vic2NyaWJlPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj10aGlzLm9wZXJhdG9yLHI9ZnVuY3Rpb24odCxlLGkpe2lmKHQpe2lmKHQgaW5zdGFuY2VvZiBmKXJldHVybiB0O2lmKHRbcF0pcmV0dXJuIHRbcF0oKX1yZXR1cm4gdHx8ZXx8aT9uZXcgZih0LGUsaSk6bmV3IGYoYSl9KHQsZSxpKTtpZihuP3IuYWRkKG4uY2FsbChyLHRoaXMuc291cmNlKSk6ci5hZGQodGhpcy5zb3VyY2V8fHMudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyYmIXIuc3luY0Vycm9yVGhyb3dhYmxlP3RoaXMuX3N1YnNjcmliZShyKTp0aGlzLl90cnlTdWJzY3JpYmUocikpLHMudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyYmci5zeW5jRXJyb3JUaHJvd2FibGUmJihyLnN5bmNFcnJvclRocm93YWJsZT0hMSxyLnN5bmNFcnJvclRocm93bikpdGhyb3cgci5zeW5jRXJyb3JWYWx1ZTtyZXR1cm4gcn0sdC5wcm90b3R5cGUuX3RyeVN1YnNjcmliZT1mdW5jdGlvbih0KXt0cnl7cmV0dXJuIHRoaXMuX3N1YnNjcmliZSh0KX1jYXRjaChlKXtzLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcmJih0LnN5bmNFcnJvclRocm93bj0hMCx0LnN5bmNFcnJvclZhbHVlPWUpLCFmdW5jdGlvbih0KXtmb3IoO3Q7KXt2YXIgZT10LGk9ZS5jbG9zZWQsbj1lLmRlc3RpbmF0aW9uLHI9ZS5pc1N0b3BwZWQ7aWYoaXx8cilyZXR1cm4hMTt0PW4mJm4gaW5zdGFuY2VvZiBmP246bnVsbH1yZXR1cm4hMH0odCk/Y29uc29sZS53YXJuKGUpOnQuZXJyb3IoZSl9fSx0LnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcztyZXR1cm4gbmV3KGU9eChlKSkoKGZ1bmN0aW9uKGUsbil7dmFyIHI7cj1pLnN1YnNjcmliZSgoZnVuY3Rpb24oZSl7dHJ5e3QoZSl9Y2F0Y2godCl7bih0KSxyJiZyLnVuc3Vic2NyaWJlKCl9fSksbixlKX0pKX0sdC5wcm90b3R5cGUuX3N1YnNjcmliZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLnNvdXJjZTtyZXR1cm4gZSYmZS5zdWJzY3JpYmUodCl9LHQucHJvdG90eXBlW2ddPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLnBpcGU9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sZT0wO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspdFtlXT1hcmd1bWVudHNbZV07cmV0dXJuIDA9PT10Lmxlbmd0aD90aGlzOnkodCkodGhpcyl9LHQucHJvdG90eXBlLnRvUHJvbWlzZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzO3JldHVybiBuZXcodD14KHQpKSgoZnVuY3Rpb24odCxpKXt2YXIgbjtlLnN1YnNjcmliZSgoZnVuY3Rpb24odCl7cmV0dXJuIG49dH0pLChmdW5jdGlvbih0KXtyZXR1cm4gaSh0KX0pLChmdW5jdGlvbigpe3JldHVybiB0KG4pfSkpfSkpfSx0LmNyZWF0ZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IHQoZSl9LHR9KCk7ZnVuY3Rpb24geCh0KXtpZih0fHwodD1Qcm9taXNlKSwhdCl0aHJvdyBuZXcgRXJyb3IoXCJubyBQcm9taXNlIGltcGwgZm91bmRcIik7cmV0dXJuIHR9dmFyIHc9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7cmV0dXJuIEVycm9yLmNhbGwodGhpcyksdGhpcy5tZXNzYWdlPVwib2JqZWN0IHVuc3Vic2NyaWJlZFwiLHRoaXMubmFtZT1cIk9iamVjdFVuc3Vic2NyaWJlZEVycm9yXCIsdGhpc31yZXR1cm4gdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpLHR9KCksUz1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBuLnN1YmplY3Q9ZSxuLnN1YnNjcmliZXI9aSxuLmNsb3NlZD0hMSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUudW5zdWJzY3JpYmU9ZnVuY3Rpb24oKXtpZighdGhpcy5jbG9zZWQpe3RoaXMuY2xvc2VkPSEwO3ZhciB0PXRoaXMuc3ViamVjdCxlPXQub2JzZXJ2ZXJzO2lmKHRoaXMuc3ViamVjdD1udWxsLGUmJjAhPT1lLmxlbmd0aCYmIXQuaXNTdG9wcGVkJiYhdC5jbG9zZWQpe3ZhciBpPWUuaW5kZXhPZih0aGlzLnN1YnNjcmliZXIpOy0xIT09aSYmZS5zcGxpY2UoaSwxKX19fSxlfSh1KSxNPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSl7dmFyIGk9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIGkuZGVzdGluYXRpb249ZSxpfXJldHVybiBpKGUsdCksZX0oZiksVD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKCl7dmFyIGU9dC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBlLm9ic2VydmVycz1bXSxlLmNsb3NlZD0hMSxlLmlzU3RvcHBlZD0hMSxlLmhhc0Vycm9yPSExLGUudGhyb3duRXJyb3I9bnVsbCxlfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGVbcF09ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IE0odGhpcyl9LGUucHJvdG90eXBlLmxpZnQ9ZnVuY3Rpb24odCl7dmFyIGU9bmV3IEModGhpcyx0aGlzKTtyZXR1cm4gZS5vcGVyYXRvcj10LGV9LGUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24odCl7aWYodGhpcy5jbG9zZWQpdGhyb3cgbmV3IHc7aWYoIXRoaXMuaXNTdG9wcGVkKWZvcih2YXIgZT10aGlzLm9ic2VydmVycyxpPWUubGVuZ3RoLG49ZS5zbGljZSgpLHI9MDtyPGk7cisrKW5bcl0ubmV4dCh0KX0sZS5wcm90b3R5cGUuZXJyb3I9ZnVuY3Rpb24odCl7aWYodGhpcy5jbG9zZWQpdGhyb3cgbmV3IHc7dGhpcy5oYXNFcnJvcj0hMCx0aGlzLnRocm93bkVycm9yPXQsdGhpcy5pc1N0b3BwZWQ9ITA7Zm9yKHZhciBlPXRoaXMub2JzZXJ2ZXJzLGk9ZS5sZW5ndGgsbj1lLnNsaWNlKCkscj0wO3I8aTtyKyspbltyXS5lcnJvcih0KTt0aGlzLm9ic2VydmVycy5sZW5ndGg9MH0sZS5wcm90b3R5cGUuY29tcGxldGU9ZnVuY3Rpb24oKXtpZih0aGlzLmNsb3NlZCl0aHJvdyBuZXcgdzt0aGlzLmlzU3RvcHBlZD0hMDtmb3IodmFyIHQ9dGhpcy5vYnNlcnZlcnMsZT10Lmxlbmd0aCxpPXQuc2xpY2UoKSxuPTA7bjxlO24rKylpW25dLmNvbXBsZXRlKCk7dGhpcy5vYnNlcnZlcnMubGVuZ3RoPTB9LGUucHJvdG90eXBlLnVuc3Vic2NyaWJlPWZ1bmN0aW9uKCl7dGhpcy5pc1N0b3BwZWQ9ITAsdGhpcy5jbG9zZWQ9ITAsdGhpcy5vYnNlcnZlcnM9bnVsbH0sZS5wcm90b3R5cGUuX3RyeVN1YnNjcmliZT1mdW5jdGlvbihlKXtpZih0aGlzLmNsb3NlZCl0aHJvdyBuZXcgdztyZXR1cm4gdC5wcm90b3R5cGUuX3RyeVN1YnNjcmliZS5jYWxsKHRoaXMsZSl9LGUucHJvdG90eXBlLl9zdWJzY3JpYmU9ZnVuY3Rpb24odCl7aWYodGhpcy5jbG9zZWQpdGhyb3cgbmV3IHc7cmV0dXJuIHRoaXMuaGFzRXJyb3I/KHQuZXJyb3IodGhpcy50aHJvd25FcnJvciksdS5FTVBUWSk6dGhpcy5pc1N0b3BwZWQ/KHQuY29tcGxldGUoKSx1LkVNUFRZKToodGhpcy5vYnNlcnZlcnMucHVzaCh0KSxuZXcgUyh0aGlzLHQpKX0sZS5wcm90b3R5cGUuYXNPYnNlcnZhYmxlPWZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGI7cmV0dXJuIHQuc291cmNlPXRoaXMsdH0sZS5jcmVhdGU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IEModCxlKX0sZX0oYiksQz1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBuLmRlc3RpbmF0aW9uPWUsbi5zb3VyY2U9aSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmRlc3RpbmF0aW9uO2UmJmUubmV4dCYmZS5uZXh0KHQpfSxlLnByb3RvdHlwZS5lcnJvcj1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmRlc3RpbmF0aW9uO2UmJmUuZXJyb3ImJnRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9LGUucHJvdG90eXBlLmNvbXBsZXRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5kZXN0aW5hdGlvbjt0JiZ0LmNvbXBsZXRlJiZ0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCl9LGUucHJvdG90eXBlLl9zdWJzY3JpYmU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuc291cmNlP3RoaXMuc291cmNlLnN1YnNjcmliZSh0KTp1LkVNUFRZfSxlfShUKTtmdW5jdGlvbiBFKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiB0LmxpZnQobmV3IEkodCkpfX12YXIgST1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5jb25uZWN0YWJsZT10fXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5jb25uZWN0YWJsZTtpLl9yZWZDb3VudCsrO3ZhciBuPW5ldyBBKHQsaSkscj1lLnN1YnNjcmliZShuKTtyZXR1cm4gbi5jbG9zZWR8fChuLmNvbm5lY3Rpb249aS5jb25uZWN0KCkpLHJ9LHR9KCksQT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4uY29ubmVjdGFibGU9aSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jb25uZWN0YWJsZTtpZih0KXt0aGlzLmNvbm5lY3RhYmxlPW51bGw7dmFyIGU9dC5fcmVmQ291bnQ7aWYoZTw9MCl0aGlzLmNvbm5lY3Rpb249bnVsbDtlbHNlIGlmKHQuX3JlZkNvdW50PWUtMSxlPjEpdGhpcy5jb25uZWN0aW9uPW51bGw7ZWxzZXt2YXIgaT10aGlzLmNvbm5lY3Rpb24sbj10Ll9jb25uZWN0aW9uO3RoaXMuY29ubmVjdGlvbj1udWxsLCFufHxpJiZuIT09aXx8bi51bnN1YnNjcmliZSgpfX1lbHNlIHRoaXMuY29ubmVjdGlvbj1udWxsfSxlfShmKSxQPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpKXt2YXIgbj10LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIG4uc291cmNlPWUsbi5zdWJqZWN0RmFjdG9yeT1pLG4uX3JlZkNvdW50PTAsbi5faXNDb21wbGV0ZT0hMSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX3N1YnNjcmliZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRTdWJqZWN0KCkuc3Vic2NyaWJlKHQpfSxlLnByb3RvdHlwZS5nZXRTdWJqZWN0PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fc3ViamVjdDtyZXR1cm4gdCYmIXQuaXNTdG9wcGVkfHwodGhpcy5fc3ViamVjdD10aGlzLnN1YmplY3RGYWN0b3J5KCkpLHRoaXMuX3N1YmplY3R9LGUucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9jb25uZWN0aW9uO3JldHVybiB0fHwodGhpcy5faXNDb21wbGV0ZT0hMSwodD10aGlzLl9jb25uZWN0aW9uPW5ldyB1KS5hZGQodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBMKHRoaXMuZ2V0U3ViamVjdCgpLHRoaXMpKSksdC5jbG9zZWQmJih0aGlzLl9jb25uZWN0aW9uPW51bGwsdD11LkVNUFRZKSksdH0sZS5wcm90b3R5cGUucmVmQ291bnQ9ZnVuY3Rpb24oKXtyZXR1cm4gRSgpKHRoaXMpfSxlfShiKSxSPWZ1bmN0aW9uKCl7dmFyIHQ9UC5wcm90b3R5cGU7cmV0dXJue29wZXJhdG9yOnt2YWx1ZTpudWxsfSxfcmVmQ291bnQ6e3ZhbHVlOjAsd3JpdGFibGU6ITB9LF9zdWJqZWN0Ont2YWx1ZTpudWxsLHdyaXRhYmxlOiEwfSxfY29ubmVjdGlvbjp7dmFsdWU6bnVsbCx3cml0YWJsZTohMH0sX3N1YnNjcmliZTp7dmFsdWU6dC5fc3Vic2NyaWJlfSxfaXNDb21wbGV0ZTp7dmFsdWU6dC5faXNDb21wbGV0ZSx3cml0YWJsZTohMH0sZ2V0U3ViamVjdDp7dmFsdWU6dC5nZXRTdWJqZWN0fSxjb25uZWN0Ont2YWx1ZTp0LmNvbm5lY3R9LHJlZkNvdW50Ont2YWx1ZTp0LnJlZkNvdW50fX19KCksTD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4uY29ubmVjdGFibGU9aSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX2Vycm9yPWZ1bmN0aW9uKGUpe3RoaXMuX3Vuc3Vic2NyaWJlKCksdC5wcm90b3R5cGUuX2Vycm9yLmNhbGwodGhpcyxlKX0sZS5wcm90b3R5cGUuX2NvbXBsZXRlPWZ1bmN0aW9uKCl7dGhpcy5jb25uZWN0YWJsZS5faXNDb21wbGV0ZT0hMCx0aGlzLl91bnN1YnNjcmliZSgpLHQucHJvdG90eXBlLl9jb21wbGV0ZS5jYWxsKHRoaXMpfSxlLnByb3RvdHlwZS5fdW5zdWJzY3JpYmU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbm5lY3RhYmxlO2lmKHQpe3RoaXMuY29ubmVjdGFibGU9bnVsbDt2YXIgZT10Ll9jb25uZWN0aW9uO3QuX3JlZkNvdW50PTAsdC5fc3ViamVjdD1udWxsLHQuX2Nvbm5lY3Rpb249bnVsbCxlJiZlLnVuc3Vic2NyaWJlKCl9fSxlfShNKSxPPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSl7dmFyIGk9dC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBpLl92YWx1ZT1lLGl9cmV0dXJuIGkoZSx0KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZS5wcm90b3R5cGUsXCJ2YWx1ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRWYWx1ZSgpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUucHJvdG90eXBlLl9zdWJzY3JpYmU9ZnVuY3Rpb24oZSl7dmFyIGk9dC5wcm90b3R5cGUuX3N1YnNjcmliZS5jYWxsKHRoaXMsZSk7cmV0dXJuIGkmJiFpLmNsb3NlZCYmZS5uZXh0KHRoaXMuX3ZhbHVlKSxpfSxlLnByb3RvdHlwZS5nZXRWYWx1ZT1mdW5jdGlvbigpe2lmKHRoaXMuaGFzRXJyb3IpdGhyb3cgdGhpcy50aHJvd25FcnJvcjtpZih0aGlzLmNsb3NlZCl0aHJvdyBuZXcgdztyZXR1cm4gdGhpcy5fdmFsdWV9LGUucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oZSl7dC5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMsdGhpcy5fdmFsdWU9ZSl9LGV9KFQpLE49ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3ZhciBuPXQuY2FsbCh0aGlzLGUsaSl8fHRoaXM7cmV0dXJuIG4uc2NoZWR1bGVyPWUsbi53b3JrPWksbi5wZW5kaW5nPSExLG59cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5zY2hlZHVsZT1mdW5jdGlvbih0LGUpe2lmKHZvaWQgMD09PWUmJihlPTApLHRoaXMuY2xvc2VkKXJldHVybiB0aGlzO3RoaXMuc3RhdGU9dDt2YXIgaT10aGlzLmlkLG49dGhpcy5zY2hlZHVsZXI7cmV0dXJuIG51bGwhPWkmJih0aGlzLmlkPXRoaXMucmVjeWNsZUFzeW5jSWQobixpLGUpKSx0aGlzLnBlbmRpbmc9ITAsdGhpcy5kZWxheT1lLHRoaXMuaWQ9dGhpcy5pZHx8dGhpcy5yZXF1ZXN0QXN5bmNJZChuLHRoaXMuaWQsZSksdGhpc30sZS5wcm90b3R5cGUucmVxdWVzdEFzeW5jSWQ9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB2b2lkIDA9PT1pJiYoaT0wKSxzZXRJbnRlcnZhbCh0LmZsdXNoLmJpbmQodCx0aGlzKSxpKX0sZS5wcm90b3R5cGUucmVjeWNsZUFzeW5jSWQ9ZnVuY3Rpb24odCxlLGkpe2lmKHZvaWQgMD09PWkmJihpPTApLG51bGwhPT1pJiZ0aGlzLmRlbGF5PT09aSYmITE9PT10aGlzLnBlbmRpbmcpcmV0dXJuIGU7Y2xlYXJJbnRlcnZhbChlKX0sZS5wcm90b3R5cGUuZXhlY3V0ZT1mdW5jdGlvbih0LGUpe2lmKHRoaXMuY2xvc2VkKXJldHVybiBuZXcgRXJyb3IoXCJleGVjdXRpbmcgYSBjYW5jZWxsZWQgYWN0aW9uXCIpO3RoaXMucGVuZGluZz0hMTt2YXIgaT10aGlzLl9leGVjdXRlKHQsZSk7aWYoaSlyZXR1cm4gaTshMT09PXRoaXMucGVuZGluZyYmbnVsbCE9dGhpcy5pZCYmKHRoaXMuaWQ9dGhpcy5yZWN5Y2xlQXN5bmNJZCh0aGlzLnNjaGVkdWxlcix0aGlzLmlkLG51bGwpKX0sZS5wcm90b3R5cGUuX2V4ZWN1dGU9ZnVuY3Rpb24odCxlKXt2YXIgaT0hMSxuPXZvaWQgMDt0cnl7dGhpcy53b3JrKHQpfWNhdGNoKHQpe2k9ITAsbj0hIXQmJnR8fG5ldyBFcnJvcih0KX1pZihpKXJldHVybiB0aGlzLnVuc3Vic2NyaWJlKCksbn0sZS5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5pZCxlPXRoaXMuc2NoZWR1bGVyLGk9ZS5hY3Rpb25zLG49aS5pbmRleE9mKHRoaXMpO3RoaXMud29yaz1udWxsLHRoaXMuc3RhdGU9bnVsbCx0aGlzLnBlbmRpbmc9ITEsdGhpcy5zY2hlZHVsZXI9bnVsbCwtMSE9PW4mJmkuc3BsaWNlKG4sMSksbnVsbCE9dCYmKHRoaXMuaWQ9dGhpcy5yZWN5Y2xlQXN5bmNJZChlLHQsbnVsbCkpLHRoaXMuZGVsYXk9bnVsbH0sZX0oZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3JldHVybiB0LmNhbGwodGhpcyl8fHRoaXN9cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5zY2hlZHVsZT1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzfSxlfSh1KSksRD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSxpKXx8dGhpcztyZXR1cm4gbi5zY2hlZHVsZXI9ZSxuLndvcms9aSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuc2NoZWR1bGU9ZnVuY3Rpb24oZSxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9MCksaT4wP3QucHJvdG90eXBlLnNjaGVkdWxlLmNhbGwodGhpcyxlLGkpOih0aGlzLmRlbGF5PWksdGhpcy5zdGF0ZT1lLHRoaXMuc2NoZWR1bGVyLmZsdXNoKHRoaXMpLHRoaXMpfSxlLnByb3RvdHlwZS5leGVjdXRlPWZ1bmN0aW9uKGUsaSl7cmV0dXJuIGk+MHx8dGhpcy5jbG9zZWQ/dC5wcm90b3R5cGUuZXhlY3V0ZS5jYWxsKHRoaXMsZSxpKTp0aGlzLl9leGVjdXRlKGUsaSl9LGUucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkPWZ1bmN0aW9uKGUsaSxuKXtyZXR1cm4gdm9pZCAwPT09biYmKG49MCksbnVsbCE9PW4mJm4+MHx8bnVsbD09PW4mJnRoaXMuZGVsYXk+MD90LnByb3RvdHlwZS5yZXF1ZXN0QXN5bmNJZC5jYWxsKHRoaXMsZSxpLG4pOmUuZmx1c2godGhpcyl9LGV9KE4pLCQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KGUsaSl7dm9pZCAwPT09aSYmKGk9dC5ub3cpLHRoaXMuU2NoZWR1bGVyQWN0aW9uPWUsdGhpcy5ub3c9aX1yZXR1cm4gdC5wcm90b3R5cGUuc2NoZWR1bGU9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0wKSxuZXcgdGhpcy5TY2hlZHVsZXJBY3Rpb24odGhpcyx0KS5zY2hlZHVsZShpLGUpfSx0Lm5vdz1mdW5jdGlvbigpe3JldHVybiBEYXRlLm5vdygpfSx0fSgpLGs9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShpLG4pe3ZvaWQgMD09PW4mJihuPSQubm93KTt2YXIgcj10LmNhbGwodGhpcyxpLChmdW5jdGlvbigpe3JldHVybiBlLmRlbGVnYXRlJiZlLmRlbGVnYXRlIT09cj9lLmRlbGVnYXRlLm5vdygpOm4oKX0pKXx8dGhpcztyZXR1cm4gci5hY3Rpb25zPVtdLHIuYWN0aXZlPSExLHIuc2NoZWR1bGVkPXZvaWQgMCxyfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuc2NoZWR1bGU9ZnVuY3Rpb24oaSxuLHIpe3JldHVybiB2b2lkIDA9PT1uJiYobj0wKSxlLmRlbGVnYXRlJiZlLmRlbGVnYXRlIT09dGhpcz9lLmRlbGVnYXRlLnNjaGVkdWxlKGksbixyKTp0LnByb3RvdHlwZS5zY2hlZHVsZS5jYWxsKHRoaXMsaSxuLHIpfSxlLnByb3RvdHlwZS5mbHVzaD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmFjdGlvbnM7aWYodGhpcy5hY3RpdmUpZS5wdXNoKHQpO2Vsc2V7dmFyIGk7dGhpcy5hY3RpdmU9ITA7ZG97aWYoaT10LmV4ZWN1dGUodC5zdGF0ZSx0LmRlbGF5KSlicmVha313aGlsZSh0PWUuc2hpZnQoKSk7aWYodGhpcy5hY3RpdmU9ITEsaSl7Zm9yKDt0PWUuc2hpZnQoKTspdC51bnN1YnNjcmliZSgpO3Rocm93IGl9fX0sZX0oJCksej1uZXcoZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSgpe3JldHVybiBudWxsIT09dCYmdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cmV0dXJuIGkoZSx0KSxlfShrKSkoRCksRj1uZXcgYigoZnVuY3Rpb24odCl7cmV0dXJuIHQuY29tcGxldGUoKX0pKTtmdW5jdGlvbiBCKHQpe3JldHVybiB0P2Z1bmN0aW9uKHQpe3JldHVybiBuZXcgYigoZnVuY3Rpb24oZSl7cmV0dXJuIHQuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7cmV0dXJuIGUuY29tcGxldGUoKX0pKX0pKX0odCk6Rn1mdW5jdGlvbiBqKHQpe3JldHVybiB0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0LnNjaGVkdWxlfXZhciBIPWZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihlKXtmb3IodmFyIGk9MCxuPXQubGVuZ3RoO2k8biYmIWUuY2xvc2VkO2krKyllLm5leHQodFtpXSk7ZS5jb21wbGV0ZSgpfX07ZnVuY3Rpb24gVSh0LGUpe3JldHVybiBuZXcgYigoZnVuY3Rpb24oaSl7dmFyIG49bmV3IHUscj0wO3JldHVybiBuLmFkZChlLnNjaGVkdWxlKChmdW5jdGlvbigpe3IhPT10Lmxlbmd0aD8oaS5uZXh0KHRbcisrXSksaS5jbG9zZWR8fG4uYWRkKHRoaXMuc2NoZWR1bGUoKSkpOmkuY29tcGxldGUoKX0pKSksbn0pKX1mdW5jdGlvbiBWKHQsZSl7cmV0dXJuIGU/VSh0LGUpOm5ldyBiKEgodCkpfWZ1bmN0aW9uIEcoKXtmb3IodmFyIHQ9W10sZT0wO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspdFtlXT1hcmd1bWVudHNbZV07dmFyIGk9dFt0Lmxlbmd0aC0xXTtyZXR1cm4gaihpKT8odC5wb3AoKSxVKHQsaSkpOlYodCl9ZnVuY3Rpb24gcSh0LGUpe3JldHVybiBuZXcgYihlP2Z1bmN0aW9uKGkpe3JldHVybiBlLnNjaGVkdWxlKFcsMCx7ZXJyb3I6dCxzdWJzY3JpYmVyOml9KX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZXJyb3IodCl9KX1mdW5jdGlvbiBXKHQpe3ZhciBlPXQuZXJyb3I7dC5zdWJzY3JpYmVyLmVycm9yKGUpfXZhciBYPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSl7dGhpcy5raW5kPXQsdGhpcy52YWx1ZT1lLHRoaXMuZXJyb3I9aSx0aGlzLmhhc1ZhbHVlPVwiTlwiPT09dH1yZXR1cm4gdC5wcm90b3R5cGUub2JzZXJ2ZT1mdW5jdGlvbih0KXtzd2l0Y2godGhpcy5raW5kKXtjYXNlXCJOXCI6cmV0dXJuIHQubmV4dCYmdC5uZXh0KHRoaXMudmFsdWUpO2Nhc2VcIkVcIjpyZXR1cm4gdC5lcnJvciYmdC5lcnJvcih0aGlzLmVycm9yKTtjYXNlXCJDXCI6cmV0dXJuIHQuY29tcGxldGUmJnQuY29tcGxldGUoKX19LHQucHJvdG90eXBlLmRvPWZ1bmN0aW9uKHQsZSxpKXtzd2l0Y2godGhpcy5raW5kKXtjYXNlXCJOXCI6cmV0dXJuIHQmJnQodGhpcy52YWx1ZSk7Y2FzZVwiRVwiOnJldHVybiBlJiZlKHRoaXMuZXJyb3IpO2Nhc2VcIkNcIjpyZXR1cm4gaSYmaSgpfX0sdC5wcm90b3R5cGUuYWNjZXB0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5uZXh0P3RoaXMub2JzZXJ2ZSh0KTp0aGlzLmRvKHQsZSxpKX0sdC5wcm90b3R5cGUudG9PYnNlcnZhYmxlPWZ1bmN0aW9uKCl7c3dpdGNoKHRoaXMua2luZCl7Y2FzZVwiTlwiOnJldHVybiBHKHRoaXMudmFsdWUpO2Nhc2VcIkVcIjpyZXR1cm4gcSh0aGlzLmVycm9yKTtjYXNlXCJDXCI6cmV0dXJuIEIoKX10aHJvdyBuZXcgRXJyb3IoXCJ1bmV4cGVjdGVkIG5vdGlmaWNhdGlvbiBraW5kIHZhbHVlXCIpfSx0LmNyZWF0ZU5leHQ9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMCE9PWU/bmV3IHQoXCJOXCIsZSk6dC51bmRlZmluZWRWYWx1ZU5vdGlmaWNhdGlvbn0sdC5jcmVhdGVFcnJvcj1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IHQoXCJFXCIsdm9pZCAwLGUpfSx0LmNyZWF0ZUNvbXBsZXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHQuY29tcGxldGVOb3RpZmljYXRpb259LHQuY29tcGxldGVOb3RpZmljYXRpb249bmV3IHQoXCJDXCIpLHQudW5kZWZpbmVkVmFsdWVOb3RpZmljYXRpb249bmV3IHQoXCJOXCIsdm9pZCAwKSx0fSgpLFk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dm9pZCAwPT09biYmKG49MCk7dmFyIHI9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIHIuc2NoZWR1bGVyPWksci5kZWxheT1uLHJ9cmV0dXJuIGkoZSx0KSxlLmRpc3BhdGNoPWZ1bmN0aW9uKHQpe3ZhciBlPXQubm90aWZpY2F0aW9uLGk9dC5kZXN0aW5hdGlvbjtlLm9ic2VydmUoaSksdGhpcy51bnN1YnNjcmliZSgpfSxlLnByb3RvdHlwZS5zY2hlZHVsZU1lc3NhZ2U9ZnVuY3Rpb24odCl7dGhpcy5kZXN0aW5hdGlvbi5hZGQodGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUoZS5kaXNwYXRjaCx0aGlzLmRlbGF5LG5ldyBaKHQsdGhpcy5kZXN0aW5hdGlvbikpKX0sZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dGhpcy5zY2hlZHVsZU1lc3NhZ2UoWC5jcmVhdGVOZXh0KHQpKX0sZS5wcm90b3R5cGUuX2Vycm9yPWZ1bmN0aW9uKHQpe3RoaXMuc2NoZWR1bGVNZXNzYWdlKFguY3JlYXRlRXJyb3IodCkpLHRoaXMudW5zdWJzY3JpYmUoKX0sZS5wcm90b3R5cGUuX2NvbXBsZXRlPWZ1bmN0aW9uKCl7dGhpcy5zY2hlZHVsZU1lc3NhZ2UoWC5jcmVhdGVDb21wbGV0ZSgpKSx0aGlzLnVuc3Vic2NyaWJlKCl9LGV9KGYpLFo9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCxlKXt0aGlzLm5vdGlmaWNhdGlvbj10LHRoaXMuZGVzdGluYXRpb249ZX19KCksSj1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSxuKXt2b2lkIDA9PT1lJiYoZT1OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpLHZvaWQgMD09PWkmJihpPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7dmFyIHI9dC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiByLnNjaGVkdWxlcj1uLHIuX2V2ZW50cz1bXSxyLl9pbmZpbml0ZVRpbWVXaW5kb3c9ITEsci5fYnVmZmVyU2l6ZT1lPDE/MTplLHIuX3dpbmRvd1RpbWU9aTwxPzE6aSxpPT09TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZPyhyLl9pbmZpbml0ZVRpbWVXaW5kb3c9ITAsci5uZXh0PXIubmV4dEluZmluaXRlVGltZVdpbmRvdyk6ci5uZXh0PXIubmV4dFRpbWVXaW5kb3cscn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLm5leHRJbmZpbml0ZVRpbWVXaW5kb3c9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNTdG9wcGVkKXt2YXIgaT10aGlzLl9ldmVudHM7aS5wdXNoKGUpLGkubGVuZ3RoPnRoaXMuX2J1ZmZlclNpemUmJmkuc2hpZnQoKX10LnByb3RvdHlwZS5uZXh0LmNhbGwodGhpcyxlKX0sZS5wcm90b3R5cGUubmV4dFRpbWVXaW5kb3c9ZnVuY3Rpb24oZSl7dGhpcy5pc1N0b3BwZWR8fCh0aGlzLl9ldmVudHMucHVzaChuZXcgSyh0aGlzLl9nZXROb3coKSxlKSksdGhpcy5fdHJpbUJ1ZmZlclRoZW5HZXRFdmVudHMoKSksdC5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMsZSl9LGUucHJvdG90eXBlLl9zdWJzY3JpYmU9ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLl9pbmZpbml0ZVRpbWVXaW5kb3csbj1pP3RoaXMuX2V2ZW50czp0aGlzLl90cmltQnVmZmVyVGhlbkdldEV2ZW50cygpLHI9dGhpcy5zY2hlZHVsZXIscz1uLmxlbmd0aDtpZih0aGlzLmNsb3NlZCl0aHJvdyBuZXcgdztpZih0aGlzLmlzU3RvcHBlZHx8dGhpcy5oYXNFcnJvcj9lPXUuRU1QVFk6KHRoaXMub2JzZXJ2ZXJzLnB1c2godCksZT1uZXcgUyh0aGlzLHQpKSxyJiZ0LmFkZCh0PW5ldyBZKHQscikpLGkpZm9yKHZhciBvPTA7bzxzJiYhdC5jbG9zZWQ7bysrKXQubmV4dChuW29dKTtlbHNlIGZvcihvPTA7bzxzJiYhdC5jbG9zZWQ7bysrKXQubmV4dChuW29dLnZhbHVlKTtyZXR1cm4gdGhpcy5oYXNFcnJvcj90LmVycm9yKHRoaXMudGhyb3duRXJyb3IpOnRoaXMuaXNTdG9wcGVkJiZ0LmNvbXBsZXRlKCksZX0sZS5wcm90b3R5cGUuX2dldE5vdz1mdW5jdGlvbigpe3JldHVybih0aGlzLnNjaGVkdWxlcnx8eikubm93KCl9LGUucHJvdG90eXBlLl90cmltQnVmZmVyVGhlbkdldEV2ZW50cz1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLl9nZXROb3coKSxlPXRoaXMuX2J1ZmZlclNpemUsaT10aGlzLl93aW5kb3dUaW1lLG49dGhpcy5fZXZlbnRzLHI9bi5sZW5ndGgscz0wO3M8ciYmISh0LW5bc10udGltZTxpKTspcysrO3JldHVybiByPmUmJihzPU1hdGgubWF4KHMsci1lKSkscz4wJiZuLnNwbGljZSgwLHMpLG59LGV9KFQpLEs9ZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCxlKXt0aGlzLnRpbWU9dCx0aGlzLnZhbHVlPWV9fSgpLFE9bmV3IGsoTik7ZnVuY3Rpb24gdHQoKXt9dmFyIGV0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe3JldHVybiBFcnJvci5jYWxsKHRoaXMpLHRoaXMubWVzc2FnZT1cImFyZ3VtZW50IG91dCBvZiByYW5nZVwiLHRoaXMubmFtZT1cIkFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yXCIsdGhpc31yZXR1cm4gdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpLHR9KCksaXQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7cmV0dXJuIEVycm9yLmNhbGwodGhpcyksdGhpcy5tZXNzYWdlPVwibm8gZWxlbWVudHMgaW4gc2VxdWVuY2VcIix0aGlzLm5hbWU9XCJFbXB0eUVycm9yXCIsdGhpc31yZXR1cm4gdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpLHR9KCksbnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7cmV0dXJuIEVycm9yLmNhbGwodGhpcyksdGhpcy5tZXNzYWdlPVwiVGltZW91dCBoYXMgb2NjdXJyZWRcIix0aGlzLm5hbWU9XCJUaW1lb3V0RXJyb3JcIix0aGlzfXJldHVybiB0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSksdH0oKTtmdW5jdGlvbiBydCh0LGUpe3JldHVybiBmdW5jdGlvbihpKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiB0KXRocm93IG5ldyBUeXBlRXJyb3IoXCJhcmd1bWVudCBpcyBub3QgYSBmdW5jdGlvbi4gQXJlIHlvdSBsb29raW5nIGZvciBgbWFwVG8oKWA/XCIpO3JldHVybiBpLmxpZnQobmV3IHN0KHQsZSkpfX12YXIgc3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7dGhpcy5wcm9qZWN0PXQsdGhpcy50aGlzQXJnPWV9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IG90KHQsdGhpcy5wcm9qZWN0LHRoaXMudGhpc0FyZykpfSx0fSgpLG90PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpLG4pe3ZhciByPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiByLnByb2plY3Q9aSxyLmNvdW50PTAsci50aGlzQXJnPW58fHIscn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3ZhciBlO3RyeXtlPXRoaXMucHJvamVjdC5jYWxsKHRoaXMudGhpc0FyZyx0LHRoaXMuY291bnQrKyl9Y2F0Y2godCl7cmV0dXJuIHZvaWQgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcih0KX10aGlzLmRlc3RpbmF0aW9uLm5leHQoZSl9LGV9KGYpLGF0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoKXtyZXR1cm4gbnVsbCE9PXQmJnQuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbih0LGUsaSxuLHIpe3RoaXMuZGVzdGluYXRpb24ubmV4dChlKX0sZS5wcm90b3R5cGUubm90aWZ5RXJyb3I9ZnVuY3Rpb24odCxlKXt0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfSxlLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZT1mdW5jdGlvbih0KXt0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCl9LGV9KGYpLGN0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpLG4pe3ZhciByPXQuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gci5wYXJlbnQ9ZSxyLm91dGVyVmFsdWU9aSxyLm91dGVySW5kZXg9bixyLmluZGV4PTAscn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3RoaXMucGFyZW50Lm5vdGlmeU5leHQodGhpcy5vdXRlclZhbHVlLHQsdGhpcy5vdXRlckluZGV4LHRoaXMuaW5kZXgrKyx0aGlzKX0sZS5wcm90b3R5cGUuX2Vycm9yPWZ1bmN0aW9uKHQpe3RoaXMucGFyZW50Lm5vdGlmeUVycm9yKHQsdGhpcyksdGhpcy51bnN1YnNjcmliZSgpfSxlLnByb3RvdHlwZS5fY29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLnBhcmVudC5ub3RpZnlDb21wbGV0ZSh0aGlzKSx0aGlzLnVuc3Vic2NyaWJlKCl9LGV9KGYpO2Z1bmN0aW9uIGh0KCl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZTeW1ib2wuaXRlcmF0b3I/U3ltYm9sLml0ZXJhdG9yOlwiQEBpdGVyYXRvclwifXZhciBsdD1odCgpLHV0PWZ1bmN0aW9uKHQpe3JldHVybiB0JiZcIm51bWJlclwiPT10eXBlb2YgdC5sZW5ndGgmJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHR9O2Z1bmN0aW9uIGR0KHQpe3JldHVybiEhdCYmXCJmdW5jdGlvblwiIT10eXBlb2YgdC5zdWJzY3JpYmUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQudGhlbn12YXIgcHQ9ZnVuY3Rpb24odCl7aWYodCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdFtnXSlyZXR1cm4gbj10LGZ1bmN0aW9uKHQpe3ZhciBlPW5bZ10oKTtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBlLnN1YnNjcmliZSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJvdmlkZWQgb2JqZWN0IGRvZXMgbm90IGNvcnJlY3RseSBpbXBsZW1lbnQgU3ltYm9sLm9ic2VydmFibGVcIik7cmV0dXJuIGUuc3Vic2NyaWJlKHQpfTtpZih1dCh0KSlyZXR1cm4gSCh0KTtpZihkdCh0KSlyZXR1cm4gaT10LGZ1bmN0aW9uKHQpe3JldHVybiBpLnRoZW4oKGZ1bmN0aW9uKGUpe3QuY2xvc2VkfHwodC5uZXh0KGUpLHQuY29tcGxldGUoKSl9KSwoZnVuY3Rpb24oZSl7cmV0dXJuIHQuZXJyb3IoZSl9KSkudGhlbihudWxsLG8pLHR9O2lmKHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRbbHRdKXJldHVybiBlPXQsZnVuY3Rpb24odCl7Zm9yKHZhciBpPWVbbHRdKCk7Oyl7dmFyIG49dm9pZCAwO3RyeXtuPWkubmV4dCgpfWNhdGNoKGUpe3JldHVybiB0LmVycm9yKGUpLHR9aWYobi5kb25lKXt0LmNvbXBsZXRlKCk7YnJlYWt9aWYodC5uZXh0KG4udmFsdWUpLHQuY2xvc2VkKWJyZWFrfXJldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIGkucmV0dXJuJiZ0LmFkZCgoZnVuY3Rpb24oKXtpLnJldHVybiYmaS5yZXR1cm4oKX0pKSx0fTt2YXIgZSxpLG4scj1oKHQpP1wiYW4gaW52YWxpZCBvYmplY3RcIjpcIidcIit0K1wiJ1wiO3Rocm93IG5ldyBUeXBlRXJyb3IoXCJZb3UgcHJvdmlkZWQgXCIrcitcIiB3aGVyZSBhIHN0cmVhbSB3YXMgZXhwZWN0ZWQuIFlvdSBjYW4gcHJvdmlkZSBhbiBPYnNlcnZhYmxlLCBQcm9taXNlLCBBcnJheSwgb3IgSXRlcmFibGUuXCIpfTtmdW5jdGlvbiBmdCh0LGUsaSxuLHIpe2lmKHZvaWQgMD09PXImJihyPW5ldyBjdCh0LGksbikpLCFyLmNsb3NlZClyZXR1cm4gZSBpbnN0YW5jZW9mIGI/ZS5zdWJzY3JpYmUocik6cHQoZSkocil9dmFyIG10PXt9O2Z1bmN0aW9uIGd0KCl7Zm9yKHZhciB0PVtdLGU9MDtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXRbZV09YXJndW1lbnRzW2VdO3ZhciBpPXZvaWQgMCxuPXZvaWQgMDtyZXR1cm4gaih0W3QubGVuZ3RoLTFdKSYmKG49dC5wb3AoKSksXCJmdW5jdGlvblwiPT10eXBlb2YgdFt0Lmxlbmd0aC0xXSYmKGk9dC5wb3AoKSksMT09PXQubGVuZ3RoJiZjKHRbMF0pJiYodD10WzBdKSxWKHQsbikubGlmdChuZXcgX3QoaSkpfXZhciBfdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5yZXN1bHRTZWxlY3Rvcj10fXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyB2dCh0LHRoaXMucmVzdWx0U2VsZWN0b3IpKX0sdH0oKSx2dD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4ucmVzdWx0U2VsZWN0b3I9aSxuLmFjdGl2ZT0wLG4udmFsdWVzPVtdLG4ub2JzZXJ2YWJsZXM9W10sbn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3RoaXMudmFsdWVzLnB1c2gobXQpLHRoaXMub2JzZXJ2YWJsZXMucHVzaCh0KX0sZS5wcm90b3R5cGUuX2NvbXBsZXRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5vYnNlcnZhYmxlcyxlPXQubGVuZ3RoO2lmKDA9PT1lKXRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKTtlbHNle3RoaXMuYWN0aXZlPWUsdGhpcy50b1Jlc3BvbmQ9ZTtmb3IodmFyIGk9MDtpPGU7aSsrKXt2YXIgbj10W2ldO3RoaXMuYWRkKGZ0KHRoaXMsbix2b2lkIDAsaSkpfX19LGUucHJvdG90eXBlLm5vdGlmeUNvbXBsZXRlPWZ1bmN0aW9uKHQpezA9PSh0aGlzLmFjdGl2ZS09MSkmJnRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKX0sZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbih0LGUsaSl7dmFyIG49dGhpcy52YWx1ZXMscj1uW2ldLHM9dGhpcy50b1Jlc3BvbmQ/cj09PW10Py0tdGhpcy50b1Jlc3BvbmQ6dGhpcy50b1Jlc3BvbmQ6MDtuW2ldPWUsMD09PXMmJih0aGlzLnJlc3VsdFNlbGVjdG9yP3RoaXMuX3RyeVJlc3VsdFNlbGVjdG9yKG4pOnRoaXMuZGVzdGluYXRpb24ubmV4dChuLnNsaWNlKCkpKX0sZS5wcm90b3R5cGUuX3RyeVJlc3VsdFNlbGVjdG9yPWZ1bmN0aW9uKHQpe3ZhciBlO3RyeXtlPXRoaXMucmVzdWx0U2VsZWN0b3IuYXBwbHkodGhpcyx0KX1jYXRjaCh0KXtyZXR1cm4gdm9pZCB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfXRoaXMuZGVzdGluYXRpb24ubmV4dChlKX0sZX0oYXQpO2Z1bmN0aW9uIHl0KHQsZSl7aWYobnVsbCE9dCl7aWYoZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRbZ119KHQpKXJldHVybiBmdW5jdGlvbih0LGUpe3JldHVybiBuZXcgYigoZnVuY3Rpb24oaSl7dmFyIG49bmV3IHU7cmV0dXJuIG4uYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7dmFyIHI9dFtnXSgpO24uYWRkKHIuc3Vic2NyaWJlKHtuZXh0OmZ1bmN0aW9uKHQpe24uYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7cmV0dXJuIGkubmV4dCh0KX0pKSl9LGVycm9yOmZ1bmN0aW9uKHQpe24uYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7cmV0dXJuIGkuZXJyb3IodCl9KSkpfSxjb21wbGV0ZTpmdW5jdGlvbigpe24uYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7cmV0dXJuIGkuY29tcGxldGUoKX0pKSl9fSkpfSkpKSxufSkpfSh0LGUpO2lmKGR0KHQpKXJldHVybiBmdW5jdGlvbih0LGUpe3JldHVybiBuZXcgYigoZnVuY3Rpb24oaSl7dmFyIG49bmV3IHU7cmV0dXJuIG4uYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7cmV0dXJuIHQudGhlbigoZnVuY3Rpb24odCl7bi5hZGQoZS5zY2hlZHVsZSgoZnVuY3Rpb24oKXtpLm5leHQodCksbi5hZGQoZS5zY2hlZHVsZSgoZnVuY3Rpb24oKXtyZXR1cm4gaS5jb21wbGV0ZSgpfSkpKX0pKSl9KSwoZnVuY3Rpb24odCl7bi5hZGQoZS5zY2hlZHVsZSgoZnVuY3Rpb24oKXtyZXR1cm4gaS5lcnJvcih0KX0pKSl9KSl9KSkpLG59KSl9KHQsZSk7aWYodXQodCkpcmV0dXJuIFUodCxlKTtpZihmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdFtsdF19KHQpfHxcInN0cmluZ1wiPT10eXBlb2YgdClyZXR1cm4gZnVuY3Rpb24odCxlKXtpZighdCl0aHJvdyBuZXcgRXJyb3IoXCJJdGVyYWJsZSBjYW5ub3QgYmUgbnVsbFwiKTtyZXR1cm4gbmV3IGIoKGZ1bmN0aW9uKGkpe3ZhciBuLHI9bmV3IHU7cmV0dXJuIHIuYWRkKChmdW5jdGlvbigpe24mJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4ucmV0dXJuJiZuLnJldHVybigpfSkpLHIuYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7bj10W2x0XSgpLHIuYWRkKGUuc2NoZWR1bGUoKGZ1bmN0aW9uKCl7aWYoIWkuY2xvc2VkKXt2YXIgdCxlO3RyeXt2YXIgcj1uLm5leHQoKTt0PXIudmFsdWUsZT1yLmRvbmV9Y2F0Y2godCl7cmV0dXJuIHZvaWQgaS5lcnJvcih0KX1lP2kuY29tcGxldGUoKTooaS5uZXh0KHQpLHRoaXMuc2NoZWR1bGUoKSl9fSkpKX0pKSkscn0pKX0odCxlKX10aHJvdyBuZXcgVHlwZUVycm9yKChudWxsIT09dCYmdHlwZW9mIHR8fHQpK1wiIGlzIG5vdCBvYnNlcnZhYmxlXCIpfWZ1bmN0aW9uIGJ0KHQsZSl7cmV0dXJuIGU/eXQodCxlKTp0IGluc3RhbmNlb2YgYj90Om5ldyBiKHB0KHQpKX12YXIgeHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlKXt2YXIgaT10LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGkucGFyZW50PWUsaX1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3RoaXMucGFyZW50Lm5vdGlmeU5leHQodCl9LGUucHJvdG90eXBlLl9lcnJvcj1mdW5jdGlvbih0KXt0aGlzLnBhcmVudC5ub3RpZnlFcnJvcih0KSx0aGlzLnVuc3Vic2NyaWJlKCl9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMucGFyZW50Lm5vdGlmeUNvbXBsZXRlKCksdGhpcy51bnN1YnNjcmliZSgpfSxlfShmKSx3dD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKCl7cmV0dXJuIG51bGwhPT10JiZ0LmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLm5vdGlmeU5leHQ9ZnVuY3Rpb24odCl7dGhpcy5kZXN0aW5hdGlvbi5uZXh0KHQpfSxlLnByb3RvdHlwZS5ub3RpZnlFcnJvcj1mdW5jdGlvbih0KXt0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfSxlLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKX0sZX0oZik7ZnVuY3Rpb24gU3QodCxlKXtpZighZS5jbG9zZWQpcmV0dXJuIHQgaW5zdGFuY2VvZiBiP3Quc3Vic2NyaWJlKGUpOnB0KHQpKGUpfWZ1bmN0aW9uIE10KHQsZSxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2Z1bmN0aW9uKG4pe3JldHVybiBuLnBpcGUoTXQoKGZ1bmN0aW9uKGksbil7cmV0dXJuIGJ0KHQoaSxuKSkucGlwZShydCgoZnVuY3Rpb24odCxyKXtyZXR1cm4gZShpLHQsbixyKX0pKSl9KSxpKSl9OihcIm51bWJlclwiPT10eXBlb2YgZSYmKGk9ZSksZnVuY3Rpb24oZSl7cmV0dXJuIGUubGlmdChuZXcgVHQodCxpKSl9KX12YXIgVHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7dm9pZCAwPT09ZSYmKGU9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSx0aGlzLnByb2plY3Q9dCx0aGlzLmNvbmN1cnJlbnQ9ZX1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcgQ3QodCx0aGlzLnByb2plY3QsdGhpcy5jb25jdXJyZW50KSl9LHR9KCksQ3Q9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dm9pZCAwPT09biYmKG49TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTt2YXIgcj10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gci5wcm9qZWN0PWksci5jb25jdXJyZW50PW4sci5oYXNDb21wbGV0ZWQ9ITEsci5idWZmZXI9W10sci5hY3RpdmU9MCxyLmluZGV4PTAscn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3RoaXMuYWN0aXZlPHRoaXMuY29uY3VycmVudD90aGlzLl90cnlOZXh0KHQpOnRoaXMuYnVmZmVyLnB1c2godCl9LGUucHJvdG90eXBlLl90cnlOZXh0PWZ1bmN0aW9uKHQpe3ZhciBlLGk9dGhpcy5pbmRleCsrO3RyeXtlPXRoaXMucHJvamVjdCh0LGkpfWNhdGNoKHQpe3JldHVybiB2b2lkIHRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9dGhpcy5hY3RpdmUrKyx0aGlzLl9pbm5lclN1YihlKX0sZS5wcm90b3R5cGUuX2lubmVyU3ViPWZ1bmN0aW9uKHQpe3ZhciBlPW5ldyB4dCh0aGlzKSxpPXRoaXMuZGVzdGluYXRpb247aS5hZGQoZSk7dmFyIG49U3QodCxlKTtuIT09ZSYmaS5hZGQobil9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMuaGFzQ29tcGxldGVkPSEwLDA9PT10aGlzLmFjdGl2ZSYmMD09PXRoaXMuYnVmZmVyLmxlbmd0aCYmdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpLHRoaXMudW5zdWJzY3JpYmUoKX0sZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbih0KXt0aGlzLmRlc3RpbmF0aW9uLm5leHQodCl9LGUucHJvdG90eXBlLm5vdGlmeUNvbXBsZXRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5idWZmZXI7dGhpcy5hY3RpdmUtLSx0Lmxlbmd0aD4wP3RoaXMuX25leHQodC5zaGlmdCgpKTowPT09dGhpcy5hY3RpdmUmJnRoaXMuaGFzQ29tcGxldGVkJiZ0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCl9LGV9KHd0KTtmdW5jdGlvbiBFdCh0KXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKSxNdChfLHQpfWZ1bmN0aW9uIEl0KCl7cmV0dXJuIEV0KDEpfWZ1bmN0aW9uIEF0KCl7Zm9yKHZhciB0PVtdLGU9MDtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXRbZV09YXJndW1lbnRzW2VdO3JldHVybiBJdCgpKEcuYXBwbHkodm9pZCAwLHQpKX1mdW5jdGlvbiBQdCh0LGUsaSxyKXtyZXR1cm4gbihpKSYmKHI9aSxpPXZvaWQgMCkscj9QdCh0LGUsaSkucGlwZShydCgoZnVuY3Rpb24odCl7cmV0dXJuIGModCk/ci5hcHBseSh2b2lkIDAsdCk6cih0KX0pKSk6bmV3IGIoKGZ1bmN0aW9uKG4pe1J0KHQsZSwoZnVuY3Rpb24odCl7YXJndW1lbnRzLmxlbmd0aD4xP24ubmV4dChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpKTpuLm5leHQodCl9KSxuLGkpfSkpfWZ1bmN0aW9uIFJ0KHQsZSxpLG4scil7dmFyIHM7aWYoZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQuYWRkRXZlbnRMaXN0ZW5lciYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5yZW1vdmVFdmVudExpc3RlbmVyfSh0KSl7dmFyIG89dDt0LmFkZEV2ZW50TGlzdGVuZXIoZSxpLHIpLHM9ZnVuY3Rpb24oKXtyZXR1cm4gby5yZW1vdmVFdmVudExpc3RlbmVyKGUsaSxyKX19ZWxzZSBpZihmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5vbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgdC5vZmZ9KHQpKXt2YXIgYT10O3Qub24oZSxpKSxzPWZ1bmN0aW9uKCl7cmV0dXJuIGEub2ZmKGUsaSl9fWVsc2UgaWYoZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQuYWRkTGlzdGVuZXImJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQucmVtb3ZlTGlzdGVuZXJ9KHQpKXt2YXIgYz10O3QuYWRkTGlzdGVuZXIoZSxpKSxzPWZ1bmN0aW9uKCl7cmV0dXJuIGMucmVtb3ZlTGlzdGVuZXIoZSxpKX19ZWxzZXtpZighdHx8IXQubGVuZ3RoKXRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGV2ZW50IHRhcmdldFwiKTtmb3IodmFyIGg9MCxsPXQubGVuZ3RoO2g8bDtoKyspUnQodFtoXSxlLGksbixyKX1uLmFkZChzKX1mdW5jdGlvbiBMdCh0KXtyZXR1cm4hYyh0KSYmdC1wYXJzZUZsb2F0KHQpKzE+PTB9ZnVuY3Rpb24gT3QoKXtmb3IodmFyIHQ9W10sZT0wO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspdFtlXT1hcmd1bWVudHNbZV07dmFyIGk9TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLG49bnVsbCxyPXRbdC5sZW5ndGgtMV07cmV0dXJuIGoocik/KG49dC5wb3AoKSx0Lmxlbmd0aD4xJiZcIm51bWJlclwiPT10eXBlb2YgdFt0Lmxlbmd0aC0xXSYmKGk9dC5wb3AoKSkpOlwibnVtYmVyXCI9PXR5cGVvZiByJiYoaT10LnBvcCgpKSxudWxsPT09biYmMT09PXQubGVuZ3RoJiZ0WzBdaW5zdGFuY2VvZiBiP3RbMF06RXQoaSkoVih0LG4pKX1mdW5jdGlvbiBOdCh0LGUpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gaS5saWZ0KG5ldyBEdCh0LGUpKX19dmFyIER0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMucHJlZGljYXRlPXQsdGhpcy50aGlzQXJnPWV9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3ICR0KHQsdGhpcy5wcmVkaWNhdGUsdGhpcy50aGlzQXJnKSl9LHR9KCksJHQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dmFyIHI9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIHIucHJlZGljYXRlPWksci50aGlzQXJnPW4sci5jb3VudD0wLHJ9cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbih0KXt2YXIgZTt0cnl7ZT10aGlzLnByZWRpY2F0ZS5jYWxsKHRoaXMudGhpc0FyZyx0LHRoaXMuY291bnQrKyl9Y2F0Y2godCl7cmV0dXJuIHZvaWQgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcih0KX1lJiZ0aGlzLmRlc3RpbmF0aW9uLm5leHQodCl9LGV9KGYpO2Z1bmN0aW9uIGt0KHQsZSxpKXt2b2lkIDA9PT10JiYodD0wKTt2YXIgbj0tMTtyZXR1cm4gTHQoZSk/bj1OdW1iZXIoZSk8MT8xOk51bWJlcihlKTpqKGUpJiYoaT1lKSxqKGkpfHwoaT1RKSxuZXcgYigoZnVuY3Rpb24oZSl7dmFyIHI9THQodCk/dDordC1pLm5vdygpO3JldHVybiBpLnNjaGVkdWxlKHp0LHIse2luZGV4OjAscGVyaW9kOm4sc3Vic2NyaWJlcjplfSl9KSl9ZnVuY3Rpb24genQodCl7dmFyIGU9dC5pbmRleCxpPXQucGVyaW9kLG49dC5zdWJzY3JpYmVyO2lmKG4ubmV4dChlKSwhbi5jbG9zZWQpe2lmKC0xPT09aSlyZXR1cm4gbi5jb21wbGV0ZSgpO3QuaW5kZXg9ZSsxLHRoaXMuc2NoZWR1bGUodCxpKX19ZnVuY3Rpb24gRnQoKXtmb3IodmFyIHQ9W10sZT0wO2U8YXJndW1lbnRzLmxlbmd0aDtlKyspdFtlXT1hcmd1bWVudHNbZV07dmFyIGk9dFt0Lmxlbmd0aC0xXTtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBpJiZ0LnBvcCgpLFYodCx2b2lkIDApLmxpZnQobmV3IEJ0KGkpKX12YXIgQnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMucmVzdWx0U2VsZWN0b3I9dH1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcganQodCx0aGlzLnJlc3VsdFNlbGVjdG9yKSl9LHR9KCksanQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dmFyIHI9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIHIucmVzdWx0U2VsZWN0b3I9aSxyLml0ZXJhdG9ycz1bXSxyLmFjdGl2ZT0wLHIucmVzdWx0U2VsZWN0b3I9XCJmdW5jdGlvblwiPT10eXBlb2YgaT9pOnZvaWQgMCxyfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5pdGVyYXRvcnM7Yyh0KT9lLnB1c2gobmV3IFV0KHQpKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiB0W2x0XT9lLnB1c2gobmV3IEh0KHRbbHRdKCkpKTplLnB1c2gobmV3IFZ0KHRoaXMuZGVzdGluYXRpb24sdGhpcyx0KSl9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuaXRlcmF0b3JzLGU9dC5sZW5ndGg7aWYodGhpcy51bnN1YnNjcmliZSgpLDAhPT1lKXt0aGlzLmFjdGl2ZT1lO2Zvcih2YXIgaT0wO2k8ZTtpKyspe3ZhciBuPXRbaV07aWYobi5zdGlsbFVuc3Vic2NyaWJlZCl0aGlzLmRlc3RpbmF0aW9uLmFkZChuLnN1YnNjcmliZSgpKTtlbHNlIHRoaXMuYWN0aXZlLS19fWVsc2UgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpfSxlLnByb3RvdHlwZS5ub3RpZnlJbmFjdGl2ZT1mdW5jdGlvbigpe3RoaXMuYWN0aXZlLS0sMD09PXRoaXMuYWN0aXZlJiZ0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCl9LGUucHJvdG90eXBlLmNoZWNrSXRlcmF0b3JzPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuaXRlcmF0b3JzLGU9dC5sZW5ndGgsaT10aGlzLmRlc3RpbmF0aW9uLG49MDtuPGU7bisrKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZihvPXRbbl0pLmhhc1ZhbHVlJiYhby5oYXNWYWx1ZSgpKXJldHVybn12YXIgcj0hMSxzPVtdO2ZvcihuPTA7bjxlO24rKyl7dmFyIG8sYT0obz10W25dKS5uZXh0KCk7aWYoby5oYXNDb21wbGV0ZWQoKSYmKHI9ITApLGEuZG9uZSlyZXR1cm4gdm9pZCBpLmNvbXBsZXRlKCk7cy5wdXNoKGEudmFsdWUpfXRoaXMucmVzdWx0U2VsZWN0b3I/dGhpcy5fdHJ5cmVzdWx0U2VsZWN0b3Iocyk6aS5uZXh0KHMpLHImJmkuY29tcGxldGUoKX0sZS5wcm90b3R5cGUuX3RyeXJlc3VsdFNlbGVjdG9yPWZ1bmN0aW9uKHQpe3ZhciBlO3RyeXtlPXRoaXMucmVzdWx0U2VsZWN0b3IuYXBwbHkodGhpcyx0KX1jYXRjaCh0KXtyZXR1cm4gdm9pZCB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfXRoaXMuZGVzdGluYXRpb24ubmV4dChlKX0sZX0oZiksSHQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuaXRlcmF0b3I9dCx0aGlzLm5leHRSZXN1bHQ9dC5uZXh0KCl9cmV0dXJuIHQucHJvdG90eXBlLmhhc1ZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuITB9LHQucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm5leHRSZXN1bHQ7cmV0dXJuIHRoaXMubmV4dFJlc3VsdD10aGlzLml0ZXJhdG9yLm5leHQoKSx0fSx0LnByb3RvdHlwZS5oYXNDb21wbGV0ZWQ9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm5leHRSZXN1bHQ7cmV0dXJuIEJvb2xlYW4odCYmdC5kb25lKX0sdH0oKSxVdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5hcnJheT10LHRoaXMuaW5kZXg9MCx0aGlzLmxlbmd0aD0wLHRoaXMubGVuZ3RoPXQubGVuZ3RofXJldHVybiB0LnByb3RvdHlwZVtsdF09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sdC5wcm90b3R5cGUubmV4dD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmluZGV4KyssaT10aGlzLmFycmF5O3JldHVybiBlPHRoaXMubGVuZ3RoP3t2YWx1ZTppW2VdLGRvbmU6ITF9Ont2YWx1ZTpudWxsLGRvbmU6ITB9fSx0LnByb3RvdHlwZS5oYXNWYWx1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmFycmF5Lmxlbmd0aD50aGlzLmluZGV4fSx0LnByb3RvdHlwZS5oYXNDb21wbGV0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5hcnJheS5sZW5ndGg9PT10aGlzLmluZGV4fSx0fSgpLFZ0PWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpLG4pe3ZhciByPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiByLnBhcmVudD1pLHIub2JzZXJ2YWJsZT1uLHIuc3RpbGxVbnN1YnNjcmliZWQ9ITAsci5idWZmZXI9W10sci5pc0NvbXBsZXRlPSExLHJ9cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZVtsdF09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sZS5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe3ZhciB0PXRoaXMuYnVmZmVyO3JldHVybiAwPT09dC5sZW5ndGgmJnRoaXMuaXNDb21wbGV0ZT97dmFsdWU6bnVsbCxkb25lOiEwfTp7dmFsdWU6dC5zaGlmdCgpLGRvbmU6ITF9fSxlLnByb3RvdHlwZS5oYXNWYWx1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmJ1ZmZlci5sZW5ndGg+MH0sZS5wcm90b3R5cGUuaGFzQ29tcGxldGVkPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmJ1ZmZlci5sZW5ndGgmJnRoaXMuaXNDb21wbGV0ZX0sZS5wcm90b3R5cGUubm90aWZ5Q29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLmJ1ZmZlci5sZW5ndGg+MD8odGhpcy5pc0NvbXBsZXRlPSEwLHRoaXMucGFyZW50Lm5vdGlmeUluYWN0aXZlKCkpOnRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKX0sZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbih0KXt0aGlzLmJ1ZmZlci5wdXNoKHQpLHRoaXMucGFyZW50LmNoZWNrSXRlcmF0b3JzKCl9LGUucHJvdG90eXBlLnN1YnNjcmliZT1mdW5jdGlvbigpe3JldHVybiBTdCh0aGlzLm9ic2VydmFibGUsbmV3IHh0KHRoaXMpKX0sZX0od3QpO3ZhciBHdD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5kdXJhdGlvblNlbGVjdG9yPXR9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IHF0KHQsdGhpcy5kdXJhdGlvblNlbGVjdG9yKSl9LHR9KCkscXQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3ZhciBuPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBuLmR1cmF0aW9uU2VsZWN0b3I9aSxuLmhhc1ZhbHVlPSExLG59cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbih0KXtpZih0aGlzLnZhbHVlPXQsdGhpcy5oYXNWYWx1ZT0hMCwhdGhpcy50aHJvdHRsZWQpe3ZhciBlPXZvaWQgMDt0cnl7ZT0oMCx0aGlzLmR1cmF0aW9uU2VsZWN0b3IpKHQpfWNhdGNoKHQpe3JldHVybiB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfXZhciBpPVN0KGUsbmV3IHh0KHRoaXMpKTshaXx8aS5jbG9zZWQ/dGhpcy5jbGVhclRocm90dGxlKCk6dGhpcy5hZGQodGhpcy50aHJvdHRsZWQ9aSl9fSxlLnByb3RvdHlwZS5jbGVhclRocm90dGxlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxlPXQudmFsdWUsaT10Lmhhc1ZhbHVlLG49dC50aHJvdHRsZWQ7biYmKHRoaXMucmVtb3ZlKG4pLHRoaXMudGhyb3R0bGVkPXZvaWQgMCxuLnVuc3Vic2NyaWJlKCkpLGkmJih0aGlzLnZhbHVlPXZvaWQgMCx0aGlzLmhhc1ZhbHVlPSExLHRoaXMuZGVzdGluYXRpb24ubmV4dChlKSl9LGUucHJvdG90eXBlLm5vdGlmeU5leHQ9ZnVuY3Rpb24oKXt0aGlzLmNsZWFyVGhyb3R0bGUoKX0sZS5wcm90b3R5cGUubm90aWZ5Q29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLmNsZWFyVGhyb3R0bGUoKX0sZX0od3QpO2Z1bmN0aW9uIFd0KHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPVEpLGk9ZnVuY3Rpb24oKXtyZXR1cm4ga3QodCxlKX0sZnVuY3Rpb24odCl7cmV0dXJuIHQubGlmdChuZXcgR3QoaSkpfTt2YXIgaX1mdW5jdGlvbiBYdCh0LGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT1udWxsKSxmdW5jdGlvbihpKXtyZXR1cm4gaS5saWZ0KG5ldyBZdCh0LGUpKX19dmFyIFl0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuYnVmZmVyU2l6ZT10LHRoaXMuc3RhcnRCdWZmZXJFdmVyeT1lLHRoaXMuc3Vic2NyaWJlckNsYXNzPWUmJnQhPT1lP0p0Olp0fXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyB0aGlzLnN1YnNjcmliZXJDbGFzcyh0LHRoaXMuYnVmZmVyU2l6ZSx0aGlzLnN0YXJ0QnVmZmVyRXZlcnkpKX0sdH0oKSxadD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4uYnVmZmVyU2l6ZT1pLG4uYnVmZmVyPVtdLG59cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmJ1ZmZlcjtlLnB1c2godCksZS5sZW5ndGg9PXRoaXMuYnVmZmVyU2l6ZSYmKHRoaXMuZGVzdGluYXRpb24ubmV4dChlKSx0aGlzLmJ1ZmZlcj1bXSl9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuYnVmZmVyO2UubGVuZ3RoPjAmJnRoaXMuZGVzdGluYXRpb24ubmV4dChlKSx0LnByb3RvdHlwZS5fY29tcGxldGUuY2FsbCh0aGlzKX0sZX0oZiksSnQ9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dmFyIHI9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIHIuYnVmZmVyU2l6ZT1pLHIuc3RhcnRCdWZmZXJFdmVyeT1uLHIuYnVmZmVycz1bXSxyLmNvdW50PTAscn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMsaT1lLmJ1ZmZlclNpemUsbj1lLnN0YXJ0QnVmZmVyRXZlcnkscj1lLmJ1ZmZlcnMscz1lLmNvdW50O3RoaXMuY291bnQrKyxzJW49PTAmJnIucHVzaChbXSk7Zm9yKHZhciBvPXIubGVuZ3RoO28tLTspe3ZhciBhPXJbb107YS5wdXNoKHQpLGEubGVuZ3RoPT09aSYmKHIuc3BsaWNlKG8sMSksdGhpcy5kZXN0aW5hdGlvbi5uZXh0KGEpKX19LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe2Zvcih2YXIgZT10aGlzLmJ1ZmZlcnMsaT10aGlzLmRlc3RpbmF0aW9uO2UubGVuZ3RoPjA7KXt2YXIgbj1lLnNoaWZ0KCk7bi5sZW5ndGg+MCYmaS5uZXh0KG4pfXQucHJvdG90eXBlLl9jb21wbGV0ZS5jYWxsKHRoaXMpfSxlfShmKTt2YXIgS3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuY2xvc2luZ1NlbGVjdG9yPXR9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IFF0KHQsdGhpcy5jbG9zaW5nU2VsZWN0b3IpKX0sdH0oKSxRdD1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4uY2xvc2luZ1NlbGVjdG9yPWksbi5zdWJzY3JpYmluZz0hMSxuLm9wZW5CdWZmZXIoKSxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dGhpcy5idWZmZXIucHVzaCh0KX0sZS5wcm90b3R5cGUuX2NvbXBsZXRlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5idWZmZXI7ZSYmdGhpcy5kZXN0aW5hdGlvbi5uZXh0KGUpLHQucHJvdG90eXBlLl9jb21wbGV0ZS5jYWxsKHRoaXMpfSxlLnByb3RvdHlwZS5fdW5zdWJzY3JpYmU9ZnVuY3Rpb24oKXt0aGlzLmJ1ZmZlcj12b2lkIDAsdGhpcy5zdWJzY3JpYmluZz0hMX0sZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbigpe3RoaXMub3BlbkJ1ZmZlcigpfSxlLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMuc3Vic2NyaWJpbmc/dGhpcy5jb21wbGV0ZSgpOnRoaXMub3BlbkJ1ZmZlcigpfSxlLnByb3RvdHlwZS5vcGVuQnVmZmVyPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5jbG9zaW5nU3Vic2NyaXB0aW9uO3QmJih0aGlzLnJlbW92ZSh0KSx0LnVuc3Vic2NyaWJlKCkpO3ZhciBlLGk9dGhpcy5idWZmZXI7dGhpcy5idWZmZXImJnRoaXMuZGVzdGluYXRpb24ubmV4dChpKSx0aGlzLmJ1ZmZlcj1bXTt0cnl7ZT0oMCx0aGlzLmNsb3NpbmdTZWxlY3RvcikoKX1jYXRjaCh0KXtyZXR1cm4gdGhpcy5lcnJvcih0KX10PW5ldyB1LHRoaXMuY2xvc2luZ1N1YnNjcmlwdGlvbj10LHRoaXMuYWRkKHQpLHRoaXMuc3Vic2NyaWJpbmc9ITAsdC5hZGQoU3QoZSxuZXcgeHQodGhpcykpKSx0aGlzLnN1YnNjcmliaW5nPSExfSxlfSh3dCk7ZnVuY3Rpb24gdGUodCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciBpPW5ldyBlZSh0KSxuPWUubGlmdChpKTtyZXR1cm4gaS5jYXVnaHQ9bn19dmFyIGVlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0KXt0aGlzLnNlbGVjdG9yPXR9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IGllKHQsdGhpcy5zZWxlY3Rvcix0aGlzLmNhdWdodCkpfSx0fSgpLGllPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpLG4pe3ZhciByPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiByLnNlbGVjdG9yPWksci5jYXVnaHQ9bixyfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuZXJyb3I9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuaXNTdG9wcGVkKXt2YXIgaT12b2lkIDA7dHJ5e2k9dGhpcy5zZWxlY3RvcihlLHRoaXMuY2F1Z2h0KX1jYXRjaChlKXtyZXR1cm4gdm9pZCB0LnByb3RvdHlwZS5lcnJvci5jYWxsKHRoaXMsZSl9dGhpcy5fdW5zdWJzY3JpYmVBbmRSZWN5Y2xlKCk7dmFyIG49bmV3IHh0KHRoaXMpO3RoaXMuYWRkKG4pO3ZhciByPVN0KGksbik7ciE9PW4mJnRoaXMuYWRkKHIpfX0sZX0od3QpO2Z1bmN0aW9uIG5lKHQsZSl7cmV0dXJuIE10KHQsZSwxKX1mdW5jdGlvbiByZSh0LGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT1RKSxmdW5jdGlvbihpKXtyZXR1cm4gaS5saWZ0KG5ldyBzZSh0LGUpKX19dmFyIHNlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuZHVlVGltZT10LHRoaXMuc2NoZWR1bGVyPWV9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IG9lKHQsdGhpcy5kdWVUaW1lLHRoaXMuc2NoZWR1bGVyKSl9LHR9KCksb2U9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dmFyIHI9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIHIuZHVlVGltZT1pLHIuc2NoZWR1bGVyPW4sci5kZWJvdW5jZWRTdWJzY3JpcHRpb249bnVsbCxyLmxhc3RWYWx1ZT1udWxsLHIuaGFzVmFsdWU9ITEscn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3RoaXMuY2xlYXJEZWJvdW5jZSgpLHRoaXMubGFzdFZhbHVlPXQsdGhpcy5oYXNWYWx1ZT0hMCx0aGlzLmFkZCh0aGlzLmRlYm91bmNlZFN1YnNjcmlwdGlvbj10aGlzLnNjaGVkdWxlci5zY2hlZHVsZShhZSx0aGlzLmR1ZVRpbWUsdGhpcykpfSxlLnByb3RvdHlwZS5fY29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLmRlYm91bmNlZE5leHQoKSx0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCl9LGUucHJvdG90eXBlLmRlYm91bmNlZE5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLmNsZWFyRGVib3VuY2UoKSx0aGlzLmhhc1ZhbHVlKXt2YXIgdD10aGlzLmxhc3RWYWx1ZTt0aGlzLmxhc3RWYWx1ZT1udWxsLHRoaXMuaGFzVmFsdWU9ITEsdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHQpfX0sZS5wcm90b3R5cGUuY2xlYXJEZWJvdW5jZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuZGVib3VuY2VkU3Vic2NyaXB0aW9uO251bGwhPT10JiYodGhpcy5yZW1vdmUodCksdC51bnN1YnNjcmliZSgpLHRoaXMuZGVib3VuY2VkU3Vic2NyaXB0aW9uPW51bGwpfSxlfShmKTtmdW5jdGlvbiBhZSh0KXt0LmRlYm91bmNlZE5leHQoKX1mdW5jdGlvbiBjZSh0KXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9bnVsbCksZnVuY3Rpb24oZSl7cmV0dXJuIGUubGlmdChuZXcgaGUodCkpfX12YXIgaGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuZGVmYXVsdFZhbHVlPXR9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IGxlKHQsdGhpcy5kZWZhdWx0VmFsdWUpKX0sdH0oKSxsZT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4uZGVmYXVsdFZhbHVlPWksbi5pc0VtcHR5PSEwLG59cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbih0KXt0aGlzLmlzRW1wdHk9ITEsdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHQpfSxlLnByb3RvdHlwZS5fY29tcGxldGU9ZnVuY3Rpb24oKXt0aGlzLmlzRW1wdHkmJnRoaXMuZGVzdGluYXRpb24ubmV4dCh0aGlzLmRlZmF1bHRWYWx1ZSksdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpfSxlfShmKTtmdW5jdGlvbiB1ZSh0LGUpe3JldHVybiBmdW5jdGlvbihpKXtyZXR1cm4gaS5saWZ0KG5ldyBkZSh0LGUpKX19dmFyIGRlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuY29tcGFyZT10LHRoaXMua2V5U2VsZWN0b3I9ZX1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcgcGUodCx0aGlzLmNvbXBhcmUsdGhpcy5rZXlTZWxlY3RvcikpfSx0fSgpLHBlPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpLG4pe3ZhciByPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiByLmtleVNlbGVjdG9yPW4sci5oYXNLZXk9ITEsXCJmdW5jdGlvblwiPT10eXBlb2YgaSYmKHIuY29tcGFyZT1pKSxyfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuY29tcGFyZT1mdW5jdGlvbih0LGUpe3JldHVybiB0PT09ZX0sZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGU7dHJ5e3ZhciBpPXRoaXMua2V5U2VsZWN0b3I7ZT1pP2kodCk6dH1jYXRjaCh0KXtyZXR1cm4gdGhpcy5kZXN0aW5hdGlvbi5lcnJvcih0KX12YXIgbj0hMTtpZih0aGlzLmhhc0tleSl0cnl7bj0oMCx0aGlzLmNvbXBhcmUpKHRoaXMua2V5LGUpfWNhdGNoKHQpe3JldHVybiB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfWVsc2UgdGhpcy5oYXNLZXk9ITA7bnx8KHRoaXMua2V5PWUsdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHQpKX0sZX0oZik7ZnVuY3Rpb24gZmUodCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PV9lKSxmdW5jdGlvbihlKXtyZXR1cm4gZS5saWZ0KG5ldyBtZSh0KSl9fXZhciBtZT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5lcnJvckZhY3Rvcnk9dH1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcgZ2UodCx0aGlzLmVycm9yRmFjdG9yeSkpfSx0fSgpLGdlPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpKXt2YXIgbj10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gbi5lcnJvckZhY3Rvcnk9aSxuLmhhc1ZhbHVlPSExLG59cmV0dXJuIGkoZSx0KSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbih0KXt0aGlzLmhhc1ZhbHVlPSEwLHRoaXMuZGVzdGluYXRpb24ubmV4dCh0KX0sZS5wcm90b3R5cGUuX2NvbXBsZXRlPWZ1bmN0aW9uKCl7aWYodGhpcy5oYXNWYWx1ZSlyZXR1cm4gdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO3ZhciB0PXZvaWQgMDt0cnl7dD10aGlzLmVycm9yRmFjdG9yeSgpfWNhdGNoKGUpe3Q9ZX10aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfSxlfShmKTtmdW5jdGlvbiBfZSgpe3JldHVybiBuZXcgaXR9ZnVuY3Rpb24gdmUodCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiAwPT09dD9CKCk6ZS5saWZ0KG5ldyB5ZSh0KSl9fXZhciB5ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7aWYodGhpcy50b3RhbD10LHRoaXMudG90YWw8MCl0aHJvdyBuZXcgZXR9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IGJlKHQsdGhpcy50b3RhbCkpfSx0fSgpLGJlPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpKXt2YXIgbj10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gbi50b3RhbD1pLG4uY291bnQ9MCxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy50b3RhbCxpPSsrdGhpcy5jb3VudDtpPD1lJiYodGhpcy5kZXN0aW5hdGlvbi5uZXh0KHQpLGk9PT1lJiYodGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpLHRoaXMudW5zdWJzY3JpYmUoKSkpfSxlfShmKTtmdW5jdGlvbiB4ZSh0LGUsaSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPU51bWJlci5QT1NJVElWRV9JTkZJTklUWSksZT0oZXx8MCk8MT9OdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk6ZSxmdW5jdGlvbihuKXtyZXR1cm4gbi5saWZ0KG5ldyB3ZSh0LGUsaSkpfX12YXIgd2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpKXt0aGlzLnByb2plY3Q9dCx0aGlzLmNvbmN1cnJlbnQ9ZSx0aGlzLnNjaGVkdWxlcj1pfXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyBTZSh0LHRoaXMucHJvamVjdCx0aGlzLmNvbmN1cnJlbnQsdGhpcy5zY2hlZHVsZXIpKX0sdH0oKSxTZT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSxuLHIpe3ZhciBzPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBzLnByb2plY3Q9aSxzLmNvbmN1cnJlbnQ9bixzLnNjaGVkdWxlcj1yLHMuaW5kZXg9MCxzLmFjdGl2ZT0wLHMuaGFzQ29tcGxldGVkPSExLG48TnVtYmVyLlBPU0lUSVZFX0lORklOSVRZJiYocy5idWZmZXI9W10pLHN9cmV0dXJuIGkoZSx0KSxlLmRpc3BhdGNoPWZ1bmN0aW9uKHQpe3ZhciBlPXQuc3Vic2NyaWJlcixpPXQucmVzdWx0LG49dC52YWx1ZSxyPXQuaW5kZXg7ZS5zdWJzY3JpYmVUb1Byb2plY3Rpb24oaSxuLHIpfSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbih0KXt2YXIgaT10aGlzLmRlc3RpbmF0aW9uO2lmKGkuY2xvc2VkKXRoaXMuX2NvbXBsZXRlKCk7ZWxzZXt2YXIgbj10aGlzLmluZGV4Kys7aWYodGhpcy5hY3RpdmU8dGhpcy5jb25jdXJyZW50KXtpLm5leHQodCk7dHJ5e3ZhciByPSgwLHRoaXMucHJvamVjdCkodCxuKTtpZih0aGlzLnNjaGVkdWxlcil7dmFyIHM9e3N1YnNjcmliZXI6dGhpcyxyZXN1bHQ6cix2YWx1ZTp0LGluZGV4Om59O3RoaXMuZGVzdGluYXRpb24uYWRkKHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKGUuZGlzcGF0Y2gsMCxzKSl9ZWxzZSB0aGlzLnN1YnNjcmliZVRvUHJvamVjdGlvbihyLHQsbil9Y2F0Y2godCl7aS5lcnJvcih0KX19ZWxzZSB0aGlzLmJ1ZmZlci5wdXNoKHQpfX0sZS5wcm90b3R5cGUuc3Vic2NyaWJlVG9Qcm9qZWN0aW9uPWZ1bmN0aW9uKHQsZSxpKXt0aGlzLmFjdGl2ZSsrLHRoaXMuZGVzdGluYXRpb24uYWRkKFN0KHQsbmV3IHh0KHRoaXMpKSl9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMuaGFzQ29tcGxldGVkPSEwLHRoaXMuaGFzQ29tcGxldGVkJiYwPT09dGhpcy5hY3RpdmUmJnRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKSx0aGlzLnVuc3Vic2NyaWJlKCl9LGUucHJvdG90eXBlLm5vdGlmeU5leHQ9ZnVuY3Rpb24odCl7dGhpcy5fbmV4dCh0KX0sZS5wcm90b3R5cGUubm90aWZ5Q29tcGxldGU9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmJ1ZmZlcjt0aGlzLmFjdGl2ZS0tLHQmJnQubGVuZ3RoPjAmJnRoaXMuX25leHQodC5zaGlmdCgpKSx0aGlzLmhhc0NvbXBsZXRlZCYmMD09PXRoaXMuYWN0aXZlJiZ0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCl9LGV9KHd0KTtmdW5jdGlvbiBNZSh0KXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIGUubGlmdChuZXcgVGUodCkpfX12YXIgVGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMuY2FsbGJhY2s9dH1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcgQ2UodCx0aGlzLmNhbGxiYWNrKSl9LHR9KCksQ2U9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3ZhciBuPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBuLmFkZChuZXcgdShpKSksbn1yZXR1cm4gaShlLHQpLGV9KGYpO2Z1bmN0aW9uIEVlKHQsZSl7dmFyIGk9YXJndW1lbnRzLmxlbmd0aD49MjtyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIG4ucGlwZSh0P050KChmdW5jdGlvbihlLGkpe3JldHVybiB0KGUsaSxuKX0pKTpfLHZlKDEpLGk/Y2UoZSk6ZmUoKGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBpdH0pKSl9fWZ1bmN0aW9uIEllKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gMD09PXQ/QigpOmUubGlmdChuZXcgQWUodCkpfX12YXIgQWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe2lmKHRoaXMudG90YWw9dCx0aGlzLnRvdGFsPDApdGhyb3cgbmV3IGV0fXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyBQZSh0LHRoaXMudG90YWwpKX0sdH0oKSxQZT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4udG90YWw9aSxuLnJpbmc9bmV3IEFycmF5LG4uY291bnQ9MCxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5yaW5nLGk9dGhpcy50b3RhbCxuPXRoaXMuY291bnQrKztlLmxlbmd0aDxpP2UucHVzaCh0KTplW24laV09dH0sZS5wcm90b3R5cGUuX2NvbXBsZXRlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5kZXN0aW5hdGlvbixlPXRoaXMuY291bnQ7aWYoZT4wKWZvcih2YXIgaT10aGlzLmNvdW50Pj10aGlzLnRvdGFsP3RoaXMudG90YWw6dGhpcy5jb3VudCxuPXRoaXMucmluZyxyPTA7cjxpO3IrKyl7dmFyIHM9ZSsrJWk7dC5uZXh0KG5bc10pfXQuY29tcGxldGUoKX0sZX0oZik7ZnVuY3Rpb24gUmUodCxlKXt2YXIgaT1hcmd1bWVudHMubGVuZ3RoPj0yO3JldHVybiBmdW5jdGlvbihuKXtyZXR1cm4gbi5waXBlKHQ/TnQoKGZ1bmN0aW9uKGUsaSl7cmV0dXJuIHQoZSxpLG4pfSkpOl8sSWUoMSksaT9jZShlKTpmZSgoZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGl0fSkpKX19ZnVuY3Rpb24gTGUodCxlKXt2YXIgaT0hMTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD49MiYmKGk9ITApLGZ1bmN0aW9uKG4pe3JldHVybiBuLmxpZnQobmV3IE9lKHQsZSxpKSl9fXZhciBPZT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlLGkpe3ZvaWQgMD09PWkmJihpPSExKSx0aGlzLmFjY3VtdWxhdG9yPXQsdGhpcy5zZWVkPWUsdGhpcy5oYXNTZWVkPWl9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IE5lKHQsdGhpcy5hY2N1bXVsYXRvcix0aGlzLnNlZWQsdGhpcy5oYXNTZWVkKSl9LHR9KCksTmU9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbixyKXt2YXIgcz10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gcy5hY2N1bXVsYXRvcj1pLHMuX3NlZWQ9bixzLmhhc1NlZWQ9cixzLmluZGV4PTAsc31yZXR1cm4gaShlLHQpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLnByb3RvdHlwZSxcInNlZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NlZWR9LHNldDpmdW5jdGlvbih0KXt0aGlzLmhhc1NlZWQ9ITAsdGhpcy5fc2VlZD10fSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe2lmKHRoaXMuaGFzU2VlZClyZXR1cm4gdGhpcy5fdHJ5TmV4dCh0KTt0aGlzLnNlZWQ9dCx0aGlzLmRlc3RpbmF0aW9uLm5leHQodCl9LGUucHJvdG90eXBlLl90cnlOZXh0PWZ1bmN0aW9uKHQpe3ZhciBlLGk9dGhpcy5pbmRleCsrO3RyeXtlPXRoaXMuYWNjdW11bGF0b3IodGhpcy5zZWVkLHQsaSl9Y2F0Y2godCl7dGhpcy5kZXN0aW5hdGlvbi5lcnJvcih0KX10aGlzLnNlZWQ9ZSx0aGlzLmRlc3RpbmF0aW9uLm5leHQoZSl9LGV9KGYpO2Z1bmN0aW9uIERlKHQsZSl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg+PTI/ZnVuY3Rpb24oaSl7cmV0dXJuIHYoTGUodCxlKSxJZSgxKSxjZShlKSkoaSl9OmZ1bmN0aW9uKGUpe3JldHVybiB2KExlKChmdW5jdGlvbihlLGksbil7cmV0dXJuIHQoZSxpLG4rMSl9KSksSWUoMSkpKGUpfX1mdW5jdGlvbiAkZSh0LGUpe3JldHVybiBmdW5jdGlvbihpKXt2YXIgbjtpZihuPVwiZnVuY3Rpb25cIj09dHlwZW9mIHQ/dDpmdW5jdGlvbigpe3JldHVybiB0fSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBlKXJldHVybiBpLmxpZnQobmV3IGtlKG4sZSkpO3ZhciByPU9iamVjdC5jcmVhdGUoaSxSKTtyZXR1cm4gci5zb3VyY2U9aSxyLnN1YmplY3RGYWN0b3J5PW4scn19dmFyIGtlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuc3ViamVjdEZhY3Rvcnk9dCx0aGlzLnNlbGVjdG9yPWV9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnNlbGVjdG9yLG49dGhpcy5zdWJqZWN0RmFjdG9yeSgpLHI9aShuKS5zdWJzY3JpYmUodCk7cmV0dXJuIHIuYWRkKGUuc3Vic2NyaWJlKG4pKSxyfSx0fSgpO2Z1bmN0aW9uIHplKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiB0LmxpZnQobmV3IEZlKX19dmFyIEZlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCgpe31yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcgQmUodCkpfSx0fSgpLEJlPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSl7dmFyIGk9dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIGkuaGFzUHJldj0hMSxpfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGU7dGhpcy5oYXNQcmV2P2U9W3RoaXMucHJldix0XTp0aGlzLmhhc1ByZXY9ITAsdGhpcy5wcmV2PXQsZSYmdGhpcy5kZXN0aW5hdGlvbi5uZXh0KGUpfSxlfShmKTtmdW5jdGlvbiBqZSh0LGUpe3JldHVybiBmdW5jdGlvbihpKXtmb3IodmFyIG49aSxyPTA7cjxlO3IrKyl7dmFyIHM9bnVsbCE9bj9uW3Rbcl1dOnZvaWQgMDtpZih2b2lkIDA9PT1zKXJldHVybjtuPXN9cmV0dXJuIG59fWZ1bmN0aW9uIEhlKHQpe3JldHVybiB0PyRlKChmdW5jdGlvbigpe3JldHVybiBuZXcgVH0pLHQpOiRlKG5ldyBUKX1mdW5jdGlvbiBVZSh0LGUsaSxuKXtpJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiBpJiYobj1pKTt2YXIgcj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBpP2k6dm9pZCAwLHM9bmV3IEoodCxlLG4pO3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gJGUoKGZ1bmN0aW9uKCl7cmV0dXJuIHN9KSxyKSh0KX19ZnVuY3Rpb24gVmUodCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PS0xKSxmdW5jdGlvbihlKXtyZXR1cm4gZS5saWZ0KG5ldyBHZSh0LGUpKX19dmFyIEdlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe3RoaXMuY291bnQ9dCx0aGlzLnNvdXJjZT1lfXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyBxZSh0LHRoaXMuY291bnQsdGhpcy5zb3VyY2UpKX0sdH0oKSxxZT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSxuKXt2YXIgcj10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gci5jb3VudD1pLHIuc291cmNlPW4scn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLmVycm9yPWZ1bmN0aW9uKGUpe2lmKCF0aGlzLmlzU3RvcHBlZCl7dmFyIGk9dGhpcy5zb3VyY2Usbj10aGlzLmNvdW50O2lmKDA9PT1uKXJldHVybiB0LnByb3RvdHlwZS5lcnJvci5jYWxsKHRoaXMsZSk7bj4tMSYmKHRoaXMuY291bnQ9bi0xKSxpLnN1YnNjcmliZSh0aGlzLl91bnN1YnNjcmliZUFuZFJlY3ljbGUoKSl9fSxlfShmKTt2YXIgV2U9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMubm90aWZpZXI9dH1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3ZhciBpPW5ldyBYZSh0KSxuPWUuc3Vic2NyaWJlKGkpO3JldHVybiBuLmFkZChTdCh0aGlzLm5vdGlmaWVyLG5ldyB4dChpKSkpLG59LHR9KCksWGU9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZSgpe3ZhciBlPW51bGwhPT10JiZ0LmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpcztyZXR1cm4gZS5oYXNWYWx1ZT0hMSxlfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dGhpcy52YWx1ZT10LHRoaXMuaGFzVmFsdWU9ITB9LGUucHJvdG90eXBlLm5vdGlmeU5leHQ9ZnVuY3Rpb24oKXt0aGlzLmVtaXRWYWx1ZSgpfSxlLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMuZW1pdFZhbHVlKCl9LGUucHJvdG90eXBlLmVtaXRWYWx1ZT1mdW5jdGlvbigpe3RoaXMuaGFzVmFsdWUmJih0aGlzLmhhc1ZhbHVlPSExLHRoaXMuZGVzdGluYXRpb24ubmV4dCh0aGlzLnZhbHVlKSl9LGV9KHd0KTtmdW5jdGlvbiBZZSgpe3JldHVybiBuZXcgVH1mdW5jdGlvbiBaZSgpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gRSgpKCRlKFllKSh0KSl9fWZ1bmN0aW9uIEplKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5saWZ0KG5ldyBLZSh0KSl9fXZhciBLZT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy50b3RhbD10fXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyBRZSh0LHRoaXMudG90YWwpKX0sdH0oKSxRZT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSl7dmFyIG49dC5jYWxsKHRoaXMsZSl8fHRoaXM7cmV0dXJuIG4udG90YWw9aSxuLmNvdW50PTAsbn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpeysrdGhpcy5jb3VudD50aGlzLnRvdGFsJiZ0aGlzLmRlc3RpbmF0aW9uLm5leHQodCl9LGV9KGYpO2Z1bmN0aW9uIHRpKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5saWZ0KG5ldyBlaSh0KSl9fXZhciBlaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5wcmVkaWNhdGU9dH1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3JldHVybiBlLnN1YnNjcmliZShuZXcgaWkodCx0aGlzLnByZWRpY2F0ZSkpfSx0fSgpLGlpPWZ1bmN0aW9uKHQpe2Z1bmN0aW9uIGUoZSxpKXt2YXIgbj10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gbi5wcmVkaWNhdGU9aSxuLnNraXBwaW5nPSEwLG4uaW5kZXg9MCxufXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5kZXN0aW5hdGlvbjt0aGlzLnNraXBwaW5nJiZ0aGlzLnRyeUNhbGxQcmVkaWNhdGUodCksdGhpcy5za2lwcGluZ3x8ZS5uZXh0KHQpfSxlLnByb3RvdHlwZS50cnlDYWxsUHJlZGljYXRlPWZ1bmN0aW9uKHQpe3RyeXt2YXIgZT10aGlzLnByZWRpY2F0ZSh0LHRoaXMuaW5kZXgrKyk7dGhpcy5za2lwcGluZz1Cb29sZWFuKGUpfWNhdGNoKHQpe3RoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9fSxlfShmKTtmdW5jdGlvbiBuaSgpe2Zvcih2YXIgdD1bXSxlPTA7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyl0W2VdPWFyZ3VtZW50c1tlXTt2YXIgaT10W3QubGVuZ3RoLTFdO3JldHVybiBqKGkpPyh0LnBvcCgpLGZ1bmN0aW9uKGUpe3JldHVybiBBdCh0LGUsaSl9KTpmdW5jdGlvbihlKXtyZXR1cm4gQXQodCxlKX19ZnVuY3Rpb24gcmkodCxlKXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2Z1bmN0aW9uKGkpe3JldHVybiBpLnBpcGUocmkoKGZ1bmN0aW9uKGksbil7cmV0dXJuIGJ0KHQoaSxuKSkucGlwZShydCgoZnVuY3Rpb24odCxyKXtyZXR1cm4gZShpLHQsbixyKX0pKSl9KSkpfTpmdW5jdGlvbihlKXtyZXR1cm4gZS5saWZ0KG5ldyBzaSh0KSl9fXZhciBzaT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7dGhpcy5wcm9qZWN0PXR9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IG9pKHQsdGhpcy5wcm9qZWN0KSl9LHR9KCksb2k9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGkpe3ZhciBuPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBuLnByb2plY3Q9aSxuLmluZGV4PTAsbn1yZXR1cm4gaShlLHQpLGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe3ZhciBlLGk9dGhpcy5pbmRleCsrO3RyeXtlPXRoaXMucHJvamVjdCh0LGkpfWNhdGNoKHQpe3JldHVybiB2b2lkIHRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9dGhpcy5faW5uZXJTdWIoZSl9LGUucHJvdG90eXBlLl9pbm5lclN1Yj1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmlubmVyU3Vic2NyaXB0aW9uO2UmJmUudW5zdWJzY3JpYmUoKTt2YXIgaT1uZXcgeHQodGhpcyksbj10aGlzLmRlc3RpbmF0aW9uO24uYWRkKGkpLHRoaXMuaW5uZXJTdWJzY3JpcHRpb249U3QodCxpKSx0aGlzLmlubmVyU3Vic2NyaXB0aW9uIT09aSYmbi5hZGQodGhpcy5pbm5lclN1YnNjcmlwdGlvbil9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuaW5uZXJTdWJzY3JpcHRpb247ZSYmIWUuY2xvc2VkfHx0LnByb3RvdHlwZS5fY29tcGxldGUuY2FsbCh0aGlzKSx0aGlzLnVuc3Vic2NyaWJlKCl9LGUucHJvdG90eXBlLl91bnN1YnNjcmliZT1mdW5jdGlvbigpe3RoaXMuaW5uZXJTdWJzY3JpcHRpb249dm9pZCAwfSxlLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZT1mdW5jdGlvbigpe3RoaXMuaW5uZXJTdWJzY3JpcHRpb249dm9pZCAwLHRoaXMuaXNTdG9wcGVkJiZ0LnByb3RvdHlwZS5fY29tcGxldGUuY2FsbCh0aGlzKX0sZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbih0KXt0aGlzLmRlc3RpbmF0aW9uLm5leHQodCl9LGV9KHd0KTtmdW5jdGlvbiBhaSh0KXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIGUubGlmdChuZXcgY2kodCkpfX12YXIgY2k9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQpe3RoaXMubm90aWZpZXI9dH1yZXR1cm4gdC5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbih0LGUpe3ZhciBpPW5ldyBoaSh0KSxuPVN0KHRoaXMubm90aWZpZXIsbmV3IHh0KGkpKTtyZXR1cm4gbiYmIWkuc2VlblZhbHVlPyhpLmFkZChuKSxlLnN1YnNjcmliZShpKSk6aX0sdH0oKSxoaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUpe3ZhciBpPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBpLnNlZW5WYWx1ZT0hMSxpfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbigpe3RoaXMuc2VlblZhbHVlPSEwLHRoaXMuY29tcGxldGUoKX0sZS5wcm90b3R5cGUubm90aWZ5Q29tcGxldGU9ZnVuY3Rpb24oKXt9LGV9KHd0KTtmdW5jdGlvbiBsaSh0LGUpe3JldHVybiB2b2lkIDA9PT1lJiYoZT0hMSksZnVuY3Rpb24oaSl7cmV0dXJuIGkubGlmdChuZXcgdWkodCxlKSl9fXZhciB1aT1mdW5jdGlvbigpe2Z1bmN0aW9uIHQodCxlKXt0aGlzLnByZWRpY2F0ZT10LHRoaXMuaW5jbHVzaXZlPWV9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IGRpKHQsdGhpcy5wcmVkaWNhdGUsdGhpcy5pbmNsdXNpdmUpKX0sdH0oKSxkaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSxuKXt2YXIgcj10LmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gci5wcmVkaWNhdGU9aSxyLmluY2x1c2l2ZT1uLHIuaW5kZXg9MCxyfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dmFyIGUsaT10aGlzLmRlc3RpbmF0aW9uO3RyeXtlPXRoaXMucHJlZGljYXRlKHQsdGhpcy5pbmRleCsrKX1jYXRjaCh0KXtyZXR1cm4gdm9pZCBpLmVycm9yKHQpfXRoaXMubmV4dE9yQ29tcGxldGUodCxlKX0sZS5wcm90b3R5cGUubmV4dE9yQ29tcGxldGU9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLmRlc3RpbmF0aW9uO0Jvb2xlYW4oZSk/aS5uZXh0KHQpOih0aGlzLmluY2x1c2l2ZSYmaS5uZXh0KHQpLGkuY29tcGxldGUoKSl9LGV9KGYpO2Z1bmN0aW9uIHBpKHQsZSxpKXtyZXR1cm4gZnVuY3Rpb24obil7cmV0dXJuIG4ubGlmdChuZXcgZmkodCxlLGkpKX19dmFyIGZpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSl7dGhpcy5uZXh0T3JPYnNlcnZlcj10LHRoaXMuZXJyb3I9ZSx0aGlzLmNvbXBsZXRlPWl9cmV0dXJuIHQucHJvdG90eXBlLmNhbGw9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZS5zdWJzY3JpYmUobmV3IG1pKHQsdGhpcy5uZXh0T3JPYnNlcnZlcix0aGlzLmVycm9yLHRoaXMuY29tcGxldGUpKX0sdH0oKSxtaT1mdW5jdGlvbih0KXtmdW5jdGlvbiBlKGUsaSxyLHMpe3ZhciBvPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBvLl90YXBOZXh0PXR0LG8uX3RhcEVycm9yPXR0LG8uX3RhcENvbXBsZXRlPXR0LG8uX3RhcEVycm9yPXJ8fHR0LG8uX3RhcENvbXBsZXRlPXN8fHR0LG4oaSk/KG8uX2NvbnRleHQ9byxvLl90YXBOZXh0PWkpOmkmJihvLl9jb250ZXh0PWksby5fdGFwTmV4dD1pLm5leHR8fHR0LG8uX3RhcEVycm9yPWkuZXJyb3J8fHR0LG8uX3RhcENvbXBsZXRlPWkuY29tcGxldGV8fHR0KSxvfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUuX25leHQ9ZnVuY3Rpb24odCl7dHJ5e3RoaXMuX3RhcE5leHQuY2FsbCh0aGlzLl9jb250ZXh0LHQpfWNhdGNoKHQpe3JldHVybiB2b2lkIHRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9dGhpcy5kZXN0aW5hdGlvbi5uZXh0KHQpfSxlLnByb3RvdHlwZS5fZXJyb3I9ZnVuY3Rpb24odCl7dHJ5e3RoaXMuX3RhcEVycm9yLmNhbGwodGhpcy5fY29udGV4dCx0KX1jYXRjaCh0KXtyZXR1cm4gdm9pZCB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKHQpfXRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9LGUucHJvdG90eXBlLl9jb21wbGV0ZT1mdW5jdGlvbigpe3RyeXt0aGlzLl90YXBDb21wbGV0ZS5jYWxsKHRoaXMuX2NvbnRleHQpfWNhdGNoKHQpe3JldHVybiB2b2lkIHRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9cmV0dXJuIHRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKX0sZX0oZik7ZnVuY3Rpb24gZ2kodCxlLGkpe3JldHVybiB2b2lkIDA9PT1pJiYoaT1RKSxmdW5jdGlvbihuKXt2YXIgcixzPShyPXQpaW5zdGFuY2VvZiBEYXRlJiYhaXNOYU4oK3IpLG89cz8rdC1pLm5vdygpOk1hdGguYWJzKHQpO3JldHVybiBuLmxpZnQobmV3IF9pKG8scyxlLGkpKX19dmFyIF9pPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSxuKXt0aGlzLndhaXRGb3I9dCx0aGlzLmFic29sdXRlVGltZW91dD1lLHRoaXMud2l0aE9ic2VydmFibGU9aSx0aGlzLnNjaGVkdWxlcj1ufXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyB2aSh0LHRoaXMuYWJzb2x1dGVUaW1lb3V0LHRoaXMud2FpdEZvcix0aGlzLndpdGhPYnNlcnZhYmxlLHRoaXMuc2NoZWR1bGVyKSl9LHR9KCksdmk9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbixyLHMpe3ZhciBvPXQuY2FsbCh0aGlzLGUpfHx0aGlzO3JldHVybiBvLmFic29sdXRlVGltZW91dD1pLG8ud2FpdEZvcj1uLG8ud2l0aE9ic2VydmFibGU9cixvLnNjaGVkdWxlcj1zLG8uc2NoZWR1bGVUaW1lb3V0KCksb31yZXR1cm4gaShlLHQpLGUuZGlzcGF0Y2hUaW1lb3V0PWZ1bmN0aW9uKHQpe3ZhciBlPXQud2l0aE9ic2VydmFibGU7dC5fdW5zdWJzY3JpYmVBbmRSZWN5Y2xlKCksdC5hZGQoU3QoZSxuZXcgeHQodCkpKX0sZS5wcm90b3R5cGUuc2NoZWR1bGVUaW1lb3V0PWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5hY3Rpb247dD90aGlzLmFjdGlvbj10LnNjaGVkdWxlKHRoaXMsdGhpcy53YWl0Rm9yKTp0aGlzLmFkZCh0aGlzLmFjdGlvbj10aGlzLnNjaGVkdWxlci5zY2hlZHVsZShlLmRpc3BhdGNoVGltZW91dCx0aGlzLndhaXRGb3IsdGhpcykpfSxlLnByb3RvdHlwZS5fbmV4dD1mdW5jdGlvbihlKXt0aGlzLmFic29sdXRlVGltZW91dHx8dGhpcy5zY2hlZHVsZVRpbWVvdXQoKSx0LnByb3RvdHlwZS5fbmV4dC5jYWxsKHRoaXMsZSl9LGUucHJvdG90eXBlLl91bnN1YnNjcmliZT1mdW5jdGlvbigpe3RoaXMuYWN0aW9uPXZvaWQgMCx0aGlzLnNjaGVkdWxlcj1udWxsLHRoaXMud2l0aE9ic2VydmFibGU9bnVsbH0sZX0od3QpO2Z1bmN0aW9uIHlpKHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihlPVEpLGdpKHQscShuZXcgbnQpLGUpfWZ1bmN0aW9uIGJpKCl7Zm9yKHZhciB0PVtdLGU9MDtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXRbZV09YXJndW1lbnRzW2VdO3JldHVybiBmdW5jdGlvbihlKXt2YXIgaTtcImZ1bmN0aW9uXCI9PXR5cGVvZiB0W3QubGVuZ3RoLTFdJiYoaT10LnBvcCgpKTt2YXIgbj10O3JldHVybiBlLmxpZnQobmV3IHhpKG4saSkpfX12YXIgeGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSl7dGhpcy5vYnNlcnZhYmxlcz10LHRoaXMucHJvamVjdD1lfXJldHVybiB0LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuc3Vic2NyaWJlKG5ldyB3aSh0LHRoaXMub2JzZXJ2YWJsZXMsdGhpcy5wcm9qZWN0KSl9LHR9KCksd2k9ZnVuY3Rpb24odCl7ZnVuY3Rpb24gZShlLGksbil7dmFyIHI9dC5jYWxsKHRoaXMsZSl8fHRoaXM7ci5vYnNlcnZhYmxlcz1pLHIucHJvamVjdD1uLHIudG9SZXNwb25kPVtdO3ZhciBzPWkubGVuZ3RoO3IudmFsdWVzPW5ldyBBcnJheShzKTtmb3IodmFyIG89MDtvPHM7bysrKXIudG9SZXNwb25kLnB1c2gobyk7Zm9yKG89MDtvPHM7bysrKXt2YXIgYT1pW29dO3IuYWRkKGZ0KHIsYSx2b2lkIDAsbykpfXJldHVybiByfXJldHVybiBpKGUsdCksZS5wcm90b3R5cGUubm90aWZ5TmV4dD1mdW5jdGlvbih0LGUsaSl7dGhpcy52YWx1ZXNbaV09ZTt2YXIgbj10aGlzLnRvUmVzcG9uZDtpZihuLmxlbmd0aD4wKXt2YXIgcj1uLmluZGV4T2YoaSk7LTEhPT1yJiZuLnNwbGljZShyLDEpfX0sZS5wcm90b3R5cGUubm90aWZ5Q29tcGxldGU9ZnVuY3Rpb24oKXt9LGUucHJvdG90eXBlLl9uZXh0PWZ1bmN0aW9uKHQpe2lmKDA9PT10aGlzLnRvUmVzcG9uZC5sZW5ndGgpe3ZhciBlPVt0XS5jb25jYXQodGhpcy52YWx1ZXMpO3RoaXMucHJvamVjdD90aGlzLl90cnlQcm9qZWN0KGUpOnRoaXMuZGVzdGluYXRpb24ubmV4dChlKX19LGUucHJvdG90eXBlLl90cnlQcm9qZWN0PWZ1bmN0aW9uKHQpe3ZhciBlO3RyeXtlPXRoaXMucHJvamVjdC5hcHBseSh0aGlzLHQpfWNhdGNoKHQpe3JldHVybiB2b2lkIHRoaXMuZGVzdGluYXRpb24uZXJyb3IodCl9dGhpcy5kZXN0aW5hdGlvbi5uZXh0KGUpfSxlfShhdCk7Y2xhc3MgU2l7Y3JlYXRlRmlsdGVyKHQpe3JldHVybiBuZXcgRnVuY3Rpb24oXCJub2RlXCIsXCJyZXR1cm4gXCIrdGhpcy5fY29tcGlsZSh0KStcIjtcIil9X2NvbXBpbGUodCl7aWYobnVsbD09dHx8dC5sZW5ndGg8PTEpcmV0dXJuXCJ0cnVlXCI7Y29uc3QgZT10WzBdO3JldHVyblwiKFwiKyhcIj09XCI9PT1lP3RoaXMuX2NvbXBpbGVDb21wYXJpc29uT3AoXCI9PT1cIix0WzFdLHRbMl0sITEpOlwiIT1cIj09PWU/dGhpcy5fY29tcGlsZUNvbXBhcmlzb25PcChcIiE9PVwiLHRbMV0sdFsyXSwhMSk6XCI+XCI9PT1lfHxcIj49XCI9PT1lfHxcIjxcIj09PWV8fFwiPD1cIj09PWU/dGhpcy5fY29tcGlsZUNvbXBhcmlzb25PcChlLHRbMV0sdFsyXSwhMCk6XCJpblwiPT09ZT90aGlzLl9jb21waWxlSW5PcCh0WzFdLHQuc2xpY2UoMikpOlwiIWluXCI9PT1lP3RoaXMuX2NvbXBpbGVOZWdhdGlvbih0aGlzLl9jb21waWxlSW5PcCh0WzFdLHQuc2xpY2UoMikpKTpcImFsbFwiPT09ZT90aGlzLl9jb21waWxlTG9naWNhbE9wKHQuc2xpY2UoMSksXCImJlwiKTpcInRydWVcIikrXCIpXCJ9X2NvbXBhcmUodCxlKXtyZXR1cm4gdDxlPy0xOnQ+ZT8xOjB9X2NvbXBpbGVDb21wYXJpc29uT3AodCxlLGksbil7Y29uc3Qgcj10aGlzLl9jb21waWxlUHJvcGVydHlSZWZlcmVuY2UoZSkscz1KU09OLnN0cmluZ2lmeShpKTtyZXR1cm4obj9cInR5cGVvZiBcIityK1wiPT09dHlwZW9mIFwiK3MrXCImJlwiOlwiXCIpK3IrdCtzfV9jb21waWxlSW5PcCh0LGUpe2NvbnN0IGk9dGhpcy5fY29tcGFyZTtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoZS5zb3J0KGkpKStcIi5pbmRleE9mKFwiK3RoaXMuX2NvbXBpbGVQcm9wZXJ0eVJlZmVyZW5jZSh0KStcIikhPT0tMVwifV9jb21waWxlTG9naWNhbE9wKHQsZSl7Y29uc3QgaT10aGlzLl9jb21waWxlLmJpbmQodGhpcyk7cmV0dXJuIHQubWFwKGkpLmpvaW4oZSl9X2NvbXBpbGVOZWdhdGlvbih0KXtyZXR1cm5cIiEoXCIrdCtcIilcIn1fY29tcGlsZVByb3BlcnR5UmVmZXJlbmNlKHQpe3JldHVyblwibm9kZVtcIitKU09OLnN0cmluZ2lmeSh0KStcIl1cIn19Y29uc3QgTWk9MTAwLFRpPTFlMyxDaT0xMDAxLEVpPTEwMDIsSWk9MTAwMyxBaT0xMDA2LFBpPTEwMDgsUmk9MTAwOSxMaT0xMDEyLE9pPTEwMTQsTmk9MTAxNSxEaT0xMDE2LCRpPTEwMjAsa2k9MTAyMix6aT0xMDIzLEZpPTEwMjYsQmk9MTAyNyxqaT0yMzAwLEhpPTIzMDEsVWk9MjMwMixWaT0yNDAwLEdpPTI0MDEscWk9MjQwMixXaT0yNTAwLFhpPTNlMyxZaT03NjgwLFppPTM1MDQ0LEppPTM1MDQ4LEtpPVwiMzAwIGVzXCI7ZnVuY3Rpb24gUWkoKXt9T2JqZWN0LmFzc2lnbihRaS5wcm90b3R5cGUse2FkZEV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24odCxlKXt2b2lkIDA9PT10aGlzLl9saXN0ZW5lcnMmJih0aGlzLl9saXN0ZW5lcnM9e30pO2NvbnN0IGk9dGhpcy5fbGlzdGVuZXJzO3ZvaWQgMD09PWlbdF0mJihpW3RdPVtdKSwtMT09PWlbdF0uaW5kZXhPZihlKSYmaVt0XS5wdXNoKGUpfSxoYXNFdmVudExpc3RlbmVyOmZ1bmN0aW9uKHQsZSl7aWYodm9pZCAwPT09dGhpcy5fbGlzdGVuZXJzKXJldHVybiExO2NvbnN0IGk9dGhpcy5fbGlzdGVuZXJzO3JldHVybiB2b2lkIDAhPT1pW3RdJiYtMSE9PWlbdF0uaW5kZXhPZihlKX0scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbih0LGUpe2lmKHZvaWQgMD09PXRoaXMuX2xpc3RlbmVycylyZXR1cm47Y29uc3QgaT10aGlzLl9saXN0ZW5lcnNbdF07aWYodm9pZCAwIT09aSl7Y29uc3QgdD1pLmluZGV4T2YoZSk7LTEhPT10JiZpLnNwbGljZSh0LDEpfX0sZGlzcGF0Y2hFdmVudDpmdW5jdGlvbih0KXtpZih2b2lkIDA9PT10aGlzLl9saXN0ZW5lcnMpcmV0dXJuO2NvbnN0IGU9dGhpcy5fbGlzdGVuZXJzW3QudHlwZV07aWYodm9pZCAwIT09ZSl7dC50YXJnZXQ9dGhpcztjb25zdCBpPWUuc2xpY2UoMCk7Zm9yKGxldCBlPTAsbj1pLmxlbmd0aDtlPG47ZSsrKWlbZV0uY2FsbCh0aGlzLHQpfX19KTtjb25zdCB0bj1bXTtmb3IobGV0IHQ9MDt0PDI1Njt0KyspdG5bdF09KHQ8MTY/XCIwXCI6XCJcIikrdC50b1N0cmluZygxNik7bGV0IGVuPTEyMzQ1Njc7Y29uc3Qgbm49e0RFRzJSQUQ6TWF0aC5QSS8xODAsUkFEMkRFRzoxODAvTWF0aC5QSSxnZW5lcmF0ZVVVSUQ6ZnVuY3Rpb24oKXtjb25zdCB0PTQyOTQ5NjcyOTUqTWF0aC5yYW5kb20oKXwwLGU9NDI5NDk2NzI5NSpNYXRoLnJhbmRvbSgpfDAsaT00Mjk0OTY3Mjk1Kk1hdGgucmFuZG9tKCl8MCxuPTQyOTQ5NjcyOTUqTWF0aC5yYW5kb20oKXwwO3JldHVybih0blsyNTUmdF0rdG5bdD4+OCYyNTVdK3RuW3Q+PjE2JjI1NV0rdG5bdD4+MjQmMjU1XStcIi1cIit0blsyNTUmZV0rdG5bZT4+OCYyNTVdK1wiLVwiK3RuW2U+PjE2JjE1fDY0XSt0bltlPj4yNCYyNTVdK1wiLVwiK3RuWzYzJml8MTI4XSt0bltpPj44JjI1NV0rXCItXCIrdG5baT4+MTYmMjU1XSt0bltpPj4yNCYyNTVdK3RuWzI1NSZuXSt0bltuPj44JjI1NV0rdG5bbj4+MTYmMjU1XSt0bltuPj4yNCYyNTVdKS50b1VwcGVyQ2FzZSgpfSxjbGFtcDpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIE1hdGgubWF4KGUsTWF0aC5taW4oaSx0KSl9LGV1Y2xpZGVhbk1vZHVsbzpmdW5jdGlvbih0LGUpe3JldHVybih0JWUrZSklZX0sbWFwTGluZWFyOmZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIG4rKHQtZSkqKHItbikvKGktZSl9LGxlcnA6ZnVuY3Rpb24odCxlLGkpe3JldHVybigxLWkpKnQraSplfSxkYW1wOmZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBubi5sZXJwKHQsZSwxLU1hdGguZXhwKC1pKm4pKX0scGluZ3Bvbmc6ZnVuY3Rpb24odCxlPTEpe3JldHVybiBlLU1hdGguYWJzKG5uLmV1Y2xpZGVhbk1vZHVsbyh0LDIqZSktZSl9LHNtb290aHN0ZXA6ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0PD1lPzA6dD49aT8xOih0PSh0LWUpLyhpLWUpKSp0KigzLTIqdCl9LHNtb290aGVyc3RlcDpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ8PWU/MDp0Pj1pPzE6KHQ9KHQtZSkvKGktZSkpKnQqdCoodCooNip0LTE1KSsxMCl9LHJhbmRJbnQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdCtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqKGUtdCsxKSl9LHJhbmRGbG9hdDpmdW5jdGlvbih0LGUpe3JldHVybiB0K01hdGgucmFuZG9tKCkqKGUtdCl9LHJhbmRGbG9hdFNwcmVhZDpmdW5jdGlvbih0KXtyZXR1cm4gdCooLjUtTWF0aC5yYW5kb20oKSl9LHNlZWRlZFJhbmRvbTpmdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwIT09dCYmKGVuPXQlMjE0NzQ4MzY0NyksZW49MTY4MDcqZW4lMjE0NzQ4MzY0NywoZW4tMSkvMjE0NzQ4MzY0Nn0sZGVnVG9SYWQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQqbm4uREVHMlJBRH0scmFkVG9EZWc6ZnVuY3Rpb24odCl7cmV0dXJuIHQqbm4uUkFEMkRFR30saXNQb3dlck9mVHdvOmZ1bmN0aW9uKHQpe3JldHVybiAwPT0odCZ0LTEpJiYwIT09dH0sY2VpbFBvd2VyT2ZUd286ZnVuY3Rpb24odCl7cmV0dXJuIE1hdGgucG93KDIsTWF0aC5jZWlsKE1hdGgubG9nKHQpL01hdGguTE4yKSl9LGZsb29yUG93ZXJPZlR3bzpmdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5wb3coMixNYXRoLmZsb29yKE1hdGgubG9nKHQpL01hdGguTE4yKSl9LHNldFF1YXRlcm5pb25Gcm9tUHJvcGVyRXVsZXI6ZnVuY3Rpb24odCxlLGksbixyKXtjb25zdCBzPU1hdGguY29zLG89TWF0aC5zaW4sYT1zKGkvMiksYz1vKGkvMiksaD1zKChlK24pLzIpLGw9bygoZStuKS8yKSx1PXMoKGUtbikvMiksZD1vKChlLW4pLzIpLHA9cygobi1lKS8yKSxmPW8oKG4tZSkvMik7c3dpdGNoKHIpe2Nhc2VcIlhZWFwiOnQuc2V0KGEqbCxjKnUsYypkLGEqaCk7YnJlYWs7Y2FzZVwiWVpZXCI6dC5zZXQoYypkLGEqbCxjKnUsYSpoKTticmVhaztjYXNlXCJaWFpcIjp0LnNldChjKnUsYypkLGEqbCxhKmgpO2JyZWFrO2Nhc2VcIlhaWFwiOnQuc2V0KGEqbCxjKmYsYypwLGEqaCk7YnJlYWs7Y2FzZVwiWVhZXCI6dC5zZXQoYypwLGEqbCxjKmYsYSpoKTticmVhaztjYXNlXCJaWVpcIjp0LnNldChjKmYsYypwLGEqbCxhKmgpO2JyZWFrO2RlZmF1bHQ6Y29uc29sZS53YXJuKFwiVEhSRUUuTWF0aFV0aWxzOiAuc2V0UXVhdGVybmlvbkZyb21Qcm9wZXJFdWxlcigpIGVuY291bnRlcmVkIGFuIHVua25vd24gb3JkZXI6IFwiK3IpfX19O2NsYXNzIHJue2NvbnN0cnVjdG9yKHQ9MCxlPTApe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLFwiaXNWZWN0b3IyXCIse3ZhbHVlOiEwfSksdGhpcy54PXQsdGhpcy55PWV9Z2V0IHdpZHRoKCl7cmV0dXJuIHRoaXMueH1zZXQgd2lkdGgodCl7dGhpcy54PXR9Z2V0IGhlaWdodCgpe3JldHVybiB0aGlzLnl9c2V0IGhlaWdodCh0KXt0aGlzLnk9dH1zZXQodCxlKXtyZXR1cm4gdGhpcy54PXQsdGhpcy55PWUsdGhpc31zZXRTY2FsYXIodCl7cmV0dXJuIHRoaXMueD10LHRoaXMueT10LHRoaXN9c2V0WCh0KXtyZXR1cm4gdGhpcy54PXQsdGhpc31zZXRZKHQpe3JldHVybiB0aGlzLnk9dCx0aGlzfXNldENvbXBvbmVudCh0LGUpe3N3aXRjaCh0KXtjYXNlIDA6dGhpcy54PWU7YnJlYWs7Y2FzZSAxOnRoaXMueT1lO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiaW5kZXggaXMgb3V0IG9mIHJhbmdlOiBcIit0KX1yZXR1cm4gdGhpc31nZXRDb21wb25lbnQodCl7c3dpdGNoKHQpe2Nhc2UgMDpyZXR1cm4gdGhpcy54O2Nhc2UgMTpyZXR1cm4gdGhpcy55O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiaW5kZXggaXMgb3V0IG9mIHJhbmdlOiBcIit0KX19Y2xvbmUoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LHRoaXMueSl9Y29weSh0KXtyZXR1cm4gdGhpcy54PXQueCx0aGlzLnk9dC55LHRoaXN9YWRkKHQsZSl7cmV0dXJuIHZvaWQgMCE9PWU/KGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjI6IC5hZGQoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5hZGRWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC5cIiksdGhpcy5hZGRWZWN0b3JzKHQsZSkpOih0aGlzLngrPXQueCx0aGlzLnkrPXQueSx0aGlzKX1hZGRTY2FsYXIodCl7cmV0dXJuIHRoaXMueCs9dCx0aGlzLnkrPXQsdGhpc31hZGRWZWN0b3JzKHQsZSl7cmV0dXJuIHRoaXMueD10LngrZS54LHRoaXMueT10LnkrZS55LHRoaXN9YWRkU2NhbGVkVmVjdG9yKHQsZSl7cmV0dXJuIHRoaXMueCs9dC54KmUsdGhpcy55Kz10LnkqZSx0aGlzfXN1Yih0LGUpe3JldHVybiB2b2lkIDAhPT1lPyhjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3IyOiAuc3ViKCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAuc3ViVmVjdG9ycyggYSwgYiApIGluc3RlYWQuXCIpLHRoaXMuc3ViVmVjdG9ycyh0LGUpKToodGhpcy54LT10LngsdGhpcy55LT10LnksdGhpcyl9c3ViU2NhbGFyKHQpe3JldHVybiB0aGlzLngtPXQsdGhpcy55LT10LHRoaXN9c3ViVmVjdG9ycyh0LGUpe3JldHVybiB0aGlzLng9dC54LWUueCx0aGlzLnk9dC55LWUueSx0aGlzfW11bHRpcGx5KHQpe3JldHVybiB0aGlzLngqPXQueCx0aGlzLnkqPXQueSx0aGlzfW11bHRpcGx5U2NhbGFyKHQpe3JldHVybiB0aGlzLngqPXQsdGhpcy55Kj10LHRoaXN9ZGl2aWRlKHQpe3JldHVybiB0aGlzLngvPXQueCx0aGlzLnkvPXQueSx0aGlzfWRpdmlkZVNjYWxhcih0KXtyZXR1cm4gdGhpcy5tdWx0aXBseVNjYWxhcigxL3QpfWFwcGx5TWF0cml4Myh0KXtjb25zdCBlPXRoaXMueCxpPXRoaXMueSxuPXQuZWxlbWVudHM7cmV0dXJuIHRoaXMueD1uWzBdKmUrblszXSppK25bNl0sdGhpcy55PW5bMV0qZStuWzRdKmkrbls3XSx0aGlzfW1pbih0KXtyZXR1cm4gdGhpcy54PU1hdGgubWluKHRoaXMueCx0LngpLHRoaXMueT1NYXRoLm1pbih0aGlzLnksdC55KSx0aGlzfW1heCh0KXtyZXR1cm4gdGhpcy54PU1hdGgubWF4KHRoaXMueCx0LngpLHRoaXMueT1NYXRoLm1heCh0aGlzLnksdC55KSx0aGlzfWNsYW1wKHQsZSl7cmV0dXJuIHRoaXMueD1NYXRoLm1heCh0LngsTWF0aC5taW4oZS54LHRoaXMueCkpLHRoaXMueT1NYXRoLm1heCh0LnksTWF0aC5taW4oZS55LHRoaXMueSkpLHRoaXN9Y2xhbXBTY2FsYXIodCxlKXtyZXR1cm4gdGhpcy54PU1hdGgubWF4KHQsTWF0aC5taW4oZSx0aGlzLngpKSx0aGlzLnk9TWF0aC5tYXgodCxNYXRoLm1pbihlLHRoaXMueSkpLHRoaXN9Y2xhbXBMZW5ndGgodCxlKXtjb25zdCBpPXRoaXMubGVuZ3RoKCk7cmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKGl8fDEpLm11bHRpcGx5U2NhbGFyKE1hdGgubWF4KHQsTWF0aC5taW4oZSxpKSkpfWZsb29yKCl7cmV0dXJuIHRoaXMueD1NYXRoLmZsb29yKHRoaXMueCksdGhpcy55PU1hdGguZmxvb3IodGhpcy55KSx0aGlzfWNlaWwoKXtyZXR1cm4gdGhpcy54PU1hdGguY2VpbCh0aGlzLngpLHRoaXMueT1NYXRoLmNlaWwodGhpcy55KSx0aGlzfXJvdW5kKCl7cmV0dXJuIHRoaXMueD1NYXRoLnJvdW5kKHRoaXMueCksdGhpcy55PU1hdGgucm91bmQodGhpcy55KSx0aGlzfXJvdW5kVG9aZXJvKCl7cmV0dXJuIHRoaXMueD10aGlzLng8MD9NYXRoLmNlaWwodGhpcy54KTpNYXRoLmZsb29yKHRoaXMueCksdGhpcy55PXRoaXMueTwwP01hdGguY2VpbCh0aGlzLnkpOk1hdGguZmxvb3IodGhpcy55KSx0aGlzfW5lZ2F0ZSgpe3JldHVybiB0aGlzLng9LXRoaXMueCx0aGlzLnk9LXRoaXMueSx0aGlzfWRvdCh0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55fWNyb3NzKHQpe3JldHVybiB0aGlzLngqdC55LXRoaXMueSp0Lnh9bGVuZ3RoU3EoKXtyZXR1cm4gdGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55fWxlbmd0aCgpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55KX1tYW5oYXR0YW5MZW5ndGgoKXtyZXR1cm4gTWF0aC5hYnModGhpcy54KStNYXRoLmFicyh0aGlzLnkpfW5vcm1hbGl6ZSgpe3JldHVybiB0aGlzLmRpdmlkZVNjYWxhcih0aGlzLmxlbmd0aCgpfHwxKX1hbmdsZSgpe3JldHVybiBNYXRoLmF0YW4yKC10aGlzLnksLXRoaXMueCkrTWF0aC5QSX1kaXN0YW5jZVRvKHQpe3JldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0YW5jZVRvU3F1YXJlZCh0KSl9ZGlzdGFuY2VUb1NxdWFyZWQodCl7Y29uc3QgZT10aGlzLngtdC54LGk9dGhpcy55LXQueTtyZXR1cm4gZSplK2kqaX1tYW5oYXR0YW5EaXN0YW5jZVRvKHQpe3JldHVybiBNYXRoLmFicyh0aGlzLngtdC54KStNYXRoLmFicyh0aGlzLnktdC55KX1zZXRMZW5ndGgodCl7cmV0dXJuIHRoaXMubm9ybWFsaXplKCkubXVsdGlwbHlTY2FsYXIodCl9bGVycCh0LGUpe3JldHVybiB0aGlzLngrPSh0LngtdGhpcy54KSplLHRoaXMueSs9KHQueS10aGlzLnkpKmUsdGhpc31sZXJwVmVjdG9ycyh0LGUsaSl7cmV0dXJuIHRoaXMueD10LngrKGUueC10LngpKmksdGhpcy55PXQueSsoZS55LXQueSkqaSx0aGlzfWVxdWFscyh0KXtyZXR1cm4gdC54PT09dGhpcy54JiZ0Lnk9PT10aGlzLnl9ZnJvbUFycmF5KHQsZT0wKXtyZXR1cm4gdGhpcy54PXRbZV0sdGhpcy55PXRbZSsxXSx0aGlzfXRvQXJyYXkodD1bXSxlPTApe3JldHVybiB0W2VdPXRoaXMueCx0W2UrMV09dGhpcy55LHR9ZnJvbUJ1ZmZlckF0dHJpYnV0ZSh0LGUsaSl7cmV0dXJuIHZvaWQgMCE9PWkmJmNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjI6IG9mZnNldCBoYXMgYmVlbiByZW1vdmVkIGZyb20gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS5cIiksdGhpcy54PXQuZ2V0WChlKSx0aGlzLnk9dC5nZXRZKGUpLHRoaXN9cm90YXRlQXJvdW5kKHQsZSl7Y29uc3QgaT1NYXRoLmNvcyhlKSxuPU1hdGguc2luKGUpLHI9dGhpcy54LXQueCxzPXRoaXMueS10Lnk7cmV0dXJuIHRoaXMueD1yKmktcypuK3QueCx0aGlzLnk9cipuK3MqaSt0LnksdGhpc31yYW5kb20oKXtyZXR1cm4gdGhpcy54PU1hdGgucmFuZG9tKCksdGhpcy55PU1hdGgucmFuZG9tKCksdGhpc319Y2xhc3Mgc257Y29uc3RydWN0b3IoKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzTWF0cml4M1wiLHt2YWx1ZTohMH0pLHRoaXMuZWxlbWVudHM9WzEsMCwwLDAsMSwwLDAsMCwxXSxhcmd1bWVudHMubGVuZ3RoPjAmJmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5NYXRyaXgzOiB0aGUgY29uc3RydWN0b3Igbm8gbG9uZ2VyIHJlYWRzIGFyZ3VtZW50cy4gdXNlIC5zZXQoKSBpbnN0ZWFkLlwiKX1zZXQodCxlLGksbixyLHMsbyxhLGMpe2NvbnN0IGg9dGhpcy5lbGVtZW50cztyZXR1cm4gaFswXT10LGhbMV09bixoWzJdPW8saFszXT1lLGhbNF09cixoWzVdPWEsaFs2XT1pLGhbN109cyxoWzhdPWMsdGhpc31pZGVudGl0eSgpe3JldHVybiB0aGlzLnNldCgxLDAsMCwwLDEsMCwwLDAsMSksdGhpc31jbG9uZSgpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuZnJvbUFycmF5KHRoaXMuZWxlbWVudHMpfWNvcHkodCl7Y29uc3QgZT10aGlzLmVsZW1lbnRzLGk9dC5lbGVtZW50cztyZXR1cm4gZVswXT1pWzBdLGVbMV09aVsxXSxlWzJdPWlbMl0sZVszXT1pWzNdLGVbNF09aVs0XSxlWzVdPWlbNV0sZVs2XT1pWzZdLGVbN109aVs3XSxlWzhdPWlbOF0sdGhpc31leHRyYWN0QmFzaXModCxlLGkpe3JldHVybiB0LnNldEZyb21NYXRyaXgzQ29sdW1uKHRoaXMsMCksZS5zZXRGcm9tTWF0cml4M0NvbHVtbih0aGlzLDEpLGkuc2V0RnJvbU1hdHJpeDNDb2x1bW4odGhpcywyKSx0aGlzfXNldEZyb21NYXRyaXg0KHQpe2NvbnN0IGU9dC5lbGVtZW50cztyZXR1cm4gdGhpcy5zZXQoZVswXSxlWzRdLGVbOF0sZVsxXSxlWzVdLGVbOV0sZVsyXSxlWzZdLGVbMTBdKSx0aGlzfW11bHRpcGx5KHQpe3JldHVybiB0aGlzLm11bHRpcGx5TWF0cmljZXModGhpcyx0KX1wcmVtdWx0aXBseSh0KXtyZXR1cm4gdGhpcy5tdWx0aXBseU1hdHJpY2VzKHQsdGhpcyl9bXVsdGlwbHlNYXRyaWNlcyh0LGUpe2NvbnN0IGk9dC5lbGVtZW50cyxuPWUuZWxlbWVudHMscj10aGlzLmVsZW1lbnRzLHM9aVswXSxvPWlbM10sYT1pWzZdLGM9aVsxXSxoPWlbNF0sbD1pWzddLHU9aVsyXSxkPWlbNV0scD1pWzhdLGY9blswXSxtPW5bM10sZz1uWzZdLF89blsxXSx2PW5bNF0seT1uWzddLGI9blsyXSx4PW5bNV0sdz1uWzhdO3JldHVybiByWzBdPXMqZitvKl8rYSpiLHJbM109cyptK28qdithKngscls2XT1zKmcrbyp5K2EqdyxyWzFdPWMqZitoKl8rbCpiLHJbNF09YyptK2gqditsKngscls3XT1jKmcraCp5K2wqdyxyWzJdPXUqZitkKl8rcCpiLHJbNV09dSptK2QqditwKngscls4XT11KmcrZCp5K3Aqdyx0aGlzfW11bHRpcGx5U2NhbGFyKHQpe2NvbnN0IGU9dGhpcy5lbGVtZW50cztyZXR1cm4gZVswXSo9dCxlWzNdKj10LGVbNl0qPXQsZVsxXSo9dCxlWzRdKj10LGVbN10qPXQsZVsyXSo9dCxlWzVdKj10LGVbOF0qPXQsdGhpc31kZXRlcm1pbmFudCgpe2NvbnN0IHQ9dGhpcy5lbGVtZW50cyxlPXRbMF0saT10WzFdLG49dFsyXSxyPXRbM10scz10WzRdLG89dFs1XSxhPXRbNl0sYz10WzddLGg9dFs4XTtyZXR1cm4gZSpzKmgtZSpvKmMtaSpyKmgraSpvKmErbipyKmMtbipzKmF9aW52ZXJ0KCl7Y29uc3QgdD10aGlzLmVsZW1lbnRzLGU9dFswXSxpPXRbMV0sbj10WzJdLHI9dFszXSxzPXRbNF0sbz10WzVdLGE9dFs2XSxjPXRbN10saD10WzhdLGw9aCpzLW8qYyx1PW8qYS1oKnIsZD1jKnItcyphLHA9ZSpsK2kqdStuKmQ7aWYoMD09PXApcmV0dXJuIHRoaXMuc2V0KDAsMCwwLDAsMCwwLDAsMCwwKTtjb25zdCBmPTEvcDtyZXR1cm4gdFswXT1sKmYsdFsxXT0obipjLWgqaSkqZix0WzJdPShvKmktbipzKSpmLHRbM109dSpmLHRbNF09KGgqZS1uKmEpKmYsdFs1XT0obipyLW8qZSkqZix0WzZdPWQqZix0WzddPShpKmEtYyplKSpmLHRbOF09KHMqZS1pKnIpKmYsdGhpc310cmFuc3Bvc2UoKXtsZXQgdDtjb25zdCBlPXRoaXMuZWxlbWVudHM7cmV0dXJuIHQ9ZVsxXSxlWzFdPWVbM10sZVszXT10LHQ9ZVsyXSxlWzJdPWVbNl0sZVs2XT10LHQ9ZVs1XSxlWzVdPWVbN10sZVs3XT10LHRoaXN9Z2V0Tm9ybWFsTWF0cml4KHQpe3JldHVybiB0aGlzLnNldEZyb21NYXRyaXg0KHQpLmNvcHkodGhpcykuaW52ZXJ0KCkudHJhbnNwb3NlKCl9dHJhbnNwb3NlSW50b0FycmF5KHQpe2NvbnN0IGU9dGhpcy5lbGVtZW50cztyZXR1cm4gdFswXT1lWzBdLHRbMV09ZVszXSx0WzJdPWVbNl0sdFszXT1lWzFdLHRbNF09ZVs0XSx0WzVdPWVbN10sdFs2XT1lWzJdLHRbN109ZVs1XSx0WzhdPWVbOF0sdGhpc31zZXRVdlRyYW5zZm9ybSh0LGUsaSxuLHIscyxvKXtjb25zdCBhPU1hdGguY29zKHIpLGM9TWF0aC5zaW4ocik7cmV0dXJuIHRoaXMuc2V0KGkqYSxpKmMsLWkqKGEqcytjKm8pK3MrdCwtbipjLG4qYSwtbiooLWMqcythKm8pK28rZSwwLDAsMSksdGhpc31zY2FsZSh0LGUpe2NvbnN0IGk9dGhpcy5lbGVtZW50cztyZXR1cm4gaVswXSo9dCxpWzNdKj10LGlbNl0qPXQsaVsxXSo9ZSxpWzRdKj1lLGlbN10qPWUsdGhpc31yb3RhdGUodCl7Y29uc3QgZT1NYXRoLmNvcyh0KSxpPU1hdGguc2luKHQpLG49dGhpcy5lbGVtZW50cyxyPW5bMF0scz1uWzNdLG89bls2XSxhPW5bMV0sYz1uWzRdLGg9bls3XTtyZXR1cm4gblswXT1lKnIraSphLG5bM109ZSpzK2kqYyxuWzZdPWUqbytpKmgsblsxXT0taSpyK2UqYSxuWzRdPS1pKnMrZSpjLG5bN109LWkqbytlKmgsdGhpc310cmFuc2xhdGUodCxlKXtjb25zdCBpPXRoaXMuZWxlbWVudHM7cmV0dXJuIGlbMF0rPXQqaVsyXSxpWzNdKz10KmlbNV0saVs2XSs9dCppWzhdLGlbMV0rPWUqaVsyXSxpWzRdKz1lKmlbNV0saVs3XSs9ZSppWzhdLHRoaXN9ZXF1YWxzKHQpe2NvbnN0IGU9dGhpcy5lbGVtZW50cyxpPXQuZWxlbWVudHM7Zm9yKGxldCB0PTA7dDw5O3QrKylpZihlW3RdIT09aVt0XSlyZXR1cm4hMTtyZXR1cm4hMH1mcm9tQXJyYXkodCxlPTApe2ZvcihsZXQgaT0wO2k8OTtpKyspdGhpcy5lbGVtZW50c1tpXT10W2krZV07cmV0dXJuIHRoaXN9dG9BcnJheSh0PVtdLGU9MCl7Y29uc3QgaT10aGlzLmVsZW1lbnRzO3JldHVybiB0W2VdPWlbMF0sdFtlKzFdPWlbMV0sdFtlKzJdPWlbMl0sdFtlKzNdPWlbM10sdFtlKzRdPWlbNF0sdFtlKzVdPWlbNV0sdFtlKzZdPWlbNl0sdFtlKzddPWlbN10sdFtlKzhdPWlbOF0sdH19bGV0IG9uO2NvbnN0IGFuPXtnZXREYXRhVVJMOmZ1bmN0aW9uKHQpe2lmKC9eZGF0YTovaS50ZXN0KHQuc3JjKSlyZXR1cm4gdC5zcmM7aWYoXCJ1bmRlZmluZWRcIj09dHlwZW9mIEhUTUxDYW52YXNFbGVtZW50KXJldHVybiB0LnNyYztsZXQgZTtpZih0IGluc3RhbmNlb2YgSFRNTENhbnZhc0VsZW1lbnQpZT10O2Vsc2V7dm9pZCAwPT09b24mJihvbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIsXCJjYW52YXNcIikpLG9uLndpZHRoPXQud2lkdGgsb24uaGVpZ2h0PXQuaGVpZ2h0O2NvbnN0IGk9b24uZ2V0Q29udGV4dChcIjJkXCIpO3QgaW5zdGFuY2VvZiBJbWFnZURhdGE/aS5wdXRJbWFnZURhdGEodCwwLDApOmkuZHJhd0ltYWdlKHQsMCwwLHQud2lkdGgsdC5oZWlnaHQpLGU9b259cmV0dXJuIGUud2lkdGg+MjA0OHx8ZS5oZWlnaHQ+MjA0OD9lLnRvRGF0YVVSTChcImltYWdlL2pwZWdcIiwuNik6ZS50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIil9fTtsZXQgY249MDtmdW5jdGlvbiBobih0PWhuLkRFRkFVTFRfSU1BR0UsZT1obi5ERUZBVUxUX01BUFBJTkcsaT0xMDAxLG49MTAwMSxyPTEwMDYscz0xMDA4LG89MTAyMyxhPTEwMDksYz0xLGg9M2UzKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlkXCIse3ZhbHVlOmNuKyt9KSx0aGlzLnV1aWQ9bm4uZ2VuZXJhdGVVVUlEKCksdGhpcy5uYW1lPVwiXCIsdGhpcy5pbWFnZT10LHRoaXMubWlwbWFwcz1bXSx0aGlzLm1hcHBpbmc9ZSx0aGlzLndyYXBTPWksdGhpcy53cmFwVD1uLHRoaXMubWFnRmlsdGVyPXIsdGhpcy5taW5GaWx0ZXI9cyx0aGlzLmFuaXNvdHJvcHk9Yyx0aGlzLmZvcm1hdD1vLHRoaXMuaW50ZXJuYWxGb3JtYXQ9bnVsbCx0aGlzLnR5cGU9YSx0aGlzLm9mZnNldD1uZXcgcm4oMCwwKSx0aGlzLnJlcGVhdD1uZXcgcm4oMSwxKSx0aGlzLmNlbnRlcj1uZXcgcm4oMCwwKSx0aGlzLnJvdGF0aW9uPTAsdGhpcy5tYXRyaXhBdXRvVXBkYXRlPSEwLHRoaXMubWF0cml4PW5ldyBzbix0aGlzLmdlbmVyYXRlTWlwbWFwcz0hMCx0aGlzLnByZW11bHRpcGx5QWxwaGE9ITEsdGhpcy5mbGlwWT0hMCx0aGlzLnVucGFja0FsaWdubWVudD00LHRoaXMuZW5jb2Rpbmc9aCx0aGlzLnZlcnNpb249MCx0aGlzLm9uVXBkYXRlPW51bGx9ZnVuY3Rpb24gbG4odCl7cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIEhUTUxJbWFnZUVsZW1lbnQmJnQgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50fHxcInVuZGVmaW5lZFwiIT10eXBlb2YgSFRNTENhbnZhc0VsZW1lbnQmJnQgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudHx8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIEltYWdlQml0bWFwJiZ0IGluc3RhbmNlb2YgSW1hZ2VCaXRtYXA/YW4uZ2V0RGF0YVVSTCh0KTp0LmRhdGE/e2RhdGE6QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodC5kYXRhKSx3aWR0aDp0LndpZHRoLGhlaWdodDp0LmhlaWdodCx0eXBlOnQuZGF0YS5jb25zdHJ1Y3Rvci5uYW1lfTooY29uc29sZS53YXJuKFwiVEhSRUUuVGV4dHVyZTogVW5hYmxlIHRvIHNlcmlhbGl6ZSBUZXh0dXJlLlwiKSx7fSl9aG4uREVGQVVMVF9JTUFHRT12b2lkIDAsaG4uREVGQVVMVF9NQVBQSU5HPTMwMCxobi5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKFFpLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOmhuLGlzVGV4dHVyZTohMCx1cGRhdGVNYXRyaXg6ZnVuY3Rpb24oKXt0aGlzLm1hdHJpeC5zZXRVdlRyYW5zZm9ybSh0aGlzLm9mZnNldC54LHRoaXMub2Zmc2V0LnksdGhpcy5yZXBlYXQueCx0aGlzLnJlcGVhdC55LHRoaXMucm90YXRpb24sdGhpcy5jZW50ZXIueCx0aGlzLmNlbnRlci55KX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4obmV3IHRoaXMuY29uc3RydWN0b3IpLmNvcHkodGhpcyl9LGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubmFtZT10Lm5hbWUsdGhpcy5pbWFnZT10LmltYWdlLHRoaXMubWlwbWFwcz10Lm1pcG1hcHMuc2xpY2UoMCksdGhpcy5tYXBwaW5nPXQubWFwcGluZyx0aGlzLndyYXBTPXQud3JhcFMsdGhpcy53cmFwVD10LndyYXBULHRoaXMubWFnRmlsdGVyPXQubWFnRmlsdGVyLHRoaXMubWluRmlsdGVyPXQubWluRmlsdGVyLHRoaXMuYW5pc290cm9weT10LmFuaXNvdHJvcHksdGhpcy5mb3JtYXQ9dC5mb3JtYXQsdGhpcy5pbnRlcm5hbEZvcm1hdD10LmludGVybmFsRm9ybWF0LHRoaXMudHlwZT10LnR5cGUsdGhpcy5vZmZzZXQuY29weSh0Lm9mZnNldCksdGhpcy5yZXBlYXQuY29weSh0LnJlcGVhdCksdGhpcy5jZW50ZXIuY29weSh0LmNlbnRlciksdGhpcy5yb3RhdGlvbj10LnJvdGF0aW9uLHRoaXMubWF0cml4QXV0b1VwZGF0ZT10Lm1hdHJpeEF1dG9VcGRhdGUsdGhpcy5tYXRyaXguY29weSh0Lm1hdHJpeCksdGhpcy5nZW5lcmF0ZU1pcG1hcHM9dC5nZW5lcmF0ZU1pcG1hcHMsdGhpcy5wcmVtdWx0aXBseUFscGhhPXQucHJlbXVsdGlwbHlBbHBoYSx0aGlzLmZsaXBZPXQuZmxpcFksdGhpcy51bnBhY2tBbGlnbm1lbnQ9dC51bnBhY2tBbGlnbm1lbnQsdGhpcy5lbmNvZGluZz10LmVuY29kaW5nLHRoaXN9LHRvSlNPTjpmdW5jdGlvbih0KXtjb25zdCBlPXZvaWQgMD09PXR8fFwic3RyaW5nXCI9PXR5cGVvZiB0O2lmKCFlJiZ2b2lkIDAhPT10LnRleHR1cmVzW3RoaXMudXVpZF0pcmV0dXJuIHQudGV4dHVyZXNbdGhpcy51dWlkXTtjb25zdCBpPXttZXRhZGF0YTp7dmVyc2lvbjo0LjUsdHlwZTpcIlRleHR1cmVcIixnZW5lcmF0b3I6XCJUZXh0dXJlLnRvSlNPTlwifSx1dWlkOnRoaXMudXVpZCxuYW1lOnRoaXMubmFtZSxtYXBwaW5nOnRoaXMubWFwcGluZyxyZXBlYXQ6W3RoaXMucmVwZWF0LngsdGhpcy5yZXBlYXQueV0sb2Zmc2V0Olt0aGlzLm9mZnNldC54LHRoaXMub2Zmc2V0LnldLGNlbnRlcjpbdGhpcy5jZW50ZXIueCx0aGlzLmNlbnRlci55XSxyb3RhdGlvbjp0aGlzLnJvdGF0aW9uLHdyYXA6W3RoaXMud3JhcFMsdGhpcy53cmFwVF0sZm9ybWF0OnRoaXMuZm9ybWF0LHR5cGU6dGhpcy50eXBlLGVuY29kaW5nOnRoaXMuZW5jb2RpbmcsbWluRmlsdGVyOnRoaXMubWluRmlsdGVyLG1hZ0ZpbHRlcjp0aGlzLm1hZ0ZpbHRlcixhbmlzb3Ryb3B5OnRoaXMuYW5pc290cm9weSxmbGlwWTp0aGlzLmZsaXBZLHByZW11bHRpcGx5QWxwaGE6dGhpcy5wcmVtdWx0aXBseUFscGhhLHVucGFja0FsaWdubWVudDp0aGlzLnVucGFja0FsaWdubWVudH07aWYodm9pZCAwIT09dGhpcy5pbWFnZSl7Y29uc3Qgbj10aGlzLmltYWdlO2lmKHZvaWQgMD09PW4udXVpZCYmKG4udXVpZD1ubi5nZW5lcmF0ZVVVSUQoKSksIWUmJnZvaWQgMD09PXQuaW1hZ2VzW24udXVpZF0pe2xldCBlO2lmKEFycmF5LmlzQXJyYXkobikpe2U9W107Zm9yKGxldCB0PTAsaT1uLmxlbmd0aDt0PGk7dCsrKW5bdF0uaXNEYXRhVGV4dHVyZT9lLnB1c2gobG4oblt0XS5pbWFnZSkpOmUucHVzaChsbihuW3RdKSl9ZWxzZSBlPWxuKG4pO3QuaW1hZ2VzW24udXVpZF09e3V1aWQ6bi51dWlkLHVybDplfX1pLmltYWdlPW4udXVpZH1yZXR1cm4gZXx8KHQudGV4dHVyZXNbdGhpcy51dWlkXT1pKSxpfSxkaXNwb3NlOmZ1bmN0aW9uKCl7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOlwiZGlzcG9zZVwifSl9LHRyYW5zZm9ybVV2OmZ1bmN0aW9uKHQpe2lmKDMwMCE9PXRoaXMubWFwcGluZylyZXR1cm4gdDtpZih0LmFwcGx5TWF0cml4Myh0aGlzLm1hdHJpeCksdC54PDB8fHQueD4xKXN3aXRjaCh0aGlzLndyYXBTKXtjYXNlIFRpOnQueD10LngtTWF0aC5mbG9vcih0LngpO2JyZWFrO2Nhc2UgQ2k6dC54PXQueDwwPzA6MTticmVhaztjYXNlIEVpOjE9PT1NYXRoLmFicyhNYXRoLmZsb29yKHQueCklMik/dC54PU1hdGguY2VpbCh0LngpLXQueDp0Lng9dC54LU1hdGguZmxvb3IodC54KX1pZih0Lnk8MHx8dC55PjEpc3dpdGNoKHRoaXMud3JhcFQpe2Nhc2UgVGk6dC55PXQueS1NYXRoLmZsb29yKHQueSk7YnJlYWs7Y2FzZSBDaTp0Lnk9dC55PDA/MDoxO2JyZWFrO2Nhc2UgRWk6MT09PU1hdGguYWJzKE1hdGguZmxvb3IodC55KSUyKT90Lnk9TWF0aC5jZWlsKHQueSktdC55OnQueT10LnktTWF0aC5mbG9vcih0LnkpfXJldHVybiB0aGlzLmZsaXBZJiYodC55PTEtdC55KSx0fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShobi5wcm90b3R5cGUsXCJuZWVkc1VwZGF0ZVwiLHtzZXQ6ZnVuY3Rpb24odCl7ITA9PT10JiZ0aGlzLnZlcnNpb24rK319KTtjbGFzcyB1bntjb25zdHJ1Y3Rvcih0PTAsZT0wLGk9MCxuPTEpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLFwiaXNWZWN0b3I0XCIse3ZhbHVlOiEwfSksdGhpcy54PXQsdGhpcy55PWUsdGhpcy56PWksdGhpcy53PW59Z2V0IHdpZHRoKCl7cmV0dXJuIHRoaXMuen1zZXQgd2lkdGgodCl7dGhpcy56PXR9Z2V0IGhlaWdodCgpe3JldHVybiB0aGlzLnd9c2V0IGhlaWdodCh0KXt0aGlzLnc9dH1zZXQodCxlLGksbil7cmV0dXJuIHRoaXMueD10LHRoaXMueT1lLHRoaXMuej1pLHRoaXMudz1uLHRoaXN9c2V0U2NhbGFyKHQpe3JldHVybiB0aGlzLng9dCx0aGlzLnk9dCx0aGlzLno9dCx0aGlzLnc9dCx0aGlzfXNldFgodCl7cmV0dXJuIHRoaXMueD10LHRoaXN9c2V0WSh0KXtyZXR1cm4gdGhpcy55PXQsdGhpc31zZXRaKHQpe3JldHVybiB0aGlzLno9dCx0aGlzfXNldFcodCl7cmV0dXJuIHRoaXMudz10LHRoaXN9c2V0Q29tcG9uZW50KHQsZSl7c3dpdGNoKHQpe2Nhc2UgMDp0aGlzLng9ZTticmVhaztjYXNlIDE6dGhpcy55PWU7YnJlYWs7Y2FzZSAyOnRoaXMuej1lO2JyZWFrO2Nhc2UgMzp0aGlzLnc9ZTticmVhaztkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcImluZGV4IGlzIG91dCBvZiByYW5nZTogXCIrdCl9cmV0dXJuIHRoaXN9Z2V0Q29tcG9uZW50KHQpe3N3aXRjaCh0KXtjYXNlIDA6cmV0dXJuIHRoaXMueDtjYXNlIDE6cmV0dXJuIHRoaXMueTtjYXNlIDI6cmV0dXJuIHRoaXMuejtjYXNlIDM6cmV0dXJuIHRoaXMudztkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcImluZGV4IGlzIG91dCBvZiByYW5nZTogXCIrdCl9fWNsb25lKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMueCx0aGlzLnksdGhpcy56LHRoaXMudyl9Y29weSh0KXtyZXR1cm4gdGhpcy54PXQueCx0aGlzLnk9dC55LHRoaXMuej10LnosdGhpcy53PXZvaWQgMCE9PXQudz90Lnc6MSx0aGlzfWFkZCh0LGUpe3JldHVybiB2b2lkIDAhPT1lPyhjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3I0OiAuYWRkKCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAuYWRkVmVjdG9ycyggYSwgYiApIGluc3RlYWQuXCIpLHRoaXMuYWRkVmVjdG9ycyh0LGUpKToodGhpcy54Kz10LngsdGhpcy55Kz10LnksdGhpcy56Kz10LnosdGhpcy53Kz10LncsdGhpcyl9YWRkU2NhbGFyKHQpe3JldHVybiB0aGlzLngrPXQsdGhpcy55Kz10LHRoaXMueis9dCx0aGlzLncrPXQsdGhpc31hZGRWZWN0b3JzKHQsZSl7cmV0dXJuIHRoaXMueD10LngrZS54LHRoaXMueT10LnkrZS55LHRoaXMuej10LnorZS56LHRoaXMudz10LncrZS53LHRoaXN9YWRkU2NhbGVkVmVjdG9yKHQsZSl7cmV0dXJuIHRoaXMueCs9dC54KmUsdGhpcy55Kz10LnkqZSx0aGlzLnorPXQueiplLHRoaXMudys9dC53KmUsdGhpc31zdWIodCxlKXtyZXR1cm4gdm9pZCAwIT09ZT8oY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yNDogLnN1YigpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLnN1YlZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLlwiKSx0aGlzLnN1YlZlY3RvcnModCxlKSk6KHRoaXMueC09dC54LHRoaXMueS09dC55LHRoaXMuei09dC56LHRoaXMudy09dC53LHRoaXMpfXN1YlNjYWxhcih0KXtyZXR1cm4gdGhpcy54LT10LHRoaXMueS09dCx0aGlzLnotPXQsdGhpcy53LT10LHRoaXN9c3ViVmVjdG9ycyh0LGUpe3JldHVybiB0aGlzLng9dC54LWUueCx0aGlzLnk9dC55LWUueSx0aGlzLno9dC56LWUueix0aGlzLnc9dC53LWUudyx0aGlzfW11bHRpcGx5KHQpe3JldHVybiB0aGlzLngqPXQueCx0aGlzLnkqPXQueSx0aGlzLnoqPXQueix0aGlzLncqPXQudyx0aGlzfW11bHRpcGx5U2NhbGFyKHQpe3JldHVybiB0aGlzLngqPXQsdGhpcy55Kj10LHRoaXMueio9dCx0aGlzLncqPXQsdGhpc31hcHBseU1hdHJpeDQodCl7Y29uc3QgZT10aGlzLngsaT10aGlzLnksbj10aGlzLnoscj10aGlzLncscz10LmVsZW1lbnRzO3JldHVybiB0aGlzLng9c1swXSplK3NbNF0qaStzWzhdKm4rc1sxMl0qcix0aGlzLnk9c1sxXSplK3NbNV0qaStzWzldKm4rc1sxM10qcix0aGlzLno9c1syXSplK3NbNl0qaStzWzEwXSpuK3NbMTRdKnIsdGhpcy53PXNbM10qZStzWzddKmkrc1sxMV0qbitzWzE1XSpyLHRoaXN9ZGl2aWRlU2NhbGFyKHQpe3JldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKDEvdCl9c2V0QXhpc0FuZ2xlRnJvbVF1YXRlcm5pb24odCl7dGhpcy53PTIqTWF0aC5hY29zKHQudyk7Y29uc3QgZT1NYXRoLnNxcnQoMS10LncqdC53KTtyZXR1cm4gZTwxZS00Pyh0aGlzLng9MSx0aGlzLnk9MCx0aGlzLno9MCk6KHRoaXMueD10LngvZSx0aGlzLnk9dC55L2UsdGhpcy56PXQuei9lKSx0aGlzfXNldEF4aXNBbmdsZUZyb21Sb3RhdGlvbk1hdHJpeCh0KXtsZXQgZSxpLG4scjtjb25zdCBzPS4wMSxvPS4xLGE9dC5lbGVtZW50cyxjPWFbMF0saD1hWzRdLGw9YVs4XSx1PWFbMV0sZD1hWzVdLHA9YVs5XSxmPWFbMl0sbT1hWzZdLGc9YVsxMF07aWYoTWF0aC5hYnMoaC11KTxzJiZNYXRoLmFicyhsLWYpPHMmJk1hdGguYWJzKHAtbSk8cyl7aWYoTWF0aC5hYnMoaCt1KTxvJiZNYXRoLmFicyhsK2YpPG8mJk1hdGguYWJzKHArbSk8byYmTWF0aC5hYnMoYytkK2ctMyk8bylyZXR1cm4gdGhpcy5zZXQoMSwwLDAsMCksdGhpcztlPU1hdGguUEk7Y29uc3QgdD0oYysxKS8yLGE9KGQrMSkvMixfPShnKzEpLzIsdj0oaCt1KS80LHk9KGwrZikvNCxiPShwK20pLzQ7cmV0dXJuIHQ+YSYmdD5fP3Q8cz8oaT0wLG49LjcwNzEwNjc4MSxyPS43MDcxMDY3ODEpOihpPU1hdGguc3FydCh0KSxuPXYvaSxyPXkvaSk6YT5fP2E8cz8oaT0uNzA3MTA2NzgxLG49MCxyPS43MDcxMDY3ODEpOihuPU1hdGguc3FydChhKSxpPXYvbixyPWIvbik6XzxzPyhpPS43MDcxMDY3ODEsbj0uNzA3MTA2NzgxLHI9MCk6KHI9TWF0aC5zcXJ0KF8pLGk9eS9yLG49Yi9yKSx0aGlzLnNldChpLG4scixlKSx0aGlzfWxldCBfPU1hdGguc3FydCgobS1wKSoobS1wKSsobC1mKSoobC1mKSsodS1oKSoodS1oKSk7cmV0dXJuIE1hdGguYWJzKF8pPC4wMDEmJihfPTEpLHRoaXMueD0obS1wKS9fLHRoaXMueT0obC1mKS9fLHRoaXMuej0odS1oKS9fLHRoaXMudz1NYXRoLmFjb3MoKGMrZCtnLTEpLzIpLHRoaXN9bWluKHQpe3JldHVybiB0aGlzLng9TWF0aC5taW4odGhpcy54LHQueCksdGhpcy55PU1hdGgubWluKHRoaXMueSx0LnkpLHRoaXMuej1NYXRoLm1pbih0aGlzLnosdC56KSx0aGlzLnc9TWF0aC5taW4odGhpcy53LHQudyksdGhpc31tYXgodCl7cmV0dXJuIHRoaXMueD1NYXRoLm1heCh0aGlzLngsdC54KSx0aGlzLnk9TWF0aC5tYXgodGhpcy55LHQueSksdGhpcy56PU1hdGgubWF4KHRoaXMueix0LnopLHRoaXMudz1NYXRoLm1heCh0aGlzLncsdC53KSx0aGlzfWNsYW1wKHQsZSl7cmV0dXJuIHRoaXMueD1NYXRoLm1heCh0LngsTWF0aC5taW4oZS54LHRoaXMueCkpLHRoaXMueT1NYXRoLm1heCh0LnksTWF0aC5taW4oZS55LHRoaXMueSkpLHRoaXMuej1NYXRoLm1heCh0LnosTWF0aC5taW4oZS56LHRoaXMueikpLHRoaXMudz1NYXRoLm1heCh0LncsTWF0aC5taW4oZS53LHRoaXMudykpLHRoaXN9Y2xhbXBTY2FsYXIodCxlKXtyZXR1cm4gdGhpcy54PU1hdGgubWF4KHQsTWF0aC5taW4oZSx0aGlzLngpKSx0aGlzLnk9TWF0aC5tYXgodCxNYXRoLm1pbihlLHRoaXMueSkpLHRoaXMuej1NYXRoLm1heCh0LE1hdGgubWluKGUsdGhpcy56KSksdGhpcy53PU1hdGgubWF4KHQsTWF0aC5taW4oZSx0aGlzLncpKSx0aGlzfWNsYW1wTGVuZ3RoKHQsZSl7Y29uc3QgaT10aGlzLmxlbmd0aCgpO3JldHVybiB0aGlzLmRpdmlkZVNjYWxhcihpfHwxKS5tdWx0aXBseVNjYWxhcihNYXRoLm1heCh0LE1hdGgubWluKGUsaSkpKX1mbG9vcigpe3JldHVybiB0aGlzLng9TWF0aC5mbG9vcih0aGlzLngpLHRoaXMueT1NYXRoLmZsb29yKHRoaXMueSksdGhpcy56PU1hdGguZmxvb3IodGhpcy56KSx0aGlzLnc9TWF0aC5mbG9vcih0aGlzLncpLHRoaXN9Y2VpbCgpe3JldHVybiB0aGlzLng9TWF0aC5jZWlsKHRoaXMueCksdGhpcy55PU1hdGguY2VpbCh0aGlzLnkpLHRoaXMuej1NYXRoLmNlaWwodGhpcy56KSx0aGlzLnc9TWF0aC5jZWlsKHRoaXMudyksdGhpc31yb3VuZCgpe3JldHVybiB0aGlzLng9TWF0aC5yb3VuZCh0aGlzLngpLHRoaXMueT1NYXRoLnJvdW5kKHRoaXMueSksdGhpcy56PU1hdGgucm91bmQodGhpcy56KSx0aGlzLnc9TWF0aC5yb3VuZCh0aGlzLncpLHRoaXN9cm91bmRUb1plcm8oKXtyZXR1cm4gdGhpcy54PXRoaXMueDwwP01hdGguY2VpbCh0aGlzLngpOk1hdGguZmxvb3IodGhpcy54KSx0aGlzLnk9dGhpcy55PDA/TWF0aC5jZWlsKHRoaXMueSk6TWF0aC5mbG9vcih0aGlzLnkpLHRoaXMuej10aGlzLno8MD9NYXRoLmNlaWwodGhpcy56KTpNYXRoLmZsb29yKHRoaXMueiksdGhpcy53PXRoaXMudzwwP01hdGguY2VpbCh0aGlzLncpOk1hdGguZmxvb3IodGhpcy53KSx0aGlzfW5lZ2F0ZSgpe3JldHVybiB0aGlzLng9LXRoaXMueCx0aGlzLnk9LXRoaXMueSx0aGlzLno9LXRoaXMueix0aGlzLnc9LXRoaXMudyx0aGlzfWRvdCh0KXtyZXR1cm4gdGhpcy54KnQueCt0aGlzLnkqdC55K3RoaXMueip0LnordGhpcy53KnQud31sZW5ndGhTcSgpe3JldHVybiB0aGlzLngqdGhpcy54K3RoaXMueSp0aGlzLnkrdGhpcy56KnRoaXMueit0aGlzLncqdGhpcy53fWxlbmd0aCgpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55K3RoaXMueip0aGlzLnordGhpcy53KnRoaXMudyl9bWFuaGF0dGFuTGVuZ3RoKCl7cmV0dXJuIE1hdGguYWJzKHRoaXMueCkrTWF0aC5hYnModGhpcy55KStNYXRoLmFicyh0aGlzLnopK01hdGguYWJzKHRoaXMudyl9bm9ybWFsaXplKCl7cmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKHRoaXMubGVuZ3RoKCl8fDEpfXNldExlbmd0aCh0KXtyZXR1cm4gdGhpcy5ub3JtYWxpemUoKS5tdWx0aXBseVNjYWxhcih0KX1sZXJwKHQsZSl7cmV0dXJuIHRoaXMueCs9KHQueC10aGlzLngpKmUsdGhpcy55Kz0odC55LXRoaXMueSkqZSx0aGlzLnorPSh0LnotdGhpcy56KSplLHRoaXMudys9KHQudy10aGlzLncpKmUsdGhpc31sZXJwVmVjdG9ycyh0LGUsaSl7cmV0dXJuIHRoaXMueD10LngrKGUueC10LngpKmksdGhpcy55PXQueSsoZS55LXQueSkqaSx0aGlzLno9dC56KyhlLnotdC56KSppLHRoaXMudz10LncrKGUudy10LncpKmksdGhpc31lcXVhbHModCl7cmV0dXJuIHQueD09PXRoaXMueCYmdC55PT09dGhpcy55JiZ0Lno9PT10aGlzLnomJnQudz09PXRoaXMud31mcm9tQXJyYXkodCxlPTApe3JldHVybiB0aGlzLng9dFtlXSx0aGlzLnk9dFtlKzFdLHRoaXMuej10W2UrMl0sdGhpcy53PXRbZSszXSx0aGlzfXRvQXJyYXkodD1bXSxlPTApe3JldHVybiB0W2VdPXRoaXMueCx0W2UrMV09dGhpcy55LHRbZSsyXT10aGlzLnosdFtlKzNdPXRoaXMudyx0fWZyb21CdWZmZXJBdHRyaWJ1dGUodCxlLGkpe3JldHVybiB2b2lkIDAhPT1pJiZjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3I0OiBvZmZzZXQgaGFzIGJlZW4gcmVtb3ZlZCBmcm9tIC5mcm9tQnVmZmVyQXR0cmlidXRlKCkuXCIpLHRoaXMueD10LmdldFgoZSksdGhpcy55PXQuZ2V0WShlKSx0aGlzLno9dC5nZXRaKGUpLHRoaXMudz10LmdldFcoZSksdGhpc31yYW5kb20oKXtyZXR1cm4gdGhpcy54PU1hdGgucmFuZG9tKCksdGhpcy55PU1hdGgucmFuZG9tKCksdGhpcy56PU1hdGgucmFuZG9tKCksdGhpcy53PU1hdGgucmFuZG9tKCksdGhpc319Y2xhc3MgZG4gZXh0ZW5kcyBRaXtjb25zdHJ1Y3Rvcih0LGUsaSl7c3VwZXIoKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzV2ViR0xSZW5kZXJUYXJnZXRcIix7dmFsdWU6ITB9KSx0aGlzLndpZHRoPXQsdGhpcy5oZWlnaHQ9ZSx0aGlzLnNjaXNzb3I9bmV3IHVuKDAsMCx0LGUpLHRoaXMuc2Npc3NvclRlc3Q9ITEsdGhpcy52aWV3cG9ydD1uZXcgdW4oMCwwLHQsZSksaT1pfHx7fSx0aGlzLnRleHR1cmU9bmV3IGhuKHZvaWQgMCxpLm1hcHBpbmcsaS53cmFwUyxpLndyYXBULGkubWFnRmlsdGVyLGkubWluRmlsdGVyLGkuZm9ybWF0LGkudHlwZSxpLmFuaXNvdHJvcHksaS5lbmNvZGluZyksdGhpcy50ZXh0dXJlLmltYWdlPXt9LHRoaXMudGV4dHVyZS5pbWFnZS53aWR0aD10LHRoaXMudGV4dHVyZS5pbWFnZS5oZWlnaHQ9ZSx0aGlzLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzPXZvaWQgMCE9PWkuZ2VuZXJhdGVNaXBtYXBzJiZpLmdlbmVyYXRlTWlwbWFwcyx0aGlzLnRleHR1cmUubWluRmlsdGVyPXZvaWQgMCE9PWkubWluRmlsdGVyP2kubWluRmlsdGVyOkFpLHRoaXMuZGVwdGhCdWZmZXI9dm9pZCAwPT09aS5kZXB0aEJ1ZmZlcnx8aS5kZXB0aEJ1ZmZlcix0aGlzLnN0ZW5jaWxCdWZmZXI9dm9pZCAwIT09aS5zdGVuY2lsQnVmZmVyJiZpLnN0ZW5jaWxCdWZmZXIsdGhpcy5kZXB0aFRleHR1cmU9dm9pZCAwIT09aS5kZXB0aFRleHR1cmU/aS5kZXB0aFRleHR1cmU6bnVsbH1zZXRTaXplKHQsZSl7dGhpcy53aWR0aD09PXQmJnRoaXMuaGVpZ2h0PT09ZXx8KHRoaXMud2lkdGg9dCx0aGlzLmhlaWdodD1lLHRoaXMudGV4dHVyZS5pbWFnZS53aWR0aD10LHRoaXMudGV4dHVyZS5pbWFnZS5oZWlnaHQ9ZSx0aGlzLmRpc3Bvc2UoKSksdGhpcy52aWV3cG9ydC5zZXQoMCwwLHQsZSksdGhpcy5zY2lzc29yLnNldCgwLDAsdCxlKX1jbG9uZSgpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuY29weSh0aGlzKX1jb3B5KHQpe3JldHVybiB0aGlzLndpZHRoPXQud2lkdGgsdGhpcy5oZWlnaHQ9dC5oZWlnaHQsdGhpcy52aWV3cG9ydC5jb3B5KHQudmlld3BvcnQpLHRoaXMudGV4dHVyZT10LnRleHR1cmUuY2xvbmUoKSx0aGlzLmRlcHRoQnVmZmVyPXQuZGVwdGhCdWZmZXIsdGhpcy5zdGVuY2lsQnVmZmVyPXQuc3RlbmNpbEJ1ZmZlcix0aGlzLmRlcHRoVGV4dHVyZT10LmRlcHRoVGV4dHVyZSx0aGlzfWRpc3Bvc2UoKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6XCJkaXNwb3NlXCJ9KX19Y2xhc3MgcG57Y29uc3RydWN0b3IodD0wLGU9MCxpPTAsbj0xKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzUXVhdGVybmlvblwiLHt2YWx1ZTohMH0pLHRoaXMuX3g9dCx0aGlzLl95PWUsdGhpcy5fej1pLHRoaXMuX3c9bn1zdGF0aWMgc2xlcnAodCxlLGksbil7cmV0dXJuIGkuY29weSh0KS5zbGVycChlLG4pfXN0YXRpYyBzbGVycEZsYXQodCxlLGksbixyLHMsbyl7bGV0IGE9aVtuKzBdLGM9aVtuKzFdLGg9aVtuKzJdLGw9aVtuKzNdO2NvbnN0IHU9cltzKzBdLGQ9cltzKzFdLHA9cltzKzJdLGY9cltzKzNdO2lmKGwhPT1mfHxhIT09dXx8YyE9PWR8fGghPT1wKXtsZXQgdD0xLW87Y29uc3QgZT1hKnUrYypkK2gqcCtsKmYsaT1lPj0wPzE6LTEsbj0xLWUqZTtpZihuPk51bWJlci5FUFNJTE9OKXtjb25zdCByPU1hdGguc3FydChuKSxzPU1hdGguYXRhbjIocixlKmkpO3Q9TWF0aC5zaW4odCpzKS9yLG89TWF0aC5zaW4obypzKS9yfWNvbnN0IHI9byppO2lmKGE9YSp0K3UqcixjPWMqdCtkKnIsaD1oKnQrcCpyLGw9bCp0K2Yqcix0PT09MS1vKXtjb25zdCB0PTEvTWF0aC5zcXJ0KGEqYStjKmMraCpoK2wqbCk7YSo9dCxjKj10LGgqPXQsbCo9dH19dFtlXT1hLHRbZSsxXT1jLHRbZSsyXT1oLHRbZSszXT1sfXN0YXRpYyBtdWx0aXBseVF1YXRlcm5pb25zRmxhdCh0LGUsaSxuLHIscyl7Y29uc3Qgbz1pW25dLGE9aVtuKzFdLGM9aVtuKzJdLGg9aVtuKzNdLGw9cltzXSx1PXJbcysxXSxkPXJbcysyXSxwPXJbcyszXTtyZXR1cm4gdFtlXT1vKnAraCpsK2EqZC1jKnUsdFtlKzFdPWEqcCtoKnUrYypsLW8qZCx0W2UrMl09YypwK2gqZCtvKnUtYSpsLHRbZSszXT1oKnAtbypsLWEqdS1jKmQsdH1nZXQgeCgpe3JldHVybiB0aGlzLl94fXNldCB4KHQpe3RoaXMuX3g9dCx0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCl9Z2V0IHkoKXtyZXR1cm4gdGhpcy5feX1zZXQgeSh0KXt0aGlzLl95PXQsdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpfWdldCB6KCl7cmV0dXJuIHRoaXMuX3p9c2V0IHoodCl7dGhpcy5fej10LHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKX1nZXQgdygpe3JldHVybiB0aGlzLl93fXNldCB3KHQpe3RoaXMuX3c9dCx0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCl9c2V0KHQsZSxpLG4pe3JldHVybiB0aGlzLl94PXQsdGhpcy5feT1lLHRoaXMuX3o9aSx0aGlzLl93PW4sdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9Y2xvbmUoKXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5feCx0aGlzLl95LHRoaXMuX3osdGhpcy5fdyl9Y29weSh0KXtyZXR1cm4gdGhpcy5feD10LngsdGhpcy5feT10LnksdGhpcy5fej10LnosdGhpcy5fdz10LncsdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9c2V0RnJvbUV1bGVyKHQsZSl7aWYoIXR8fCF0LmlzRXVsZXIpdGhyb3cgbmV3IEVycm9yKFwiVEhSRUUuUXVhdGVybmlvbjogLnNldEZyb21FdWxlcigpIG5vdyBleHBlY3RzIGFuIEV1bGVyIHJvdGF0aW9uIHJhdGhlciB0aGFuIGEgVmVjdG9yMyBhbmQgb3JkZXIuXCIpO2NvbnN0IGk9dC5feCxuPXQuX3kscj10Ll96LHM9dC5fb3JkZXIsbz1NYXRoLmNvcyxhPU1hdGguc2luLGM9byhpLzIpLGg9byhuLzIpLGw9byhyLzIpLHU9YShpLzIpLGQ9YShuLzIpLHA9YShyLzIpO3N3aXRjaChzKXtjYXNlXCJYWVpcIjp0aGlzLl94PXUqaCpsK2MqZCpwLHRoaXMuX3k9YypkKmwtdSpoKnAsdGhpcy5fej1jKmgqcCt1KmQqbCx0aGlzLl93PWMqaCpsLXUqZCpwO2JyZWFrO2Nhc2VcIllYWlwiOnRoaXMuX3g9dSpoKmwrYypkKnAsdGhpcy5feT1jKmQqbC11KmgqcCx0aGlzLl96PWMqaCpwLXUqZCpsLHRoaXMuX3c9YypoKmwrdSpkKnA7YnJlYWs7Y2FzZVwiWlhZXCI6dGhpcy5feD11KmgqbC1jKmQqcCx0aGlzLl95PWMqZCpsK3UqaCpwLHRoaXMuX3o9YypoKnArdSpkKmwsdGhpcy5fdz1jKmgqbC11KmQqcDticmVhaztjYXNlXCJaWVhcIjp0aGlzLl94PXUqaCpsLWMqZCpwLHRoaXMuX3k9YypkKmwrdSpoKnAsdGhpcy5fej1jKmgqcC11KmQqbCx0aGlzLl93PWMqaCpsK3UqZCpwO2JyZWFrO2Nhc2VcIllaWFwiOnRoaXMuX3g9dSpoKmwrYypkKnAsdGhpcy5feT1jKmQqbCt1KmgqcCx0aGlzLl96PWMqaCpwLXUqZCpsLHRoaXMuX3c9YypoKmwtdSpkKnA7YnJlYWs7Y2FzZVwiWFpZXCI6dGhpcy5feD11KmgqbC1jKmQqcCx0aGlzLl95PWMqZCpsLXUqaCpwLHRoaXMuX3o9YypoKnArdSpkKmwsdGhpcy5fdz1jKmgqbCt1KmQqcDticmVhaztkZWZhdWx0OmNvbnNvbGUud2FybihcIlRIUkVFLlF1YXRlcm5pb246IC5zZXRGcm9tRXVsZXIoKSBlbmNvdW50ZXJlZCBhbiB1bmtub3duIG9yZGVyOiBcIitzKX1yZXR1cm4hMSE9PWUmJnRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXNldEZyb21BeGlzQW5nbGUodCxlKXtjb25zdCBpPWUvMixuPU1hdGguc2luKGkpO3JldHVybiB0aGlzLl94PXQueCpuLHRoaXMuX3k9dC55Km4sdGhpcy5fej10Lnoqbix0aGlzLl93PU1hdGguY29zKGkpLHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXNldEZyb21Sb3RhdGlvbk1hdHJpeCh0KXtjb25zdCBlPXQuZWxlbWVudHMsaT1lWzBdLG49ZVs0XSxyPWVbOF0scz1lWzFdLG89ZVs1XSxhPWVbOV0sYz1lWzJdLGg9ZVs2XSxsPWVbMTBdLHU9aStvK2w7aWYodT4wKXtjb25zdCB0PS41L01hdGguc3FydCh1KzEpO3RoaXMuX3c9LjI1L3QsdGhpcy5feD0oaC1hKSp0LHRoaXMuX3k9KHItYykqdCx0aGlzLl96PShzLW4pKnR9ZWxzZSBpZihpPm8mJmk+bCl7Y29uc3QgdD0yKk1hdGguc3FydCgxK2ktby1sKTt0aGlzLl93PShoLWEpL3QsdGhpcy5feD0uMjUqdCx0aGlzLl95PShuK3MpL3QsdGhpcy5fej0ocitjKS90fWVsc2UgaWYobz5sKXtjb25zdCB0PTIqTWF0aC5zcXJ0KDErby1pLWwpO3RoaXMuX3c9KHItYykvdCx0aGlzLl94PShuK3MpL3QsdGhpcy5feT0uMjUqdCx0aGlzLl96PShhK2gpL3R9ZWxzZXtjb25zdCB0PTIqTWF0aC5zcXJ0KDErbC1pLW8pO3RoaXMuX3c9KHMtbikvdCx0aGlzLl94PShyK2MpL3QsdGhpcy5feT0oYStoKS90LHRoaXMuX3o9LjI1KnR9cmV0dXJuIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXNldEZyb21Vbml0VmVjdG9ycyh0LGUpe2xldCBpPXQuZG90KGUpKzE7cmV0dXJuIGk8MWUtNj8oaT0wLE1hdGguYWJzKHQueCk+TWF0aC5hYnModC56KT8odGhpcy5feD0tdC55LHRoaXMuX3k9dC54LHRoaXMuX3o9MCx0aGlzLl93PWkpOih0aGlzLl94PTAsdGhpcy5feT0tdC56LHRoaXMuX3o9dC55LHRoaXMuX3c9aSkpOih0aGlzLl94PXQueSplLnotdC56KmUueSx0aGlzLl95PXQueiplLngtdC54KmUueix0aGlzLl96PXQueCplLnktdC55KmUueCx0aGlzLl93PWkpLHRoaXMubm9ybWFsaXplKCl9YW5nbGVUbyh0KXtyZXR1cm4gMipNYXRoLmFjb3MoTWF0aC5hYnMobm4uY2xhbXAodGhpcy5kb3QodCksLTEsMSkpKX1yb3RhdGVUb3dhcmRzKHQsZSl7Y29uc3QgaT10aGlzLmFuZ2xlVG8odCk7aWYoMD09PWkpcmV0dXJuIHRoaXM7Y29uc3Qgbj1NYXRoLm1pbigxLGUvaSk7cmV0dXJuIHRoaXMuc2xlcnAodCxuKSx0aGlzfWlkZW50aXR5KCl7cmV0dXJuIHRoaXMuc2V0KDAsMCwwLDEpfWludmVydCgpe3JldHVybiB0aGlzLmNvbmp1Z2F0ZSgpfWNvbmp1Z2F0ZSgpe3JldHVybiB0aGlzLl94Kj0tMSx0aGlzLl95Kj0tMSx0aGlzLl96Kj0tMSx0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCksdGhpc31kb3QodCl7cmV0dXJuIHRoaXMuX3gqdC5feCt0aGlzLl95KnQuX3krdGhpcy5feip0Ll96K3RoaXMuX3cqdC5fd31sZW5ndGhTcSgpe3JldHVybiB0aGlzLl94KnRoaXMuX3grdGhpcy5feSp0aGlzLl95K3RoaXMuX3oqdGhpcy5feit0aGlzLl93KnRoaXMuX3d9bGVuZ3RoKCl7cmV0dXJuIE1hdGguc3FydCh0aGlzLl94KnRoaXMuX3grdGhpcy5feSp0aGlzLl95K3RoaXMuX3oqdGhpcy5feit0aGlzLl93KnRoaXMuX3cpfW5vcm1hbGl6ZSgpe2xldCB0PXRoaXMubGVuZ3RoKCk7cmV0dXJuIDA9PT10Pyh0aGlzLl94PTAsdGhpcy5feT0wLHRoaXMuX3o9MCx0aGlzLl93PTEpOih0PTEvdCx0aGlzLl94PXRoaXMuX3gqdCx0aGlzLl95PXRoaXMuX3kqdCx0aGlzLl96PXRoaXMuX3oqdCx0aGlzLl93PXRoaXMuX3cqdCksdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9bXVsdGlwbHkodCxlKXtyZXR1cm4gdm9pZCAwIT09ZT8oY29uc29sZS53YXJuKFwiVEhSRUUuUXVhdGVybmlvbjogLm11bHRpcGx5KCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAubXVsdGlwbHlRdWF0ZXJuaW9ucyggYSwgYiApIGluc3RlYWQuXCIpLHRoaXMubXVsdGlwbHlRdWF0ZXJuaW9ucyh0LGUpKTp0aGlzLm11bHRpcGx5UXVhdGVybmlvbnModGhpcyx0KX1wcmVtdWx0aXBseSh0KXtyZXR1cm4gdGhpcy5tdWx0aXBseVF1YXRlcm5pb25zKHQsdGhpcyl9bXVsdGlwbHlRdWF0ZXJuaW9ucyh0LGUpe2NvbnN0IGk9dC5feCxuPXQuX3kscj10Ll96LHM9dC5fdyxvPWUuX3gsYT1lLl95LGM9ZS5feixoPWUuX3c7cmV0dXJuIHRoaXMuX3g9aSpoK3MqbytuKmMtciphLHRoaXMuX3k9bipoK3MqYStyKm8taSpjLHRoaXMuX3o9cipoK3MqYytpKmEtbipvLHRoaXMuX3c9cypoLWkqby1uKmEtcipjLHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXNsZXJwKHQsZSl7aWYoMD09PWUpcmV0dXJuIHRoaXM7aWYoMT09PWUpcmV0dXJuIHRoaXMuY29weSh0KTtjb25zdCBpPXRoaXMuX3gsbj10aGlzLl95LHI9dGhpcy5feixzPXRoaXMuX3c7bGV0IG89cyp0Ll93K2kqdC5feCtuKnQuX3krcip0Ll96O2lmKG88MD8odGhpcy5fdz0tdC5fdyx0aGlzLl94PS10Ll94LHRoaXMuX3k9LXQuX3ksdGhpcy5fej0tdC5feixvPS1vKTp0aGlzLmNvcHkodCksbz49MSlyZXR1cm4gdGhpcy5fdz1zLHRoaXMuX3g9aSx0aGlzLl95PW4sdGhpcy5fej1yLHRoaXM7Y29uc3QgYT0xLW8qbztpZihhPD1OdW1iZXIuRVBTSUxPTil7Y29uc3QgdD0xLWU7cmV0dXJuIHRoaXMuX3c9dCpzK2UqdGhpcy5fdyx0aGlzLl94PXQqaStlKnRoaXMuX3gsdGhpcy5feT10Km4rZSp0aGlzLl95LHRoaXMuX3o9dCpyK2UqdGhpcy5feix0aGlzLm5vcm1hbGl6ZSgpLHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfWNvbnN0IGM9TWF0aC5zcXJ0KGEpLGg9TWF0aC5hdGFuMihjLG8pLGw9TWF0aC5zaW4oKDEtZSkqaCkvYyx1PU1hdGguc2luKGUqaCkvYztyZXR1cm4gdGhpcy5fdz1zKmwrdGhpcy5fdyp1LHRoaXMuX3g9aSpsK3RoaXMuX3gqdSx0aGlzLl95PW4qbCt0aGlzLl95KnUsdGhpcy5fej1yKmwrdGhpcy5feip1LHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfWVxdWFscyh0KXtyZXR1cm4gdC5feD09PXRoaXMuX3gmJnQuX3k9PT10aGlzLl95JiZ0Ll96PT09dGhpcy5feiYmdC5fdz09PXRoaXMuX3d9ZnJvbUFycmF5KHQsZT0wKXtyZXR1cm4gdGhpcy5feD10W2VdLHRoaXMuX3k9dFtlKzFdLHRoaXMuX3o9dFtlKzJdLHRoaXMuX3c9dFtlKzNdLHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXRvQXJyYXkodD1bXSxlPTApe3JldHVybiB0W2VdPXRoaXMuX3gsdFtlKzFdPXRoaXMuX3ksdFtlKzJdPXRoaXMuX3osdFtlKzNdPXRoaXMuX3csdH1mcm9tQnVmZmVyQXR0cmlidXRlKHQsZSl7cmV0dXJuIHRoaXMuX3g9dC5nZXRYKGUpLHRoaXMuX3k9dC5nZXRZKGUpLHRoaXMuX3o9dC5nZXRaKGUpLHRoaXMuX3c9dC5nZXRXKGUpLHRoaXN9X29uQ2hhbmdlKHQpe3JldHVybiB0aGlzLl9vbkNoYW5nZUNhbGxiYWNrPXQsdGhpc31fb25DaGFuZ2VDYWxsYmFjaygpe319Y2xhc3MgZm57Y29uc3RydWN0b3IodD0wLGU9MCxpPTApe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLFwiaXNWZWN0b3IzXCIse3ZhbHVlOiEwfSksdGhpcy54PXQsdGhpcy55PWUsdGhpcy56PWl9c2V0KHQsZSxpKXtyZXR1cm4gdm9pZCAwPT09aSYmKGk9dGhpcy56KSx0aGlzLng9dCx0aGlzLnk9ZSx0aGlzLno9aSx0aGlzfXNldFNjYWxhcih0KXtyZXR1cm4gdGhpcy54PXQsdGhpcy55PXQsdGhpcy56PXQsdGhpc31zZXRYKHQpe3JldHVybiB0aGlzLng9dCx0aGlzfXNldFkodCl7cmV0dXJuIHRoaXMueT10LHRoaXN9c2V0Wih0KXtyZXR1cm4gdGhpcy56PXQsdGhpc31zZXRDb21wb25lbnQodCxlKXtzd2l0Y2godCl7Y2FzZSAwOnRoaXMueD1lO2JyZWFrO2Nhc2UgMTp0aGlzLnk9ZTticmVhaztjYXNlIDI6dGhpcy56PWU7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJpbmRleCBpcyBvdXQgb2YgcmFuZ2U6IFwiK3QpfXJldHVybiB0aGlzfWdldENvbXBvbmVudCh0KXtzd2l0Y2godCl7Y2FzZSAwOnJldHVybiB0aGlzLng7Y2FzZSAxOnJldHVybiB0aGlzLnk7Y2FzZSAyOnJldHVybiB0aGlzLno7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJpbmRleCBpcyBvdXQgb2YgcmFuZ2U6IFwiK3QpfX1jbG9uZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLngsdGhpcy55LHRoaXMueil9Y29weSh0KXtyZXR1cm4gdGhpcy54PXQueCx0aGlzLnk9dC55LHRoaXMuej10LnosdGhpc31hZGQodCxlKXtyZXR1cm4gdm9pZCAwIT09ZT8oY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogLmFkZCgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLmFkZFZlY3RvcnMoIGEsIGIgKSBpbnN0ZWFkLlwiKSx0aGlzLmFkZFZlY3RvcnModCxlKSk6KHRoaXMueCs9dC54LHRoaXMueSs9dC55LHRoaXMueis9dC56LHRoaXMpfWFkZFNjYWxhcih0KXtyZXR1cm4gdGhpcy54Kz10LHRoaXMueSs9dCx0aGlzLnorPXQsdGhpc31hZGRWZWN0b3JzKHQsZSl7cmV0dXJuIHRoaXMueD10LngrZS54LHRoaXMueT10LnkrZS55LHRoaXMuej10LnorZS56LHRoaXN9YWRkU2NhbGVkVmVjdG9yKHQsZSl7cmV0dXJuIHRoaXMueCs9dC54KmUsdGhpcy55Kz10LnkqZSx0aGlzLnorPXQueiplLHRoaXN9c3ViKHQsZSl7cmV0dXJuIHZvaWQgMCE9PWU/KGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjM6IC5zdWIoKSBub3cgb25seSBhY2NlcHRzIG9uZSBhcmd1bWVudC4gVXNlIC5zdWJWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC5cIiksdGhpcy5zdWJWZWN0b3JzKHQsZSkpOih0aGlzLngtPXQueCx0aGlzLnktPXQueSx0aGlzLnotPXQueix0aGlzKX1zdWJTY2FsYXIodCl7cmV0dXJuIHRoaXMueC09dCx0aGlzLnktPXQsdGhpcy56LT10LHRoaXN9c3ViVmVjdG9ycyh0LGUpe3JldHVybiB0aGlzLng9dC54LWUueCx0aGlzLnk9dC55LWUueSx0aGlzLno9dC56LWUueix0aGlzfW11bHRpcGx5KHQsZSl7cmV0dXJuIHZvaWQgMCE9PWU/KGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjM6IC5tdWx0aXBseSgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLm11bHRpcGx5VmVjdG9ycyggYSwgYiApIGluc3RlYWQuXCIpLHRoaXMubXVsdGlwbHlWZWN0b3JzKHQsZSkpOih0aGlzLngqPXQueCx0aGlzLnkqPXQueSx0aGlzLnoqPXQueix0aGlzKX1tdWx0aXBseVNjYWxhcih0KXtyZXR1cm4gdGhpcy54Kj10LHRoaXMueSo9dCx0aGlzLnoqPXQsdGhpc31tdWx0aXBseVZlY3RvcnModCxlKXtyZXR1cm4gdGhpcy54PXQueCplLngsdGhpcy55PXQueSplLnksdGhpcy56PXQueiplLnosdGhpc31hcHBseUV1bGVyKHQpe3JldHVybiB0JiZ0LmlzRXVsZXJ8fGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5WZWN0b3IzOiAuYXBwbHlFdWxlcigpIG5vdyBleHBlY3RzIGFuIEV1bGVyIHJvdGF0aW9uIHJhdGhlciB0aGFuIGEgVmVjdG9yMyBhbmQgb3JkZXIuXCIpLHRoaXMuYXBwbHlRdWF0ZXJuaW9uKGduLnNldEZyb21FdWxlcih0KSl9YXBwbHlBeGlzQW5nbGUodCxlKXtyZXR1cm4gdGhpcy5hcHBseVF1YXRlcm5pb24oZ24uc2V0RnJvbUF4aXNBbmdsZSh0LGUpKX1hcHBseU1hdHJpeDModCl7Y29uc3QgZT10aGlzLngsaT10aGlzLnksbj10aGlzLnoscj10LmVsZW1lbnRzO3JldHVybiB0aGlzLng9clswXSplK3JbM10qaStyWzZdKm4sdGhpcy55PXJbMV0qZStyWzRdKmkrcls3XSpuLHRoaXMuej1yWzJdKmUrcls1XSppK3JbOF0qbix0aGlzfWFwcGx5Tm9ybWFsTWF0cml4KHQpe3JldHVybiB0aGlzLmFwcGx5TWF0cml4Myh0KS5ub3JtYWxpemUoKX1hcHBseU1hdHJpeDQodCl7Y29uc3QgZT10aGlzLngsaT10aGlzLnksbj10aGlzLnoscj10LmVsZW1lbnRzLHM9MS8oclszXSplK3JbN10qaStyWzExXSpuK3JbMTVdKTtyZXR1cm4gdGhpcy54PShyWzBdKmUrcls0XSppK3JbOF0qbityWzEyXSkqcyx0aGlzLnk9KHJbMV0qZStyWzVdKmkrcls5XSpuK3JbMTNdKSpzLHRoaXMuej0oclsyXSplK3JbNl0qaStyWzEwXSpuK3JbMTRdKSpzLHRoaXN9YXBwbHlRdWF0ZXJuaW9uKHQpe2NvbnN0IGU9dGhpcy54LGk9dGhpcy55LG49dGhpcy56LHI9dC54LHM9dC55LG89dC56LGE9dC53LGM9YSplK3Mqbi1vKmksaD1hKmkrbyplLXIqbixsPWEqbityKmktcyplLHU9LXIqZS1zKmktbypuO3JldHVybiB0aGlzLng9YyphK3UqLXIraCotby1sKi1zLHRoaXMueT1oKmErdSotcytsKi1yLWMqLW8sdGhpcy56PWwqYSt1Ki1vK2MqLXMtaCotcix0aGlzfXByb2plY3QodCl7cmV0dXJuIHRoaXMuYXBwbHlNYXRyaXg0KHQubWF0cml4V29ybGRJbnZlcnNlKS5hcHBseU1hdHJpeDQodC5wcm9qZWN0aW9uTWF0cml4KX11bnByb2plY3QodCl7cmV0dXJuIHRoaXMuYXBwbHlNYXRyaXg0KHQucHJvamVjdGlvbk1hdHJpeEludmVyc2UpLmFwcGx5TWF0cml4NCh0Lm1hdHJpeFdvcmxkKX10cmFuc2Zvcm1EaXJlY3Rpb24odCl7Y29uc3QgZT10aGlzLngsaT10aGlzLnksbj10aGlzLnoscj10LmVsZW1lbnRzO3JldHVybiB0aGlzLng9clswXSplK3JbNF0qaStyWzhdKm4sdGhpcy55PXJbMV0qZStyWzVdKmkrcls5XSpuLHRoaXMuej1yWzJdKmUrcls2XSppK3JbMTBdKm4sdGhpcy5ub3JtYWxpemUoKX1kaXZpZGUodCl7cmV0dXJuIHRoaXMueC89dC54LHRoaXMueS89dC55LHRoaXMuei89dC56LHRoaXN9ZGl2aWRlU2NhbGFyKHQpe3JldHVybiB0aGlzLm11bHRpcGx5U2NhbGFyKDEvdCl9bWluKHQpe3JldHVybiB0aGlzLng9TWF0aC5taW4odGhpcy54LHQueCksdGhpcy55PU1hdGgubWluKHRoaXMueSx0LnkpLHRoaXMuej1NYXRoLm1pbih0aGlzLnosdC56KSx0aGlzfW1heCh0KXtyZXR1cm4gdGhpcy54PU1hdGgubWF4KHRoaXMueCx0LngpLHRoaXMueT1NYXRoLm1heCh0aGlzLnksdC55KSx0aGlzLno9TWF0aC5tYXgodGhpcy56LHQueiksdGhpc31jbGFtcCh0LGUpe3JldHVybiB0aGlzLng9TWF0aC5tYXgodC54LE1hdGgubWluKGUueCx0aGlzLngpKSx0aGlzLnk9TWF0aC5tYXgodC55LE1hdGgubWluKGUueSx0aGlzLnkpKSx0aGlzLno9TWF0aC5tYXgodC56LE1hdGgubWluKGUueix0aGlzLnopKSx0aGlzfWNsYW1wU2NhbGFyKHQsZSl7cmV0dXJuIHRoaXMueD1NYXRoLm1heCh0LE1hdGgubWluKGUsdGhpcy54KSksdGhpcy55PU1hdGgubWF4KHQsTWF0aC5taW4oZSx0aGlzLnkpKSx0aGlzLno9TWF0aC5tYXgodCxNYXRoLm1pbihlLHRoaXMueikpLHRoaXN9Y2xhbXBMZW5ndGgodCxlKXtjb25zdCBpPXRoaXMubGVuZ3RoKCk7cmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKGl8fDEpLm11bHRpcGx5U2NhbGFyKE1hdGgubWF4KHQsTWF0aC5taW4oZSxpKSkpfWZsb29yKCl7cmV0dXJuIHRoaXMueD1NYXRoLmZsb29yKHRoaXMueCksdGhpcy55PU1hdGguZmxvb3IodGhpcy55KSx0aGlzLno9TWF0aC5mbG9vcih0aGlzLnopLHRoaXN9Y2VpbCgpe3JldHVybiB0aGlzLng9TWF0aC5jZWlsKHRoaXMueCksdGhpcy55PU1hdGguY2VpbCh0aGlzLnkpLHRoaXMuej1NYXRoLmNlaWwodGhpcy56KSx0aGlzfXJvdW5kKCl7cmV0dXJuIHRoaXMueD1NYXRoLnJvdW5kKHRoaXMueCksdGhpcy55PU1hdGgucm91bmQodGhpcy55KSx0aGlzLno9TWF0aC5yb3VuZCh0aGlzLnopLHRoaXN9cm91bmRUb1plcm8oKXtyZXR1cm4gdGhpcy54PXRoaXMueDwwP01hdGguY2VpbCh0aGlzLngpOk1hdGguZmxvb3IodGhpcy54KSx0aGlzLnk9dGhpcy55PDA/TWF0aC5jZWlsKHRoaXMueSk6TWF0aC5mbG9vcih0aGlzLnkpLHRoaXMuej10aGlzLno8MD9NYXRoLmNlaWwodGhpcy56KTpNYXRoLmZsb29yKHRoaXMueiksdGhpc31uZWdhdGUoKXtyZXR1cm4gdGhpcy54PS10aGlzLngsdGhpcy55PS10aGlzLnksdGhpcy56PS10aGlzLnosdGhpc31kb3QodCl7cmV0dXJuIHRoaXMueCp0LngrdGhpcy55KnQueSt0aGlzLnoqdC56fWxlbmd0aFNxKCl7cmV0dXJuIHRoaXMueCp0aGlzLngrdGhpcy55KnRoaXMueSt0aGlzLnoqdGhpcy56fWxlbmd0aCgpe3JldHVybiBNYXRoLnNxcnQodGhpcy54KnRoaXMueCt0aGlzLnkqdGhpcy55K3RoaXMueip0aGlzLnopfW1hbmhhdHRhbkxlbmd0aCgpe3JldHVybiBNYXRoLmFicyh0aGlzLngpK01hdGguYWJzKHRoaXMueSkrTWF0aC5hYnModGhpcy56KX1ub3JtYWxpemUoKXtyZXR1cm4gdGhpcy5kaXZpZGVTY2FsYXIodGhpcy5sZW5ndGgoKXx8MSl9c2V0TGVuZ3RoKHQpe3JldHVybiB0aGlzLm5vcm1hbGl6ZSgpLm11bHRpcGx5U2NhbGFyKHQpfWxlcnAodCxlKXtyZXR1cm4gdGhpcy54Kz0odC54LXRoaXMueCkqZSx0aGlzLnkrPSh0LnktdGhpcy55KSplLHRoaXMueis9KHQuei10aGlzLnopKmUsdGhpc31sZXJwVmVjdG9ycyh0LGUsaSl7cmV0dXJuIHRoaXMueD10LngrKGUueC10LngpKmksdGhpcy55PXQueSsoZS55LXQueSkqaSx0aGlzLno9dC56KyhlLnotdC56KSppLHRoaXN9Y3Jvc3ModCxlKXtyZXR1cm4gdm9pZCAwIT09ZT8oY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogLmNyb3NzKCkgbm93IG9ubHkgYWNjZXB0cyBvbmUgYXJndW1lbnQuIFVzZSAuY3Jvc3NWZWN0b3JzKCBhLCBiICkgaW5zdGVhZC5cIiksdGhpcy5jcm9zc1ZlY3RvcnModCxlKSk6dGhpcy5jcm9zc1ZlY3RvcnModGhpcyx0KX1jcm9zc1ZlY3RvcnModCxlKXtjb25zdCBpPXQueCxuPXQueSxyPXQueixzPWUueCxvPWUueSxhPWUuejtyZXR1cm4gdGhpcy54PW4qYS1yKm8sdGhpcy55PXIqcy1pKmEsdGhpcy56PWkqby1uKnMsdGhpc31wcm9qZWN0T25WZWN0b3IodCl7Y29uc3QgZT10Lmxlbmd0aFNxKCk7aWYoMD09PWUpcmV0dXJuIHRoaXMuc2V0KDAsMCwwKTtjb25zdCBpPXQuZG90KHRoaXMpL2U7cmV0dXJuIHRoaXMuY29weSh0KS5tdWx0aXBseVNjYWxhcihpKX1wcm9qZWN0T25QbGFuZSh0KXtyZXR1cm4gbW4uY29weSh0aGlzKS5wcm9qZWN0T25WZWN0b3IodCksdGhpcy5zdWIobW4pfXJlZmxlY3QodCl7cmV0dXJuIHRoaXMuc3ViKG1uLmNvcHkodCkubXVsdGlwbHlTY2FsYXIoMip0aGlzLmRvdCh0KSkpfWFuZ2xlVG8odCl7Y29uc3QgZT1NYXRoLnNxcnQodGhpcy5sZW5ndGhTcSgpKnQubGVuZ3RoU3EoKSk7aWYoMD09PWUpcmV0dXJuIE1hdGguUEkvMjtjb25zdCBpPXRoaXMuZG90KHQpL2U7cmV0dXJuIE1hdGguYWNvcyhubi5jbGFtcChpLC0xLDEpKX1kaXN0YW5jZVRvKHQpe3JldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0YW5jZVRvU3F1YXJlZCh0KSl9ZGlzdGFuY2VUb1NxdWFyZWQodCl7Y29uc3QgZT10aGlzLngtdC54LGk9dGhpcy55LXQueSxuPXRoaXMuei10Lno7cmV0dXJuIGUqZStpKmkrbipufW1hbmhhdHRhbkRpc3RhbmNlVG8odCl7cmV0dXJuIE1hdGguYWJzKHRoaXMueC10LngpK01hdGguYWJzKHRoaXMueS10LnkpK01hdGguYWJzKHRoaXMuei10LnopfXNldEZyb21TcGhlcmljYWwodCl7cmV0dXJuIHRoaXMuc2V0RnJvbVNwaGVyaWNhbENvb3Jkcyh0LnJhZGl1cyx0LnBoaSx0LnRoZXRhKX1zZXRGcm9tU3BoZXJpY2FsQ29vcmRzKHQsZSxpKXtjb25zdCBuPU1hdGguc2luKGUpKnQ7cmV0dXJuIHRoaXMueD1uKk1hdGguc2luKGkpLHRoaXMueT1NYXRoLmNvcyhlKSp0LHRoaXMuej1uKk1hdGguY29zKGkpLHRoaXN9c2V0RnJvbUN5bGluZHJpY2FsKHQpe3JldHVybiB0aGlzLnNldEZyb21DeWxpbmRyaWNhbENvb3Jkcyh0LnJhZGl1cyx0LnRoZXRhLHQueSl9c2V0RnJvbUN5bGluZHJpY2FsQ29vcmRzKHQsZSxpKXtyZXR1cm4gdGhpcy54PXQqTWF0aC5zaW4oZSksdGhpcy55PWksdGhpcy56PXQqTWF0aC5jb3MoZSksdGhpc31zZXRGcm9tTWF0cml4UG9zaXRpb24odCl7Y29uc3QgZT10LmVsZW1lbnRzO3JldHVybiB0aGlzLng9ZVsxMl0sdGhpcy55PWVbMTNdLHRoaXMuej1lWzE0XSx0aGlzfXNldEZyb21NYXRyaXhTY2FsZSh0KXtjb25zdCBlPXRoaXMuc2V0RnJvbU1hdHJpeENvbHVtbih0LDApLmxlbmd0aCgpLGk9dGhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKHQsMSkubGVuZ3RoKCksbj10aGlzLnNldEZyb21NYXRyaXhDb2x1bW4odCwyKS5sZW5ndGgoKTtyZXR1cm4gdGhpcy54PWUsdGhpcy55PWksdGhpcy56PW4sdGhpc31zZXRGcm9tTWF0cml4Q29sdW1uKHQsZSl7cmV0dXJuIHRoaXMuZnJvbUFycmF5KHQuZWxlbWVudHMsNCplKX1zZXRGcm9tTWF0cml4M0NvbHVtbih0LGUpe3JldHVybiB0aGlzLmZyb21BcnJheSh0LmVsZW1lbnRzLDMqZSl9ZXF1YWxzKHQpe3JldHVybiB0Lng9PT10aGlzLngmJnQueT09PXRoaXMueSYmdC56PT09dGhpcy56fWZyb21BcnJheSh0LGU9MCl7cmV0dXJuIHRoaXMueD10W2VdLHRoaXMueT10W2UrMV0sdGhpcy56PXRbZSsyXSx0aGlzfXRvQXJyYXkodD1bXSxlPTApe3JldHVybiB0W2VdPXRoaXMueCx0W2UrMV09dGhpcy55LHRbZSsyXT10aGlzLnosdH1mcm9tQnVmZmVyQXR0cmlidXRlKHQsZSxpKXtyZXR1cm4gdm9pZCAwIT09aSYmY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogb2Zmc2V0IGhhcyBiZWVuIHJlbW92ZWQgZnJvbSAuZnJvbUJ1ZmZlckF0dHJpYnV0ZSgpLlwiKSx0aGlzLng9dC5nZXRYKGUpLHRoaXMueT10LmdldFkoZSksdGhpcy56PXQuZ2V0WihlKSx0aGlzfXJhbmRvbSgpe3JldHVybiB0aGlzLng9TWF0aC5yYW5kb20oKSx0aGlzLnk9TWF0aC5yYW5kb20oKSx0aGlzLno9TWF0aC5yYW5kb20oKSx0aGlzfX1jb25zdCBtbj1uZXcgZm4sZ249bmV3IHBuO2NsYXNzIF9ue2NvbnN0cnVjdG9yKHQsZSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpc0JveDNcIix7dmFsdWU6ITB9KSx0aGlzLm1pbj12b2lkIDAhPT10P3Q6bmV3IGZuKDEvMCwxLzAsMS8wKSx0aGlzLm1heD12b2lkIDAhPT1lP2U6bmV3IGZuKC0xLzAsLTEvMCwtMS8wKX1zZXQodCxlKXtyZXR1cm4gdGhpcy5taW4uY29weSh0KSx0aGlzLm1heC5jb3B5KGUpLHRoaXN9c2V0RnJvbUFycmF5KHQpe2xldCBlPTEvMCxpPTEvMCxuPTEvMCxyPS0xLzAscz0tMS8wLG89LTEvMDtmb3IobGV0IGE9MCxjPXQubGVuZ3RoO2E8YzthKz0zKXtjb25zdCBjPXRbYV0saD10W2ErMV0sbD10W2ErMl07YzxlJiYoZT1jKSxoPGkmJihpPWgpLGw8biYmKG49bCksYz5yJiYocj1jKSxoPnMmJihzPWgpLGw+byYmKG89bCl9cmV0dXJuIHRoaXMubWluLnNldChlLGksbiksdGhpcy5tYXguc2V0KHIscyxvKSx0aGlzfXNldEZyb21CdWZmZXJBdHRyaWJ1dGUodCl7bGV0IGU9MS8wLGk9MS8wLG49MS8wLHI9LTEvMCxzPS0xLzAsbz0tMS8wO2ZvcihsZXQgYT0wLGM9dC5jb3VudDthPGM7YSsrKXtjb25zdCBjPXQuZ2V0WChhKSxoPXQuZ2V0WShhKSxsPXQuZ2V0WihhKTtjPGUmJihlPWMpLGg8aSYmKGk9aCksbDxuJiYobj1sKSxjPnImJihyPWMpLGg+cyYmKHM9aCksbD5vJiYobz1sKX1yZXR1cm4gdGhpcy5taW4uc2V0KGUsaSxuKSx0aGlzLm1heC5zZXQocixzLG8pLHRoaXN9c2V0RnJvbVBvaW50cyh0KXt0aGlzLm1ha2VFbXB0eSgpO2ZvcihsZXQgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl0aGlzLmV4cGFuZEJ5UG9pbnQodFtlXSk7cmV0dXJuIHRoaXN9c2V0RnJvbUNlbnRlckFuZFNpemUodCxlKXtjb25zdCBpPWJuLmNvcHkoZSkubXVsdGlwbHlTY2FsYXIoLjUpO3JldHVybiB0aGlzLm1pbi5jb3B5KHQpLnN1YihpKSx0aGlzLm1heC5jb3B5KHQpLmFkZChpKSx0aGlzfXNldEZyb21PYmplY3QodCl7cmV0dXJuIHRoaXMubWFrZUVtcHR5KCksdGhpcy5leHBhbmRCeU9iamVjdCh0KX1jbG9uZSgpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuY29weSh0aGlzKX1jb3B5KHQpe3JldHVybiB0aGlzLm1pbi5jb3B5KHQubWluKSx0aGlzLm1heC5jb3B5KHQubWF4KSx0aGlzfW1ha2VFbXB0eSgpe3JldHVybiB0aGlzLm1pbi54PXRoaXMubWluLnk9dGhpcy5taW4uej0xLzAsdGhpcy5tYXgueD10aGlzLm1heC55PXRoaXMubWF4Lno9LTEvMCx0aGlzfWlzRW1wdHkoKXtyZXR1cm4gdGhpcy5tYXgueDx0aGlzLm1pbi54fHx0aGlzLm1heC55PHRoaXMubWluLnl8fHRoaXMubWF4Lno8dGhpcy5taW4uen1nZXRDZW50ZXIodCl7cmV0dXJuIHZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gzOiAuZ2V0Q2VudGVyKCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSx0PW5ldyBmbiksdGhpcy5pc0VtcHR5KCk/dC5zZXQoMCwwLDApOnQuYWRkVmVjdG9ycyh0aGlzLm1pbix0aGlzLm1heCkubXVsdGlwbHlTY2FsYXIoLjUpfWdldFNpemUodCl7cmV0dXJuIHZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gzOiAuZ2V0U2l6ZSgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgZm4pLHRoaXMuaXNFbXB0eSgpP3Quc2V0KDAsMCwwKTp0LnN1YlZlY3RvcnModGhpcy5tYXgsdGhpcy5taW4pfWV4cGFuZEJ5UG9pbnQodCl7cmV0dXJuIHRoaXMubWluLm1pbih0KSx0aGlzLm1heC5tYXgodCksdGhpc31leHBhbmRCeVZlY3Rvcih0KXtyZXR1cm4gdGhpcy5taW4uc3ViKHQpLHRoaXMubWF4LmFkZCh0KSx0aGlzfWV4cGFuZEJ5U2NhbGFyKHQpe3JldHVybiB0aGlzLm1pbi5hZGRTY2FsYXIoLXQpLHRoaXMubWF4LmFkZFNjYWxhcih0KSx0aGlzfWV4cGFuZEJ5T2JqZWN0KHQpe3QudXBkYXRlV29ybGRNYXRyaXgoITEsITEpO2NvbnN0IGU9dC5nZW9tZXRyeTt2b2lkIDAhPT1lJiYobnVsbD09PWUuYm91bmRpbmdCb3gmJmUuY29tcHV0ZUJvdW5kaW5nQm94KCkseG4uY29weShlLmJvdW5kaW5nQm94KSx4bi5hcHBseU1hdHJpeDQodC5tYXRyaXhXb3JsZCksdGhpcy51bmlvbih4bikpO2NvbnN0IGk9dC5jaGlsZHJlbjtmb3IobGV0IHQ9MCxlPWkubGVuZ3RoO3Q8ZTt0KyspdGhpcy5leHBhbmRCeU9iamVjdChpW3RdKTtyZXR1cm4gdGhpc31jb250YWluc1BvaW50KHQpe3JldHVybiEodC54PHRoaXMubWluLnh8fHQueD50aGlzLm1heC54fHx0Lnk8dGhpcy5taW4ueXx8dC55PnRoaXMubWF4Lnl8fHQuejx0aGlzLm1pbi56fHx0Lno+dGhpcy5tYXgueil9Y29udGFpbnNCb3godCl7cmV0dXJuIHRoaXMubWluLng8PXQubWluLngmJnQubWF4Lng8PXRoaXMubWF4LngmJnRoaXMubWluLnk8PXQubWluLnkmJnQubWF4Lnk8PXRoaXMubWF4LnkmJnRoaXMubWluLno8PXQubWluLnomJnQubWF4Lno8PXRoaXMubWF4Lnp9Z2V0UGFyYW1ldGVyKHQsZSl7cmV0dXJuIHZvaWQgMD09PWUmJihjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gzOiAuZ2V0UGFyYW1ldGVyKCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBmbiksZS5zZXQoKHQueC10aGlzLm1pbi54KS8odGhpcy5tYXgueC10aGlzLm1pbi54KSwodC55LXRoaXMubWluLnkpLyh0aGlzLm1heC55LXRoaXMubWluLnkpLCh0LnotdGhpcy5taW4ueikvKHRoaXMubWF4LnotdGhpcy5taW4ueikpfWludGVyc2VjdHNCb3godCl7cmV0dXJuISh0Lm1heC54PHRoaXMubWluLnh8fHQubWluLng+dGhpcy5tYXgueHx8dC5tYXgueTx0aGlzLm1pbi55fHx0Lm1pbi55PnRoaXMubWF4Lnl8fHQubWF4Lno8dGhpcy5taW4uenx8dC5taW4uej50aGlzLm1heC56KX1pbnRlcnNlY3RzU3BoZXJlKHQpe3JldHVybiB0aGlzLmNsYW1wUG9pbnQodC5jZW50ZXIsYm4pLGJuLmRpc3RhbmNlVG9TcXVhcmVkKHQuY2VudGVyKTw9dC5yYWRpdXMqdC5yYWRpdXN9aW50ZXJzZWN0c1BsYW5lKHQpe2xldCBlLGk7cmV0dXJuIHQubm9ybWFsLng+MD8oZT10Lm5vcm1hbC54KnRoaXMubWluLngsaT10Lm5vcm1hbC54KnRoaXMubWF4LngpOihlPXQubm9ybWFsLngqdGhpcy5tYXgueCxpPXQubm9ybWFsLngqdGhpcy5taW4ueCksdC5ub3JtYWwueT4wPyhlKz10Lm5vcm1hbC55KnRoaXMubWluLnksaSs9dC5ub3JtYWwueSp0aGlzLm1heC55KTooZSs9dC5ub3JtYWwueSp0aGlzLm1heC55LGkrPXQubm9ybWFsLnkqdGhpcy5taW4ueSksdC5ub3JtYWwuej4wPyhlKz10Lm5vcm1hbC56KnRoaXMubWluLnosaSs9dC5ub3JtYWwueip0aGlzLm1heC56KTooZSs9dC5ub3JtYWwueip0aGlzLm1heC56LGkrPXQubm9ybWFsLnoqdGhpcy5taW4ueiksZTw9LXQuY29uc3RhbnQmJmk+PS10LmNvbnN0YW50fWludGVyc2VjdHNUcmlhbmdsZSh0KXtpZih0aGlzLmlzRW1wdHkoKSlyZXR1cm4hMTt0aGlzLmdldENlbnRlcihJbiksQW4uc3ViVmVjdG9ycyh0aGlzLm1heCxJbiksd24uc3ViVmVjdG9ycyh0LmEsSW4pLFNuLnN1YlZlY3RvcnModC5iLEluKSxNbi5zdWJWZWN0b3JzKHQuYyxJbiksVG4uc3ViVmVjdG9ycyhTbix3biksQ24uc3ViVmVjdG9ycyhNbixTbiksRW4uc3ViVmVjdG9ycyh3bixNbik7bGV0IGU9WzAsLVRuLnosVG4ueSwwLC1Dbi56LENuLnksMCwtRW4ueixFbi55LFRuLnosMCwtVG4ueCxDbi56LDAsLUNuLngsRW4ueiwwLC1Fbi54LC1Ubi55LFRuLngsMCwtQ24ueSxDbi54LDAsLUVuLnksRW4ueCwwXTtyZXR1cm4hIXZuKGUsd24sU24sTW4sQW4pJiYoZT1bMSwwLDAsMCwxLDAsMCwwLDFdLCEhdm4oZSx3bixTbixNbixBbikmJihQbi5jcm9zc1ZlY3RvcnMoVG4sQ24pLGU9W1BuLngsUG4ueSxQbi56XSx2bihlLHduLFNuLE1uLEFuKSkpfWNsYW1wUG9pbnQodCxlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGNvbnNvbGUud2FybihcIlRIUkVFLkJveDM6IC5jbGFtcFBvaW50KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBmbiksZS5jb3B5KHQpLmNsYW1wKHRoaXMubWluLHRoaXMubWF4KX1kaXN0YW5jZVRvUG9pbnQodCl7cmV0dXJuIGJuLmNvcHkodCkuY2xhbXAodGhpcy5taW4sdGhpcy5tYXgpLnN1Yih0KS5sZW5ndGgoKX1nZXRCb3VuZGluZ1NwaGVyZSh0KXtyZXR1cm4gdm9pZCAwPT09dCYmY29uc29sZS5lcnJvcihcIlRIUkVFLkJveDM6IC5nZXRCb3VuZGluZ1NwaGVyZSgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdGhpcy5nZXRDZW50ZXIodC5jZW50ZXIpLHQucmFkaXVzPS41KnRoaXMuZ2V0U2l6ZShibikubGVuZ3RoKCksdH1pbnRlcnNlY3QodCl7cmV0dXJuIHRoaXMubWluLm1heCh0Lm1pbiksdGhpcy5tYXgubWluKHQubWF4KSx0aGlzLmlzRW1wdHkoKSYmdGhpcy5tYWtlRW1wdHkoKSx0aGlzfXVuaW9uKHQpe3JldHVybiB0aGlzLm1pbi5taW4odC5taW4pLHRoaXMubWF4Lm1heCh0Lm1heCksdGhpc31hcHBseU1hdHJpeDQodCl7cmV0dXJuIHRoaXMuaXNFbXB0eSgpfHwoeW5bMF0uc2V0KHRoaXMubWluLngsdGhpcy5taW4ueSx0aGlzLm1pbi56KS5hcHBseU1hdHJpeDQodCkseW5bMV0uc2V0KHRoaXMubWluLngsdGhpcy5taW4ueSx0aGlzLm1heC56KS5hcHBseU1hdHJpeDQodCkseW5bMl0uc2V0KHRoaXMubWluLngsdGhpcy5tYXgueSx0aGlzLm1pbi56KS5hcHBseU1hdHJpeDQodCkseW5bM10uc2V0KHRoaXMubWluLngsdGhpcy5tYXgueSx0aGlzLm1heC56KS5hcHBseU1hdHJpeDQodCkseW5bNF0uc2V0KHRoaXMubWF4LngsdGhpcy5taW4ueSx0aGlzLm1pbi56KS5hcHBseU1hdHJpeDQodCkseW5bNV0uc2V0KHRoaXMubWF4LngsdGhpcy5taW4ueSx0aGlzLm1heC56KS5hcHBseU1hdHJpeDQodCkseW5bNl0uc2V0KHRoaXMubWF4LngsdGhpcy5tYXgueSx0aGlzLm1pbi56KS5hcHBseU1hdHJpeDQodCkseW5bN10uc2V0KHRoaXMubWF4LngsdGhpcy5tYXgueSx0aGlzLm1heC56KS5hcHBseU1hdHJpeDQodCksdGhpcy5zZXRGcm9tUG9pbnRzKHluKSksdGhpc310cmFuc2xhdGUodCl7cmV0dXJuIHRoaXMubWluLmFkZCh0KSx0aGlzLm1heC5hZGQodCksdGhpc31lcXVhbHModCl7cmV0dXJuIHQubWluLmVxdWFscyh0aGlzLm1pbikmJnQubWF4LmVxdWFscyh0aGlzLm1heCl9fWZ1bmN0aW9uIHZuKHQsZSxpLG4scil7Zm9yKGxldCBzPTAsbz10Lmxlbmd0aC0zO3M8PW87cys9Myl7Um4uZnJvbUFycmF5KHQscyk7Y29uc3Qgbz1yLngqTWF0aC5hYnMoUm4ueCkrci55Kk1hdGguYWJzKFJuLnkpK3IueipNYXRoLmFicyhSbi56KSxhPWUuZG90KFJuKSxjPWkuZG90KFJuKSxoPW4uZG90KFJuKTtpZihNYXRoLm1heCgtTWF0aC5tYXgoYSxjLGgpLE1hdGgubWluKGEsYyxoKSk+bylyZXR1cm4hMX1yZXR1cm4hMH1jb25zdCB5bj1bbmV3IGZuLG5ldyBmbixuZXcgZm4sbmV3IGZuLG5ldyBmbixuZXcgZm4sbmV3IGZuLG5ldyBmbl0sYm49bmV3IGZuLHhuPW5ldyBfbix3bj1uZXcgZm4sU249bmV3IGZuLE1uPW5ldyBmbixUbj1uZXcgZm4sQ249bmV3IGZuLEVuPW5ldyBmbixJbj1uZXcgZm4sQW49bmV3IGZuLFBuPW5ldyBmbixSbj1uZXcgZm4sTG49bmV3IF9uO2NsYXNzIE9ue2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5jZW50ZXI9dm9pZCAwIT09dD90Om5ldyBmbix0aGlzLnJhZGl1cz12b2lkIDAhPT1lP2U6LTF9c2V0KHQsZSl7cmV0dXJuIHRoaXMuY2VudGVyLmNvcHkodCksdGhpcy5yYWRpdXM9ZSx0aGlzfXNldEZyb21Qb2ludHModCxlKXtjb25zdCBpPXRoaXMuY2VudGVyO3ZvaWQgMCE9PWU/aS5jb3B5KGUpOkxuLnNldEZyb21Qb2ludHModCkuZ2V0Q2VudGVyKGkpO2xldCBuPTA7Zm9yKGxldCBlPTAscj10Lmxlbmd0aDtlPHI7ZSsrKW49TWF0aC5tYXgobixpLmRpc3RhbmNlVG9TcXVhcmVkKHRbZV0pKTtyZXR1cm4gdGhpcy5yYWRpdXM9TWF0aC5zcXJ0KG4pLHRoaXN9Y2xvbmUoKXtyZXR1cm4obmV3IHRoaXMuY29uc3RydWN0b3IpLmNvcHkodGhpcyl9Y29weSh0KXtyZXR1cm4gdGhpcy5jZW50ZXIuY29weSh0LmNlbnRlciksdGhpcy5yYWRpdXM9dC5yYWRpdXMsdGhpc31pc0VtcHR5KCl7cmV0dXJuIHRoaXMucmFkaXVzPDB9bWFrZUVtcHR5KCl7cmV0dXJuIHRoaXMuY2VudGVyLnNldCgwLDAsMCksdGhpcy5yYWRpdXM9LTEsdGhpc31jb250YWluc1BvaW50KHQpe3JldHVybiB0LmRpc3RhbmNlVG9TcXVhcmVkKHRoaXMuY2VudGVyKTw9dGhpcy5yYWRpdXMqdGhpcy5yYWRpdXN9ZGlzdGFuY2VUb1BvaW50KHQpe3JldHVybiB0LmRpc3RhbmNlVG8odGhpcy5jZW50ZXIpLXRoaXMucmFkaXVzfWludGVyc2VjdHNTcGhlcmUodCl7Y29uc3QgZT10aGlzLnJhZGl1cyt0LnJhZGl1cztyZXR1cm4gdC5jZW50ZXIuZGlzdGFuY2VUb1NxdWFyZWQodGhpcy5jZW50ZXIpPD1lKmV9aW50ZXJzZWN0c0JveCh0KXtyZXR1cm4gdC5pbnRlcnNlY3RzU3BoZXJlKHRoaXMpfWludGVyc2VjdHNQbGFuZSh0KXtyZXR1cm4gTWF0aC5hYnModC5kaXN0YW5jZVRvUG9pbnQodGhpcy5jZW50ZXIpKTw9dGhpcy5yYWRpdXN9Y2xhbXBQb2ludCh0LGUpe2NvbnN0IGk9dGhpcy5jZW50ZXIuZGlzdGFuY2VUb1NxdWFyZWQodCk7cmV0dXJuIHZvaWQgMD09PWUmJihjb25zb2xlLndhcm4oXCJUSFJFRS5TcGhlcmU6IC5jbGFtcFBvaW50KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBmbiksZS5jb3B5KHQpLGk+dGhpcy5yYWRpdXMqdGhpcy5yYWRpdXMmJihlLnN1Yih0aGlzLmNlbnRlcikubm9ybWFsaXplKCksZS5tdWx0aXBseVNjYWxhcih0aGlzLnJhZGl1cykuYWRkKHRoaXMuY2VudGVyKSksZX1nZXRCb3VuZGluZ0JveCh0KXtyZXR1cm4gdm9pZCAwPT09dCYmKGNvbnNvbGUud2FybihcIlRIUkVFLlNwaGVyZTogLmdldEJvdW5kaW5nQm94KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSx0PW5ldyBfbiksdGhpcy5pc0VtcHR5KCk/KHQubWFrZUVtcHR5KCksdCk6KHQuc2V0KHRoaXMuY2VudGVyLHRoaXMuY2VudGVyKSx0LmV4cGFuZEJ5U2NhbGFyKHRoaXMucmFkaXVzKSx0KX1hcHBseU1hdHJpeDQodCl7cmV0dXJuIHRoaXMuY2VudGVyLmFwcGx5TWF0cml4NCh0KSx0aGlzLnJhZGl1cz10aGlzLnJhZGl1cyp0LmdldE1heFNjYWxlT25BeGlzKCksdGhpc310cmFuc2xhdGUodCl7cmV0dXJuIHRoaXMuY2VudGVyLmFkZCh0KSx0aGlzfWVxdWFscyh0KXtyZXR1cm4gdC5jZW50ZXIuZXF1YWxzKHRoaXMuY2VudGVyKSYmdC5yYWRpdXM9PT10aGlzLnJhZGl1c319Y29uc3QgTm49bmV3IGZuLERuPW5ldyBmbiwkbj1uZXcgZm4sa249bmV3IGZuLHpuPW5ldyBmbixGbj1uZXcgZm4sQm49bmV3IGZuO2NsYXNzIGpue2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5vcmlnaW49dm9pZCAwIT09dD90Om5ldyBmbix0aGlzLmRpcmVjdGlvbj12b2lkIDAhPT1lP2U6bmV3IGZuKDAsMCwtMSl9c2V0KHQsZSl7cmV0dXJuIHRoaXMub3JpZ2luLmNvcHkodCksdGhpcy5kaXJlY3Rpb24uY29weShlKSx0aGlzfWNsb25lKCl7cmV0dXJuKG5ldyB0aGlzLmNvbnN0cnVjdG9yKS5jb3B5KHRoaXMpfWNvcHkodCl7cmV0dXJuIHRoaXMub3JpZ2luLmNvcHkodC5vcmlnaW4pLHRoaXMuZGlyZWN0aW9uLmNvcHkodC5kaXJlY3Rpb24pLHRoaXN9YXQodCxlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGNvbnNvbGUud2FybihcIlRIUkVFLlJheTogLmF0KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBmbiksZS5jb3B5KHRoaXMuZGlyZWN0aW9uKS5tdWx0aXBseVNjYWxhcih0KS5hZGQodGhpcy5vcmlnaW4pfWxvb2tBdCh0KXtyZXR1cm4gdGhpcy5kaXJlY3Rpb24uY29weSh0KS5zdWIodGhpcy5vcmlnaW4pLm5vcm1hbGl6ZSgpLHRoaXN9cmVjYXN0KHQpe3JldHVybiB0aGlzLm9yaWdpbi5jb3B5KHRoaXMuYXQodCxObikpLHRoaXN9Y2xvc2VzdFBvaW50VG9Qb2ludCh0LGUpe3ZvaWQgMD09PWUmJihjb25zb2xlLndhcm4oXCJUSFJFRS5SYXk6IC5jbG9zZXN0UG9pbnRUb1BvaW50KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBmbiksZS5zdWJWZWN0b3JzKHQsdGhpcy5vcmlnaW4pO2NvbnN0IGk9ZS5kb3QodGhpcy5kaXJlY3Rpb24pO3JldHVybiBpPDA/ZS5jb3B5KHRoaXMub3JpZ2luKTplLmNvcHkodGhpcy5kaXJlY3Rpb24pLm11bHRpcGx5U2NhbGFyKGkpLmFkZCh0aGlzLm9yaWdpbil9ZGlzdGFuY2VUb1BvaW50KHQpe3JldHVybiBNYXRoLnNxcnQodGhpcy5kaXN0YW5jZVNxVG9Qb2ludCh0KSl9ZGlzdGFuY2VTcVRvUG9pbnQodCl7Y29uc3QgZT1Obi5zdWJWZWN0b3JzKHQsdGhpcy5vcmlnaW4pLmRvdCh0aGlzLmRpcmVjdGlvbik7cmV0dXJuIGU8MD90aGlzLm9yaWdpbi5kaXN0YW5jZVRvU3F1YXJlZCh0KTooTm4uY29weSh0aGlzLmRpcmVjdGlvbikubXVsdGlwbHlTY2FsYXIoZSkuYWRkKHRoaXMub3JpZ2luKSxObi5kaXN0YW5jZVRvU3F1YXJlZCh0KSl9ZGlzdGFuY2VTcVRvU2VnbWVudCh0LGUsaSxuKXtEbi5jb3B5KHQpLmFkZChlKS5tdWx0aXBseVNjYWxhciguNSksJG4uY29weShlKS5zdWIodCkubm9ybWFsaXplKCksa24uY29weSh0aGlzLm9yaWdpbikuc3ViKERuKTtjb25zdCByPS41KnQuZGlzdGFuY2VUbyhlKSxzPS10aGlzLmRpcmVjdGlvbi5kb3QoJG4pLG89a24uZG90KHRoaXMuZGlyZWN0aW9uKSxhPS1rbi5kb3QoJG4pLGM9a24ubGVuZ3RoU3EoKSxoPU1hdGguYWJzKDEtcypzKTtsZXQgbCx1LGQscDtpZihoPjApaWYobD1zKmEtbyx1PXMqby1hLHA9cipoLGw+PTApaWYodT49LXApaWYodTw9cCl7Y29uc3QgdD0xL2g7bCo9dCx1Kj10LGQ9bCoobCtzKnUrMipvKSt1KihzKmwrdSsyKmEpK2N9ZWxzZSB1PXIsbD1NYXRoLm1heCgwLC0ocyp1K28pKSxkPS1sKmwrdSoodSsyKmEpK2M7ZWxzZSB1PS1yLGw9TWF0aC5tYXgoMCwtKHMqdStvKSksZD0tbCpsK3UqKHUrMiphKStjO2Vsc2UgdTw9LXA/KGw9TWF0aC5tYXgoMCwtKC1zKnIrbykpLHU9bD4wPy1yOk1hdGgubWluKE1hdGgubWF4KC1yLC1hKSxyKSxkPS1sKmwrdSoodSsyKmEpK2MpOnU8PXA/KGw9MCx1PU1hdGgubWluKE1hdGgubWF4KC1yLC1hKSxyKSxkPXUqKHUrMiphKStjKToobD1NYXRoLm1heCgwLC0ocypyK28pKSx1PWw+MD9yOk1hdGgubWluKE1hdGgubWF4KC1yLC1hKSxyKSxkPS1sKmwrdSoodSsyKmEpK2MpO2Vsc2UgdT1zPjA/LXI6cixsPU1hdGgubWF4KDAsLShzKnUrbykpLGQ9LWwqbCt1Kih1KzIqYSkrYztyZXR1cm4gaSYmaS5jb3B5KHRoaXMuZGlyZWN0aW9uKS5tdWx0aXBseVNjYWxhcihsKS5hZGQodGhpcy5vcmlnaW4pLG4mJm4uY29weSgkbikubXVsdGlwbHlTY2FsYXIodSkuYWRkKERuKSxkfWludGVyc2VjdFNwaGVyZSh0LGUpe05uLnN1YlZlY3RvcnModC5jZW50ZXIsdGhpcy5vcmlnaW4pO2NvbnN0IGk9Tm4uZG90KHRoaXMuZGlyZWN0aW9uKSxuPU5uLmRvdChObiktaSppLHI9dC5yYWRpdXMqdC5yYWRpdXM7aWYobj5yKXJldHVybiBudWxsO2NvbnN0IHM9TWF0aC5zcXJ0KHItbiksbz1pLXMsYT1pK3M7cmV0dXJuIG88MCYmYTwwP251bGw6bzwwP3RoaXMuYXQoYSxlKTp0aGlzLmF0KG8sZSl9aW50ZXJzZWN0c1NwaGVyZSh0KXtyZXR1cm4gdGhpcy5kaXN0YW5jZVNxVG9Qb2ludCh0LmNlbnRlcik8PXQucmFkaXVzKnQucmFkaXVzfWRpc3RhbmNlVG9QbGFuZSh0KXtjb25zdCBlPXQubm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbik7aWYoMD09PWUpcmV0dXJuIDA9PT10LmRpc3RhbmNlVG9Qb2ludCh0aGlzLm9yaWdpbik/MDpudWxsO2NvbnN0IGk9LSh0aGlzLm9yaWdpbi5kb3QodC5ub3JtYWwpK3QuY29uc3RhbnQpL2U7cmV0dXJuIGk+PTA/aTpudWxsfWludGVyc2VjdFBsYW5lKHQsZSl7Y29uc3QgaT10aGlzLmRpc3RhbmNlVG9QbGFuZSh0KTtyZXR1cm4gbnVsbD09PWk/bnVsbDp0aGlzLmF0KGksZSl9aW50ZXJzZWN0c1BsYW5lKHQpe2NvbnN0IGU9dC5kaXN0YW5jZVRvUG9pbnQodGhpcy5vcmlnaW4pO2lmKDA9PT1lKXJldHVybiEwO3JldHVybiB0Lm5vcm1hbC5kb3QodGhpcy5kaXJlY3Rpb24pKmU8MH1pbnRlcnNlY3RCb3godCxlKXtsZXQgaSxuLHIscyxvLGE7Y29uc3QgYz0xL3RoaXMuZGlyZWN0aW9uLngsaD0xL3RoaXMuZGlyZWN0aW9uLnksbD0xL3RoaXMuZGlyZWN0aW9uLnosdT10aGlzLm9yaWdpbjtyZXR1cm4gYz49MD8oaT0odC5taW4ueC11LngpKmMsbj0odC5tYXgueC11LngpKmMpOihpPSh0Lm1heC54LXUueCkqYyxuPSh0Lm1pbi54LXUueCkqYyksaD49MD8ocj0odC5taW4ueS11LnkpKmgscz0odC5tYXgueS11LnkpKmgpOihyPSh0Lm1heC55LXUueSkqaCxzPSh0Lm1pbi55LXUueSkqaCksaT5zfHxyPm4/bnVsbDooKHI+aXx8aSE9aSkmJihpPXIpLChzPG58fG4hPW4pJiYobj1zKSxsPj0wPyhvPSh0Lm1pbi56LXUueikqbCxhPSh0Lm1heC56LXUueikqbCk6KG89KHQubWF4LnotdS56KSpsLGE9KHQubWluLnotdS56KSpsKSxpPmF8fG8+bj9udWxsOigobz5pfHxpIT1pKSYmKGk9byksKGE8bnx8biE9bikmJihuPWEpLG48MD9udWxsOnRoaXMuYXQoaT49MD9pOm4sZSkpKX1pbnRlcnNlY3RzQm94KHQpe3JldHVybiBudWxsIT09dGhpcy5pbnRlcnNlY3RCb3godCxObil9aW50ZXJzZWN0VHJpYW5nbGUodCxlLGksbixyKXt6bi5zdWJWZWN0b3JzKGUsdCksRm4uc3ViVmVjdG9ycyhpLHQpLEJuLmNyb3NzVmVjdG9ycyh6bixGbik7bGV0IHMsbz10aGlzLmRpcmVjdGlvbi5kb3QoQm4pO2lmKG8+MCl7aWYobilyZXR1cm4gbnVsbDtzPTF9ZWxzZXtpZighKG88MCkpcmV0dXJuIG51bGw7cz0tMSxvPS1vfWtuLnN1YlZlY3RvcnModGhpcy5vcmlnaW4sdCk7Y29uc3QgYT1zKnRoaXMuZGlyZWN0aW9uLmRvdChGbi5jcm9zc1ZlY3RvcnMoa24sRm4pKTtpZihhPDApcmV0dXJuIG51bGw7Y29uc3QgYz1zKnRoaXMuZGlyZWN0aW9uLmRvdCh6bi5jcm9zcyhrbikpO2lmKGM8MClyZXR1cm4gbnVsbDtpZihhK2M+bylyZXR1cm4gbnVsbDtjb25zdCBoPS1zKmtuLmRvdChCbik7cmV0dXJuIGg8MD9udWxsOnRoaXMuYXQoaC9vLHIpfWFwcGx5TWF0cml4NCh0KXtyZXR1cm4gdGhpcy5vcmlnaW4uYXBwbHlNYXRyaXg0KHQpLHRoaXMuZGlyZWN0aW9uLnRyYW5zZm9ybURpcmVjdGlvbih0KSx0aGlzfWVxdWFscyh0KXtyZXR1cm4gdC5vcmlnaW4uZXF1YWxzKHRoaXMub3JpZ2luKSYmdC5kaXJlY3Rpb24uZXF1YWxzKHRoaXMuZGlyZWN0aW9uKX19Y2xhc3MgSG57Y29uc3RydWN0b3IoKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzTWF0cml4NFwiLHt2YWx1ZTohMH0pLHRoaXMuZWxlbWVudHM9WzEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDFdLGFyZ3VtZW50cy5sZW5ndGg+MCYmY29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDQ6IHRoZSBjb25zdHJ1Y3RvciBubyBsb25nZXIgcmVhZHMgYXJndW1lbnRzLiB1c2UgLnNldCgpIGluc3RlYWQuXCIpfXNldCh0LGUsaSxuLHIscyxvLGEsYyxoLGwsdSxkLHAsZixtKXtjb25zdCBnPXRoaXMuZWxlbWVudHM7cmV0dXJuIGdbMF09dCxnWzRdPWUsZ1s4XT1pLGdbMTJdPW4sZ1sxXT1yLGdbNV09cyxnWzldPW8sZ1sxM109YSxnWzJdPWMsZ1s2XT1oLGdbMTBdPWwsZ1sxNF09dSxnWzNdPWQsZ1s3XT1wLGdbMTFdPWYsZ1sxNV09bSx0aGlzfWlkZW50aXR5KCl7cmV0dXJuIHRoaXMuc2V0KDEsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDEpLHRoaXN9Y2xvbmUoKXtyZXR1cm4obmV3IEhuKS5mcm9tQXJyYXkodGhpcy5lbGVtZW50cyl9Y29weSh0KXtjb25zdCBlPXRoaXMuZWxlbWVudHMsaT10LmVsZW1lbnRzO3JldHVybiBlWzBdPWlbMF0sZVsxXT1pWzFdLGVbMl09aVsyXSxlWzNdPWlbM10sZVs0XT1pWzRdLGVbNV09aVs1XSxlWzZdPWlbNl0sZVs3XT1pWzddLGVbOF09aVs4XSxlWzldPWlbOV0sZVsxMF09aVsxMF0sZVsxMV09aVsxMV0sZVsxMl09aVsxMl0sZVsxM109aVsxM10sZVsxNF09aVsxNF0sZVsxNV09aVsxNV0sdGhpc31jb3B5UG9zaXRpb24odCl7Y29uc3QgZT10aGlzLmVsZW1lbnRzLGk9dC5lbGVtZW50cztyZXR1cm4gZVsxMl09aVsxMl0sZVsxM109aVsxM10sZVsxNF09aVsxNF0sdGhpc31zZXRGcm9tTWF0cml4Myh0KXtjb25zdCBlPXQuZWxlbWVudHM7cmV0dXJuIHRoaXMuc2V0KGVbMF0sZVszXSxlWzZdLDAsZVsxXSxlWzRdLGVbN10sMCxlWzJdLGVbNV0sZVs4XSwwLDAsMCwwLDEpLHRoaXN9ZXh0cmFjdEJhc2lzKHQsZSxpKXtyZXR1cm4gdC5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsMCksZS5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsMSksaS5zZXRGcm9tTWF0cml4Q29sdW1uKHRoaXMsMiksdGhpc31tYWtlQmFzaXModCxlLGkpe3JldHVybiB0aGlzLnNldCh0LngsZS54LGkueCwwLHQueSxlLnksaS55LDAsdC56LGUueixpLnosMCwwLDAsMCwxKSx0aGlzfWV4dHJhY3RSb3RhdGlvbih0KXtjb25zdCBlPXRoaXMuZWxlbWVudHMsaT10LmVsZW1lbnRzLG49MS9Vbi5zZXRGcm9tTWF0cml4Q29sdW1uKHQsMCkubGVuZ3RoKCkscj0xL1VuLnNldEZyb21NYXRyaXhDb2x1bW4odCwxKS5sZW5ndGgoKSxzPTEvVW4uc2V0RnJvbU1hdHJpeENvbHVtbih0LDIpLmxlbmd0aCgpO3JldHVybiBlWzBdPWlbMF0qbixlWzFdPWlbMV0qbixlWzJdPWlbMl0qbixlWzNdPTAsZVs0XT1pWzRdKnIsZVs1XT1pWzVdKnIsZVs2XT1pWzZdKnIsZVs3XT0wLGVbOF09aVs4XSpzLGVbOV09aVs5XSpzLGVbMTBdPWlbMTBdKnMsZVsxMV09MCxlWzEyXT0wLGVbMTNdPTAsZVsxNF09MCxlWzE1XT0xLHRoaXN9bWFrZVJvdGF0aW9uRnJvbUV1bGVyKHQpe3QmJnQuaXNFdWxlcnx8Y29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDQ6IC5tYWtlUm90YXRpb25Gcm9tRXVsZXIoKSBub3cgZXhwZWN0cyBhIEV1bGVyIHJvdGF0aW9uIHJhdGhlciB0aGFuIGEgVmVjdG9yMyBhbmQgb3JkZXIuXCIpO2NvbnN0IGU9dGhpcy5lbGVtZW50cyxpPXQueCxuPXQueSxyPXQueixzPU1hdGguY29zKGkpLG89TWF0aC5zaW4oaSksYT1NYXRoLmNvcyhuKSxjPU1hdGguc2luKG4pLGg9TWF0aC5jb3MociksbD1NYXRoLnNpbihyKTtpZihcIlhZWlwiPT09dC5vcmRlcil7Y29uc3QgdD1zKmgsaT1zKmwsbj1vKmgscj1vKmw7ZVswXT1hKmgsZVs0XT0tYSpsLGVbOF09YyxlWzFdPWkrbipjLGVbNV09dC1yKmMsZVs5XT0tbyphLGVbMl09ci10KmMsZVs2XT1uK2kqYyxlWzEwXT1zKmF9ZWxzZSBpZihcIllYWlwiPT09dC5vcmRlcil7Y29uc3QgdD1hKmgsaT1hKmwsbj1jKmgscj1jKmw7ZVswXT10K3IqbyxlWzRdPW4qby1pLGVbOF09cypjLGVbMV09cypsLGVbNV09cypoLGVbOV09LW8sZVsyXT1pKm8tbixlWzZdPXIrdCpvLGVbMTBdPXMqYX1lbHNlIGlmKFwiWlhZXCI9PT10Lm9yZGVyKXtjb25zdCB0PWEqaCxpPWEqbCxuPWMqaCxyPWMqbDtlWzBdPXQtcipvLGVbNF09LXMqbCxlWzhdPW4raSpvLGVbMV09aStuKm8sZVs1XT1zKmgsZVs5XT1yLXQqbyxlWzJdPS1zKmMsZVs2XT1vLGVbMTBdPXMqYX1lbHNlIGlmKFwiWllYXCI9PT10Lm9yZGVyKXtjb25zdCB0PXMqaCxpPXMqbCxuPW8qaCxyPW8qbDtlWzBdPWEqaCxlWzRdPW4qYy1pLGVbOF09dCpjK3IsZVsxXT1hKmwsZVs1XT1yKmMrdCxlWzldPWkqYy1uLGVbMl09LWMsZVs2XT1vKmEsZVsxMF09cyphfWVsc2UgaWYoXCJZWlhcIj09PXQub3JkZXIpe2NvbnN0IHQ9cyphLGk9cypjLG49byphLHI9bypjO2VbMF09YSpoLGVbNF09ci10KmwsZVs4XT1uKmwraSxlWzFdPWwsZVs1XT1zKmgsZVs5XT0tbypoLGVbMl09LWMqaCxlWzZdPWkqbCtuLGVbMTBdPXQtcipsfWVsc2UgaWYoXCJYWllcIj09PXQub3JkZXIpe2NvbnN0IHQ9cyphLGk9cypjLG49byphLHI9bypjO2VbMF09YSpoLGVbNF09LWwsZVs4XT1jKmgsZVsxXT10KmwrcixlWzVdPXMqaCxlWzldPWkqbC1uLGVbMl09bipsLWksZVs2XT1vKmgsZVsxMF09cipsK3R9cmV0dXJuIGVbM109MCxlWzddPTAsZVsxMV09MCxlWzEyXT0wLGVbMTNdPTAsZVsxNF09MCxlWzE1XT0xLHRoaXN9bWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24odCl7cmV0dXJuIHRoaXMuY29tcG9zZShHbix0LHFuKX1sb29rQXQodCxlLGkpe2NvbnN0IG49dGhpcy5lbGVtZW50cztyZXR1cm4gWW4uc3ViVmVjdG9ycyh0LGUpLDA9PT1Zbi5sZW5ndGhTcSgpJiYoWW4uej0xKSxZbi5ub3JtYWxpemUoKSxXbi5jcm9zc1ZlY3RvcnMoaSxZbiksMD09PVduLmxlbmd0aFNxKCkmJigxPT09TWF0aC5hYnMoaS56KT9Zbi54Kz0xZS00OlluLnorPTFlLTQsWW4ubm9ybWFsaXplKCksV24uY3Jvc3NWZWN0b3JzKGksWW4pKSxXbi5ub3JtYWxpemUoKSxYbi5jcm9zc1ZlY3RvcnMoWW4sV24pLG5bMF09V24ueCxuWzRdPVhuLngsbls4XT1Zbi54LG5bMV09V24ueSxuWzVdPVhuLnksbls5XT1Zbi55LG5bMl09V24ueixuWzZdPVhuLnosblsxMF09WW4ueix0aGlzfW11bHRpcGx5KHQsZSl7cmV0dXJuIHZvaWQgMCE9PWU/KGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDQ6IC5tdWx0aXBseSgpIG5vdyBvbmx5IGFjY2VwdHMgb25lIGFyZ3VtZW50LiBVc2UgLm11bHRpcGx5TWF0cmljZXMoIGEsIGIgKSBpbnN0ZWFkLlwiKSx0aGlzLm11bHRpcGx5TWF0cmljZXModCxlKSk6dGhpcy5tdWx0aXBseU1hdHJpY2VzKHRoaXMsdCl9cHJlbXVsdGlwbHkodCl7cmV0dXJuIHRoaXMubXVsdGlwbHlNYXRyaWNlcyh0LHRoaXMpfW11bHRpcGx5TWF0cmljZXModCxlKXtjb25zdCBpPXQuZWxlbWVudHMsbj1lLmVsZW1lbnRzLHI9dGhpcy5lbGVtZW50cyxzPWlbMF0sbz1pWzRdLGE9aVs4XSxjPWlbMTJdLGg9aVsxXSxsPWlbNV0sdT1pWzldLGQ9aVsxM10scD1pWzJdLGY9aVs2XSxtPWlbMTBdLGc9aVsxNF0sXz1pWzNdLHY9aVs3XSx5PWlbMTFdLGI9aVsxNV0seD1uWzBdLHc9bls0XSxTPW5bOF0sTT1uWzEyXSxUPW5bMV0sQz1uWzVdLEU9bls5XSxJPW5bMTNdLEE9blsyXSxQPW5bNl0sUj1uWzEwXSxMPW5bMTRdLE89blszXSxOPW5bN10sRD1uWzExXSwkPW5bMTVdO3JldHVybiByWzBdPXMqeCtvKlQrYSpBK2MqTyxyWzRdPXMqdytvKkMrYSpQK2MqTixyWzhdPXMqUytvKkUrYSpSK2MqRCxyWzEyXT1zKk0rbypJK2EqTCtjKiQsclsxXT1oKngrbCpUK3UqQStkKk8scls1XT1oKncrbCpDK3UqUCtkKk4scls5XT1oKlMrbCpFK3UqUitkKkQsclsxM109aCpNK2wqSSt1KkwrZCokLHJbMl09cCp4K2YqVCttKkErZypPLHJbNl09cCp3K2YqQyttKlArZypOLHJbMTBdPXAqUytmKkUrbSpSK2cqRCxyWzE0XT1wKk0rZipJK20qTCtnKiQsclszXT1fKngrdipUK3kqQStiKk8scls3XT1fKncrdipDK3kqUCtiKk4sclsxMV09XypTK3YqRSt5KlIrYipELHJbMTVdPV8qTSt2KkkreSpMK2IqJCx0aGlzfW11bHRpcGx5U2NhbGFyKHQpe2NvbnN0IGU9dGhpcy5lbGVtZW50cztyZXR1cm4gZVswXSo9dCxlWzRdKj10LGVbOF0qPXQsZVsxMl0qPXQsZVsxXSo9dCxlWzVdKj10LGVbOV0qPXQsZVsxM10qPXQsZVsyXSo9dCxlWzZdKj10LGVbMTBdKj10LGVbMTRdKj10LGVbM10qPXQsZVs3XSo9dCxlWzExXSo9dCxlWzE1XSo9dCx0aGlzfWRldGVybWluYW50KCl7Y29uc3QgdD10aGlzLmVsZW1lbnRzLGU9dFswXSxpPXRbNF0sbj10WzhdLHI9dFsxMl0scz10WzFdLG89dFs1XSxhPXRbOV0sYz10WzEzXSxoPXRbMl0sbD10WzZdLHU9dFsxMF0sZD10WzE0XTtyZXR1cm4gdFszXSooK3IqYSpsLW4qYypsLXIqbyp1K2kqYyp1K24qbypkLWkqYSpkKSt0WzddKigrZSphKmQtZSpjKnUrcipzKnUtbipzKmQrbipjKmgtciphKmgpK3RbMTFdKigrZSpjKmwtZSpvKmQtcipzKmwraSpzKmQrcipvKmgtaSpjKmgpK3RbMTVdKigtbipvKmgtZSphKmwrZSpvKnUrbipzKmwtaSpzKnUraSphKmgpfXRyYW5zcG9zZSgpe2NvbnN0IHQ9dGhpcy5lbGVtZW50cztsZXQgZTtyZXR1cm4gZT10WzFdLHRbMV09dFs0XSx0WzRdPWUsZT10WzJdLHRbMl09dFs4XSx0WzhdPWUsZT10WzZdLHRbNl09dFs5XSx0WzldPWUsZT10WzNdLHRbM109dFsxMl0sdFsxMl09ZSxlPXRbN10sdFs3XT10WzEzXSx0WzEzXT1lLGU9dFsxMV0sdFsxMV09dFsxNF0sdFsxNF09ZSx0aGlzfXNldFBvc2l0aW9uKHQsZSxpKXtjb25zdCBuPXRoaXMuZWxlbWVudHM7cmV0dXJuIHQuaXNWZWN0b3IzPyhuWzEyXT10LngsblsxM109dC55LG5bMTRdPXQueik6KG5bMTJdPXQsblsxM109ZSxuWzE0XT1pKSx0aGlzfWludmVydCgpe2NvbnN0IHQ9dGhpcy5lbGVtZW50cyxlPXRbMF0saT10WzFdLG49dFsyXSxyPXRbM10scz10WzRdLG89dFs1XSxhPXRbNl0sYz10WzddLGg9dFs4XSxsPXRbOV0sdT10WzEwXSxkPXRbMTFdLHA9dFsxMl0sZj10WzEzXSxtPXRbMTRdLGc9dFsxNV0sXz1sKm0qYy1mKnUqYytmKmEqZC1vKm0qZC1sKmEqZytvKnUqZyx2PXAqdSpjLWgqbSpjLXAqYSpkK3MqbSpkK2gqYSpnLXMqdSpnLHk9aCpmKmMtcCpsKmMrcCpvKmQtcypmKmQtaCpvKmcrcypsKmcsYj1wKmwqYS1oKmYqYS1wKm8qdStzKmYqdStoKm8qbS1zKmwqbSx4PWUqXytpKnYrbip5K3IqYjtpZigwPT09eClyZXR1cm4gdGhpcy5zZXQoMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCk7Y29uc3Qgdz0xL3g7cmV0dXJuIHRbMF09Xyp3LHRbMV09KGYqdSpyLWwqbSpyLWYqbipkK2kqbSpkK2wqbipnLWkqdSpnKSp3LHRbMl09KG8qbSpyLWYqYSpyK2YqbipjLWkqbSpjLW8qbipnK2kqYSpnKSp3LHRbM109KGwqYSpyLW8qdSpyLWwqbipjK2kqdSpjK28qbipkLWkqYSpkKSp3LHRbNF09dip3LHRbNV09KGgqbSpyLXAqdSpyK3AqbipkLWUqbSpkLWgqbipnK2UqdSpnKSp3LHRbNl09KHAqYSpyLXMqbSpyLXAqbipjK2UqbSpjK3MqbipnLWUqYSpnKSp3LHRbN109KHMqdSpyLWgqYSpyK2gqbipjLWUqdSpjLXMqbipkK2UqYSpkKSp3LHRbOF09eSp3LHRbOV09KHAqbCpyLWgqZipyLXAqaSpkK2UqZipkK2gqaSpnLWUqbCpnKSp3LHRbMTBdPShzKmYqci1wKm8qcitwKmkqYy1lKmYqYy1zKmkqZytlKm8qZykqdyx0WzExXT0oaCpvKnItcypsKnItaCppKmMrZSpsKmMrcyppKmQtZSpvKmQpKncsdFsxMl09Yip3LHRbMTNdPShoKmYqbi1wKmwqbitwKmkqdS1lKmYqdS1oKmkqbStlKmwqbSkqdyx0WzE0XT0ocCpvKm4tcypmKm4tcCppKmErZSpmKmErcyppKm0tZSpvKm0pKncsdFsxNV09KHMqbCpuLWgqbypuK2gqaSphLWUqbCphLXMqaSp1K2Uqbyp1KSp3LHRoaXN9c2NhbGUodCl7Y29uc3QgZT10aGlzLmVsZW1lbnRzLGk9dC54LG49dC55LHI9dC56O3JldHVybiBlWzBdKj1pLGVbNF0qPW4sZVs4XSo9cixlWzFdKj1pLGVbNV0qPW4sZVs5XSo9cixlWzJdKj1pLGVbNl0qPW4sZVsxMF0qPXIsZVszXSo9aSxlWzddKj1uLGVbMTFdKj1yLHRoaXN9Z2V0TWF4U2NhbGVPbkF4aXMoKXtjb25zdCB0PXRoaXMuZWxlbWVudHMsZT10WzBdKnRbMF0rdFsxXSp0WzFdK3RbMl0qdFsyXSxpPXRbNF0qdFs0XSt0WzVdKnRbNV0rdFs2XSp0WzZdLG49dFs4XSp0WzhdK3RbOV0qdFs5XSt0WzEwXSp0WzEwXTtyZXR1cm4gTWF0aC5zcXJ0KE1hdGgubWF4KGUsaSxuKSl9bWFrZVRyYW5zbGF0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5zZXQoMSwwLDAsdCwwLDEsMCxlLDAsMCwxLGksMCwwLDAsMSksdGhpc31tYWtlUm90YXRpb25YKHQpe2NvbnN0IGU9TWF0aC5jb3ModCksaT1NYXRoLnNpbih0KTtyZXR1cm4gdGhpcy5zZXQoMSwwLDAsMCwwLGUsLWksMCwwLGksZSwwLDAsMCwwLDEpLHRoaXN9bWFrZVJvdGF0aW9uWSh0KXtjb25zdCBlPU1hdGguY29zKHQpLGk9TWF0aC5zaW4odCk7cmV0dXJuIHRoaXMuc2V0KGUsMCxpLDAsMCwxLDAsMCwtaSwwLGUsMCwwLDAsMCwxKSx0aGlzfW1ha2VSb3RhdGlvbloodCl7Y29uc3QgZT1NYXRoLmNvcyh0KSxpPU1hdGguc2luKHQpO3JldHVybiB0aGlzLnNldChlLC1pLDAsMCxpLGUsMCwwLDAsMCwxLDAsMCwwLDAsMSksdGhpc31tYWtlUm90YXRpb25BeGlzKHQsZSl7Y29uc3QgaT1NYXRoLmNvcyhlKSxuPU1hdGguc2luKGUpLHI9MS1pLHM9dC54LG89dC55LGE9dC56LGM9cipzLGg9cipvO3JldHVybiB0aGlzLnNldChjKnMraSxjKm8tbiphLGMqYStuKm8sMCxjKm8rbiphLGgqbytpLGgqYS1uKnMsMCxjKmEtbipvLGgqYStuKnMsciphKmEraSwwLDAsMCwwLDEpLHRoaXN9bWFrZVNjYWxlKHQsZSxpKXtyZXR1cm4gdGhpcy5zZXQodCwwLDAsMCwwLGUsMCwwLDAsMCxpLDAsMCwwLDAsMSksdGhpc31tYWtlU2hlYXIodCxlLGkpe3JldHVybiB0aGlzLnNldCgxLGUsaSwwLHQsMSxpLDAsdCxlLDEsMCwwLDAsMCwxKSx0aGlzfWNvbXBvc2UodCxlLGkpe2NvbnN0IG49dGhpcy5lbGVtZW50cyxyPWUuX3gscz1lLl95LG89ZS5feixhPWUuX3csYz1yK3IsaD1zK3MsbD1vK28sdT1yKmMsZD1yKmgscD1yKmwsZj1zKmgsbT1zKmwsZz1vKmwsXz1hKmMsdj1hKmgseT1hKmwsYj1pLngseD1pLnksdz1pLno7cmV0dXJuIG5bMF09KDEtKGYrZykpKmIsblsxXT0oZCt5KSpiLG5bMl09KHAtdikqYixuWzNdPTAsbls0XT0oZC15KSp4LG5bNV09KDEtKHUrZykpKngsbls2XT0obStfKSp4LG5bN109MCxuWzhdPShwK3YpKncsbls5XT0obS1fKSp3LG5bMTBdPSgxLSh1K2YpKSp3LG5bMTFdPTAsblsxMl09dC54LG5bMTNdPXQueSxuWzE0XT10LnosblsxNV09MSx0aGlzfWRlY29tcG9zZSh0LGUsaSl7Y29uc3Qgbj10aGlzLmVsZW1lbnRzO2xldCByPVVuLnNldChuWzBdLG5bMV0sblsyXSkubGVuZ3RoKCk7Y29uc3Qgcz1Vbi5zZXQobls0XSxuWzVdLG5bNl0pLmxlbmd0aCgpLG89VW4uc2V0KG5bOF0sbls5XSxuWzEwXSkubGVuZ3RoKCk7dGhpcy5kZXRlcm1pbmFudCgpPDAmJihyPS1yKSx0Lng9blsxMl0sdC55PW5bMTNdLHQuej1uWzE0XSxWbi5jb3B5KHRoaXMpO2NvbnN0IGE9MS9yLGM9MS9zLGg9MS9vO3JldHVybiBWbi5lbGVtZW50c1swXSo9YSxWbi5lbGVtZW50c1sxXSo9YSxWbi5lbGVtZW50c1syXSo9YSxWbi5lbGVtZW50c1s0XSo9YyxWbi5lbGVtZW50c1s1XSo9YyxWbi5lbGVtZW50c1s2XSo9YyxWbi5lbGVtZW50c1s4XSo9aCxWbi5lbGVtZW50c1s5XSo9aCxWbi5lbGVtZW50c1sxMF0qPWgsZS5zZXRGcm9tUm90YXRpb25NYXRyaXgoVm4pLGkueD1yLGkueT1zLGkuej1vLHRoaXN9bWFrZVBlcnNwZWN0aXZlKHQsZSxpLG4scixzKXt2b2lkIDA9PT1zJiZjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAubWFrZVBlcnNwZWN0aXZlKCkgaGFzIGJlZW4gcmVkZWZpbmVkIGFuZCBoYXMgYSBuZXcgc2lnbmF0dXJlLiBQbGVhc2UgY2hlY2sgdGhlIGRvY3MuXCIpO2NvbnN0IG89dGhpcy5lbGVtZW50cyxhPTIqci8oZS10KSxjPTIqci8oaS1uKSxoPShlK3QpLyhlLXQpLGw9KGkrbikvKGktbiksdT0tKHMrcikvKHMtciksZD0tMipzKnIvKHMtcik7cmV0dXJuIG9bMF09YSxvWzRdPTAsb1s4XT1oLG9bMTJdPTAsb1sxXT0wLG9bNV09YyxvWzldPWwsb1sxM109MCxvWzJdPTAsb1s2XT0wLG9bMTBdPXUsb1sxNF09ZCxvWzNdPTAsb1s3XT0wLG9bMTFdPS0xLG9bMTVdPTAsdGhpc31tYWtlT3J0aG9ncmFwaGljKHQsZSxpLG4scixzKXtjb25zdCBvPXRoaXMuZWxlbWVudHMsYT0xLyhlLXQpLGM9MS8oaS1uKSxoPTEvKHMtciksbD0oZSt0KSphLHU9KGkrbikqYyxkPShzK3IpKmg7cmV0dXJuIG9bMF09MiphLG9bNF09MCxvWzhdPTAsb1sxMl09LWwsb1sxXT0wLG9bNV09MipjLG9bOV09MCxvWzEzXT0tdSxvWzJdPTAsb1s2XT0wLG9bMTBdPS0yKmgsb1sxNF09LWQsb1szXT0wLG9bN109MCxvWzExXT0wLG9bMTVdPTEsdGhpc31lcXVhbHModCl7Y29uc3QgZT10aGlzLmVsZW1lbnRzLGk9dC5lbGVtZW50cztmb3IobGV0IHQ9MDt0PDE2O3QrKylpZihlW3RdIT09aVt0XSlyZXR1cm4hMTtyZXR1cm4hMH1mcm9tQXJyYXkodCxlPTApe2ZvcihsZXQgaT0wO2k8MTY7aSsrKXRoaXMuZWxlbWVudHNbaV09dFtpK2VdO3JldHVybiB0aGlzfXRvQXJyYXkodD1bXSxlPTApe2NvbnN0IGk9dGhpcy5lbGVtZW50cztyZXR1cm4gdFtlXT1pWzBdLHRbZSsxXT1pWzFdLHRbZSsyXT1pWzJdLHRbZSszXT1pWzNdLHRbZSs0XT1pWzRdLHRbZSs1XT1pWzVdLHRbZSs2XT1pWzZdLHRbZSs3XT1pWzddLHRbZSs4XT1pWzhdLHRbZSs5XT1pWzldLHRbZSsxMF09aVsxMF0sdFtlKzExXT1pWzExXSx0W2UrMTJdPWlbMTJdLHRbZSsxM109aVsxM10sdFtlKzE0XT1pWzE0XSx0W2UrMTVdPWlbMTVdLHR9fWNvbnN0IFVuPW5ldyBmbixWbj1uZXcgSG4sR249bmV3IGZuKDAsMCwwKSxxbj1uZXcgZm4oMSwxLDEpLFduPW5ldyBmbixYbj1uZXcgZm4sWW49bmV3IGZuO2NsYXNzIFpue2NvbnN0cnVjdG9yKHQ9MCxlPTAsaT0wLG49Wm4uRGVmYXVsdE9yZGVyKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzRXVsZXJcIix7dmFsdWU6ITB9KSx0aGlzLl94PXQsdGhpcy5feT1lLHRoaXMuX3o9aSx0aGlzLl9vcmRlcj1ufWdldCB4KCl7cmV0dXJuIHRoaXMuX3h9c2V0IHgodCl7dGhpcy5feD10LHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKX1nZXQgeSgpe3JldHVybiB0aGlzLl95fXNldCB5KHQpe3RoaXMuX3k9dCx0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCl9Z2V0IHooKXtyZXR1cm4gdGhpcy5fen1zZXQgeih0KXt0aGlzLl96PXQsdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpfWdldCBvcmRlcigpe3JldHVybiB0aGlzLl9vcmRlcn1zZXQgb3JkZXIodCl7dGhpcy5fb3JkZXI9dCx0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCl9c2V0KHQsZSxpLG4pe3JldHVybiB0aGlzLl94PXQsdGhpcy5feT1lLHRoaXMuX3o9aSx0aGlzLl9vcmRlcj1ufHx0aGlzLl9vcmRlcix0aGlzLl9vbkNoYW5nZUNhbGxiYWNrKCksdGhpc31jbG9uZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLl94LHRoaXMuX3ksdGhpcy5feix0aGlzLl9vcmRlcil9Y29weSh0KXtyZXR1cm4gdGhpcy5feD10Ll94LHRoaXMuX3k9dC5feSx0aGlzLl96PXQuX3osdGhpcy5fb3JkZXI9dC5fb3JkZXIsdGhpcy5fb25DaGFuZ2VDYWxsYmFjaygpLHRoaXN9c2V0RnJvbVJvdGF0aW9uTWF0cml4KHQsZSxpKXtjb25zdCBuPW5uLmNsYW1wLHI9dC5lbGVtZW50cyxzPXJbMF0sbz1yWzRdLGE9cls4XSxjPXJbMV0saD1yWzVdLGw9cls5XSx1PXJbMl0sZD1yWzZdLHA9clsxMF07c3dpdGNoKGU9ZXx8dGhpcy5fb3JkZXIpe2Nhc2VcIlhZWlwiOnRoaXMuX3k9TWF0aC5hc2luKG4oYSwtMSwxKSksTWF0aC5hYnMoYSk8Ljk5OTk5OTk/KHRoaXMuX3g9TWF0aC5hdGFuMigtbCxwKSx0aGlzLl96PU1hdGguYXRhbjIoLW8scykpOih0aGlzLl94PU1hdGguYXRhbjIoZCxoKSx0aGlzLl96PTApO2JyZWFrO2Nhc2VcIllYWlwiOnRoaXMuX3g9TWF0aC5hc2luKC1uKGwsLTEsMSkpLE1hdGguYWJzKGwpPC45OTk5OTk5Pyh0aGlzLl95PU1hdGguYXRhbjIoYSxwKSx0aGlzLl96PU1hdGguYXRhbjIoYyxoKSk6KHRoaXMuX3k9TWF0aC5hdGFuMigtdSxzKSx0aGlzLl96PTApO2JyZWFrO2Nhc2VcIlpYWVwiOnRoaXMuX3g9TWF0aC5hc2luKG4oZCwtMSwxKSksTWF0aC5hYnMoZCk8Ljk5OTk5OTk/KHRoaXMuX3k9TWF0aC5hdGFuMigtdSxwKSx0aGlzLl96PU1hdGguYXRhbjIoLW8saCkpOih0aGlzLl95PTAsdGhpcy5fej1NYXRoLmF0YW4yKGMscykpO2JyZWFrO2Nhc2VcIlpZWFwiOnRoaXMuX3k9TWF0aC5hc2luKC1uKHUsLTEsMSkpLE1hdGguYWJzKHUpPC45OTk5OTk5Pyh0aGlzLl94PU1hdGguYXRhbjIoZCxwKSx0aGlzLl96PU1hdGguYXRhbjIoYyxzKSk6KHRoaXMuX3g9MCx0aGlzLl96PU1hdGguYXRhbjIoLW8saCkpO2JyZWFrO2Nhc2VcIllaWFwiOnRoaXMuX3o9TWF0aC5hc2luKG4oYywtMSwxKSksTWF0aC5hYnMoYyk8Ljk5OTk5OTk/KHRoaXMuX3g9TWF0aC5hdGFuMigtbCxoKSx0aGlzLl95PU1hdGguYXRhbjIoLXUscykpOih0aGlzLl94PTAsdGhpcy5feT1NYXRoLmF0YW4yKGEscCkpO2JyZWFrO2Nhc2VcIlhaWVwiOnRoaXMuX3o9TWF0aC5hc2luKC1uKG8sLTEsMSkpLE1hdGguYWJzKG8pPC45OTk5OTk5Pyh0aGlzLl94PU1hdGguYXRhbjIoZCxoKSx0aGlzLl95PU1hdGguYXRhbjIoYSxzKSk6KHRoaXMuX3g9TWF0aC5hdGFuMigtbCxwKSx0aGlzLl95PTApO2JyZWFrO2RlZmF1bHQ6Y29uc29sZS53YXJuKFwiVEhSRUUuRXVsZXI6IC5zZXRGcm9tUm90YXRpb25NYXRyaXgoKSBlbmNvdW50ZXJlZCBhbiB1bmtub3duIG9yZGVyOiBcIitlKX1yZXR1cm4gdGhpcy5fb3JkZXI9ZSwhMSE9PWkmJnRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXNldEZyb21RdWF0ZXJuaW9uKHQsZSxpKXtyZXR1cm4gSm4ubWFrZVJvdGF0aW9uRnJvbVF1YXRlcm5pb24odCksdGhpcy5zZXRGcm9tUm90YXRpb25NYXRyaXgoSm4sZSxpKX1zZXRGcm9tVmVjdG9yMyh0LGUpe3JldHVybiB0aGlzLnNldCh0LngsdC55LHQueixlfHx0aGlzLl9vcmRlcil9cmVvcmRlcih0KXtyZXR1cm4gS24uc2V0RnJvbUV1bGVyKHRoaXMpLHRoaXMuc2V0RnJvbVF1YXRlcm5pb24oS24sdCl9ZXF1YWxzKHQpe3JldHVybiB0Ll94PT09dGhpcy5feCYmdC5feT09PXRoaXMuX3kmJnQuX3o9PT10aGlzLl96JiZ0Ll9vcmRlcj09PXRoaXMuX29yZGVyfWZyb21BcnJheSh0KXtyZXR1cm4gdGhpcy5feD10WzBdLHRoaXMuX3k9dFsxXSx0aGlzLl96PXRbMl0sdm9pZCAwIT09dFszXSYmKHRoaXMuX29yZGVyPXRbM10pLHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soKSx0aGlzfXRvQXJyYXkodD1bXSxlPTApe3JldHVybiB0W2VdPXRoaXMuX3gsdFtlKzFdPXRoaXMuX3ksdFtlKzJdPXRoaXMuX3osdFtlKzNdPXRoaXMuX29yZGVyLHR9dG9WZWN0b3IzKHQpe3JldHVybiB0P3Quc2V0KHRoaXMuX3gsdGhpcy5feSx0aGlzLl96KTpuZXcgZm4odGhpcy5feCx0aGlzLl95LHRoaXMuX3opfV9vbkNoYW5nZSh0KXtyZXR1cm4gdGhpcy5fb25DaGFuZ2VDYWxsYmFjaz10LHRoaXN9X29uQ2hhbmdlQ2FsbGJhY2soKXt9fVpuLkRlZmF1bHRPcmRlcj1cIlhZWlwiLFpuLlJvdGF0aW9uT3JkZXJzPVtcIlhZWlwiLFwiWVpYXCIsXCJaWFlcIixcIlhaWVwiLFwiWVhaXCIsXCJaWVhcIl07Y29uc3QgSm49bmV3IEhuLEtuPW5ldyBwbjtjbGFzcyBRbntjb25zdHJ1Y3Rvcigpe3RoaXMubWFzaz0xfXNldCh0KXt0aGlzLm1hc2s9MTw8dHwwfWVuYWJsZSh0KXt0aGlzLm1hc2t8PTE8PHR8MH1lbmFibGVBbGwoKXt0aGlzLm1hc2s9LTF9dG9nZ2xlKHQpe3RoaXMubWFza149MTw8dHwwfWRpc2FibGUodCl7dGhpcy5tYXNrJj1+KDE8PHR8MCl9ZGlzYWJsZUFsbCgpe3RoaXMubWFzaz0wfXRlc3QodCl7cmV0dXJuIDAhPSh0aGlzLm1hc2smdC5tYXNrKX19bGV0IHRyPTA7Y29uc3QgZXI9bmV3IGZuLGlyPW5ldyBwbixucj1uZXcgSG4scnI9bmV3IGZuLHNyPW5ldyBmbixvcj1uZXcgZm4sYXI9bmV3IHBuLGNyPW5ldyBmbigxLDAsMCksaHI9bmV3IGZuKDAsMSwwKSxscj1uZXcgZm4oMCwwLDEpLHVyPXt0eXBlOlwiYWRkZWRcIn0sZHI9e3R5cGU6XCJyZW1vdmVkXCJ9O2Z1bmN0aW9uIHByKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpZFwiLHt2YWx1ZTp0cisrfSksdGhpcy51dWlkPW5uLmdlbmVyYXRlVVVJRCgpLHRoaXMubmFtZT1cIlwiLHRoaXMudHlwZT1cIk9iamVjdDNEXCIsdGhpcy5wYXJlbnQ9bnVsbCx0aGlzLmNoaWxkcmVuPVtdLHRoaXMudXA9cHIuRGVmYXVsdFVwLmNsb25lKCk7Y29uc3QgdD1uZXcgZm4sZT1uZXcgWm4saT1uZXcgcG4sbj1uZXcgZm4oMSwxLDEpO2UuX29uQ2hhbmdlKChmdW5jdGlvbigpe2kuc2V0RnJvbUV1bGVyKGUsITEpfSkpLGkuX29uQ2hhbmdlKChmdW5jdGlvbigpe2Uuc2V0RnJvbVF1YXRlcm5pb24oaSx2b2lkIDAsITEpfSkpLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse3Bvc2l0aW9uOntjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCx2YWx1ZTp0fSxyb3RhdGlvbjp7Y29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6ITAsdmFsdWU6ZX0scXVhdGVybmlvbjp7Y29uZmlndXJhYmxlOiEwLGVudW1lcmFibGU6ITAsdmFsdWU6aX0sc2NhbGU6e2NvbmZpZ3VyYWJsZTohMCxlbnVtZXJhYmxlOiEwLHZhbHVlOm59LG1vZGVsVmlld01hdHJpeDp7dmFsdWU6bmV3IEhufSxub3JtYWxNYXRyaXg6e3ZhbHVlOm5ldyBzbn19KSx0aGlzLm1hdHJpeD1uZXcgSG4sdGhpcy5tYXRyaXhXb3JsZD1uZXcgSG4sdGhpcy5tYXRyaXhBdXRvVXBkYXRlPXByLkRlZmF1bHRNYXRyaXhBdXRvVXBkYXRlLHRoaXMubWF0cml4V29ybGROZWVkc1VwZGF0ZT0hMSx0aGlzLmxheWVycz1uZXcgUW4sdGhpcy52aXNpYmxlPSEwLHRoaXMuY2FzdFNoYWRvdz0hMSx0aGlzLnJlY2VpdmVTaGFkb3c9ITEsdGhpcy5mcnVzdHVtQ3VsbGVkPSEwLHRoaXMucmVuZGVyT3JkZXI9MCx0aGlzLmFuaW1hdGlvbnM9W10sdGhpcy51c2VyRGF0YT17fX1wci5EZWZhdWx0VXA9bmV3IGZuKDAsMSwwKSxwci5EZWZhdWx0TWF0cml4QXV0b1VwZGF0ZT0hMCxwci5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKFFpLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnByLGlzT2JqZWN0M0Q6ITAsb25CZWZvcmVSZW5kZXI6ZnVuY3Rpb24oKXt9LG9uQWZ0ZXJSZW5kZXI6ZnVuY3Rpb24oKXt9LGFwcGx5TWF0cml4NDpmdW5jdGlvbih0KXt0aGlzLm1hdHJpeEF1dG9VcGRhdGUmJnRoaXMudXBkYXRlTWF0cml4KCksdGhpcy5tYXRyaXgucHJlbXVsdGlwbHkodCksdGhpcy5tYXRyaXguZGVjb21wb3NlKHRoaXMucG9zaXRpb24sdGhpcy5xdWF0ZXJuaW9uLHRoaXMuc2NhbGUpfSxhcHBseVF1YXRlcm5pb246ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMucXVhdGVybmlvbi5wcmVtdWx0aXBseSh0KSx0aGlzfSxzZXRSb3RhdGlvbkZyb21BeGlzQW5nbGU6ZnVuY3Rpb24odCxlKXt0aGlzLnF1YXRlcm5pb24uc2V0RnJvbUF4aXNBbmdsZSh0LGUpfSxzZXRSb3RhdGlvbkZyb21FdWxlcjpmdW5jdGlvbih0KXt0aGlzLnF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKHQsITApfSxzZXRSb3RhdGlvbkZyb21NYXRyaXg6ZnVuY3Rpb24odCl7dGhpcy5xdWF0ZXJuaW9uLnNldEZyb21Sb3RhdGlvbk1hdHJpeCh0KX0sc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbjpmdW5jdGlvbih0KXt0aGlzLnF1YXRlcm5pb24uY29weSh0KX0scm90YXRlT25BeGlzOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGlyLnNldEZyb21BeGlzQW5nbGUodCxlKSx0aGlzLnF1YXRlcm5pb24ubXVsdGlwbHkoaXIpLHRoaXN9LHJvdGF0ZU9uV29ybGRBeGlzOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGlyLnNldEZyb21BeGlzQW5nbGUodCxlKSx0aGlzLnF1YXRlcm5pb24ucHJlbXVsdGlwbHkoaXIpLHRoaXN9LHJvdGF0ZVg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMucm90YXRlT25BeGlzKGNyLHQpfSxyb3RhdGVZOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnJvdGF0ZU9uQXhpcyhocix0KX0scm90YXRlWjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yb3RhdGVPbkF4aXMobHIsdCl9LHRyYW5zbGF0ZU9uQXhpczpmdW5jdGlvbih0LGUpe3JldHVybiBlci5jb3B5KHQpLmFwcGx5UXVhdGVybmlvbih0aGlzLnF1YXRlcm5pb24pLHRoaXMucG9zaXRpb24uYWRkKGVyLm11bHRpcGx5U2NhbGFyKGUpKSx0aGlzfSx0cmFuc2xhdGVYOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnRyYW5zbGF0ZU9uQXhpcyhjcix0KX0sdHJhbnNsYXRlWTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50cmFuc2xhdGVPbkF4aXMoaHIsdCl9LHRyYW5zbGF0ZVo6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudHJhbnNsYXRlT25BeGlzKGxyLHQpfSxsb2NhbFRvV29ybGQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQuYXBwbHlNYXRyaXg0KHRoaXMubWF0cml4V29ybGQpfSx3b3JsZFRvTG9jYWw6ZnVuY3Rpb24odCl7cmV0dXJuIHQuYXBwbHlNYXRyaXg0KG5yLmNvcHkodGhpcy5tYXRyaXhXb3JsZCkuaW52ZXJ0KCkpfSxsb29rQXQ6ZnVuY3Rpb24odCxlLGkpe3QuaXNWZWN0b3IzP3JyLmNvcHkodCk6cnIuc2V0KHQsZSxpKTtjb25zdCBuPXRoaXMucGFyZW50O3RoaXMudXBkYXRlV29ybGRNYXRyaXgoITAsITEpLHNyLnNldEZyb21NYXRyaXhQb3NpdGlvbih0aGlzLm1hdHJpeFdvcmxkKSx0aGlzLmlzQ2FtZXJhfHx0aGlzLmlzTGlnaHQ/bnIubG9va0F0KHNyLHJyLHRoaXMudXApOm5yLmxvb2tBdChycixzcix0aGlzLnVwKSx0aGlzLnF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KG5yKSxuJiYobnIuZXh0cmFjdFJvdGF0aW9uKG4ubWF0cml4V29ybGQpLGlyLnNldEZyb21Sb3RhdGlvbk1hdHJpeChuciksdGhpcy5xdWF0ZXJuaW9uLnByZW11bHRpcGx5KGlyLmludmVydCgpKSl9LGFkZDpmdW5jdGlvbih0KXtpZihhcmd1bWVudHMubGVuZ3RoPjEpe2ZvcihsZXQgdD0wO3Q8YXJndW1lbnRzLmxlbmd0aDt0KyspdGhpcy5hZGQoYXJndW1lbnRzW3RdKTtyZXR1cm4gdGhpc31yZXR1cm4gdD09PXRoaXM/KGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5PYmplY3QzRC5hZGQ6IG9iamVjdCBjYW4ndCBiZSBhZGRlZCBhcyBhIGNoaWxkIG9mIGl0c2VsZi5cIix0KSx0aGlzKToodCYmdC5pc09iamVjdDNEPyhudWxsIT09dC5wYXJlbnQmJnQucGFyZW50LnJlbW92ZSh0KSx0LnBhcmVudD10aGlzLHRoaXMuY2hpbGRyZW4ucHVzaCh0KSx0LmRpc3BhdGNoRXZlbnQodXIpKTpjb25zb2xlLmVycm9yKFwiVEhSRUUuT2JqZWN0M0QuYWRkOiBvYmplY3Qgbm90IGFuIGluc3RhbmNlIG9mIFRIUkVFLk9iamVjdDNELlwiLHQpLHRoaXMpfSxyZW1vdmU6ZnVuY3Rpb24odCl7aWYoYXJndW1lbnRzLmxlbmd0aD4xKXtmb3IobGV0IHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXRoaXMucmVtb3ZlKGFyZ3VtZW50c1t0XSk7cmV0dXJuIHRoaXN9Y29uc3QgZT10aGlzLmNoaWxkcmVuLmluZGV4T2YodCk7cmV0dXJuLTEhPT1lJiYodC5wYXJlbnQ9bnVsbCx0aGlzLmNoaWxkcmVuLnNwbGljZShlLDEpLHQuZGlzcGF0Y2hFdmVudChkcikpLHRoaXN9LGNsZWFyOmZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLmNoaWxkcmVuLmxlbmd0aDt0Kyspe2NvbnN0IGU9dGhpcy5jaGlsZHJlblt0XTtlLnBhcmVudD1udWxsLGUuZGlzcGF0Y2hFdmVudChkcil9cmV0dXJuIHRoaXMuY2hpbGRyZW4ubGVuZ3RoPTAsdGhpc30sYXR0YWNoOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnVwZGF0ZVdvcmxkTWF0cml4KCEwLCExKSxuci5jb3B5KHRoaXMubWF0cml4V29ybGQpLmludmVydCgpLG51bGwhPT10LnBhcmVudCYmKHQucGFyZW50LnVwZGF0ZVdvcmxkTWF0cml4KCEwLCExKSxuci5tdWx0aXBseSh0LnBhcmVudC5tYXRyaXhXb3JsZCkpLHQuYXBwbHlNYXRyaXg0KG5yKSx0LnVwZGF0ZVdvcmxkTWF0cml4KCExLCExKSx0aGlzLmFkZCh0KSx0aGlzfSxnZXRPYmplY3RCeUlkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmdldE9iamVjdEJ5UHJvcGVydHkoXCJpZFwiLHQpfSxnZXRPYmplY3RCeU5hbWU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZ2V0T2JqZWN0QnlQcm9wZXJ0eShcIm5hbWVcIix0KX0sZ2V0T2JqZWN0QnlQcm9wZXJ0eTpmdW5jdGlvbih0LGUpe2lmKHRoaXNbdF09PT1lKXJldHVybiB0aGlzO2ZvcihsZXQgaT0wLG49dGhpcy5jaGlsZHJlbi5sZW5ndGg7aTxuO2krKyl7Y29uc3Qgbj10aGlzLmNoaWxkcmVuW2ldLmdldE9iamVjdEJ5UHJvcGVydHkodCxlKTtpZih2b2lkIDAhPT1uKXJldHVybiBufX0sZ2V0V29ybGRQb3NpdGlvbjpmdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwPT09dCYmKGNvbnNvbGUud2FybihcIlRIUkVFLk9iamVjdDNEOiAuZ2V0V29ybGRQb3NpdGlvbigpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgZm4pLHRoaXMudXBkYXRlV29ybGRNYXRyaXgoITAsITEpLHQuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMubWF0cml4V29ybGQpfSxnZXRXb3JsZFF1YXRlcm5pb246ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5PYmplY3QzRDogLmdldFdvcmxkUXVhdGVybmlvbigpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgcG4pLHRoaXMudXBkYXRlV29ybGRNYXRyaXgoITAsITEpLHRoaXMubWF0cml4V29ybGQuZGVjb21wb3NlKHNyLHQsb3IpLHR9LGdldFdvcmxkU2NhbGU6ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5PYmplY3QzRDogLmdldFdvcmxkU2NhbGUoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkXCIpLHQ9bmV3IGZuKSx0aGlzLnVwZGF0ZVdvcmxkTWF0cml4KCEwLCExKSx0aGlzLm1hdHJpeFdvcmxkLmRlY29tcG9zZShzcixhcix0KSx0fSxnZXRXb3JsZERpcmVjdGlvbjpmdW5jdGlvbih0KXt2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiVEhSRUUuT2JqZWN0M0Q6IC5nZXRXb3JsZERpcmVjdGlvbigpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgZm4pLHRoaXMudXBkYXRlV29ybGRNYXRyaXgoITAsITEpO2NvbnN0IGU9dGhpcy5tYXRyaXhXb3JsZC5lbGVtZW50cztyZXR1cm4gdC5zZXQoZVs4XSxlWzldLGVbMTBdKS5ub3JtYWxpemUoKX0scmF5Y2FzdDpmdW5jdGlvbigpe30sdHJhdmVyc2U6ZnVuY3Rpb24odCl7dCh0aGlzKTtjb25zdCBlPXRoaXMuY2hpbGRyZW47Zm9yKGxldCBpPTAsbj1lLmxlbmd0aDtpPG47aSsrKWVbaV0udHJhdmVyc2UodCl9LHRyYXZlcnNlVmlzaWJsZTpmdW5jdGlvbih0KXtpZighMT09PXRoaXMudmlzaWJsZSlyZXR1cm47dCh0aGlzKTtjb25zdCBlPXRoaXMuY2hpbGRyZW47Zm9yKGxldCBpPTAsbj1lLmxlbmd0aDtpPG47aSsrKWVbaV0udHJhdmVyc2VWaXNpYmxlKHQpfSx0cmF2ZXJzZUFuY2VzdG9yczpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMucGFyZW50O251bGwhPT1lJiYodChlKSxlLnRyYXZlcnNlQW5jZXN0b3JzKHQpKX0sdXBkYXRlTWF0cml4OmZ1bmN0aW9uKCl7dGhpcy5tYXRyaXguY29tcG9zZSh0aGlzLnBvc2l0aW9uLHRoaXMucXVhdGVybmlvbix0aGlzLnNjYWxlKSx0aGlzLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGU9ITB9LHVwZGF0ZU1hdHJpeFdvcmxkOmZ1bmN0aW9uKHQpe3RoaXMubWF0cml4QXV0b1VwZGF0ZSYmdGhpcy51cGRhdGVNYXRyaXgoKSwodGhpcy5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlfHx0KSYmKG51bGw9PT10aGlzLnBhcmVudD90aGlzLm1hdHJpeFdvcmxkLmNvcHkodGhpcy5tYXRyaXgpOnRoaXMubWF0cml4V29ybGQubXVsdGlwbHlNYXRyaWNlcyh0aGlzLnBhcmVudC5tYXRyaXhXb3JsZCx0aGlzLm1hdHJpeCksdGhpcy5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlPSExLHQ9ITApO2NvbnN0IGU9dGhpcy5jaGlsZHJlbjtmb3IobGV0IGk9MCxuPWUubGVuZ3RoO2k8bjtpKyspZVtpXS51cGRhdGVNYXRyaXhXb3JsZCh0KX0sdXBkYXRlV29ybGRNYXRyaXg6ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMucGFyZW50O2lmKCEwPT09dCYmbnVsbCE9PWkmJmkudXBkYXRlV29ybGRNYXRyaXgoITAsITEpLHRoaXMubWF0cml4QXV0b1VwZGF0ZSYmdGhpcy51cGRhdGVNYXRyaXgoKSxudWxsPT09dGhpcy5wYXJlbnQ/dGhpcy5tYXRyaXhXb3JsZC5jb3B5KHRoaXMubWF0cml4KTp0aGlzLm1hdHJpeFdvcmxkLm11bHRpcGx5TWF0cmljZXModGhpcy5wYXJlbnQubWF0cml4V29ybGQsdGhpcy5tYXRyaXgpLCEwPT09ZSl7Y29uc3QgdD10aGlzLmNoaWxkcmVuO2ZvcihsZXQgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl0W2VdLnVwZGF0ZVdvcmxkTWF0cml4KCExLCEwKX19LHRvSlNPTjpmdW5jdGlvbih0KXtjb25zdCBlPXZvaWQgMD09PXR8fFwic3RyaW5nXCI9PXR5cGVvZiB0LGk9e307ZSYmKHQ9e2dlb21ldHJpZXM6e30sbWF0ZXJpYWxzOnt9LHRleHR1cmVzOnt9LGltYWdlczp7fSxzaGFwZXM6e30sc2tlbGV0b25zOnt9LGFuaW1hdGlvbnM6e319LGkubWV0YWRhdGE9e3ZlcnNpb246NC41LHR5cGU6XCJPYmplY3RcIixnZW5lcmF0b3I6XCJPYmplY3QzRC50b0pTT05cIn0pO2NvbnN0IG49e307ZnVuY3Rpb24gcihlLGkpe3JldHVybiB2b2lkIDA9PT1lW2kudXVpZF0mJihlW2kudXVpZF09aS50b0pTT04odCkpLGkudXVpZH1pZihuLnV1aWQ9dGhpcy51dWlkLG4udHlwZT10aGlzLnR5cGUsXCJcIiE9PXRoaXMubmFtZSYmKG4ubmFtZT10aGlzLm5hbWUpLCEwPT09dGhpcy5jYXN0U2hhZG93JiYobi5jYXN0U2hhZG93PSEwKSwhMD09PXRoaXMucmVjZWl2ZVNoYWRvdyYmKG4ucmVjZWl2ZVNoYWRvdz0hMCksITE9PT10aGlzLnZpc2libGUmJihuLnZpc2libGU9ITEpLCExPT09dGhpcy5mcnVzdHVtQ3VsbGVkJiYobi5mcnVzdHVtQ3VsbGVkPSExKSwwIT09dGhpcy5yZW5kZXJPcmRlciYmKG4ucmVuZGVyT3JkZXI9dGhpcy5yZW5kZXJPcmRlciksXCJ7fVwiIT09SlNPTi5zdHJpbmdpZnkodGhpcy51c2VyRGF0YSkmJihuLnVzZXJEYXRhPXRoaXMudXNlckRhdGEpLG4ubGF5ZXJzPXRoaXMubGF5ZXJzLm1hc2ssbi5tYXRyaXg9dGhpcy5tYXRyaXgudG9BcnJheSgpLCExPT09dGhpcy5tYXRyaXhBdXRvVXBkYXRlJiYobi5tYXRyaXhBdXRvVXBkYXRlPSExKSx0aGlzLmlzSW5zdGFuY2VkTWVzaCYmKG4udHlwZT1cIkluc3RhbmNlZE1lc2hcIixuLmNvdW50PXRoaXMuY291bnQsbi5pbnN0YW5jZU1hdHJpeD10aGlzLmluc3RhbmNlTWF0cml4LnRvSlNPTigpKSx0aGlzLmlzTWVzaHx8dGhpcy5pc0xpbmV8fHRoaXMuaXNQb2ludHMpe24uZ2VvbWV0cnk9cih0Lmdlb21ldHJpZXMsdGhpcy5nZW9tZXRyeSk7Y29uc3QgZT10aGlzLmdlb21ldHJ5LnBhcmFtZXRlcnM7aWYodm9pZCAwIT09ZSYmdm9pZCAwIT09ZS5zaGFwZXMpe2NvbnN0IGk9ZS5zaGFwZXM7aWYoQXJyYXkuaXNBcnJheShpKSlmb3IobGV0IGU9MCxuPWkubGVuZ3RoO2U8bjtlKyspe2NvbnN0IG49aVtlXTtyKHQuc2hhcGVzLG4pfWVsc2Ugcih0LnNoYXBlcyxpKX19aWYodGhpcy5pc1NraW5uZWRNZXNoJiYobi5iaW5kTW9kZT10aGlzLmJpbmRNb2RlLG4uYmluZE1hdHJpeD10aGlzLmJpbmRNYXRyaXgudG9BcnJheSgpLHZvaWQgMCE9PXRoaXMuc2tlbGV0b24mJihyKHQuc2tlbGV0b25zLHRoaXMuc2tlbGV0b24pLG4uc2tlbGV0b249dGhpcy5za2VsZXRvbi51dWlkKSksdm9pZCAwIT09dGhpcy5tYXRlcmlhbClpZihBcnJheS5pc0FycmF5KHRoaXMubWF0ZXJpYWwpKXtjb25zdCBlPVtdO2ZvcihsZXQgaT0wLG49dGhpcy5tYXRlcmlhbC5sZW5ndGg7aTxuO2krKyllLnB1c2gocih0Lm1hdGVyaWFscyx0aGlzLm1hdGVyaWFsW2ldKSk7bi5tYXRlcmlhbD1lfWVsc2Ugbi5tYXRlcmlhbD1yKHQubWF0ZXJpYWxzLHRoaXMubWF0ZXJpYWwpO2lmKHRoaXMuY2hpbGRyZW4ubGVuZ3RoPjApe24uY2hpbGRyZW49W107Zm9yKGxldCBlPTA7ZTx0aGlzLmNoaWxkcmVuLmxlbmd0aDtlKyspbi5jaGlsZHJlbi5wdXNoKHRoaXMuY2hpbGRyZW5bZV0udG9KU09OKHQpLm9iamVjdCl9aWYodGhpcy5hbmltYXRpb25zLmxlbmd0aD4wKXtuLmFuaW1hdGlvbnM9W107Zm9yKGxldCBlPTA7ZTx0aGlzLmFuaW1hdGlvbnMubGVuZ3RoO2UrKyl7Y29uc3QgaT10aGlzLmFuaW1hdGlvbnNbZV07bi5hbmltYXRpb25zLnB1c2gocih0LmFuaW1hdGlvbnMsaSkpfX1pZihlKXtjb25zdCBlPXModC5nZW9tZXRyaWVzKSxuPXModC5tYXRlcmlhbHMpLHI9cyh0LnRleHR1cmVzKSxvPXModC5pbWFnZXMpLGE9cyh0LnNoYXBlcyksYz1zKHQuc2tlbGV0b25zKSxoPXModC5hbmltYXRpb25zKTtlLmxlbmd0aD4wJiYoaS5nZW9tZXRyaWVzPWUpLG4ubGVuZ3RoPjAmJihpLm1hdGVyaWFscz1uKSxyLmxlbmd0aD4wJiYoaS50ZXh0dXJlcz1yKSxvLmxlbmd0aD4wJiYoaS5pbWFnZXM9byksYS5sZW5ndGg+MCYmKGkuc2hhcGVzPWEpLGMubGVuZ3RoPjAmJihpLnNrZWxldG9ucz1jKSxoLmxlbmd0aD4wJiYoaS5hbmltYXRpb25zPWgpfXJldHVybiBpLm9iamVjdD1uLGk7ZnVuY3Rpb24gcyh0KXtjb25zdCBlPVtdO2Zvcihjb25zdCBpIGluIHQpe2NvbnN0IG49dFtpXTtkZWxldGUgbi5tZXRhZGF0YSxlLnB1c2gobil9cmV0dXJuIGV9fSxjbG9uZTpmdW5jdGlvbih0KXtyZXR1cm4obmV3IHRoaXMuY29uc3RydWN0b3IpLmNvcHkodGhpcyx0KX0sY29weTpmdW5jdGlvbih0LGU9ITApe2lmKHRoaXMubmFtZT10Lm5hbWUsdGhpcy51cC5jb3B5KHQudXApLHRoaXMucG9zaXRpb24uY29weSh0LnBvc2l0aW9uKSx0aGlzLnJvdGF0aW9uLm9yZGVyPXQucm90YXRpb24ub3JkZXIsdGhpcy5xdWF0ZXJuaW9uLmNvcHkodC5xdWF0ZXJuaW9uKSx0aGlzLnNjYWxlLmNvcHkodC5zY2FsZSksdGhpcy5tYXRyaXguY29weSh0Lm1hdHJpeCksdGhpcy5tYXRyaXhXb3JsZC5jb3B5KHQubWF0cml4V29ybGQpLHRoaXMubWF0cml4QXV0b1VwZGF0ZT10Lm1hdHJpeEF1dG9VcGRhdGUsdGhpcy5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlPXQubWF0cml4V29ybGROZWVkc1VwZGF0ZSx0aGlzLmxheWVycy5tYXNrPXQubGF5ZXJzLm1hc2ssdGhpcy52aXNpYmxlPXQudmlzaWJsZSx0aGlzLmNhc3RTaGFkb3c9dC5jYXN0U2hhZG93LHRoaXMucmVjZWl2ZVNoYWRvdz10LnJlY2VpdmVTaGFkb3csdGhpcy5mcnVzdHVtQ3VsbGVkPXQuZnJ1c3R1bUN1bGxlZCx0aGlzLnJlbmRlck9yZGVyPXQucmVuZGVyT3JkZXIsdGhpcy51c2VyRGF0YT1KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHQudXNlckRhdGEpKSwhMD09PWUpZm9yKGxldCBlPTA7ZTx0LmNoaWxkcmVuLmxlbmd0aDtlKyspe2NvbnN0IGk9dC5jaGlsZHJlbltlXTt0aGlzLmFkZChpLmNsb25lKCkpfXJldHVybiB0aGlzfX0pO2NvbnN0IGZyPW5ldyBmbixtcj1uZXcgZm4sZ3I9bmV3IHNuO2NsYXNzIF9ye2NvbnN0cnVjdG9yKHQsZSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpc1BsYW5lXCIse3ZhbHVlOiEwfSksdGhpcy5ub3JtYWw9dm9pZCAwIT09dD90Om5ldyBmbigxLDAsMCksdGhpcy5jb25zdGFudD12b2lkIDAhPT1lP2U6MH1zZXQodCxlKXtyZXR1cm4gdGhpcy5ub3JtYWwuY29weSh0KSx0aGlzLmNvbnN0YW50PWUsdGhpc31zZXRDb21wb25lbnRzKHQsZSxpLG4pe3JldHVybiB0aGlzLm5vcm1hbC5zZXQodCxlLGkpLHRoaXMuY29uc3RhbnQ9bix0aGlzfXNldEZyb21Ob3JtYWxBbmRDb3BsYW5hclBvaW50KHQsZSl7cmV0dXJuIHRoaXMubm9ybWFsLmNvcHkodCksdGhpcy5jb25zdGFudD0tZS5kb3QodGhpcy5ub3JtYWwpLHRoaXN9c2V0RnJvbUNvcGxhbmFyUG9pbnRzKHQsZSxpKXtjb25zdCBuPWZyLnN1YlZlY3RvcnMoaSxlKS5jcm9zcyhtci5zdWJWZWN0b3JzKHQsZSkpLm5vcm1hbGl6ZSgpO3JldHVybiB0aGlzLnNldEZyb21Ob3JtYWxBbmRDb3BsYW5hclBvaW50KG4sdCksdGhpc31jbG9uZSgpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuY29weSh0aGlzKX1jb3B5KHQpe3JldHVybiB0aGlzLm5vcm1hbC5jb3B5KHQubm9ybWFsKSx0aGlzLmNvbnN0YW50PXQuY29uc3RhbnQsdGhpc31ub3JtYWxpemUoKXtjb25zdCB0PTEvdGhpcy5ub3JtYWwubGVuZ3RoKCk7cmV0dXJuIHRoaXMubm9ybWFsLm11bHRpcGx5U2NhbGFyKHQpLHRoaXMuY29uc3RhbnQqPXQsdGhpc31uZWdhdGUoKXtyZXR1cm4gdGhpcy5jb25zdGFudCo9LTEsdGhpcy5ub3JtYWwubmVnYXRlKCksdGhpc31kaXN0YW5jZVRvUG9pbnQodCl7cmV0dXJuIHRoaXMubm9ybWFsLmRvdCh0KSt0aGlzLmNvbnN0YW50fWRpc3RhbmNlVG9TcGhlcmUodCl7cmV0dXJuIHRoaXMuZGlzdGFuY2VUb1BvaW50KHQuY2VudGVyKS10LnJhZGl1c31wcm9qZWN0UG9pbnQodCxlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGNvbnNvbGUud2FybihcIlRIUkVFLlBsYW5lOiAucHJvamVjdFBvaW50KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBmbiksZS5jb3B5KHRoaXMubm9ybWFsKS5tdWx0aXBseVNjYWxhcigtdGhpcy5kaXN0YW5jZVRvUG9pbnQodCkpLmFkZCh0KX1pbnRlcnNlY3RMaW5lKHQsZSl7dm9pZCAwPT09ZSYmKGNvbnNvbGUud2FybihcIlRIUkVFLlBsYW5lOiAuaW50ZXJzZWN0TGluZSgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksZT1uZXcgZm4pO2NvbnN0IGk9dC5kZWx0YShmciksbj10aGlzLm5vcm1hbC5kb3QoaSk7aWYoMD09PW4pcmV0dXJuIDA9PT10aGlzLmRpc3RhbmNlVG9Qb2ludCh0LnN0YXJ0KT9lLmNvcHkodC5zdGFydCk6dm9pZCAwO2NvbnN0IHI9LSh0LnN0YXJ0LmRvdCh0aGlzLm5vcm1hbCkrdGhpcy5jb25zdGFudCkvbjtyZXR1cm4gcjwwfHxyPjE/dm9pZCAwOmUuY29weShpKS5tdWx0aXBseVNjYWxhcihyKS5hZGQodC5zdGFydCl9aW50ZXJzZWN0c0xpbmUodCl7Y29uc3QgZT10aGlzLmRpc3RhbmNlVG9Qb2ludCh0LnN0YXJ0KSxpPXRoaXMuZGlzdGFuY2VUb1BvaW50KHQuZW5kKTtyZXR1cm4gZTwwJiZpPjB8fGk8MCYmZT4wfWludGVyc2VjdHNCb3godCl7cmV0dXJuIHQuaW50ZXJzZWN0c1BsYW5lKHRoaXMpfWludGVyc2VjdHNTcGhlcmUodCl7cmV0dXJuIHQuaW50ZXJzZWN0c1BsYW5lKHRoaXMpfWNvcGxhbmFyUG9pbnQodCl7cmV0dXJuIHZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5QbGFuZTogLmNvcGxhbmFyUG9pbnQoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkXCIpLHQ9bmV3IGZuKSx0LmNvcHkodGhpcy5ub3JtYWwpLm11bHRpcGx5U2NhbGFyKC10aGlzLmNvbnN0YW50KX1hcHBseU1hdHJpeDQodCxlKXtjb25zdCBpPWV8fGdyLmdldE5vcm1hbE1hdHJpeCh0KSxuPXRoaXMuY29wbGFuYXJQb2ludChmcikuYXBwbHlNYXRyaXg0KHQpLHI9dGhpcy5ub3JtYWwuYXBwbHlNYXRyaXgzKGkpLm5vcm1hbGl6ZSgpO3JldHVybiB0aGlzLmNvbnN0YW50PS1uLmRvdChyKSx0aGlzfXRyYW5zbGF0ZSh0KXtyZXR1cm4gdGhpcy5jb25zdGFudC09dC5kb3QodGhpcy5ub3JtYWwpLHRoaXN9ZXF1YWxzKHQpe3JldHVybiB0Lm5vcm1hbC5lcXVhbHModGhpcy5ub3JtYWwpJiZ0LmNvbnN0YW50PT09dGhpcy5jb25zdGFudH19Y29uc3QgdnI9bmV3IGZuLHlyPW5ldyBmbixicj1uZXcgZm4seHI9bmV3IGZuLHdyPW5ldyBmbixTcj1uZXcgZm4sTXI9bmV3IGZuLFRyPW5ldyBmbixDcj1uZXcgZm4sRXI9bmV3IGZuO2NsYXNzIElye2NvbnN0cnVjdG9yKHQsZSxpKXt0aGlzLmE9dm9pZCAwIT09dD90Om5ldyBmbix0aGlzLmI9dm9pZCAwIT09ZT9lOm5ldyBmbix0aGlzLmM9dm9pZCAwIT09aT9pOm5ldyBmbn1zdGF0aWMgZ2V0Tm9ybWFsKHQsZSxpLG4pe3ZvaWQgMD09PW4mJihjb25zb2xlLndhcm4oXCJUSFJFRS5UcmlhbmdsZTogLmdldE5vcm1hbCgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksbj1uZXcgZm4pLG4uc3ViVmVjdG9ycyhpLGUpLHZyLnN1YlZlY3RvcnModCxlKSxuLmNyb3NzKHZyKTtjb25zdCByPW4ubGVuZ3RoU3EoKTtyZXR1cm4gcj4wP24ubXVsdGlwbHlTY2FsYXIoMS9NYXRoLnNxcnQocikpOm4uc2V0KDAsMCwwKX1zdGF0aWMgZ2V0QmFyeWNvb3JkKHQsZSxpLG4scil7dnIuc3ViVmVjdG9ycyhuLGUpLHlyLnN1YlZlY3RvcnMoaSxlKSxici5zdWJWZWN0b3JzKHQsZSk7Y29uc3Qgcz12ci5kb3QodnIpLG89dnIuZG90KHlyKSxhPXZyLmRvdChiciksYz15ci5kb3QoeXIpLGg9eXIuZG90KGJyKSxsPXMqYy1vKm87aWYodm9pZCAwPT09ciYmKGNvbnNvbGUud2FybihcIlRIUkVFLlRyaWFuZ2xlOiAuZ2V0QmFyeWNvb3JkKCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxyPW5ldyBmbiksMD09PWwpcmV0dXJuIHIuc2V0KC0yLC0xLC0xKTtjb25zdCB1PTEvbCxkPShjKmEtbypoKSp1LHA9KHMqaC1vKmEpKnU7cmV0dXJuIHIuc2V0KDEtZC1wLHAsZCl9c3RhdGljIGNvbnRhaW5zUG9pbnQodCxlLGksbil7cmV0dXJuIHRoaXMuZ2V0QmFyeWNvb3JkKHQsZSxpLG4seHIpLHhyLng+PTAmJnhyLnk+PTAmJnhyLngreHIueTw9MX1zdGF0aWMgZ2V0VVYodCxlLGksbixyLHMsbyxhKXtyZXR1cm4gdGhpcy5nZXRCYXJ5Y29vcmQodCxlLGksbix4ciksYS5zZXQoMCwwKSxhLmFkZFNjYWxlZFZlY3RvcihyLHhyLngpLGEuYWRkU2NhbGVkVmVjdG9yKHMseHIueSksYS5hZGRTY2FsZWRWZWN0b3Iobyx4ci56KSxhfXN0YXRpYyBpc0Zyb250RmFjaW5nKHQsZSxpLG4pe3JldHVybiB2ci5zdWJWZWN0b3JzKGksZSkseXIuc3ViVmVjdG9ycyh0LGUpLHZyLmNyb3NzKHlyKS5kb3Qobik8MH1zZXQodCxlLGkpe3JldHVybiB0aGlzLmEuY29weSh0KSx0aGlzLmIuY29weShlKSx0aGlzLmMuY29weShpKSx0aGlzfXNldEZyb21Qb2ludHNBbmRJbmRpY2VzKHQsZSxpLG4pe3JldHVybiB0aGlzLmEuY29weSh0W2VdKSx0aGlzLmIuY29weSh0W2ldKSx0aGlzLmMuY29weSh0W25dKSx0aGlzfWNsb25lKCl7cmV0dXJuKG5ldyB0aGlzLmNvbnN0cnVjdG9yKS5jb3B5KHRoaXMpfWNvcHkodCl7cmV0dXJuIHRoaXMuYS5jb3B5KHQuYSksdGhpcy5iLmNvcHkodC5iKSx0aGlzLmMuY29weSh0LmMpLHRoaXN9Z2V0QXJlYSgpe3JldHVybiB2ci5zdWJWZWN0b3JzKHRoaXMuYyx0aGlzLmIpLHlyLnN1YlZlY3RvcnModGhpcy5hLHRoaXMuYiksLjUqdnIuY3Jvc3MoeXIpLmxlbmd0aCgpfWdldE1pZHBvaW50KHQpe3JldHVybiB2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiVEhSRUUuVHJpYW5nbGU6IC5nZXRNaWRwb2ludCgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgZm4pLHQuYWRkVmVjdG9ycyh0aGlzLmEsdGhpcy5iKS5hZGQodGhpcy5jKS5tdWx0aXBseVNjYWxhcigxLzMpfWdldE5vcm1hbCh0KXtyZXR1cm4gSXIuZ2V0Tm9ybWFsKHRoaXMuYSx0aGlzLmIsdGhpcy5jLHQpfWdldFBsYW5lKHQpe3JldHVybiB2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiVEhSRUUuVHJpYW5nbGU6IC5nZXRQbGFuZSgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgX3IpLHQuc2V0RnJvbUNvcGxhbmFyUG9pbnRzKHRoaXMuYSx0aGlzLmIsdGhpcy5jKX1nZXRCYXJ5Y29vcmQodCxlKXtyZXR1cm4gSXIuZ2V0QmFyeWNvb3JkKHQsdGhpcy5hLHRoaXMuYix0aGlzLmMsZSl9Z2V0VVYodCxlLGksbixyKXtyZXR1cm4gSXIuZ2V0VVYodCx0aGlzLmEsdGhpcy5iLHRoaXMuYyxlLGksbixyKX1jb250YWluc1BvaW50KHQpe3JldHVybiBJci5jb250YWluc1BvaW50KHQsdGhpcy5hLHRoaXMuYix0aGlzLmMpfWlzRnJvbnRGYWNpbmcodCl7cmV0dXJuIElyLmlzRnJvbnRGYWNpbmcodGhpcy5hLHRoaXMuYix0aGlzLmMsdCl9aW50ZXJzZWN0c0JveCh0KXtyZXR1cm4gdC5pbnRlcnNlY3RzVHJpYW5nbGUodGhpcyl9Y2xvc2VzdFBvaW50VG9Qb2ludCh0LGUpe3ZvaWQgMD09PWUmJihjb25zb2xlLndhcm4oXCJUSFJFRS5UcmlhbmdsZTogLmNsb3Nlc3RQb2ludFRvUG9pbnQoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkXCIpLGU9bmV3IGZuKTtjb25zdCBpPXRoaXMuYSxuPXRoaXMuYixyPXRoaXMuYztsZXQgcyxvO3dyLnN1YlZlY3RvcnMobixpKSxTci5zdWJWZWN0b3JzKHIsaSksVHIuc3ViVmVjdG9ycyh0LGkpO2NvbnN0IGE9d3IuZG90KFRyKSxjPVNyLmRvdChUcik7aWYoYTw9MCYmYzw9MClyZXR1cm4gZS5jb3B5KGkpO0NyLnN1YlZlY3RvcnModCxuKTtjb25zdCBoPXdyLmRvdChDciksbD1Tci5kb3QoQ3IpO2lmKGg+PTAmJmw8PWgpcmV0dXJuIGUuY29weShuKTtjb25zdCB1PWEqbC1oKmM7aWYodTw9MCYmYT49MCYmaDw9MClyZXR1cm4gcz1hLyhhLWgpLGUuY29weShpKS5hZGRTY2FsZWRWZWN0b3Iod3Iscyk7RXIuc3ViVmVjdG9ycyh0LHIpO2NvbnN0IGQ9d3IuZG90KEVyKSxwPVNyLmRvdChFcik7aWYocD49MCYmZDw9cClyZXR1cm4gZS5jb3B5KHIpO2NvbnN0IGY9ZCpjLWEqcDtpZihmPD0wJiZjPj0wJiZwPD0wKXJldHVybiBvPWMvKGMtcCksZS5jb3B5KGkpLmFkZFNjYWxlZFZlY3RvcihTcixvKTtjb25zdCBtPWgqcC1kKmw7aWYobTw9MCYmbC1oPj0wJiZkLXA+PTApcmV0dXJuIE1yLnN1YlZlY3RvcnMocixuKSxvPShsLWgpLyhsLWgrKGQtcCkpLGUuY29weShuKS5hZGRTY2FsZWRWZWN0b3IoTXIsbyk7Y29uc3QgZz0xLyhtK2YrdSk7cmV0dXJuIHM9ZipnLG89dSpnLGUuY29weShpKS5hZGRTY2FsZWRWZWN0b3Iod3IscykuYWRkU2NhbGVkVmVjdG9yKFNyLG8pfWVxdWFscyh0KXtyZXR1cm4gdC5hLmVxdWFscyh0aGlzLmEpJiZ0LmIuZXF1YWxzKHRoaXMuYikmJnQuYy5lcXVhbHModGhpcy5jKX19Y29uc3QgQXI9e2FsaWNlYmx1ZToxNTc5MjM4MyxhbnRpcXVld2hpdGU6MTY0NDQzNzUsYXF1YTo2NTUzNSxhcXVhbWFyaW5lOjgzODg1NjQsYXp1cmU6MTU3OTQxNzUsYmVpZ2U6MTYxMTkyNjAsYmlzcXVlOjE2NzcwMjQ0LGJsYWNrOjAsYmxhbmNoZWRhbG1vbmQ6MTY3NzIwNDUsYmx1ZToyNTUsYmx1ZXZpb2xldDo5MDU1MjAyLGJyb3duOjEwODI0MjM0LGJ1cmx5d29vZDoxNDU5NjIzMSxjYWRldGJsdWU6NjI2NjUyOCxjaGFydHJldXNlOjgzODgzNTIsY2hvY29sYXRlOjEzNzg5NDcwLGNvcmFsOjE2NzQ0MjcyLGNvcm5mbG93ZXJibHVlOjY1OTE5ODEsY29ybnNpbGs6MTY3NzUzODgsY3JpbXNvbjoxNDQyMzEwMCxjeWFuOjY1NTM1LGRhcmtibHVlOjEzOSxkYXJrY3lhbjozNTcyMyxkYXJrZ29sZGVucm9kOjEyMDkyOTM5LGRhcmtncmF5OjExMTE5MDE3LGRhcmtncmVlbjoyNTYwMCxkYXJrZ3JleToxMTExOTAxNyxkYXJra2hha2k6MTI0MzMyNTksZGFya21hZ2VudGE6OTEwOTY0MyxkYXJrb2xpdmVncmVlbjo1NTk3OTk5LGRhcmtvcmFuZ2U6MTY3NDc1MjAsZGFya29yY2hpZDoxMDA0MDAxMixkYXJrcmVkOjkxMDk1MDQsZGFya3NhbG1vbjoxNTMwODQxMCxkYXJrc2VhZ3JlZW46OTQxOTkxOSxkYXJrc2xhdGVibHVlOjQ3MzQzNDcsZGFya3NsYXRlZ3JheTozMTAwNDk1LGRhcmtzbGF0ZWdyZXk6MzEwMDQ5NSxkYXJrdHVycXVvaXNlOjUyOTQ1LGRhcmt2aW9sZXQ6OTY5OTUzOSxkZWVwcGluazoxNjcxNjk0NyxkZWVwc2t5Ymx1ZTo0OTE1MSxkaW1ncmF5OjY5MDgyNjUsZGltZ3JleTo2OTA4MjY1LGRvZGdlcmJsdWU6MjAwMzE5OSxmaXJlYnJpY2s6MTE2NzQxNDYsZmxvcmFsd2hpdGU6MTY3NzU5MjAsZm9yZXN0Z3JlZW46MjI2Mzg0MixmdWNoc2lhOjE2NzExOTM1LGdhaW5zYm9ybzoxNDQ3NDQ2MCxnaG9zdHdoaXRlOjE2MzE2NjcxLGdvbGQ6MTY3NjY3MjAsZ29sZGVucm9kOjE0MzI5MTIwLGdyYXk6ODQyMTUwNCxncmVlbjozMjc2OCxncmVlbnllbGxvdzoxMTQwMzA1NSxncmV5Ojg0MjE1MDQsaG9uZXlkZXc6MTU3OTQxNjAsaG90cGluazoxNjczODc0MCxpbmRpYW5yZWQ6MTM0NTg1MjQsaW5kaWdvOjQ5MTUzMzAsaXZvcnk6MTY3NzcyMDAsa2hha2k6MTU3ODc2NjAsbGF2ZW5kZXI6MTUxMzI0MTAsbGF2ZW5kZXJibHVzaDoxNjc3MzM2NSxsYXduZ3JlZW46ODE5MDk3NixsZW1vbmNoaWZmb246MTY3NzU4ODUsbGlnaHRibHVlOjExMzkzMjU0LGxpZ2h0Y29yYWw6MTU3NjE1MzYsbGlnaHRjeWFuOjE0NzQ1NTk5LGxpZ2h0Z29sZGVucm9keWVsbG93OjE2NDQ4MjEwLGxpZ2h0Z3JheToxMzg4MjMyMyxsaWdodGdyZWVuOjk0OTgyNTYsbGlnaHRncmV5OjEzODgyMzIzLGxpZ2h0cGluazoxNjc1ODQ2NSxsaWdodHNhbG1vbjoxNjc1Mjc2MixsaWdodHNlYWdyZWVuOjIxNDI4OTAsbGlnaHRza3libHVlOjg5MDAzNDYsbGlnaHRzbGF0ZWdyYXk6NzgzMzc1MyxsaWdodHNsYXRlZ3JleTo3ODMzNzUzLGxpZ2h0c3RlZWxibHVlOjExNTg0NzM0LGxpZ2h0eWVsbG93OjE2Nzc3MTg0LGxpbWU6NjUyODAsbGltZWdyZWVuOjMzMjkzMzAsbGluZW46MTY0NDU2NzAsbWFnZW50YToxNjcxMTkzNSxtYXJvb246ODM4ODYwOCxtZWRpdW1hcXVhbWFyaW5lOjY3MzczMjIsbWVkaXVtYmx1ZToyMDUsbWVkaXVtb3JjaGlkOjEyMjExNjY3LG1lZGl1bXB1cnBsZTo5NjYyNjgzLG1lZGl1bXNlYWdyZWVuOjM5NzgwOTcsbWVkaXVtc2xhdGVibHVlOjgwODc3OTAsbWVkaXVtc3ByaW5nZ3JlZW46NjQxNTQsbWVkaXVtdHVycXVvaXNlOjQ3NzIzMDAsbWVkaXVtdmlvbGV0cmVkOjEzMDQ3MTczLG1pZG5pZ2h0Ymx1ZToxNjQ0OTEyLG1pbnRjcmVhbToxNjEyMTg1MCxtaXN0eXJvc2U6MTY3NzAyNzMsbW9jY2FzaW46MTY3NzAyMjksbmF2YWpvd2hpdGU6MTY3Njg2ODUsbmF2eToxMjgsb2xkbGFjZToxNjY0MzU1OCxvbGl2ZTo4NDIxMzc2LG9saXZlZHJhYjo3MDQ4NzM5LG9yYW5nZToxNjc1MzkyMCxvcmFuZ2VyZWQ6MTY3MjkzNDQsb3JjaGlkOjE0MzE1NzM0LHBhbGVnb2xkZW5yb2Q6MTU2NTcxMzAscGFsZWdyZWVuOjEwMDI1ODgwLHBhbGV0dXJxdW9pc2U6MTE1Mjk5NjYscGFsZXZpb2xldHJlZDoxNDM4MTIwMyxwYXBheWF3aGlwOjE2NzczMDc3LHBlYWNocHVmZjoxNjc2NzY3MyxwZXJ1OjEzNDY4OTkxLHBpbms6MTY3NjEwMzUscGx1bToxNDUyNDYzNyxwb3dkZXJibHVlOjExNTkxOTEwLHB1cnBsZTo4Mzg4NzM2LHJlYmVjY2FwdXJwbGU6NjY5Nzg4MSxyZWQ6MTY3MTE2ODAscm9zeWJyb3duOjEyMzU3NTE5LHJveWFsYmx1ZTo0Mjg2OTQ1LHNhZGRsZWJyb3duOjkxMjcxODcsc2FsbW9uOjE2NDE2ODgyLHNhbmR5YnJvd246MTYwMzI4NjQsc2VhZ3JlZW46MzA1MDMyNyxzZWFzaGVsbDoxNjc3NDYzOCxzaWVubmE6MTA1MDY3OTcsc2lsdmVyOjEyNjMyMjU2LHNreWJsdWU6ODkwMDMzMSxzbGF0ZWJsdWU6Njk3MDA2MSxzbGF0ZWdyYXk6NzM3Mjk0NCxzbGF0ZWdyZXk6NzM3Mjk0NCxzbm93OjE2Nzc1OTMwLHNwcmluZ2dyZWVuOjY1NDA3LHN0ZWVsYmx1ZTo0NjIwOTgwLHRhbjoxMzgwODc4MCx0ZWFsOjMyODk2LHRoaXN0bGU6MTQyMDQ4ODgsdG9tYXRvOjE2NzM3MDk1LHR1cnF1b2lzZTo0MjUxODU2LHZpb2xldDoxNTYzMTA4Nix3aGVhdDoxNjExMzMzMSx3aGl0ZToxNjc3NzIxNSx3aGl0ZXNtb2tlOjE2MTE5Mjg1LHllbGxvdzoxNjc3Njk2MCx5ZWxsb3dncmVlbjoxMDE0NTA3NH0sUHI9e2g6MCxzOjAsbDowfSxScj17aDowLHM6MCxsOjB9O2Z1bmN0aW9uIExyKHQsZSxpKXtyZXR1cm4gaTwwJiYoaSs9MSksaT4xJiYoaS09MSksaTwxLzY/dCs2KihlLXQpKmk6aTwuNT9lOmk8Mi8zP3QrNiooZS10KSooMi8zLWkpOnR9ZnVuY3Rpb24gT3IodCl7cmV0dXJuIHQ8LjA0MDQ1Py4wNzczOTkzODA4KnQ6TWF0aC5wb3coLjk0Nzg2NzI5ODYqdCsuMDUyMTMyNzAxNCwyLjQpfWZ1bmN0aW9uIE5yKHQpe3JldHVybiB0PC4wMDMxMzA4PzEyLjkyKnQ6MS4wNTUqTWF0aC5wb3codCwuNDE2NjYpLS4wNTV9Y2xhc3MgRHJ7Y29uc3RydWN0b3IodCxlLGkpe3JldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzQ29sb3JcIix7dmFsdWU6ITB9KSx2b2lkIDA9PT1lJiZ2b2lkIDA9PT1pP3RoaXMuc2V0KHQpOnRoaXMuc2V0UkdCKHQsZSxpKX1zZXQodCl7cmV0dXJuIHQmJnQuaXNDb2xvcj90aGlzLmNvcHkodCk6XCJudW1iZXJcIj09dHlwZW9mIHQ/dGhpcy5zZXRIZXgodCk6XCJzdHJpbmdcIj09dHlwZW9mIHQmJnRoaXMuc2V0U3R5bGUodCksdGhpc31zZXRTY2FsYXIodCl7cmV0dXJuIHRoaXMucj10LHRoaXMuZz10LHRoaXMuYj10LHRoaXN9c2V0SGV4KHQpe3JldHVybiB0PU1hdGguZmxvb3IodCksdGhpcy5yPSh0Pj4xNiYyNTUpLzI1NSx0aGlzLmc9KHQ+PjgmMjU1KS8yNTUsdGhpcy5iPSgyNTUmdCkvMjU1LHRoaXN9c2V0UkdCKHQsZSxpKXtyZXR1cm4gdGhpcy5yPXQsdGhpcy5nPWUsdGhpcy5iPWksdGhpc31zZXRIU0wodCxlLGkpe2lmKHQ9bm4uZXVjbGlkZWFuTW9kdWxvKHQsMSksZT1ubi5jbGFtcChlLDAsMSksaT1ubi5jbGFtcChpLDAsMSksMD09PWUpdGhpcy5yPXRoaXMuZz10aGlzLmI9aTtlbHNle2NvbnN0IG49aTw9LjU/aSooMStlKTppK2UtaSplLHI9MippLW47dGhpcy5yPUxyKHIsbix0KzEvMyksdGhpcy5nPUxyKHIsbix0KSx0aGlzLmI9THIocixuLHQtMS8zKX1yZXR1cm4gdGhpc31zZXRTdHlsZSh0KXtmdW5jdGlvbiBlKGUpe3ZvaWQgMCE9PWUmJnBhcnNlRmxvYXQoZSk8MSYmY29uc29sZS53YXJuKFwiVEhSRUUuQ29sb3I6IEFscGhhIGNvbXBvbmVudCBvZiBcIit0K1wiIHdpbGwgYmUgaWdub3JlZC5cIil9bGV0IGk7aWYoaT0vXigoPzpyZ2J8aHNsKWE/KVxcKChbXlxcKV0qKVxcKS8uZXhlYyh0KSl7bGV0IHQ7Y29uc3Qgbj1pWzFdLHI9aVsyXTtzd2l0Y2gobil7Y2FzZVwicmdiXCI6Y2FzZVwicmdiYVwiOmlmKHQ9L15cXHMqKFxcZCspXFxzKixcXHMqKFxcZCspXFxzKixcXHMqKFxcZCspXFxzKig/OixcXHMqKFxcZCpcXC4/XFxkKylcXHMqKT8kLy5leGVjKHIpKXJldHVybiB0aGlzLnI9TWF0aC5taW4oMjU1LHBhcnNlSW50KHRbMV0sMTApKS8yNTUsdGhpcy5nPU1hdGgubWluKDI1NSxwYXJzZUludCh0WzJdLDEwKSkvMjU1LHRoaXMuYj1NYXRoLm1pbigyNTUscGFyc2VJbnQodFszXSwxMCkpLzI1NSxlKHRbNF0pLHRoaXM7aWYodD0vXlxccyooXFxkKylcXCVcXHMqLFxccyooXFxkKylcXCVcXHMqLFxccyooXFxkKylcXCVcXHMqKD86LFxccyooXFxkKlxcLj9cXGQrKVxccyopPyQvLmV4ZWMocikpcmV0dXJuIHRoaXMucj1NYXRoLm1pbigxMDAscGFyc2VJbnQodFsxXSwxMCkpLzEwMCx0aGlzLmc9TWF0aC5taW4oMTAwLHBhcnNlSW50KHRbMl0sMTApKS8xMDAsdGhpcy5iPU1hdGgubWluKDEwMCxwYXJzZUludCh0WzNdLDEwKSkvMTAwLGUodFs0XSksdGhpczticmVhaztjYXNlXCJoc2xcIjpjYXNlXCJoc2xhXCI6aWYodD0vXlxccyooXFxkKlxcLj9cXGQrKVxccyosXFxzKihcXGQrKVxcJVxccyosXFxzKihcXGQrKVxcJVxccyooPzosXFxzKihcXGQqXFwuP1xcZCspXFxzKik/JC8uZXhlYyhyKSl7Y29uc3QgaT1wYXJzZUZsb2F0KHRbMV0pLzM2MCxuPXBhcnNlSW50KHRbMl0sMTApLzEwMCxyPXBhcnNlSW50KHRbM10sMTApLzEwMDtyZXR1cm4gZSh0WzRdKSx0aGlzLnNldEhTTChpLG4scil9fX1lbHNlIGlmKGk9L15cXCMoW0EtRmEtZlxcZF0rKSQvLmV4ZWModCkpe2NvbnN0IHQ9aVsxXSxlPXQubGVuZ3RoO2lmKDM9PT1lKXJldHVybiB0aGlzLnI9cGFyc2VJbnQodC5jaGFyQXQoMCkrdC5jaGFyQXQoMCksMTYpLzI1NSx0aGlzLmc9cGFyc2VJbnQodC5jaGFyQXQoMSkrdC5jaGFyQXQoMSksMTYpLzI1NSx0aGlzLmI9cGFyc2VJbnQodC5jaGFyQXQoMikrdC5jaGFyQXQoMiksMTYpLzI1NSx0aGlzO2lmKDY9PT1lKXJldHVybiB0aGlzLnI9cGFyc2VJbnQodC5jaGFyQXQoMCkrdC5jaGFyQXQoMSksMTYpLzI1NSx0aGlzLmc9cGFyc2VJbnQodC5jaGFyQXQoMikrdC5jaGFyQXQoMyksMTYpLzI1NSx0aGlzLmI9cGFyc2VJbnQodC5jaGFyQXQoNCkrdC5jaGFyQXQoNSksMTYpLzI1NSx0aGlzfXJldHVybiB0JiZ0Lmxlbmd0aD4wP3RoaXMuc2V0Q29sb3JOYW1lKHQpOnRoaXN9c2V0Q29sb3JOYW1lKHQpe2NvbnN0IGU9QXJbdF07cmV0dXJuIHZvaWQgMCE9PWU/dGhpcy5zZXRIZXgoZSk6Y29uc29sZS53YXJuKFwiVEhSRUUuQ29sb3I6IFVua25vd24gY29sb3IgXCIrdCksdGhpc31jbG9uZSgpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnIsdGhpcy5nLHRoaXMuYil9Y29weSh0KXtyZXR1cm4gdGhpcy5yPXQucix0aGlzLmc9dC5nLHRoaXMuYj10LmIsdGhpc31jb3B5R2FtbWFUb0xpbmVhcih0LGU9Mil7cmV0dXJuIHRoaXMucj1NYXRoLnBvdyh0LnIsZSksdGhpcy5nPU1hdGgucG93KHQuZyxlKSx0aGlzLmI9TWF0aC5wb3codC5iLGUpLHRoaXN9Y29weUxpbmVhclRvR2FtbWEodCxlPTIpe2NvbnN0IGk9ZT4wPzEvZToxO3JldHVybiB0aGlzLnI9TWF0aC5wb3codC5yLGkpLHRoaXMuZz1NYXRoLnBvdyh0LmcsaSksdGhpcy5iPU1hdGgucG93KHQuYixpKSx0aGlzfWNvbnZlcnRHYW1tYVRvTGluZWFyKHQpe3JldHVybiB0aGlzLmNvcHlHYW1tYVRvTGluZWFyKHRoaXMsdCksdGhpc31jb252ZXJ0TGluZWFyVG9HYW1tYSh0KXtyZXR1cm4gdGhpcy5jb3B5TGluZWFyVG9HYW1tYSh0aGlzLHQpLHRoaXN9Y29weVNSR0JUb0xpbmVhcih0KXtyZXR1cm4gdGhpcy5yPU9yKHQuciksdGhpcy5nPU9yKHQuZyksdGhpcy5iPU9yKHQuYiksdGhpc31jb3B5TGluZWFyVG9TUkdCKHQpe3JldHVybiB0aGlzLnI9TnIodC5yKSx0aGlzLmc9TnIodC5nKSx0aGlzLmI9TnIodC5iKSx0aGlzfWNvbnZlcnRTUkdCVG9MaW5lYXIoKXtyZXR1cm4gdGhpcy5jb3B5U1JHQlRvTGluZWFyKHRoaXMpLHRoaXN9Y29udmVydExpbmVhclRvU1JHQigpe3JldHVybiB0aGlzLmNvcHlMaW5lYXJUb1NSR0IodGhpcyksdGhpc31nZXRIZXgoKXtyZXR1cm4gMjU1KnRoaXMucjw8MTZeMjU1KnRoaXMuZzw8OF4yNTUqdGhpcy5iPDwwfWdldEhleFN0cmluZygpe3JldHVybihcIjAwMDAwMFwiK3RoaXMuZ2V0SGV4KCkudG9TdHJpbmcoMTYpKS5zbGljZSgtNil9Z2V0SFNMKHQpe3ZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5Db2xvcjogLmdldEhTTCgpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD17aDowLHM6MCxsOjB9KTtjb25zdCBlPXRoaXMucixpPXRoaXMuZyxuPXRoaXMuYixyPU1hdGgubWF4KGUsaSxuKSxzPU1hdGgubWluKGUsaSxuKTtsZXQgbyxhO2NvbnN0IGM9KHMrcikvMjtpZihzPT09cilvPTAsYT0wO2Vsc2V7Y29uc3QgdD1yLXM7c3dpdGNoKGE9Yzw9LjU/dC8ocitzKTp0LygyLXItcykscil7Y2FzZSBlOm89KGktbikvdCsoaTxuPzY6MCk7YnJlYWs7Y2FzZSBpOm89KG4tZSkvdCsyO2JyZWFrO2Nhc2UgbjpvPShlLWkpL3QrNH1vLz02fXJldHVybiB0Lmg9byx0LnM9YSx0Lmw9Yyx0fWdldFN0eWxlKCl7cmV0dXJuXCJyZ2IoXCIrKDI1NSp0aGlzLnJ8MCkrXCIsXCIrKDI1NSp0aGlzLmd8MCkrXCIsXCIrKDI1NSp0aGlzLmJ8MCkrXCIpXCJ9b2Zmc2V0SFNMKHQsZSxpKXtyZXR1cm4gdGhpcy5nZXRIU0woUHIpLFByLmgrPXQsUHIucys9ZSxQci5sKz1pLHRoaXMuc2V0SFNMKFByLmgsUHIucyxQci5sKSx0aGlzfWFkZCh0KXtyZXR1cm4gdGhpcy5yKz10LnIsdGhpcy5nKz10LmcsdGhpcy5iKz10LmIsdGhpc31hZGRDb2xvcnModCxlKXtyZXR1cm4gdGhpcy5yPXQucitlLnIsdGhpcy5nPXQuZytlLmcsdGhpcy5iPXQuYitlLmIsdGhpc31hZGRTY2FsYXIodCl7cmV0dXJuIHRoaXMucis9dCx0aGlzLmcrPXQsdGhpcy5iKz10LHRoaXN9c3ViKHQpe3JldHVybiB0aGlzLnI9TWF0aC5tYXgoMCx0aGlzLnItdC5yKSx0aGlzLmc9TWF0aC5tYXgoMCx0aGlzLmctdC5nKSx0aGlzLmI9TWF0aC5tYXgoMCx0aGlzLmItdC5iKSx0aGlzfW11bHRpcGx5KHQpe3JldHVybiB0aGlzLnIqPXQucix0aGlzLmcqPXQuZyx0aGlzLmIqPXQuYix0aGlzfW11bHRpcGx5U2NhbGFyKHQpe3JldHVybiB0aGlzLnIqPXQsdGhpcy5nKj10LHRoaXMuYio9dCx0aGlzfWxlcnAodCxlKXtyZXR1cm4gdGhpcy5yKz0odC5yLXRoaXMucikqZSx0aGlzLmcrPSh0LmctdGhpcy5nKSplLHRoaXMuYis9KHQuYi10aGlzLmIpKmUsdGhpc31sZXJwQ29sb3JzKHQsZSxpKXtyZXR1cm4gdGhpcy5yPXQucisoZS5yLXQucikqaSx0aGlzLmc9dC5nKyhlLmctdC5nKSppLHRoaXMuYj10LmIrKGUuYi10LmIpKmksdGhpc31sZXJwSFNMKHQsZSl7dGhpcy5nZXRIU0woUHIpLHQuZ2V0SFNMKFJyKTtjb25zdCBpPW5uLmxlcnAoUHIuaCxSci5oLGUpLG49bm4ubGVycChQci5zLFJyLnMsZSkscj1ubi5sZXJwKFByLmwsUnIubCxlKTtyZXR1cm4gdGhpcy5zZXRIU0woaSxuLHIpLHRoaXN9ZXF1YWxzKHQpe3JldHVybiB0LnI9PT10aGlzLnImJnQuZz09PXRoaXMuZyYmdC5iPT09dGhpcy5ifWZyb21BcnJheSh0LGU9MCl7cmV0dXJuIHRoaXMucj10W2VdLHRoaXMuZz10W2UrMV0sdGhpcy5iPXRbZSsyXSx0aGlzfXRvQXJyYXkodD1bXSxlPTApe3JldHVybiB0W2VdPXRoaXMucix0W2UrMV09dGhpcy5nLHRbZSsyXT10aGlzLmIsdH1mcm9tQnVmZmVyQXR0cmlidXRlKHQsZSl7cmV0dXJuIHRoaXMucj10LmdldFgoZSksdGhpcy5nPXQuZ2V0WShlKSx0aGlzLmI9dC5nZXRaKGUpLCEwPT09dC5ub3JtYWxpemVkJiYodGhpcy5yLz0yNTUsdGhpcy5nLz0yNTUsdGhpcy5iLz0yNTUpLHRoaXN9dG9KU09OKCl7cmV0dXJuIHRoaXMuZ2V0SGV4KCl9fURyLk5BTUVTPUFyLERyLnByb3RvdHlwZS5yPTEsRHIucHJvdG90eXBlLmc9MSxEci5wcm90b3R5cGUuYj0xO2NsYXNzICRye2NvbnN0cnVjdG9yKHQsZSxpLG4scixzPTApe3RoaXMuYT10LHRoaXMuYj1lLHRoaXMuYz1pLHRoaXMubm9ybWFsPW4mJm4uaXNWZWN0b3IzP246bmV3IGZuLHRoaXMudmVydGV4Tm9ybWFscz1BcnJheS5pc0FycmF5KG4pP246W10sdGhpcy5jb2xvcj1yJiZyLmlzQ29sb3I/cjpuZXcgRHIsdGhpcy52ZXJ0ZXhDb2xvcnM9QXJyYXkuaXNBcnJheShyKT9yOltdLHRoaXMubWF0ZXJpYWxJbmRleD1zfWNsb25lKCl7cmV0dXJuKG5ldyB0aGlzLmNvbnN0cnVjdG9yKS5jb3B5KHRoaXMpfWNvcHkodCl7dGhpcy5hPXQuYSx0aGlzLmI9dC5iLHRoaXMuYz10LmMsdGhpcy5ub3JtYWwuY29weSh0Lm5vcm1hbCksdGhpcy5jb2xvci5jb3B5KHQuY29sb3IpLHRoaXMubWF0ZXJpYWxJbmRleD10Lm1hdGVyaWFsSW5kZXg7Zm9yKGxldCBlPTAsaT10LnZlcnRleE5vcm1hbHMubGVuZ3RoO2U8aTtlKyspdGhpcy52ZXJ0ZXhOb3JtYWxzW2VdPXQudmVydGV4Tm9ybWFsc1tlXS5jbG9uZSgpO2ZvcihsZXQgZT0wLGk9dC52ZXJ0ZXhDb2xvcnMubGVuZ3RoO2U8aTtlKyspdGhpcy52ZXJ0ZXhDb2xvcnNbZV09dC52ZXJ0ZXhDb2xvcnNbZV0uY2xvbmUoKTtyZXR1cm4gdGhpc319bGV0IGtyPTA7ZnVuY3Rpb24genIoKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlkXCIse3ZhbHVlOmtyKyt9KSx0aGlzLnV1aWQ9bm4uZ2VuZXJhdGVVVUlEKCksdGhpcy5uYW1lPVwiXCIsdGhpcy50eXBlPVwiTWF0ZXJpYWxcIix0aGlzLmZvZz0hMCx0aGlzLmJsZW5kaW5nPTEsdGhpcy5zaWRlPTAsdGhpcy5mbGF0U2hhZGluZz0hMSx0aGlzLnZlcnRleENvbG9ycz0hMSx0aGlzLm9wYWNpdHk9MSx0aGlzLnRyYW5zcGFyZW50PSExLHRoaXMuYmxlbmRTcmM9MjA0LHRoaXMuYmxlbmREc3Q9MjA1LHRoaXMuYmxlbmRFcXVhdGlvbj1NaSx0aGlzLmJsZW5kU3JjQWxwaGE9bnVsbCx0aGlzLmJsZW5kRHN0QWxwaGE9bnVsbCx0aGlzLmJsZW5kRXF1YXRpb25BbHBoYT1udWxsLHRoaXMuZGVwdGhGdW5jPTMsdGhpcy5kZXB0aFRlc3Q9ITAsdGhpcy5kZXB0aFdyaXRlPSEwLHRoaXMuc3RlbmNpbFdyaXRlTWFzaz0yNTUsdGhpcy5zdGVuY2lsRnVuYz01MTksdGhpcy5zdGVuY2lsUmVmPTAsdGhpcy5zdGVuY2lsRnVuY01hc2s9MjU1LHRoaXMuc3RlbmNpbEZhaWw9WWksdGhpcy5zdGVuY2lsWkZhaWw9WWksdGhpcy5zdGVuY2lsWlBhc3M9WWksdGhpcy5zdGVuY2lsV3JpdGU9ITEsdGhpcy5jbGlwcGluZ1BsYW5lcz1udWxsLHRoaXMuY2xpcEludGVyc2VjdGlvbj0hMSx0aGlzLmNsaXBTaGFkb3dzPSExLHRoaXMuc2hhZG93U2lkZT1udWxsLHRoaXMuY29sb3JXcml0ZT0hMCx0aGlzLnByZWNpc2lvbj1udWxsLHRoaXMucG9seWdvbk9mZnNldD0hMSx0aGlzLnBvbHlnb25PZmZzZXRGYWN0b3I9MCx0aGlzLnBvbHlnb25PZmZzZXRVbml0cz0wLHRoaXMuZGl0aGVyaW5nPSExLHRoaXMuYWxwaGFUZXN0PTAsdGhpcy5wcmVtdWx0aXBsaWVkQWxwaGE9ITEsdGhpcy52aXNpYmxlPSEwLHRoaXMudG9uZU1hcHBlZD0hMCx0aGlzLnVzZXJEYXRhPXt9LHRoaXMudmVyc2lvbj0wfWZ1bmN0aW9uIEZyKHQpe3pyLmNhbGwodGhpcyksdGhpcy50eXBlPVwiTWVzaEJhc2ljTWF0ZXJpYWxcIix0aGlzLmNvbG9yPW5ldyBEcigxNjc3NzIxNSksdGhpcy5tYXA9bnVsbCx0aGlzLmxpZ2h0TWFwPW51bGwsdGhpcy5saWdodE1hcEludGVuc2l0eT0xLHRoaXMuYW9NYXA9bnVsbCx0aGlzLmFvTWFwSW50ZW5zaXR5PTEsdGhpcy5zcGVjdWxhck1hcD1udWxsLHRoaXMuYWxwaGFNYXA9bnVsbCx0aGlzLmVudk1hcD1udWxsLHRoaXMuY29tYmluZT0wLHRoaXMucmVmbGVjdGl2aXR5PTEsdGhpcy5yZWZyYWN0aW9uUmF0aW89Ljk4LHRoaXMud2lyZWZyYW1lPSExLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPTEsdGhpcy53aXJlZnJhbWVMaW5lY2FwPVwicm91bmRcIix0aGlzLndpcmVmcmFtZUxpbmVqb2luPVwicm91bmRcIix0aGlzLnNraW5uaW5nPSExLHRoaXMubW9ycGhUYXJnZXRzPSExLHRoaXMuc2V0VmFsdWVzKHQpfXpyLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoUWkucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6enIsaXNNYXRlcmlhbDohMCxvbkJlZm9yZUNvbXBpbGU6ZnVuY3Rpb24oKXt9LGN1c3RvbVByb2dyYW1DYWNoZUtleTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9uQmVmb3JlQ29tcGlsZS50b1N0cmluZygpfSxzZXRWYWx1ZXM6ZnVuY3Rpb24odCl7aWYodm9pZCAwIT09dClmb3IoY29uc3QgZSBpbiB0KXtjb25zdCBpPXRbZV07aWYodm9pZCAwPT09aSl7Y29uc29sZS53YXJuKFwiVEhSRUUuTWF0ZXJpYWw6ICdcIitlK1wiJyBwYXJhbWV0ZXIgaXMgdW5kZWZpbmVkLlwiKTtjb250aW51ZX1pZihcInNoYWRpbmdcIj09PWUpe2NvbnNvbGUud2FybihcIlRIUkVFLlwiK3RoaXMudHlwZStcIjogLnNoYWRpbmcgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHRoZSBib29sZWFuIC5mbGF0U2hhZGluZyBpbnN0ZWFkLlwiKSx0aGlzLmZsYXRTaGFkaW5nPTE9PT1pO2NvbnRpbnVlfWNvbnN0IG49dGhpc1tlXTt2b2lkIDAhPT1uP24mJm4uaXNDb2xvcj9uLnNldChpKTpuJiZuLmlzVmVjdG9yMyYmaSYmaS5pc1ZlY3RvcjM/bi5jb3B5KGkpOnRoaXNbZV09aTpjb25zb2xlLndhcm4oXCJUSFJFRS5cIit0aGlzLnR5cGUrXCI6ICdcIitlK1wiJyBpcyBub3QgYSBwcm9wZXJ0eSBvZiB0aGlzIG1hdGVyaWFsLlwiKX19LHRvSlNPTjpmdW5jdGlvbih0KXtjb25zdCBlPXZvaWQgMD09PXR8fFwic3RyaW5nXCI9PXR5cGVvZiB0O2UmJih0PXt0ZXh0dXJlczp7fSxpbWFnZXM6e319KTtjb25zdCBpPXttZXRhZGF0YTp7dmVyc2lvbjo0LjUsdHlwZTpcIk1hdGVyaWFsXCIsZ2VuZXJhdG9yOlwiTWF0ZXJpYWwudG9KU09OXCJ9fTtmdW5jdGlvbiBuKHQpe2NvbnN0IGU9W107Zm9yKGNvbnN0IGkgaW4gdCl7Y29uc3Qgbj10W2ldO2RlbGV0ZSBuLm1ldGFkYXRhLGUucHVzaChuKX1yZXR1cm4gZX1pZihpLnV1aWQ9dGhpcy51dWlkLGkudHlwZT10aGlzLnR5cGUsXCJcIiE9PXRoaXMubmFtZSYmKGkubmFtZT10aGlzLm5hbWUpLHRoaXMuY29sb3ImJnRoaXMuY29sb3IuaXNDb2xvciYmKGkuY29sb3I9dGhpcy5jb2xvci5nZXRIZXgoKSksdm9pZCAwIT09dGhpcy5yb3VnaG5lc3MmJihpLnJvdWdobmVzcz10aGlzLnJvdWdobmVzcyksdm9pZCAwIT09dGhpcy5tZXRhbG5lc3MmJihpLm1ldGFsbmVzcz10aGlzLm1ldGFsbmVzcyksdGhpcy5zaGVlbiYmdGhpcy5zaGVlbi5pc0NvbG9yJiYoaS5zaGVlbj10aGlzLnNoZWVuLmdldEhleCgpKSx0aGlzLmVtaXNzaXZlJiZ0aGlzLmVtaXNzaXZlLmlzQ29sb3ImJihpLmVtaXNzaXZlPXRoaXMuZW1pc3NpdmUuZ2V0SGV4KCkpLHRoaXMuZW1pc3NpdmVJbnRlbnNpdHkmJjEhPT10aGlzLmVtaXNzaXZlSW50ZW5zaXR5JiYoaS5lbWlzc2l2ZUludGVuc2l0eT10aGlzLmVtaXNzaXZlSW50ZW5zaXR5KSx0aGlzLnNwZWN1bGFyJiZ0aGlzLnNwZWN1bGFyLmlzQ29sb3ImJihpLnNwZWN1bGFyPXRoaXMuc3BlY3VsYXIuZ2V0SGV4KCkpLHZvaWQgMCE9PXRoaXMuc2hpbmluZXNzJiYoaS5zaGluaW5lc3M9dGhpcy5zaGluaW5lc3MpLHZvaWQgMCE9PXRoaXMuY2xlYXJjb2F0JiYoaS5jbGVhcmNvYXQ9dGhpcy5jbGVhcmNvYXQpLHZvaWQgMCE9PXRoaXMuY2xlYXJjb2F0Um91Z2huZXNzJiYoaS5jbGVhcmNvYXRSb3VnaG5lc3M9dGhpcy5jbGVhcmNvYXRSb3VnaG5lc3MpLHRoaXMuY2xlYXJjb2F0TWFwJiZ0aGlzLmNsZWFyY29hdE1hcC5pc1RleHR1cmUmJihpLmNsZWFyY29hdE1hcD10aGlzLmNsZWFyY29hdE1hcC50b0pTT04odCkudXVpZCksdGhpcy5jbGVhcmNvYXRSb3VnaG5lc3NNYXAmJnRoaXMuY2xlYXJjb2F0Um91Z2huZXNzTWFwLmlzVGV4dHVyZSYmKGkuY2xlYXJjb2F0Um91Z2huZXNzTWFwPXRoaXMuY2xlYXJjb2F0Um91Z2huZXNzTWFwLnRvSlNPTih0KS51dWlkKSx0aGlzLmNsZWFyY29hdE5vcm1hbE1hcCYmdGhpcy5jbGVhcmNvYXROb3JtYWxNYXAuaXNUZXh0dXJlJiYoaS5jbGVhcmNvYXROb3JtYWxNYXA9dGhpcy5jbGVhcmNvYXROb3JtYWxNYXAudG9KU09OKHQpLnV1aWQsaS5jbGVhcmNvYXROb3JtYWxTY2FsZT10aGlzLmNsZWFyY29hdE5vcm1hbFNjYWxlLnRvQXJyYXkoKSksdGhpcy5tYXAmJnRoaXMubWFwLmlzVGV4dHVyZSYmKGkubWFwPXRoaXMubWFwLnRvSlNPTih0KS51dWlkKSx0aGlzLm1hdGNhcCYmdGhpcy5tYXRjYXAuaXNUZXh0dXJlJiYoaS5tYXRjYXA9dGhpcy5tYXRjYXAudG9KU09OKHQpLnV1aWQpLHRoaXMuYWxwaGFNYXAmJnRoaXMuYWxwaGFNYXAuaXNUZXh0dXJlJiYoaS5hbHBoYU1hcD10aGlzLmFscGhhTWFwLnRvSlNPTih0KS51dWlkKSx0aGlzLmxpZ2h0TWFwJiZ0aGlzLmxpZ2h0TWFwLmlzVGV4dHVyZSYmKGkubGlnaHRNYXA9dGhpcy5saWdodE1hcC50b0pTT04odCkudXVpZCksdGhpcy5hb01hcCYmdGhpcy5hb01hcC5pc1RleHR1cmUmJihpLmFvTWFwPXRoaXMuYW9NYXAudG9KU09OKHQpLnV1aWQsaS5hb01hcEludGVuc2l0eT10aGlzLmFvTWFwSW50ZW5zaXR5KSx0aGlzLmJ1bXBNYXAmJnRoaXMuYnVtcE1hcC5pc1RleHR1cmUmJihpLmJ1bXBNYXA9dGhpcy5idW1wTWFwLnRvSlNPTih0KS51dWlkLGkuYnVtcFNjYWxlPXRoaXMuYnVtcFNjYWxlKSx0aGlzLm5vcm1hbE1hcCYmdGhpcy5ub3JtYWxNYXAuaXNUZXh0dXJlJiYoaS5ub3JtYWxNYXA9dGhpcy5ub3JtYWxNYXAudG9KU09OKHQpLnV1aWQsaS5ub3JtYWxNYXBUeXBlPXRoaXMubm9ybWFsTWFwVHlwZSxpLm5vcm1hbFNjYWxlPXRoaXMubm9ybWFsU2NhbGUudG9BcnJheSgpKSx0aGlzLmRpc3BsYWNlbWVudE1hcCYmdGhpcy5kaXNwbGFjZW1lbnRNYXAuaXNUZXh0dXJlJiYoaS5kaXNwbGFjZW1lbnRNYXA9dGhpcy5kaXNwbGFjZW1lbnRNYXAudG9KU09OKHQpLnV1aWQsaS5kaXNwbGFjZW1lbnRTY2FsZT10aGlzLmRpc3BsYWNlbWVudFNjYWxlLGkuZGlzcGxhY2VtZW50Qmlhcz10aGlzLmRpc3BsYWNlbWVudEJpYXMpLHRoaXMucm91Z2huZXNzTWFwJiZ0aGlzLnJvdWdobmVzc01hcC5pc1RleHR1cmUmJihpLnJvdWdobmVzc01hcD10aGlzLnJvdWdobmVzc01hcC50b0pTT04odCkudXVpZCksdGhpcy5tZXRhbG5lc3NNYXAmJnRoaXMubWV0YWxuZXNzTWFwLmlzVGV4dHVyZSYmKGkubWV0YWxuZXNzTWFwPXRoaXMubWV0YWxuZXNzTWFwLnRvSlNPTih0KS51dWlkKSx0aGlzLmVtaXNzaXZlTWFwJiZ0aGlzLmVtaXNzaXZlTWFwLmlzVGV4dHVyZSYmKGkuZW1pc3NpdmVNYXA9dGhpcy5lbWlzc2l2ZU1hcC50b0pTT04odCkudXVpZCksdGhpcy5zcGVjdWxhck1hcCYmdGhpcy5zcGVjdWxhck1hcC5pc1RleHR1cmUmJihpLnNwZWN1bGFyTWFwPXRoaXMuc3BlY3VsYXJNYXAudG9KU09OKHQpLnV1aWQpLHRoaXMuZW52TWFwJiZ0aGlzLmVudk1hcC5pc1RleHR1cmUmJihpLmVudk1hcD10aGlzLmVudk1hcC50b0pTT04odCkudXVpZCxpLnJlZmxlY3Rpdml0eT10aGlzLnJlZmxlY3Rpdml0eSxpLnJlZnJhY3Rpb25SYXRpbz10aGlzLnJlZnJhY3Rpb25SYXRpbyx2b2lkIDAhPT10aGlzLmNvbWJpbmUmJihpLmNvbWJpbmU9dGhpcy5jb21iaW5lKSx2b2lkIDAhPT10aGlzLmVudk1hcEludGVuc2l0eSYmKGkuZW52TWFwSW50ZW5zaXR5PXRoaXMuZW52TWFwSW50ZW5zaXR5KSksdGhpcy5ncmFkaWVudE1hcCYmdGhpcy5ncmFkaWVudE1hcC5pc1RleHR1cmUmJihpLmdyYWRpZW50TWFwPXRoaXMuZ3JhZGllbnRNYXAudG9KU09OKHQpLnV1aWQpLHZvaWQgMCE9PXRoaXMuc2l6ZSYmKGkuc2l6ZT10aGlzLnNpemUpLHZvaWQgMCE9PXRoaXMuc2l6ZUF0dGVudWF0aW9uJiYoaS5zaXplQXR0ZW51YXRpb249dGhpcy5zaXplQXR0ZW51YXRpb24pLDEhPT10aGlzLmJsZW5kaW5nJiYoaS5ibGVuZGluZz10aGlzLmJsZW5kaW5nKSwhMD09PXRoaXMuZmxhdFNoYWRpbmcmJihpLmZsYXRTaGFkaW5nPXRoaXMuZmxhdFNoYWRpbmcpLDAhPT10aGlzLnNpZGUmJihpLnNpZGU9dGhpcy5zaWRlKSx0aGlzLnZlcnRleENvbG9ycyYmKGkudmVydGV4Q29sb3JzPSEwKSx0aGlzLm9wYWNpdHk8MSYmKGkub3BhY2l0eT10aGlzLm9wYWNpdHkpLCEwPT09dGhpcy50cmFuc3BhcmVudCYmKGkudHJhbnNwYXJlbnQ9dGhpcy50cmFuc3BhcmVudCksaS5kZXB0aEZ1bmM9dGhpcy5kZXB0aEZ1bmMsaS5kZXB0aFRlc3Q9dGhpcy5kZXB0aFRlc3QsaS5kZXB0aFdyaXRlPXRoaXMuZGVwdGhXcml0ZSxpLnN0ZW5jaWxXcml0ZT10aGlzLnN0ZW5jaWxXcml0ZSxpLnN0ZW5jaWxXcml0ZU1hc2s9dGhpcy5zdGVuY2lsV3JpdGVNYXNrLGkuc3RlbmNpbEZ1bmM9dGhpcy5zdGVuY2lsRnVuYyxpLnN0ZW5jaWxSZWY9dGhpcy5zdGVuY2lsUmVmLGkuc3RlbmNpbEZ1bmNNYXNrPXRoaXMuc3RlbmNpbEZ1bmNNYXNrLGkuc3RlbmNpbEZhaWw9dGhpcy5zdGVuY2lsRmFpbCxpLnN0ZW5jaWxaRmFpbD10aGlzLnN0ZW5jaWxaRmFpbCxpLnN0ZW5jaWxaUGFzcz10aGlzLnN0ZW5jaWxaUGFzcyx0aGlzLnJvdGF0aW9uJiYwIT09dGhpcy5yb3RhdGlvbiYmKGkucm90YXRpb249dGhpcy5yb3RhdGlvbiksITA9PT10aGlzLnBvbHlnb25PZmZzZXQmJihpLnBvbHlnb25PZmZzZXQ9ITApLDAhPT10aGlzLnBvbHlnb25PZmZzZXRGYWN0b3ImJihpLnBvbHlnb25PZmZzZXRGYWN0b3I9dGhpcy5wb2x5Z29uT2Zmc2V0RmFjdG9yKSwwIT09dGhpcy5wb2x5Z29uT2Zmc2V0VW5pdHMmJihpLnBvbHlnb25PZmZzZXRVbml0cz10aGlzLnBvbHlnb25PZmZzZXRVbml0cyksdGhpcy5saW5ld2lkdGgmJjEhPT10aGlzLmxpbmV3aWR0aCYmKGkubGluZXdpZHRoPXRoaXMubGluZXdpZHRoKSx2b2lkIDAhPT10aGlzLmRhc2hTaXplJiYoaS5kYXNoU2l6ZT10aGlzLmRhc2hTaXplKSx2b2lkIDAhPT10aGlzLmdhcFNpemUmJihpLmdhcFNpemU9dGhpcy5nYXBTaXplKSx2b2lkIDAhPT10aGlzLnNjYWxlJiYoaS5zY2FsZT10aGlzLnNjYWxlKSwhMD09PXRoaXMuZGl0aGVyaW5nJiYoaS5kaXRoZXJpbmc9ITApLHRoaXMuYWxwaGFUZXN0PjAmJihpLmFscGhhVGVzdD10aGlzLmFscGhhVGVzdCksITA9PT10aGlzLnByZW11bHRpcGxpZWRBbHBoYSYmKGkucHJlbXVsdGlwbGllZEFscGhhPXRoaXMucHJlbXVsdGlwbGllZEFscGhhKSwhMD09PXRoaXMud2lyZWZyYW1lJiYoaS53aXJlZnJhbWU9dGhpcy53aXJlZnJhbWUpLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPjEmJihpLndpcmVmcmFtZUxpbmV3aWR0aD10aGlzLndpcmVmcmFtZUxpbmV3aWR0aCksXCJyb3VuZFwiIT09dGhpcy53aXJlZnJhbWVMaW5lY2FwJiYoaS53aXJlZnJhbWVMaW5lY2FwPXRoaXMud2lyZWZyYW1lTGluZWNhcCksXCJyb3VuZFwiIT09dGhpcy53aXJlZnJhbWVMaW5lam9pbiYmKGkud2lyZWZyYW1lTGluZWpvaW49dGhpcy53aXJlZnJhbWVMaW5lam9pbiksITA9PT10aGlzLm1vcnBoVGFyZ2V0cyYmKGkubW9ycGhUYXJnZXRzPSEwKSwhMD09PXRoaXMubW9ycGhOb3JtYWxzJiYoaS5tb3JwaE5vcm1hbHM9ITApLCEwPT09dGhpcy5za2lubmluZyYmKGkuc2tpbm5pbmc9ITApLCExPT09dGhpcy52aXNpYmxlJiYoaS52aXNpYmxlPSExKSwhMT09PXRoaXMudG9uZU1hcHBlZCYmKGkudG9uZU1hcHBlZD0hMSksXCJ7fVwiIT09SlNPTi5zdHJpbmdpZnkodGhpcy51c2VyRGF0YSkmJihpLnVzZXJEYXRhPXRoaXMudXNlckRhdGEpLGUpe2NvbnN0IGU9bih0LnRleHR1cmVzKSxyPW4odC5pbWFnZXMpO2UubGVuZ3RoPjAmJihpLnRleHR1cmVzPWUpLHIubGVuZ3RoPjAmJihpLmltYWdlcz1yKX1yZXR1cm4gaX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4obmV3IHRoaXMuY29uc3RydWN0b3IpLmNvcHkodGhpcyl9LGNvcHk6ZnVuY3Rpb24odCl7dGhpcy5uYW1lPXQubmFtZSx0aGlzLmZvZz10LmZvZyx0aGlzLmJsZW5kaW5nPXQuYmxlbmRpbmcsdGhpcy5zaWRlPXQuc2lkZSx0aGlzLmZsYXRTaGFkaW5nPXQuZmxhdFNoYWRpbmcsdGhpcy52ZXJ0ZXhDb2xvcnM9dC52ZXJ0ZXhDb2xvcnMsdGhpcy5vcGFjaXR5PXQub3BhY2l0eSx0aGlzLnRyYW5zcGFyZW50PXQudHJhbnNwYXJlbnQsdGhpcy5ibGVuZFNyYz10LmJsZW5kU3JjLHRoaXMuYmxlbmREc3Q9dC5ibGVuZERzdCx0aGlzLmJsZW5kRXF1YXRpb249dC5ibGVuZEVxdWF0aW9uLHRoaXMuYmxlbmRTcmNBbHBoYT10LmJsZW5kU3JjQWxwaGEsdGhpcy5ibGVuZERzdEFscGhhPXQuYmxlbmREc3RBbHBoYSx0aGlzLmJsZW5kRXF1YXRpb25BbHBoYT10LmJsZW5kRXF1YXRpb25BbHBoYSx0aGlzLmRlcHRoRnVuYz10LmRlcHRoRnVuYyx0aGlzLmRlcHRoVGVzdD10LmRlcHRoVGVzdCx0aGlzLmRlcHRoV3JpdGU9dC5kZXB0aFdyaXRlLHRoaXMuc3RlbmNpbFdyaXRlTWFzaz10LnN0ZW5jaWxXcml0ZU1hc2ssdGhpcy5zdGVuY2lsRnVuYz10LnN0ZW5jaWxGdW5jLHRoaXMuc3RlbmNpbFJlZj10LnN0ZW5jaWxSZWYsdGhpcy5zdGVuY2lsRnVuY01hc2s9dC5zdGVuY2lsRnVuY01hc2ssdGhpcy5zdGVuY2lsRmFpbD10LnN0ZW5jaWxGYWlsLHRoaXMuc3RlbmNpbFpGYWlsPXQuc3RlbmNpbFpGYWlsLHRoaXMuc3RlbmNpbFpQYXNzPXQuc3RlbmNpbFpQYXNzLHRoaXMuc3RlbmNpbFdyaXRlPXQuc3RlbmNpbFdyaXRlO2NvbnN0IGU9dC5jbGlwcGluZ1BsYW5lcztsZXQgaT1udWxsO2lmKG51bGwhPT1lKXtjb25zdCB0PWUubGVuZ3RoO2k9bmV3IEFycmF5KHQpO2ZvcihsZXQgbj0wO24hPT10OysrbilpW25dPWVbbl0uY2xvbmUoKX1yZXR1cm4gdGhpcy5jbGlwcGluZ1BsYW5lcz1pLHRoaXMuY2xpcEludGVyc2VjdGlvbj10LmNsaXBJbnRlcnNlY3Rpb24sdGhpcy5jbGlwU2hhZG93cz10LmNsaXBTaGFkb3dzLHRoaXMuc2hhZG93U2lkZT10LnNoYWRvd1NpZGUsdGhpcy5jb2xvcldyaXRlPXQuY29sb3JXcml0ZSx0aGlzLnByZWNpc2lvbj10LnByZWNpc2lvbix0aGlzLnBvbHlnb25PZmZzZXQ9dC5wb2x5Z29uT2Zmc2V0LHRoaXMucG9seWdvbk9mZnNldEZhY3Rvcj10LnBvbHlnb25PZmZzZXRGYWN0b3IsdGhpcy5wb2x5Z29uT2Zmc2V0VW5pdHM9dC5wb2x5Z29uT2Zmc2V0VW5pdHMsdGhpcy5kaXRoZXJpbmc9dC5kaXRoZXJpbmcsdGhpcy5hbHBoYVRlc3Q9dC5hbHBoYVRlc3QsdGhpcy5wcmVtdWx0aXBsaWVkQWxwaGE9dC5wcmVtdWx0aXBsaWVkQWxwaGEsdGhpcy52aXNpYmxlPXQudmlzaWJsZSx0aGlzLnRvbmVNYXBwZWQ9dC50b25lTWFwcGVkLHRoaXMudXNlckRhdGE9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0LnVzZXJEYXRhKSksdGhpc30sZGlzcG9zZTpmdW5jdGlvbigpe3RoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpcImRpc3Bvc2VcIn0pfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh6ci5wcm90b3R5cGUsXCJuZWVkc1VwZGF0ZVwiLHtzZXQ6ZnVuY3Rpb24odCl7ITA9PT10JiZ0aGlzLnZlcnNpb24rK319KSxGci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh6ci5wcm90b3R5cGUpLEZyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1GcixGci5wcm90b3R5cGUuaXNNZXNoQmFzaWNNYXRlcmlhbD0hMCxGci5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4genIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuY29sb3IuY29weSh0LmNvbG9yKSx0aGlzLm1hcD10Lm1hcCx0aGlzLmxpZ2h0TWFwPXQubGlnaHRNYXAsdGhpcy5saWdodE1hcEludGVuc2l0eT10LmxpZ2h0TWFwSW50ZW5zaXR5LHRoaXMuYW9NYXA9dC5hb01hcCx0aGlzLmFvTWFwSW50ZW5zaXR5PXQuYW9NYXBJbnRlbnNpdHksdGhpcy5zcGVjdWxhck1hcD10LnNwZWN1bGFyTWFwLHRoaXMuYWxwaGFNYXA9dC5hbHBoYU1hcCx0aGlzLmVudk1hcD10LmVudk1hcCx0aGlzLmNvbWJpbmU9dC5jb21iaW5lLHRoaXMucmVmbGVjdGl2aXR5PXQucmVmbGVjdGl2aXR5LHRoaXMucmVmcmFjdGlvblJhdGlvPXQucmVmcmFjdGlvblJhdGlvLHRoaXMud2lyZWZyYW1lPXQud2lyZWZyYW1lLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPXQud2lyZWZyYW1lTGluZXdpZHRoLHRoaXMud2lyZWZyYW1lTGluZWNhcD10LndpcmVmcmFtZUxpbmVjYXAsdGhpcy53aXJlZnJhbWVMaW5lam9pbj10LndpcmVmcmFtZUxpbmVqb2luLHRoaXMuc2tpbm5pbmc9dC5za2lubmluZyx0aGlzLm1vcnBoVGFyZ2V0cz10Lm1vcnBoVGFyZ2V0cyx0aGlzfTtjb25zdCBCcj1uZXcgZm4sanI9bmV3IHJuO2Z1bmN0aW9uIEhyKHQsZSxpKXtpZihBcnJheS5pc0FycmF5KHQpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJUSFJFRS5CdWZmZXJBdHRyaWJ1dGU6IGFycmF5IHNob3VsZCBiZSBhIFR5cGVkIEFycmF5LlwiKTt0aGlzLm5hbWU9XCJcIix0aGlzLmFycmF5PXQsdGhpcy5pdGVtU2l6ZT1lLHRoaXMuY291bnQ9dm9pZCAwIT09dD90Lmxlbmd0aC9lOjAsdGhpcy5ub3JtYWxpemVkPSEwPT09aSx0aGlzLnVzYWdlPVppLHRoaXMudXBkYXRlUmFuZ2U9e29mZnNldDowLGNvdW50Oi0xfSx0aGlzLnZlcnNpb249MH1mdW5jdGlvbiBVcih0LGUsaSl7SHIuY2FsbCh0aGlzLG5ldyBJbnQ4QXJyYXkodCksZSxpKX1mdW5jdGlvbiBWcih0LGUsaSl7SHIuY2FsbCh0aGlzLG5ldyBVaW50OEFycmF5KHQpLGUsaSl9ZnVuY3Rpb24gR3IodCxlLGkpe0hyLmNhbGwodGhpcyxuZXcgVWludDhDbGFtcGVkQXJyYXkodCksZSxpKX1mdW5jdGlvbiBxcih0LGUsaSl7SHIuY2FsbCh0aGlzLG5ldyBJbnQxNkFycmF5KHQpLGUsaSl9ZnVuY3Rpb24gV3IodCxlLGkpe0hyLmNhbGwodGhpcyxuZXcgVWludDE2QXJyYXkodCksZSxpKX1mdW5jdGlvbiBYcih0LGUsaSl7SHIuY2FsbCh0aGlzLG5ldyBJbnQzMkFycmF5KHQpLGUsaSl9ZnVuY3Rpb24gWXIodCxlLGkpe0hyLmNhbGwodGhpcyxuZXcgVWludDMyQXJyYXkodCksZSxpKX1mdW5jdGlvbiBacih0LGUsaSl7SHIuY2FsbCh0aGlzLG5ldyBVaW50MTZBcnJheSh0KSxlLGkpfWZ1bmN0aW9uIEpyKHQsZSxpKXtIci5jYWxsKHRoaXMsbmV3IEZsb2F0MzJBcnJheSh0KSxlLGkpfWZ1bmN0aW9uIEtyKHQsZSxpKXtIci5jYWxsKHRoaXMsbmV3IEZsb2F0NjRBcnJheSh0KSxlLGkpfWZ1bmN0aW9uIFFyKHQpe2lmKDA9PT10Lmxlbmd0aClyZXR1cm4tMS8wO2xldCBlPXRbMF07Zm9yKGxldCBpPTEsbj10Lmxlbmd0aDtpPG47KytpKXRbaV0+ZSYmKGU9dFtpXSk7cmV0dXJuIGV9T2JqZWN0LmRlZmluZVByb3BlcnR5KEhyLnByb3RvdHlwZSxcIm5lZWRzVXBkYXRlXCIse3NldDpmdW5jdGlvbih0KXshMD09PXQmJnRoaXMudmVyc2lvbisrfX0pLE9iamVjdC5hc3NpZ24oSHIucHJvdG90eXBlLHtpc0J1ZmZlckF0dHJpYnV0ZTohMCxvblVwbG9hZENhbGxiYWNrOmZ1bmN0aW9uKCl7fSxzZXRVc2FnZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy51c2FnZT10LHRoaXN9LGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubmFtZT10Lm5hbWUsdGhpcy5hcnJheT1uZXcgdC5hcnJheS5jb25zdHJ1Y3Rvcih0LmFycmF5KSx0aGlzLml0ZW1TaXplPXQuaXRlbVNpemUsdGhpcy5jb3VudD10LmNvdW50LHRoaXMubm9ybWFsaXplZD10Lm5vcm1hbGl6ZWQsdGhpcy51c2FnZT10LnVzYWdlLHRoaXN9LGNvcHlBdDpmdW5jdGlvbih0LGUsaSl7dCo9dGhpcy5pdGVtU2l6ZSxpKj1lLml0ZW1TaXplO2ZvcihsZXQgbj0wLHI9dGhpcy5pdGVtU2l6ZTtuPHI7bisrKXRoaXMuYXJyYXlbdCtuXT1lLmFycmF5W2krbl07cmV0dXJuIHRoaXN9LGNvcHlBcnJheTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hcnJheS5zZXQodCksdGhpc30sY29weUNvbG9yc0FycmF5OmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5hcnJheTtsZXQgaT0wO2ZvcihsZXQgbj0wLHI9dC5sZW5ndGg7bjxyO24rKyl7bGV0IHI9dFtuXTt2b2lkIDA9PT1yJiYoY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyQXR0cmlidXRlLmNvcHlDb2xvcnNBcnJheSgpOiBjb2xvciBpcyB1bmRlZmluZWRcIixuKSxyPW5ldyBEciksZVtpKytdPXIucixlW2krK109ci5nLGVbaSsrXT1yLmJ9cmV0dXJuIHRoaXN9LGNvcHlWZWN0b3Iyc0FycmF5OmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5hcnJheTtsZXQgaT0wO2ZvcihsZXQgbj0wLHI9dC5sZW5ndGg7bjxyO24rKyl7bGV0IHI9dFtuXTt2b2lkIDA9PT1yJiYoY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyQXR0cmlidXRlLmNvcHlWZWN0b3Iyc0FycmF5KCk6IHZlY3RvciBpcyB1bmRlZmluZWRcIixuKSxyPW5ldyBybiksZVtpKytdPXIueCxlW2krK109ci55fXJldHVybiB0aGlzfSxjb3B5VmVjdG9yM3NBcnJheTpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMuYXJyYXk7bGV0IGk9MDtmb3IobGV0IG49MCxyPXQubGVuZ3RoO248cjtuKyspe2xldCByPXRbbl07dm9pZCAwPT09ciYmKGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZS5jb3B5VmVjdG9yM3NBcnJheSgpOiB2ZWN0b3IgaXMgdW5kZWZpbmVkXCIsbikscj1uZXcgZm4pLGVbaSsrXT1yLngsZVtpKytdPXIueSxlW2krK109ci56fXJldHVybiB0aGlzfSxjb3B5VmVjdG9yNHNBcnJheTpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMuYXJyYXk7bGV0IGk9MDtmb3IobGV0IG49MCxyPXQubGVuZ3RoO248cjtuKyspe2xldCByPXRbbl07dm9pZCAwPT09ciYmKGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZS5jb3B5VmVjdG9yNHNBcnJheSgpOiB2ZWN0b3IgaXMgdW5kZWZpbmVkXCIsbikscj1uZXcgdW4pLGVbaSsrXT1yLngsZVtpKytdPXIueSxlW2krK109ci56LGVbaSsrXT1yLnd9cmV0dXJuIHRoaXN9LGFwcGx5TWF0cml4MzpmdW5jdGlvbih0KXtpZigyPT09dGhpcy5pdGVtU2l6ZSlmb3IobGV0IGU9MCxpPXRoaXMuY291bnQ7ZTxpO2UrKylqci5mcm9tQnVmZmVyQXR0cmlidXRlKHRoaXMsZSksanIuYXBwbHlNYXRyaXgzKHQpLHRoaXMuc2V0WFkoZSxqci54LGpyLnkpO2Vsc2UgaWYoMz09PXRoaXMuaXRlbVNpemUpZm9yKGxldCBlPTAsaT10aGlzLmNvdW50O2U8aTtlKyspQnIuZnJvbUJ1ZmZlckF0dHJpYnV0ZSh0aGlzLGUpLEJyLmFwcGx5TWF0cml4Myh0KSx0aGlzLnNldFhZWihlLEJyLngsQnIueSxCci56KTtyZXR1cm4gdGhpc30sYXBwbHlNYXRyaXg0OmZ1bmN0aW9uKHQpe2ZvcihsZXQgZT0wLGk9dGhpcy5jb3VudDtlPGk7ZSsrKUJyLng9dGhpcy5nZXRYKGUpLEJyLnk9dGhpcy5nZXRZKGUpLEJyLno9dGhpcy5nZXRaKGUpLEJyLmFwcGx5TWF0cml4NCh0KSx0aGlzLnNldFhZWihlLEJyLngsQnIueSxCci56KTtyZXR1cm4gdGhpc30sYXBwbHlOb3JtYWxNYXRyaXg6ZnVuY3Rpb24odCl7Zm9yKGxldCBlPTAsaT10aGlzLmNvdW50O2U8aTtlKyspQnIueD10aGlzLmdldFgoZSksQnIueT10aGlzLmdldFkoZSksQnIuej10aGlzLmdldFooZSksQnIuYXBwbHlOb3JtYWxNYXRyaXgodCksdGhpcy5zZXRYWVooZSxCci54LEJyLnksQnIueik7cmV0dXJuIHRoaXN9LHRyYW5zZm9ybURpcmVjdGlvbjpmdW5jdGlvbih0KXtmb3IobGV0IGU9MCxpPXRoaXMuY291bnQ7ZTxpO2UrKylCci54PXRoaXMuZ2V0WChlKSxCci55PXRoaXMuZ2V0WShlKSxCci56PXRoaXMuZ2V0WihlKSxCci50cmFuc2Zvcm1EaXJlY3Rpb24odCksdGhpcy5zZXRYWVooZSxCci54LEJyLnksQnIueik7cmV0dXJuIHRoaXN9LHNldDpmdW5jdGlvbih0LGU9MCl7cmV0dXJuIHRoaXMuYXJyYXkuc2V0KHQsZSksdGhpc30sZ2V0WDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hcnJheVt0KnRoaXMuaXRlbVNpemVdfSxzZXRYOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYXJyYXlbdCp0aGlzLml0ZW1TaXplXT1lLHRoaXN9LGdldFk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYXJyYXlbdCp0aGlzLml0ZW1TaXplKzFdfSxzZXRZOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuYXJyYXlbdCp0aGlzLml0ZW1TaXplKzFdPWUsdGhpc30sZ2V0WjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hcnJheVt0KnRoaXMuaXRlbVNpemUrMl19LHNldFo6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5hcnJheVt0KnRoaXMuaXRlbVNpemUrMl09ZSx0aGlzfSxnZXRXOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmFycmF5W3QqdGhpcy5pdGVtU2l6ZSszXX0sc2V0VzpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmFycmF5W3QqdGhpcy5pdGVtU2l6ZSszXT1lLHRoaXN9LHNldFhZOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdCo9dGhpcy5pdGVtU2l6ZSx0aGlzLmFycmF5W3QrMF09ZSx0aGlzLmFycmF5W3QrMV09aSx0aGlzfSxzZXRYWVo6ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIHQqPXRoaXMuaXRlbVNpemUsdGhpcy5hcnJheVt0KzBdPWUsdGhpcy5hcnJheVt0KzFdPWksdGhpcy5hcnJheVt0KzJdPW4sdGhpc30sc2V0WFlaVzpmdW5jdGlvbih0LGUsaSxuLHIpe3JldHVybiB0Kj10aGlzLml0ZW1TaXplLHRoaXMuYXJyYXlbdCswXT1lLHRoaXMuYXJyYXlbdCsxXT1pLHRoaXMuYXJyYXlbdCsyXT1uLHRoaXMuYXJyYXlbdCszXT1yLHRoaXN9LG9uVXBsb2FkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9uVXBsb2FkQ2FsbGJhY2s9dCx0aGlzfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmFycmF5LHRoaXMuaXRlbVNpemUpLmNvcHkodGhpcyl9LHRvSlNPTjpmdW5jdGlvbigpe3JldHVybntpdGVtU2l6ZTp0aGlzLml0ZW1TaXplLHR5cGU6dGhpcy5hcnJheS5jb25zdHJ1Y3Rvci5uYW1lLGFycmF5OkFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHRoaXMuYXJyYXkpLG5vcm1hbGl6ZWQ6dGhpcy5ub3JtYWxpemVkfX19KSxVci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLFVyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1VcixWci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLFZyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1WcixHci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLEdyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1Hcixxci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLHFyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1xcixXci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLFdyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1XcixYci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLFhyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1YcixZci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLFlyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1Zcixaci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShIci5wcm90b3R5cGUpLFpyLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1acixaci5wcm90b3R5cGUuaXNGbG9hdDE2QnVmZmVyQXR0cmlidXRlPSEwLEpyLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEhyLnByb3RvdHlwZSksSnIucHJvdG90eXBlLmNvbnN0cnVjdG9yPUpyLEtyLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEhyLnByb3RvdHlwZSksS3IucHJvdG90eXBlLmNvbnN0cnVjdG9yPUtyO2NvbnN0IHRzPXtJbnQ4QXJyYXk6SW50OEFycmF5LFVpbnQ4QXJyYXk6VWludDhBcnJheSxVaW50OENsYW1wZWRBcnJheTpcInVuZGVmaW5lZFwiIT10eXBlb2YgVWludDhDbGFtcGVkQXJyYXk/VWludDhDbGFtcGVkQXJyYXk6VWludDhBcnJheSxJbnQxNkFycmF5OkludDE2QXJyYXksVWludDE2QXJyYXk6VWludDE2QXJyYXksSW50MzJBcnJheTpJbnQzMkFycmF5LFVpbnQzMkFycmF5OlVpbnQzMkFycmF5LEZsb2F0MzJBcnJheTpGbG9hdDMyQXJyYXksRmxvYXQ2NEFycmF5OkZsb2F0NjRBcnJheX07ZnVuY3Rpb24gZXModCxlKXtyZXR1cm4gbmV3IHRzW3RdKGUpfWxldCBpcz0wO2NvbnN0IG5zPW5ldyBIbixycz1uZXcgcHIsc3M9bmV3IGZuLG9zPW5ldyBfbixhcz1uZXcgX24sY3M9bmV3IGZuO2Z1bmN0aW9uIGhzKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpZFwiLHt2YWx1ZTppcysrfSksdGhpcy51dWlkPW5uLmdlbmVyYXRlVVVJRCgpLHRoaXMubmFtZT1cIlwiLHRoaXMudHlwZT1cIkJ1ZmZlckdlb21ldHJ5XCIsdGhpcy5pbmRleD1udWxsLHRoaXMuYXR0cmlidXRlcz17fSx0aGlzLm1vcnBoQXR0cmlidXRlcz17fSx0aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlPSExLHRoaXMuZ3JvdXBzPVtdLHRoaXMuYm91bmRpbmdCb3g9bnVsbCx0aGlzLmJvdW5kaW5nU3BoZXJlPW51bGwsdGhpcy5kcmF3UmFuZ2U9e3N0YXJ0OjAsY291bnQ6MS8wfSx0aGlzLnVzZXJEYXRhPXt9fWhzLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoUWkucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6aHMsaXNCdWZmZXJHZW9tZXRyeTohMCxnZXRJbmRleDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluZGV4fSxzZXRJbmRleDpmdW5jdGlvbih0KXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KT90aGlzLmluZGV4PW5ldyhRcih0KT42NTUzNT9ZcjpXcikodCwxKTp0aGlzLmluZGV4PXQsdGhpc30sZ2V0QXR0cmlidXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbdF19LHNldEF0dHJpYnV0ZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbdF09ZSx0aGlzfSxkZWxldGVBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7cmV0dXJuIGRlbGV0ZSB0aGlzLmF0dHJpYnV0ZXNbdF0sdGhpc30saGFzQXR0cmlidXRlOmZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDAhPT10aGlzLmF0dHJpYnV0ZXNbdF19LGFkZEdyb3VwOmZ1bmN0aW9uKHQsZSxpPTApe3RoaXMuZ3JvdXBzLnB1c2goe3N0YXJ0OnQsY291bnQ6ZSxtYXRlcmlhbEluZGV4Oml9KX0sY2xlYXJHcm91cHM6ZnVuY3Rpb24oKXt0aGlzLmdyb3Vwcz1bXX0sc2V0RHJhd1JhbmdlOmZ1bmN0aW9uKHQsZSl7dGhpcy5kcmF3UmFuZ2Uuc3RhcnQ9dCx0aGlzLmRyYXdSYW5nZS5jb3VudD1lfSxhcHBseU1hdHJpeDQ6ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLmF0dHJpYnV0ZXMucG9zaXRpb247dm9pZCAwIT09ZSYmKGUuYXBwbHlNYXRyaXg0KHQpLGUubmVlZHNVcGRhdGU9ITApO2NvbnN0IGk9dGhpcy5hdHRyaWJ1dGVzLm5vcm1hbDtpZih2b2lkIDAhPT1pKXtjb25zdCBlPShuZXcgc24pLmdldE5vcm1hbE1hdHJpeCh0KTtpLmFwcGx5Tm9ybWFsTWF0cml4KGUpLGkubmVlZHNVcGRhdGU9ITB9Y29uc3Qgbj10aGlzLmF0dHJpYnV0ZXMudGFuZ2VudDtyZXR1cm4gdm9pZCAwIT09biYmKG4udHJhbnNmb3JtRGlyZWN0aW9uKHQpLG4ubmVlZHNVcGRhdGU9ITApLG51bGwhPT10aGlzLmJvdW5kaW5nQm94JiZ0aGlzLmNvbXB1dGVCb3VuZGluZ0JveCgpLG51bGwhPT10aGlzLmJvdW5kaW5nU3BoZXJlJiZ0aGlzLmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpLHRoaXN9LHJvdGF0ZVg6ZnVuY3Rpb24odCl7cmV0dXJuIG5zLm1ha2VSb3RhdGlvblgodCksdGhpcy5hcHBseU1hdHJpeDQobnMpLHRoaXN9LHJvdGF0ZVk6ZnVuY3Rpb24odCl7cmV0dXJuIG5zLm1ha2VSb3RhdGlvblkodCksdGhpcy5hcHBseU1hdHJpeDQobnMpLHRoaXN9LHJvdGF0ZVo6ZnVuY3Rpb24odCl7cmV0dXJuIG5zLm1ha2VSb3RhdGlvbloodCksdGhpcy5hcHBseU1hdHJpeDQobnMpLHRoaXN9LHRyYW5zbGF0ZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIG5zLm1ha2VUcmFuc2xhdGlvbih0LGUsaSksdGhpcy5hcHBseU1hdHJpeDQobnMpLHRoaXN9LHNjYWxlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gbnMubWFrZVNjYWxlKHQsZSxpKSx0aGlzLmFwcGx5TWF0cml4NChucyksdGhpc30sbG9va0F0OmZ1bmN0aW9uKHQpe3JldHVybiBycy5sb29rQXQodCkscnMudXBkYXRlTWF0cml4KCksdGhpcy5hcHBseU1hdHJpeDQocnMubWF0cml4KSx0aGlzfSxjZW50ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21wdXRlQm91bmRpbmdCb3goKSx0aGlzLmJvdW5kaW5nQm94LmdldENlbnRlcihzcykubmVnYXRlKCksdGhpcy50cmFuc2xhdGUoc3MueCxzcy55LHNzLnopLHRoaXN9LHNldEZyb21Qb2ludHM6ZnVuY3Rpb24odCl7Y29uc3QgZT1bXTtmb3IobGV0IGk9MCxuPXQubGVuZ3RoO2k8bjtpKyspe2NvbnN0IG49dFtpXTtlLnB1c2gobi54LG4ueSxuLnp8fDApfXJldHVybiB0aGlzLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEpyKGUsMykpLHRoaXN9LGNvbXB1dGVCb3VuZGluZ0JveDpmdW5jdGlvbigpe251bGw9PT10aGlzLmJvdW5kaW5nQm94JiYodGhpcy5ib3VuZGluZ0JveD1uZXcgX24pO2NvbnN0IHQ9dGhpcy5hdHRyaWJ1dGVzLnBvc2l0aW9uLGU9dGhpcy5tb3JwaEF0dHJpYnV0ZXMucG9zaXRpb247aWYodCYmdC5pc0dMQnVmZmVyQXR0cmlidXRlKXJldHVybiBjb25zb2xlLmVycm9yKCdUSFJFRS5CdWZmZXJHZW9tZXRyeS5jb21wdXRlQm91bmRpbmdCb3goKTogR0xCdWZmZXJBdHRyaWJ1dGUgcmVxdWlyZXMgYSBtYW51YWwgYm91bmRpbmcgYm94LiBBbHRlcm5hdGl2ZWx5IHNldCBcIm1lc2guZnJ1c3R1bUN1bGxlZFwiIHRvIFwiZmFsc2VcIi4nLHRoaXMpLHZvaWQgdGhpcy5ib3VuZGluZ0JveC5zZXQobmV3IGZuKC0xLzAsLTEvMCwtMS8wKSxuZXcgZm4oMS8wLDEvMCwxLzApKTtpZih2b2lkIDAhPT10KXtpZih0aGlzLmJvdW5kaW5nQm94LnNldEZyb21CdWZmZXJBdHRyaWJ1dGUodCksZSlmb3IobGV0IHQ9MCxpPWUubGVuZ3RoO3Q8aTt0Kyspe2NvbnN0IGk9ZVt0XTtvcy5zZXRGcm9tQnVmZmVyQXR0cmlidXRlKGkpLHRoaXMubW9ycGhUYXJnZXRzUmVsYXRpdmU/KGNzLmFkZFZlY3RvcnModGhpcy5ib3VuZGluZ0JveC5taW4sb3MubWluKSx0aGlzLmJvdW5kaW5nQm94LmV4cGFuZEJ5UG9pbnQoY3MpLGNzLmFkZFZlY3RvcnModGhpcy5ib3VuZGluZ0JveC5tYXgsb3MubWF4KSx0aGlzLmJvdW5kaW5nQm94LmV4cGFuZEJ5UG9pbnQoY3MpKToodGhpcy5ib3VuZGluZ0JveC5leHBhbmRCeVBvaW50KG9zLm1pbiksdGhpcy5ib3VuZGluZ0JveC5leHBhbmRCeVBvaW50KG9zLm1heCkpfX1lbHNlIHRoaXMuYm91bmRpbmdCb3gubWFrZUVtcHR5KCk7KGlzTmFOKHRoaXMuYm91bmRpbmdCb3gubWluLngpfHxpc05hTih0aGlzLmJvdW5kaW5nQm94Lm1pbi55KXx8aXNOYU4odGhpcy5ib3VuZGluZ0JveC5taW4ueikpJiZjb25zb2xlLmVycm9yKCdUSFJFRS5CdWZmZXJHZW9tZXRyeS5jb21wdXRlQm91bmRpbmdCb3goKTogQ29tcHV0ZWQgbWluL21heCBoYXZlIE5hTiB2YWx1ZXMuIFRoZSBcInBvc2l0aW9uXCIgYXR0cmlidXRlIGlzIGxpa2VseSB0byBoYXZlIE5hTiB2YWx1ZXMuJyx0aGlzKX0sY29tcHV0ZUJvdW5kaW5nU3BoZXJlOmZ1bmN0aW9uKCl7bnVsbD09PXRoaXMuYm91bmRpbmdTcGhlcmUmJih0aGlzLmJvdW5kaW5nU3BoZXJlPW5ldyBPbik7Y29uc3QgdD10aGlzLmF0dHJpYnV0ZXMucG9zaXRpb24sZT10aGlzLm1vcnBoQXR0cmlidXRlcy5wb3NpdGlvbjtpZih0JiZ0LmlzR0xCdWZmZXJBdHRyaWJ1dGUpcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1RIUkVFLkJ1ZmZlckdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpOiBHTEJ1ZmZlckF0dHJpYnV0ZSByZXF1aXJlcyBhIG1hbnVhbCBib3VuZGluZyBzcGhlcmUuIEFsdGVybmF0aXZlbHkgc2V0IFwibWVzaC5mcnVzdHVtQ3VsbGVkXCIgdG8gXCJmYWxzZVwiLicsdGhpcyksdm9pZCB0aGlzLmJvdW5kaW5nU3BoZXJlLnNldChuZXcgZm4sMS8wKTtpZih0KXtjb25zdCBpPXRoaXMuYm91bmRpbmdTcGhlcmUuY2VudGVyO2lmKG9zLnNldEZyb21CdWZmZXJBdHRyaWJ1dGUodCksZSlmb3IobGV0IHQ9MCxpPWUubGVuZ3RoO3Q8aTt0Kyspe2NvbnN0IGk9ZVt0XTthcy5zZXRGcm9tQnVmZmVyQXR0cmlidXRlKGkpLHRoaXMubW9ycGhUYXJnZXRzUmVsYXRpdmU/KGNzLmFkZFZlY3RvcnMob3MubWluLGFzLm1pbiksb3MuZXhwYW5kQnlQb2ludChjcyksY3MuYWRkVmVjdG9ycyhvcy5tYXgsYXMubWF4KSxvcy5leHBhbmRCeVBvaW50KGNzKSk6KG9zLmV4cGFuZEJ5UG9pbnQoYXMubWluKSxvcy5leHBhbmRCeVBvaW50KGFzLm1heCkpfW9zLmdldENlbnRlcihpKTtsZXQgbj0wO2ZvcihsZXQgZT0wLHI9dC5jb3VudDtlPHI7ZSsrKWNzLmZyb21CdWZmZXJBdHRyaWJ1dGUodCxlKSxuPU1hdGgubWF4KG4saS5kaXN0YW5jZVRvU3F1YXJlZChjcykpO2lmKGUpZm9yKGxldCByPTAscz1lLmxlbmd0aDtyPHM7cisrKXtjb25zdCBzPWVbcl0sbz10aGlzLm1vcnBoVGFyZ2V0c1JlbGF0aXZlO2ZvcihsZXQgZT0wLHI9cy5jb3VudDtlPHI7ZSsrKWNzLmZyb21CdWZmZXJBdHRyaWJ1dGUocyxlKSxvJiYoc3MuZnJvbUJ1ZmZlckF0dHJpYnV0ZSh0LGUpLGNzLmFkZChzcykpLG49TWF0aC5tYXgobixpLmRpc3RhbmNlVG9TcXVhcmVkKGNzKSl9dGhpcy5ib3VuZGluZ1NwaGVyZS5yYWRpdXM9TWF0aC5zcXJ0KG4pLGlzTmFOKHRoaXMuYm91bmRpbmdTcGhlcmUucmFkaXVzKSYmY29uc29sZS5lcnJvcignVEhSRUUuQnVmZmVyR2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCk6IENvbXB1dGVkIHJhZGl1cyBpcyBOYU4uIFRoZSBcInBvc2l0aW9uXCIgYXR0cmlidXRlIGlzIGxpa2VseSB0byBoYXZlIE5hTiB2YWx1ZXMuJyx0aGlzKX19LGNvbXB1dGVGYWNlTm9ybWFsczpmdW5jdGlvbigpe30sY29tcHV0ZVRhbmdlbnRzOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLmluZGV4LGU9dGhpcy5hdHRyaWJ1dGVzO2lmKG51bGw9PT10fHx2b2lkIDA9PT1lLnBvc2l0aW9ufHx2b2lkIDA9PT1lLm5vcm1hbHx8dm9pZCAwPT09ZS51dilyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuQnVmZmVyR2VvbWV0cnk6IC5jb21wdXRlVGFuZ2VudHMoKSBmYWlsZWQuIE1pc3NpbmcgcmVxdWlyZWQgYXR0cmlidXRlcyAoaW5kZXgsIHBvc2l0aW9uLCBub3JtYWwgb3IgdXYpXCIpO2NvbnN0IGk9dC5hcnJheSxuPWUucG9zaXRpb24uYXJyYXkscj1lLm5vcm1hbC5hcnJheSxzPWUudXYuYXJyYXksbz1uLmxlbmd0aC8zO3ZvaWQgMD09PWUudGFuZ2VudCYmdGhpcy5zZXRBdHRyaWJ1dGUoXCJ0YW5nZW50XCIsbmV3IEhyKG5ldyBGbG9hdDMyQXJyYXkoNCpvKSw0KSk7Y29uc3QgYT1lLnRhbmdlbnQuYXJyYXksYz1bXSxoPVtdO2ZvcihsZXQgdD0wO3Q8bzt0KyspY1t0XT1uZXcgZm4saFt0XT1uZXcgZm47Y29uc3QgbD1uZXcgZm4sdT1uZXcgZm4sZD1uZXcgZm4scD1uZXcgcm4sZj1uZXcgcm4sbT1uZXcgcm4sZz1uZXcgZm4sXz1uZXcgZm47ZnVuY3Rpb24gdih0LGUsaSl7bC5mcm9tQXJyYXkobiwzKnQpLHUuZnJvbUFycmF5KG4sMyplKSxkLmZyb21BcnJheShuLDMqaSkscC5mcm9tQXJyYXkocywyKnQpLGYuZnJvbUFycmF5KHMsMiplKSxtLmZyb21BcnJheShzLDIqaSksdS5zdWIobCksZC5zdWIobCksZi5zdWIocCksbS5zdWIocCk7Y29uc3Qgcj0xLyhmLngqbS55LW0ueCpmLnkpO2lzRmluaXRlKHIpJiYoZy5jb3B5KHUpLm11bHRpcGx5U2NhbGFyKG0ueSkuYWRkU2NhbGVkVmVjdG9yKGQsLWYueSkubXVsdGlwbHlTY2FsYXIociksXy5jb3B5KGQpLm11bHRpcGx5U2NhbGFyKGYueCkuYWRkU2NhbGVkVmVjdG9yKHUsLW0ueCkubXVsdGlwbHlTY2FsYXIociksY1t0XS5hZGQoZyksY1tlXS5hZGQoZyksY1tpXS5hZGQoZyksaFt0XS5hZGQoXyksaFtlXS5hZGQoXyksaFtpXS5hZGQoXykpfWxldCB5PXRoaXMuZ3JvdXBzOzA9PT15Lmxlbmd0aCYmKHk9W3tzdGFydDowLGNvdW50OmkubGVuZ3RofV0pO2ZvcihsZXQgdD0wLGU9eS5sZW5ndGg7dDxlOysrdCl7Y29uc3QgZT15W3RdLG49ZS5zdGFydDtmb3IobGV0IHQ9bixyPW4rZS5jb3VudDt0PHI7dCs9Myl2KGlbdCswXSxpW3QrMV0saVt0KzJdKX1jb25zdCBiPW5ldyBmbix4PW5ldyBmbix3PW5ldyBmbixTPW5ldyBmbjtmdW5jdGlvbiBNKHQpe3cuZnJvbUFycmF5KHIsMyp0KSxTLmNvcHkodyk7Y29uc3QgZT1jW3RdO2IuY29weShlKSxiLnN1Yih3Lm11bHRpcGx5U2NhbGFyKHcuZG90KGUpKSkubm9ybWFsaXplKCkseC5jcm9zc1ZlY3RvcnMoUyxlKTtjb25zdCBpPXguZG90KGhbdF0pPDA/LTE6MTthWzQqdF09Yi54LGFbNCp0KzFdPWIueSxhWzQqdCsyXT1iLnosYVs0KnQrM109aX1mb3IobGV0IHQ9MCxlPXkubGVuZ3RoO3Q8ZTsrK3Qpe2NvbnN0IGU9eVt0XSxuPWUuc3RhcnQ7Zm9yKGxldCB0PW4scj1uK2UuY291bnQ7dDxyO3QrPTMpTShpW3QrMF0pLE0oaVt0KzFdKSxNKGlbdCsyXSl9fSxjb21wdXRlVmVydGV4Tm9ybWFsczpmdW5jdGlvbigpe2NvbnN0IHQ9dGhpcy5pbmRleCxlPXRoaXMuZ2V0QXR0cmlidXRlKFwicG9zaXRpb25cIik7aWYodm9pZCAwIT09ZSl7bGV0IGk9dGhpcy5nZXRBdHRyaWJ1dGUoXCJub3JtYWxcIik7aWYodm9pZCAwPT09aSlpPW5ldyBIcihuZXcgRmxvYXQzMkFycmF5KDMqZS5jb3VudCksMyksdGhpcy5zZXRBdHRyaWJ1dGUoXCJub3JtYWxcIixpKTtlbHNlIGZvcihsZXQgdD0wLGU9aS5jb3VudDt0PGU7dCsrKWkuc2V0WFlaKHQsMCwwLDApO2NvbnN0IG49bmV3IGZuLHI9bmV3IGZuLHM9bmV3IGZuLG89bmV3IGZuLGE9bmV3IGZuLGM9bmV3IGZuLGg9bmV3IGZuLGw9bmV3IGZuO2lmKHQpZm9yKGxldCB1PTAsZD10LmNvdW50O3U8ZDt1Kz0zKXtjb25zdCBkPXQuZ2V0WCh1KzApLHA9dC5nZXRYKHUrMSksZj10LmdldFgodSsyKTtuLmZyb21CdWZmZXJBdHRyaWJ1dGUoZSxkKSxyLmZyb21CdWZmZXJBdHRyaWJ1dGUoZSxwKSxzLmZyb21CdWZmZXJBdHRyaWJ1dGUoZSxmKSxoLnN1YlZlY3RvcnMocyxyKSxsLnN1YlZlY3RvcnMobixyKSxoLmNyb3NzKGwpLG8uZnJvbUJ1ZmZlckF0dHJpYnV0ZShpLGQpLGEuZnJvbUJ1ZmZlckF0dHJpYnV0ZShpLHApLGMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShpLGYpLG8uYWRkKGgpLGEuYWRkKGgpLGMuYWRkKGgpLGkuc2V0WFlaKGQsby54LG8ueSxvLnopLGkuc2V0WFlaKHAsYS54LGEueSxhLnopLGkuc2V0WFlaKGYsYy54LGMueSxjLnopfWVsc2UgZm9yKGxldCB0PTAsbz1lLmNvdW50O3Q8bzt0Kz0zKW4uZnJvbUJ1ZmZlckF0dHJpYnV0ZShlLHQrMCksci5mcm9tQnVmZmVyQXR0cmlidXRlKGUsdCsxKSxzLmZyb21CdWZmZXJBdHRyaWJ1dGUoZSx0KzIpLGguc3ViVmVjdG9ycyhzLHIpLGwuc3ViVmVjdG9ycyhuLHIpLGguY3Jvc3MobCksaS5zZXRYWVoodCswLGgueCxoLnksaC56KSxpLnNldFhZWih0KzEsaC54LGgueSxoLnopLGkuc2V0WFlaKHQrMixoLngsaC55LGgueik7dGhpcy5ub3JtYWxpemVOb3JtYWxzKCksaS5uZWVkc1VwZGF0ZT0hMH19LG1lcmdlOmZ1bmN0aW9uKHQsZSl7aWYoIXR8fCF0LmlzQnVmZmVyR2VvbWV0cnkpcmV0dXJuIHZvaWQgY29uc29sZS5lcnJvcihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5Lm1lcmdlKCk6IGdlb21ldHJ5IG5vdCBhbiBpbnN0YW5jZSBvZiBUSFJFRS5CdWZmZXJHZW9tZXRyeS5cIix0KTt2b2lkIDA9PT1lJiYoZT0wLGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5Lm1lcmdlKCk6IE92ZXJ3cml0aW5nIG9yaWdpbmFsIGdlb21ldHJ5LCBzdGFydGluZyBhdCBvZmZzZXQ9MC4gVXNlIEJ1ZmZlckdlb21ldHJ5VXRpbHMubWVyZ2VCdWZmZXJHZW9tZXRyaWVzKCkgZm9yIGxvc3NsZXNzIG1lcmdlLlwiKSk7Y29uc3QgaT10aGlzLmF0dHJpYnV0ZXM7Zm9yKGNvbnN0IG4gaW4gaSl7aWYodm9pZCAwPT09dC5hdHRyaWJ1dGVzW25dKWNvbnRpbnVlO2NvbnN0IHI9aVtuXS5hcnJheSxzPXQuYXR0cmlidXRlc1tuXSxvPXMuYXJyYXksYT1zLml0ZW1TaXplKmUsYz1NYXRoLm1pbihvLmxlbmd0aCxyLmxlbmd0aC1hKTtmb3IobGV0IHQ9MCxlPWE7dDxjO3QrKyxlKyspcltlXT1vW3RdfXJldHVybiB0aGlzfSxub3JtYWxpemVOb3JtYWxzOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLmF0dHJpYnV0ZXMubm9ybWFsO2ZvcihsZXQgZT0wLGk9dC5jb3VudDtlPGk7ZSsrKWNzLmZyb21CdWZmZXJBdHRyaWJ1dGUodCxlKSxjcy5ub3JtYWxpemUoKSx0LnNldFhZWihlLGNzLngsY3MueSxjcy56KX0sdG9Ob25JbmRleGVkOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUpe2NvbnN0IGk9dC5hcnJheSxuPXQuaXRlbVNpemUscj10Lm5vcm1hbGl6ZWQscz1uZXcgaS5jb25zdHJ1Y3RvcihlLmxlbmd0aCpuKTtsZXQgbz0wLGE9MDtmb3IobGV0IHQ9MCxyPWUubGVuZ3RoO3Q8cjt0Kyspe289ZVt0XSpuO2ZvcihsZXQgdD0wO3Q8bjt0Kyspc1thKytdPWlbbysrXX1yZXR1cm4gbmV3IEhyKHMsbixyKX1pZihudWxsPT09dGhpcy5pbmRleClyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyR2VvbWV0cnkudG9Ob25JbmRleGVkKCk6IEJ1ZmZlckdlb21ldHJ5IGlzIGFscmVhZHkgbm9uLWluZGV4ZWQuXCIpLHRoaXM7Y29uc3QgZT1uZXcgaHMsaT10aGlzLmluZGV4LmFycmF5LG49dGhpcy5hdHRyaWJ1dGVzO2Zvcihjb25zdCByIGluIG4pe2NvbnN0IHM9dChuW3JdLGkpO2Uuc2V0QXR0cmlidXRlKHIscyl9Y29uc3Qgcj10aGlzLm1vcnBoQXR0cmlidXRlcztmb3IoY29uc3QgbiBpbiByKXtjb25zdCBzPVtdLG89cltuXTtmb3IobGV0IGU9MCxuPW8ubGVuZ3RoO2U8bjtlKyspe2NvbnN0IG49dChvW2VdLGkpO3MucHVzaChuKX1lLm1vcnBoQXR0cmlidXRlc1tuXT1zfWUubW9ycGhUYXJnZXRzUmVsYXRpdmU9dGhpcy5tb3JwaFRhcmdldHNSZWxhdGl2ZTtjb25zdCBzPXRoaXMuZ3JvdXBzO2ZvcihsZXQgdD0wLGk9cy5sZW5ndGg7dDxpO3QrKyl7Y29uc3QgaT1zW3RdO2UuYWRkR3JvdXAoaS5zdGFydCxpLmNvdW50LGkubWF0ZXJpYWxJbmRleCl9cmV0dXJuIGV9LHRvSlNPTjpmdW5jdGlvbigpe2NvbnN0IHQ9e21ldGFkYXRhOnt2ZXJzaW9uOjQuNSx0eXBlOlwiQnVmZmVyR2VvbWV0cnlcIixnZW5lcmF0b3I6XCJCdWZmZXJHZW9tZXRyeS50b0pTT05cIn19O2lmKHQudXVpZD10aGlzLnV1aWQsdC50eXBlPXRoaXMudHlwZSxcIlwiIT09dGhpcy5uYW1lJiYodC5uYW1lPXRoaXMubmFtZSksT2JqZWN0LmtleXModGhpcy51c2VyRGF0YSkubGVuZ3RoPjAmJih0LnVzZXJEYXRhPXRoaXMudXNlckRhdGEpLHZvaWQgMCE9PXRoaXMucGFyYW1ldGVycyl7Y29uc3QgZT10aGlzLnBhcmFtZXRlcnM7Zm9yKGNvbnN0IGkgaW4gZSl2b2lkIDAhPT1lW2ldJiYodFtpXT1lW2ldKTtyZXR1cm4gdH10LmRhdGE9e2F0dHJpYnV0ZXM6e319O2NvbnN0IGU9dGhpcy5pbmRleDtudWxsIT09ZSYmKHQuZGF0YS5pbmRleD17dHlwZTplLmFycmF5LmNvbnN0cnVjdG9yLm5hbWUsYXJyYXk6QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZS5hcnJheSl9KTtjb25zdCBpPXRoaXMuYXR0cmlidXRlcztmb3IoY29uc3QgZSBpbiBpKXtjb25zdCBuPWlbZV0scj1uLnRvSlNPTih0LmRhdGEpO1wiXCIhPT1uLm5hbWUmJihyLm5hbWU9bi5uYW1lKSx0LmRhdGEuYXR0cmlidXRlc1tlXT1yfWNvbnN0IG49e307bGV0IHI9ITE7Zm9yKGNvbnN0IGUgaW4gdGhpcy5tb3JwaEF0dHJpYnV0ZXMpe2NvbnN0IGk9dGhpcy5tb3JwaEF0dHJpYnV0ZXNbZV0scz1bXTtmb3IobGV0IGU9MCxuPWkubGVuZ3RoO2U8bjtlKyspe2NvbnN0IG49aVtlXSxyPW4udG9KU09OKHQuZGF0YSk7XCJcIiE9PW4ubmFtZSYmKHIubmFtZT1uLm5hbWUpLHMucHVzaChyKX1zLmxlbmd0aD4wJiYobltlXT1zLHI9ITApfXImJih0LmRhdGEubW9ycGhBdHRyaWJ1dGVzPW4sdC5kYXRhLm1vcnBoVGFyZ2V0c1JlbGF0aXZlPXRoaXMubW9ycGhUYXJnZXRzUmVsYXRpdmUpO2NvbnN0IHM9dGhpcy5ncm91cHM7cy5sZW5ndGg+MCYmKHQuZGF0YS5ncm91cHM9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzKSkpO2NvbnN0IG89dGhpcy5ib3VuZGluZ1NwaGVyZTtyZXR1cm4gbnVsbCE9PW8mJih0LmRhdGEuYm91bmRpbmdTcGhlcmU9e2NlbnRlcjpvLmNlbnRlci50b0FycmF5KCkscmFkaXVzOm8ucmFkaXVzfSksdH0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4obmV3IGhzKS5jb3B5KHRoaXMpfSxjb3B5OmZ1bmN0aW9uKHQpe3RoaXMuaW5kZXg9bnVsbCx0aGlzLmF0dHJpYnV0ZXM9e30sdGhpcy5tb3JwaEF0dHJpYnV0ZXM9e30sdGhpcy5ncm91cHM9W10sdGhpcy5ib3VuZGluZ0JveD1udWxsLHRoaXMuYm91bmRpbmdTcGhlcmU9bnVsbDtjb25zdCBlPXt9O3RoaXMubmFtZT10Lm5hbWU7Y29uc3QgaT10LmluZGV4O251bGwhPT1pJiZ0aGlzLnNldEluZGV4KGkuY2xvbmUoZSkpO2NvbnN0IG49dC5hdHRyaWJ1dGVzO2Zvcihjb25zdCB0IGluIG4pe2NvbnN0IGk9blt0XTt0aGlzLnNldEF0dHJpYnV0ZSh0LGkuY2xvbmUoZSkpfWNvbnN0IHI9dC5tb3JwaEF0dHJpYnV0ZXM7Zm9yKGNvbnN0IHQgaW4gcil7Y29uc3QgaT1bXSxuPXJbdF07Zm9yKGxldCB0PTAscj1uLmxlbmd0aDt0PHI7dCsrKWkucHVzaChuW3RdLmNsb25lKGUpKTt0aGlzLm1vcnBoQXR0cmlidXRlc1t0XT1pfXRoaXMubW9ycGhUYXJnZXRzUmVsYXRpdmU9dC5tb3JwaFRhcmdldHNSZWxhdGl2ZTtjb25zdCBzPXQuZ3JvdXBzO2ZvcihsZXQgdD0wLGU9cy5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT1zW3RdO3RoaXMuYWRkR3JvdXAoZS5zdGFydCxlLmNvdW50LGUubWF0ZXJpYWxJbmRleCl9Y29uc3Qgbz10LmJvdW5kaW5nQm94O251bGwhPT1vJiYodGhpcy5ib3VuZGluZ0JveD1vLmNsb25lKCkpO2NvbnN0IGE9dC5ib3VuZGluZ1NwaGVyZTtyZXR1cm4gbnVsbCE9PWEmJih0aGlzLmJvdW5kaW5nU3BoZXJlPWEuY2xvbmUoKSksdGhpcy5kcmF3UmFuZ2Uuc3RhcnQ9dC5kcmF3UmFuZ2Uuc3RhcnQsdGhpcy5kcmF3UmFuZ2UuY291bnQ9dC5kcmF3UmFuZ2UuY291bnQsdGhpcy51c2VyRGF0YT10LnVzZXJEYXRhLHRoaXN9LGRpc3Bvc2U6ZnVuY3Rpb24oKXt0aGlzLmRpc3BhdGNoRXZlbnQoe3R5cGU6XCJkaXNwb3NlXCJ9KX19KTtjb25zdCBscz1uZXcgSG4sdXM9bmV3IGpuLGRzPW5ldyBPbixwcz1uZXcgZm4sZnM9bmV3IGZuLG1zPW5ldyBmbixncz1uZXcgZm4sX3M9bmV3IGZuLHZzPW5ldyBmbix5cz1uZXcgZm4sYnM9bmV3IGZuLHhzPW5ldyBmbix3cz1uZXcgcm4sU3M9bmV3IHJuLE1zPW5ldyBybixUcz1uZXcgZm4sQ3M9bmV3IGZuO2Z1bmN0aW9uIEVzKHQ9bmV3IGhzLGU9bmV3IEZyKXtwci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIk1lc2hcIix0aGlzLmdlb21ldHJ5PXQsdGhpcy5tYXRlcmlhbD1lLHRoaXMudXBkYXRlTW9ycGhUYXJnZXRzKCl9ZnVuY3Rpb24gSXModCxlLGksbixyLHMsbyxhLGMsaCxsLHUpe3BzLmZyb21CdWZmZXJBdHRyaWJ1dGUocixoKSxmcy5mcm9tQnVmZmVyQXR0cmlidXRlKHIsbCksbXMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShyLHUpO2NvbnN0IGQ9dC5tb3JwaFRhcmdldEluZmx1ZW5jZXM7aWYoZS5tb3JwaFRhcmdldHMmJnMmJmQpe3lzLnNldCgwLDAsMCksYnMuc2V0KDAsMCwwKSx4cy5zZXQoMCwwLDApO2ZvcihsZXQgdD0wLGU9cy5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT1kW3RdLGk9c1t0XTswIT09ZSYmKGdzLmZyb21CdWZmZXJBdHRyaWJ1dGUoaSxoKSxfcy5mcm9tQnVmZmVyQXR0cmlidXRlKGksbCksdnMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShpLHUpLG8/KHlzLmFkZFNjYWxlZFZlY3RvcihncyxlKSxicy5hZGRTY2FsZWRWZWN0b3IoX3MsZSkseHMuYWRkU2NhbGVkVmVjdG9yKHZzLGUpKTooeXMuYWRkU2NhbGVkVmVjdG9yKGdzLnN1YihwcyksZSksYnMuYWRkU2NhbGVkVmVjdG9yKF9zLnN1YihmcyksZSkseHMuYWRkU2NhbGVkVmVjdG9yKHZzLnN1YihtcyksZSkpKX1wcy5hZGQoeXMpLGZzLmFkZChicyksbXMuYWRkKHhzKX10LmlzU2tpbm5lZE1lc2gmJih0LmJvbmVUcmFuc2Zvcm0oaCxwcyksdC5ib25lVHJhbnNmb3JtKGwsZnMpLHQuYm9uZVRyYW5zZm9ybSh1LG1zKSk7Y29uc3QgcD1mdW5jdGlvbih0LGUsaSxuLHIscyxvLGEpe2xldCBjO2lmKGM9MT09PWUuc2lkZT9uLmludGVyc2VjdFRyaWFuZ2xlKG8scyxyLCEwLGEpOm4uaW50ZXJzZWN0VHJpYW5nbGUocixzLG8sMiE9PWUuc2lkZSxhKSxudWxsPT09YylyZXR1cm4gbnVsbDtDcy5jb3B5KGEpLENzLmFwcGx5TWF0cml4NCh0Lm1hdHJpeFdvcmxkKTtjb25zdCBoPWkucmF5Lm9yaWdpbi5kaXN0YW5jZVRvKENzKTtyZXR1cm4gaDxpLm5lYXJ8fGg+aS5mYXI/bnVsbDp7ZGlzdGFuY2U6aCxwb2ludDpDcy5jbG9uZSgpLG9iamVjdDp0fX0odCxlLGksbixwcyxmcyxtcyxUcyk7aWYocCl7YSYmKHdzLmZyb21CdWZmZXJBdHRyaWJ1dGUoYSxoKSxTcy5mcm9tQnVmZmVyQXR0cmlidXRlKGEsbCksTXMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShhLHUpLHAudXY9SXIuZ2V0VVYoVHMscHMsZnMsbXMsd3MsU3MsTXMsbmV3IHJuKSksYyYmKHdzLmZyb21CdWZmZXJBdHRyaWJ1dGUoYyxoKSxTcy5mcm9tQnVmZmVyQXR0cmlidXRlKGMsbCksTXMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShjLHUpLHAudXYyPUlyLmdldFVWKFRzLHBzLGZzLG1zLHdzLFNzLE1zLG5ldyBybikpO2NvbnN0IHQ9bmV3ICRyKGgsbCx1KTtJci5nZXROb3JtYWwocHMsZnMsbXMsdC5ub3JtYWwpLHAuZmFjZT10fXJldHVybiBwfUVzLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocHIucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6RXMsaXNNZXNoOiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHByLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx2b2lkIDAhPT10Lm1vcnBoVGFyZ2V0SW5mbHVlbmNlcyYmKHRoaXMubW9ycGhUYXJnZXRJbmZsdWVuY2VzPXQubW9ycGhUYXJnZXRJbmZsdWVuY2VzLnNsaWNlKCkpLHZvaWQgMCE9PXQubW9ycGhUYXJnZXREaWN0aW9uYXJ5JiYodGhpcy5tb3JwaFRhcmdldERpY3Rpb25hcnk9T2JqZWN0LmFzc2lnbih7fSx0Lm1vcnBoVGFyZ2V0RGljdGlvbmFyeSkpLHRoaXMubWF0ZXJpYWw9dC5tYXRlcmlhbCx0aGlzLmdlb21ldHJ5PXQuZ2VvbWV0cnksdGhpc30sdXBkYXRlTW9ycGhUYXJnZXRzOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLmdlb21ldHJ5O2lmKHQuaXNCdWZmZXJHZW9tZXRyeSl7Y29uc3QgZT10Lm1vcnBoQXR0cmlidXRlcyxpPU9iamVjdC5rZXlzKGUpO2lmKGkubGVuZ3RoPjApe2NvbnN0IHQ9ZVtpWzBdXTtpZih2b2lkIDAhPT10KXt0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcz1bXSx0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeT17fTtmb3IobGV0IGU9MCxpPXQubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dFtlXS5uYW1lfHxTdHJpbmcoZSk7dGhpcy5tb3JwaFRhcmdldEluZmx1ZW5jZXMucHVzaCgwKSx0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeVtpXT1lfX19fWVsc2V7Y29uc3QgZT10Lm1vcnBoVGFyZ2V0czt2b2lkIDAhPT1lJiZlLmxlbmd0aD4wJiZjb25zb2xlLmVycm9yKFwiVEhSRUUuTWVzaC51cGRhdGVNb3JwaFRhcmdldHMoKSBubyBsb25nZXIgc3VwcG9ydHMgVEhSRUUuR2VvbWV0cnkuIFVzZSBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLlwiKX19LHJheWNhc3Q6ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMuZ2VvbWV0cnksbj10aGlzLm1hdGVyaWFsLHI9dGhpcy5tYXRyaXhXb3JsZDtpZih2b2lkIDA9PT1uKXJldHVybjtpZihudWxsPT09aS5ib3VuZGluZ1NwaGVyZSYmaS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKSxkcy5jb3B5KGkuYm91bmRpbmdTcGhlcmUpLGRzLmFwcGx5TWF0cml4NChyKSwhMT09PXQucmF5LmludGVyc2VjdHNTcGhlcmUoZHMpKXJldHVybjtpZihscy5jb3B5KHIpLmludmVydCgpLHVzLmNvcHkodC5yYXkpLmFwcGx5TWF0cml4NChscyksbnVsbCE9PWkuYm91bmRpbmdCb3gmJiExPT09dXMuaW50ZXJzZWN0c0JveChpLmJvdW5kaW5nQm94KSlyZXR1cm47bGV0IHM7aWYoaS5pc0J1ZmZlckdlb21ldHJ5KXtjb25zdCByPWkuaW5kZXgsbz1pLmF0dHJpYnV0ZXMucG9zaXRpb24sYT1pLm1vcnBoQXR0cmlidXRlcy5wb3NpdGlvbixjPWkubW9ycGhUYXJnZXRzUmVsYXRpdmUsaD1pLmF0dHJpYnV0ZXMudXYsbD1pLmF0dHJpYnV0ZXMudXYyLHU9aS5ncm91cHMsZD1pLmRyYXdSYW5nZTtpZihudWxsIT09cilpZihBcnJheS5pc0FycmF5KG4pKWZvcihsZXQgaT0wLHA9dS5sZW5ndGg7aTxwO2krKyl7Y29uc3QgcD11W2ldLGY9bltwLm1hdGVyaWFsSW5kZXhdO2ZvcihsZXQgaT1NYXRoLm1heChwLnN0YXJ0LGQuc3RhcnQpLG49TWF0aC5taW4ocC5zdGFydCtwLmNvdW50LGQuc3RhcnQrZC5jb3VudCk7aTxuO2krPTMpe2NvbnN0IG49ci5nZXRYKGkpLHU9ci5nZXRYKGkrMSksZD1yLmdldFgoaSsyKTtzPUlzKHRoaXMsZix0LHVzLG8sYSxjLGgsbCxuLHUsZCkscyYmKHMuZmFjZUluZGV4PU1hdGguZmxvb3IoaS8zKSxzLmZhY2UubWF0ZXJpYWxJbmRleD1wLm1hdGVyaWFsSW5kZXgsZS5wdXNoKHMpKX19ZWxzZXtmb3IobGV0IGk9TWF0aC5tYXgoMCxkLnN0YXJ0KSx1PU1hdGgubWluKHIuY291bnQsZC5zdGFydCtkLmNvdW50KTtpPHU7aSs9Myl7Y29uc3QgdT1yLmdldFgoaSksZD1yLmdldFgoaSsxKSxwPXIuZ2V0WChpKzIpO3M9SXModGhpcyxuLHQsdXMsbyxhLGMsaCxsLHUsZCxwKSxzJiYocy5mYWNlSW5kZXg9TWF0aC5mbG9vcihpLzMpLGUucHVzaChzKSl9fWVsc2UgaWYodm9pZCAwIT09bylpZihBcnJheS5pc0FycmF5KG4pKWZvcihsZXQgaT0wLHI9dS5sZW5ndGg7aTxyO2krKyl7Y29uc3Qgcj11W2ldLHA9bltyLm1hdGVyaWFsSW5kZXhdO2ZvcihsZXQgaT1NYXRoLm1heChyLnN0YXJ0LGQuc3RhcnQpLG49TWF0aC5taW4oci5zdGFydCtyLmNvdW50LGQuc3RhcnQrZC5jb3VudCk7aTxuO2krPTMpe3M9SXModGhpcyxwLHQsdXMsbyxhLGMsaCxsLGksaSsxLGkrMikscyYmKHMuZmFjZUluZGV4PU1hdGguZmxvb3IoaS8zKSxzLmZhY2UubWF0ZXJpYWxJbmRleD1yLm1hdGVyaWFsSW5kZXgsZS5wdXNoKHMpKX19ZWxzZXtmb3IobGV0IGk9TWF0aC5tYXgoMCxkLnN0YXJ0KSxyPU1hdGgubWluKG8uY291bnQsZC5zdGFydCtkLmNvdW50KTtpPHI7aSs9Myl7cz1Jcyh0aGlzLG4sdCx1cyxvLGEsYyxoLGwsaSxpKzEsaSsyKSxzJiYocy5mYWNlSW5kZXg9TWF0aC5mbG9vcihpLzMpLGUucHVzaChzKSl9fX1lbHNlIGkuaXNHZW9tZXRyeSYmY29uc29sZS5lcnJvcihcIlRIUkVFLk1lc2gucmF5Y2FzdCgpIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuXCIpfX0pO2NsYXNzIEFzIGV4dGVuZHMgaHN7Y29uc3RydWN0b3IodD0xLGU9MSxpPTEsbj0xLHI9MSxzPTEpe3N1cGVyKCksdGhpcy50eXBlPVwiQm94R2VvbWV0cnlcIix0aGlzLnBhcmFtZXRlcnM9e3dpZHRoOnQsaGVpZ2h0OmUsZGVwdGg6aSx3aWR0aFNlZ21lbnRzOm4saGVpZ2h0U2VnbWVudHM6cixkZXB0aFNlZ21lbnRzOnN9O2NvbnN0IG89dGhpcztuPU1hdGguZmxvb3Iobikscj1NYXRoLmZsb29yKHIpLHM9TWF0aC5mbG9vcihzKTtjb25zdCBhPVtdLGM9W10saD1bXSxsPVtdO2xldCB1PTAsZD0wO2Z1bmN0aW9uIHAodCxlLGksbixyLHMscCxmLG0sZyxfKXtjb25zdCB2PXMvbSx5PXAvZyxiPXMvMix4PXAvMix3PWYvMixTPW0rMSxNPWcrMTtsZXQgVD0wLEM9MDtjb25zdCBFPW5ldyBmbjtmb3IobGV0IHM9MDtzPE07cysrKXtjb25zdCBvPXMqeS14O2ZvcihsZXQgYT0wO2E8UzthKyspe2NvbnN0IHU9YSp2LWI7RVt0XT11Km4sRVtlXT1vKnIsRVtpXT13LGMucHVzaChFLngsRS55LEUueiksRVt0XT0wLEVbZV09MCxFW2ldPWY+MD8xOi0xLGgucHVzaChFLngsRS55LEUueiksbC5wdXNoKGEvbSksbC5wdXNoKDEtcy9nKSxUKz0xfX1mb3IobGV0IHQ9MDt0PGc7dCsrKWZvcihsZXQgZT0wO2U8bTtlKyspe2NvbnN0IGk9dStlK1MqdCxuPXUrZStTKih0KzEpLHI9dSsoZSsxKStTKih0KzEpLHM9dSsoZSsxKStTKnQ7YS5wdXNoKGksbixzKSxhLnB1c2gobixyLHMpLEMrPTZ9by5hZGRHcm91cChkLEMsXyksZCs9Qyx1Kz1UfXAoXCJ6XCIsXCJ5XCIsXCJ4XCIsLTEsLTEsaSxlLHQscyxyLDApLHAoXCJ6XCIsXCJ5XCIsXCJ4XCIsMSwtMSxpLGUsLXQscyxyLDEpLHAoXCJ4XCIsXCJ6XCIsXCJ5XCIsMSwxLHQsaSxlLG4scywyKSxwKFwieFwiLFwielwiLFwieVwiLDEsLTEsdCxpLC1lLG4scywzKSxwKFwieFwiLFwieVwiLFwielwiLDEsLTEsdCxlLGksbixyLDQpLHAoXCJ4XCIsXCJ5XCIsXCJ6XCIsLTEsLTEsdCxlLC1pLG4sciw1KSx0aGlzLnNldEluZGV4KGEpLHRoaXMuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSnIoYywzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJub3JtYWxcIixuZXcgSnIoaCwzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJ1dlwiLG5ldyBKcihsLDIpKX19ZnVuY3Rpb24gUHModCl7Y29uc3QgZT17fTtmb3IoY29uc3QgaSBpbiB0KXtlW2ldPXt9O2Zvcihjb25zdCBuIGluIHRbaV0pe2NvbnN0IHI9dFtpXVtuXTtyJiYoci5pc0NvbG9yfHxyLmlzTWF0cml4M3x8ci5pc01hdHJpeDR8fHIuaXNWZWN0b3IyfHxyLmlzVmVjdG9yM3x8ci5pc1ZlY3RvcjR8fHIuaXNUZXh0dXJlKT9lW2ldW25dPXIuY2xvbmUoKTpBcnJheS5pc0FycmF5KHIpP2VbaV1bbl09ci5zbGljZSgpOmVbaV1bbl09cn19cmV0dXJuIGV9ZnVuY3Rpb24gUnModCl7Y29uc3QgZT17fTtmb3IobGV0IGk9MDtpPHQubGVuZ3RoO2krKyl7Y29uc3Qgbj1Qcyh0W2ldKTtmb3IoY29uc3QgdCBpbiBuKWVbdF09blt0XX1yZXR1cm4gZX1jb25zdCBMcz17Y2xvbmU6UHMsbWVyZ2U6UnN9O2Z1bmN0aW9uIE9zKHQpe3pyLmNhbGwodGhpcyksdGhpcy50eXBlPVwiU2hhZGVyTWF0ZXJpYWxcIix0aGlzLmRlZmluZXM9e30sdGhpcy51bmlmb3Jtcz17fSx0aGlzLnZlcnRleFNoYWRlcj1cInZvaWQgbWFpbigpIHtcXG5cXHRnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XFxufVwiLHRoaXMuZnJhZ21lbnRTaGFkZXI9XCJ2b2lkIG1haW4oKSB7XFxuXFx0Z2xfRnJhZ0NvbG9yID0gdmVjNCggMS4wLCAwLjAsIDAuMCwgMS4wICk7XFxufVwiLHRoaXMubGluZXdpZHRoPTEsdGhpcy53aXJlZnJhbWU9ITEsdGhpcy53aXJlZnJhbWVMaW5ld2lkdGg9MSx0aGlzLmZvZz0hMSx0aGlzLmxpZ2h0cz0hMSx0aGlzLmNsaXBwaW5nPSExLHRoaXMuc2tpbm5pbmc9ITEsdGhpcy5tb3JwaFRhcmdldHM9ITEsdGhpcy5tb3JwaE5vcm1hbHM9ITEsdGhpcy5leHRlbnNpb25zPXtkZXJpdmF0aXZlczohMSxmcmFnRGVwdGg6ITEsZHJhd0J1ZmZlcnM6ITEsc2hhZGVyVGV4dHVyZUxPRDohMX0sdGhpcy5kZWZhdWx0QXR0cmlidXRlVmFsdWVzPXtjb2xvcjpbMSwxLDFdLHV2OlswLDBdLHV2MjpbMCwwXX0sdGhpcy5pbmRleDBBdHRyaWJ1dGVOYW1lPXZvaWQgMCx0aGlzLnVuaWZvcm1zTmVlZFVwZGF0ZT0hMSx0aGlzLmdsc2xWZXJzaW9uPW51bGwsdm9pZCAwIT09dCYmKHZvaWQgMCE9PXQuYXR0cmlidXRlcyYmY29uc29sZS5lcnJvcihcIlRIUkVFLlNoYWRlck1hdGVyaWFsOiBhdHRyaWJ1dGVzIHNob3VsZCBub3cgYmUgZGVmaW5lZCBpbiBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLlwiKSx0aGlzLnNldFZhbHVlcyh0KSl9ZnVuY3Rpb24gTnMoKXtwci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIkNhbWVyYVwiLHRoaXMubWF0cml4V29ybGRJbnZlcnNlPW5ldyBIbix0aGlzLnByb2plY3Rpb25NYXRyaXg9bmV3IEhuLHRoaXMucHJvamVjdGlvbk1hdHJpeEludmVyc2U9bmV3IEhufWZ1bmN0aW9uIERzKHQ9NTAsZT0xLGk9LjEsbj0yZTMpe05zLmNhbGwodGhpcyksdGhpcy50eXBlPVwiUGVyc3BlY3RpdmVDYW1lcmFcIix0aGlzLmZvdj10LHRoaXMuem9vbT0xLHRoaXMubmVhcj1pLHRoaXMuZmFyPW4sdGhpcy5mb2N1cz0xMCx0aGlzLmFzcGVjdD1lLHRoaXMudmlldz1udWxsLHRoaXMuZmlsbUdhdWdlPTM1LHRoaXMuZmlsbU9mZnNldD0wLHRoaXMudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpfU9zLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHpyLnByb3RvdHlwZSksT3MucHJvdG90eXBlLmNvbnN0cnVjdG9yPU9zLE9zLnByb3RvdHlwZS5pc1NoYWRlck1hdGVyaWFsPSEwLE9zLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiB6ci5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5mcmFnbWVudFNoYWRlcj10LmZyYWdtZW50U2hhZGVyLHRoaXMudmVydGV4U2hhZGVyPXQudmVydGV4U2hhZGVyLHRoaXMudW5pZm9ybXM9UHModC51bmlmb3JtcyksdGhpcy5kZWZpbmVzPU9iamVjdC5hc3NpZ24oe30sdC5kZWZpbmVzKSx0aGlzLndpcmVmcmFtZT10LndpcmVmcmFtZSx0aGlzLndpcmVmcmFtZUxpbmV3aWR0aD10LndpcmVmcmFtZUxpbmV3aWR0aCx0aGlzLmxpZ2h0cz10LmxpZ2h0cyx0aGlzLmNsaXBwaW5nPXQuY2xpcHBpbmcsdGhpcy5za2lubmluZz10LnNraW5uaW5nLHRoaXMubW9ycGhUYXJnZXRzPXQubW9ycGhUYXJnZXRzLHRoaXMubW9ycGhOb3JtYWxzPXQubW9ycGhOb3JtYWxzLHRoaXMuZXh0ZW5zaW9ucz1PYmplY3QuYXNzaWduKHt9LHQuZXh0ZW5zaW9ucyksdGhpcy5nbHNsVmVyc2lvbj10Lmdsc2xWZXJzaW9uLHRoaXN9LE9zLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24odCl7Y29uc3QgZT16ci5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyx0KTtlLmdsc2xWZXJzaW9uPXRoaXMuZ2xzbFZlcnNpb24sZS51bmlmb3Jtcz17fTtmb3IoY29uc3QgaSBpbiB0aGlzLnVuaWZvcm1zKXtjb25zdCBuPXRoaXMudW5pZm9ybXNbaV0udmFsdWU7biYmbi5pc1RleHR1cmU/ZS51bmlmb3Jtc1tpXT17dHlwZTpcInRcIix2YWx1ZTpuLnRvSlNPTih0KS51dWlkfTpuJiZuLmlzQ29sb3I/ZS51bmlmb3Jtc1tpXT17dHlwZTpcImNcIix2YWx1ZTpuLmdldEhleCgpfTpuJiZuLmlzVmVjdG9yMj9lLnVuaWZvcm1zW2ldPXt0eXBlOlwidjJcIix2YWx1ZTpuLnRvQXJyYXkoKX06biYmbi5pc1ZlY3RvcjM/ZS51bmlmb3Jtc1tpXT17dHlwZTpcInYzXCIsdmFsdWU6bi50b0FycmF5KCl9Om4mJm4uaXNWZWN0b3I0P2UudW5pZm9ybXNbaV09e3R5cGU6XCJ2NFwiLHZhbHVlOm4udG9BcnJheSgpfTpuJiZuLmlzTWF0cml4Mz9lLnVuaWZvcm1zW2ldPXt0eXBlOlwibTNcIix2YWx1ZTpuLnRvQXJyYXkoKX06biYmbi5pc01hdHJpeDQ/ZS51bmlmb3Jtc1tpXT17dHlwZTpcIm00XCIsdmFsdWU6bi50b0FycmF5KCl9OmUudW5pZm9ybXNbaV09e3ZhbHVlOm59fU9iamVjdC5rZXlzKHRoaXMuZGVmaW5lcykubGVuZ3RoPjAmJihlLmRlZmluZXM9dGhpcy5kZWZpbmVzKSxlLnZlcnRleFNoYWRlcj10aGlzLnZlcnRleFNoYWRlcixlLmZyYWdtZW50U2hhZGVyPXRoaXMuZnJhZ21lbnRTaGFkZXI7Y29uc3QgaT17fTtmb3IoY29uc3QgdCBpbiB0aGlzLmV4dGVuc2lvbnMpITA9PT10aGlzLmV4dGVuc2lvbnNbdF0mJihpW3RdPSEwKTtyZXR1cm4gT2JqZWN0LmtleXMoaSkubGVuZ3RoPjAmJihlLmV4dGVuc2lvbnM9aSksZX0sTnMucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShwci5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpOcyxpc0NhbWVyYTohMCxjb3B5OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHByLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0LGUpLHRoaXMubWF0cml4V29ybGRJbnZlcnNlLmNvcHkodC5tYXRyaXhXb3JsZEludmVyc2UpLHRoaXMucHJvamVjdGlvbk1hdHJpeC5jb3B5KHQucHJvamVjdGlvbk1hdHJpeCksdGhpcy5wcm9qZWN0aW9uTWF0cml4SW52ZXJzZS5jb3B5KHQucHJvamVjdGlvbk1hdHJpeEludmVyc2UpLHRoaXN9LGdldFdvcmxkRGlyZWN0aW9uOmZ1bmN0aW9uKHQpe3ZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5DYW1lcmE6IC5nZXRXb3JsZERpcmVjdGlvbigpIHRhcmdldCBpcyBub3cgcmVxdWlyZWRcIiksdD1uZXcgZm4pLHRoaXMudXBkYXRlV29ybGRNYXRyaXgoITAsITEpO2NvbnN0IGU9dGhpcy5tYXRyaXhXb3JsZC5lbGVtZW50cztyZXR1cm4gdC5zZXQoLWVbOF0sLWVbOV0sLWVbMTBdKS5ub3JtYWxpemUoKX0sdXBkYXRlTWF0cml4V29ybGQ6ZnVuY3Rpb24odCl7cHIucHJvdG90eXBlLnVwZGF0ZU1hdHJpeFdvcmxkLmNhbGwodGhpcyx0KSx0aGlzLm1hdHJpeFdvcmxkSW52ZXJzZS5jb3B5KHRoaXMubWF0cml4V29ybGQpLmludmVydCgpfSx1cGRhdGVXb3JsZE1hdHJpeDpmdW5jdGlvbih0LGUpe3ByLnByb3RvdHlwZS51cGRhdGVXb3JsZE1hdHJpeC5jYWxsKHRoaXMsdCxlKSx0aGlzLm1hdHJpeFdvcmxkSW52ZXJzZS5jb3B5KHRoaXMubWF0cml4V29ybGQpLmludmVydCgpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuY29weSh0aGlzKX19KSxEcy5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKE5zLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOkRzLGlzUGVyc3BlY3RpdmVDYW1lcmE6ITAsY29weTpmdW5jdGlvbih0LGUpe3JldHVybiBOcy5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCxlKSx0aGlzLmZvdj10LmZvdix0aGlzLnpvb209dC56b29tLHRoaXMubmVhcj10Lm5lYXIsdGhpcy5mYXI9dC5mYXIsdGhpcy5mb2N1cz10LmZvY3VzLHRoaXMuYXNwZWN0PXQuYXNwZWN0LHRoaXMudmlldz1udWxsPT09dC52aWV3P251bGw6T2JqZWN0LmFzc2lnbih7fSx0LnZpZXcpLHRoaXMuZmlsbUdhdWdlPXQuZmlsbUdhdWdlLHRoaXMuZmlsbU9mZnNldD10LmZpbG1PZmZzZXQsdGhpc30sc2V0Rm9jYWxMZW5ndGg6ZnVuY3Rpb24odCl7Y29uc3QgZT0uNSp0aGlzLmdldEZpbG1IZWlnaHQoKS90O3RoaXMuZm92PTIqbm4uUkFEMkRFRypNYXRoLmF0YW4oZSksdGhpcy51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCl9LGdldEZvY2FsTGVuZ3RoOmZ1bmN0aW9uKCl7Y29uc3QgdD1NYXRoLnRhbiguNSpubi5ERUcyUkFEKnRoaXMuZm92KTtyZXR1cm4uNSp0aGlzLmdldEZpbG1IZWlnaHQoKS90fSxnZXRFZmZlY3RpdmVGT1Y6ZnVuY3Rpb24oKXtyZXR1cm4gMipubi5SQUQyREVHKk1hdGguYXRhbihNYXRoLnRhbiguNSpubi5ERUcyUkFEKnRoaXMuZm92KS90aGlzLnpvb20pfSxnZXRGaWxtV2lkdGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWxtR2F1Z2UqTWF0aC5taW4odGhpcy5hc3BlY3QsMSl9LGdldEZpbG1IZWlnaHQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5maWxtR2F1Z2UvTWF0aC5tYXgodGhpcy5hc3BlY3QsMSl9LHNldFZpZXdPZmZzZXQ6ZnVuY3Rpb24odCxlLGksbixyLHMpe3RoaXMuYXNwZWN0PXQvZSxudWxsPT09dGhpcy52aWV3JiYodGhpcy52aWV3PXtlbmFibGVkOiEwLGZ1bGxXaWR0aDoxLGZ1bGxIZWlnaHQ6MSxvZmZzZXRYOjAsb2Zmc2V0WTowLHdpZHRoOjEsaGVpZ2h0OjF9KSx0aGlzLnZpZXcuZW5hYmxlZD0hMCx0aGlzLnZpZXcuZnVsbFdpZHRoPXQsdGhpcy52aWV3LmZ1bGxIZWlnaHQ9ZSx0aGlzLnZpZXcub2Zmc2V0WD1pLHRoaXMudmlldy5vZmZzZXRZPW4sdGhpcy52aWV3LndpZHRoPXIsdGhpcy52aWV3LmhlaWdodD1zLHRoaXMudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpfSxjbGVhclZpZXdPZmZzZXQ6ZnVuY3Rpb24oKXtudWxsIT09dGhpcy52aWV3JiYodGhpcy52aWV3LmVuYWJsZWQ9ITEpLHRoaXMudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpfSx1cGRhdGVQcm9qZWN0aW9uTWF0cml4OmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLm5lYXI7bGV0IGU9dCpNYXRoLnRhbiguNSpubi5ERUcyUkFEKnRoaXMuZm92KS90aGlzLnpvb20saT0yKmUsbj10aGlzLmFzcGVjdCppLHI9LS41Km47Y29uc3Qgcz10aGlzLnZpZXc7aWYobnVsbCE9PXRoaXMudmlldyYmdGhpcy52aWV3LmVuYWJsZWQpe2NvbnN0IHQ9cy5mdWxsV2lkdGgsbz1zLmZ1bGxIZWlnaHQ7cis9cy5vZmZzZXRYKm4vdCxlLT1zLm9mZnNldFkqaS9vLG4qPXMud2lkdGgvdCxpKj1zLmhlaWdodC9vfWNvbnN0IG89dGhpcy5maWxtT2Zmc2V0OzAhPT1vJiYocis9dCpvL3RoaXMuZ2V0RmlsbVdpZHRoKCkpLHRoaXMucHJvamVjdGlvbk1hdHJpeC5tYWtlUGVyc3BlY3RpdmUocixyK24sZSxlLWksdCx0aGlzLmZhciksdGhpcy5wcm9qZWN0aW9uTWF0cml4SW52ZXJzZS5jb3B5KHRoaXMucHJvamVjdGlvbk1hdHJpeCkuaW52ZXJ0KCl9LHRvSlNPTjpmdW5jdGlvbih0KXtjb25zdCBlPXByLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLHQpO3JldHVybiBlLm9iamVjdC5mb3Y9dGhpcy5mb3YsZS5vYmplY3Quem9vbT10aGlzLnpvb20sZS5vYmplY3QubmVhcj10aGlzLm5lYXIsZS5vYmplY3QuZmFyPXRoaXMuZmFyLGUub2JqZWN0LmZvY3VzPXRoaXMuZm9jdXMsZS5vYmplY3QuYXNwZWN0PXRoaXMuYXNwZWN0LG51bGwhPT10aGlzLnZpZXcmJihlLm9iamVjdC52aWV3PU9iamVjdC5hc3NpZ24oe30sdGhpcy52aWV3KSksZS5vYmplY3QuZmlsbUdhdWdlPXRoaXMuZmlsbUdhdWdlLGUub2JqZWN0LmZpbG1PZmZzZXQ9dGhpcy5maWxtT2Zmc2V0LGV9fSk7Y29uc3QgJHM9OTA7ZnVuY3Rpb24ga3ModCxlLGkpe2lmKHByLmNhbGwodGhpcyksdGhpcy50eXBlPVwiQ3ViZUNhbWVyYVwiLCEwIT09aS5pc1dlYkdMQ3ViZVJlbmRlclRhcmdldClyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuQ3ViZUNhbWVyYTogVGhlIGNvbnN0cnVjdG9yIG5vdyBleHBlY3RzIGFuIGluc3RhbmNlIG9mIFdlYkdMQ3ViZVJlbmRlclRhcmdldCBhcyB0aGlyZCBwYXJhbWV0ZXIuXCIpO3RoaXMucmVuZGVyVGFyZ2V0PWk7Y29uc3Qgbj1uZXcgRHMoJHMsMSx0LGUpO24ubGF5ZXJzPXRoaXMubGF5ZXJzLG4udXAuc2V0KDAsLTEsMCksbi5sb29rQXQobmV3IGZuKDEsMCwwKSksdGhpcy5hZGQobik7Y29uc3Qgcj1uZXcgRHMoJHMsMSx0LGUpO3IubGF5ZXJzPXRoaXMubGF5ZXJzLHIudXAuc2V0KDAsLTEsMCksci5sb29rQXQobmV3IGZuKC0xLDAsMCkpLHRoaXMuYWRkKHIpO2NvbnN0IHM9bmV3IERzKCRzLDEsdCxlKTtzLmxheWVycz10aGlzLmxheWVycyxzLnVwLnNldCgwLDAsMSkscy5sb29rQXQobmV3IGZuKDAsMSwwKSksdGhpcy5hZGQocyk7Y29uc3Qgbz1uZXcgRHMoJHMsMSx0LGUpO28ubGF5ZXJzPXRoaXMubGF5ZXJzLG8udXAuc2V0KDAsMCwtMSksby5sb29rQXQobmV3IGZuKDAsLTEsMCkpLHRoaXMuYWRkKG8pO2NvbnN0IGE9bmV3IERzKCRzLDEsdCxlKTthLmxheWVycz10aGlzLmxheWVycyxhLnVwLnNldCgwLC0xLDApLGEubG9va0F0KG5ldyBmbigwLDAsMSkpLHRoaXMuYWRkKGEpO2NvbnN0IGM9bmV3IERzKCRzLDEsdCxlKTtjLmxheWVycz10aGlzLmxheWVycyxjLnVwLnNldCgwLC0xLDApLGMubG9va0F0KG5ldyBmbigwLDAsLTEpKSx0aGlzLmFkZChjKSx0aGlzLnVwZGF0ZT1mdW5jdGlvbih0LGUpe251bGw9PT10aGlzLnBhcmVudCYmdGhpcy51cGRhdGVNYXRyaXhXb3JsZCgpO2NvbnN0IGg9dC54ci5lbmFibGVkLGw9dC5nZXRSZW5kZXJUYXJnZXQoKTt0LnhyLmVuYWJsZWQ9ITE7Y29uc3QgdT1pLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzO2kudGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHM9ITEsdC5zZXRSZW5kZXJUYXJnZXQoaSwwKSx0LnJlbmRlcihlLG4pLHQuc2V0UmVuZGVyVGFyZ2V0KGksMSksdC5yZW5kZXIoZSxyKSx0LnNldFJlbmRlclRhcmdldChpLDIpLHQucmVuZGVyKGUscyksdC5zZXRSZW5kZXJUYXJnZXQoaSwzKSx0LnJlbmRlcihlLG8pLHQuc2V0UmVuZGVyVGFyZ2V0KGksNCksdC5yZW5kZXIoZSxhKSxpLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzPXUsdC5zZXRSZW5kZXJUYXJnZXQoaSw1KSx0LnJlbmRlcihlLGMpLHQuc2V0UmVuZGVyVGFyZ2V0KGwpLHQueHIuZW5hYmxlZD1ofX1mdW5jdGlvbiB6cyh0LGUsaSxuLHIscyxvLGEsYyxoKXt0PXZvaWQgMCE9PXQ/dDpbXSxlPXZvaWQgMCE9PWU/ZTozMDEsbz12b2lkIDAhPT1vP286a2ksaG4uY2FsbCh0aGlzLHQsZSxpLG4scixzLG8sYSxjLGgpLHRoaXMuZmxpcFk9ITEsdGhpcy5fbmVlZHNGbGlwRW52TWFwPSEwfWtzLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHByLnByb3RvdHlwZSksa3MucHJvdG90eXBlLmNvbnN0cnVjdG9yPWtzLHpzLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGhuLnByb3RvdHlwZSksenMucHJvdG90eXBlLmNvbnN0cnVjdG9yPXpzLHpzLnByb3RvdHlwZS5pc0N1YmVUZXh0dXJlPSEwLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh6cy5wcm90b3R5cGUsXCJpbWFnZXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW1hZ2V9LHNldDpmdW5jdGlvbih0KXt0aGlzLmltYWdlPXR9fSk7Y2xhc3MgRnMgZXh0ZW5kcyBkbntjb25zdHJ1Y3Rvcih0LGUsaSl7TnVtYmVyLmlzSW50ZWdlcihlKSYmKGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMQ3ViZVJlbmRlclRhcmdldDogY29uc3RydWN0b3Igc2lnbmF0dXJlIGlzIG5vdyBXZWJHTEN1YmVSZW5kZXJUYXJnZXQoIHNpemUsIG9wdGlvbnMgKVwiKSxlPWkpLHN1cGVyKHQsdCxlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxcImlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0XCIse3ZhbHVlOiEwfSksZT1lfHx7fSx0aGlzLnRleHR1cmU9bmV3IHpzKHZvaWQgMCxlLm1hcHBpbmcsZS53cmFwUyxlLndyYXBULGUubWFnRmlsdGVyLGUubWluRmlsdGVyLGUuZm9ybWF0LGUudHlwZSxlLmFuaXNvdHJvcHksZS5lbmNvZGluZyksdGhpcy50ZXh0dXJlLl9uZWVkc0ZsaXBFbnZNYXA9ITF9ZnJvbUVxdWlyZWN0YW5ndWxhclRleHR1cmUodCxlKXt0aGlzLnRleHR1cmUudHlwZT1lLnR5cGUsdGhpcy50ZXh0dXJlLmZvcm1hdD16aSx0aGlzLnRleHR1cmUuZW5jb2Rpbmc9ZS5lbmNvZGluZyx0aGlzLnRleHR1cmUuZ2VuZXJhdGVNaXBtYXBzPWUuZ2VuZXJhdGVNaXBtYXBzLHRoaXMudGV4dHVyZS5taW5GaWx0ZXI9ZS5taW5GaWx0ZXIsdGhpcy50ZXh0dXJlLm1hZ0ZpbHRlcj1lLm1hZ0ZpbHRlcjtjb25zdCBpPXt1bmlmb3Jtczp7dEVxdWlyZWN0Ont2YWx1ZTpudWxsfX0sdmVydGV4U2hhZGVyOlwiXFxuXFxuXFx0XFx0XFx0XFx0dmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcXG5cXG5cXHRcXHRcXHRcXHR2ZWMzIHRyYW5zZm9ybURpcmVjdGlvbiggaW4gdmVjMyBkaXIsIGluIG1hdDQgbWF0cml4ICkge1xcblxcblxcdFxcdFxcdFxcdFxcdHJldHVybiBub3JtYWxpemUoICggbWF0cml4ICogdmVjNCggZGlyLCAwLjAgKSApLnh5eiApO1xcblxcblxcdFxcdFxcdFxcdH1cXG5cXG5cXHRcXHRcXHRcXHR2b2lkIG1haW4oKSB7XFxuXFxuXFx0XFx0XFx0XFx0XFx0dldvcmxkRGlyZWN0aW9uID0gdHJhbnNmb3JtRGlyZWN0aW9uKCBwb3NpdGlvbiwgbW9kZWxNYXRyaXggKTtcXG5cXG5cXHRcXHRcXHRcXHRcXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdFxcdFxcdFxcdFxcdCNpbmNsdWRlIDxwcm9qZWN0X3ZlcnRleD5cXG5cXG5cXHRcXHRcXHRcXHR9XFxuXFx0XFx0XFx0XCIsZnJhZ21lbnRTaGFkZXI6XCJcXG5cXG5cXHRcXHRcXHRcXHR1bmlmb3JtIHNhbXBsZXIyRCB0RXF1aXJlY3Q7XFxuXFxuXFx0XFx0XFx0XFx0dmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcXG5cXG5cXHRcXHRcXHRcXHQjaW5jbHVkZSA8Y29tbW9uPlxcblxcblxcdFxcdFxcdFxcdHZvaWQgbWFpbigpIHtcXG5cXG5cXHRcXHRcXHRcXHRcXHR2ZWMzIGRpcmVjdGlvbiA9IG5vcm1hbGl6ZSggdldvcmxkRGlyZWN0aW9uICk7XFxuXFxuXFx0XFx0XFx0XFx0XFx0dmVjMiBzYW1wbGVVViA9IGVxdWlyZWN0VXYoIGRpcmVjdGlvbiApO1xcblxcblxcdFxcdFxcdFxcdFxcdGdsX0ZyYWdDb2xvciA9IHRleHR1cmUyRCggdEVxdWlyZWN0LCBzYW1wbGVVViApO1xcblxcblxcdFxcdFxcdFxcdH1cXG5cXHRcXHRcXHRcIn0sbj1uZXcgQXMoNSw1LDUpLHI9bmV3IE9zKHtuYW1lOlwiQ3ViZW1hcEZyb21FcXVpcmVjdFwiLHVuaWZvcm1zOlBzKGkudW5pZm9ybXMpLHZlcnRleFNoYWRlcjppLnZlcnRleFNoYWRlcixmcmFnbWVudFNoYWRlcjppLmZyYWdtZW50U2hhZGVyLHNpZGU6MSxibGVuZGluZzowfSk7ci51bmlmb3Jtcy50RXF1aXJlY3QudmFsdWU9ZTtjb25zdCBzPW5ldyBFcyhuLHIpLG89ZS5taW5GaWx0ZXI7ZS5taW5GaWx0ZXI9PT1QaSYmKGUubWluRmlsdGVyPUFpKTtyZXR1cm4gbmV3IGtzKDEsMTAsdGhpcykudXBkYXRlKHQscyksZS5taW5GaWx0ZXI9byxzLmdlb21ldHJ5LmRpc3Bvc2UoKSxzLm1hdGVyaWFsLmRpc3Bvc2UoKSx0aGlzfWNsZWFyKHQsZSxpLG4pe2NvbnN0IHI9dC5nZXRSZW5kZXJUYXJnZXQoKTtmb3IobGV0IHI9MDtyPDY7cisrKXQuc2V0UmVuZGVyVGFyZ2V0KHRoaXMsciksdC5jbGVhcihlLGksbik7dC5zZXRSZW5kZXJUYXJnZXQocil9fWZ1bmN0aW9uIEJzKHQsZSxpLG4scixzLG8sYSxjLGgsbCx1KXtobi5jYWxsKHRoaXMsbnVsbCxzLG8sYSxjLGgsbixyLGwsdSksdGhpcy5pbWFnZT17ZGF0YTp0fHxudWxsLHdpZHRoOmV8fDEsaGVpZ2h0Oml8fDF9LHRoaXMubWFnRmlsdGVyPXZvaWQgMCE9PWM/YzpJaSx0aGlzLm1pbkZpbHRlcj12b2lkIDAhPT1oP2g6SWksdGhpcy5nZW5lcmF0ZU1pcG1hcHM9ITEsdGhpcy5mbGlwWT0hMSx0aGlzLnVucGFja0FsaWdubWVudD0xLHRoaXMubmVlZHNVcGRhdGU9ITB9QnMucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoaG4ucHJvdG90eXBlKSxCcy5wcm90b3R5cGUuY29uc3RydWN0b3I9QnMsQnMucHJvdG90eXBlLmlzRGF0YVRleHR1cmU9ITA7Y29uc3QganM9bmV3IE9uLEhzPW5ldyBmbjtjbGFzcyBVc3tjb25zdHJ1Y3Rvcih0LGUsaSxuLHIscyl7dGhpcy5wbGFuZXM9W3ZvaWQgMCE9PXQ/dDpuZXcgX3Isdm9pZCAwIT09ZT9lOm5ldyBfcix2b2lkIDAhPT1pP2k6bmV3IF9yLHZvaWQgMCE9PW4/bjpuZXcgX3Isdm9pZCAwIT09cj9yOm5ldyBfcix2b2lkIDAhPT1zP3M6bmV3IF9yXX1zZXQodCxlLGksbixyLHMpe2NvbnN0IG89dGhpcy5wbGFuZXM7cmV0dXJuIG9bMF0uY29weSh0KSxvWzFdLmNvcHkoZSksb1syXS5jb3B5KGkpLG9bM10uY29weShuKSxvWzRdLmNvcHkociksb1s1XS5jb3B5KHMpLHRoaXN9Y2xvbmUoKXtyZXR1cm4obmV3IHRoaXMuY29uc3RydWN0b3IpLmNvcHkodGhpcyl9Y29weSh0KXtjb25zdCBlPXRoaXMucGxhbmVzO2ZvcihsZXQgaT0wO2k8NjtpKyspZVtpXS5jb3B5KHQucGxhbmVzW2ldKTtyZXR1cm4gdGhpc31zZXRGcm9tUHJvamVjdGlvbk1hdHJpeCh0KXtjb25zdCBlPXRoaXMucGxhbmVzLGk9dC5lbGVtZW50cyxuPWlbMF0scj1pWzFdLHM9aVsyXSxvPWlbM10sYT1pWzRdLGM9aVs1XSxoPWlbNl0sbD1pWzddLHU9aVs4XSxkPWlbOV0scD1pWzEwXSxmPWlbMTFdLG09aVsxMl0sZz1pWzEzXSxfPWlbMTRdLHY9aVsxNV07cmV0dXJuIGVbMF0uc2V0Q29tcG9uZW50cyhvLW4sbC1hLGYtdSx2LW0pLm5vcm1hbGl6ZSgpLGVbMV0uc2V0Q29tcG9uZW50cyhvK24sbCthLGYrdSx2K20pLm5vcm1hbGl6ZSgpLGVbMl0uc2V0Q29tcG9uZW50cyhvK3IsbCtjLGYrZCx2K2cpLm5vcm1hbGl6ZSgpLGVbM10uc2V0Q29tcG9uZW50cyhvLXIsbC1jLGYtZCx2LWcpLm5vcm1hbGl6ZSgpLGVbNF0uc2V0Q29tcG9uZW50cyhvLXMsbC1oLGYtcCx2LV8pLm5vcm1hbGl6ZSgpLGVbNV0uc2V0Q29tcG9uZW50cyhvK3MsbCtoLGYrcCx2K18pLm5vcm1hbGl6ZSgpLHRoaXN9aW50ZXJzZWN0c09iamVjdCh0KXtjb25zdCBlPXQuZ2VvbWV0cnk7cmV0dXJuIG51bGw9PT1lLmJvdW5kaW5nU3BoZXJlJiZlLmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpLGpzLmNvcHkoZS5ib3VuZGluZ1NwaGVyZSkuYXBwbHlNYXRyaXg0KHQubWF0cml4V29ybGQpLHRoaXMuaW50ZXJzZWN0c1NwaGVyZShqcyl9aW50ZXJzZWN0c1Nwcml0ZSh0KXtyZXR1cm4ganMuY2VudGVyLnNldCgwLDAsMCksanMucmFkaXVzPS43MDcxMDY3ODExODY1NDc2LGpzLmFwcGx5TWF0cml4NCh0Lm1hdHJpeFdvcmxkKSx0aGlzLmludGVyc2VjdHNTcGhlcmUoanMpfWludGVyc2VjdHNTcGhlcmUodCl7Y29uc3QgZT10aGlzLnBsYW5lcyxpPXQuY2VudGVyLG49LXQucmFkaXVzO2ZvcihsZXQgdD0wO3Q8Njt0Kyspe2lmKGVbdF0uZGlzdGFuY2VUb1BvaW50KGkpPG4pcmV0dXJuITF9cmV0dXJuITB9aW50ZXJzZWN0c0JveCh0KXtjb25zdCBlPXRoaXMucGxhbmVzO2ZvcihsZXQgaT0wO2k8NjtpKyspe2NvbnN0IG49ZVtpXTtpZihIcy54PW4ubm9ybWFsLng+MD90Lm1heC54OnQubWluLngsSHMueT1uLm5vcm1hbC55PjA/dC5tYXgueTp0Lm1pbi55LEhzLno9bi5ub3JtYWwuej4wP3QubWF4Lno6dC5taW4ueixuLmRpc3RhbmNlVG9Qb2ludChIcyk8MClyZXR1cm4hMX1yZXR1cm4hMH1jb250YWluc1BvaW50KHQpe2NvbnN0IGU9dGhpcy5wbGFuZXM7Zm9yKGxldCBpPTA7aTw2O2krKylpZihlW2ldLmRpc3RhbmNlVG9Qb2ludCh0KTwwKXJldHVybiExO3JldHVybiEwfX1mdW5jdGlvbiBWcygpe2xldCB0PW51bGwsZT0hMSxpPW51bGwsbj1udWxsO2Z1bmN0aW9uIHIoZSxzKXtpKGUscyksbj10LnJlcXVlc3RBbmltYXRpb25GcmFtZShyKX1yZXR1cm57c3RhcnQ6ZnVuY3Rpb24oKXshMCE9PWUmJm51bGwhPT1pJiYobj10LnJlcXVlc3RBbmltYXRpb25GcmFtZShyKSxlPSEwKX0sc3RvcDpmdW5jdGlvbigpe3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUobiksZT0hMX0sc2V0QW5pbWF0aW9uTG9vcDpmdW5jdGlvbih0KXtpPXR9LHNldENvbnRleHQ6ZnVuY3Rpb24oZSl7dD1lfX19ZnVuY3Rpb24gR3ModCxlKXtjb25zdCBpPWUuaXNXZWJHTDIsbj1uZXcgV2Vha01hcDtyZXR1cm57Z2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0LmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUmJih0PXQuZGF0YSksbi5nZXQodCl9LHJlbW92ZTpmdW5jdGlvbihlKXtlLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUmJihlPWUuZGF0YSk7Y29uc3QgaT1uLmdldChlKTtpJiYodC5kZWxldGVCdWZmZXIoaS5idWZmZXIpLG4uZGVsZXRlKGUpKX0sdXBkYXRlOmZ1bmN0aW9uKGUscil7aWYoZS5pc0dMQnVmZmVyQXR0cmlidXRlKXtjb25zdCB0PW4uZ2V0KGUpO3JldHVybiB2b2lkKCghdHx8dC52ZXJzaW9uPGUudmVyc2lvbikmJm4uc2V0KGUse2J1ZmZlcjplLmJ1ZmZlcix0eXBlOmUudHlwZSxieXRlc1BlckVsZW1lbnQ6ZS5lbGVtZW50U2l6ZSx2ZXJzaW9uOmUudmVyc2lvbn0pKX1lLmlzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGUmJihlPWUuZGF0YSk7Y29uc3Qgcz1uLmdldChlKTt2b2lkIDA9PT1zP24uc2V0KGUsZnVuY3Rpb24oZSxuKXtjb25zdCByPWUuYXJyYXkscz1lLnVzYWdlLG89dC5jcmVhdGVCdWZmZXIoKTt0LmJpbmRCdWZmZXIobixvKSx0LmJ1ZmZlckRhdGEobixyLHMpLGUub25VcGxvYWRDYWxsYmFjaygpO2xldCBhPTUxMjY7cmV0dXJuIHIgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk/YT01MTI2OnIgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXk/Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xBdHRyaWJ1dGVzOiBVbnN1cHBvcnRlZCBkYXRhIGJ1ZmZlciBmb3JtYXQ6IEZsb2F0NjRBcnJheS5cIik6ciBpbnN0YW5jZW9mIFVpbnQxNkFycmF5P2UuaXNGbG9hdDE2QnVmZmVyQXR0cmlidXRlP2k/YT01MTMxOmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMQXR0cmlidXRlczogVXNhZ2Ugb2YgRmxvYXQxNkJ1ZmZlckF0dHJpYnV0ZSByZXF1aXJlcyBXZWJHTDIuXCIpOmE9NTEyMzpyIGluc3RhbmNlb2YgSW50MTZBcnJheT9hPTUxMjI6ciBpbnN0YW5jZW9mIFVpbnQzMkFycmF5P2E9NTEyNTpyIGluc3RhbmNlb2YgSW50MzJBcnJheT9hPTUxMjQ6ciBpbnN0YW5jZW9mIEludDhBcnJheT9hPTUxMjA6ciBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkmJihhPTUxMjEpLHtidWZmZXI6byx0eXBlOmEsYnl0ZXNQZXJFbGVtZW50OnIuQllURVNfUEVSX0VMRU1FTlQsdmVyc2lvbjplLnZlcnNpb259fShlLHIpKTpzLnZlcnNpb248ZS52ZXJzaW9uJiYoIWZ1bmN0aW9uKGUsbixyKXtjb25zdCBzPW4uYXJyYXksbz1uLnVwZGF0ZVJhbmdlO3QuYmluZEJ1ZmZlcihyLGUpLC0xPT09by5jb3VudD90LmJ1ZmZlclN1YkRhdGEociwwLHMpOihpP3QuYnVmZmVyU3ViRGF0YShyLG8ub2Zmc2V0KnMuQllURVNfUEVSX0VMRU1FTlQscyxvLm9mZnNldCxvLmNvdW50KTp0LmJ1ZmZlclN1YkRhdGEocixvLm9mZnNldCpzLkJZVEVTX1BFUl9FTEVNRU5ULHMuc3ViYXJyYXkoby5vZmZzZXQsby5vZmZzZXQrby5jb3VudCkpLG8uY291bnQ9LTEpfShzLmJ1ZmZlcixlLHIpLHMudmVyc2lvbj1lLnZlcnNpb24pfX19Y2xhc3MgcXMgZXh0ZW5kcyBoc3tjb25zdHJ1Y3Rvcih0PTEsZT0xLGk9MSxuPTEpe3N1cGVyKCksdGhpcy50eXBlPVwiUGxhbmVHZW9tZXRyeVwiLHRoaXMucGFyYW1ldGVycz17d2lkdGg6dCxoZWlnaHQ6ZSx3aWR0aFNlZ21lbnRzOmksaGVpZ2h0U2VnbWVudHM6bn07Y29uc3Qgcj10LzIscz1lLzIsbz1NYXRoLmZsb29yKGkpLGE9TWF0aC5mbG9vcihuKSxjPW8rMSxoPWErMSxsPXQvbyx1PWUvYSxkPVtdLHA9W10sZj1bXSxtPVtdO2ZvcihsZXQgdD0wO3Q8aDt0Kyspe2NvbnN0IGU9dCp1LXM7Zm9yKGxldCBpPTA7aTxjO2krKyl7Y29uc3Qgbj1pKmwtcjtwLnB1c2gobiwtZSwwKSxmLnB1c2goMCwwLDEpLG0ucHVzaChpL28pLG0ucHVzaCgxLXQvYSl9fWZvcihsZXQgdD0wO3Q8YTt0KyspZm9yKGxldCBlPTA7ZTxvO2UrKyl7Y29uc3QgaT1lK2MqdCxuPWUrYyoodCsxKSxyPWUrMStjKih0KzEpLHM9ZSsxK2MqdDtkLnB1c2goaSxuLHMpLGQucHVzaChuLHIscyl9dGhpcy5zZXRJbmRleChkKSx0aGlzLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEpyKHAsMykpLHRoaXMuc2V0QXR0cmlidXRlKFwibm9ybWFsXCIsbmV3IEpyKGYsMykpLHRoaXMuc2V0QXR0cmlidXRlKFwidXZcIixuZXcgSnIobSwyKSl9fWNvbnN0IFdzPXthbHBoYW1hcF9mcmFnbWVudDpcIiNpZmRlZiBVU0VfQUxQSEFNQVBcXG5cXHRkaWZmdXNlQ29sb3IuYSAqPSB0ZXh0dXJlMkQoIGFscGhhTWFwLCB2VXYgKS5nO1xcbiNlbmRpZlwiLGFscGhhbWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0FMUEhBTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgYWxwaGFNYXA7XFxuI2VuZGlmXCIsYWxwaGF0ZXN0X2ZyYWdtZW50OlwiI2lmZGVmIEFMUEhBVEVTVFxcblxcdGlmICggZGlmZnVzZUNvbG9yLmEgPCBBTFBIQVRFU1QgKSBkaXNjYXJkO1xcbiNlbmRpZlwiLGFvbWFwX2ZyYWdtZW50OlwiI2lmZGVmIFVTRV9BT01BUFxcblxcdGZsb2F0IGFtYmllbnRPY2NsdXNpb24gPSAoIHRleHR1cmUyRCggYW9NYXAsIHZVdjIgKS5yIC0gMS4wICkgKiBhb01hcEludGVuc2l0eSArIDEuMDtcXG5cXHRyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKj0gYW1iaWVudE9jY2x1c2lvbjtcXG5cXHQjaWYgZGVmaW5lZCggVVNFX0VOVk1BUCApICYmIGRlZmluZWQoIFNUQU5EQVJEIClcXG5cXHRcXHRmbG9hdCBkb3ROViA9IHNhdHVyYXRlKCBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZ2VvbWV0cnkudmlld0RpciApICk7XFxuXFx0XFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3RTcGVjdWxhciAqPSBjb21wdXRlU3BlY3VsYXJPY2NsdXNpb24oIGRvdE5WLCBhbWJpZW50T2NjbHVzaW9uLCBtYXRlcmlhbC5zcGVjdWxhclJvdWdobmVzcyApO1xcblxcdCNlbmRpZlxcbiNlbmRpZlwiLGFvbWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0FPTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgYW9NYXA7XFxuXFx0dW5pZm9ybSBmbG9hdCBhb01hcEludGVuc2l0eTtcXG4jZW5kaWZcIixiZWdpbl92ZXJ0ZXg6XCJ2ZWMzIHRyYW5zZm9ybWVkID0gdmVjMyggcG9zaXRpb24gKTtcIixiZWdpbm5vcm1hbF92ZXJ0ZXg6XCJ2ZWMzIG9iamVjdE5vcm1hbCA9IHZlYzMoIG5vcm1hbCApO1xcbiNpZmRlZiBVU0VfVEFOR0VOVFxcblxcdHZlYzMgb2JqZWN0VGFuZ2VudCA9IHZlYzMoIHRhbmdlbnQueHl6ICk7XFxuI2VuZGlmXCIsYnNkZnM6XCJ2ZWMyIGludGVncmF0ZVNwZWN1bGFyQlJERiggY29uc3QgaW4gZmxvYXQgZG90TlYsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcyApIHtcXG5cXHRjb25zdCB2ZWM0IGMwID0gdmVjNCggLSAxLCAtIDAuMDI3NSwgLSAwLjU3MiwgMC4wMjIgKTtcXG5cXHRjb25zdCB2ZWM0IGMxID0gdmVjNCggMSwgMC4wNDI1LCAxLjA0LCAtIDAuMDQgKTtcXG5cXHR2ZWM0IHIgPSByb3VnaG5lc3MgKiBjMCArIGMxO1xcblxcdGZsb2F0IGEwMDQgPSBtaW4oIHIueCAqIHIueCwgZXhwMiggLSA5LjI4ICogZG90TlYgKSApICogci54ICsgci55O1xcblxcdHJldHVybiB2ZWMyKCAtMS4wNCwgMS4wNCApICogYTAwNCArIHIuenc7XFxufVxcbmZsb2F0IHB1bmN0dWFsTGlnaHRJbnRlbnNpdHlUb0lycmFkaWFuY2VGYWN0b3IoIGNvbnN0IGluIGZsb2F0IGxpZ2h0RGlzdGFuY2UsIGNvbnN0IGluIGZsb2F0IGN1dG9mZkRpc3RhbmNlLCBjb25zdCBpbiBmbG9hdCBkZWNheUV4cG9uZW50ICkge1xcbiNpZiBkZWZpbmVkICggUEhZU0lDQUxMWV9DT1JSRUNUX0xJR0hUUyApXFxuXFx0ZmxvYXQgZGlzdGFuY2VGYWxsb2ZmID0gMS4wIC8gbWF4KCBwb3coIGxpZ2h0RGlzdGFuY2UsIGRlY2F5RXhwb25lbnQgKSwgMC4wMSApO1xcblxcdGlmKCBjdXRvZmZEaXN0YW5jZSA+IDAuMCApIHtcXG5cXHRcXHRkaXN0YW5jZUZhbGxvZmYgKj0gcG93Miggc2F0dXJhdGUoIDEuMCAtIHBvdzQoIGxpZ2h0RGlzdGFuY2UgLyBjdXRvZmZEaXN0YW5jZSApICkgKTtcXG5cXHR9XFxuXFx0cmV0dXJuIGRpc3RhbmNlRmFsbG9mZjtcXG4jZWxzZVxcblxcdGlmKCBjdXRvZmZEaXN0YW5jZSA+IDAuMCAmJiBkZWNheUV4cG9uZW50ID4gMC4wICkge1xcblxcdFxcdHJldHVybiBwb3coIHNhdHVyYXRlKCAtbGlnaHREaXN0YW5jZSAvIGN1dG9mZkRpc3RhbmNlICsgMS4wICksIGRlY2F5RXhwb25lbnQgKTtcXG5cXHR9XFxuXFx0cmV0dXJuIDEuMDtcXG4jZW5kaWZcXG59XFxudmVjMyBCUkRGX0RpZmZ1c2VfTGFtYmVydCggY29uc3QgaW4gdmVjMyBkaWZmdXNlQ29sb3IgKSB7XFxuXFx0cmV0dXJuIFJFQ0lQUk9DQUxfUEkgKiBkaWZmdXNlQ29sb3I7XFxufVxcbnZlYzMgRl9TY2hsaWNrKCBjb25zdCBpbiB2ZWMzIHNwZWN1bGFyQ29sb3IsIGNvbnN0IGluIGZsb2F0IGRvdExIICkge1xcblxcdGZsb2F0IGZyZXNuZWwgPSBleHAyKCAoIC01LjU1NDczICogZG90TEggLSA2Ljk4MzE2ICkgKiBkb3RMSCApO1xcblxcdHJldHVybiAoIDEuMCAtIHNwZWN1bGFyQ29sb3IgKSAqIGZyZXNuZWwgKyBzcGVjdWxhckNvbG9yO1xcbn1cXG52ZWMzIEZfU2NobGlja19Sb3VnaG5lc3NEZXBlbmRlbnQoIGNvbnN0IGluIHZlYzMgRjAsIGNvbnN0IGluIGZsb2F0IGRvdE5WLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MgKSB7XFxuXFx0ZmxvYXQgZnJlc25lbCA9IGV4cDIoICggLTUuNTU0NzMgKiBkb3ROViAtIDYuOTgzMTYgKSAqIGRvdE5WICk7XFxuXFx0dmVjMyBGciA9IG1heCggdmVjMyggMS4wIC0gcm91Z2huZXNzICksIEYwICkgLSBGMDtcXG5cXHRyZXR1cm4gRnIgKiBmcmVzbmVsICsgRjA7XFxufVxcbmZsb2F0IEdfR0dYX1NtaXRoKCBjb25zdCBpbiBmbG9hdCBhbHBoYSwgY29uc3QgaW4gZmxvYXQgZG90TkwsIGNvbnN0IGluIGZsb2F0IGRvdE5WICkge1xcblxcdGZsb2F0IGEyID0gcG93MiggYWxwaGEgKTtcXG5cXHRmbG9hdCBnbCA9IGRvdE5MICsgc3FydCggYTIgKyAoIDEuMCAtIGEyICkgKiBwb3cyKCBkb3ROTCApICk7XFxuXFx0ZmxvYXQgZ3YgPSBkb3ROViArIHNxcnQoIGEyICsgKCAxLjAgLSBhMiApICogcG93MiggZG90TlYgKSApO1xcblxcdHJldHVybiAxLjAgLyAoIGdsICogZ3YgKTtcXG59XFxuZmxvYXQgR19HR1hfU21pdGhDb3JyZWxhdGVkKCBjb25zdCBpbiBmbG9hdCBhbHBoYSwgY29uc3QgaW4gZmxvYXQgZG90TkwsIGNvbnN0IGluIGZsb2F0IGRvdE5WICkge1xcblxcdGZsb2F0IGEyID0gcG93MiggYWxwaGEgKTtcXG5cXHRmbG9hdCBndiA9IGRvdE5MICogc3FydCggYTIgKyAoIDEuMCAtIGEyICkgKiBwb3cyKCBkb3ROViApICk7XFxuXFx0ZmxvYXQgZ2wgPSBkb3ROViAqIHNxcnQoIGEyICsgKCAxLjAgLSBhMiApICogcG93MiggZG90TkwgKSApO1xcblxcdHJldHVybiAwLjUgLyBtYXgoIGd2ICsgZ2wsIEVQU0lMT04gKTtcXG59XFxuZmxvYXQgRF9HR1goIGNvbnN0IGluIGZsb2F0IGFscGhhLCBjb25zdCBpbiBmbG9hdCBkb3ROSCApIHtcXG5cXHRmbG9hdCBhMiA9IHBvdzIoIGFscGhhICk7XFxuXFx0ZmxvYXQgZGVub20gPSBwb3cyKCBkb3ROSCApICogKCBhMiAtIDEuMCApICsgMS4wO1xcblxcdHJldHVybiBSRUNJUFJPQ0FMX1BJICogYTIgLyBwb3cyKCBkZW5vbSApO1xcbn1cXG52ZWMzIEJSREZfU3BlY3VsYXJfR0dYKCBjb25zdCBpbiBJbmNpZGVudExpZ2h0IGluY2lkZW50TGlnaHQsIGNvbnN0IGluIHZlYzMgdmlld0RpciwgY29uc3QgaW4gdmVjMyBub3JtYWwsIGNvbnN0IGluIHZlYzMgc3BlY3VsYXJDb2xvciwgY29uc3QgaW4gZmxvYXQgcm91Z2huZXNzICkge1xcblxcdGZsb2F0IGFscGhhID0gcG93Miggcm91Z2huZXNzICk7XFxuXFx0dmVjMyBoYWxmRGlyID0gbm9ybWFsaXplKCBpbmNpZGVudExpZ2h0LmRpcmVjdGlvbiArIHZpZXdEaXIgKTtcXG5cXHRmbG9hdCBkb3ROTCA9IHNhdHVyYXRlKCBkb3QoIG5vcm1hbCwgaW5jaWRlbnRMaWdodC5kaXJlY3Rpb24gKSApO1xcblxcdGZsb2F0IGRvdE5WID0gc2F0dXJhdGUoIGRvdCggbm9ybWFsLCB2aWV3RGlyICkgKTtcXG5cXHRmbG9hdCBkb3ROSCA9IHNhdHVyYXRlKCBkb3QoIG5vcm1hbCwgaGFsZkRpciApICk7XFxuXFx0ZmxvYXQgZG90TEggPSBzYXR1cmF0ZSggZG90KCBpbmNpZGVudExpZ2h0LmRpcmVjdGlvbiwgaGFsZkRpciApICk7XFxuXFx0dmVjMyBGID0gRl9TY2hsaWNrKCBzcGVjdWxhckNvbG9yLCBkb3RMSCApO1xcblxcdGZsb2F0IEcgPSBHX0dHWF9TbWl0aENvcnJlbGF0ZWQoIGFscGhhLCBkb3ROTCwgZG90TlYgKTtcXG5cXHRmbG9hdCBEID0gRF9HR1goIGFscGhhLCBkb3ROSCApO1xcblxcdHJldHVybiBGICogKCBHICogRCApO1xcbn1cXG52ZWMyIExUQ19VdiggY29uc3QgaW4gdmVjMyBOLCBjb25zdCBpbiB2ZWMzIFYsIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcyApIHtcXG5cXHRjb25zdCBmbG9hdCBMVVRfU0laRSA9IDY0LjA7XFxuXFx0Y29uc3QgZmxvYXQgTFVUX1NDQUxFID0gKCBMVVRfU0laRSAtIDEuMCApIC8gTFVUX1NJWkU7XFxuXFx0Y29uc3QgZmxvYXQgTFVUX0JJQVMgPSAwLjUgLyBMVVRfU0laRTtcXG5cXHRmbG9hdCBkb3ROViA9IHNhdHVyYXRlKCBkb3QoIE4sIFYgKSApO1xcblxcdHZlYzIgdXYgPSB2ZWMyKCByb3VnaG5lc3MsIHNxcnQoIDEuMCAtIGRvdE5WICkgKTtcXG5cXHR1diA9IHV2ICogTFVUX1NDQUxFICsgTFVUX0JJQVM7XFxuXFx0cmV0dXJuIHV2O1xcbn1cXG5mbG9hdCBMVENfQ2xpcHBlZFNwaGVyZUZvcm1GYWN0b3IoIGNvbnN0IGluIHZlYzMgZiApIHtcXG5cXHRmbG9hdCBsID0gbGVuZ3RoKCBmICk7XFxuXFx0cmV0dXJuIG1heCggKCBsICogbCArIGYueiApIC8gKCBsICsgMS4wICksIDAuMCApO1xcbn1cXG52ZWMzIExUQ19FZGdlVmVjdG9yRm9ybUZhY3RvciggY29uc3QgaW4gdmVjMyB2MSwgY29uc3QgaW4gdmVjMyB2MiApIHtcXG5cXHRmbG9hdCB4ID0gZG90KCB2MSwgdjIgKTtcXG5cXHRmbG9hdCB5ID0gYWJzKCB4ICk7XFxuXFx0ZmxvYXQgYSA9IDAuODU0Mzk4NSArICggMC40OTY1MTU1ICsgMC4wMTQ1MjA2ICogeSApICogeTtcXG5cXHRmbG9hdCBiID0gMy40MTc1OTQwICsgKCA0LjE2MTY3MjQgKyB5ICkgKiB5O1xcblxcdGZsb2F0IHYgPSBhIC8gYjtcXG5cXHRmbG9hdCB0aGV0YV9zaW50aGV0YSA9ICggeCA+IDAuMCApID8gdiA6IDAuNSAqIGludmVyc2VzcXJ0KCBtYXgoIDEuMCAtIHggKiB4LCAxZS03ICkgKSAtIHY7XFxuXFx0cmV0dXJuIGNyb3NzKCB2MSwgdjIgKSAqIHRoZXRhX3NpbnRoZXRhO1xcbn1cXG52ZWMzIExUQ19FdmFsdWF0ZSggY29uc3QgaW4gdmVjMyBOLCBjb25zdCBpbiB2ZWMzIFYsIGNvbnN0IGluIHZlYzMgUCwgY29uc3QgaW4gbWF0MyBtSW52LCBjb25zdCBpbiB2ZWMzIHJlY3RDb29yZHNbIDQgXSApIHtcXG5cXHR2ZWMzIHYxID0gcmVjdENvb3Jkc1sgMSBdIC0gcmVjdENvb3Jkc1sgMCBdO1xcblxcdHZlYzMgdjIgPSByZWN0Q29vcmRzWyAzIF0gLSByZWN0Q29vcmRzWyAwIF07XFxuXFx0dmVjMyBsaWdodE5vcm1hbCA9IGNyb3NzKCB2MSwgdjIgKTtcXG5cXHRpZiggZG90KCBsaWdodE5vcm1hbCwgUCAtIHJlY3RDb29yZHNbIDAgXSApIDwgMC4wICkgcmV0dXJuIHZlYzMoIDAuMCApO1xcblxcdHZlYzMgVDEsIFQyO1xcblxcdFQxID0gbm9ybWFsaXplKCBWIC0gTiAqIGRvdCggViwgTiApICk7XFxuXFx0VDIgPSAtIGNyb3NzKCBOLCBUMSApO1xcblxcdG1hdDMgbWF0ID0gbUludiAqIHRyYW5zcG9zZU1hdDMoIG1hdDMoIFQxLCBUMiwgTiApICk7XFxuXFx0dmVjMyBjb29yZHNbIDQgXTtcXG5cXHRjb29yZHNbIDAgXSA9IG1hdCAqICggcmVjdENvb3Jkc1sgMCBdIC0gUCApO1xcblxcdGNvb3Jkc1sgMSBdID0gbWF0ICogKCByZWN0Q29vcmRzWyAxIF0gLSBQICk7XFxuXFx0Y29vcmRzWyAyIF0gPSBtYXQgKiAoIHJlY3RDb29yZHNbIDIgXSAtIFAgKTtcXG5cXHRjb29yZHNbIDMgXSA9IG1hdCAqICggcmVjdENvb3Jkc1sgMyBdIC0gUCApO1xcblxcdGNvb3Jkc1sgMCBdID0gbm9ybWFsaXplKCBjb29yZHNbIDAgXSApO1xcblxcdGNvb3Jkc1sgMSBdID0gbm9ybWFsaXplKCBjb29yZHNbIDEgXSApO1xcblxcdGNvb3Jkc1sgMiBdID0gbm9ybWFsaXplKCBjb29yZHNbIDIgXSApO1xcblxcdGNvb3Jkc1sgMyBdID0gbm9ybWFsaXplKCBjb29yZHNbIDMgXSApO1xcblxcdHZlYzMgdmVjdG9yRm9ybUZhY3RvciA9IHZlYzMoIDAuMCApO1xcblxcdHZlY3RvckZvcm1GYWN0b3IgKz0gTFRDX0VkZ2VWZWN0b3JGb3JtRmFjdG9yKCBjb29yZHNbIDAgXSwgY29vcmRzWyAxIF0gKTtcXG5cXHR2ZWN0b3JGb3JtRmFjdG9yICs9IExUQ19FZGdlVmVjdG9yRm9ybUZhY3RvciggY29vcmRzWyAxIF0sIGNvb3Jkc1sgMiBdICk7XFxuXFx0dmVjdG9yRm9ybUZhY3RvciArPSBMVENfRWRnZVZlY3RvckZvcm1GYWN0b3IoIGNvb3Jkc1sgMiBdLCBjb29yZHNbIDMgXSApO1xcblxcdHZlY3RvckZvcm1GYWN0b3IgKz0gTFRDX0VkZ2VWZWN0b3JGb3JtRmFjdG9yKCBjb29yZHNbIDMgXSwgY29vcmRzWyAwIF0gKTtcXG5cXHRmbG9hdCByZXN1bHQgPSBMVENfQ2xpcHBlZFNwaGVyZUZvcm1GYWN0b3IoIHZlY3RvckZvcm1GYWN0b3IgKTtcXG5cXHRyZXR1cm4gdmVjMyggcmVzdWx0ICk7XFxufVxcbnZlYzMgQlJERl9TcGVjdWxhcl9HR1hfRW52aXJvbm1lbnQoIGNvbnN0IGluIHZlYzMgdmlld0RpciwgY29uc3QgaW4gdmVjMyBub3JtYWwsIGNvbnN0IGluIHZlYzMgc3BlY3VsYXJDb2xvciwgY29uc3QgaW4gZmxvYXQgcm91Z2huZXNzICkge1xcblxcdGZsb2F0IGRvdE5WID0gc2F0dXJhdGUoIGRvdCggbm9ybWFsLCB2aWV3RGlyICkgKTtcXG5cXHR2ZWMyIGJyZGYgPSBpbnRlZ3JhdGVTcGVjdWxhckJSREYoIGRvdE5WLCByb3VnaG5lc3MgKTtcXG5cXHRyZXR1cm4gc3BlY3VsYXJDb2xvciAqIGJyZGYueCArIGJyZGYueTtcXG59XFxudm9pZCBCUkRGX1NwZWN1bGFyX011bHRpc2NhdHRlcmluZ19FbnZpcm9ubWVudCggY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgY29uc3QgaW4gdmVjMyBzcGVjdWxhckNvbG9yLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MsIGlub3V0IHZlYzMgc2luZ2xlU2NhdHRlciwgaW5vdXQgdmVjMyBtdWx0aVNjYXR0ZXIgKSB7XFxuXFx0ZmxvYXQgZG90TlYgPSBzYXR1cmF0ZSggZG90KCBnZW9tZXRyeS5ub3JtYWwsIGdlb21ldHJ5LnZpZXdEaXIgKSApO1xcblxcdHZlYzMgRiA9IEZfU2NobGlja19Sb3VnaG5lc3NEZXBlbmRlbnQoIHNwZWN1bGFyQ29sb3IsIGRvdE5WLCByb3VnaG5lc3MgKTtcXG5cXHR2ZWMyIGJyZGYgPSBpbnRlZ3JhdGVTcGVjdWxhckJSREYoIGRvdE5WLCByb3VnaG5lc3MgKTtcXG5cXHR2ZWMzIEZzc0VzcyA9IEYgKiBicmRmLnggKyBicmRmLnk7XFxuXFx0ZmxvYXQgRXNzID0gYnJkZi54ICsgYnJkZi55O1xcblxcdGZsb2F0IEVtcyA9IDEuMCAtIEVzcztcXG5cXHR2ZWMzIEZhdmcgPSBzcGVjdWxhckNvbG9yICsgKCAxLjAgLSBzcGVjdWxhckNvbG9yICkgKiAwLjA0NzYxOTtcXHR2ZWMzIEZtcyA9IEZzc0VzcyAqIEZhdmcgLyAoIDEuMCAtIEVtcyAqIEZhdmcgKTtcXG5cXHRzaW5nbGVTY2F0dGVyICs9IEZzc0VzcztcXG5cXHRtdWx0aVNjYXR0ZXIgKz0gRm1zICogRW1zO1xcbn1cXG5mbG9hdCBHX0JsaW5uUGhvbmdfSW1wbGljaXQoICkge1xcblxcdHJldHVybiAwLjI1O1xcbn1cXG5mbG9hdCBEX0JsaW5uUGhvbmcoIGNvbnN0IGluIGZsb2F0IHNoaW5pbmVzcywgY29uc3QgaW4gZmxvYXQgZG90TkggKSB7XFxuXFx0cmV0dXJuIFJFQ0lQUk9DQUxfUEkgKiAoIHNoaW5pbmVzcyAqIDAuNSArIDEuMCApICogcG93KCBkb3ROSCwgc2hpbmluZXNzICk7XFxufVxcbnZlYzMgQlJERl9TcGVjdWxhcl9CbGlublBob25nKCBjb25zdCBpbiBJbmNpZGVudExpZ2h0IGluY2lkZW50TGlnaHQsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIHZlYzMgc3BlY3VsYXJDb2xvciwgY29uc3QgaW4gZmxvYXQgc2hpbmluZXNzICkge1xcblxcdHZlYzMgaGFsZkRpciA9IG5vcm1hbGl6ZSggaW5jaWRlbnRMaWdodC5kaXJlY3Rpb24gKyBnZW9tZXRyeS52aWV3RGlyICk7XFxuXFx0ZmxvYXQgZG90TkggPSBzYXR1cmF0ZSggZG90KCBnZW9tZXRyeS5ub3JtYWwsIGhhbGZEaXIgKSApO1xcblxcdGZsb2F0IGRvdExIID0gc2F0dXJhdGUoIGRvdCggaW5jaWRlbnRMaWdodC5kaXJlY3Rpb24sIGhhbGZEaXIgKSApO1xcblxcdHZlYzMgRiA9IEZfU2NobGljayggc3BlY3VsYXJDb2xvciwgZG90TEggKTtcXG5cXHRmbG9hdCBHID0gR19CbGlublBob25nX0ltcGxpY2l0KCApO1xcblxcdGZsb2F0IEQgPSBEX0JsaW5uUGhvbmcoIHNoaW5pbmVzcywgZG90TkggKTtcXG5cXHRyZXR1cm4gRiAqICggRyAqIEQgKTtcXG59XFxuZmxvYXQgR0dYUm91Z2huZXNzVG9CbGlubkV4cG9uZW50KCBjb25zdCBpbiBmbG9hdCBnZ3hSb3VnaG5lc3MgKSB7XFxuXFx0cmV0dXJuICggMi4wIC8gcG93MiggZ2d4Um91Z2huZXNzICsgMC4wMDAxICkgLSAyLjAgKTtcXG59XFxuZmxvYXQgQmxpbm5FeHBvbmVudFRvR0dYUm91Z2huZXNzKCBjb25zdCBpbiBmbG9hdCBibGlubkV4cG9uZW50ICkge1xcblxcdHJldHVybiBzcXJ0KCAyLjAgLyAoIGJsaW5uRXhwb25lbnQgKyAyLjAgKSApO1xcbn1cXG4jaWYgZGVmaW5lZCggVVNFX1NIRUVOIClcXG5mbG9hdCBEX0NoYXJsaWUoZmxvYXQgcm91Z2huZXNzLCBmbG9hdCBOb0gpIHtcXG5cXHRmbG9hdCBpbnZBbHBoYSA9IDEuMCAvIHJvdWdobmVzcztcXG5cXHRmbG9hdCBjb3MyaCA9IE5vSCAqIE5vSDtcXG5cXHRmbG9hdCBzaW4yaCA9IG1heCgxLjAgLSBjb3MyaCwgMC4wMDc4MTI1KTtcXHRyZXR1cm4gKDIuMCArIGludkFscGhhKSAqIHBvdyhzaW4yaCwgaW52QWxwaGEgKiAwLjUpIC8gKDIuMCAqIFBJKTtcXG59XFxuZmxvYXQgVl9OZXViZWx0KGZsb2F0IE5vViwgZmxvYXQgTm9MKSB7XFxuXFx0cmV0dXJuIHNhdHVyYXRlKDEuMCAvICg0LjAgKiAoTm9MICsgTm9WIC0gTm9MICogTm9WKSkpO1xcbn1cXG52ZWMzIEJSREZfU3BlY3VsYXJfU2hlZW4oIGNvbnN0IGluIGZsb2F0IHJvdWdobmVzcywgY29uc3QgaW4gdmVjMyBMLCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCB2ZWMzIHNwZWN1bGFyQ29sb3IgKSB7XFxuXFx0dmVjMyBOID0gZ2VvbWV0cnkubm9ybWFsO1xcblxcdHZlYzMgViA9IGdlb21ldHJ5LnZpZXdEaXI7XFxuXFx0dmVjMyBIID0gbm9ybWFsaXplKCBWICsgTCApO1xcblxcdGZsb2F0IGRvdE5IID0gc2F0dXJhdGUoIGRvdCggTiwgSCApICk7XFxuXFx0cmV0dXJuIHNwZWN1bGFyQ29sb3IgKiBEX0NoYXJsaWUoIHJvdWdobmVzcywgZG90TkggKSAqIFZfTmV1YmVsdCggZG90KE4sIFYpLCBkb3QoTiwgTCkgKTtcXG59XFxuI2VuZGlmXCIsYnVtcG1hcF9wYXJzX2ZyYWdtZW50OlwiI2lmZGVmIFVTRV9CVU1QTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgYnVtcE1hcDtcXG5cXHR1bmlmb3JtIGZsb2F0IGJ1bXBTY2FsZTtcXG5cXHR2ZWMyIGRIZHh5X2Z3ZCgpIHtcXG5cXHRcXHR2ZWMyIGRTVGR4ID0gZEZkeCggdlV2ICk7XFxuXFx0XFx0dmVjMiBkU1RkeSA9IGRGZHkoIHZVdiApO1xcblxcdFxcdGZsb2F0IEhsbCA9IGJ1bXBTY2FsZSAqIHRleHR1cmUyRCggYnVtcE1hcCwgdlV2ICkueDtcXG5cXHRcXHRmbG9hdCBkQnggPSBidW1wU2NhbGUgKiB0ZXh0dXJlMkQoIGJ1bXBNYXAsIHZVdiArIGRTVGR4ICkueCAtIEhsbDtcXG5cXHRcXHRmbG9hdCBkQnkgPSBidW1wU2NhbGUgKiB0ZXh0dXJlMkQoIGJ1bXBNYXAsIHZVdiArIGRTVGR5ICkueCAtIEhsbDtcXG5cXHRcXHRyZXR1cm4gdmVjMiggZEJ4LCBkQnkgKTtcXG5cXHR9XFxuXFx0dmVjMyBwZXJ0dXJiTm9ybWFsQXJiKCB2ZWMzIHN1cmZfcG9zLCB2ZWMzIHN1cmZfbm9ybSwgdmVjMiBkSGR4eSApIHtcXG5cXHRcXHR2ZWMzIHZTaWdtYVggPSB2ZWMzKCBkRmR4KCBzdXJmX3Bvcy54ICksIGRGZHgoIHN1cmZfcG9zLnkgKSwgZEZkeCggc3VyZl9wb3MueiApICk7XFxuXFx0XFx0dmVjMyB2U2lnbWFZID0gdmVjMyggZEZkeSggc3VyZl9wb3MueCApLCBkRmR5KCBzdXJmX3Bvcy55ICksIGRGZHkoIHN1cmZfcG9zLnogKSApO1xcblxcdFxcdHZlYzMgdk4gPSBzdXJmX25vcm07XFxuXFx0XFx0dmVjMyBSMSA9IGNyb3NzKCB2U2lnbWFZLCB2TiApO1xcblxcdFxcdHZlYzMgUjIgPSBjcm9zcyggdk4sIHZTaWdtYVggKTtcXG5cXHRcXHRmbG9hdCBmRGV0ID0gZG90KCB2U2lnbWFYLCBSMSApO1xcblxcdFxcdGZEZXQgKj0gKCBmbG9hdCggZ2xfRnJvbnRGYWNpbmcgKSAqIDIuMCAtIDEuMCApO1xcblxcdFxcdHZlYzMgdkdyYWQgPSBzaWduKCBmRGV0ICkgKiAoIGRIZHh5LnggKiBSMSArIGRIZHh5LnkgKiBSMiApO1xcblxcdFxcdHJldHVybiBub3JtYWxpemUoIGFicyggZkRldCApICogc3VyZl9ub3JtIC0gdkdyYWQgKTtcXG5cXHR9XFxuI2VuZGlmXCIsY2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50OlwiI2lmIE5VTV9DTElQUElOR19QTEFORVMgPiAwXFxuXFx0dmVjNCBwbGFuZTtcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgVU5JT05fQ0xJUFBJTkdfUExBTkVTOyBpICsrICkge1xcblxcdFxcdHBsYW5lID0gY2xpcHBpbmdQbGFuZXNbIGkgXTtcXG5cXHRcXHRpZiAoIGRvdCggdkNsaXBQb3NpdGlvbiwgcGxhbmUueHl6ICkgPiBwbGFuZS53ICkgZGlzY2FyZDtcXG5cXHR9XFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcXG5cXHQjaWYgVU5JT05fQ0xJUFBJTkdfUExBTkVTIDwgTlVNX0NMSVBQSU5HX1BMQU5FU1xcblxcdFxcdGJvb2wgY2xpcHBlZCA9IHRydWU7XFxuXFx0XFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxcblxcdFxcdGZvciAoIGludCBpID0gVU5JT05fQ0xJUFBJTkdfUExBTkVTOyBpIDwgTlVNX0NMSVBQSU5HX1BMQU5FUzsgaSArKyApIHtcXG5cXHRcXHRcXHRwbGFuZSA9IGNsaXBwaW5nUGxhbmVzWyBpIF07XFxuXFx0XFx0XFx0Y2xpcHBlZCA9ICggZG90KCB2Q2xpcFBvc2l0aW9uLCBwbGFuZS54eXogKSA+IHBsYW5lLncgKSAmJiBjbGlwcGVkO1xcblxcdFxcdH1cXG5cXHRcXHQjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxcblxcdFxcdGlmICggY2xpcHBlZCApIGRpc2NhcmQ7XFxuXFx0I2VuZGlmXFxuI2VuZGlmXCIsY2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ6XCIjaWYgTlVNX0NMSVBQSU5HX1BMQU5FUyA+IDBcXG5cXHR2YXJ5aW5nIHZlYzMgdkNsaXBQb3NpdGlvbjtcXG5cXHR1bmlmb3JtIHZlYzQgY2xpcHBpbmdQbGFuZXNbIE5VTV9DTElQUElOR19QTEFORVMgXTtcXG4jZW5kaWZcIixjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg6XCIjaWYgTlVNX0NMSVBQSU5HX1BMQU5FUyA+IDBcXG5cXHR2YXJ5aW5nIHZlYzMgdkNsaXBQb3NpdGlvbjtcXG4jZW5kaWZcIixjbGlwcGluZ19wbGFuZXNfdmVydGV4OlwiI2lmIE5VTV9DTElQUElOR19QTEFORVMgPiAwXFxuXFx0dkNsaXBQb3NpdGlvbiA9IC0gbXZQb3NpdGlvbi54eXo7XFxuI2VuZGlmXCIsY29sb3JfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0NPTE9SXFxuXFx0ZGlmZnVzZUNvbG9yLnJnYiAqPSB2Q29sb3I7XFxuI2VuZGlmXCIsY29sb3JfcGFyc19mcmFnbWVudDpcIiNpZmRlZiBVU0VfQ09MT1JcXG5cXHR2YXJ5aW5nIHZlYzMgdkNvbG9yO1xcbiNlbmRpZlwiLGNvbG9yX3BhcnNfdmVydGV4OlwiI2lmIGRlZmluZWQoIFVTRV9DT0xPUiApIHx8IGRlZmluZWQoIFVTRV9JTlNUQU5DSU5HX0NPTE9SIClcXG5cXHR2YXJ5aW5nIHZlYzMgdkNvbG9yO1xcbiNlbmRpZlwiLGNvbG9yX3ZlcnRleDpcIiNpZiBkZWZpbmVkKCBVU0VfQ09MT1IgKSB8fCBkZWZpbmVkKCBVU0VfSU5TVEFOQ0lOR19DT0xPUiApXFxuXFx0dkNvbG9yID0gdmVjMyggMS4wICk7XFxuI2VuZGlmXFxuI2lmZGVmIFVTRV9DT0xPUlxcblxcdHZDb2xvci54eXogKj0gY29sb3IueHl6O1xcbiNlbmRpZlxcbiNpZmRlZiBVU0VfSU5TVEFOQ0lOR19DT0xPUlxcblxcdHZDb2xvci54eXogKj0gaW5zdGFuY2VDb2xvci54eXo7XFxuI2VuZGlmXCIsY29tbW9uOlwiI2RlZmluZSBQSSAzLjE0MTU5MjY1MzU4OTc5M1xcbiNkZWZpbmUgUEkyIDYuMjgzMTg1MzA3MTc5NTg2XFxuI2RlZmluZSBQSV9IQUxGIDEuNTcwNzk2MzI2Nzk0ODk2NlxcbiNkZWZpbmUgUkVDSVBST0NBTF9QSSAwLjMxODMwOTg4NjE4Mzc5MDdcXG4jZGVmaW5lIFJFQ0lQUk9DQUxfUEkyIDAuMTU5MTU0OTQzMDkxODk1MzVcXG4jZGVmaW5lIEVQU0lMT04gMWUtNlxcbiNpZm5kZWYgc2F0dXJhdGVcXG4jZGVmaW5lIHNhdHVyYXRlKGEpIGNsYW1wKCBhLCAwLjAsIDEuMCApXFxuI2VuZGlmXFxuI2RlZmluZSB3aGl0ZUNvbXBsZW1lbnQoYSkgKCAxLjAgLSBzYXR1cmF0ZSggYSApIClcXG5mbG9hdCBwb3cyKCBjb25zdCBpbiBmbG9hdCB4ICkgeyByZXR1cm4geCp4OyB9XFxuZmxvYXQgcG93MyggY29uc3QgaW4gZmxvYXQgeCApIHsgcmV0dXJuIHgqeCp4OyB9XFxuZmxvYXQgcG93NCggY29uc3QgaW4gZmxvYXQgeCApIHsgZmxvYXQgeDIgPSB4Kng7IHJldHVybiB4Mip4MjsgfVxcbmZsb2F0IGF2ZXJhZ2UoIGNvbnN0IGluIHZlYzMgY29sb3IgKSB7IHJldHVybiBkb3QoIGNvbG9yLCB2ZWMzKCAwLjMzMzMgKSApOyB9XFxuaGlnaHAgZmxvYXQgcmFuZCggY29uc3QgaW4gdmVjMiB1diApIHtcXG5cXHRjb25zdCBoaWdocCBmbG9hdCBhID0gMTIuOTg5OCwgYiA9IDc4LjIzMywgYyA9IDQzNzU4LjU0NTM7XFxuXFx0aGlnaHAgZmxvYXQgZHQgPSBkb3QoIHV2Lnh5LCB2ZWMyKCBhLGIgKSApLCBzbiA9IG1vZCggZHQsIFBJICk7XFxuXFx0cmV0dXJuIGZyYWN0KHNpbihzbikgKiBjKTtcXG59XFxuI2lmZGVmIEhJR0hfUFJFQ0lTSU9OXFxuXFx0ZmxvYXQgcHJlY2lzaW9uU2FmZUxlbmd0aCggdmVjMyB2ICkgeyByZXR1cm4gbGVuZ3RoKCB2ICk7IH1cXG4jZWxzZVxcblxcdGZsb2F0IG1heDMoIHZlYzMgdiApIHsgcmV0dXJuIG1heCggbWF4KCB2LngsIHYueSApLCB2LnogKTsgfVxcblxcdGZsb2F0IHByZWNpc2lvblNhZmVMZW5ndGgoIHZlYzMgdiApIHtcXG5cXHRcXHRmbG9hdCBtYXhDb21wb25lbnQgPSBtYXgzKCBhYnMoIHYgKSApO1xcblxcdFxcdHJldHVybiBsZW5ndGgoIHYgLyBtYXhDb21wb25lbnQgKSAqIG1heENvbXBvbmVudDtcXG5cXHR9XFxuI2VuZGlmXFxuc3RydWN0IEluY2lkZW50TGlnaHQge1xcblxcdHZlYzMgY29sb3I7XFxuXFx0dmVjMyBkaXJlY3Rpb247XFxuXFx0Ym9vbCB2aXNpYmxlO1xcbn07XFxuc3RydWN0IFJlZmxlY3RlZExpZ2h0IHtcXG5cXHR2ZWMzIGRpcmVjdERpZmZ1c2U7XFxuXFx0dmVjMyBkaXJlY3RTcGVjdWxhcjtcXG5cXHR2ZWMzIGluZGlyZWN0RGlmZnVzZTtcXG5cXHR2ZWMzIGluZGlyZWN0U3BlY3VsYXI7XFxufTtcXG5zdHJ1Y3QgR2VvbWV0cmljQ29udGV4dCB7XFxuXFx0dmVjMyBwb3NpdGlvbjtcXG5cXHR2ZWMzIG5vcm1hbDtcXG5cXHR2ZWMzIHZpZXdEaXI7XFxuI2lmZGVmIENMRUFSQ09BVFxcblxcdHZlYzMgY2xlYXJjb2F0Tm9ybWFsO1xcbiNlbmRpZlxcbn07XFxudmVjMyB0cmFuc2Zvcm1EaXJlY3Rpb24oIGluIHZlYzMgZGlyLCBpbiBtYXQ0IG1hdHJpeCApIHtcXG5cXHRyZXR1cm4gbm9ybWFsaXplKCAoIG1hdHJpeCAqIHZlYzQoIGRpciwgMC4wICkgKS54eXogKTtcXG59XFxudmVjMyBpbnZlcnNlVHJhbnNmb3JtRGlyZWN0aW9uKCBpbiB2ZWMzIGRpciwgaW4gbWF0NCBtYXRyaXggKSB7XFxuXFx0cmV0dXJuIG5vcm1hbGl6ZSggKCB2ZWM0KCBkaXIsIDAuMCApICogbWF0cml4ICkueHl6ICk7XFxufVxcbnZlYzMgcHJvamVjdE9uUGxhbmUoaW4gdmVjMyBwb2ludCwgaW4gdmVjMyBwb2ludE9uUGxhbmUsIGluIHZlYzMgcGxhbmVOb3JtYWwgKSB7XFxuXFx0ZmxvYXQgZGlzdGFuY2UgPSBkb3QoIHBsYW5lTm9ybWFsLCBwb2ludCAtIHBvaW50T25QbGFuZSApO1xcblxcdHJldHVybiAtIGRpc3RhbmNlICogcGxhbmVOb3JtYWwgKyBwb2ludDtcXG59XFxuZmxvYXQgc2lkZU9mUGxhbmUoIGluIHZlYzMgcG9pbnQsIGluIHZlYzMgcG9pbnRPblBsYW5lLCBpbiB2ZWMzIHBsYW5lTm9ybWFsICkge1xcblxcdHJldHVybiBzaWduKCBkb3QoIHBvaW50IC0gcG9pbnRPblBsYW5lLCBwbGFuZU5vcm1hbCApICk7XFxufVxcbnZlYzMgbGluZVBsYW5lSW50ZXJzZWN0KCBpbiB2ZWMzIHBvaW50T25MaW5lLCBpbiB2ZWMzIGxpbmVEaXJlY3Rpb24sIGluIHZlYzMgcG9pbnRPblBsYW5lLCBpbiB2ZWMzIHBsYW5lTm9ybWFsICkge1xcblxcdHJldHVybiBsaW5lRGlyZWN0aW9uICogKCBkb3QoIHBsYW5lTm9ybWFsLCBwb2ludE9uUGxhbmUgLSBwb2ludE9uTGluZSApIC8gZG90KCBwbGFuZU5vcm1hbCwgbGluZURpcmVjdGlvbiApICkgKyBwb2ludE9uTGluZTtcXG59XFxubWF0MyB0cmFuc3Bvc2VNYXQzKCBjb25zdCBpbiBtYXQzIG0gKSB7XFxuXFx0bWF0MyB0bXA7XFxuXFx0dG1wWyAwIF0gPSB2ZWMzKCBtWyAwIF0ueCwgbVsgMSBdLngsIG1bIDIgXS54ICk7XFxuXFx0dG1wWyAxIF0gPSB2ZWMzKCBtWyAwIF0ueSwgbVsgMSBdLnksIG1bIDIgXS55ICk7XFxuXFx0dG1wWyAyIF0gPSB2ZWMzKCBtWyAwIF0ueiwgbVsgMSBdLnosIG1bIDIgXS56ICk7XFxuXFx0cmV0dXJuIHRtcDtcXG59XFxuZmxvYXQgbGluZWFyVG9SZWxhdGl2ZUx1bWluYW5jZSggY29uc3QgaW4gdmVjMyBjb2xvciApIHtcXG5cXHR2ZWMzIHdlaWdodHMgPSB2ZWMzKCAwLjIxMjYsIDAuNzE1MiwgMC4wNzIyICk7XFxuXFx0cmV0dXJuIGRvdCggd2VpZ2h0cywgY29sb3IucmdiICk7XFxufVxcbmJvb2wgaXNQZXJzcGVjdGl2ZU1hdHJpeCggbWF0NCBtICkge1xcblxcdHJldHVybiBtWyAyIF1bIDMgXSA9PSAtIDEuMDtcXG59XFxudmVjMiBlcXVpcmVjdFV2KCBpbiB2ZWMzIGRpciApIHtcXG5cXHRmbG9hdCB1ID0gYXRhbiggZGlyLnosIGRpci54ICkgKiBSRUNJUFJPQ0FMX1BJMiArIDAuNTtcXG5cXHRmbG9hdCB2ID0gYXNpbiggY2xhbXAoIGRpci55LCAtIDEuMCwgMS4wICkgKSAqIFJFQ0lQUk9DQUxfUEkgKyAwLjU7XFxuXFx0cmV0dXJuIHZlYzIoIHUsIHYgKTtcXG59XCIsY3ViZV91dl9yZWZsZWN0aW9uX2ZyYWdtZW50OlwiI2lmZGVmIEVOVk1BUF9UWVBFX0NVQkVfVVZcXG5cXHQjZGVmaW5lIGN1YmVVVl9tYXhNaXBMZXZlbCA4LjBcXG5cXHQjZGVmaW5lIGN1YmVVVl9taW5NaXBMZXZlbCA0LjBcXG5cXHQjZGVmaW5lIGN1YmVVVl9tYXhUaWxlU2l6ZSAyNTYuMFxcblxcdCNkZWZpbmUgY3ViZVVWX21pblRpbGVTaXplIDE2LjBcXG5cXHRmbG9hdCBnZXRGYWNlKCB2ZWMzIGRpcmVjdGlvbiApIHtcXG5cXHRcXHR2ZWMzIGFic0RpcmVjdGlvbiA9IGFicyggZGlyZWN0aW9uICk7XFxuXFx0XFx0ZmxvYXQgZmFjZSA9IC0gMS4wO1xcblxcdFxcdGlmICggYWJzRGlyZWN0aW9uLnggPiBhYnNEaXJlY3Rpb24ueiApIHtcXG5cXHRcXHRcXHRpZiAoIGFic0RpcmVjdGlvbi54ID4gYWJzRGlyZWN0aW9uLnkgKVxcblxcdFxcdFxcdFxcdGZhY2UgPSBkaXJlY3Rpb24ueCA+IDAuMCA/IDAuMCA6IDMuMDtcXG5cXHRcXHRcXHRlbHNlXFxuXFx0XFx0XFx0XFx0ZmFjZSA9IGRpcmVjdGlvbi55ID4gMC4wID8gMS4wIDogNC4wO1xcblxcdFxcdH0gZWxzZSB7XFxuXFx0XFx0XFx0aWYgKCBhYnNEaXJlY3Rpb24ueiA+IGFic0RpcmVjdGlvbi55IClcXG5cXHRcXHRcXHRcXHRmYWNlID0gZGlyZWN0aW9uLnogPiAwLjAgPyAyLjAgOiA1LjA7XFxuXFx0XFx0XFx0ZWxzZVxcblxcdFxcdFxcdFxcdGZhY2UgPSBkaXJlY3Rpb24ueSA+IDAuMCA/IDEuMCA6IDQuMDtcXG5cXHRcXHR9XFxuXFx0XFx0cmV0dXJuIGZhY2U7XFxuXFx0fVxcblxcdHZlYzIgZ2V0VVYoIHZlYzMgZGlyZWN0aW9uLCBmbG9hdCBmYWNlICkge1xcblxcdFxcdHZlYzIgdXY7XFxuXFx0XFx0aWYgKCBmYWNlID09IDAuMCApIHtcXG5cXHRcXHRcXHR1diA9IHZlYzIoIGRpcmVjdGlvbi56LCBkaXJlY3Rpb24ueSApIC8gYWJzKCBkaXJlY3Rpb24ueCApO1xcblxcdFxcdH0gZWxzZSBpZiAoIGZhY2UgPT0gMS4wICkge1xcblxcdFxcdFxcdHV2ID0gdmVjMiggLSBkaXJlY3Rpb24ueCwgLSBkaXJlY3Rpb24ueiApIC8gYWJzKCBkaXJlY3Rpb24ueSApO1xcblxcdFxcdH0gZWxzZSBpZiAoIGZhY2UgPT0gMi4wICkge1xcblxcdFxcdFxcdHV2ID0gdmVjMiggLSBkaXJlY3Rpb24ueCwgZGlyZWN0aW9uLnkgKSAvIGFicyggZGlyZWN0aW9uLnogKTtcXG5cXHRcXHR9IGVsc2UgaWYgKCBmYWNlID09IDMuMCApIHtcXG5cXHRcXHRcXHR1diA9IHZlYzIoIC0gZGlyZWN0aW9uLnosIGRpcmVjdGlvbi55ICkgLyBhYnMoIGRpcmVjdGlvbi54ICk7XFxuXFx0XFx0fSBlbHNlIGlmICggZmFjZSA9PSA0LjAgKSB7XFxuXFx0XFx0XFx0dXYgPSB2ZWMyKCAtIGRpcmVjdGlvbi54LCBkaXJlY3Rpb24ueiApIC8gYWJzKCBkaXJlY3Rpb24ueSApO1xcblxcdFxcdH0gZWxzZSB7XFxuXFx0XFx0XFx0dXYgPSB2ZWMyKCBkaXJlY3Rpb24ueCwgZGlyZWN0aW9uLnkgKSAvIGFicyggZGlyZWN0aW9uLnogKTtcXG5cXHRcXHR9XFxuXFx0XFx0cmV0dXJuIDAuNSAqICggdXYgKyAxLjAgKTtcXG5cXHR9XFxuXFx0dmVjMyBiaWxpbmVhckN1YmVVViggc2FtcGxlcjJEIGVudk1hcCwgdmVjMyBkaXJlY3Rpb24sIGZsb2F0IG1pcEludCApIHtcXG5cXHRcXHRmbG9hdCBmYWNlID0gZ2V0RmFjZSggZGlyZWN0aW9uICk7XFxuXFx0XFx0ZmxvYXQgZmlsdGVySW50ID0gbWF4KCBjdWJlVVZfbWluTWlwTGV2ZWwgLSBtaXBJbnQsIDAuMCApO1xcblxcdFxcdG1pcEludCA9IG1heCggbWlwSW50LCBjdWJlVVZfbWluTWlwTGV2ZWwgKTtcXG5cXHRcXHRmbG9hdCBmYWNlU2l6ZSA9IGV4cDIoIG1pcEludCApO1xcblxcdFxcdGZsb2F0IHRleGVsU2l6ZSA9IDEuMCAvICggMy4wICogY3ViZVVWX21heFRpbGVTaXplICk7XFxuXFx0XFx0dmVjMiB1diA9IGdldFVWKCBkaXJlY3Rpb24sIGZhY2UgKSAqICggZmFjZVNpemUgLSAxLjAgKTtcXG5cXHRcXHR2ZWMyIGYgPSBmcmFjdCggdXYgKTtcXG5cXHRcXHR1diArPSAwLjUgLSBmO1xcblxcdFxcdGlmICggZmFjZSA+IDIuMCApIHtcXG5cXHRcXHRcXHR1di55ICs9IGZhY2VTaXplO1xcblxcdFxcdFxcdGZhY2UgLT0gMy4wO1xcblxcdFxcdH1cXG5cXHRcXHR1di54ICs9IGZhY2UgKiBmYWNlU2l6ZTtcXG5cXHRcXHRpZiAoIG1pcEludCA8IGN1YmVVVl9tYXhNaXBMZXZlbCApIHtcXG5cXHRcXHRcXHR1di55ICs9IDIuMCAqIGN1YmVVVl9tYXhUaWxlU2l6ZTtcXG5cXHRcXHR9XFxuXFx0XFx0dXYueSArPSBmaWx0ZXJJbnQgKiAyLjAgKiBjdWJlVVZfbWluVGlsZVNpemU7XFxuXFx0XFx0dXYueCArPSAzLjAgKiBtYXgoIDAuMCwgY3ViZVVWX21heFRpbGVTaXplIC0gMi4wICogZmFjZVNpemUgKTtcXG5cXHRcXHR1diAqPSB0ZXhlbFNpemU7XFxuXFx0XFx0dmVjMyB0bCA9IGVudk1hcFRleGVsVG9MaW5lYXIoIHRleHR1cmUyRCggZW52TWFwLCB1diApICkucmdiO1xcblxcdFxcdHV2LnggKz0gdGV4ZWxTaXplO1xcblxcdFxcdHZlYzMgdHIgPSBlbnZNYXBUZXhlbFRvTGluZWFyKCB0ZXh0dXJlMkQoIGVudk1hcCwgdXYgKSApLnJnYjtcXG5cXHRcXHR1di55ICs9IHRleGVsU2l6ZTtcXG5cXHRcXHR2ZWMzIGJyID0gZW52TWFwVGV4ZWxUb0xpbmVhciggdGV4dHVyZTJEKCBlbnZNYXAsIHV2ICkgKS5yZ2I7XFxuXFx0XFx0dXYueCAtPSB0ZXhlbFNpemU7XFxuXFx0XFx0dmVjMyBibCA9IGVudk1hcFRleGVsVG9MaW5lYXIoIHRleHR1cmUyRCggZW52TWFwLCB1diApICkucmdiO1xcblxcdFxcdHZlYzMgdG0gPSBtaXgoIHRsLCB0ciwgZi54ICk7XFxuXFx0XFx0dmVjMyBibSA9IG1peCggYmwsIGJyLCBmLnggKTtcXG5cXHRcXHRyZXR1cm4gbWl4KCB0bSwgYm0sIGYueSApO1xcblxcdH1cXG5cXHQjZGVmaW5lIHIwIDEuMFxcblxcdCNkZWZpbmUgdjAgMC4zMzlcXG5cXHQjZGVmaW5lIG0wIC0gMi4wXFxuXFx0I2RlZmluZSByMSAwLjhcXG5cXHQjZGVmaW5lIHYxIDAuMjc2XFxuXFx0I2RlZmluZSBtMSAtIDEuMFxcblxcdCNkZWZpbmUgcjQgMC40XFxuXFx0I2RlZmluZSB2NCAwLjA0NlxcblxcdCNkZWZpbmUgbTQgMi4wXFxuXFx0I2RlZmluZSByNSAwLjMwNVxcblxcdCNkZWZpbmUgdjUgMC4wMTZcXG5cXHQjZGVmaW5lIG01IDMuMFxcblxcdCNkZWZpbmUgcjYgMC4yMVxcblxcdCNkZWZpbmUgdjYgMC4wMDM4XFxuXFx0I2RlZmluZSBtNiA0LjBcXG5cXHRmbG9hdCByb3VnaG5lc3NUb01pcCggZmxvYXQgcm91Z2huZXNzICkge1xcblxcdFxcdGZsb2F0IG1pcCA9IDAuMDtcXG5cXHRcXHRpZiAoIHJvdWdobmVzcyA+PSByMSApIHtcXG5cXHRcXHRcXHRtaXAgPSAoIHIwIC0gcm91Z2huZXNzICkgKiAoIG0xIC0gbTAgKSAvICggcjAgLSByMSApICsgbTA7XFxuXFx0XFx0fSBlbHNlIGlmICggcm91Z2huZXNzID49IHI0ICkge1xcblxcdFxcdFxcdG1pcCA9ICggcjEgLSByb3VnaG5lc3MgKSAqICggbTQgLSBtMSApIC8gKCByMSAtIHI0ICkgKyBtMTtcXG5cXHRcXHR9IGVsc2UgaWYgKCByb3VnaG5lc3MgPj0gcjUgKSB7XFxuXFx0XFx0XFx0bWlwID0gKCByNCAtIHJvdWdobmVzcyApICogKCBtNSAtIG00ICkgLyAoIHI0IC0gcjUgKSArIG00O1xcblxcdFxcdH0gZWxzZSBpZiAoIHJvdWdobmVzcyA+PSByNiApIHtcXG5cXHRcXHRcXHRtaXAgPSAoIHI1IC0gcm91Z2huZXNzICkgKiAoIG02IC0gbTUgKSAvICggcjUgLSByNiApICsgbTU7XFxuXFx0XFx0fSBlbHNlIHtcXG5cXHRcXHRcXHRtaXAgPSAtIDIuMCAqIGxvZzIoIDEuMTYgKiByb3VnaG5lc3MgKTtcXHRcXHR9XFxuXFx0XFx0cmV0dXJuIG1pcDtcXG5cXHR9XFxuXFx0dmVjNCB0ZXh0dXJlQ3ViZVVWKCBzYW1wbGVyMkQgZW52TWFwLCB2ZWMzIHNhbXBsZURpciwgZmxvYXQgcm91Z2huZXNzICkge1xcblxcdFxcdGZsb2F0IG1pcCA9IGNsYW1wKCByb3VnaG5lc3NUb01pcCggcm91Z2huZXNzICksIG0wLCBjdWJlVVZfbWF4TWlwTGV2ZWwgKTtcXG5cXHRcXHRmbG9hdCBtaXBGID0gZnJhY3QoIG1pcCApO1xcblxcdFxcdGZsb2F0IG1pcEludCA9IGZsb29yKCBtaXAgKTtcXG5cXHRcXHR2ZWMzIGNvbG9yMCA9IGJpbGluZWFyQ3ViZVVWKCBlbnZNYXAsIHNhbXBsZURpciwgbWlwSW50ICk7XFxuXFx0XFx0aWYgKCBtaXBGID09IDAuMCApIHtcXG5cXHRcXHRcXHRyZXR1cm4gdmVjNCggY29sb3IwLCAxLjAgKTtcXG5cXHRcXHR9IGVsc2Uge1xcblxcdFxcdFxcdHZlYzMgY29sb3IxID0gYmlsaW5lYXJDdWJlVVYoIGVudk1hcCwgc2FtcGxlRGlyLCBtaXBJbnQgKyAxLjAgKTtcXG5cXHRcXHRcXHRyZXR1cm4gdmVjNCggbWl4KCBjb2xvcjAsIGNvbG9yMSwgbWlwRiApLCAxLjAgKTtcXG5cXHRcXHR9XFxuXFx0fVxcbiNlbmRpZlwiLGRlZmF1bHRub3JtYWxfdmVydGV4OlwidmVjMyB0cmFuc2Zvcm1lZE5vcm1hbCA9IG9iamVjdE5vcm1hbDtcXG4jaWZkZWYgVVNFX0lOU1RBTkNJTkdcXG5cXHRtYXQzIG0gPSBtYXQzKCBpbnN0YW5jZU1hdHJpeCApO1xcblxcdHRyYW5zZm9ybWVkTm9ybWFsIC89IHZlYzMoIGRvdCggbVsgMCBdLCBtWyAwIF0gKSwgZG90KCBtWyAxIF0sIG1bIDEgXSApLCBkb3QoIG1bIDIgXSwgbVsgMiBdICkgKTtcXG5cXHR0cmFuc2Zvcm1lZE5vcm1hbCA9IG0gKiB0cmFuc2Zvcm1lZE5vcm1hbDtcXG4jZW5kaWZcXG50cmFuc2Zvcm1lZE5vcm1hbCA9IG5vcm1hbE1hdHJpeCAqIHRyYW5zZm9ybWVkTm9ybWFsO1xcbiNpZmRlZiBGTElQX1NJREVEXFxuXFx0dHJhbnNmb3JtZWROb3JtYWwgPSAtIHRyYW5zZm9ybWVkTm9ybWFsO1xcbiNlbmRpZlxcbiNpZmRlZiBVU0VfVEFOR0VOVFxcblxcdHZlYzMgdHJhbnNmb3JtZWRUYW5nZW50ID0gKCBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBvYmplY3RUYW5nZW50LCAwLjAgKSApLnh5ejtcXG5cXHQjaWZkZWYgRkxJUF9TSURFRFxcblxcdFxcdHRyYW5zZm9ybWVkVGFuZ2VudCA9IC0gdHJhbnNmb3JtZWRUYW5nZW50O1xcblxcdCNlbmRpZlxcbiNlbmRpZlwiLGRpc3BsYWNlbWVudG1hcF9wYXJzX3ZlcnRleDpcIiNpZmRlZiBVU0VfRElTUExBQ0VNRU5UTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgZGlzcGxhY2VtZW50TWFwO1xcblxcdHVuaWZvcm0gZmxvYXQgZGlzcGxhY2VtZW50U2NhbGU7XFxuXFx0dW5pZm9ybSBmbG9hdCBkaXNwbGFjZW1lbnRCaWFzO1xcbiNlbmRpZlwiLGRpc3BsYWNlbWVudG1hcF92ZXJ0ZXg6XCIjaWZkZWYgVVNFX0RJU1BMQUNFTUVOVE1BUFxcblxcdHRyYW5zZm9ybWVkICs9IG5vcm1hbGl6ZSggb2JqZWN0Tm9ybWFsICkgKiAoIHRleHR1cmUyRCggZGlzcGxhY2VtZW50TWFwLCB2VXYgKS54ICogZGlzcGxhY2VtZW50U2NhbGUgKyBkaXNwbGFjZW1lbnRCaWFzICk7XFxuI2VuZGlmXCIsZW1pc3NpdmVtYXBfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0VNSVNTSVZFTUFQXFxuXFx0dmVjNCBlbWlzc2l2ZUNvbG9yID0gdGV4dHVyZTJEKCBlbWlzc2l2ZU1hcCwgdlV2ICk7XFxuXFx0ZW1pc3NpdmVDb2xvci5yZ2IgPSBlbWlzc2l2ZU1hcFRleGVsVG9MaW5lYXIoIGVtaXNzaXZlQ29sb3IgKS5yZ2I7XFxuXFx0dG90YWxFbWlzc2l2ZVJhZGlhbmNlICo9IGVtaXNzaXZlQ29sb3IucmdiO1xcbiNlbmRpZlwiLGVtaXNzaXZlbWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0VNSVNTSVZFTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgZW1pc3NpdmVNYXA7XFxuI2VuZGlmXCIsZW5jb2RpbmdzX2ZyYWdtZW50OlwiZ2xfRnJhZ0NvbG9yID0gbGluZWFyVG9PdXRwdXRUZXhlbCggZ2xfRnJhZ0NvbG9yICk7XCIsZW5jb2RpbmdzX3BhcnNfZnJhZ21lbnQ6XCJcXG52ZWM0IExpbmVhclRvTGluZWFyKCBpbiB2ZWM0IHZhbHVlICkge1xcblxcdHJldHVybiB2YWx1ZTtcXG59XFxudmVjNCBHYW1tYVRvTGluZWFyKCBpbiB2ZWM0IHZhbHVlLCBpbiBmbG9hdCBnYW1tYUZhY3RvciApIHtcXG5cXHRyZXR1cm4gdmVjNCggcG93KCB2YWx1ZS5yZ2IsIHZlYzMoIGdhbW1hRmFjdG9yICkgKSwgdmFsdWUuYSApO1xcbn1cXG52ZWM0IExpbmVhclRvR2FtbWEoIGluIHZlYzQgdmFsdWUsIGluIGZsb2F0IGdhbW1hRmFjdG9yICkge1xcblxcdHJldHVybiB2ZWM0KCBwb3coIHZhbHVlLnJnYiwgdmVjMyggMS4wIC8gZ2FtbWFGYWN0b3IgKSApLCB2YWx1ZS5hICk7XFxufVxcbnZlYzQgc1JHQlRvTGluZWFyKCBpbiB2ZWM0IHZhbHVlICkge1xcblxcdHJldHVybiB2ZWM0KCBtaXgoIHBvdyggdmFsdWUucmdiICogMC45NDc4NjcyOTg2ICsgdmVjMyggMC4wNTIxMzI3MDE0ICksIHZlYzMoIDIuNCApICksIHZhbHVlLnJnYiAqIDAuMDc3Mzk5MzgwOCwgdmVjMyggbGVzc1RoYW5FcXVhbCggdmFsdWUucmdiLCB2ZWMzKCAwLjA0MDQ1ICkgKSApICksIHZhbHVlLmEgKTtcXG59XFxudmVjNCBMaW5lYXJUb3NSR0IoIGluIHZlYzQgdmFsdWUgKSB7XFxuXFx0cmV0dXJuIHZlYzQoIG1peCggcG93KCB2YWx1ZS5yZ2IsIHZlYzMoIDAuNDE2NjYgKSApICogMS4wNTUgLSB2ZWMzKCAwLjA1NSApLCB2YWx1ZS5yZ2IgKiAxMi45MiwgdmVjMyggbGVzc1RoYW5FcXVhbCggdmFsdWUucmdiLCB2ZWMzKCAwLjAwMzEzMDggKSApICkgKSwgdmFsdWUuYSApO1xcbn1cXG52ZWM0IFJHQkVUb0xpbmVhciggaW4gdmVjNCB2YWx1ZSApIHtcXG5cXHRyZXR1cm4gdmVjNCggdmFsdWUucmdiICogZXhwMiggdmFsdWUuYSAqIDI1NS4wIC0gMTI4LjAgKSwgMS4wICk7XFxufVxcbnZlYzQgTGluZWFyVG9SR0JFKCBpbiB2ZWM0IHZhbHVlICkge1xcblxcdGZsb2F0IG1heENvbXBvbmVudCA9IG1heCggbWF4KCB2YWx1ZS5yLCB2YWx1ZS5nICksIHZhbHVlLmIgKTtcXG5cXHRmbG9hdCBmRXhwID0gY2xhbXAoIGNlaWwoIGxvZzIoIG1heENvbXBvbmVudCApICksIC0xMjguMCwgMTI3LjAgKTtcXG5cXHRyZXR1cm4gdmVjNCggdmFsdWUucmdiIC8gZXhwMiggZkV4cCApLCAoIGZFeHAgKyAxMjguMCApIC8gMjU1LjAgKTtcXG59XFxudmVjNCBSR0JNVG9MaW5lYXIoIGluIHZlYzQgdmFsdWUsIGluIGZsb2F0IG1heFJhbmdlICkge1xcblxcdHJldHVybiB2ZWM0KCB2YWx1ZS5yZ2IgKiB2YWx1ZS5hICogbWF4UmFuZ2UsIDEuMCApO1xcbn1cXG52ZWM0IExpbmVhclRvUkdCTSggaW4gdmVjNCB2YWx1ZSwgaW4gZmxvYXQgbWF4UmFuZ2UgKSB7XFxuXFx0ZmxvYXQgbWF4UkdCID0gbWF4KCB2YWx1ZS5yLCBtYXgoIHZhbHVlLmcsIHZhbHVlLmIgKSApO1xcblxcdGZsb2F0IE0gPSBjbGFtcCggbWF4UkdCIC8gbWF4UmFuZ2UsIDAuMCwgMS4wICk7XFxuXFx0TSA9IGNlaWwoIE0gKiAyNTUuMCApIC8gMjU1LjA7XFxuXFx0cmV0dXJuIHZlYzQoIHZhbHVlLnJnYiAvICggTSAqIG1heFJhbmdlICksIE0gKTtcXG59XFxudmVjNCBSR0JEVG9MaW5lYXIoIGluIHZlYzQgdmFsdWUsIGluIGZsb2F0IG1heFJhbmdlICkge1xcblxcdHJldHVybiB2ZWM0KCB2YWx1ZS5yZ2IgKiAoICggbWF4UmFuZ2UgLyAyNTUuMCApIC8gdmFsdWUuYSApLCAxLjAgKTtcXG59XFxudmVjNCBMaW5lYXJUb1JHQkQoIGluIHZlYzQgdmFsdWUsIGluIGZsb2F0IG1heFJhbmdlICkge1xcblxcdGZsb2F0IG1heFJHQiA9IG1heCggdmFsdWUuciwgbWF4KCB2YWx1ZS5nLCB2YWx1ZS5iICkgKTtcXG5cXHRmbG9hdCBEID0gbWF4KCBtYXhSYW5nZSAvIG1heFJHQiwgMS4wICk7XFxuXFx0RCA9IGNsYW1wKCBmbG9vciggRCApIC8gMjU1LjAsIDAuMCwgMS4wICk7XFxuXFx0cmV0dXJuIHZlYzQoIHZhbHVlLnJnYiAqICggRCAqICggMjU1LjAgLyBtYXhSYW5nZSApICksIEQgKTtcXG59XFxuY29uc3QgbWF0MyBjTG9nTHV2TSA9IG1hdDMoIDAuMjIwOSwgMC4zMzkwLCAwLjQxODQsIDAuMTEzOCwgMC42NzgwLCAwLjczMTksIDAuMDEwMiwgMC4xMTMwLCAwLjI5NjkgKTtcXG52ZWM0IExpbmVhclRvTG9nTHV2KCBpbiB2ZWM0IHZhbHVlICkge1xcblxcdHZlYzMgWHBfWV9YWVpwID0gY0xvZ0x1dk0gKiB2YWx1ZS5yZ2I7XFxuXFx0WHBfWV9YWVpwID0gbWF4KCBYcF9ZX1hZWnAsIHZlYzMoIDFlLTYsIDFlLTYsIDFlLTYgKSApO1xcblxcdHZlYzQgdlJlc3VsdDtcXG5cXHR2UmVzdWx0Lnh5ID0gWHBfWV9YWVpwLnh5IC8gWHBfWV9YWVpwLno7XFxuXFx0ZmxvYXQgTGUgPSAyLjAgKiBsb2cyKFhwX1lfWFlacC55KSArIDEyNy4wO1xcblxcdHZSZXN1bHQudyA9IGZyYWN0KCBMZSApO1xcblxcdHZSZXN1bHQueiA9ICggTGUgLSAoIGZsb29yKCB2UmVzdWx0LncgKiAyNTUuMCApICkgLyAyNTUuMCApIC8gMjU1LjA7XFxuXFx0cmV0dXJuIHZSZXN1bHQ7XFxufVxcbmNvbnN0IG1hdDMgY0xvZ0x1dkludmVyc2VNID0gbWF0MyggNi4wMDE0LCAtMi43MDA4LCAtMS43OTk2LCAtMS4zMzIwLCAzLjEwMjksIC01Ljc3MjEsIDAuMzAwOCwgLTEuMDg4MiwgNS42MjY4ICk7XFxudmVjNCBMb2dMdXZUb0xpbmVhciggaW4gdmVjNCB2YWx1ZSApIHtcXG5cXHRmbG9hdCBMZSA9IHZhbHVlLnogKiAyNTUuMCArIHZhbHVlLnc7XFxuXFx0dmVjMyBYcF9ZX1hZWnA7XFxuXFx0WHBfWV9YWVpwLnkgPSBleHAyKCAoIExlIC0gMTI3LjAgKSAvIDIuMCApO1xcblxcdFhwX1lfWFlacC56ID0gWHBfWV9YWVpwLnkgLyB2YWx1ZS55O1xcblxcdFhwX1lfWFlacC54ID0gdmFsdWUueCAqIFhwX1lfWFlacC56O1xcblxcdHZlYzMgdlJHQiA9IGNMb2dMdXZJbnZlcnNlTSAqIFhwX1lfWFlacC5yZ2I7XFxuXFx0cmV0dXJuIHZlYzQoIG1heCggdlJHQiwgMC4wICksIDEuMCApO1xcbn1cIixlbnZtYXBfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0VOVk1BUFxcblxcdCNpZmRlZiBFTlZfV09STERQT1NcXG5cXHRcXHR2ZWMzIGNhbWVyYVRvRnJhZztcXG5cXHRcXHRpZiAoIGlzT3J0aG9ncmFwaGljICkge1xcblxcdFxcdFxcdGNhbWVyYVRvRnJhZyA9IG5vcm1hbGl6ZSggdmVjMyggLSB2aWV3TWF0cml4WyAwIF1bIDIgXSwgLSB2aWV3TWF0cml4WyAxIF1bIDIgXSwgLSB2aWV3TWF0cml4WyAyIF1bIDIgXSApICk7XFxuXFx0XFx0fSBlbHNlIHtcXG5cXHRcXHRcXHRjYW1lcmFUb0ZyYWcgPSBub3JtYWxpemUoIHZXb3JsZFBvc2l0aW9uIC0gY2FtZXJhUG9zaXRpb24gKTtcXG5cXHRcXHR9XFxuXFx0XFx0dmVjMyB3b3JsZE5vcm1hbCA9IGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIG5vcm1hbCwgdmlld01hdHJpeCApO1xcblxcdFxcdCNpZmRlZiBFTlZNQVBfTU9ERV9SRUZMRUNUSU9OXFxuXFx0XFx0XFx0dmVjMyByZWZsZWN0VmVjID0gcmVmbGVjdCggY2FtZXJhVG9GcmFnLCB3b3JsZE5vcm1hbCApO1xcblxcdFxcdCNlbHNlXFxuXFx0XFx0XFx0dmVjMyByZWZsZWN0VmVjID0gcmVmcmFjdCggY2FtZXJhVG9GcmFnLCB3b3JsZE5vcm1hbCwgcmVmcmFjdGlvblJhdGlvICk7XFxuXFx0XFx0I2VuZGlmXFxuXFx0I2Vsc2VcXG5cXHRcXHR2ZWMzIHJlZmxlY3RWZWMgPSB2UmVmbGVjdDtcXG5cXHQjZW5kaWZcXG5cXHQjaWZkZWYgRU5WTUFQX1RZUEVfQ1VCRVxcblxcdFxcdHZlYzQgZW52Q29sb3IgPSB0ZXh0dXJlQ3ViZSggZW52TWFwLCB2ZWMzKCBmbGlwRW52TWFwICogcmVmbGVjdFZlYy54LCByZWZsZWN0VmVjLnl6ICkgKTtcXG5cXHQjZWxpZiBkZWZpbmVkKCBFTlZNQVBfVFlQRV9DVUJFX1VWIClcXG5cXHRcXHR2ZWM0IGVudkNvbG9yID0gdGV4dHVyZUN1YmVVViggZW52TWFwLCByZWZsZWN0VmVjLCAwLjAgKTtcXG5cXHQjZWxzZVxcblxcdFxcdHZlYzQgZW52Q29sb3IgPSB2ZWM0KCAwLjAgKTtcXG5cXHQjZW5kaWZcXG5cXHQjaWZuZGVmIEVOVk1BUF9UWVBFX0NVQkVfVVZcXG5cXHRcXHRlbnZDb2xvciA9IGVudk1hcFRleGVsVG9MaW5lYXIoIGVudkNvbG9yICk7XFxuXFx0I2VuZGlmXFxuXFx0I2lmZGVmIEVOVk1BUF9CTEVORElOR19NVUxUSVBMWVxcblxcdFxcdG91dGdvaW5nTGlnaHQgPSBtaXgoIG91dGdvaW5nTGlnaHQsIG91dGdvaW5nTGlnaHQgKiBlbnZDb2xvci54eXosIHNwZWN1bGFyU3RyZW5ndGggKiByZWZsZWN0aXZpdHkgKTtcXG5cXHQjZWxpZiBkZWZpbmVkKCBFTlZNQVBfQkxFTkRJTkdfTUlYIClcXG5cXHRcXHRvdXRnb2luZ0xpZ2h0ID0gbWl4KCBvdXRnb2luZ0xpZ2h0LCBlbnZDb2xvci54eXosIHNwZWN1bGFyU3RyZW5ndGggKiByZWZsZWN0aXZpdHkgKTtcXG5cXHQjZWxpZiBkZWZpbmVkKCBFTlZNQVBfQkxFTkRJTkdfQUREIClcXG5cXHRcXHRvdXRnb2luZ0xpZ2h0ICs9IGVudkNvbG9yLnh5eiAqIHNwZWN1bGFyU3RyZW5ndGggKiByZWZsZWN0aXZpdHk7XFxuXFx0I2VuZGlmXFxuI2VuZGlmXCIsZW52bWFwX2NvbW1vbl9wYXJzX2ZyYWdtZW50OlwiI2lmZGVmIFVTRV9FTlZNQVBcXG5cXHR1bmlmb3JtIGZsb2F0IGVudk1hcEludGVuc2l0eTtcXG5cXHR1bmlmb3JtIGZsb2F0IGZsaXBFbnZNYXA7XFxuXFx0dW5pZm9ybSBpbnQgbWF4TWlwTGV2ZWw7XFxuXFx0I2lmZGVmIEVOVk1BUF9UWVBFX0NVQkVcXG5cXHRcXHR1bmlmb3JtIHNhbXBsZXJDdWJlIGVudk1hcDtcXG5cXHQjZWxzZVxcblxcdFxcdHVuaWZvcm0gc2FtcGxlcjJEIGVudk1hcDtcXG5cXHQjZW5kaWZcXG5cXHRcXG4jZW5kaWZcIixlbnZtYXBfcGFyc19mcmFnbWVudDpcIiNpZmRlZiBVU0VfRU5WTUFQXFxuXFx0dW5pZm9ybSBmbG9hdCByZWZsZWN0aXZpdHk7XFxuXFx0I2lmIGRlZmluZWQoIFVTRV9CVU1QTUFQICkgfHwgZGVmaW5lZCggVVNFX05PUk1BTE1BUCApIHx8IGRlZmluZWQoIFBIT05HIClcXG5cXHRcXHQjZGVmaW5lIEVOVl9XT1JMRFBPU1xcblxcdCNlbmRpZlxcblxcdCNpZmRlZiBFTlZfV09STERQT1NcXG5cXHRcXHR2YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb247XFxuXFx0XFx0dW5pZm9ybSBmbG9hdCByZWZyYWN0aW9uUmF0aW87XFxuXFx0I2Vsc2VcXG5cXHRcXHR2YXJ5aW5nIHZlYzMgdlJlZmxlY3Q7XFxuXFx0I2VuZGlmXFxuI2VuZGlmXCIsZW52bWFwX3BhcnNfdmVydGV4OlwiI2lmZGVmIFVTRV9FTlZNQVBcXG5cXHQjaWYgZGVmaW5lZCggVVNFX0JVTVBNQVAgKSB8fCBkZWZpbmVkKCBVU0VfTk9STUFMTUFQICkgfHxkZWZpbmVkKCBQSE9ORyApXFxuXFx0XFx0I2RlZmluZSBFTlZfV09STERQT1NcXG5cXHQjZW5kaWZcXG5cXHQjaWZkZWYgRU5WX1dPUkxEUE9TXFxuXFx0XFx0XFxuXFx0XFx0dmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uO1xcblxcdCNlbHNlXFxuXFx0XFx0dmFyeWluZyB2ZWMzIHZSZWZsZWN0O1xcblxcdFxcdHVuaWZvcm0gZmxvYXQgcmVmcmFjdGlvblJhdGlvO1xcblxcdCNlbmRpZlxcbiNlbmRpZlwiLGVudm1hcF9waHlzaWNhbF9wYXJzX2ZyYWdtZW50OlwiI2lmIGRlZmluZWQoIFVTRV9FTlZNQVAgKVxcblxcdCNpZmRlZiBFTlZNQVBfTU9ERV9SRUZSQUNUSU9OXFxuXFx0XFx0dW5pZm9ybSBmbG9hdCByZWZyYWN0aW9uUmF0aW87XFxuXFx0I2VuZGlmXFxuXFx0dmVjMyBnZXRMaWdodFByb2JlSW5kaXJlY3RJcnJhZGlhbmNlKCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBpbnQgbWF4TUlQTGV2ZWwgKSB7XFxuXFx0XFx0dmVjMyB3b3JsZE5vcm1hbCA9IGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIGdlb21ldHJ5Lm5vcm1hbCwgdmlld01hdHJpeCApO1xcblxcdFxcdCNpZmRlZiBFTlZNQVBfVFlQRV9DVUJFXFxuXFx0XFx0XFx0dmVjMyBxdWVyeVZlYyA9IHZlYzMoIGZsaXBFbnZNYXAgKiB3b3JsZE5vcm1hbC54LCB3b3JsZE5vcm1hbC55eiApO1xcblxcdFxcdFxcdCNpZmRlZiBURVhUVVJFX0xPRF9FWFRcXG5cXHRcXHRcXHRcXHR2ZWM0IGVudk1hcENvbG9yID0gdGV4dHVyZUN1YmVMb2RFWFQoIGVudk1hcCwgcXVlcnlWZWMsIGZsb2F0KCBtYXhNSVBMZXZlbCApICk7XFxuXFx0XFx0XFx0I2Vsc2VcXG5cXHRcXHRcXHRcXHR2ZWM0IGVudk1hcENvbG9yID0gdGV4dHVyZUN1YmUoIGVudk1hcCwgcXVlcnlWZWMsIGZsb2F0KCBtYXhNSVBMZXZlbCApICk7XFxuXFx0XFx0XFx0I2VuZGlmXFxuXFx0XFx0XFx0ZW52TWFwQ29sb3IucmdiID0gZW52TWFwVGV4ZWxUb0xpbmVhciggZW52TWFwQ29sb3IgKS5yZ2I7XFxuXFx0XFx0I2VsaWYgZGVmaW5lZCggRU5WTUFQX1RZUEVfQ1VCRV9VViApXFxuXFx0XFx0XFx0dmVjNCBlbnZNYXBDb2xvciA9IHRleHR1cmVDdWJlVVYoIGVudk1hcCwgd29ybGROb3JtYWwsIDEuMCApO1xcblxcdFxcdCNlbHNlXFxuXFx0XFx0XFx0dmVjNCBlbnZNYXBDb2xvciA9IHZlYzQoIDAuMCApO1xcblxcdFxcdCNlbmRpZlxcblxcdFxcdHJldHVybiBQSSAqIGVudk1hcENvbG9yLnJnYiAqIGVudk1hcEludGVuc2l0eTtcXG5cXHR9XFxuXFx0ZmxvYXQgZ2V0U3BlY3VsYXJNSVBMZXZlbCggY29uc3QgaW4gZmxvYXQgcm91Z2huZXNzLCBjb25zdCBpbiBpbnQgbWF4TUlQTGV2ZWwgKSB7XFxuXFx0XFx0ZmxvYXQgbWF4TUlQTGV2ZWxTY2FsYXIgPSBmbG9hdCggbWF4TUlQTGV2ZWwgKTtcXG5cXHRcXHRmbG9hdCBzaWdtYSA9IFBJICogcm91Z2huZXNzICogcm91Z2huZXNzIC8gKCAxLjAgKyByb3VnaG5lc3MgKTtcXG5cXHRcXHRmbG9hdCBkZXNpcmVkTUlQTGV2ZWwgPSBtYXhNSVBMZXZlbFNjYWxhciArIGxvZzIoIHNpZ21hICk7XFxuXFx0XFx0cmV0dXJuIGNsYW1wKCBkZXNpcmVkTUlQTGV2ZWwsIDAuMCwgbWF4TUlQTGV2ZWxTY2FsYXIgKTtcXG5cXHR9XFxuXFx0dmVjMyBnZXRMaWdodFByb2JlSW5kaXJlY3RSYWRpYW5jZSggY29uc3QgaW4gdmVjMyB2aWV3RGlyLCBjb25zdCBpbiB2ZWMzIG5vcm1hbCwgY29uc3QgaW4gZmxvYXQgcm91Z2huZXNzLCBjb25zdCBpbiBpbnQgbWF4TUlQTGV2ZWwgKSB7XFxuXFx0XFx0I2lmZGVmIEVOVk1BUF9NT0RFX1JFRkxFQ1RJT05cXG5cXHRcXHRcXHR2ZWMzIHJlZmxlY3RWZWMgPSByZWZsZWN0KCAtdmlld0Rpciwgbm9ybWFsICk7XFxuXFx0XFx0XFx0cmVmbGVjdFZlYyA9IG5vcm1hbGl6ZSggbWl4KCByZWZsZWN0VmVjLCBub3JtYWwsIHJvdWdobmVzcyAqIHJvdWdobmVzcykgKTtcXG5cXHRcXHQjZWxzZVxcblxcdFxcdFxcdHZlYzMgcmVmbGVjdFZlYyA9IHJlZnJhY3QoIC12aWV3RGlyLCBub3JtYWwsIHJlZnJhY3Rpb25SYXRpbyApO1xcblxcdFxcdCNlbmRpZlxcblxcdFxcdHJlZmxlY3RWZWMgPSBpbnZlcnNlVHJhbnNmb3JtRGlyZWN0aW9uKCByZWZsZWN0VmVjLCB2aWV3TWF0cml4ICk7XFxuXFx0XFx0ZmxvYXQgc3BlY3VsYXJNSVBMZXZlbCA9IGdldFNwZWN1bGFyTUlQTGV2ZWwoIHJvdWdobmVzcywgbWF4TUlQTGV2ZWwgKTtcXG5cXHRcXHQjaWZkZWYgRU5WTUFQX1RZUEVfQ1VCRVxcblxcdFxcdFxcdHZlYzMgcXVlcnlSZWZsZWN0VmVjID0gdmVjMyggZmxpcEVudk1hcCAqIHJlZmxlY3RWZWMueCwgcmVmbGVjdFZlYy55eiApO1xcblxcdFxcdFxcdCNpZmRlZiBURVhUVVJFX0xPRF9FWFRcXG5cXHRcXHRcXHRcXHR2ZWM0IGVudk1hcENvbG9yID0gdGV4dHVyZUN1YmVMb2RFWFQoIGVudk1hcCwgcXVlcnlSZWZsZWN0VmVjLCBzcGVjdWxhck1JUExldmVsICk7XFxuXFx0XFx0XFx0I2Vsc2VcXG5cXHRcXHRcXHRcXHR2ZWM0IGVudk1hcENvbG9yID0gdGV4dHVyZUN1YmUoIGVudk1hcCwgcXVlcnlSZWZsZWN0VmVjLCBzcGVjdWxhck1JUExldmVsICk7XFxuXFx0XFx0XFx0I2VuZGlmXFxuXFx0XFx0XFx0ZW52TWFwQ29sb3IucmdiID0gZW52TWFwVGV4ZWxUb0xpbmVhciggZW52TWFwQ29sb3IgKS5yZ2I7XFxuXFx0XFx0I2VsaWYgZGVmaW5lZCggRU5WTUFQX1RZUEVfQ1VCRV9VViApXFxuXFx0XFx0XFx0dmVjNCBlbnZNYXBDb2xvciA9IHRleHR1cmVDdWJlVVYoIGVudk1hcCwgcmVmbGVjdFZlYywgcm91Z2huZXNzICk7XFxuXFx0XFx0I2VuZGlmXFxuXFx0XFx0cmV0dXJuIGVudk1hcENvbG9yLnJnYiAqIGVudk1hcEludGVuc2l0eTtcXG5cXHR9XFxuI2VuZGlmXCIsZW52bWFwX3ZlcnRleDpcIiNpZmRlZiBVU0VfRU5WTUFQXFxuXFx0I2lmZGVmIEVOVl9XT1JMRFBPU1xcblxcdFxcdHZXb3JsZFBvc2l0aW9uID0gd29ybGRQb3NpdGlvbi54eXo7XFxuXFx0I2Vsc2VcXG5cXHRcXHR2ZWMzIGNhbWVyYVRvVmVydGV4O1xcblxcdFxcdGlmICggaXNPcnRob2dyYXBoaWMgKSB7XFxuXFx0XFx0XFx0Y2FtZXJhVG9WZXJ0ZXggPSBub3JtYWxpemUoIHZlYzMoIC0gdmlld01hdHJpeFsgMCBdWyAyIF0sIC0gdmlld01hdHJpeFsgMSBdWyAyIF0sIC0gdmlld01hdHJpeFsgMiBdWyAyIF0gKSApO1xcblxcdFxcdH0gZWxzZSB7XFxuXFx0XFx0XFx0Y2FtZXJhVG9WZXJ0ZXggPSBub3JtYWxpemUoIHdvcmxkUG9zaXRpb24ueHl6IC0gY2FtZXJhUG9zaXRpb24gKTtcXG5cXHRcXHR9XFxuXFx0XFx0dmVjMyB3b3JsZE5vcm1hbCA9IGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIHRyYW5zZm9ybWVkTm9ybWFsLCB2aWV3TWF0cml4ICk7XFxuXFx0XFx0I2lmZGVmIEVOVk1BUF9NT0RFX1JFRkxFQ1RJT05cXG5cXHRcXHRcXHR2UmVmbGVjdCA9IHJlZmxlY3QoIGNhbWVyYVRvVmVydGV4LCB3b3JsZE5vcm1hbCApO1xcblxcdFxcdCNlbHNlXFxuXFx0XFx0XFx0dlJlZmxlY3QgPSByZWZyYWN0KCBjYW1lcmFUb1ZlcnRleCwgd29ybGROb3JtYWwsIHJlZnJhY3Rpb25SYXRpbyApO1xcblxcdFxcdCNlbmRpZlxcblxcdCNlbmRpZlxcbiNlbmRpZlwiLGZvZ192ZXJ0ZXg6XCIjaWZkZWYgVVNFX0ZPR1xcblxcdGZvZ0RlcHRoID0gLSBtdlBvc2l0aW9uLno7XFxuI2VuZGlmXCIsZm9nX3BhcnNfdmVydGV4OlwiI2lmZGVmIFVTRV9GT0dcXG5cXHR2YXJ5aW5nIGZsb2F0IGZvZ0RlcHRoO1xcbiNlbmRpZlwiLGZvZ19mcmFnbWVudDpcIiNpZmRlZiBVU0VfRk9HXFxuXFx0I2lmZGVmIEZPR19FWFAyXFxuXFx0XFx0ZmxvYXQgZm9nRmFjdG9yID0gMS4wIC0gZXhwKCAtIGZvZ0RlbnNpdHkgKiBmb2dEZW5zaXR5ICogZm9nRGVwdGggKiBmb2dEZXB0aCApO1xcblxcdCNlbHNlXFxuXFx0XFx0ZmxvYXQgZm9nRmFjdG9yID0gc21vb3Roc3RlcCggZm9nTmVhciwgZm9nRmFyLCBmb2dEZXB0aCApO1xcblxcdCNlbmRpZlxcblxcdGdsX0ZyYWdDb2xvci5yZ2IgPSBtaXgoIGdsX0ZyYWdDb2xvci5yZ2IsIGZvZ0NvbG9yLCBmb2dGYWN0b3IgKTtcXG4jZW5kaWZcIixmb2dfcGFyc19mcmFnbWVudDpcIiNpZmRlZiBVU0VfRk9HXFxuXFx0dW5pZm9ybSB2ZWMzIGZvZ0NvbG9yO1xcblxcdHZhcnlpbmcgZmxvYXQgZm9nRGVwdGg7XFxuXFx0I2lmZGVmIEZPR19FWFAyXFxuXFx0XFx0dW5pZm9ybSBmbG9hdCBmb2dEZW5zaXR5O1xcblxcdCNlbHNlXFxuXFx0XFx0dW5pZm9ybSBmbG9hdCBmb2dOZWFyO1xcblxcdFxcdHVuaWZvcm0gZmxvYXQgZm9nRmFyO1xcblxcdCNlbmRpZlxcbiNlbmRpZlwiLGdyYWRpZW50bWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0dSQURJRU5UTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgZ3JhZGllbnRNYXA7XFxuI2VuZGlmXFxudmVjMyBnZXRHcmFkaWVudElycmFkaWFuY2UoIHZlYzMgbm9ybWFsLCB2ZWMzIGxpZ2h0RGlyZWN0aW9uICkge1xcblxcdGZsb2F0IGRvdE5MID0gZG90KCBub3JtYWwsIGxpZ2h0RGlyZWN0aW9uICk7XFxuXFx0dmVjMiBjb29yZCA9IHZlYzIoIGRvdE5MICogMC41ICsgMC41LCAwLjAgKTtcXG5cXHQjaWZkZWYgVVNFX0dSQURJRU5UTUFQXFxuXFx0XFx0cmV0dXJuIHRleHR1cmUyRCggZ3JhZGllbnRNYXAsIGNvb3JkICkucmdiO1xcblxcdCNlbHNlXFxuXFx0XFx0cmV0dXJuICggY29vcmQueCA8IDAuNyApID8gdmVjMyggMC43ICkgOiB2ZWMzKCAxLjAgKTtcXG5cXHQjZW5kaWZcXG59XCIsbGlnaHRtYXBfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX0xJR0hUTUFQXFxuXFx0dmVjNCBsaWdodE1hcFRleGVsPSB0ZXh0dXJlMkQoIGxpZ2h0TWFwLCB2VXYyICk7XFxuXFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICs9IFBJICogbGlnaHRNYXBUZXhlbFRvTGluZWFyKCBsaWdodE1hcFRleGVsICkucmdiICogbGlnaHRNYXBJbnRlbnNpdHk7XFxuI2VuZGlmXCIsbGlnaHRtYXBfcGFyc19mcmFnbWVudDpcIiNpZmRlZiBVU0VfTElHSFRNQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCBsaWdodE1hcDtcXG5cXHR1bmlmb3JtIGZsb2F0IGxpZ2h0TWFwSW50ZW5zaXR5O1xcbiNlbmRpZlwiLGxpZ2h0c19sYW1iZXJ0X3ZlcnRleDpcInZlYzMgZGlmZnVzZSA9IHZlYzMoIDEuMCApO1xcbkdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnk7XFxuZ2VvbWV0cnkucG9zaXRpb24gPSBtdlBvc2l0aW9uLnh5ejtcXG5nZW9tZXRyeS5ub3JtYWwgPSBub3JtYWxpemUoIHRyYW5zZm9ybWVkTm9ybWFsICk7XFxuZ2VvbWV0cnkudmlld0RpciA9ICggaXNPcnRob2dyYXBoaWMgKSA/IHZlYzMoIDAsIDAsIDEgKSA6IG5vcm1hbGl6ZSggLW12UG9zaXRpb24ueHl6ICk7XFxuR2VvbWV0cmljQ29udGV4dCBiYWNrR2VvbWV0cnk7XFxuYmFja0dlb21ldHJ5LnBvc2l0aW9uID0gZ2VvbWV0cnkucG9zaXRpb247XFxuYmFja0dlb21ldHJ5Lm5vcm1hbCA9IC1nZW9tZXRyeS5ub3JtYWw7XFxuYmFja0dlb21ldHJ5LnZpZXdEaXIgPSBnZW9tZXRyeS52aWV3RGlyO1xcbnZMaWdodEZyb250ID0gdmVjMyggMC4wICk7XFxudkluZGlyZWN0RnJvbnQgPSB2ZWMzKCAwLjAgKTtcXG4jaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0dkxpZ2h0QmFjayA9IHZlYzMoIDAuMCApO1xcblxcdHZJbmRpcmVjdEJhY2sgPSB2ZWMzKCAwLjAgKTtcXG4jZW5kaWZcXG5JbmNpZGVudExpZ2h0IGRpcmVjdExpZ2h0O1xcbmZsb2F0IGRvdE5MO1xcbnZlYzMgZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlO1xcbnZJbmRpcmVjdEZyb250ICs9IGdldEFtYmllbnRMaWdodElycmFkaWFuY2UoIGFtYmllbnRMaWdodENvbG9yICk7XFxudkluZGlyZWN0RnJvbnQgKz0gZ2V0TGlnaHRQcm9iZUlycmFkaWFuY2UoIGxpZ2h0UHJvYmUsIGdlb21ldHJ5ICk7XFxuI2lmZGVmIERPVUJMRV9TSURFRFxcblxcdHZJbmRpcmVjdEJhY2sgKz0gZ2V0QW1iaWVudExpZ2h0SXJyYWRpYW5jZSggYW1iaWVudExpZ2h0Q29sb3IgKTtcXG5cXHR2SW5kaXJlY3RCYWNrICs9IGdldExpZ2h0UHJvYmVJcnJhZGlhbmNlKCBsaWdodFByb2JlLCBiYWNrR2VvbWV0cnkgKTtcXG4jZW5kaWZcXG4jaWYgTlVNX1BPSU5UX0xJR0hUUyA+IDBcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX1BPSU5UX0xJR0hUUzsgaSArKyApIHtcXG5cXHRcXHRnZXRQb2ludERpcmVjdExpZ2h0SXJyYWRpYW5jZSggcG9pbnRMaWdodHNbIGkgXSwgZ2VvbWV0cnksIGRpcmVjdExpZ2h0ICk7XFxuXFx0XFx0ZG90TkwgPSBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICk7XFxuXFx0XFx0ZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlID0gUEkgKiBkaXJlY3RMaWdodC5jb2xvcjtcXG5cXHRcXHR2TGlnaHRGcm9udCArPSBzYXR1cmF0ZSggZG90TkwgKSAqIGRpcmVjdExpZ2h0Q29sb3JfRGlmZnVzZTtcXG5cXHRcXHQjaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0XFx0XFx0dkxpZ2h0QmFjayArPSBzYXR1cmF0ZSggLWRvdE5MICkgKiBkaXJlY3RMaWdodENvbG9yX0RpZmZ1c2U7XFxuXFx0XFx0I2VuZGlmXFxuXFx0fVxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXFxuI2VuZGlmXFxuI2lmIE5VTV9TUE9UX0xJR0hUUyA+IDBcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX1NQT1RfTElHSFRTOyBpICsrICkge1xcblxcdFxcdGdldFNwb3REaXJlY3RMaWdodElycmFkaWFuY2UoIHNwb3RMaWdodHNbIGkgXSwgZ2VvbWV0cnksIGRpcmVjdExpZ2h0ICk7XFxuXFx0XFx0ZG90TkwgPSBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICk7XFxuXFx0XFx0ZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlID0gUEkgKiBkaXJlY3RMaWdodC5jb2xvcjtcXG5cXHRcXHR2TGlnaHRGcm9udCArPSBzYXR1cmF0ZSggZG90TkwgKSAqIGRpcmVjdExpZ2h0Q29sb3JfRGlmZnVzZTtcXG5cXHRcXHQjaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0XFx0XFx0dkxpZ2h0QmFjayArPSBzYXR1cmF0ZSggLWRvdE5MICkgKiBkaXJlY3RMaWdodENvbG9yX0RpZmZ1c2U7XFxuXFx0XFx0I2VuZGlmXFxuXFx0fVxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXFxuI2VuZGlmXFxuI2lmIE5VTV9ESVJfTElHSFRTID4gMFxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcXG5cXHRmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fRElSX0xJR0hUUzsgaSArKyApIHtcXG5cXHRcXHRnZXREaXJlY3Rpb25hbERpcmVjdExpZ2h0SXJyYWRpYW5jZSggZGlyZWN0aW9uYWxMaWdodHNbIGkgXSwgZ2VvbWV0cnksIGRpcmVjdExpZ2h0ICk7XFxuXFx0XFx0ZG90TkwgPSBkb3QoIGdlb21ldHJ5Lm5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICk7XFxuXFx0XFx0ZGlyZWN0TGlnaHRDb2xvcl9EaWZmdXNlID0gUEkgKiBkaXJlY3RMaWdodC5jb2xvcjtcXG5cXHRcXHR2TGlnaHRGcm9udCArPSBzYXR1cmF0ZSggZG90TkwgKSAqIGRpcmVjdExpZ2h0Q29sb3JfRGlmZnVzZTtcXG5cXHRcXHQjaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0XFx0XFx0dkxpZ2h0QmFjayArPSBzYXR1cmF0ZSggLWRvdE5MICkgKiBkaXJlY3RMaWdodENvbG9yX0RpZmZ1c2U7XFxuXFx0XFx0I2VuZGlmXFxuXFx0fVxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXFxuI2VuZGlmXFxuI2lmIE5VTV9IRU1JX0xJR0hUUyA+IDBcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0hFTUlfTElHSFRTOyBpICsrICkge1xcblxcdFxcdHZJbmRpcmVjdEZyb250ICs9IGdldEhlbWlzcGhlcmVMaWdodElycmFkaWFuY2UoIGhlbWlzcGhlcmVMaWdodHNbIGkgXSwgZ2VvbWV0cnkgKTtcXG5cXHRcXHQjaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0XFx0XFx0dkluZGlyZWN0QmFjayArPSBnZXRIZW1pc3BoZXJlTGlnaHRJcnJhZGlhbmNlKCBoZW1pc3BoZXJlTGlnaHRzWyBpIF0sIGJhY2tHZW9tZXRyeSApO1xcblxcdFxcdCNlbmRpZlxcblxcdH1cXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxcbiNlbmRpZlwiLGxpZ2h0c19wYXJzX2JlZ2luOlwidW5pZm9ybSBib29sIHJlY2VpdmVTaGFkb3c7XFxudW5pZm9ybSB2ZWMzIGFtYmllbnRMaWdodENvbG9yO1xcbnVuaWZvcm0gdmVjMyBsaWdodFByb2JlWyA5IF07XFxudmVjMyBzaEdldElycmFkaWFuY2VBdCggaW4gdmVjMyBub3JtYWwsIGluIHZlYzMgc2hDb2VmZmljaWVudHNbIDkgXSApIHtcXG5cXHRmbG9hdCB4ID0gbm9ybWFsLngsIHkgPSBub3JtYWwueSwgeiA9IG5vcm1hbC56O1xcblxcdHZlYzMgcmVzdWx0ID0gc2hDb2VmZmljaWVudHNbIDAgXSAqIDAuODg2MjI3O1xcblxcdHJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgMSBdICogMi4wICogMC41MTE2NjQgKiB5O1xcblxcdHJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgMiBdICogMi4wICogMC41MTE2NjQgKiB6O1xcblxcdHJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgMyBdICogMi4wICogMC41MTE2NjQgKiB4O1xcblxcdHJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgNCBdICogMi4wICogMC40MjkwNDMgKiB4ICogeTtcXG5cXHRyZXN1bHQgKz0gc2hDb2VmZmljaWVudHNbIDUgXSAqIDIuMCAqIDAuNDI5MDQzICogeSAqIHo7XFxuXFx0cmVzdWx0ICs9IHNoQ29lZmZpY2llbnRzWyA2IF0gKiAoIDAuNzQzMTI1ICogeiAqIHogLSAwLjI0NzcwOCApO1xcblxcdHJlc3VsdCArPSBzaENvZWZmaWNpZW50c1sgNyBdICogMi4wICogMC40MjkwNDMgKiB4ICogejtcXG5cXHRyZXN1bHQgKz0gc2hDb2VmZmljaWVudHNbIDggXSAqIDAuNDI5MDQzICogKCB4ICogeCAtIHkgKiB5ICk7XFxuXFx0cmV0dXJuIHJlc3VsdDtcXG59XFxudmVjMyBnZXRMaWdodFByb2JlSXJyYWRpYW5jZSggY29uc3QgaW4gdmVjMyBsaWdodFByb2JlWyA5IF0sIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnkgKSB7XFxuXFx0dmVjMyB3b3JsZE5vcm1hbCA9IGludmVyc2VUcmFuc2Zvcm1EaXJlY3Rpb24oIGdlb21ldHJ5Lm5vcm1hbCwgdmlld01hdHJpeCApO1xcblxcdHZlYzMgaXJyYWRpYW5jZSA9IHNoR2V0SXJyYWRpYW5jZUF0KCB3b3JsZE5vcm1hbCwgbGlnaHRQcm9iZSApO1xcblxcdHJldHVybiBpcnJhZGlhbmNlO1xcbn1cXG52ZWMzIGdldEFtYmllbnRMaWdodElycmFkaWFuY2UoIGNvbnN0IGluIHZlYzMgYW1iaWVudExpZ2h0Q29sb3IgKSB7XFxuXFx0dmVjMyBpcnJhZGlhbmNlID0gYW1iaWVudExpZ2h0Q29sb3I7XFxuXFx0I2lmbmRlZiBQSFlTSUNBTExZX0NPUlJFQ1RfTElHSFRTXFxuXFx0XFx0aXJyYWRpYW5jZSAqPSBQSTtcXG5cXHQjZW5kaWZcXG5cXHRyZXR1cm4gaXJyYWRpYW5jZTtcXG59XFxuI2lmIE5VTV9ESVJfTElHSFRTID4gMFxcblxcdHN0cnVjdCBEaXJlY3Rpb25hbExpZ2h0IHtcXG5cXHRcXHR2ZWMzIGRpcmVjdGlvbjtcXG5cXHRcXHR2ZWMzIGNvbG9yO1xcblxcdH07XFxuXFx0dW5pZm9ybSBEaXJlY3Rpb25hbExpZ2h0IGRpcmVjdGlvbmFsTGlnaHRzWyBOVU1fRElSX0xJR0hUUyBdO1xcblxcdHZvaWQgZ2V0RGlyZWN0aW9uYWxEaXJlY3RMaWdodElycmFkaWFuY2UoIGNvbnN0IGluIERpcmVjdGlvbmFsTGlnaHQgZGlyZWN0aW9uYWxMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgb3V0IEluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQgKSB7XFxuXFx0XFx0ZGlyZWN0TGlnaHQuY29sb3IgPSBkaXJlY3Rpb25hbExpZ2h0LmNvbG9yO1xcblxcdFxcdGRpcmVjdExpZ2h0LmRpcmVjdGlvbiA9IGRpcmVjdGlvbmFsTGlnaHQuZGlyZWN0aW9uO1xcblxcdFxcdGRpcmVjdExpZ2h0LnZpc2libGUgPSB0cnVlO1xcblxcdH1cXG4jZW5kaWZcXG4jaWYgTlVNX1BPSU5UX0xJR0hUUyA+IDBcXG5cXHRzdHJ1Y3QgUG9pbnRMaWdodCB7XFxuXFx0XFx0dmVjMyBwb3NpdGlvbjtcXG5cXHRcXHR2ZWMzIGNvbG9yO1xcblxcdFxcdGZsb2F0IGRpc3RhbmNlO1xcblxcdFxcdGZsb2F0IGRlY2F5O1xcblxcdH07XFxuXFx0dW5pZm9ybSBQb2ludExpZ2h0IHBvaW50TGlnaHRzWyBOVU1fUE9JTlRfTElHSFRTIF07XFxuXFx0dm9pZCBnZXRQb2ludERpcmVjdExpZ2h0SXJyYWRpYW5jZSggY29uc3QgaW4gUG9pbnRMaWdodCBwb2ludExpZ2h0LCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBvdXQgSW5jaWRlbnRMaWdodCBkaXJlY3RMaWdodCApIHtcXG5cXHRcXHR2ZWMzIGxWZWN0b3IgPSBwb2ludExpZ2h0LnBvc2l0aW9uIC0gZ2VvbWV0cnkucG9zaXRpb247XFxuXFx0XFx0ZGlyZWN0TGlnaHQuZGlyZWN0aW9uID0gbm9ybWFsaXplKCBsVmVjdG9yICk7XFxuXFx0XFx0ZmxvYXQgbGlnaHREaXN0YW5jZSA9IGxlbmd0aCggbFZlY3RvciApO1xcblxcdFxcdGRpcmVjdExpZ2h0LmNvbG9yID0gcG9pbnRMaWdodC5jb2xvcjtcXG5cXHRcXHRkaXJlY3RMaWdodC5jb2xvciAqPSBwdW5jdHVhbExpZ2h0SW50ZW5zaXR5VG9JcnJhZGlhbmNlRmFjdG9yKCBsaWdodERpc3RhbmNlLCBwb2ludExpZ2h0LmRpc3RhbmNlLCBwb2ludExpZ2h0LmRlY2F5ICk7XFxuXFx0XFx0ZGlyZWN0TGlnaHQudmlzaWJsZSA9ICggZGlyZWN0TGlnaHQuY29sb3IgIT0gdmVjMyggMC4wICkgKTtcXG5cXHR9XFxuI2VuZGlmXFxuI2lmIE5VTV9TUE9UX0xJR0hUUyA+IDBcXG5cXHRzdHJ1Y3QgU3BvdExpZ2h0IHtcXG5cXHRcXHR2ZWMzIHBvc2l0aW9uO1xcblxcdFxcdHZlYzMgZGlyZWN0aW9uO1xcblxcdFxcdHZlYzMgY29sb3I7XFxuXFx0XFx0ZmxvYXQgZGlzdGFuY2U7XFxuXFx0XFx0ZmxvYXQgZGVjYXk7XFxuXFx0XFx0ZmxvYXQgY29uZUNvcztcXG5cXHRcXHRmbG9hdCBwZW51bWJyYUNvcztcXG5cXHR9O1xcblxcdHVuaWZvcm0gU3BvdExpZ2h0IHNwb3RMaWdodHNbIE5VTV9TUE9UX0xJR0hUUyBdO1xcblxcdHZvaWQgZ2V0U3BvdERpcmVjdExpZ2h0SXJyYWRpYW5jZSggY29uc3QgaW4gU3BvdExpZ2h0IHNwb3RMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgb3V0IEluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQgKSB7XFxuXFx0XFx0dmVjMyBsVmVjdG9yID0gc3BvdExpZ2h0LnBvc2l0aW9uIC0gZ2VvbWV0cnkucG9zaXRpb247XFxuXFx0XFx0ZGlyZWN0TGlnaHQuZGlyZWN0aW9uID0gbm9ybWFsaXplKCBsVmVjdG9yICk7XFxuXFx0XFx0ZmxvYXQgbGlnaHREaXN0YW5jZSA9IGxlbmd0aCggbFZlY3RvciApO1xcblxcdFxcdGZsb2F0IGFuZ2xlQ29zID0gZG90KCBkaXJlY3RMaWdodC5kaXJlY3Rpb24sIHNwb3RMaWdodC5kaXJlY3Rpb24gKTtcXG5cXHRcXHRpZiAoIGFuZ2xlQ29zID4gc3BvdExpZ2h0LmNvbmVDb3MgKSB7XFxuXFx0XFx0XFx0ZmxvYXQgc3BvdEVmZmVjdCA9IHNtb290aHN0ZXAoIHNwb3RMaWdodC5jb25lQ29zLCBzcG90TGlnaHQucGVudW1icmFDb3MsIGFuZ2xlQ29zICk7XFxuXFx0XFx0XFx0ZGlyZWN0TGlnaHQuY29sb3IgPSBzcG90TGlnaHQuY29sb3I7XFxuXFx0XFx0XFx0ZGlyZWN0TGlnaHQuY29sb3IgKj0gc3BvdEVmZmVjdCAqIHB1bmN0dWFsTGlnaHRJbnRlbnNpdHlUb0lycmFkaWFuY2VGYWN0b3IoIGxpZ2h0RGlzdGFuY2UsIHNwb3RMaWdodC5kaXN0YW5jZSwgc3BvdExpZ2h0LmRlY2F5ICk7XFxuXFx0XFx0XFx0ZGlyZWN0TGlnaHQudmlzaWJsZSA9IHRydWU7XFxuXFx0XFx0fSBlbHNlIHtcXG5cXHRcXHRcXHRkaXJlY3RMaWdodC5jb2xvciA9IHZlYzMoIDAuMCApO1xcblxcdFxcdFxcdGRpcmVjdExpZ2h0LnZpc2libGUgPSBmYWxzZTtcXG5cXHRcXHR9XFxuXFx0fVxcbiNlbmRpZlxcbiNpZiBOVU1fUkVDVF9BUkVBX0xJR0hUUyA+IDBcXG5cXHRzdHJ1Y3QgUmVjdEFyZWFMaWdodCB7XFxuXFx0XFx0dmVjMyBjb2xvcjtcXG5cXHRcXHR2ZWMzIHBvc2l0aW9uO1xcblxcdFxcdHZlYzMgaGFsZldpZHRoO1xcblxcdFxcdHZlYzMgaGFsZkhlaWdodDtcXG5cXHR9O1xcblxcdHVuaWZvcm0gc2FtcGxlcjJEIGx0Y18xO1xcdHVuaWZvcm0gc2FtcGxlcjJEIGx0Y18yO1xcblxcdHVuaWZvcm0gUmVjdEFyZWFMaWdodCByZWN0QXJlYUxpZ2h0c1sgTlVNX1JFQ1RfQVJFQV9MSUdIVFMgXTtcXG4jZW5kaWZcXG4jaWYgTlVNX0hFTUlfTElHSFRTID4gMFxcblxcdHN0cnVjdCBIZW1pc3BoZXJlTGlnaHQge1xcblxcdFxcdHZlYzMgZGlyZWN0aW9uO1xcblxcdFxcdHZlYzMgc2t5Q29sb3I7XFxuXFx0XFx0dmVjMyBncm91bmRDb2xvcjtcXG5cXHR9O1xcblxcdHVuaWZvcm0gSGVtaXNwaGVyZUxpZ2h0IGhlbWlzcGhlcmVMaWdodHNbIE5VTV9IRU1JX0xJR0hUUyBdO1xcblxcdHZlYzMgZ2V0SGVtaXNwaGVyZUxpZ2h0SXJyYWRpYW5jZSggY29uc3QgaW4gSGVtaXNwaGVyZUxpZ2h0IGhlbWlMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSApIHtcXG5cXHRcXHRmbG9hdCBkb3ROTCA9IGRvdCggZ2VvbWV0cnkubm9ybWFsLCBoZW1pTGlnaHQuZGlyZWN0aW9uICk7XFxuXFx0XFx0ZmxvYXQgaGVtaURpZmZ1c2VXZWlnaHQgPSAwLjUgKiBkb3ROTCArIDAuNTtcXG5cXHRcXHR2ZWMzIGlycmFkaWFuY2UgPSBtaXgoIGhlbWlMaWdodC5ncm91bmRDb2xvciwgaGVtaUxpZ2h0LnNreUNvbG9yLCBoZW1pRGlmZnVzZVdlaWdodCApO1xcblxcdFxcdCNpZm5kZWYgUEhZU0lDQUxMWV9DT1JSRUNUX0xJR0hUU1xcblxcdFxcdFxcdGlycmFkaWFuY2UgKj0gUEk7XFxuXFx0XFx0I2VuZGlmXFxuXFx0XFx0cmV0dXJuIGlycmFkaWFuY2U7XFxuXFx0fVxcbiNlbmRpZlwiLGxpZ2h0c190b29uX2ZyYWdtZW50OlwiVG9vbk1hdGVyaWFsIG1hdGVyaWFsO1xcbm1hdGVyaWFsLmRpZmZ1c2VDb2xvciA9IGRpZmZ1c2VDb2xvci5yZ2I7XCIsbGlnaHRzX3Rvb25fcGFyc19mcmFnbWVudDpcInZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xcbiNpZm5kZWYgRkxBVF9TSEFERURcXG5cXHR2YXJ5aW5nIHZlYzMgdk5vcm1hbDtcXG4jZW5kaWZcXG5zdHJ1Y3QgVG9vbk1hdGVyaWFsIHtcXG5cXHR2ZWMzIGRpZmZ1c2VDb2xvcjtcXG59O1xcbnZvaWQgUkVfRGlyZWN0X1Rvb24oIGNvbnN0IGluIEluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIFRvb25NYXRlcmlhbCBtYXRlcmlhbCwgaW5vdXQgUmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQgKSB7XFxuXFx0dmVjMyBpcnJhZGlhbmNlID0gZ2V0R3JhZGllbnRJcnJhZGlhbmNlKCBnZW9tZXRyeS5ub3JtYWwsIGRpcmVjdExpZ2h0LmRpcmVjdGlvbiApICogZGlyZWN0TGlnaHQuY29sb3I7XFxuXFx0I2lmbmRlZiBQSFlTSUNBTExZX0NPUlJFQ1RfTElHSFRTXFxuXFx0XFx0aXJyYWRpYW5jZSAqPSBQSTtcXG5cXHQjZW5kaWZcXG5cXHRyZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICs9IGlycmFkaWFuY2UgKiBCUkRGX0RpZmZ1c2VfTGFtYmVydCggbWF0ZXJpYWwuZGlmZnVzZUNvbG9yICk7XFxufVxcbnZvaWQgUkVfSW5kaXJlY3REaWZmdXNlX1Rvb24oIGNvbnN0IGluIHZlYzMgaXJyYWRpYW5jZSwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgY29uc3QgaW4gVG9vbk1hdGVyaWFsIG1hdGVyaWFsLCBpbm91dCBSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCApIHtcXG5cXHRyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKz0gaXJyYWRpYW5jZSAqIEJSREZfRGlmZnVzZV9MYW1iZXJ0KCBtYXRlcmlhbC5kaWZmdXNlQ29sb3IgKTtcXG59XFxuI2RlZmluZSBSRV9EaXJlY3RcXHRcXHRcXHRcXHRSRV9EaXJlY3RfVG9vblxcbiNkZWZpbmUgUkVfSW5kaXJlY3REaWZmdXNlXFx0XFx0UkVfSW5kaXJlY3REaWZmdXNlX1Rvb25cXG4jZGVmaW5lIE1hdGVyaWFsX0xpZ2h0UHJvYmVMT0QoIG1hdGVyaWFsIClcXHQoMClcIixsaWdodHNfcGhvbmdfZnJhZ21lbnQ6XCJCbGlublBob25nTWF0ZXJpYWwgbWF0ZXJpYWw7XFxubWF0ZXJpYWwuZGlmZnVzZUNvbG9yID0gZGlmZnVzZUNvbG9yLnJnYjtcXG5tYXRlcmlhbC5zcGVjdWxhckNvbG9yID0gc3BlY3VsYXI7XFxubWF0ZXJpYWwuc3BlY3VsYXJTaGluaW5lc3MgPSBzaGluaW5lc3M7XFxubWF0ZXJpYWwuc3BlY3VsYXJTdHJlbmd0aCA9IHNwZWN1bGFyU3RyZW5ndGg7XCIsbGlnaHRzX3Bob25nX3BhcnNfZnJhZ21lbnQ6XCJ2YXJ5aW5nIHZlYzMgdlZpZXdQb3NpdGlvbjtcXG4jaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0dmFyeWluZyB2ZWMzIHZOb3JtYWw7XFxuI2VuZGlmXFxuc3RydWN0IEJsaW5uUGhvbmdNYXRlcmlhbCB7XFxuXFx0dmVjMyBkaWZmdXNlQ29sb3I7XFxuXFx0dmVjMyBzcGVjdWxhckNvbG9yO1xcblxcdGZsb2F0IHNwZWN1bGFyU2hpbmluZXNzO1xcblxcdGZsb2F0IHNwZWN1bGFyU3RyZW5ndGg7XFxufTtcXG52b2lkIFJFX0RpcmVjdF9CbGlublBob25nKCBjb25zdCBpbiBJbmNpZGVudExpZ2h0IGRpcmVjdExpZ2h0LCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBCbGlublBob25nTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xcblxcdGZsb2F0IGRvdE5MID0gc2F0dXJhdGUoIGRvdCggZ2VvbWV0cnkubm9ybWFsLCBkaXJlY3RMaWdodC5kaXJlY3Rpb24gKSApO1xcblxcdHZlYzMgaXJyYWRpYW5jZSA9IGRvdE5MICogZGlyZWN0TGlnaHQuY29sb3I7XFxuXFx0I2lmbmRlZiBQSFlTSUNBTExZX0NPUlJFQ1RfTElHSFRTXFxuXFx0XFx0aXJyYWRpYW5jZSAqPSBQSTtcXG5cXHQjZW5kaWZcXG5cXHRyZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICs9IGlycmFkaWFuY2UgKiBCUkRGX0RpZmZ1c2VfTGFtYmVydCggbWF0ZXJpYWwuZGlmZnVzZUNvbG9yICk7XFxuXFx0cmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgKz0gaXJyYWRpYW5jZSAqIEJSREZfU3BlY3VsYXJfQmxpbm5QaG9uZyggZGlyZWN0TGlnaHQsIGdlb21ldHJ5LCBtYXRlcmlhbC5zcGVjdWxhckNvbG9yLCBtYXRlcmlhbC5zcGVjdWxhclNoaW5pbmVzcyApICogbWF0ZXJpYWwuc3BlY3VsYXJTdHJlbmd0aDtcXG59XFxudm9pZCBSRV9JbmRpcmVjdERpZmZ1c2VfQmxpbm5QaG9uZyggY29uc3QgaW4gdmVjMyBpcnJhZGlhbmNlLCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBCbGlublBob25nTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xcblxcdHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSBpcnJhZGlhbmNlICogQlJERl9EaWZmdXNlX0xhbWJlcnQoIG1hdGVyaWFsLmRpZmZ1c2VDb2xvciApO1xcbn1cXG4jZGVmaW5lIFJFX0RpcmVjdFxcdFxcdFxcdFxcdFJFX0RpcmVjdF9CbGlublBob25nXFxuI2RlZmluZSBSRV9JbmRpcmVjdERpZmZ1c2VcXHRcXHRSRV9JbmRpcmVjdERpZmZ1c2VfQmxpbm5QaG9uZ1xcbiNkZWZpbmUgTWF0ZXJpYWxfTGlnaHRQcm9iZUxPRCggbWF0ZXJpYWwgKVxcdCgwKVwiLGxpZ2h0c19waHlzaWNhbF9mcmFnbWVudDpcIlBoeXNpY2FsTWF0ZXJpYWwgbWF0ZXJpYWw7XFxubWF0ZXJpYWwuZGlmZnVzZUNvbG9yID0gZGlmZnVzZUNvbG9yLnJnYiAqICggMS4wIC0gbWV0YWxuZXNzRmFjdG9yICk7XFxudmVjMyBkeHkgPSBtYXgoIGFicyggZEZkeCggZ2VvbWV0cnlOb3JtYWwgKSApLCBhYnMoIGRGZHkoIGdlb21ldHJ5Tm9ybWFsICkgKSApO1xcbmZsb2F0IGdlb21ldHJ5Um91Z2huZXNzID0gbWF4KCBtYXgoIGR4eS54LCBkeHkueSApLCBkeHkueiApO1xcbm1hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzID0gbWF4KCByb3VnaG5lc3NGYWN0b3IsIDAuMDUyNSApO21hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzICs9IGdlb21ldHJ5Um91Z2huZXNzO1xcbm1hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzID0gbWluKCBtYXRlcmlhbC5zcGVjdWxhclJvdWdobmVzcywgMS4wICk7XFxuI2lmZGVmIFJFRkxFQ1RJVklUWVxcblxcdG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgPSBtaXgoIHZlYzMoIE1BWElNVU1fU1BFQ1VMQVJfQ09FRkZJQ0lFTlQgKiBwb3cyKCByZWZsZWN0aXZpdHkgKSApLCBkaWZmdXNlQ29sb3IucmdiLCBtZXRhbG5lc3NGYWN0b3IgKTtcXG4jZWxzZVxcblxcdG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgPSBtaXgoIHZlYzMoIERFRkFVTFRfU1BFQ1VMQVJfQ09FRkZJQ0lFTlQgKSwgZGlmZnVzZUNvbG9yLnJnYiwgbWV0YWxuZXNzRmFjdG9yICk7XFxuI2VuZGlmXFxuI2lmZGVmIENMRUFSQ09BVFxcblxcdG1hdGVyaWFsLmNsZWFyY29hdCA9IGNsZWFyY29hdDtcXG5cXHRtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MgPSBjbGVhcmNvYXRSb3VnaG5lc3M7XFxuXFx0I2lmZGVmIFVTRV9DTEVBUkNPQVRNQVBcXG5cXHRcXHRtYXRlcmlhbC5jbGVhcmNvYXQgKj0gdGV4dHVyZTJEKCBjbGVhcmNvYXRNYXAsIHZVdiApLng7XFxuXFx0I2VuZGlmXFxuXFx0I2lmZGVmIFVTRV9DTEVBUkNPQVRfUk9VR0hORVNTTUFQXFxuXFx0XFx0bWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzICo9IHRleHR1cmUyRCggY2xlYXJjb2F0Um91Z2huZXNzTWFwLCB2VXYgKS55O1xcblxcdCNlbmRpZlxcblxcdG1hdGVyaWFsLmNsZWFyY29hdCA9IHNhdHVyYXRlKCBtYXRlcmlhbC5jbGVhcmNvYXQgKTtcXHRtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MgPSBtYXgoIG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcywgMC4wNTI1ICk7XFxuXFx0bWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzICs9IGdlb21ldHJ5Um91Z2huZXNzO1xcblxcdG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcyA9IG1pbiggbWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzLCAxLjAgKTtcXG4jZW5kaWZcXG4jaWZkZWYgVVNFX1NIRUVOXFxuXFx0bWF0ZXJpYWwuc2hlZW5Db2xvciA9IHNoZWVuO1xcbiNlbmRpZlwiLGxpZ2h0c19waHlzaWNhbF9wYXJzX2ZyYWdtZW50Olwic3RydWN0IFBoeXNpY2FsTWF0ZXJpYWwge1xcblxcdHZlYzMgZGlmZnVzZUNvbG9yO1xcblxcdGZsb2F0IHNwZWN1bGFyUm91Z2huZXNzO1xcblxcdHZlYzMgc3BlY3VsYXJDb2xvcjtcXG4jaWZkZWYgQ0xFQVJDT0FUXFxuXFx0ZmxvYXQgY2xlYXJjb2F0O1xcblxcdGZsb2F0IGNsZWFyY29hdFJvdWdobmVzcztcXG4jZW5kaWZcXG4jaWZkZWYgVVNFX1NIRUVOXFxuXFx0dmVjMyBzaGVlbkNvbG9yO1xcbiNlbmRpZlxcbn07XFxuI2RlZmluZSBNQVhJTVVNX1NQRUNVTEFSX0NPRUZGSUNJRU5UIDAuMTZcXG4jZGVmaW5lIERFRkFVTFRfU1BFQ1VMQVJfQ09FRkZJQ0lFTlQgMC4wNFxcbmZsb2F0IGNsZWFyY29hdERIUkFwcHJveCggY29uc3QgaW4gZmxvYXQgcm91Z2huZXNzLCBjb25zdCBpbiBmbG9hdCBkb3ROTCApIHtcXG5cXHRyZXR1cm4gREVGQVVMVF9TUEVDVUxBUl9DT0VGRklDSUVOVCArICggMS4wIC0gREVGQVVMVF9TUEVDVUxBUl9DT0VGRklDSUVOVCApICogKCBwb3coIDEuMCAtIGRvdE5MLCA1LjAgKSAqIHBvdyggMS4wIC0gcm91Z2huZXNzLCAyLjAgKSApO1xcbn1cXG4jaWYgTlVNX1JFQ1RfQVJFQV9MSUdIVFMgPiAwXFxuXFx0dm9pZCBSRV9EaXJlY3RfUmVjdEFyZWFfUGh5c2ljYWwoIGNvbnN0IGluIFJlY3RBcmVhTGlnaHQgcmVjdEFyZWFMaWdodCwgY29uc3QgaW4gR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeSwgY29uc3QgaW4gUGh5c2ljYWxNYXRlcmlhbCBtYXRlcmlhbCwgaW5vdXQgUmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQgKSB7XFxuXFx0XFx0dmVjMyBub3JtYWwgPSBnZW9tZXRyeS5ub3JtYWw7XFxuXFx0XFx0dmVjMyB2aWV3RGlyID0gZ2VvbWV0cnkudmlld0RpcjtcXG5cXHRcXHR2ZWMzIHBvc2l0aW9uID0gZ2VvbWV0cnkucG9zaXRpb247XFxuXFx0XFx0dmVjMyBsaWdodFBvcyA9IHJlY3RBcmVhTGlnaHQucG9zaXRpb247XFxuXFx0XFx0dmVjMyBoYWxmV2lkdGggPSByZWN0QXJlYUxpZ2h0LmhhbGZXaWR0aDtcXG5cXHRcXHR2ZWMzIGhhbGZIZWlnaHQgPSByZWN0QXJlYUxpZ2h0LmhhbGZIZWlnaHQ7XFxuXFx0XFx0dmVjMyBsaWdodENvbG9yID0gcmVjdEFyZWFMaWdodC5jb2xvcjtcXG5cXHRcXHRmbG9hdCByb3VnaG5lc3MgPSBtYXRlcmlhbC5zcGVjdWxhclJvdWdobmVzcztcXG5cXHRcXHR2ZWMzIHJlY3RDb29yZHNbIDQgXTtcXG5cXHRcXHRyZWN0Q29vcmRzWyAwIF0gPSBsaWdodFBvcyArIGhhbGZXaWR0aCAtIGhhbGZIZWlnaHQ7XFx0XFx0cmVjdENvb3Jkc1sgMSBdID0gbGlnaHRQb3MgLSBoYWxmV2lkdGggLSBoYWxmSGVpZ2h0O1xcblxcdFxcdHJlY3RDb29yZHNbIDIgXSA9IGxpZ2h0UG9zIC0gaGFsZldpZHRoICsgaGFsZkhlaWdodDtcXG5cXHRcXHRyZWN0Q29vcmRzWyAzIF0gPSBsaWdodFBvcyArIGhhbGZXaWR0aCArIGhhbGZIZWlnaHQ7XFxuXFx0XFx0dmVjMiB1diA9IExUQ19Vdiggbm9ybWFsLCB2aWV3RGlyLCByb3VnaG5lc3MgKTtcXG5cXHRcXHR2ZWM0IHQxID0gdGV4dHVyZTJEKCBsdGNfMSwgdXYgKTtcXG5cXHRcXHR2ZWM0IHQyID0gdGV4dHVyZTJEKCBsdGNfMiwgdXYgKTtcXG5cXHRcXHRtYXQzIG1JbnYgPSBtYXQzKFxcblxcdFxcdFxcdHZlYzMoIHQxLngsIDAsIHQxLnkgKSxcXG5cXHRcXHRcXHR2ZWMzKCAgICAwLCAxLCAgICAwICksXFxuXFx0XFx0XFx0dmVjMyggdDEueiwgMCwgdDEudyApXFxuXFx0XFx0KTtcXG5cXHRcXHR2ZWMzIGZyZXNuZWwgPSAoIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgKiB0Mi54ICsgKCB2ZWMzKCAxLjAgKSAtIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IgKSAqIHQyLnkgKTtcXG5cXHRcXHRyZWZsZWN0ZWRMaWdodC5kaXJlY3RTcGVjdWxhciArPSBsaWdodENvbG9yICogZnJlc25lbCAqIExUQ19FdmFsdWF0ZSggbm9ybWFsLCB2aWV3RGlyLCBwb3NpdGlvbiwgbUludiwgcmVjdENvb3JkcyApO1xcblxcdFxcdHJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgKz0gbGlnaHRDb2xvciAqIG1hdGVyaWFsLmRpZmZ1c2VDb2xvciAqIExUQ19FdmFsdWF0ZSggbm9ybWFsLCB2aWV3RGlyLCBwb3NpdGlvbiwgbWF0MyggMS4wICksIHJlY3RDb29yZHMgKTtcXG5cXHR9XFxuI2VuZGlmXFxudm9pZCBSRV9EaXJlY3RfUGh5c2ljYWwoIGNvbnN0IGluIEluY2lkZW50TGlnaHQgZGlyZWN0TGlnaHQsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIFBoeXNpY2FsTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ICkge1xcblxcdGZsb2F0IGRvdE5MID0gc2F0dXJhdGUoIGRvdCggZ2VvbWV0cnkubm9ybWFsLCBkaXJlY3RMaWdodC5kaXJlY3Rpb24gKSApO1xcblxcdHZlYzMgaXJyYWRpYW5jZSA9IGRvdE5MICogZGlyZWN0TGlnaHQuY29sb3I7XFxuXFx0I2lmbmRlZiBQSFlTSUNBTExZX0NPUlJFQ1RfTElHSFRTXFxuXFx0XFx0aXJyYWRpYW5jZSAqPSBQSTtcXG5cXHQjZW5kaWZcXG5cXHQjaWZkZWYgQ0xFQVJDT0FUXFxuXFx0XFx0ZmxvYXQgY2NEb3ROTCA9IHNhdHVyYXRlKCBkb3QoIGdlb21ldHJ5LmNsZWFyY29hdE5vcm1hbCwgZGlyZWN0TGlnaHQuZGlyZWN0aW9uICkgKTtcXG5cXHRcXHR2ZWMzIGNjSXJyYWRpYW5jZSA9IGNjRG90TkwgKiBkaXJlY3RMaWdodC5jb2xvcjtcXG5cXHRcXHQjaWZuZGVmIFBIWVNJQ0FMTFlfQ09SUkVDVF9MSUdIVFNcXG5cXHRcXHRcXHRjY0lycmFkaWFuY2UgKj0gUEk7XFxuXFx0XFx0I2VuZGlmXFxuXFx0XFx0ZmxvYXQgY2xlYXJjb2F0REhSID0gbWF0ZXJpYWwuY2xlYXJjb2F0ICogY2xlYXJjb2F0REhSQXBwcm94KCBtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MsIGNjRG90TkwgKTtcXG5cXHRcXHRyZWZsZWN0ZWRMaWdodC5kaXJlY3RTcGVjdWxhciArPSBjY0lycmFkaWFuY2UgKiBtYXRlcmlhbC5jbGVhcmNvYXQgKiBCUkRGX1NwZWN1bGFyX0dHWCggZGlyZWN0TGlnaHQsIGdlb21ldHJ5LnZpZXdEaXIsIGdlb21ldHJ5LmNsZWFyY29hdE5vcm1hbCwgdmVjMyggREVGQVVMVF9TUEVDVUxBUl9DT0VGRklDSUVOVCApLCBtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MgKTtcXG5cXHQjZWxzZVxcblxcdFxcdGZsb2F0IGNsZWFyY29hdERIUiA9IDAuMDtcXG5cXHQjZW5kaWZcXG5cXHQjaWZkZWYgVVNFX1NIRUVOXFxuXFx0XFx0cmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgKz0gKCAxLjAgLSBjbGVhcmNvYXRESFIgKSAqIGlycmFkaWFuY2UgKiBCUkRGX1NwZWN1bGFyX1NoZWVuKFxcblxcdFxcdFxcdG1hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzLFxcblxcdFxcdFxcdGRpcmVjdExpZ2h0LmRpcmVjdGlvbixcXG5cXHRcXHRcXHRnZW9tZXRyeSxcXG5cXHRcXHRcXHRtYXRlcmlhbC5zaGVlbkNvbG9yXFxuXFx0XFx0KTtcXG5cXHQjZWxzZVxcblxcdFxcdHJlZmxlY3RlZExpZ2h0LmRpcmVjdFNwZWN1bGFyICs9ICggMS4wIC0gY2xlYXJjb2F0REhSICkgKiBpcnJhZGlhbmNlICogQlJERl9TcGVjdWxhcl9HR1goIGRpcmVjdExpZ2h0LCBnZW9tZXRyeS52aWV3RGlyLCBnZW9tZXRyeS5ub3JtYWwsIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IsIG1hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzKTtcXG5cXHQjZW5kaWZcXG5cXHRyZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICs9ICggMS4wIC0gY2xlYXJjb2F0REhSICkgKiBpcnJhZGlhbmNlICogQlJERl9EaWZmdXNlX0xhbWJlcnQoIG1hdGVyaWFsLmRpZmZ1c2VDb2xvciApO1xcbn1cXG52b2lkIFJFX0luZGlyZWN0RGlmZnVzZV9QaHlzaWNhbCggY29uc3QgaW4gdmVjMyBpcnJhZGlhbmNlLCBjb25zdCBpbiBHZW9tZXRyaWNDb250ZXh0IGdlb21ldHJ5LCBjb25zdCBpbiBQaHlzaWNhbE1hdGVyaWFsIG1hdGVyaWFsLCBpbm91dCBSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCApIHtcXG5cXHRyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKz0gaXJyYWRpYW5jZSAqIEJSREZfRGlmZnVzZV9MYW1iZXJ0KCBtYXRlcmlhbC5kaWZmdXNlQ29sb3IgKTtcXG59XFxudm9pZCBSRV9JbmRpcmVjdFNwZWN1bGFyX1BoeXNpY2FsKCBjb25zdCBpbiB2ZWMzIHJhZGlhbmNlLCBjb25zdCBpbiB2ZWMzIGlycmFkaWFuY2UsIGNvbnN0IGluIHZlYzMgY2xlYXJjb2F0UmFkaWFuY2UsIGNvbnN0IGluIEdlb21ldHJpY0NvbnRleHQgZ2VvbWV0cnksIGNvbnN0IGluIFBoeXNpY2FsTWF0ZXJpYWwgbWF0ZXJpYWwsIGlub3V0IFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0KSB7XFxuXFx0I2lmZGVmIENMRUFSQ09BVFxcblxcdFxcdGZsb2F0IGNjRG90TlYgPSBzYXR1cmF0ZSggZG90KCBnZW9tZXRyeS5jbGVhcmNvYXROb3JtYWwsIGdlb21ldHJ5LnZpZXdEaXIgKSApO1xcblxcdFxcdHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0U3BlY3VsYXIgKz0gY2xlYXJjb2F0UmFkaWFuY2UgKiBtYXRlcmlhbC5jbGVhcmNvYXQgKiBCUkRGX1NwZWN1bGFyX0dHWF9FbnZpcm9ubWVudCggZ2VvbWV0cnkudmlld0RpciwgZ2VvbWV0cnkuY2xlYXJjb2F0Tm9ybWFsLCB2ZWMzKCBERUZBVUxUX1NQRUNVTEFSX0NPRUZGSUNJRU5UICksIG1hdGVyaWFsLmNsZWFyY29hdFJvdWdobmVzcyApO1xcblxcdFxcdGZsb2F0IGNjRG90TkwgPSBjY0RvdE5WO1xcblxcdFxcdGZsb2F0IGNsZWFyY29hdERIUiA9IG1hdGVyaWFsLmNsZWFyY29hdCAqIGNsZWFyY29hdERIUkFwcHJveCggbWF0ZXJpYWwuY2xlYXJjb2F0Um91Z2huZXNzLCBjY0RvdE5MICk7XFxuXFx0I2Vsc2VcXG5cXHRcXHRmbG9hdCBjbGVhcmNvYXRESFIgPSAwLjA7XFxuXFx0I2VuZGlmXFxuXFx0ZmxvYXQgY2xlYXJjb2F0SW52ID0gMS4wIC0gY2xlYXJjb2F0REhSO1xcblxcdHZlYzMgc2luZ2xlU2NhdHRlcmluZyA9IHZlYzMoIDAuMCApO1xcblxcdHZlYzMgbXVsdGlTY2F0dGVyaW5nID0gdmVjMyggMC4wICk7XFxuXFx0dmVjMyBjb3NpbmVXZWlnaHRlZElycmFkaWFuY2UgPSBpcnJhZGlhbmNlICogUkVDSVBST0NBTF9QSTtcXG5cXHRCUkRGX1NwZWN1bGFyX011bHRpc2NhdHRlcmluZ19FbnZpcm9ubWVudCggZ2VvbWV0cnksIG1hdGVyaWFsLnNwZWN1bGFyQ29sb3IsIG1hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzLCBzaW5nbGVTY2F0dGVyaW5nLCBtdWx0aVNjYXR0ZXJpbmcgKTtcXG5cXHR2ZWMzIGRpZmZ1c2UgPSBtYXRlcmlhbC5kaWZmdXNlQ29sb3IgKiAoIDEuMCAtICggc2luZ2xlU2NhdHRlcmluZyArIG11bHRpU2NhdHRlcmluZyApICk7XFxuXFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3RTcGVjdWxhciArPSBjbGVhcmNvYXRJbnYgKiByYWRpYW5jZSAqIHNpbmdsZVNjYXR0ZXJpbmc7XFxuXFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3RTcGVjdWxhciArPSBtdWx0aVNjYXR0ZXJpbmcgKiBjb3NpbmVXZWlnaHRlZElycmFkaWFuY2U7XFxuXFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICs9IGRpZmZ1c2UgKiBjb3NpbmVXZWlnaHRlZElycmFkaWFuY2U7XFxufVxcbiNkZWZpbmUgUkVfRGlyZWN0XFx0XFx0XFx0XFx0UkVfRGlyZWN0X1BoeXNpY2FsXFxuI2RlZmluZSBSRV9EaXJlY3RfUmVjdEFyZWFcXHRcXHRSRV9EaXJlY3RfUmVjdEFyZWFfUGh5c2ljYWxcXG4jZGVmaW5lIFJFX0luZGlyZWN0RGlmZnVzZVxcdFxcdFJFX0luZGlyZWN0RGlmZnVzZV9QaHlzaWNhbFxcbiNkZWZpbmUgUkVfSW5kaXJlY3RTcGVjdWxhclxcdFxcdFJFX0luZGlyZWN0U3BlY3VsYXJfUGh5c2ljYWxcXG5mbG9hdCBjb21wdXRlU3BlY3VsYXJPY2NsdXNpb24oIGNvbnN0IGluIGZsb2F0IGRvdE5WLCBjb25zdCBpbiBmbG9hdCBhbWJpZW50T2NjbHVzaW9uLCBjb25zdCBpbiBmbG9hdCByb3VnaG5lc3MgKSB7XFxuXFx0cmV0dXJuIHNhdHVyYXRlKCBwb3coIGRvdE5WICsgYW1iaWVudE9jY2x1c2lvbiwgZXhwMiggLSAxNi4wICogcm91Z2huZXNzIC0gMS4wICkgKSAtIDEuMCArIGFtYmllbnRPY2NsdXNpb24gKTtcXG59XCIsbGlnaHRzX2ZyYWdtZW50X2JlZ2luOlwiXFxuR2VvbWV0cmljQ29udGV4dCBnZW9tZXRyeTtcXG5nZW9tZXRyeS5wb3NpdGlvbiA9IC0gdlZpZXdQb3NpdGlvbjtcXG5nZW9tZXRyeS5ub3JtYWwgPSBub3JtYWw7XFxuZ2VvbWV0cnkudmlld0RpciA9ICggaXNPcnRob2dyYXBoaWMgKSA/IHZlYzMoIDAsIDAsIDEgKSA6IG5vcm1hbGl6ZSggdlZpZXdQb3NpdGlvbiApO1xcbiNpZmRlZiBDTEVBUkNPQVRcXG5cXHRnZW9tZXRyeS5jbGVhcmNvYXROb3JtYWwgPSBjbGVhcmNvYXROb3JtYWw7XFxuI2VuZGlmXFxuSW5jaWRlbnRMaWdodCBkaXJlY3RMaWdodDtcXG4jaWYgKCBOVU1fUE9JTlRfTElHSFRTID4gMCApICYmIGRlZmluZWQoIFJFX0RpcmVjdCApXFxuXFx0UG9pbnRMaWdodCBwb2ludExpZ2h0O1xcblxcdCNpZiBkZWZpbmVkKCBVU0VfU0hBRE9XTUFQICkgJiYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0UG9pbnRMaWdodFNoYWRvdyBwb2ludExpZ2h0U2hhZG93O1xcblxcdCNlbmRpZlxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcXG5cXHRmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fUE9JTlRfTElHSFRTOyBpICsrICkge1xcblxcdFxcdHBvaW50TGlnaHQgPSBwb2ludExpZ2h0c1sgaSBdO1xcblxcdFxcdGdldFBvaW50RGlyZWN0TGlnaHRJcnJhZGlhbmNlKCBwb2ludExpZ2h0LCBnZW9tZXRyeSwgZGlyZWN0TGlnaHQgKTtcXG5cXHRcXHQjaWYgZGVmaW5lZCggVVNFX1NIQURPV01BUCApICYmICggVU5ST0xMRURfTE9PUF9JTkRFWCA8IE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTIClcXG5cXHRcXHRwb2ludExpZ2h0U2hhZG93ID0gcG9pbnRMaWdodFNoYWRvd3NbIGkgXTtcXG5cXHRcXHRkaXJlY3RMaWdodC5jb2xvciAqPSBhbGwoIGJ2ZWMyKCBkaXJlY3RMaWdodC52aXNpYmxlLCByZWNlaXZlU2hhZG93ICkgKSA/IGdldFBvaW50U2hhZG93KCBwb2ludFNoYWRvd01hcFsgaSBdLCBwb2ludExpZ2h0U2hhZG93LnNoYWRvd01hcFNpemUsIHBvaW50TGlnaHRTaGFkb3cuc2hhZG93QmlhcywgcG9pbnRMaWdodFNoYWRvdy5zaGFkb3dSYWRpdXMsIHZQb2ludFNoYWRvd0Nvb3JkWyBpIF0sIHBvaW50TGlnaHRTaGFkb3cuc2hhZG93Q2FtZXJhTmVhciwgcG9pbnRMaWdodFNoYWRvdy5zaGFkb3dDYW1lcmFGYXIgKSA6IDEuMDtcXG5cXHRcXHQjZW5kaWZcXG5cXHRcXHRSRV9EaXJlY3QoIGRpcmVjdExpZ2h0LCBnZW9tZXRyeSwgbWF0ZXJpYWwsIHJlZmxlY3RlZExpZ2h0ICk7XFxuXFx0fVxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXFxuI2VuZGlmXFxuI2lmICggTlVNX1NQT1RfTElHSFRTID4gMCApICYmIGRlZmluZWQoIFJFX0RpcmVjdCApXFxuXFx0U3BvdExpZ2h0IHNwb3RMaWdodDtcXG5cXHQjaWYgZGVmaW5lZCggVVNFX1NIQURPV01BUCApICYmIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0U3BvdExpZ2h0U2hhZG93IHNwb3RMaWdodFNoYWRvdztcXG5cXHQjZW5kaWZcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX1NQT1RfTElHSFRTOyBpICsrICkge1xcblxcdFxcdHNwb3RMaWdodCA9IHNwb3RMaWdodHNbIGkgXTtcXG5cXHRcXHRnZXRTcG90RGlyZWN0TGlnaHRJcnJhZGlhbmNlKCBzcG90TGlnaHQsIGdlb21ldHJ5LCBkaXJlY3RMaWdodCApO1xcblxcdFxcdCNpZiBkZWZpbmVkKCBVU0VfU0hBRE9XTUFQICkgJiYgKCBVTlJPTExFRF9MT09QX0lOREVYIDwgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyApXFxuXFx0XFx0c3BvdExpZ2h0U2hhZG93ID0gc3BvdExpZ2h0U2hhZG93c1sgaSBdO1xcblxcdFxcdGRpcmVjdExpZ2h0LmNvbG9yICo9IGFsbCggYnZlYzIoIGRpcmVjdExpZ2h0LnZpc2libGUsIHJlY2VpdmVTaGFkb3cgKSApID8gZ2V0U2hhZG93KCBzcG90U2hhZG93TWFwWyBpIF0sIHNwb3RMaWdodFNoYWRvdy5zaGFkb3dNYXBTaXplLCBzcG90TGlnaHRTaGFkb3cuc2hhZG93Qmlhcywgc3BvdExpZ2h0U2hhZG93LnNoYWRvd1JhZGl1cywgdlNwb3RTaGFkb3dDb29yZFsgaSBdICkgOiAxLjA7XFxuXFx0XFx0I2VuZGlmXFxuXFx0XFx0UkVfRGlyZWN0KCBkaXJlY3RMaWdodCwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xcblxcdH1cXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxcbiNlbmRpZlxcbiNpZiAoIE5VTV9ESVJfTElHSFRTID4gMCApICYmIGRlZmluZWQoIFJFX0RpcmVjdCApXFxuXFx0RGlyZWN0aW9uYWxMaWdodCBkaXJlY3Rpb25hbExpZ2h0O1xcblxcdCNpZiBkZWZpbmVkKCBVU0VfU0hBRE9XTUFQICkgJiYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMFxcblxcdERpcmVjdGlvbmFsTGlnaHRTaGFkb3cgZGlyZWN0aW9uYWxMaWdodFNoYWRvdztcXG5cXHQjZW5kaWZcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0RJUl9MSUdIVFM7IGkgKysgKSB7XFxuXFx0XFx0ZGlyZWN0aW9uYWxMaWdodCA9IGRpcmVjdGlvbmFsTGlnaHRzWyBpIF07XFxuXFx0XFx0Z2V0RGlyZWN0aW9uYWxEaXJlY3RMaWdodElycmFkaWFuY2UoIGRpcmVjdGlvbmFsTGlnaHQsIGdlb21ldHJ5LCBkaXJlY3RMaWdodCApO1xcblxcdFxcdCNpZiBkZWZpbmVkKCBVU0VfU0hBRE9XTUFQICkgJiYgKCBVTlJPTExFRF9MT09QX0lOREVYIDwgTlVNX0RJUl9MSUdIVF9TSEFET1dTIClcXG5cXHRcXHRkaXJlY3Rpb25hbExpZ2h0U2hhZG93ID0gZGlyZWN0aW9uYWxMaWdodFNoYWRvd3NbIGkgXTtcXG5cXHRcXHRkaXJlY3RMaWdodC5jb2xvciAqPSBhbGwoIGJ2ZWMyKCBkaXJlY3RMaWdodC52aXNpYmxlLCByZWNlaXZlU2hhZG93ICkgKSA/IGdldFNoYWRvdyggZGlyZWN0aW9uYWxTaGFkb3dNYXBbIGkgXSwgZGlyZWN0aW9uYWxMaWdodFNoYWRvdy5zaGFkb3dNYXBTaXplLCBkaXJlY3Rpb25hbExpZ2h0U2hhZG93LnNoYWRvd0JpYXMsIGRpcmVjdGlvbmFsTGlnaHRTaGFkb3cuc2hhZG93UmFkaXVzLCB2RGlyZWN0aW9uYWxTaGFkb3dDb29yZFsgaSBdICkgOiAxLjA7XFxuXFx0XFx0I2VuZGlmXFxuXFx0XFx0UkVfRGlyZWN0KCBkaXJlY3RMaWdodCwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xcblxcdH1cXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxcbiNlbmRpZlxcbiNpZiAoIE5VTV9SRUNUX0FSRUFfTElHSFRTID4gMCApICYmIGRlZmluZWQoIFJFX0RpcmVjdF9SZWN0QXJlYSApXFxuXFx0UmVjdEFyZWFMaWdodCByZWN0QXJlYUxpZ2h0O1xcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcXG5cXHRmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fUkVDVF9BUkVBX0xJR0hUUzsgaSArKyApIHtcXG5cXHRcXHRyZWN0QXJlYUxpZ2h0ID0gcmVjdEFyZWFMaWdodHNbIGkgXTtcXG5cXHRcXHRSRV9EaXJlY3RfUmVjdEFyZWEoIHJlY3RBcmVhTGlnaHQsIGdlb21ldHJ5LCBtYXRlcmlhbCwgcmVmbGVjdGVkTGlnaHQgKTtcXG5cXHR9XFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZCggUkVfSW5kaXJlY3REaWZmdXNlIClcXG5cXHR2ZWMzIGlibElycmFkaWFuY2UgPSB2ZWMzKCAwLjAgKTtcXG5cXHR2ZWMzIGlycmFkaWFuY2UgPSBnZXRBbWJpZW50TGlnaHRJcnJhZGlhbmNlKCBhbWJpZW50TGlnaHRDb2xvciApO1xcblxcdGlycmFkaWFuY2UgKz0gZ2V0TGlnaHRQcm9iZUlycmFkaWFuY2UoIGxpZ2h0UHJvYmUsIGdlb21ldHJ5ICk7XFxuXFx0I2lmICggTlVNX0hFTUlfTElHSFRTID4gMCApXFxuXFx0XFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxcblxcdFxcdGZvciAoIGludCBpID0gMDsgaSA8IE5VTV9IRU1JX0xJR0hUUzsgaSArKyApIHtcXG5cXHRcXHRcXHRpcnJhZGlhbmNlICs9IGdldEhlbWlzcGhlcmVMaWdodElycmFkaWFuY2UoIGhlbWlzcGhlcmVMaWdodHNbIGkgXSwgZ2VvbWV0cnkgKTtcXG5cXHRcXHR9XFxuXFx0XFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZCggUkVfSW5kaXJlY3RTcGVjdWxhciApXFxuXFx0dmVjMyByYWRpYW5jZSA9IHZlYzMoIDAuMCApO1xcblxcdHZlYzMgY2xlYXJjb2F0UmFkaWFuY2UgPSB2ZWMzKCAwLjAgKTtcXG4jZW5kaWZcIixsaWdodHNfZnJhZ21lbnRfbWFwczpcIiNpZiBkZWZpbmVkKCBSRV9JbmRpcmVjdERpZmZ1c2UgKVxcblxcdCNpZmRlZiBVU0VfTElHSFRNQVBcXG5cXHRcXHR2ZWM0IGxpZ2h0TWFwVGV4ZWw9IHRleHR1cmUyRCggbGlnaHRNYXAsIHZVdjIgKTtcXG5cXHRcXHR2ZWMzIGxpZ2h0TWFwSXJyYWRpYW5jZSA9IGxpZ2h0TWFwVGV4ZWxUb0xpbmVhciggbGlnaHRNYXBUZXhlbCApLnJnYiAqIGxpZ2h0TWFwSW50ZW5zaXR5O1xcblxcdFxcdCNpZm5kZWYgUEhZU0lDQUxMWV9DT1JSRUNUX0xJR0hUU1xcblxcdFxcdFxcdGxpZ2h0TWFwSXJyYWRpYW5jZSAqPSBQSTtcXG5cXHRcXHQjZW5kaWZcXG5cXHRcXHRpcnJhZGlhbmNlICs9IGxpZ2h0TWFwSXJyYWRpYW5jZTtcXG5cXHQjZW5kaWZcXG5cXHQjaWYgZGVmaW5lZCggVVNFX0VOVk1BUCApICYmIGRlZmluZWQoIFNUQU5EQVJEICkgJiYgZGVmaW5lZCggRU5WTUFQX1RZUEVfQ1VCRV9VViApXFxuXFx0XFx0aWJsSXJyYWRpYW5jZSArPSBnZXRMaWdodFByb2JlSW5kaXJlY3RJcnJhZGlhbmNlKCBnZW9tZXRyeSwgbWF4TWlwTGV2ZWwgKTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG4jaWYgZGVmaW5lZCggVVNFX0VOVk1BUCApICYmIGRlZmluZWQoIFJFX0luZGlyZWN0U3BlY3VsYXIgKVxcblxcdHJhZGlhbmNlICs9IGdldExpZ2h0UHJvYmVJbmRpcmVjdFJhZGlhbmNlKCBnZW9tZXRyeS52aWV3RGlyLCBnZW9tZXRyeS5ub3JtYWwsIG1hdGVyaWFsLnNwZWN1bGFyUm91Z2huZXNzLCBtYXhNaXBMZXZlbCApO1xcblxcdCNpZmRlZiBDTEVBUkNPQVRcXG5cXHRcXHRjbGVhcmNvYXRSYWRpYW5jZSArPSBnZXRMaWdodFByb2JlSW5kaXJlY3RSYWRpYW5jZSggZ2VvbWV0cnkudmlld0RpciwgZ2VvbWV0cnkuY2xlYXJjb2F0Tm9ybWFsLCBtYXRlcmlhbC5jbGVhcmNvYXRSb3VnaG5lc3MsIG1heE1pcExldmVsICk7XFxuXFx0I2VuZGlmXFxuI2VuZGlmXCIsbGlnaHRzX2ZyYWdtZW50X2VuZDpcIiNpZiBkZWZpbmVkKCBSRV9JbmRpcmVjdERpZmZ1c2UgKVxcblxcdFJFX0luZGlyZWN0RGlmZnVzZSggaXJyYWRpYW5jZSwgZ2VvbWV0cnksIG1hdGVyaWFsLCByZWZsZWN0ZWRMaWdodCApO1xcbiNlbmRpZlxcbiNpZiBkZWZpbmVkKCBSRV9JbmRpcmVjdFNwZWN1bGFyIClcXG5cXHRSRV9JbmRpcmVjdFNwZWN1bGFyKCByYWRpYW5jZSwgaWJsSXJyYWRpYW5jZSwgY2xlYXJjb2F0UmFkaWFuY2UsIGdlb21ldHJ5LCBtYXRlcmlhbCwgcmVmbGVjdGVkTGlnaHQgKTtcXG4jZW5kaWZcIixsb2dkZXB0aGJ1Zl9mcmFnbWVudDpcIiNpZiBkZWZpbmVkKCBVU0VfTE9HREVQVEhCVUYgKSAmJiBkZWZpbmVkKCBVU0VfTE9HREVQVEhCVUZfRVhUIClcXG5cXHRnbF9GcmFnRGVwdGhFWFQgPSB2SXNQZXJzcGVjdGl2ZSA9PSAwLjAgPyBnbF9GcmFnQ29vcmQueiA6IGxvZzIoIHZGcmFnRGVwdGggKSAqIGxvZ0RlcHRoQnVmRkMgKiAwLjU7XFxuI2VuZGlmXCIsbG9nZGVwdGhidWZfcGFyc19mcmFnbWVudDpcIiNpZiBkZWZpbmVkKCBVU0VfTE9HREVQVEhCVUYgKSAmJiBkZWZpbmVkKCBVU0VfTE9HREVQVEhCVUZfRVhUIClcXG5cXHR1bmlmb3JtIGZsb2F0IGxvZ0RlcHRoQnVmRkM7XFxuXFx0dmFyeWluZyBmbG9hdCB2RnJhZ0RlcHRoO1xcblxcdHZhcnlpbmcgZmxvYXQgdklzUGVyc3BlY3RpdmU7XFxuI2VuZGlmXCIsbG9nZGVwdGhidWZfcGFyc192ZXJ0ZXg6XCIjaWZkZWYgVVNFX0xPR0RFUFRIQlVGXFxuXFx0I2lmZGVmIFVTRV9MT0dERVBUSEJVRl9FWFRcXG5cXHRcXHR2YXJ5aW5nIGZsb2F0IHZGcmFnRGVwdGg7XFxuXFx0XFx0dmFyeWluZyBmbG9hdCB2SXNQZXJzcGVjdGl2ZTtcXG5cXHQjZWxzZVxcblxcdFxcdHVuaWZvcm0gZmxvYXQgbG9nRGVwdGhCdWZGQztcXG5cXHQjZW5kaWZcXG4jZW5kaWZcIixsb2dkZXB0aGJ1Zl92ZXJ0ZXg6XCIjaWZkZWYgVVNFX0xPR0RFUFRIQlVGXFxuXFx0I2lmZGVmIFVTRV9MT0dERVBUSEJVRl9FWFRcXG5cXHRcXHR2RnJhZ0RlcHRoID0gMS4wICsgZ2xfUG9zaXRpb24udztcXG5cXHRcXHR2SXNQZXJzcGVjdGl2ZSA9IGZsb2F0KCBpc1BlcnNwZWN0aXZlTWF0cml4KCBwcm9qZWN0aW9uTWF0cml4ICkgKTtcXG5cXHQjZWxzZVxcblxcdFxcdGlmICggaXNQZXJzcGVjdGl2ZU1hdHJpeCggcHJvamVjdGlvbk1hdHJpeCApICkge1xcblxcdFxcdFxcdGdsX1Bvc2l0aW9uLnogPSBsb2cyKCBtYXgoIEVQU0lMT04sIGdsX1Bvc2l0aW9uLncgKyAxLjAgKSApICogbG9nRGVwdGhCdWZGQyAtIDEuMDtcXG5cXHRcXHRcXHRnbF9Qb3NpdGlvbi56ICo9IGdsX1Bvc2l0aW9uLnc7XFxuXFx0XFx0fVxcblxcdCNlbmRpZlxcbiNlbmRpZlwiLG1hcF9mcmFnbWVudDpcIiNpZmRlZiBVU0VfTUFQXFxuXFx0dmVjNCB0ZXhlbENvbG9yID0gdGV4dHVyZTJEKCBtYXAsIHZVdiApO1xcblxcdHRleGVsQ29sb3IgPSBtYXBUZXhlbFRvTGluZWFyKCB0ZXhlbENvbG9yICk7XFxuXFx0ZGlmZnVzZUNvbG9yICo9IHRleGVsQ29sb3I7XFxuI2VuZGlmXCIsbWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX01BUFxcblxcdHVuaWZvcm0gc2FtcGxlcjJEIG1hcDtcXG4jZW5kaWZcIixtYXBfcGFydGljbGVfZnJhZ21lbnQ6XCIjaWYgZGVmaW5lZCggVVNFX01BUCApIHx8IGRlZmluZWQoIFVTRV9BTFBIQU1BUCApXFxuXFx0dmVjMiB1diA9ICggdXZUcmFuc2Zvcm0gKiB2ZWMzKCBnbF9Qb2ludENvb3JkLngsIDEuMCAtIGdsX1BvaW50Q29vcmQueSwgMSApICkueHk7XFxuI2VuZGlmXFxuI2lmZGVmIFVTRV9NQVBcXG5cXHR2ZWM0IG1hcFRleGVsID0gdGV4dHVyZTJEKCBtYXAsIHV2ICk7XFxuXFx0ZGlmZnVzZUNvbG9yICo9IG1hcFRleGVsVG9MaW5lYXIoIG1hcFRleGVsICk7XFxuI2VuZGlmXFxuI2lmZGVmIFVTRV9BTFBIQU1BUFxcblxcdGRpZmZ1c2VDb2xvci5hICo9IHRleHR1cmUyRCggYWxwaGFNYXAsIHV2ICkuZztcXG4jZW5kaWZcIixtYXBfcGFydGljbGVfcGFyc19mcmFnbWVudDpcIiNpZiBkZWZpbmVkKCBVU0VfTUFQICkgfHwgZGVmaW5lZCggVVNFX0FMUEhBTUFQIClcXG5cXHR1bmlmb3JtIG1hdDMgdXZUcmFuc2Zvcm07XFxuI2VuZGlmXFxuI2lmZGVmIFVTRV9NQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCBtYXA7XFxuI2VuZGlmXFxuI2lmZGVmIFVTRV9BTFBIQU1BUFxcblxcdHVuaWZvcm0gc2FtcGxlcjJEIGFscGhhTWFwO1xcbiNlbmRpZlwiLG1ldGFsbmVzc21hcF9mcmFnbWVudDpcImZsb2F0IG1ldGFsbmVzc0ZhY3RvciA9IG1ldGFsbmVzcztcXG4jaWZkZWYgVVNFX01FVEFMTkVTU01BUFxcblxcdHZlYzQgdGV4ZWxNZXRhbG5lc3MgPSB0ZXh0dXJlMkQoIG1ldGFsbmVzc01hcCwgdlV2ICk7XFxuXFx0bWV0YWxuZXNzRmFjdG9yICo9IHRleGVsTWV0YWxuZXNzLmI7XFxuI2VuZGlmXCIsbWV0YWxuZXNzbWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX01FVEFMTkVTU01BUFxcblxcdHVuaWZvcm0gc2FtcGxlcjJEIG1ldGFsbmVzc01hcDtcXG4jZW5kaWZcIixtb3JwaG5vcm1hbF92ZXJ0ZXg6XCIjaWZkZWYgVVNFX01PUlBITk9STUFMU1xcblxcdG9iamVjdE5vcm1hbCAqPSBtb3JwaFRhcmdldEJhc2VJbmZsdWVuY2U7XFxuXFx0b2JqZWN0Tm9ybWFsICs9IG1vcnBoTm9ybWFsMCAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgMCBdO1xcblxcdG9iamVjdE5vcm1hbCArPSBtb3JwaE5vcm1hbDEgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDEgXTtcXG5cXHRvYmplY3ROb3JtYWwgKz0gbW9ycGhOb3JtYWwyICogbW9ycGhUYXJnZXRJbmZsdWVuY2VzWyAyIF07XFxuXFx0b2JqZWN0Tm9ybWFsICs9IG1vcnBoTm9ybWFsMyAqIG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgMyBdO1xcbiNlbmRpZlwiLG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4OlwiI2lmZGVmIFVTRV9NT1JQSFRBUkdFVFNcXG5cXHR1bmlmb3JtIGZsb2F0IG1vcnBoVGFyZ2V0QmFzZUluZmx1ZW5jZTtcXG5cXHQjaWZuZGVmIFVTRV9NT1JQSE5PUk1BTFNcXG5cXHRcXHR1bmlmb3JtIGZsb2F0IG1vcnBoVGFyZ2V0SW5mbHVlbmNlc1sgOCBdO1xcblxcdCNlbHNlXFxuXFx0XFx0dW5pZm9ybSBmbG9hdCBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDQgXTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcIixtb3JwaHRhcmdldF92ZXJ0ZXg6XCIjaWZkZWYgVVNFX01PUlBIVEFSR0VUU1xcblxcdHRyYW5zZm9ybWVkICo9IG1vcnBoVGFyZ2V0QmFzZUluZmx1ZW5jZTtcXG5cXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDAgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDAgXTtcXG5cXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDEgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDEgXTtcXG5cXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDIgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDIgXTtcXG5cXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDMgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDMgXTtcXG5cXHQjaWZuZGVmIFVTRV9NT1JQSE5PUk1BTFNcXG5cXHRcXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDQgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDQgXTtcXG5cXHRcXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDUgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDUgXTtcXG5cXHRcXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDYgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDYgXTtcXG5cXHRcXHR0cmFuc2Zvcm1lZCArPSBtb3JwaFRhcmdldDcgKiBtb3JwaFRhcmdldEluZmx1ZW5jZXNbIDcgXTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcIixub3JtYWxfZnJhZ21lbnRfYmVnaW46XCIjaWZkZWYgRkxBVF9TSEFERURcXG5cXHR2ZWMzIGZkeCA9IHZlYzMoIGRGZHgoIHZWaWV3UG9zaXRpb24ueCApLCBkRmR4KCB2Vmlld1Bvc2l0aW9uLnkgKSwgZEZkeCggdlZpZXdQb3NpdGlvbi56ICkgKTtcXG5cXHR2ZWMzIGZkeSA9IHZlYzMoIGRGZHkoIHZWaWV3UG9zaXRpb24ueCApLCBkRmR5KCB2Vmlld1Bvc2l0aW9uLnkgKSwgZEZkeSggdlZpZXdQb3NpdGlvbi56ICkgKTtcXG5cXHR2ZWMzIG5vcm1hbCA9IG5vcm1hbGl6ZSggY3Jvc3MoIGZkeCwgZmR5ICkgKTtcXG4jZWxzZVxcblxcdHZlYzMgbm9ybWFsID0gbm9ybWFsaXplKCB2Tm9ybWFsICk7XFxuXFx0I2lmZGVmIERPVUJMRV9TSURFRFxcblxcdFxcdG5vcm1hbCA9IG5vcm1hbCAqICggZmxvYXQoIGdsX0Zyb250RmFjaW5nICkgKiAyLjAgLSAxLjAgKTtcXG5cXHQjZW5kaWZcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHR2ZWMzIHRhbmdlbnQgPSBub3JtYWxpemUoIHZUYW5nZW50ICk7XFxuXFx0XFx0dmVjMyBiaXRhbmdlbnQgPSBub3JtYWxpemUoIHZCaXRhbmdlbnQgKTtcXG5cXHRcXHQjaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0XFx0XFx0dGFuZ2VudCA9IHRhbmdlbnQgKiAoIGZsb2F0KCBnbF9Gcm9udEZhY2luZyApICogMi4wIC0gMS4wICk7XFxuXFx0XFx0XFx0Yml0YW5nZW50ID0gYml0YW5nZW50ICogKCBmbG9hdCggZ2xfRnJvbnRGYWNpbmcgKSAqIDIuMCAtIDEuMCApO1xcblxcdFxcdCNlbmRpZlxcblxcdFxcdCNpZiBkZWZpbmVkKCBUQU5HRU5UU1BBQ0VfTk9STUFMTUFQICkgfHwgZGVmaW5lZCggVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVAgKVxcblxcdFxcdFxcdG1hdDMgdlRCTiA9IG1hdDMoIHRhbmdlbnQsIGJpdGFuZ2VudCwgbm9ybWFsICk7XFxuXFx0XFx0I2VuZGlmXFxuXFx0I2VuZGlmXFxuI2VuZGlmXFxudmVjMyBnZW9tZXRyeU5vcm1hbCA9IG5vcm1hbDtcIixub3JtYWxfZnJhZ21lbnRfbWFwczpcIiNpZmRlZiBPQkpFQ1RTUEFDRV9OT1JNQUxNQVBcXG5cXHRub3JtYWwgPSB0ZXh0dXJlMkQoIG5vcm1hbE1hcCwgdlV2ICkueHl6ICogMi4wIC0gMS4wO1xcblxcdCNpZmRlZiBGTElQX1NJREVEXFxuXFx0XFx0bm9ybWFsID0gLSBub3JtYWw7XFxuXFx0I2VuZGlmXFxuXFx0I2lmZGVmIERPVUJMRV9TSURFRFxcblxcdFxcdG5vcm1hbCA9IG5vcm1hbCAqICggZmxvYXQoIGdsX0Zyb250RmFjaW5nICkgKiAyLjAgLSAxLjAgKTtcXG5cXHQjZW5kaWZcXG5cXHRub3JtYWwgPSBub3JtYWxpemUoIG5vcm1hbE1hdHJpeCAqIG5vcm1hbCApO1xcbiNlbGlmIGRlZmluZWQoIFRBTkdFTlRTUEFDRV9OT1JNQUxNQVAgKVxcblxcdHZlYzMgbWFwTiA9IHRleHR1cmUyRCggbm9ybWFsTWFwLCB2VXYgKS54eXogKiAyLjAgLSAxLjA7XFxuXFx0bWFwTi54eSAqPSBub3JtYWxTY2FsZTtcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHRub3JtYWwgPSBub3JtYWxpemUoIHZUQk4gKiBtYXBOICk7XFxuXFx0I2Vsc2VcXG5cXHRcXHRub3JtYWwgPSBwZXJ0dXJiTm9ybWFsMkFyYiggLXZWaWV3UG9zaXRpb24sIG5vcm1hbCwgbWFwTiApO1xcblxcdCNlbmRpZlxcbiNlbGlmIGRlZmluZWQoIFVTRV9CVU1QTUFQIClcXG5cXHRub3JtYWwgPSBwZXJ0dXJiTm9ybWFsQXJiKCAtdlZpZXdQb3NpdGlvbiwgbm9ybWFsLCBkSGR4eV9md2QoKSApO1xcbiNlbmRpZlwiLG5vcm1hbG1hcF9wYXJzX2ZyYWdtZW50OlwiI2lmZGVmIFVTRV9OT1JNQUxNQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCBub3JtYWxNYXA7XFxuXFx0dW5pZm9ybSB2ZWMyIG5vcm1hbFNjYWxlO1xcbiNlbmRpZlxcbiNpZmRlZiBPQkpFQ1RTUEFDRV9OT1JNQUxNQVBcXG5cXHR1bmlmb3JtIG1hdDMgbm9ybWFsTWF0cml4O1xcbiNlbmRpZlxcbiNpZiAhIGRlZmluZWQgKCBVU0VfVEFOR0VOVCApICYmICggZGVmaW5lZCAoIFRBTkdFTlRTUEFDRV9OT1JNQUxNQVAgKSB8fCBkZWZpbmVkICggVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVAgKSApXFxuXFx0dmVjMyBwZXJ0dXJiTm9ybWFsMkFyYiggdmVjMyBleWVfcG9zLCB2ZWMzIHN1cmZfbm9ybSwgdmVjMyBtYXBOICkge1xcblxcdFxcdHZlYzMgcTAgPSB2ZWMzKCBkRmR4KCBleWVfcG9zLnggKSwgZEZkeCggZXllX3Bvcy55ICksIGRGZHgoIGV5ZV9wb3MueiApICk7XFxuXFx0XFx0dmVjMyBxMSA9IHZlYzMoIGRGZHkoIGV5ZV9wb3MueCApLCBkRmR5KCBleWVfcG9zLnkgKSwgZEZkeSggZXllX3Bvcy56ICkgKTtcXG5cXHRcXHR2ZWMyIHN0MCA9IGRGZHgoIHZVdi5zdCApO1xcblxcdFxcdHZlYzIgc3QxID0gZEZkeSggdlV2LnN0ICk7XFxuXFx0XFx0ZmxvYXQgc2NhbGUgPSBzaWduKCBzdDEudCAqIHN0MC5zIC0gc3QwLnQgKiBzdDEucyApO1xcblxcdFxcdHZlYzMgUyA9IG5vcm1hbGl6ZSggKCBxMCAqIHN0MS50IC0gcTEgKiBzdDAudCApICogc2NhbGUgKTtcXG5cXHRcXHR2ZWMzIFQgPSBub3JtYWxpemUoICggLSBxMCAqIHN0MS5zICsgcTEgKiBzdDAucyApICogc2NhbGUgKTtcXG5cXHRcXHR2ZWMzIE4gPSBub3JtYWxpemUoIHN1cmZfbm9ybSApO1xcblxcdFxcdG1hdDMgdHNuID0gbWF0MyggUywgVCwgTiApO1xcblxcdFxcdG1hcE4ueHkgKj0gKCBmbG9hdCggZ2xfRnJvbnRGYWNpbmcgKSAqIDIuMCAtIDEuMCApO1xcblxcdFxcdHJldHVybiBub3JtYWxpemUoIHRzbiAqIG1hcE4gKTtcXG5cXHR9XFxuI2VuZGlmXCIsY2xlYXJjb2F0X25vcm1hbF9mcmFnbWVudF9iZWdpbjpcIiNpZmRlZiBDTEVBUkNPQVRcXG5cXHR2ZWMzIGNsZWFyY29hdE5vcm1hbCA9IGdlb21ldHJ5Tm9ybWFsO1xcbiNlbmRpZlwiLGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfbWFwczpcIiNpZmRlZiBVU0VfQ0xFQVJDT0FUX05PUk1BTE1BUFxcblxcdHZlYzMgY2xlYXJjb2F0TWFwTiA9IHRleHR1cmUyRCggY2xlYXJjb2F0Tm9ybWFsTWFwLCB2VXYgKS54eXogKiAyLjAgLSAxLjA7XFxuXFx0Y2xlYXJjb2F0TWFwTi54eSAqPSBjbGVhcmNvYXROb3JtYWxTY2FsZTtcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHRjbGVhcmNvYXROb3JtYWwgPSBub3JtYWxpemUoIHZUQk4gKiBjbGVhcmNvYXRNYXBOICk7XFxuXFx0I2Vsc2VcXG5cXHRcXHRjbGVhcmNvYXROb3JtYWwgPSBwZXJ0dXJiTm9ybWFsMkFyYiggLSB2Vmlld1Bvc2l0aW9uLCBjbGVhcmNvYXROb3JtYWwsIGNsZWFyY29hdE1hcE4gKTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcIixjbGVhcmNvYXRfcGFyc19mcmFnbWVudDpcIiNpZmRlZiBVU0VfQ0xFQVJDT0FUTUFQXFxuXFx0dW5pZm9ybSBzYW1wbGVyMkQgY2xlYXJjb2F0TWFwO1xcbiNlbmRpZlxcbiNpZmRlZiBVU0VfQ0xFQVJDT0FUX1JPVUdITkVTU01BUFxcblxcdHVuaWZvcm0gc2FtcGxlcjJEIGNsZWFyY29hdFJvdWdobmVzc01hcDtcXG4jZW5kaWZcXG4jaWZkZWYgVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCBjbGVhcmNvYXROb3JtYWxNYXA7XFxuXFx0dW5pZm9ybSB2ZWMyIGNsZWFyY29hdE5vcm1hbFNjYWxlO1xcbiNlbmRpZlwiLHBhY2tpbmc6XCJ2ZWMzIHBhY2tOb3JtYWxUb1JHQiggY29uc3QgaW4gdmVjMyBub3JtYWwgKSB7XFxuXFx0cmV0dXJuIG5vcm1hbGl6ZSggbm9ybWFsICkgKiAwLjUgKyAwLjU7XFxufVxcbnZlYzMgdW5wYWNrUkdCVG9Ob3JtYWwoIGNvbnN0IGluIHZlYzMgcmdiICkge1xcblxcdHJldHVybiAyLjAgKiByZ2IueHl6IC0gMS4wO1xcbn1cXG5jb25zdCBmbG9hdCBQYWNrVXBzY2FsZSA9IDI1Ni4gLyAyNTUuO2NvbnN0IGZsb2F0IFVucGFja0Rvd25zY2FsZSA9IDI1NS4gLyAyNTYuO1xcbmNvbnN0IHZlYzMgUGFja0ZhY3RvcnMgPSB2ZWMzKCAyNTYuICogMjU2LiAqIDI1Ni4sIDI1Ni4gKiAyNTYuLCAyNTYuICk7XFxuY29uc3QgdmVjNCBVbnBhY2tGYWN0b3JzID0gVW5wYWNrRG93bnNjYWxlIC8gdmVjNCggUGFja0ZhY3RvcnMsIDEuICk7XFxuY29uc3QgZmxvYXQgU2hpZnRSaWdodDggPSAxLiAvIDI1Ni47XFxudmVjNCBwYWNrRGVwdGhUb1JHQkEoIGNvbnN0IGluIGZsb2F0IHYgKSB7XFxuXFx0dmVjNCByID0gdmVjNCggZnJhY3QoIHYgKiBQYWNrRmFjdG9ycyApLCB2ICk7XFxuXFx0ci55encgLT0gci54eXogKiBTaGlmdFJpZ2h0ODtcXHRyZXR1cm4gciAqIFBhY2tVcHNjYWxlO1xcbn1cXG5mbG9hdCB1bnBhY2tSR0JBVG9EZXB0aCggY29uc3QgaW4gdmVjNCB2ICkge1xcblxcdHJldHVybiBkb3QoIHYsIFVucGFja0ZhY3RvcnMgKTtcXG59XFxudmVjNCBwYWNrMkhhbGZUb1JHQkEoIHZlYzIgdiApIHtcXG5cXHR2ZWM0IHIgPSB2ZWM0KCB2LngsIGZyYWN0KCB2LnggKiAyNTUuMCApLCB2LnksIGZyYWN0KCB2LnkgKiAyNTUuMCApKTtcXG5cXHRyZXR1cm4gdmVjNCggci54IC0gci55IC8gMjU1LjAsIHIueSwgci56IC0gci53IC8gMjU1LjAsIHIudyk7XFxufVxcbnZlYzIgdW5wYWNrUkdCQVRvMkhhbGYoIHZlYzQgdiApIHtcXG5cXHRyZXR1cm4gdmVjMiggdi54ICsgKCB2LnkgLyAyNTUuMCApLCB2LnogKyAoIHYudyAvIDI1NS4wICkgKTtcXG59XFxuZmxvYXQgdmlld1pUb09ydGhvZ3JhcGhpY0RlcHRoKCBjb25zdCBpbiBmbG9hdCB2aWV3WiwgY29uc3QgaW4gZmxvYXQgbmVhciwgY29uc3QgaW4gZmxvYXQgZmFyICkge1xcblxcdHJldHVybiAoIHZpZXdaICsgbmVhciApIC8gKCBuZWFyIC0gZmFyICk7XFxufVxcbmZsb2F0IG9ydGhvZ3JhcGhpY0RlcHRoVG9WaWV3WiggY29uc3QgaW4gZmxvYXQgbGluZWFyQ2xpcFosIGNvbnN0IGluIGZsb2F0IG5lYXIsIGNvbnN0IGluIGZsb2F0IGZhciApIHtcXG5cXHRyZXR1cm4gbGluZWFyQ2xpcFogKiAoIG5lYXIgLSBmYXIgKSAtIG5lYXI7XFxufVxcbmZsb2F0IHZpZXdaVG9QZXJzcGVjdGl2ZURlcHRoKCBjb25zdCBpbiBmbG9hdCB2aWV3WiwgY29uc3QgaW4gZmxvYXQgbmVhciwgY29uc3QgaW4gZmxvYXQgZmFyICkge1xcblxcdHJldHVybiAoKCBuZWFyICsgdmlld1ogKSAqIGZhciApIC8gKCggZmFyIC0gbmVhciApICogdmlld1ogKTtcXG59XFxuZmxvYXQgcGVyc3BlY3RpdmVEZXB0aFRvVmlld1ooIGNvbnN0IGluIGZsb2F0IGludkNsaXBaLCBjb25zdCBpbiBmbG9hdCBuZWFyLCBjb25zdCBpbiBmbG9hdCBmYXIgKSB7XFxuXFx0cmV0dXJuICggbmVhciAqIGZhciApIC8gKCAoIGZhciAtIG5lYXIgKSAqIGludkNsaXBaIC0gZmFyICk7XFxufVwiLHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ6XCIjaWZkZWYgUFJFTVVMVElQTElFRF9BTFBIQVxcblxcdGdsX0ZyYWdDb2xvci5yZ2IgKj0gZ2xfRnJhZ0NvbG9yLmE7XFxuI2VuZGlmXCIscHJvamVjdF92ZXJ0ZXg6XCJ2ZWM0IG12UG9zaXRpb24gPSB2ZWM0KCB0cmFuc2Zvcm1lZCwgMS4wICk7XFxuI2lmZGVmIFVTRV9JTlNUQU5DSU5HXFxuXFx0bXZQb3NpdGlvbiA9IGluc3RhbmNlTWF0cml4ICogbXZQb3NpdGlvbjtcXG4jZW5kaWZcXG5tdlBvc2l0aW9uID0gbW9kZWxWaWV3TWF0cml4ICogbXZQb3NpdGlvbjtcXG5nbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtdlBvc2l0aW9uO1wiLGRpdGhlcmluZ19mcmFnbWVudDpcIiNpZmRlZiBESVRIRVJJTkdcXG5cXHRnbF9GcmFnQ29sb3IucmdiID0gZGl0aGVyaW5nKCBnbF9GcmFnQ29sb3IucmdiICk7XFxuI2VuZGlmXCIsZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgRElUSEVSSU5HXFxuXFx0dmVjMyBkaXRoZXJpbmcoIHZlYzMgY29sb3IgKSB7XFxuXFx0XFx0ZmxvYXQgZ3JpZF9wb3NpdGlvbiA9IHJhbmQoIGdsX0ZyYWdDb29yZC54eSApO1xcblxcdFxcdHZlYzMgZGl0aGVyX3NoaWZ0X1JHQiA9IHZlYzMoIDAuMjUgLyAyNTUuMCwgLTAuMjUgLyAyNTUuMCwgMC4yNSAvIDI1NS4wICk7XFxuXFx0XFx0ZGl0aGVyX3NoaWZ0X1JHQiA9IG1peCggMi4wICogZGl0aGVyX3NoaWZ0X1JHQiwgLTIuMCAqIGRpdGhlcl9zaGlmdF9SR0IsIGdyaWRfcG9zaXRpb24gKTtcXG5cXHRcXHRyZXR1cm4gY29sb3IgKyBkaXRoZXJfc2hpZnRfUkdCO1xcblxcdH1cXG4jZW5kaWZcIixyb3VnaG5lc3NtYXBfZnJhZ21lbnQ6XCJmbG9hdCByb3VnaG5lc3NGYWN0b3IgPSByb3VnaG5lc3M7XFxuI2lmZGVmIFVTRV9ST1VHSE5FU1NNQVBcXG5cXHR2ZWM0IHRleGVsUm91Z2huZXNzID0gdGV4dHVyZTJEKCByb3VnaG5lc3NNYXAsIHZVdiApO1xcblxcdHJvdWdobmVzc0ZhY3RvciAqPSB0ZXhlbFJvdWdobmVzcy5nO1xcbiNlbmRpZlwiLHJvdWdobmVzc21hcF9wYXJzX2ZyYWdtZW50OlwiI2lmZGVmIFVTRV9ST1VHSE5FU1NNQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCByb3VnaG5lc3NNYXA7XFxuI2VuZGlmXCIsc2hhZG93bWFwX3BhcnNfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX1NIQURPV01BUFxcblxcdCNpZiBOVU1fRElSX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0XFx0dW5pZm9ybSBzYW1wbGVyMkQgZGlyZWN0aW9uYWxTaGFkb3dNYXBbIE5VTV9ESVJfTElHSFRfU0hBRE9XUyBdO1xcblxcdFxcdHZhcnlpbmcgdmVjNCB2RGlyZWN0aW9uYWxTaGFkb3dDb29yZFsgTlVNX0RJUl9MSUdIVF9TSEFET1dTIF07XFxuXFx0XFx0c3RydWN0IERpcmVjdGlvbmFsTGlnaHRTaGFkb3cge1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd0JpYXM7XFxuXFx0XFx0XFx0ZmxvYXQgc2hhZG93Tm9ybWFsQmlhcztcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dSYWRpdXM7XFxuXFx0XFx0XFx0dmVjMiBzaGFkb3dNYXBTaXplO1xcblxcdFxcdH07XFxuXFx0XFx0dW5pZm9ybSBEaXJlY3Rpb25hbExpZ2h0U2hhZG93IGRpcmVjdGlvbmFsTGlnaHRTaGFkb3dzWyBOVU1fRElSX0xJR0hUX1NIQURPV1MgXTtcXG5cXHQjZW5kaWZcXG5cXHQjaWYgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyA+IDBcXG5cXHRcXHR1bmlmb3JtIHNhbXBsZXIyRCBzcG90U2hhZG93TWFwWyBOVU1fU1BPVF9MSUdIVF9TSEFET1dTIF07XFxuXFx0XFx0dmFyeWluZyB2ZWM0IHZTcG90U2hhZG93Q29vcmRbIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgXTtcXG5cXHRcXHRzdHJ1Y3QgU3BvdExpZ2h0U2hhZG93IHtcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dCaWFzO1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd05vcm1hbEJpYXM7XFxuXFx0XFx0XFx0ZmxvYXQgc2hhZG93UmFkaXVzO1xcblxcdFxcdFxcdHZlYzIgc2hhZG93TWFwU2l6ZTtcXG5cXHRcXHR9O1xcblxcdFxcdHVuaWZvcm0gU3BvdExpZ2h0U2hhZG93IHNwb3RMaWdodFNoYWRvd3NbIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgXTtcXG5cXHQjZW5kaWZcXG5cXHQjaWYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0XFx0dW5pZm9ybSBzYW1wbGVyMkQgcG9pbnRTaGFkb3dNYXBbIE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTIF07XFxuXFx0XFx0dmFyeWluZyB2ZWM0IHZQb2ludFNoYWRvd0Nvb3JkWyBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyBdO1xcblxcdFxcdHN0cnVjdCBQb2ludExpZ2h0U2hhZG93IHtcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dCaWFzO1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd05vcm1hbEJpYXM7XFxuXFx0XFx0XFx0ZmxvYXQgc2hhZG93UmFkaXVzO1xcblxcdFxcdFxcdHZlYzIgc2hhZG93TWFwU2l6ZTtcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dDYW1lcmFOZWFyO1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd0NhbWVyYUZhcjtcXG5cXHRcXHR9O1xcblxcdFxcdHVuaWZvcm0gUG9pbnRMaWdodFNoYWRvdyBwb2ludExpZ2h0U2hhZG93c1sgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgXTtcXG5cXHQjZW5kaWZcXG5cXHRmbG9hdCB0ZXh0dXJlMkRDb21wYXJlKCBzYW1wbGVyMkQgZGVwdGhzLCB2ZWMyIHV2LCBmbG9hdCBjb21wYXJlICkge1xcblxcdFxcdHJldHVybiBzdGVwKCBjb21wYXJlLCB1bnBhY2tSR0JBVG9EZXB0aCggdGV4dHVyZTJEKCBkZXB0aHMsIHV2ICkgKSApO1xcblxcdH1cXG5cXHR2ZWMyIHRleHR1cmUyRERpc3RyaWJ1dGlvbiggc2FtcGxlcjJEIHNoYWRvdywgdmVjMiB1diApIHtcXG5cXHRcXHRyZXR1cm4gdW5wYWNrUkdCQVRvMkhhbGYoIHRleHR1cmUyRCggc2hhZG93LCB1diApICk7XFxuXFx0fVxcblxcdGZsb2F0IFZTTVNoYWRvdyAoc2FtcGxlcjJEIHNoYWRvdywgdmVjMiB1diwgZmxvYXQgY29tcGFyZSApe1xcblxcdFxcdGZsb2F0IG9jY2x1c2lvbiA9IDEuMDtcXG5cXHRcXHR2ZWMyIGRpc3RyaWJ1dGlvbiA9IHRleHR1cmUyRERpc3RyaWJ1dGlvbiggc2hhZG93LCB1diApO1xcblxcdFxcdGZsb2F0IGhhcmRfc2hhZG93ID0gc3RlcCggY29tcGFyZSAsIGRpc3RyaWJ1dGlvbi54ICk7XFxuXFx0XFx0aWYgKGhhcmRfc2hhZG93ICE9IDEuMCApIHtcXG5cXHRcXHRcXHRmbG9hdCBkaXN0YW5jZSA9IGNvbXBhcmUgLSBkaXN0cmlidXRpb24ueCA7XFxuXFx0XFx0XFx0ZmxvYXQgdmFyaWFuY2UgPSBtYXgoIDAuMDAwMDAsIGRpc3RyaWJ1dGlvbi55ICogZGlzdHJpYnV0aW9uLnkgKTtcXG5cXHRcXHRcXHRmbG9hdCBzb2Z0bmVzc19wcm9iYWJpbGl0eSA9IHZhcmlhbmNlIC8gKHZhcmlhbmNlICsgZGlzdGFuY2UgKiBkaXN0YW5jZSApO1xcdFxcdFxcdHNvZnRuZXNzX3Byb2JhYmlsaXR5ID0gY2xhbXAoICggc29mdG5lc3NfcHJvYmFiaWxpdHkgLSAwLjMgKSAvICggMC45NSAtIDAuMyApLCAwLjAsIDEuMCApO1xcdFxcdFxcdG9jY2x1c2lvbiA9IGNsYW1wKCBtYXgoIGhhcmRfc2hhZG93LCBzb2Z0bmVzc19wcm9iYWJpbGl0eSApLCAwLjAsIDEuMCApO1xcblxcdFxcdH1cXG5cXHRcXHRyZXR1cm4gb2NjbHVzaW9uO1xcblxcdH1cXG5cXHRmbG9hdCBnZXRTaGFkb3coIHNhbXBsZXIyRCBzaGFkb3dNYXAsIHZlYzIgc2hhZG93TWFwU2l6ZSwgZmxvYXQgc2hhZG93QmlhcywgZmxvYXQgc2hhZG93UmFkaXVzLCB2ZWM0IHNoYWRvd0Nvb3JkICkge1xcblxcdFxcdGZsb2F0IHNoYWRvdyA9IDEuMDtcXG5cXHRcXHRzaGFkb3dDb29yZC54eXogLz0gc2hhZG93Q29vcmQudztcXG5cXHRcXHRzaGFkb3dDb29yZC56ICs9IHNoYWRvd0JpYXM7XFxuXFx0XFx0YnZlYzQgaW5GcnVzdHVtVmVjID0gYnZlYzQgKCBzaGFkb3dDb29yZC54ID49IDAuMCwgc2hhZG93Q29vcmQueCA8PSAxLjAsIHNoYWRvd0Nvb3JkLnkgPj0gMC4wLCBzaGFkb3dDb29yZC55IDw9IDEuMCApO1xcblxcdFxcdGJvb2wgaW5GcnVzdHVtID0gYWxsKCBpbkZydXN0dW1WZWMgKTtcXG5cXHRcXHRidmVjMiBmcnVzdHVtVGVzdFZlYyA9IGJ2ZWMyKCBpbkZydXN0dW0sIHNoYWRvd0Nvb3JkLnogPD0gMS4wICk7XFxuXFx0XFx0Ym9vbCBmcnVzdHVtVGVzdCA9IGFsbCggZnJ1c3R1bVRlc3RWZWMgKTtcXG5cXHRcXHRpZiAoIGZydXN0dW1UZXN0ICkge1xcblxcdFxcdCNpZiBkZWZpbmVkKCBTSEFET1dNQVBfVFlQRV9QQ0YgKVxcblxcdFxcdFxcdHZlYzIgdGV4ZWxTaXplID0gdmVjMiggMS4wICkgLyBzaGFkb3dNYXBTaXplO1xcblxcdFxcdFxcdGZsb2F0IGR4MCA9IC0gdGV4ZWxTaXplLnggKiBzaGFkb3dSYWRpdXM7XFxuXFx0XFx0XFx0ZmxvYXQgZHkwID0gLSB0ZXhlbFNpemUueSAqIHNoYWRvd1JhZGl1cztcXG5cXHRcXHRcXHRmbG9hdCBkeDEgPSArIHRleGVsU2l6ZS54ICogc2hhZG93UmFkaXVzO1xcblxcdFxcdFxcdGZsb2F0IGR5MSA9ICsgdGV4ZWxTaXplLnkgKiBzaGFkb3dSYWRpdXM7XFxuXFx0XFx0XFx0ZmxvYXQgZHgyID0gZHgwIC8gMi4wO1xcblxcdFxcdFxcdGZsb2F0IGR5MiA9IGR5MCAvIDIuMDtcXG5cXHRcXHRcXHRmbG9hdCBkeDMgPSBkeDEgLyAyLjA7XFxuXFx0XFx0XFx0ZmxvYXQgZHkzID0gZHkxIC8gMi4wO1xcblxcdFxcdFxcdHNoYWRvdyA9IChcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgwLCBkeTAgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggMC4wLCBkeTAgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgxLCBkeTAgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgyLCBkeTIgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggMC4wLCBkeTIgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgzLCBkeTIgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgwLCAwLjAgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5ICsgdmVjMiggZHgyLCAwLjAgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHNoYWRvd0Nvb3JkLnh5LCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDMsIDAuMCApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDEsIDAuMCApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDIsIGR5MyApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCAwLjAsIGR5MyApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDMsIGR5MyApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDAsIGR5MSApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCAwLjAsIGR5MSApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgc2hhZG93Q29vcmQueHkgKyB2ZWMyKCBkeDEsIGR5MSApLCBzaGFkb3dDb29yZC56IClcXG5cXHRcXHRcXHQpICogKCAxLjAgLyAxNy4wICk7XFxuXFx0XFx0I2VsaWYgZGVmaW5lZCggU0hBRE9XTUFQX1RZUEVfUENGX1NPRlQgKVxcblxcdFxcdFxcdHZlYzIgdGV4ZWxTaXplID0gdmVjMiggMS4wICkgLyBzaGFkb3dNYXBTaXplO1xcblxcdFxcdFxcdGZsb2F0IGR4ID0gdGV4ZWxTaXplLng7XFxuXFx0XFx0XFx0ZmxvYXQgZHkgPSB0ZXhlbFNpemUueTtcXG5cXHRcXHRcXHR2ZWMyIHV2ID0gc2hhZG93Q29vcmQueHk7XFxuXFx0XFx0XFx0dmVjMiBmID0gZnJhY3QoIHV2ICogc2hhZG93TWFwU2l6ZSArIDAuNSApO1xcblxcdFxcdFxcdHV2IC09IGYgKiB0ZXhlbFNpemU7XFxuXFx0XFx0XFx0c2hhZG93ID0gKFxcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYsIHNoYWRvd0Nvb3JkLnogKSArXFxuXFx0XFx0XFx0XFx0dGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIGR4LCAwLjAgKSwgc2hhZG93Q29vcmQueiApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggMC4wLCBkeSApLCBzaGFkb3dDb29yZC56ICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYgKyB0ZXhlbFNpemUsIHNoYWRvd0Nvb3JkLnogKSArXFxuXFx0XFx0XFx0XFx0bWl4KCB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggLWR4LCAwLjAgKSwgc2hhZG93Q29vcmQueiApLCBcXG5cXHRcXHRcXHRcXHRcXHQgdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIDIuMCAqIGR4LCAwLjAgKSwgc2hhZG93Q29vcmQueiApLFxcblxcdFxcdFxcdFxcdFxcdCBmLnggKSArXFxuXFx0XFx0XFx0XFx0bWl4KCB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggLWR4LCBkeSApLCBzaGFkb3dDb29yZC56ICksIFxcblxcdFxcdFxcdFxcdFxcdCB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggMi4wICogZHgsIGR5ICksIHNoYWRvd0Nvb3JkLnogKSxcXG5cXHRcXHRcXHRcXHRcXHQgZi54ICkgK1xcblxcdFxcdFxcdFxcdG1peCggdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIDAuMCwgLWR5ICksIHNoYWRvd0Nvb3JkLnogKSwgXFxuXFx0XFx0XFx0XFx0XFx0IHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgdXYgKyB2ZWMyKCAwLjAsIDIuMCAqIGR5ICksIHNoYWRvd0Nvb3JkLnogKSxcXG5cXHRcXHRcXHRcXHRcXHQgZi55ICkgK1xcblxcdFxcdFxcdFxcdG1peCggdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIGR4LCAtZHkgKSwgc2hhZG93Q29vcmQueiApLCBcXG5cXHRcXHRcXHRcXHRcXHQgdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIGR4LCAyLjAgKiBkeSApLCBzaGFkb3dDb29yZC56ICksXFxuXFx0XFx0XFx0XFx0XFx0IGYueSApICtcXG5cXHRcXHRcXHRcXHRtaXgoIG1peCggdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIC1keCwgLWR5ICksIHNoYWRvd0Nvb3JkLnogKSwgXFxuXFx0XFx0XFx0XFx0XFx0XFx0ICB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggMi4wICogZHgsIC1keSApLCBzaGFkb3dDb29yZC56ICksXFxuXFx0XFx0XFx0XFx0XFx0XFx0ICBmLnggKSxcXG5cXHRcXHRcXHRcXHRcXHQgbWl4KCB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIHV2ICsgdmVjMiggLWR4LCAyLjAgKiBkeSApLCBzaGFkb3dDb29yZC56ICksIFxcblxcdFxcdFxcdFxcdFxcdFxcdCAgdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCB1diArIHZlYzIoIDIuMCAqIGR4LCAyLjAgKiBkeSApLCBzaGFkb3dDb29yZC56ICksXFxuXFx0XFx0XFx0XFx0XFx0XFx0ICBmLnggKSxcXG5cXHRcXHRcXHRcXHRcXHQgZi55IClcXG5cXHRcXHRcXHQpICogKCAxLjAgLyA5LjAgKTtcXG5cXHRcXHQjZWxpZiBkZWZpbmVkKCBTSEFET1dNQVBfVFlQRV9WU00gKVxcblxcdFxcdFxcdHNoYWRvdyA9IFZTTVNoYWRvdyggc2hhZG93TWFwLCBzaGFkb3dDb29yZC54eSwgc2hhZG93Q29vcmQueiApO1xcblxcdFxcdCNlbHNlXFxuXFx0XFx0XFx0c2hhZG93ID0gdGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBzaGFkb3dDb29yZC54eSwgc2hhZG93Q29vcmQueiApO1xcblxcdFxcdCNlbmRpZlxcblxcdFxcdH1cXG5cXHRcXHRyZXR1cm4gc2hhZG93O1xcblxcdH1cXG5cXHR2ZWMyIGN1YmVUb1VWKCB2ZWMzIHYsIGZsb2F0IHRleGVsU2l6ZVkgKSB7XFxuXFx0XFx0dmVjMyBhYnNWID0gYWJzKCB2ICk7XFxuXFx0XFx0ZmxvYXQgc2NhbGVUb0N1YmUgPSAxLjAgLyBtYXgoIGFic1YueCwgbWF4KCBhYnNWLnksIGFic1YueiApICk7XFxuXFx0XFx0YWJzViAqPSBzY2FsZVRvQ3ViZTtcXG5cXHRcXHR2ICo9IHNjYWxlVG9DdWJlICogKCAxLjAgLSAyLjAgKiB0ZXhlbFNpemVZICk7XFxuXFx0XFx0dmVjMiBwbGFuYXIgPSB2Lnh5O1xcblxcdFxcdGZsb2F0IGFsbW9zdEFUZXhlbCA9IDEuNSAqIHRleGVsU2l6ZVk7XFxuXFx0XFx0ZmxvYXQgYWxtb3N0T25lID0gMS4wIC0gYWxtb3N0QVRleGVsO1xcblxcdFxcdGlmICggYWJzVi56ID49IGFsbW9zdE9uZSApIHtcXG5cXHRcXHRcXHRpZiAoIHYueiA+IDAuMCApXFxuXFx0XFx0XFx0XFx0cGxhbmFyLnggPSA0LjAgLSB2Lng7XFxuXFx0XFx0fSBlbHNlIGlmICggYWJzVi54ID49IGFsbW9zdE9uZSApIHtcXG5cXHRcXHRcXHRmbG9hdCBzaWduWCA9IHNpZ24oIHYueCApO1xcblxcdFxcdFxcdHBsYW5hci54ID0gdi56ICogc2lnblggKyAyLjAgKiBzaWduWDtcXG5cXHRcXHR9IGVsc2UgaWYgKCBhYnNWLnkgPj0gYWxtb3N0T25lICkge1xcblxcdFxcdFxcdGZsb2F0IHNpZ25ZID0gc2lnbiggdi55ICk7XFxuXFx0XFx0XFx0cGxhbmFyLnggPSB2LnggKyAyLjAgKiBzaWduWSArIDIuMDtcXG5cXHRcXHRcXHRwbGFuYXIueSA9IHYueiAqIHNpZ25ZIC0gMi4wO1xcblxcdFxcdH1cXG5cXHRcXHRyZXR1cm4gdmVjMiggMC4xMjUsIDAuMjUgKSAqIHBsYW5hciArIHZlYzIoIDAuMzc1LCAwLjc1ICk7XFxuXFx0fVxcblxcdGZsb2F0IGdldFBvaW50U2hhZG93KCBzYW1wbGVyMkQgc2hhZG93TWFwLCB2ZWMyIHNoYWRvd01hcFNpemUsIGZsb2F0IHNoYWRvd0JpYXMsIGZsb2F0IHNoYWRvd1JhZGl1cywgdmVjNCBzaGFkb3dDb29yZCwgZmxvYXQgc2hhZG93Q2FtZXJhTmVhciwgZmxvYXQgc2hhZG93Q2FtZXJhRmFyICkge1xcblxcdFxcdHZlYzIgdGV4ZWxTaXplID0gdmVjMiggMS4wICkgLyAoIHNoYWRvd01hcFNpemUgKiB2ZWMyKCA0LjAsIDIuMCApICk7XFxuXFx0XFx0dmVjMyBsaWdodFRvUG9zaXRpb24gPSBzaGFkb3dDb29yZC54eXo7XFxuXFx0XFx0ZmxvYXQgZHAgPSAoIGxlbmd0aCggbGlnaHRUb1Bvc2l0aW9uICkgLSBzaGFkb3dDYW1lcmFOZWFyICkgLyAoIHNoYWRvd0NhbWVyYUZhciAtIHNoYWRvd0NhbWVyYU5lYXIgKTtcXHRcXHRkcCArPSBzaGFkb3dCaWFzO1xcblxcdFxcdHZlYzMgYmQzRCA9IG5vcm1hbGl6ZSggbGlnaHRUb1Bvc2l0aW9uICk7XFxuXFx0XFx0I2lmIGRlZmluZWQoIFNIQURPV01BUF9UWVBFX1BDRiApIHx8IGRlZmluZWQoIFNIQURPV01BUF9UWVBFX1BDRl9TT0ZUICkgfHwgZGVmaW5lZCggU0hBRE9XTUFQX1RZUEVfVlNNIClcXG5cXHRcXHRcXHR2ZWMyIG9mZnNldCA9IHZlYzIoIC0gMSwgMSApICogc2hhZG93UmFkaXVzICogdGV4ZWxTaXplLnk7XFxuXFx0XFx0XFx0cmV0dXJuIChcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNEICsgb2Zmc2V0Lnh5eSwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXFxuXFx0XFx0XFx0XFx0dGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCArIG9mZnNldC55eXksIHRleGVsU2l6ZS55ICksIGRwICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgY3ViZVRvVVYoIGJkM0QgKyBvZmZzZXQueHl4LCB0ZXhlbFNpemUueSApLCBkcCApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNEICsgb2Zmc2V0Lnl5eCwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXFxuXFx0XFx0XFx0XFx0dGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXFxuXFx0XFx0XFx0XFx0dGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCArIG9mZnNldC54eHksIHRleGVsU2l6ZS55ICksIGRwICkgK1xcblxcdFxcdFxcdFxcdHRleHR1cmUyRENvbXBhcmUoIHNoYWRvd01hcCwgY3ViZVRvVVYoIGJkM0QgKyBvZmZzZXQueXh5LCB0ZXhlbFNpemUueSApLCBkcCApICtcXG5cXHRcXHRcXHRcXHR0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNEICsgb2Zmc2V0Lnh4eCwgdGV4ZWxTaXplLnkgKSwgZHAgKSArXFxuXFx0XFx0XFx0XFx0dGV4dHVyZTJEQ29tcGFyZSggc2hhZG93TWFwLCBjdWJlVG9VViggYmQzRCArIG9mZnNldC55eHgsIHRleGVsU2l6ZS55ICksIGRwIClcXG5cXHRcXHRcXHQpICogKCAxLjAgLyA5LjAgKTtcXG5cXHRcXHQjZWxzZVxcblxcdFxcdFxcdHJldHVybiB0ZXh0dXJlMkRDb21wYXJlKCBzaGFkb3dNYXAsIGN1YmVUb1VWKCBiZDNELCB0ZXhlbFNpemUueSApLCBkcCApO1xcblxcdFxcdCNlbmRpZlxcblxcdH1cXG4jZW5kaWZcIixzaGFkb3dtYXBfcGFyc192ZXJ0ZXg6XCIjaWZkZWYgVVNFX1NIQURPV01BUFxcblxcdCNpZiBOVU1fRElSX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0XFx0dW5pZm9ybSBtYXQ0IGRpcmVjdGlvbmFsU2hhZG93TWF0cml4WyBOVU1fRElSX0xJR0hUX1NIQURPV1MgXTtcXG5cXHRcXHR2YXJ5aW5nIHZlYzQgdkRpcmVjdGlvbmFsU2hhZG93Q29vcmRbIE5VTV9ESVJfTElHSFRfU0hBRE9XUyBdO1xcblxcdFxcdHN0cnVjdCBEaXJlY3Rpb25hbExpZ2h0U2hhZG93IHtcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dCaWFzO1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd05vcm1hbEJpYXM7XFxuXFx0XFx0XFx0ZmxvYXQgc2hhZG93UmFkaXVzO1xcblxcdFxcdFxcdHZlYzIgc2hhZG93TWFwU2l6ZTtcXG5cXHRcXHR9O1xcblxcdFxcdHVuaWZvcm0gRGlyZWN0aW9uYWxMaWdodFNoYWRvdyBkaXJlY3Rpb25hbExpZ2h0U2hhZG93c1sgTlVNX0RJUl9MSUdIVF9TSEFET1dTIF07XFxuXFx0I2VuZGlmXFxuXFx0I2lmIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0XFx0dW5pZm9ybSBtYXQ0IHNwb3RTaGFkb3dNYXRyaXhbIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgXTtcXG5cXHRcXHR2YXJ5aW5nIHZlYzQgdlNwb3RTaGFkb3dDb29yZFsgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyBdO1xcblxcdFxcdHN0cnVjdCBTcG90TGlnaHRTaGFkb3cge1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd0JpYXM7XFxuXFx0XFx0XFx0ZmxvYXQgc2hhZG93Tm9ybWFsQmlhcztcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dSYWRpdXM7XFxuXFx0XFx0XFx0dmVjMiBzaGFkb3dNYXBTaXplO1xcblxcdFxcdH07XFxuXFx0XFx0dW5pZm9ybSBTcG90TGlnaHRTaGFkb3cgc3BvdExpZ2h0U2hhZG93c1sgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyBdO1xcblxcdCNlbmRpZlxcblxcdCNpZiBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyA+IDBcXG5cXHRcXHR1bmlmb3JtIG1hdDQgcG9pbnRTaGFkb3dNYXRyaXhbIE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTIF07XFxuXFx0XFx0dmFyeWluZyB2ZWM0IHZQb2ludFNoYWRvd0Nvb3JkWyBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyBdO1xcblxcdFxcdHN0cnVjdCBQb2ludExpZ2h0U2hhZG93IHtcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dCaWFzO1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd05vcm1hbEJpYXM7XFxuXFx0XFx0XFx0ZmxvYXQgc2hhZG93UmFkaXVzO1xcblxcdFxcdFxcdHZlYzIgc2hhZG93TWFwU2l6ZTtcXG5cXHRcXHRcXHRmbG9hdCBzaGFkb3dDYW1lcmFOZWFyO1xcblxcdFxcdFxcdGZsb2F0IHNoYWRvd0NhbWVyYUZhcjtcXG5cXHRcXHR9O1xcblxcdFxcdHVuaWZvcm0gUG9pbnRMaWdodFNoYWRvdyBwb2ludExpZ2h0U2hhZG93c1sgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgXTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcIixzaGFkb3dtYXBfdmVydGV4OlwiI2lmZGVmIFVTRV9TSEFET1dNQVBcXG5cXHQjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMCB8fCBOVU1fU1BPVF9MSUdIVF9TSEFET1dTID4gMCB8fCBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyA+IDBcXG5cXHRcXHR2ZWMzIHNoYWRvd1dvcmxkTm9ybWFsID0gaW52ZXJzZVRyYW5zZm9ybURpcmVjdGlvbiggdHJhbnNmb3JtZWROb3JtYWwsIHZpZXdNYXRyaXggKTtcXG5cXHRcXHR2ZWM0IHNoYWRvd1dvcmxkUG9zaXRpb247XFxuXFx0I2VuZGlmXFxuXFx0I2lmIE5VTV9ESVJfTElHSFRfU0hBRE9XUyA+IDBcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0RJUl9MSUdIVF9TSEFET1dTOyBpICsrICkge1xcblxcdFxcdHNoYWRvd1dvcmxkUG9zaXRpb24gPSB3b3JsZFBvc2l0aW9uICsgdmVjNCggc2hhZG93V29ybGROb3JtYWwgKiBkaXJlY3Rpb25hbExpZ2h0U2hhZG93c1sgaSBdLnNoYWRvd05vcm1hbEJpYXMsIDAgKTtcXG5cXHRcXHR2RGlyZWN0aW9uYWxTaGFkb3dDb29yZFsgaSBdID0gZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXhbIGkgXSAqIHNoYWRvd1dvcmxkUG9zaXRpb247XFxuXFx0fVxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXFxuXFx0I2VuZGlmXFxuXFx0I2lmIE5VTV9TUE9UX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxcblxcdGZvciAoIGludCBpID0gMDsgaSA8IE5VTV9TUE9UX0xJR0hUX1NIQURPV1M7IGkgKysgKSB7XFxuXFx0XFx0c2hhZG93V29ybGRQb3NpdGlvbiA9IHdvcmxkUG9zaXRpb24gKyB2ZWM0KCBzaGFkb3dXb3JsZE5vcm1hbCAqIHNwb3RMaWdodFNoYWRvd3NbIGkgXS5zaGFkb3dOb3JtYWxCaWFzLCAwICk7XFxuXFx0XFx0dlNwb3RTaGFkb3dDb29yZFsgaSBdID0gc3BvdFNoYWRvd01hdHJpeFsgaSBdICogc2hhZG93V29ybGRQb3NpdGlvbjtcXG5cXHR9XFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcXG5cXHQjZW5kaWZcXG5cXHQjaWYgTlVNX1BPSU5UX0xJR0hUX1NIQURPV1MgPiAwXFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxcblxcdGZvciAoIGludCBpID0gMDsgaSA8IE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTOyBpICsrICkge1xcblxcdFxcdHNoYWRvd1dvcmxkUG9zaXRpb24gPSB3b3JsZFBvc2l0aW9uICsgdmVjNCggc2hhZG93V29ybGROb3JtYWwgKiBwb2ludExpZ2h0U2hhZG93c1sgaSBdLnNoYWRvd05vcm1hbEJpYXMsIDAgKTtcXG5cXHRcXHR2UG9pbnRTaGFkb3dDb29yZFsgaSBdID0gcG9pbnRTaGFkb3dNYXRyaXhbIGkgXSAqIHNoYWRvd1dvcmxkUG9zaXRpb247XFxuXFx0fVxcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3BfZW5kXFxuXFx0I2VuZGlmXFxuI2VuZGlmXCIsc2hhZG93bWFza19wYXJzX2ZyYWdtZW50OlwiZmxvYXQgZ2V0U2hhZG93TWFzaygpIHtcXG5cXHRmbG9hdCBzaGFkb3cgPSAxLjA7XFxuXFx0I2lmZGVmIFVTRV9TSEFET1dNQVBcXG5cXHQjaWYgTlVNX0RJUl9MSUdIVF9TSEFET1dTID4gMFxcblxcdERpcmVjdGlvbmFsTGlnaHRTaGFkb3cgZGlyZWN0aW9uYWxMaWdodDtcXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX3N0YXJ0XFxuXFx0Zm9yICggaW50IGkgPSAwOyBpIDwgTlVNX0RJUl9MSUdIVF9TSEFET1dTOyBpICsrICkge1xcblxcdFxcdGRpcmVjdGlvbmFsTGlnaHQgPSBkaXJlY3Rpb25hbExpZ2h0U2hhZG93c1sgaSBdO1xcblxcdFxcdHNoYWRvdyAqPSByZWNlaXZlU2hhZG93ID8gZ2V0U2hhZG93KCBkaXJlY3Rpb25hbFNoYWRvd01hcFsgaSBdLCBkaXJlY3Rpb25hbExpZ2h0LnNoYWRvd01hcFNpemUsIGRpcmVjdGlvbmFsTGlnaHQuc2hhZG93QmlhcywgZGlyZWN0aW9uYWxMaWdodC5zaGFkb3dSYWRpdXMsIHZEaXJlY3Rpb25hbFNoYWRvd0Nvb3JkWyBpIF0gKSA6IDEuMDtcXG5cXHR9XFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9lbmRcXG5cXHQjZW5kaWZcXG5cXHQjaWYgTlVNX1NQT1RfTElHSFRfU0hBRE9XUyA+IDBcXG5cXHRTcG90TGlnaHRTaGFkb3cgc3BvdExpZ2h0O1xcblxcdCNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnRcXG5cXHRmb3IgKCBpbnQgaSA9IDA7IGkgPCBOVU1fU1BPVF9MSUdIVF9TSEFET1dTOyBpICsrICkge1xcblxcdFxcdHNwb3RMaWdodCA9IHNwb3RMaWdodFNoYWRvd3NbIGkgXTtcXG5cXHRcXHRzaGFkb3cgKj0gcmVjZWl2ZVNoYWRvdyA/IGdldFNoYWRvdyggc3BvdFNoYWRvd01hcFsgaSBdLCBzcG90TGlnaHQuc2hhZG93TWFwU2l6ZSwgc3BvdExpZ2h0LnNoYWRvd0JpYXMsIHNwb3RMaWdodC5zaGFkb3dSYWRpdXMsIHZTcG90U2hhZG93Q29vcmRbIGkgXSApIDogMS4wO1xcblxcdH1cXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxcblxcdCNlbmRpZlxcblxcdCNpZiBOVU1fUE9JTlRfTElHSFRfU0hBRE9XUyA+IDBcXG5cXHRQb2ludExpZ2h0U2hhZG93IHBvaW50TGlnaHQ7XFxuXFx0I3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxcblxcdGZvciAoIGludCBpID0gMDsgaSA8IE5VTV9QT0lOVF9MSUdIVF9TSEFET1dTOyBpICsrICkge1xcblxcdFxcdHBvaW50TGlnaHQgPSBwb2ludExpZ2h0U2hhZG93c1sgaSBdO1xcblxcdFxcdHNoYWRvdyAqPSByZWNlaXZlU2hhZG93ID8gZ2V0UG9pbnRTaGFkb3coIHBvaW50U2hhZG93TWFwWyBpIF0sIHBvaW50TGlnaHQuc2hhZG93TWFwU2l6ZSwgcG9pbnRMaWdodC5zaGFkb3dCaWFzLCBwb2ludExpZ2h0LnNoYWRvd1JhZGl1cywgdlBvaW50U2hhZG93Q29vcmRbIGkgXSwgcG9pbnRMaWdodC5zaGFkb3dDYW1lcmFOZWFyLCBwb2ludExpZ2h0LnNoYWRvd0NhbWVyYUZhciApIDogMS4wO1xcblxcdH1cXG5cXHQjcHJhZ21hIHVucm9sbF9sb29wX2VuZFxcblxcdCNlbmRpZlxcblxcdCNlbmRpZlxcblxcdHJldHVybiBzaGFkb3c7XFxufVwiLHNraW5iYXNlX3ZlcnRleDpcIiNpZmRlZiBVU0VfU0tJTk5JTkdcXG5cXHRtYXQ0IGJvbmVNYXRYID0gZ2V0Qm9uZU1hdHJpeCggc2tpbkluZGV4LnggKTtcXG5cXHRtYXQ0IGJvbmVNYXRZID0gZ2V0Qm9uZU1hdHJpeCggc2tpbkluZGV4LnkgKTtcXG5cXHRtYXQ0IGJvbmVNYXRaID0gZ2V0Qm9uZU1hdHJpeCggc2tpbkluZGV4LnogKTtcXG5cXHRtYXQ0IGJvbmVNYXRXID0gZ2V0Qm9uZU1hdHJpeCggc2tpbkluZGV4LncgKTtcXG4jZW5kaWZcIixza2lubmluZ19wYXJzX3ZlcnRleDpcIiNpZmRlZiBVU0VfU0tJTk5JTkdcXG5cXHR1bmlmb3JtIG1hdDQgYmluZE1hdHJpeDtcXG5cXHR1bmlmb3JtIG1hdDQgYmluZE1hdHJpeEludmVyc2U7XFxuXFx0I2lmZGVmIEJPTkVfVEVYVFVSRVxcblxcdFxcdHVuaWZvcm0gaGlnaHAgc2FtcGxlcjJEIGJvbmVUZXh0dXJlO1xcblxcdFxcdHVuaWZvcm0gaW50IGJvbmVUZXh0dXJlU2l6ZTtcXG5cXHRcXHRtYXQ0IGdldEJvbmVNYXRyaXgoIGNvbnN0IGluIGZsb2F0IGkgKSB7XFxuXFx0XFx0XFx0ZmxvYXQgaiA9IGkgKiA0LjA7XFxuXFx0XFx0XFx0ZmxvYXQgeCA9IG1vZCggaiwgZmxvYXQoIGJvbmVUZXh0dXJlU2l6ZSApICk7XFxuXFx0XFx0XFx0ZmxvYXQgeSA9IGZsb29yKCBqIC8gZmxvYXQoIGJvbmVUZXh0dXJlU2l6ZSApICk7XFxuXFx0XFx0XFx0ZmxvYXQgZHggPSAxLjAgLyBmbG9hdCggYm9uZVRleHR1cmVTaXplICk7XFxuXFx0XFx0XFx0ZmxvYXQgZHkgPSAxLjAgLyBmbG9hdCggYm9uZVRleHR1cmVTaXplICk7XFxuXFx0XFx0XFx0eSA9IGR5ICogKCB5ICsgMC41ICk7XFxuXFx0XFx0XFx0dmVjNCB2MSA9IHRleHR1cmUyRCggYm9uZVRleHR1cmUsIHZlYzIoIGR4ICogKCB4ICsgMC41ICksIHkgKSApO1xcblxcdFxcdFxcdHZlYzQgdjIgPSB0ZXh0dXJlMkQoIGJvbmVUZXh0dXJlLCB2ZWMyKCBkeCAqICggeCArIDEuNSApLCB5ICkgKTtcXG5cXHRcXHRcXHR2ZWM0IHYzID0gdGV4dHVyZTJEKCBib25lVGV4dHVyZSwgdmVjMiggZHggKiAoIHggKyAyLjUgKSwgeSApICk7XFxuXFx0XFx0XFx0dmVjNCB2NCA9IHRleHR1cmUyRCggYm9uZVRleHR1cmUsIHZlYzIoIGR4ICogKCB4ICsgMy41ICksIHkgKSApO1xcblxcdFxcdFxcdG1hdDQgYm9uZSA9IG1hdDQoIHYxLCB2MiwgdjMsIHY0ICk7XFxuXFx0XFx0XFx0cmV0dXJuIGJvbmU7XFxuXFx0XFx0fVxcblxcdCNlbHNlXFxuXFx0XFx0dW5pZm9ybSBtYXQ0IGJvbmVNYXRyaWNlc1sgTUFYX0JPTkVTIF07XFxuXFx0XFx0bWF0NCBnZXRCb25lTWF0cml4KCBjb25zdCBpbiBmbG9hdCBpICkge1xcblxcdFxcdFxcdG1hdDQgYm9uZSA9IGJvbmVNYXRyaWNlc1sgaW50KGkpIF07XFxuXFx0XFx0XFx0cmV0dXJuIGJvbmU7XFxuXFx0XFx0fVxcblxcdCNlbmRpZlxcbiNlbmRpZlwiLHNraW5uaW5nX3ZlcnRleDpcIiNpZmRlZiBVU0VfU0tJTk5JTkdcXG5cXHR2ZWM0IHNraW5WZXJ0ZXggPSBiaW5kTWF0cml4ICogdmVjNCggdHJhbnNmb3JtZWQsIDEuMCApO1xcblxcdHZlYzQgc2tpbm5lZCA9IHZlYzQoIDAuMCApO1xcblxcdHNraW5uZWQgKz0gYm9uZU1hdFggKiBza2luVmVydGV4ICogc2tpbldlaWdodC54O1xcblxcdHNraW5uZWQgKz0gYm9uZU1hdFkgKiBza2luVmVydGV4ICogc2tpbldlaWdodC55O1xcblxcdHNraW5uZWQgKz0gYm9uZU1hdFogKiBza2luVmVydGV4ICogc2tpbldlaWdodC56O1xcblxcdHNraW5uZWQgKz0gYm9uZU1hdFcgKiBza2luVmVydGV4ICogc2tpbldlaWdodC53O1xcblxcdHRyYW5zZm9ybWVkID0gKCBiaW5kTWF0cml4SW52ZXJzZSAqIHNraW5uZWQgKS54eXo7XFxuI2VuZGlmXCIsc2tpbm5vcm1hbF92ZXJ0ZXg6XCIjaWZkZWYgVVNFX1NLSU5OSU5HXFxuXFx0bWF0NCBza2luTWF0cml4ID0gbWF0NCggMC4wICk7XFxuXFx0c2tpbk1hdHJpeCArPSBza2luV2VpZ2h0LnggKiBib25lTWF0WDtcXG5cXHRza2luTWF0cml4ICs9IHNraW5XZWlnaHQueSAqIGJvbmVNYXRZO1xcblxcdHNraW5NYXRyaXggKz0gc2tpbldlaWdodC56ICogYm9uZU1hdFo7XFxuXFx0c2tpbk1hdHJpeCArPSBza2luV2VpZ2h0LncgKiBib25lTWF0VztcXG5cXHRza2luTWF0cml4ID0gYmluZE1hdHJpeEludmVyc2UgKiBza2luTWF0cml4ICogYmluZE1hdHJpeDtcXG5cXHRvYmplY3ROb3JtYWwgPSB2ZWM0KCBza2luTWF0cml4ICogdmVjNCggb2JqZWN0Tm9ybWFsLCAwLjAgKSApLnh5ejtcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHRvYmplY3RUYW5nZW50ID0gdmVjNCggc2tpbk1hdHJpeCAqIHZlYzQoIG9iamVjdFRhbmdlbnQsIDAuMCApICkueHl6O1xcblxcdCNlbmRpZlxcbiNlbmRpZlwiLHNwZWN1bGFybWFwX2ZyYWdtZW50OlwiZmxvYXQgc3BlY3VsYXJTdHJlbmd0aDtcXG4jaWZkZWYgVVNFX1NQRUNVTEFSTUFQXFxuXFx0dmVjNCB0ZXhlbFNwZWN1bGFyID0gdGV4dHVyZTJEKCBzcGVjdWxhck1hcCwgdlV2ICk7XFxuXFx0c3BlY3VsYXJTdHJlbmd0aCA9IHRleGVsU3BlY3VsYXIucjtcXG4jZWxzZVxcblxcdHNwZWN1bGFyU3RyZW5ndGggPSAxLjA7XFxuI2VuZGlmXCIsc3BlY3VsYXJtYXBfcGFyc19mcmFnbWVudDpcIiNpZmRlZiBVU0VfU1BFQ1VMQVJNQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCBzcGVjdWxhck1hcDtcXG4jZW5kaWZcIix0b25lbWFwcGluZ19mcmFnbWVudDpcIiNpZiBkZWZpbmVkKCBUT05FX01BUFBJTkcgKVxcblxcdGdsX0ZyYWdDb2xvci5yZ2IgPSB0b25lTWFwcGluZyggZ2xfRnJhZ0NvbG9yLnJnYiApO1xcbiNlbmRpZlwiLHRvbmVtYXBwaW5nX3BhcnNfZnJhZ21lbnQ6XCIjaWZuZGVmIHNhdHVyYXRlXFxuI2RlZmluZSBzYXR1cmF0ZShhKSBjbGFtcCggYSwgMC4wLCAxLjAgKVxcbiNlbmRpZlxcbnVuaWZvcm0gZmxvYXQgdG9uZU1hcHBpbmdFeHBvc3VyZTtcXG52ZWMzIExpbmVhclRvbmVNYXBwaW5nKCB2ZWMzIGNvbG9yICkge1xcblxcdHJldHVybiB0b25lTWFwcGluZ0V4cG9zdXJlICogY29sb3I7XFxufVxcbnZlYzMgUmVpbmhhcmRUb25lTWFwcGluZyggdmVjMyBjb2xvciApIHtcXG5cXHRjb2xvciAqPSB0b25lTWFwcGluZ0V4cG9zdXJlO1xcblxcdHJldHVybiBzYXR1cmF0ZSggY29sb3IgLyAoIHZlYzMoIDEuMCApICsgY29sb3IgKSApO1xcbn1cXG52ZWMzIE9wdGltaXplZENpbmVvblRvbmVNYXBwaW5nKCB2ZWMzIGNvbG9yICkge1xcblxcdGNvbG9yICo9IHRvbmVNYXBwaW5nRXhwb3N1cmU7XFxuXFx0Y29sb3IgPSBtYXgoIHZlYzMoIDAuMCApLCBjb2xvciAtIDAuMDA0ICk7XFxuXFx0cmV0dXJuIHBvdyggKCBjb2xvciAqICggNi4yICogY29sb3IgKyAwLjUgKSApIC8gKCBjb2xvciAqICggNi4yICogY29sb3IgKyAxLjcgKSArIDAuMDYgKSwgdmVjMyggMi4yICkgKTtcXG59XFxudmVjMyBSUlRBbmRPRFRGaXQoIHZlYzMgdiApIHtcXG5cXHR2ZWMzIGEgPSB2ICogKCB2ICsgMC4wMjQ1Nzg2ICkgLSAwLjAwMDA5MDUzNztcXG5cXHR2ZWMzIGIgPSB2ICogKCAwLjk4MzcyOSAqIHYgKyAwLjQzMjk1MTAgKSArIDAuMjM4MDgxO1xcblxcdHJldHVybiBhIC8gYjtcXG59XFxudmVjMyBBQ0VTRmlsbWljVG9uZU1hcHBpbmcoIHZlYzMgY29sb3IgKSB7XFxuXFx0Y29uc3QgbWF0MyBBQ0VTSW5wdXRNYXQgPSBtYXQzKFxcblxcdFxcdHZlYzMoIDAuNTk3MTksIDAuMDc2MDAsIDAuMDI4NDAgKSxcXHRcXHR2ZWMzKCAwLjM1NDU4LCAwLjkwODM0LCAwLjEzMzgzICksXFxuXFx0XFx0dmVjMyggMC4wNDgyMywgMC4wMTU2NiwgMC44Mzc3NyApXFxuXFx0KTtcXG5cXHRjb25zdCBtYXQzIEFDRVNPdXRwdXRNYXQgPSBtYXQzKFxcblxcdFxcdHZlYzMoICAxLjYwNDc1LCAtMC4xMDIwOCwgLTAuMDAzMjcgKSxcXHRcXHR2ZWMzKCAtMC41MzEwOCwgIDEuMTA4MTMsIC0wLjA3Mjc2ICksXFxuXFx0XFx0dmVjMyggLTAuMDczNjcsIC0wLjAwNjA1LCAgMS4wNzYwMiApXFxuXFx0KTtcXG5cXHRjb2xvciAqPSB0b25lTWFwcGluZ0V4cG9zdXJlIC8gMC42O1xcblxcdGNvbG9yID0gQUNFU0lucHV0TWF0ICogY29sb3I7XFxuXFx0Y29sb3IgPSBSUlRBbmRPRFRGaXQoIGNvbG9yICk7XFxuXFx0Y29sb3IgPSBBQ0VTT3V0cHV0TWF0ICogY29sb3I7XFxuXFx0cmV0dXJuIHNhdHVyYXRlKCBjb2xvciApO1xcbn1cXG52ZWMzIEN1c3RvbVRvbmVNYXBwaW5nKCB2ZWMzIGNvbG9yICkgeyByZXR1cm4gY29sb3I7IH1cIix0cmFuc21pc3Npb25tYXBfZnJhZ21lbnQ6XCIjaWZkZWYgVVNFX1RSQU5TTUlTU0lPTk1BUFxcblxcdHRvdGFsVHJhbnNtaXNzaW9uICo9IHRleHR1cmUyRCggdHJhbnNtaXNzaW9uTWFwLCB2VXYgKS5yO1xcbiNlbmRpZlwiLHRyYW5zbWlzc2lvbm1hcF9wYXJzX2ZyYWdtZW50OlwiI2lmZGVmIFVTRV9UUkFOU01JU1NJT05NQVBcXG5cXHR1bmlmb3JtIHNhbXBsZXIyRCB0cmFuc21pc3Npb25NYXA7XFxuI2VuZGlmXCIsdXZfcGFyc19mcmFnbWVudDpcIiNpZiAoIGRlZmluZWQoIFVTRV9VViApICYmICEgZGVmaW5lZCggVVZTX1ZFUlRFWF9PTkxZICkgKVxcblxcdHZhcnlpbmcgdmVjMiB2VXY7XFxuI2VuZGlmXCIsdXZfcGFyc192ZXJ0ZXg6XCIjaWZkZWYgVVNFX1VWXFxuXFx0I2lmZGVmIFVWU19WRVJURVhfT05MWVxcblxcdFxcdHZlYzIgdlV2O1xcblxcdCNlbHNlXFxuXFx0XFx0dmFyeWluZyB2ZWMyIHZVdjtcXG5cXHQjZW5kaWZcXG5cXHR1bmlmb3JtIG1hdDMgdXZUcmFuc2Zvcm07XFxuI2VuZGlmXCIsdXZfdmVydGV4OlwiI2lmZGVmIFVTRV9VVlxcblxcdHZVdiA9ICggdXZUcmFuc2Zvcm0gKiB2ZWMzKCB1diwgMSApICkueHk7XFxuI2VuZGlmXCIsdXYyX3BhcnNfZnJhZ21lbnQ6XCIjaWYgZGVmaW5lZCggVVNFX0xJR0hUTUFQICkgfHwgZGVmaW5lZCggVVNFX0FPTUFQIClcXG5cXHR2YXJ5aW5nIHZlYzIgdlV2MjtcXG4jZW5kaWZcIix1djJfcGFyc192ZXJ0ZXg6XCIjaWYgZGVmaW5lZCggVVNFX0xJR0hUTUFQICkgfHwgZGVmaW5lZCggVVNFX0FPTUFQIClcXG5cXHRhdHRyaWJ1dGUgdmVjMiB1djI7XFxuXFx0dmFyeWluZyB2ZWMyIHZVdjI7XFxuXFx0dW5pZm9ybSBtYXQzIHV2MlRyYW5zZm9ybTtcXG4jZW5kaWZcIix1djJfdmVydGV4OlwiI2lmIGRlZmluZWQoIFVTRV9MSUdIVE1BUCApIHx8IGRlZmluZWQoIFVTRV9BT01BUCApXFxuXFx0dlV2MiA9ICggdXYyVHJhbnNmb3JtICogdmVjMyggdXYyLCAxICkgKS54eTtcXG4jZW5kaWZcIix3b3JsZHBvc192ZXJ0ZXg6XCIjaWYgZGVmaW5lZCggVVNFX0VOVk1BUCApIHx8IGRlZmluZWQoIERJU1RBTkNFICkgfHwgZGVmaW5lZCAoIFVTRV9TSEFET1dNQVAgKVxcblxcdHZlYzQgd29ybGRQb3NpdGlvbiA9IHZlYzQoIHRyYW5zZm9ybWVkLCAxLjAgKTtcXG5cXHQjaWZkZWYgVVNFX0lOU1RBTkNJTkdcXG5cXHRcXHR3b3JsZFBvc2l0aW9uID0gaW5zdGFuY2VNYXRyaXggKiB3b3JsZFBvc2l0aW9uO1xcblxcdCNlbmRpZlxcblxcdHdvcmxkUG9zaXRpb24gPSBtb2RlbE1hdHJpeCAqIHdvcmxkUG9zaXRpb247XFxuI2VuZGlmXCIsYmFja2dyb3VuZF9mcmFnOlwidW5pZm9ybSBzYW1wbGVyMkQgdDJEO1xcbnZhcnlpbmcgdmVjMiB2VXY7XFxudm9pZCBtYWluKCkge1xcblxcdHZlYzQgdGV4Q29sb3IgPSB0ZXh0dXJlMkQoIHQyRCwgdlV2ICk7XFxuXFx0Z2xfRnJhZ0NvbG9yID0gbWFwVGV4ZWxUb0xpbmVhciggdGV4Q29sb3IgKTtcXG5cXHQjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cXG59XCIsYmFja2dyb3VuZF92ZXJ0OlwidmFyeWluZyB2ZWMyIHZVdjtcXG51bmlmb3JtIG1hdDMgdXZUcmFuc2Zvcm07XFxudm9pZCBtYWluKCkge1xcblxcdHZVdiA9ICggdXZUcmFuc2Zvcm0gKiB2ZWMzKCB1diwgMSApICkueHk7XFxuXFx0Z2xfUG9zaXRpb24gPSB2ZWM0KCBwb3NpdGlvbi54eSwgMS4wLCAxLjAgKTtcXG59XCIsY3ViZV9mcmFnOlwiI2luY2x1ZGUgPGVudm1hcF9jb21tb25fcGFyc19mcmFnbWVudD5cXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxudmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcXG4jaW5jbHVkZSA8Y3ViZV91dl9yZWZsZWN0aW9uX2ZyYWdtZW50PlxcbnZvaWQgbWFpbigpIHtcXG5cXHR2ZWMzIHZSZWZsZWN0ID0gdldvcmxkRGlyZWN0aW9uO1xcblxcdCNpbmNsdWRlIDxlbnZtYXBfZnJhZ21lbnQ+XFxuXFx0Z2xfRnJhZ0NvbG9yID0gZW52Q29sb3I7XFxuXFx0Z2xfRnJhZ0NvbG9yLmEgKj0gb3BhY2l0eTtcXG5cXHQjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cXG59XCIsY3ViZV92ZXJ0OlwidmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbnZvaWQgbWFpbigpIHtcXG5cXHR2V29ybGREaXJlY3Rpb24gPSB0cmFuc2Zvcm1EaXJlY3Rpb24oIHBvc2l0aW9uLCBtb2RlbE1hdHJpeCApO1xcblxcdCNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdGdsX1Bvc2l0aW9uLnogPSBnbF9Qb3NpdGlvbi53O1xcbn1cIixkZXB0aF9mcmFnOlwiI2lmIERFUFRIX1BBQ0tJTkcgPT0gMzIwMFxcblxcdHVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG4jZW5kaWZcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDxwYWNraW5nPlxcbiNpbmNsdWRlIDx1dl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XFxudmFyeWluZyB2ZWMyIHZIaWdoUHJlY2lzaW9uWlc7XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XFxuXFx0dmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCAxLjAgKTtcXG5cXHQjaWYgREVQVEhfUEFDS0lORyA9PSAzMjAwXFxuXFx0XFx0ZGlmZnVzZUNvbG9yLmEgPSBvcGFjaXR5O1xcblxcdCNlbmRpZlxcblxcdCNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxcblxcdGZsb2F0IGZyYWdDb29yZFogPSAwLjUgKiB2SGlnaFByZWNpc2lvblpXWzBdIC8gdkhpZ2hQcmVjaXNpb25aV1sxXSArIDAuNTtcXG5cXHQjaWYgREVQVEhfUEFDS0lORyA9PSAzMjAwXFxuXFx0XFx0Z2xfRnJhZ0NvbG9yID0gdmVjNCggdmVjMyggMS4wIC0gZnJhZ0Nvb3JkWiApLCBvcGFjaXR5ICk7XFxuXFx0I2VsaWYgREVQVEhfUEFDS0lORyA9PSAzMjAxXFxuXFx0XFx0Z2xfRnJhZ0NvbG9yID0gcGFja0RlcHRoVG9SR0JBKCBmcmFnQ29vcmRaICk7XFxuXFx0I2VuZGlmXFxufVwiLGRlcHRoX3ZlcnQ6XCIjaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XFxudmFyeWluZyB2ZWMyIHZIaWdoUHJlY2lzaW9uWlc7XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDx1dl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5iYXNlX3ZlcnRleD5cXG5cXHQjaWZkZWYgVVNFX0RJU1BMQUNFTUVOVE1BUFxcblxcdFxcdCNpbmNsdWRlIDxiZWdpbm5vcm1hbF92ZXJ0ZXg+XFxuXFx0XFx0I2luY2x1ZGUgPG1vcnBobm9ybWFsX3ZlcnRleD5cXG5cXHRcXHQjaW5jbHVkZSA8c2tpbm5vcm1hbF92ZXJ0ZXg+XFxuXFx0I2VuZGlmXFxuXFx0I2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGh0YXJnZXRfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2lubmluZ192ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGRpc3BsYWNlbWVudG1hcF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc192ZXJ0ZXg+XFxuXFx0dkhpZ2hQcmVjaXNpb25aVyA9IGdsX1Bvc2l0aW9uLnp3O1xcbn1cIixkaXN0YW5jZVJHQkFfZnJhZzpcIiNkZWZpbmUgRElTVEFOQ0VcXG51bmlmb3JtIHZlYzMgcmVmZXJlbmNlUG9zaXRpb247XFxudW5pZm9ybSBmbG9hdCBuZWFyRGlzdGFuY2U7XFxudW5pZm9ybSBmbG9hdCBmYXJEaXN0YW5jZTtcXG52YXJ5aW5nIHZlYzMgdldvcmxkUG9zaXRpb247XFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8cGFja2luZz5cXG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGFscGhhbWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50PlxcbnZvaWQgbWFpbiAoKSB7XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cXG5cXHR2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIDEuMCApO1xcblxcdCNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XFxuXFx0ZmxvYXQgZGlzdCA9IGxlbmd0aCggdldvcmxkUG9zaXRpb24gLSByZWZlcmVuY2VQb3NpdGlvbiApO1xcblxcdGRpc3QgPSAoIGRpc3QgLSBuZWFyRGlzdGFuY2UgKSAvICggZmFyRGlzdGFuY2UgLSBuZWFyRGlzdGFuY2UgKTtcXG5cXHRkaXN0ID0gc2F0dXJhdGUoIGRpc3QgKTtcXG5cXHRnbF9GcmFnQ29sb3IgPSBwYWNrRGVwdGhUb1JHQkEoIGRpc3QgKTtcXG59XCIsZGlzdGFuY2VSR0JBX3ZlcnQ6XCIjZGVmaW5lIERJU1RBTkNFXFxudmFyeWluZyB2ZWMzIHZXb3JsZFBvc2l0aW9uO1xcbiNpbmNsdWRlIDxjb21tb24+XFxuI2luY2x1ZGUgPHV2X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8dXZfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2lmZGVmIFVTRV9ESVNQTEFDRU1FTlRNQVBcXG5cXHRcXHQjaW5jbHVkZSA8YmVnaW5ub3JtYWxfdmVydGV4PlxcblxcdFxcdCNpbmNsdWRlIDxtb3JwaG5vcm1hbF92ZXJ0ZXg+XFxuXFx0XFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNlbmRpZlxcblxcdCNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8c2tpbm5pbmdfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxwcm9qZWN0X3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfdmVydGV4PlxcblxcdHZXb3JsZFBvc2l0aW9uID0gd29ybGRQb3NpdGlvbi54eXo7XFxufVwiLGVxdWlyZWN0X2ZyYWc6XCJ1bmlmb3JtIHNhbXBsZXIyRCB0RXF1aXJlY3Q7XFxudmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbnZvaWQgbWFpbigpIHtcXG5cXHR2ZWMzIGRpcmVjdGlvbiA9IG5vcm1hbGl6ZSggdldvcmxkRGlyZWN0aW9uICk7XFxuXFx0dmVjMiBzYW1wbGVVViA9IGVxdWlyZWN0VXYoIGRpcmVjdGlvbiApO1xcblxcdHZlYzQgdGV4Q29sb3IgPSB0ZXh0dXJlMkQoIHRFcXVpcmVjdCwgc2FtcGxlVVYgKTtcXG5cXHRnbF9GcmFnQ29sb3IgPSBtYXBUZXhlbFRvTGluZWFyKCB0ZXhDb2xvciApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50Plxcbn1cIixlcXVpcmVjdF92ZXJ0OlwidmFyeWluZyB2ZWMzIHZXb3JsZERpcmVjdGlvbjtcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbnZvaWQgbWFpbigpIHtcXG5cXHR2V29ybGREaXJlY3Rpb24gPSB0cmFuc2Zvcm1EaXJlY3Rpb24oIHBvc2l0aW9uLCBtb2RlbE1hdHJpeCApO1xcblxcdCNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4Plxcbn1cIixsaW5lZGFzaGVkX2ZyYWc6XCJ1bmlmb3JtIHZlYzMgZGlmZnVzZTtcXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxudW5pZm9ybSBmbG9hdCBkYXNoU2l6ZTtcXG51bmlmb3JtIGZsb2F0IHRvdGFsU2l6ZTtcXG52YXJ5aW5nIGZsb2F0IHZMaW5lRGlzdGFuY2U7XFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8Y29sb3JfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50PlxcblxcdGlmICggbW9kKCB2TGluZURpc3RhbmNlLCB0b3RhbFNpemUgKSA+IGRhc2hTaXplICkge1xcblxcdFxcdGRpc2NhcmQ7XFxuXFx0fVxcblxcdHZlYzMgb3V0Z29pbmdMaWdodCA9IHZlYzMoIDAuMCApO1xcblxcdHZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggZGlmZnVzZSwgb3BhY2l0eSApO1xcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8Y29sb3JfZnJhZ21lbnQ+XFxuXFx0b3V0Z29pbmdMaWdodCA9IGRpZmZ1c2VDb2xvci5yZ2I7XFxuXFx0Z2xfRnJhZ0NvbG9yID0gdmVjNCggb3V0Z29pbmdMaWdodCwgZGlmZnVzZUNvbG9yLmEgKTtcXG5cXHQjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50Plxcbn1cIixsaW5lZGFzaGVkX3ZlcnQ6XCJ1bmlmb3JtIGZsb2F0IHNjYWxlO1xcbmF0dHJpYnV0ZSBmbG9hdCBsaW5lRGlzdGFuY2U7XFxudmFyeWluZyBmbG9hdCB2TGluZURpc3RhbmNlO1xcbiNpbmNsdWRlIDxjb21tb24+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxcbnZvaWQgbWFpbigpIHtcXG5cXHR2TGluZURpc3RhbmNlID0gc2NhbGUgKiBsaW5lRGlzdGFuY2U7XFxuXFx0I2luY2x1ZGUgPGNvbG9yX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc192ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGZvZ192ZXJ0ZXg+XFxufVwiLG1lc2hiYXNpY19mcmFnOlwidW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XFxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xcbiNpZm5kZWYgRkxBVF9TSEFERURcXG5cXHR2YXJ5aW5nIHZlYzMgdk5vcm1hbDtcXG4jZW5kaWZcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDxkaXRoZXJpbmdfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y29sb3JfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8dXYyX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxhb21hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsaWdodG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxlbnZtYXBfY29tbW9uX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGVudm1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxzcGVjdWxhcm1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc19mcmFnbWVudD5cXG52b2lkIG1haW4oKSB7XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cXG5cXHR2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcXG5cXHQjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8Y29sb3JfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPHNwZWN1bGFybWFwX2ZyYWdtZW50PlxcblxcdFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ID0gUmVmbGVjdGVkTGlnaHQoIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApICk7XFxuXFx0I2lmZGVmIFVTRV9MSUdIVE1BUFxcblxcdFxcblxcdFxcdHZlYzQgbGlnaHRNYXBUZXhlbD0gdGV4dHVyZTJEKCBsaWdodE1hcCwgdlV2MiApO1xcblxcdFxcdHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSBsaWdodE1hcFRleGVsVG9MaW5lYXIoIGxpZ2h0TWFwVGV4ZWwgKS5yZ2IgKiBsaWdodE1hcEludGVuc2l0eTtcXG5cXHQjZWxzZVxcblxcdFxcdHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSB2ZWMzKCAxLjAgKTtcXG5cXHQjZW5kaWZcXG5cXHQjaW5jbHVkZSA8YW9tYXBfZnJhZ21lbnQ+XFxuXFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICo9IGRpZmZ1c2VDb2xvci5yZ2I7XFxuXFx0dmVjMyBvdXRnb2luZ0xpZ2h0ID0gcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlO1xcblxcdCNpbmNsdWRlIDxlbnZtYXBfZnJhZ21lbnQ+XFxuXFx0Z2xfRnJhZ0NvbG9yID0gdmVjNCggb3V0Z29pbmdMaWdodCwgZGlmZnVzZUNvbG9yLmEgKTtcXG5cXHQjaW5jbHVkZSA8dG9uZW1hcHBpbmdfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGVuY29kaW5nc19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxwcmVtdWx0aXBsaWVkX2FscGhhX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxkaXRoZXJpbmdfZnJhZ21lbnQ+XFxufVwiLG1lc2hiYXNpY192ZXJ0OlwiI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPHV2Ml9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8ZW52bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDx1dl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHV2Ml92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGNvbG9yX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8c2tpbmJhc2VfdmVydGV4PlxcblxcdCNpZmRlZiBVU0VfRU5WTUFQXFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZGVmYXVsdG5vcm1hbF92ZXJ0ZXg+XFxuXFx0I2VuZGlmXFxuXFx0I2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGh0YXJnZXRfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2lubmluZ192ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHdvcmxkcG9zX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZW52bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cXG59XCIsbWVzaGxhbWJlcnRfZnJhZzpcInVuaWZvcm0gdmVjMyBkaWZmdXNlO1xcbnVuaWZvcm0gdmVjMyBlbWlzc2l2ZTtcXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxudmFyeWluZyB2ZWMzIHZMaWdodEZyb250O1xcbnZhcnlpbmcgdmVjMyB2SW5kaXJlY3RGcm9udDtcXG4jaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0dmFyeWluZyB2ZWMzIHZMaWdodEJhY2s7XFxuXFx0dmFyeWluZyB2ZWMzIHZJbmRpcmVjdEJhY2s7XFxuI2VuZGlmXFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8cGFja2luZz5cXG4jaW5jbHVkZSA8ZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2Ml9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YW9tYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bGlnaHRtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8ZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8ZW52bWFwX2NvbW1vbl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxlbnZtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y3ViZV91dl9yZWZsZWN0aW9uX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxic2Rmcz5cXG4jaW5jbHVkZSA8bGlnaHRzX3BhcnNfYmVnaW4+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxzaGFkb3dtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8c2hhZG93bWFza19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxzcGVjdWxhcm1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc19mcmFnbWVudD5cXG52b2lkIG1haW4oKSB7XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cXG5cXHR2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcXG5cXHRSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCA9IFJlZmxlY3RlZExpZ2h0KCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSApO1xcblxcdHZlYzMgdG90YWxFbWlzc2l2ZVJhZGlhbmNlID0gZW1pc3NpdmU7XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGNvbG9yX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxhbHBoYW1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8YWxwaGF0ZXN0X2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxzcGVjdWxhcm1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW1pc3NpdmVtYXBfZnJhZ21lbnQ+XFxuXFx0I2lmZGVmIERPVUJMRV9TSURFRFxcblxcdFxcdHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArPSAoIGdsX0Zyb250RmFjaW5nICkgPyB2SW5kaXJlY3RGcm9udCA6IHZJbmRpcmVjdEJhY2s7XFxuXFx0I2Vsc2VcXG5cXHRcXHRyZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKz0gdkluZGlyZWN0RnJvbnQ7XFxuXFx0I2VuZGlmXFxuXFx0I2luY2x1ZGUgPGxpZ2h0bWFwX2ZyYWdtZW50PlxcblxcdHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSAqPSBCUkRGX0RpZmZ1c2VfTGFtYmVydCggZGlmZnVzZUNvbG9yLnJnYiApO1xcblxcdCNpZmRlZiBET1VCTEVfU0lERURcXG5cXHRcXHRyZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlID0gKCBnbF9Gcm9udEZhY2luZyApID8gdkxpZ2h0RnJvbnQgOiB2TGlnaHRCYWNrO1xcblxcdCNlbHNlXFxuXFx0XFx0cmVmbGVjdGVkTGlnaHQuZGlyZWN0RGlmZnVzZSA9IHZMaWdodEZyb250O1xcblxcdCNlbmRpZlxcblxcdHJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgKj0gQlJERl9EaWZmdXNlX0xhbWJlcnQoIGRpZmZ1c2VDb2xvci5yZ2IgKSAqIGdldFNoYWRvd01hc2soKTtcXG5cXHQjaW5jbHVkZSA8YW9tYXBfZnJhZ21lbnQ+XFxuXFx0dmVjMyBvdXRnb2luZ0xpZ2h0ID0gcmVmbGVjdGVkTGlnaHQuZGlyZWN0RGlmZnVzZSArIHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArIHRvdGFsRW1pc3NpdmVSYWRpYW5jZTtcXG5cXHQjaW5jbHVkZSA8ZW52bWFwX2ZyYWdtZW50PlxcblxcdGdsX0ZyYWdDb2xvciA9IHZlYzQoIG91dGdvaW5nTGlnaHQsIGRpZmZ1c2VDb2xvci5hICk7XFxuXFx0I2luY2x1ZGUgPHRvbmVtYXBwaW5nX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxlbmNvZGluZ3NfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGZvZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8cHJlbXVsdGlwbGllZF9hbHBoYV9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZGl0aGVyaW5nX2ZyYWdtZW50Plxcbn1cIixtZXNobGFtYmVydF92ZXJ0OlwiI2RlZmluZSBMQU1CRVJUXFxudmFyeWluZyB2ZWMzIHZMaWdodEZyb250O1xcbnZhcnlpbmcgdmVjMyB2SW5kaXJlY3RGcm9udDtcXG4jaWZkZWYgRE9VQkxFX1NJREVEXFxuXFx0dmFyeWluZyB2ZWMzIHZMaWdodEJhY2s7XFxuXFx0dmFyeWluZyB2ZWMzIHZJbmRpcmVjdEJhY2s7XFxuI2VuZGlmXFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPHV2Ml9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8ZW52bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxic2Rmcz5cXG4jaW5jbHVkZSA8bGlnaHRzX3BhcnNfYmVnaW4+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8dXZfdmVydGV4PlxcblxcdCNpbmNsdWRlIDx1djJfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxlbnZtYXBfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxsaWdodHNfbGFtYmVydF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNoYWRvd21hcF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGZvZ192ZXJ0ZXg+XFxufVwiLG1lc2htYXRjYXBfZnJhZzpcIiNkZWZpbmUgTUFUQ0FQXFxudW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XFxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xcbnVuaWZvcm0gc2FtcGxlcjJEIG1hdGNhcDtcXG52YXJ5aW5nIHZlYzMgdlZpZXdQb3NpdGlvbjtcXG4jaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0dmFyeWluZyB2ZWMzIHZOb3JtYWw7XFxuI2VuZGlmXFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8ZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxmb2dfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YnVtcG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxub3JtYWxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XFxuXFx0dmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGNvbG9yX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxhbHBoYW1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8YWxwaGF0ZXN0X2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxub3JtYWxfZnJhZ21lbnRfYmVnaW4+XFxuXFx0I2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9tYXBzPlxcblxcdHZlYzMgdmlld0RpciA9IG5vcm1hbGl6ZSggdlZpZXdQb3NpdGlvbiApO1xcblxcdHZlYzMgeCA9IG5vcm1hbGl6ZSggdmVjMyggdmlld0Rpci56LCAwLjAsIC0gdmlld0Rpci54ICkgKTtcXG5cXHR2ZWMzIHkgPSBjcm9zcyggdmlld0RpciwgeCApO1xcblxcdHZlYzIgdXYgPSB2ZWMyKCBkb3QoIHgsIG5vcm1hbCApLCBkb3QoIHksIG5vcm1hbCApICkgKiAwLjQ5NSArIDAuNTtcXG5cXHQjaWZkZWYgVVNFX01BVENBUFxcblxcdFxcdHZlYzQgbWF0Y2FwQ29sb3IgPSB0ZXh0dXJlMkQoIG1hdGNhcCwgdXYgKTtcXG5cXHRcXHRtYXRjYXBDb2xvciA9IG1hdGNhcFRleGVsVG9MaW5lYXIoIG1hdGNhcENvbG9yICk7XFxuXFx0I2Vsc2VcXG5cXHRcXHR2ZWM0IG1hdGNhcENvbG9yID0gdmVjNCggMS4wICk7XFxuXFx0I2VuZGlmXFxuXFx0dmVjMyBvdXRnb2luZ0xpZ2h0ID0gZGlmZnVzZUNvbG9yLnJnYiAqIG1hdGNhcENvbG9yLnJnYjtcXG5cXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KCBvdXRnb2luZ0xpZ2h0LCBkaWZmdXNlQ29sb3IuYSApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGRpdGhlcmluZ19mcmFnbWVudD5cXG59XCIsbWVzaG1hdGNhcF92ZXJ0OlwiI2RlZmluZSBNQVRDQVBcXG52YXJ5aW5nIHZlYzMgdlZpZXdQb3NpdGlvbjtcXG4jaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0dmFyeWluZyB2ZWMzIHZOb3JtYWw7XFxuI2VuZGlmXFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8bW9ycGh0YXJnZXRfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPHNraW5uaW5nX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8dXZfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cXG5cXHQjaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0XFx0dk5vcm1hbCA9IG5vcm1hbGl6ZSggdHJhbnNmb3JtZWROb3JtYWwgKTtcXG5cXHQjZW5kaWZcXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cXG5cXHR2Vmlld1Bvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcXG59XCIsbWVzaHRvb25fZnJhZzpcIiNkZWZpbmUgVE9PTlxcbnVuaWZvcm0gdmVjMyBkaWZmdXNlO1xcbnVuaWZvcm0gdmVjMyBlbWlzc2l2ZTtcXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8cGFja2luZz5cXG4jaW5jbHVkZSA8ZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2Ml9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YW9tYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bGlnaHRtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8ZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Z3JhZGllbnRtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGJzZGZzPlxcbiNpbmNsdWRlIDxsaWdodHNfcGFyc19iZWdpbj5cXG4jaW5jbHVkZSA8bGlnaHRzX3Rvb25fcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGJ1bXBtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bm9ybWFsbWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50PlxcblxcdHZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggZGlmZnVzZSwgb3BhY2l0eSApO1xcblxcdFJlZmxlY3RlZExpZ2h0IHJlZmxlY3RlZExpZ2h0ID0gUmVmbGVjdGVkTGlnaHQoIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApICk7XFxuXFx0dmVjMyB0b3RhbEVtaXNzaXZlUmFkaWFuY2UgPSBlbWlzc2l2ZTtcXG5cXHQjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8Y29sb3JfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxhbHBoYXRlc3RfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9iZWdpbj5cXG5cXHQjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X21hcHM+XFxuXFx0I2luY2x1ZGUgPGVtaXNzaXZlbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxsaWdodHNfdG9vbl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X2JlZ2luPlxcblxcdCNpbmNsdWRlIDxsaWdodHNfZnJhZ21lbnRfbWFwcz5cXG5cXHQjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X2VuZD5cXG5cXHQjaW5jbHVkZSA8YW9tYXBfZnJhZ21lbnQ+XFxuXFx0dmVjMyBvdXRnb2luZ0xpZ2h0ID0gcmVmbGVjdGVkTGlnaHQuZGlyZWN0RGlmZnVzZSArIHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0RGlmZnVzZSArIHRvdGFsRW1pc3NpdmVSYWRpYW5jZTtcXG5cXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KCBvdXRnb2luZ0xpZ2h0LCBkaWZmdXNlQ29sb3IuYSApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGRpdGhlcmluZ19mcmFnbWVudD5cXG59XCIsbWVzaHRvb25fdmVydDpcIiNkZWZpbmUgVE9PTlxcbnZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xcbiNpZm5kZWYgRkxBVF9TSEFERURcXG5cXHR2YXJ5aW5nIHZlYzMgdk5vcm1hbDtcXG4jZW5kaWZcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8dXYyX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8dXZfdmVydGV4PlxcblxcdCNpbmNsdWRlIDx1djJfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cXG4jaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0dk5vcm1hbCA9IG5vcm1hbGl6ZSggdHJhbnNmb3JtZWROb3JtYWwgKTtcXG4jZW5kaWZcXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG5cXHR2Vmlld1Bvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcXG5cXHQjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxzaGFkb3dtYXBfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxmb2dfdmVydGV4Plxcbn1cIixtZXNocGhvbmdfZnJhZzpcIiNkZWZpbmUgUEhPTkdcXG51bmlmb3JtIHZlYzMgZGlmZnVzZTtcXG51bmlmb3JtIHZlYzMgZW1pc3NpdmU7XFxudW5pZm9ybSB2ZWMzIHNwZWN1bGFyO1xcbnVuaWZvcm0gZmxvYXQgc2hpbmluZXNzO1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDxwYWNraW5nPlxcbiNpbmNsdWRlIDxkaXRoZXJpbmdfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y29sb3JfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8dXYyX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxhb21hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsaWdodG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxlbWlzc2l2ZW1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxlbnZtYXBfY29tbW9uX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGVudm1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxic2Rmcz5cXG4jaW5jbHVkZSA8bGlnaHRzX3BhcnNfYmVnaW4+XFxuI2luY2x1ZGUgPGxpZ2h0c19waG9uZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxzaGFkb3dtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YnVtcG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxub3JtYWxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8c3BlY3VsYXJtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XFxuXFx0dmVjNCBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBkaWZmdXNlLCBvcGFjaXR5ICk7XFxuXFx0UmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQgPSBSZWZsZWN0ZWRMaWdodCggdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICkgKTtcXG5cXHR2ZWMzIHRvdGFsRW1pc3NpdmVSYWRpYW5jZSA9IGVtaXNzaXZlO1xcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8bWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxjb2xvcl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8YWxwaGFtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8c3BlY3VsYXJtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9iZWdpbj5cXG5cXHQjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X21hcHM+XFxuXFx0I2luY2x1ZGUgPGVtaXNzaXZlbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxsaWdodHNfcGhvbmdfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGxpZ2h0c19mcmFnbWVudF9iZWdpbj5cXG5cXHQjaW5jbHVkZSA8bGlnaHRzX2ZyYWdtZW50X21hcHM+XFxuXFx0I2luY2x1ZGUgPGxpZ2h0c19mcmFnbWVudF9lbmQ+XFxuXFx0I2luY2x1ZGUgPGFvbWFwX2ZyYWdtZW50PlxcblxcdHZlYzMgb3V0Z29pbmdMaWdodCA9IHJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgKyByZWZsZWN0ZWRMaWdodC5pbmRpcmVjdERpZmZ1c2UgKyByZWZsZWN0ZWRMaWdodC5kaXJlY3RTcGVjdWxhciArIHJlZmxlY3RlZExpZ2h0LmluZGlyZWN0U3BlY3VsYXIgKyB0b3RhbEVtaXNzaXZlUmFkaWFuY2U7XFxuXFx0I2luY2x1ZGUgPGVudm1hcF9mcmFnbWVudD5cXG5cXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KCBvdXRnb2luZ0xpZ2h0LCBkaWZmdXNlQ29sb3IuYSApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGRpdGhlcmluZ19mcmFnbWVudD5cXG59XCIsbWVzaHBob25nX3ZlcnQ6XCIjZGVmaW5lIFBIT05HXFxudmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XFxuI2lmbmRlZiBGTEFUX1NIQURFRFxcblxcdHZhcnlpbmcgdmVjMyB2Tm9ybWFsO1xcbiNlbmRpZlxcbiNpbmNsdWRlIDxjb21tb24+XFxuI2luY2x1ZGUgPHV2X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDx1djJfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGRpc3BsYWNlbWVudG1hcF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8ZW52bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cXG52b2lkIG1haW4oKSB7XFxuXFx0I2luY2x1ZGUgPHV2X3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8dXYyX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y29sb3JfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxiZWdpbm5vcm1hbF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPG1vcnBobm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8c2tpbmJhc2VfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZGVmYXVsdG5vcm1hbF92ZXJ0ZXg+XFxuI2lmbmRlZiBGTEFUX1NIQURFRFxcblxcdHZOb3JtYWwgPSBub3JtYWxpemUoIHRyYW5zZm9ybWVkTm9ybWFsICk7XFxuI2VuZGlmXFxuXFx0I2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGh0YXJnZXRfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2lubmluZ192ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGRpc3BsYWNlbWVudG1hcF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc192ZXJ0ZXg+XFxuXFx0dlZpZXdQb3NpdGlvbiA9IC0gbXZQb3NpdGlvbi54eXo7XFxuXFx0I2luY2x1ZGUgPHdvcmxkcG9zX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZW52bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8c2hhZG93bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cXG59XCIsbWVzaHBoeXNpY2FsX2ZyYWc6XCIjZGVmaW5lIFNUQU5EQVJEXFxuI2lmZGVmIFBIWVNJQ0FMXFxuXFx0I2RlZmluZSBSRUZMRUNUSVZJVFlcXG5cXHQjZGVmaW5lIENMRUFSQ09BVFxcblxcdCNkZWZpbmUgVFJBTlNNSVNTSU9OXFxuI2VuZGlmXFxudW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XFxudW5pZm9ybSB2ZWMzIGVtaXNzaXZlO1xcbnVuaWZvcm0gZmxvYXQgcm91Z2huZXNzO1xcbnVuaWZvcm0gZmxvYXQgbWV0YWxuZXNzO1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG4jaWZkZWYgVFJBTlNNSVNTSU9OXFxuXFx0dW5pZm9ybSBmbG9hdCB0cmFuc21pc3Npb247XFxuI2VuZGlmXFxuI2lmZGVmIFJFRkxFQ1RJVklUWVxcblxcdHVuaWZvcm0gZmxvYXQgcmVmbGVjdGl2aXR5O1xcbiNlbmRpZlxcbiNpZmRlZiBDTEVBUkNPQVRcXG5cXHR1bmlmb3JtIGZsb2F0IGNsZWFyY29hdDtcXG5cXHR1bmlmb3JtIGZsb2F0IGNsZWFyY29hdFJvdWdobmVzcztcXG4jZW5kaWZcXG4jaWZkZWYgVVNFX1NIRUVOXFxuXFx0dW5pZm9ybSB2ZWMzIHNoZWVuO1xcbiNlbmRpZlxcbnZhcnlpbmcgdmVjMyB2Vmlld1Bvc2l0aW9uO1xcbiNpZm5kZWYgRkxBVF9TSEFERURcXG5cXHR2YXJ5aW5nIHZlYzMgdk5vcm1hbDtcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHR2YXJ5aW5nIHZlYzMgdlRhbmdlbnQ7XFxuXFx0XFx0dmFyeWluZyB2ZWMzIHZCaXRhbmdlbnQ7XFxuXFx0I2VuZGlmXFxuI2VuZGlmXFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8cGFja2luZz5cXG4jaW5jbHVkZSA8ZGl0aGVyaW5nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2X3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHV2Ml9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YWxwaGFtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YW9tYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bGlnaHRtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8ZW1pc3NpdmVtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8dHJhbnNtaXNzaW9ubWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGJzZGZzPlxcbiNpbmNsdWRlIDxjdWJlX3V2X3JlZmxlY3Rpb25fZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGVudm1hcF9jb21tb25fcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8ZW52bWFwX3BoeXNpY2FsX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsaWdodHNfcGFyc19iZWdpbj5cXG4jaW5jbHVkZSA8bGlnaHRzX3BoeXNpY2FsX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxidW1wbWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPG5vcm1hbG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjbGVhcmNvYXRfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8cm91Z2huZXNzbWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPG1ldGFsbmVzc21hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc19mcmFnbWVudD5cXG52b2lkIG1haW4oKSB7XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cXG5cXHR2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcXG5cXHRSZWZsZWN0ZWRMaWdodCByZWZsZWN0ZWRMaWdodCA9IFJlZmxlY3RlZExpZ2h0KCB2ZWMzKCAwLjAgKSwgdmVjMyggMC4wICksIHZlYzMoIDAuMCApLCB2ZWMzKCAwLjAgKSApO1xcblxcdHZlYzMgdG90YWxFbWlzc2l2ZVJhZGlhbmNlID0gZW1pc3NpdmU7XFxuXFx0I2lmZGVmIFRSQU5TTUlTU0lPTlxcblxcdFxcdGZsb2F0IHRvdGFsVHJhbnNtaXNzaW9uID0gdHJhbnNtaXNzaW9uO1xcblxcdCNlbmRpZlxcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8bWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxjb2xvcl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8YWxwaGFtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8cm91Z2huZXNzbWFwX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxtZXRhbG5lc3NtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9iZWdpbj5cXG5cXHQjaW5jbHVkZSA8bm9ybWFsX2ZyYWdtZW50X21hcHM+XFxuXFx0I2luY2x1ZGUgPGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfYmVnaW4+XFxuXFx0I2luY2x1ZGUgPGNsZWFyY29hdF9ub3JtYWxfZnJhZ21lbnRfbWFwcz5cXG5cXHQjaW5jbHVkZSA8ZW1pc3NpdmVtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPHRyYW5zbWlzc2lvbm1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8bGlnaHRzX3BoeXNpY2FsX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxsaWdodHNfZnJhZ21lbnRfYmVnaW4+XFxuXFx0I2luY2x1ZGUgPGxpZ2h0c19mcmFnbWVudF9tYXBzPlxcblxcdCNpbmNsdWRlIDxsaWdodHNfZnJhZ21lbnRfZW5kPlxcblxcdCNpbmNsdWRlIDxhb21hcF9mcmFnbWVudD5cXG5cXHR2ZWMzIG91dGdvaW5nTGlnaHQgPSByZWZsZWN0ZWRMaWdodC5kaXJlY3REaWZmdXNlICsgcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlICsgcmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgKyByZWZsZWN0ZWRMaWdodC5pbmRpcmVjdFNwZWN1bGFyICsgdG90YWxFbWlzc2l2ZVJhZGlhbmNlO1xcblxcdCNpZmRlZiBUUkFOU01JU1NJT05cXG5cXHRcXHRkaWZmdXNlQ29sb3IuYSAqPSBtaXgoIHNhdHVyYXRlKCAxLiAtIHRvdGFsVHJhbnNtaXNzaW9uICsgbGluZWFyVG9SZWxhdGl2ZUx1bWluYW5jZSggcmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgKyByZWZsZWN0ZWRMaWdodC5pbmRpcmVjdFNwZWN1bGFyICkgKSwgMS4wLCBtZXRhbG5lc3MgKTtcXG5cXHQjZW5kaWZcXG5cXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KCBvdXRnb2luZ0xpZ2h0LCBkaWZmdXNlQ29sb3IuYSApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPHByZW11bHRpcGxpZWRfYWxwaGFfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGRpdGhlcmluZ19mcmFnbWVudD5cXG59XCIsbWVzaHBoeXNpY2FsX3ZlcnQ6XCIjZGVmaW5lIFNUQU5EQVJEXFxudmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XFxuI2lmbmRlZiBGTEFUX1NIQURFRFxcblxcdHZhcnlpbmcgdmVjMyB2Tm9ybWFsO1xcblxcdCNpZmRlZiBVU0VfVEFOR0VOVFxcblxcdFxcdHZhcnlpbmcgdmVjMyB2VGFuZ2VudDtcXG5cXHRcXHR2YXJ5aW5nIHZlYzMgdkJpdGFuZ2VudDtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8dXYyX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxkaXNwbGFjZW1lbnRtYXBfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGNvbG9yX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPG1vcnBodGFyZ2V0X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2hhZG93bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfdmVydGV4PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8dXZfdmVydGV4PlxcblxcdCNpbmNsdWRlIDx1djJfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxjb2xvcl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cXG4jaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0dk5vcm1hbCA9IG5vcm1hbGl6ZSggdHJhbnNmb3JtZWROb3JtYWwgKTtcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHR2VGFuZ2VudCA9IG5vcm1hbGl6ZSggdHJhbnNmb3JtZWRUYW5nZW50ICk7XFxuXFx0XFx0dkJpdGFuZ2VudCA9IG5vcm1hbGl6ZSggY3Jvc3MoIHZOb3JtYWwsIHZUYW5nZW50ICkgKiB0YW5nZW50LncgKTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG5cXHR2Vmlld1Bvc2l0aW9uID0gLSBtdlBvc2l0aW9uLnh5ejtcXG5cXHQjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxzaGFkb3dtYXBfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxmb2dfdmVydGV4Plxcbn1cIixub3JtYWxfZnJhZzpcIiNkZWZpbmUgTk9STUFMXFxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xcbiNpZiBkZWZpbmVkKCBGTEFUX1NIQURFRCApIHx8IGRlZmluZWQoIFVTRV9CVU1QTUFQICkgfHwgZGVmaW5lZCggVEFOR0VOVFNQQUNFX05PUk1BTE1BUCApXFxuXFx0dmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XFxuI2VuZGlmXFxuI2lmbmRlZiBGTEFUX1NIQURFRFxcblxcdHZhcnlpbmcgdmVjMyB2Tm9ybWFsO1xcblxcdCNpZmRlZiBVU0VfVEFOR0VOVFxcblxcdFxcdHZhcnlpbmcgdmVjMyB2VGFuZ2VudDtcXG5cXHRcXHR2YXJ5aW5nIHZlYzMgdkJpdGFuZ2VudDtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG4jaW5jbHVkZSA8cGFja2luZz5cXG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8YnVtcG1hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxub3JtYWxtYXBfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3BhcnNfZnJhZ21lbnQ+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxub3JtYWxfZnJhZ21lbnRfYmVnaW4+XFxuXFx0I2luY2x1ZGUgPG5vcm1hbF9mcmFnbWVudF9tYXBzPlxcblxcdGdsX0ZyYWdDb2xvciA9IHZlYzQoIHBhY2tOb3JtYWxUb1JHQiggbm9ybWFsICksIG9wYWNpdHkgKTtcXG59XCIsbm9ybWFsX3ZlcnQ6XCIjZGVmaW5lIE5PUk1BTFxcbiNpZiBkZWZpbmVkKCBGTEFUX1NIQURFRCApIHx8IGRlZmluZWQoIFVTRV9CVU1QTUFQICkgfHwgZGVmaW5lZCggVEFOR0VOVFNQQUNFX05PUk1BTE1BUCApXFxuXFx0dmFyeWluZyB2ZWMzIHZWaWV3UG9zaXRpb247XFxuI2VuZGlmXFxuI2lmbmRlZiBGTEFUX1NIQURFRFxcblxcdHZhcnlpbmcgdmVjMyB2Tm9ybWFsO1xcblxcdCNpZmRlZiBVU0VfVEFOR0VOVFxcblxcdFxcdHZhcnlpbmcgdmVjMyB2VGFuZ2VudDtcXG5cXHRcXHR2YXJ5aW5nIHZlYzMgdkJpdGFuZ2VudDtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDx1dl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8c2tpbm5pbmdfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDx1dl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cXG4jaWZuZGVmIEZMQVRfU0hBREVEXFxuXFx0dk5vcm1hbCA9IG5vcm1hbGl6ZSggdHJhbnNmb3JtZWROb3JtYWwgKTtcXG5cXHQjaWZkZWYgVVNFX1RBTkdFTlRcXG5cXHRcXHR2VGFuZ2VudCA9IG5vcm1hbGl6ZSggdHJhbnNmb3JtZWRUYW5nZW50ICk7XFxuXFx0XFx0dkJpdGFuZ2VudCA9IG5vcm1hbGl6ZSggY3Jvc3MoIHZOb3JtYWwsIHZUYW5nZW50ICkgKiB0YW5nZW50LncgKTtcXG5cXHQjZW5kaWZcXG4jZW5kaWZcXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8ZGlzcGxhY2VtZW50bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8cHJvamVjdF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG4jaWYgZGVmaW5lZCggRkxBVF9TSEFERUQgKSB8fCBkZWZpbmVkKCBVU0VfQlVNUE1BUCApIHx8IGRlZmluZWQoIFRBTkdFTlRTUEFDRV9OT1JNQUxNQVAgKVxcblxcdHZWaWV3UG9zaXRpb24gPSAtIG12UG9zaXRpb24ueHl6O1xcbiNlbmRpZlxcbn1cIixwb2ludHNfZnJhZzpcInVuaWZvcm0gdmVjMyBkaWZmdXNlO1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDxjb2xvcl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxtYXBfcGFydGljbGVfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50PlxcbnZvaWQgbWFpbigpIHtcXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX2ZyYWdtZW50PlxcblxcdHZlYzMgb3V0Z29pbmdMaWdodCA9IHZlYzMoIDAuMCApO1xcblxcdHZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggZGlmZnVzZSwgb3BhY2l0eSApO1xcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8bWFwX3BhcnRpY2xlX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxjb2xvcl9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8YWxwaGF0ZXN0X2ZyYWdtZW50PlxcblxcdG91dGdvaW5nTGlnaHQgPSBkaWZmdXNlQ29sb3IucmdiO1xcblxcdGdsX0ZyYWdDb2xvciA9IHZlYzQoIG91dGdvaW5nTGlnaHQsIGRpZmZ1c2VDb2xvci5hICk7XFxuXFx0I2luY2x1ZGUgPHRvbmVtYXBwaW5nX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxlbmNvZGluZ3NfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGZvZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8cHJlbXVsdGlwbGllZF9hbHBoYV9mcmFnbWVudD5cXG59XCIscG9pbnRzX3ZlcnQ6XCJ1bmlmb3JtIGZsb2F0IHNpemU7XFxudW5pZm9ybSBmbG9hdCBzY2FsZTtcXG4jaW5jbHVkZSA8Y29tbW9uPlxcbiNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cXG4jaW5jbHVkZSA8bG9nZGVwdGhidWZfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX3ZlcnRleD5cXG52b2lkIG1haW4oKSB7XFxuXFx0I2luY2x1ZGUgPGNvbG9yX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8YmVnaW5fdmVydGV4PlxcblxcdCNpbmNsdWRlIDxtb3JwaHRhcmdldF92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdGdsX1BvaW50U2l6ZSA9IHNpemU7XFxuXFx0I2lmZGVmIFVTRV9TSVpFQVRURU5VQVRJT05cXG5cXHRcXHRib29sIGlzUGVyc3BlY3RpdmUgPSBpc1BlcnNwZWN0aXZlTWF0cml4KCBwcm9qZWN0aW9uTWF0cml4ICk7XFxuXFx0XFx0aWYgKCBpc1BlcnNwZWN0aXZlICkgZ2xfUG9pbnRTaXplICo9ICggc2NhbGUgLyAtIG12UG9zaXRpb24ueiApO1xcblxcdCNlbmRpZlxcblxcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc192ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHdvcmxkcG9zX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cXG59XCIsc2hhZG93X2ZyYWc6XCJ1bmlmb3JtIHZlYzMgY29sb3I7XFxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xcbiNpbmNsdWRlIDxjb21tb24+XFxuI2luY2x1ZGUgPHBhY2tpbmc+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxic2Rmcz5cXG4jaW5jbHVkZSA8bGlnaHRzX3BhcnNfYmVnaW4+XFxuI2luY2x1ZGUgPHNoYWRvd21hcF9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxzaGFkb3dtYXNrX3BhcnNfZnJhZ21lbnQ+XFxudm9pZCBtYWluKCkge1xcblxcdGdsX0ZyYWdDb2xvciA9IHZlYzQoIGNvbG9yLCBvcGFjaXR5ICogKCAxLjAgLSBnZXRTaGFkb3dNYXNrKCkgKSApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XFxufVwiLHNoYWRvd192ZXJ0OlwiI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8Zm9nX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxzaGFkb3dtYXBfcGFyc192ZXJ0ZXg+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDxiZWdpbl92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxcblxcdCNpbmNsdWRlIDx3b3JsZHBvc192ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPGJlZ2lubm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxza2luYmFzZV92ZXJ0ZXg+XFxuXFx0I2luY2x1ZGUgPHNraW5ub3JtYWxfdmVydGV4PlxcblxcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8c2hhZG93bWFwX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cXG59XCIsc3ByaXRlX2ZyYWc6XCJ1bmlmb3JtIHZlYzMgZGlmZnVzZTtcXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxuI2luY2x1ZGUgPGNvbW1vbj5cXG4jaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cXG4jaW5jbHVkZSA8bWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGFscGhhbWFwX3BhcnNfZnJhZ21lbnQ+XFxuI2luY2x1ZGUgPGZvZ19wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc19mcmFnbWVudD5cXG52b2lkIG1haW4oKSB7XFxuXFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cXG5cXHR2ZWMzIG91dGdvaW5nTGlnaHQgPSB2ZWMzKCAwLjAgKTtcXG5cXHR2ZWM0IGRpZmZ1c2VDb2xvciA9IHZlYzQoIGRpZmZ1c2UsIG9wYWNpdHkgKTtcXG5cXHQjaW5jbHVkZSA8bG9nZGVwdGhidWZfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPG1hcF9mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8YWxwaGFtYXBfZnJhZ21lbnQ+XFxuXFx0I2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cXG5cXHRvdXRnb2luZ0xpZ2h0ID0gZGlmZnVzZUNvbG9yLnJnYjtcXG5cXHRnbF9GcmFnQ29sb3IgPSB2ZWM0KCBvdXRnb2luZ0xpZ2h0LCBkaWZmdXNlQ29sb3IuYSApO1xcblxcdCNpbmNsdWRlIDx0b25lbWFwcGluZ19mcmFnbWVudD5cXG5cXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxcblxcdCNpbmNsdWRlIDxmb2dfZnJhZ21lbnQ+XFxufVwiLHNwcml0ZV92ZXJ0OlwidW5pZm9ybSBmbG9hdCByb3RhdGlvbjtcXG51bmlmb3JtIHZlYzIgY2VudGVyO1xcbiNpbmNsdWRlIDxjb21tb24+XFxuI2luY2x1ZGUgPHV2X3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxmb2dfcGFyc192ZXJ0ZXg+XFxuI2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3BhcnNfdmVydGV4PlxcbiNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XFxudm9pZCBtYWluKCkge1xcblxcdCNpbmNsdWRlIDx1dl92ZXJ0ZXg+XFxuXFx0dmVjNCBtdlBvc2l0aW9uID0gbW9kZWxWaWV3TWF0cml4ICogdmVjNCggMC4wLCAwLjAsIDAuMCwgMS4wICk7XFxuXFx0dmVjMiBzY2FsZTtcXG5cXHRzY2FsZS54ID0gbGVuZ3RoKCB2ZWMzKCBtb2RlbE1hdHJpeFsgMCBdLngsIG1vZGVsTWF0cml4WyAwIF0ueSwgbW9kZWxNYXRyaXhbIDAgXS56ICkgKTtcXG5cXHRzY2FsZS55ID0gbGVuZ3RoKCB2ZWMzKCBtb2RlbE1hdHJpeFsgMSBdLngsIG1vZGVsTWF0cml4WyAxIF0ueSwgbW9kZWxNYXRyaXhbIDEgXS56ICkgKTtcXG5cXHQjaWZuZGVmIFVTRV9TSVpFQVRURU5VQVRJT05cXG5cXHRcXHRib29sIGlzUGVyc3BlY3RpdmUgPSBpc1BlcnNwZWN0aXZlTWF0cml4KCBwcm9qZWN0aW9uTWF0cml4ICk7XFxuXFx0XFx0aWYgKCBpc1BlcnNwZWN0aXZlICkgc2NhbGUgKj0gLSBtdlBvc2l0aW9uLno7XFxuXFx0I2VuZGlmXFxuXFx0dmVjMiBhbGlnbmVkUG9zaXRpb24gPSAoIHBvc2l0aW9uLnh5IC0gKCBjZW50ZXIgLSB2ZWMyKCAwLjUgKSApICkgKiBzY2FsZTtcXG5cXHR2ZWMyIHJvdGF0ZWRQb3NpdGlvbjtcXG5cXHRyb3RhdGVkUG9zaXRpb24ueCA9IGNvcyggcm90YXRpb24gKSAqIGFsaWduZWRQb3NpdGlvbi54IC0gc2luKCByb3RhdGlvbiApICogYWxpZ25lZFBvc2l0aW9uLnk7XFxuXFx0cm90YXRlZFBvc2l0aW9uLnkgPSBzaW4oIHJvdGF0aW9uICkgKiBhbGlnbmVkUG9zaXRpb24ueCArIGNvcyggcm90YXRpb24gKSAqIGFsaWduZWRQb3NpdGlvbi55O1xcblxcdG12UG9zaXRpb24ueHkgKz0gcm90YXRlZFBvc2l0aW9uO1xcblxcdGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG12UG9zaXRpb247XFxuXFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cXG5cXHQjaW5jbHVkZSA8Zm9nX3ZlcnRleD5cXG59XCJ9LFhzPXtjb21tb246e2RpZmZ1c2U6e3ZhbHVlOm5ldyBEcigxNTY1ODczNCl9LG9wYWNpdHk6e3ZhbHVlOjF9LG1hcDp7dmFsdWU6bnVsbH0sdXZUcmFuc2Zvcm06e3ZhbHVlOm5ldyBzbn0sdXYyVHJhbnNmb3JtOnt2YWx1ZTpuZXcgc259LGFscGhhTWFwOnt2YWx1ZTpudWxsfX0sc3BlY3VsYXJtYXA6e3NwZWN1bGFyTWFwOnt2YWx1ZTpudWxsfX0sZW52bWFwOntlbnZNYXA6e3ZhbHVlOm51bGx9LGZsaXBFbnZNYXA6e3ZhbHVlOi0xfSxyZWZsZWN0aXZpdHk6e3ZhbHVlOjF9LHJlZnJhY3Rpb25SYXRpbzp7dmFsdWU6Ljk4fSxtYXhNaXBMZXZlbDp7dmFsdWU6MH19LGFvbWFwOnthb01hcDp7dmFsdWU6bnVsbH0sYW9NYXBJbnRlbnNpdHk6e3ZhbHVlOjF9fSxsaWdodG1hcDp7bGlnaHRNYXA6e3ZhbHVlOm51bGx9LGxpZ2h0TWFwSW50ZW5zaXR5Ont2YWx1ZToxfX0sZW1pc3NpdmVtYXA6e2VtaXNzaXZlTWFwOnt2YWx1ZTpudWxsfX0sYnVtcG1hcDp7YnVtcE1hcDp7dmFsdWU6bnVsbH0sYnVtcFNjYWxlOnt2YWx1ZToxfX0sbm9ybWFsbWFwOntub3JtYWxNYXA6e3ZhbHVlOm51bGx9LG5vcm1hbFNjYWxlOnt2YWx1ZTpuZXcgcm4oMSwxKX19LGRpc3BsYWNlbWVudG1hcDp7ZGlzcGxhY2VtZW50TWFwOnt2YWx1ZTpudWxsfSxkaXNwbGFjZW1lbnRTY2FsZTp7dmFsdWU6MX0sZGlzcGxhY2VtZW50Qmlhczp7dmFsdWU6MH19LHJvdWdobmVzc21hcDp7cm91Z2huZXNzTWFwOnt2YWx1ZTpudWxsfX0sbWV0YWxuZXNzbWFwOnttZXRhbG5lc3NNYXA6e3ZhbHVlOm51bGx9fSxncmFkaWVudG1hcDp7Z3JhZGllbnRNYXA6e3ZhbHVlOm51bGx9fSxmb2c6e2ZvZ0RlbnNpdHk6e3ZhbHVlOjI1ZS01fSxmb2dOZWFyOnt2YWx1ZToxfSxmb2dGYXI6e3ZhbHVlOjJlM30sZm9nQ29sb3I6e3ZhbHVlOm5ldyBEcigxNjc3NzIxNSl9fSxsaWdodHM6e2FtYmllbnRMaWdodENvbG9yOnt2YWx1ZTpbXX0sbGlnaHRQcm9iZTp7dmFsdWU6W119LGRpcmVjdGlvbmFsTGlnaHRzOnt2YWx1ZTpbXSxwcm9wZXJ0aWVzOntkaXJlY3Rpb246e30sY29sb3I6e319fSxkaXJlY3Rpb25hbExpZ2h0U2hhZG93czp7dmFsdWU6W10scHJvcGVydGllczp7c2hhZG93Qmlhczp7fSxzaGFkb3dOb3JtYWxCaWFzOnt9LHNoYWRvd1JhZGl1czp7fSxzaGFkb3dNYXBTaXplOnt9fX0sZGlyZWN0aW9uYWxTaGFkb3dNYXA6e3ZhbHVlOltdfSxkaXJlY3Rpb25hbFNoYWRvd01hdHJpeDp7dmFsdWU6W119LHNwb3RMaWdodHM6e3ZhbHVlOltdLHByb3BlcnRpZXM6e2NvbG9yOnt9LHBvc2l0aW9uOnt9LGRpcmVjdGlvbjp7fSxkaXN0YW5jZTp7fSxjb25lQ29zOnt9LHBlbnVtYnJhQ29zOnt9LGRlY2F5Ont9fX0sc3BvdExpZ2h0U2hhZG93czp7dmFsdWU6W10scHJvcGVydGllczp7c2hhZG93Qmlhczp7fSxzaGFkb3dOb3JtYWxCaWFzOnt9LHNoYWRvd1JhZGl1czp7fSxzaGFkb3dNYXBTaXplOnt9fX0sc3BvdFNoYWRvd01hcDp7dmFsdWU6W119LHNwb3RTaGFkb3dNYXRyaXg6e3ZhbHVlOltdfSxwb2ludExpZ2h0czp7dmFsdWU6W10scHJvcGVydGllczp7Y29sb3I6e30scG9zaXRpb246e30sZGVjYXk6e30sZGlzdGFuY2U6e319fSxwb2ludExpZ2h0U2hhZG93czp7dmFsdWU6W10scHJvcGVydGllczp7c2hhZG93Qmlhczp7fSxzaGFkb3dOb3JtYWxCaWFzOnt9LHNoYWRvd1JhZGl1czp7fSxzaGFkb3dNYXBTaXplOnt9LHNoYWRvd0NhbWVyYU5lYXI6e30sc2hhZG93Q2FtZXJhRmFyOnt9fX0scG9pbnRTaGFkb3dNYXA6e3ZhbHVlOltdfSxwb2ludFNoYWRvd01hdHJpeDp7dmFsdWU6W119LGhlbWlzcGhlcmVMaWdodHM6e3ZhbHVlOltdLHByb3BlcnRpZXM6e2RpcmVjdGlvbjp7fSxza3lDb2xvcjp7fSxncm91bmRDb2xvcjp7fX19LHJlY3RBcmVhTGlnaHRzOnt2YWx1ZTpbXSxwcm9wZXJ0aWVzOntjb2xvcjp7fSxwb3NpdGlvbjp7fSx3aWR0aDp7fSxoZWlnaHQ6e319fSxsdGNfMTp7dmFsdWU6bnVsbH0sbHRjXzI6e3ZhbHVlOm51bGx9fSxwb2ludHM6e2RpZmZ1c2U6e3ZhbHVlOm5ldyBEcigxNTY1ODczNCl9LG9wYWNpdHk6e3ZhbHVlOjF9LHNpemU6e3ZhbHVlOjF9LHNjYWxlOnt2YWx1ZToxfSxtYXA6e3ZhbHVlOm51bGx9LGFscGhhTWFwOnt2YWx1ZTpudWxsfSx1dlRyYW5zZm9ybTp7dmFsdWU6bmV3IHNufX0sc3ByaXRlOntkaWZmdXNlOnt2YWx1ZTpuZXcgRHIoMTU2NTg3MzQpfSxvcGFjaXR5Ont2YWx1ZToxfSxjZW50ZXI6e3ZhbHVlOm5ldyBybiguNSwuNSl9LHJvdGF0aW9uOnt2YWx1ZTowfSxtYXA6e3ZhbHVlOm51bGx9LGFscGhhTWFwOnt2YWx1ZTpudWxsfSx1dlRyYW5zZm9ybTp7dmFsdWU6bmV3IHNufX19LFlzPXtiYXNpYzp7dW5pZm9ybXM6UnMoW1hzLmNvbW1vbixYcy5zcGVjdWxhcm1hcCxYcy5lbnZtYXAsWHMuYW9tYXAsWHMubGlnaHRtYXAsWHMuZm9nXSksdmVydGV4U2hhZGVyOldzLm1lc2hiYXNpY192ZXJ0LGZyYWdtZW50U2hhZGVyOldzLm1lc2hiYXNpY19mcmFnfSxsYW1iZXJ0Ont1bmlmb3JtczpScyhbWHMuY29tbW9uLFhzLnNwZWN1bGFybWFwLFhzLmVudm1hcCxYcy5hb21hcCxYcy5saWdodG1hcCxYcy5lbWlzc2l2ZW1hcCxYcy5mb2csWHMubGlnaHRzLHtlbWlzc2l2ZTp7dmFsdWU6bmV3IERyKDApfX1dKSx2ZXJ0ZXhTaGFkZXI6V3MubWVzaGxhbWJlcnRfdmVydCxmcmFnbWVudFNoYWRlcjpXcy5tZXNobGFtYmVydF9mcmFnfSxwaG9uZzp7dW5pZm9ybXM6UnMoW1hzLmNvbW1vbixYcy5zcGVjdWxhcm1hcCxYcy5lbnZtYXAsWHMuYW9tYXAsWHMubGlnaHRtYXAsWHMuZW1pc3NpdmVtYXAsWHMuYnVtcG1hcCxYcy5ub3JtYWxtYXAsWHMuZGlzcGxhY2VtZW50bWFwLFhzLmZvZyxYcy5saWdodHMse2VtaXNzaXZlOnt2YWx1ZTpuZXcgRHIoMCl9LHNwZWN1bGFyOnt2YWx1ZTpuZXcgRHIoMTExODQ4MSl9LHNoaW5pbmVzczp7dmFsdWU6MzB9fV0pLHZlcnRleFNoYWRlcjpXcy5tZXNocGhvbmdfdmVydCxmcmFnbWVudFNoYWRlcjpXcy5tZXNocGhvbmdfZnJhZ30sc3RhbmRhcmQ6e3VuaWZvcm1zOlJzKFtYcy5jb21tb24sWHMuZW52bWFwLFhzLmFvbWFwLFhzLmxpZ2h0bWFwLFhzLmVtaXNzaXZlbWFwLFhzLmJ1bXBtYXAsWHMubm9ybWFsbWFwLFhzLmRpc3BsYWNlbWVudG1hcCxYcy5yb3VnaG5lc3NtYXAsWHMubWV0YWxuZXNzbWFwLFhzLmZvZyxYcy5saWdodHMse2VtaXNzaXZlOnt2YWx1ZTpuZXcgRHIoMCl9LHJvdWdobmVzczp7dmFsdWU6MX0sbWV0YWxuZXNzOnt2YWx1ZTowfSxlbnZNYXBJbnRlbnNpdHk6e3ZhbHVlOjF9fV0pLHZlcnRleFNoYWRlcjpXcy5tZXNocGh5c2ljYWxfdmVydCxmcmFnbWVudFNoYWRlcjpXcy5tZXNocGh5c2ljYWxfZnJhZ30sdG9vbjp7dW5pZm9ybXM6UnMoW1hzLmNvbW1vbixYcy5hb21hcCxYcy5saWdodG1hcCxYcy5lbWlzc2l2ZW1hcCxYcy5idW1wbWFwLFhzLm5vcm1hbG1hcCxYcy5kaXNwbGFjZW1lbnRtYXAsWHMuZ3JhZGllbnRtYXAsWHMuZm9nLFhzLmxpZ2h0cyx7ZW1pc3NpdmU6e3ZhbHVlOm5ldyBEcigwKX19XSksdmVydGV4U2hhZGVyOldzLm1lc2h0b29uX3ZlcnQsZnJhZ21lbnRTaGFkZXI6V3MubWVzaHRvb25fZnJhZ30sbWF0Y2FwOnt1bmlmb3JtczpScyhbWHMuY29tbW9uLFhzLmJ1bXBtYXAsWHMubm9ybWFsbWFwLFhzLmRpc3BsYWNlbWVudG1hcCxYcy5mb2cse21hdGNhcDp7dmFsdWU6bnVsbH19XSksdmVydGV4U2hhZGVyOldzLm1lc2htYXRjYXBfdmVydCxmcmFnbWVudFNoYWRlcjpXcy5tZXNobWF0Y2FwX2ZyYWd9LHBvaW50czp7dW5pZm9ybXM6UnMoW1hzLnBvaW50cyxYcy5mb2ddKSx2ZXJ0ZXhTaGFkZXI6V3MucG9pbnRzX3ZlcnQsZnJhZ21lbnRTaGFkZXI6V3MucG9pbnRzX2ZyYWd9LGRhc2hlZDp7dW5pZm9ybXM6UnMoW1hzLmNvbW1vbixYcy5mb2cse3NjYWxlOnt2YWx1ZToxfSxkYXNoU2l6ZTp7dmFsdWU6MX0sdG90YWxTaXplOnt2YWx1ZToyfX1dKSx2ZXJ0ZXhTaGFkZXI6V3MubGluZWRhc2hlZF92ZXJ0LGZyYWdtZW50U2hhZGVyOldzLmxpbmVkYXNoZWRfZnJhZ30sZGVwdGg6e3VuaWZvcm1zOlJzKFtYcy5jb21tb24sWHMuZGlzcGxhY2VtZW50bWFwXSksdmVydGV4U2hhZGVyOldzLmRlcHRoX3ZlcnQsZnJhZ21lbnRTaGFkZXI6V3MuZGVwdGhfZnJhZ30sbm9ybWFsOnt1bmlmb3JtczpScyhbWHMuY29tbW9uLFhzLmJ1bXBtYXAsWHMubm9ybWFsbWFwLFhzLmRpc3BsYWNlbWVudG1hcCx7b3BhY2l0eTp7dmFsdWU6MX19XSksdmVydGV4U2hhZGVyOldzLm5vcm1hbF92ZXJ0LGZyYWdtZW50U2hhZGVyOldzLm5vcm1hbF9mcmFnfSxzcHJpdGU6e3VuaWZvcm1zOlJzKFtYcy5zcHJpdGUsWHMuZm9nXSksdmVydGV4U2hhZGVyOldzLnNwcml0ZV92ZXJ0LGZyYWdtZW50U2hhZGVyOldzLnNwcml0ZV9mcmFnfSxiYWNrZ3JvdW5kOnt1bmlmb3Jtczp7dXZUcmFuc2Zvcm06e3ZhbHVlOm5ldyBzbn0sdDJEOnt2YWx1ZTpudWxsfX0sdmVydGV4U2hhZGVyOldzLmJhY2tncm91bmRfdmVydCxmcmFnbWVudFNoYWRlcjpXcy5iYWNrZ3JvdW5kX2ZyYWd9LGN1YmU6e3VuaWZvcm1zOlJzKFtYcy5lbnZtYXAse29wYWNpdHk6e3ZhbHVlOjF9fV0pLHZlcnRleFNoYWRlcjpXcy5jdWJlX3ZlcnQsZnJhZ21lbnRTaGFkZXI6V3MuY3ViZV9mcmFnfSxlcXVpcmVjdDp7dW5pZm9ybXM6e3RFcXVpcmVjdDp7dmFsdWU6bnVsbH19LHZlcnRleFNoYWRlcjpXcy5lcXVpcmVjdF92ZXJ0LGZyYWdtZW50U2hhZGVyOldzLmVxdWlyZWN0X2ZyYWd9LGRpc3RhbmNlUkdCQTp7dW5pZm9ybXM6UnMoW1hzLmNvbW1vbixYcy5kaXNwbGFjZW1lbnRtYXAse3JlZmVyZW5jZVBvc2l0aW9uOnt2YWx1ZTpuZXcgZm59LG5lYXJEaXN0YW5jZTp7dmFsdWU6MX0sZmFyRGlzdGFuY2U6e3ZhbHVlOjFlM319XSksdmVydGV4U2hhZGVyOldzLmRpc3RhbmNlUkdCQV92ZXJ0LGZyYWdtZW50U2hhZGVyOldzLmRpc3RhbmNlUkdCQV9mcmFnfSxzaGFkb3c6e3VuaWZvcm1zOlJzKFtYcy5saWdodHMsWHMuZm9nLHtjb2xvcjp7dmFsdWU6bmV3IERyKDApfSxvcGFjaXR5Ont2YWx1ZToxfX1dKSx2ZXJ0ZXhTaGFkZXI6V3Muc2hhZG93X3ZlcnQsZnJhZ21lbnRTaGFkZXI6V3Muc2hhZG93X2ZyYWd9fTtmdW5jdGlvbiBacyh0LGUsaSxuLHIpe2NvbnN0IHM9bmV3IERyKDApO2xldCBvLGEsYz0wLGg9bnVsbCxsPTAsdT1udWxsO2Z1bmN0aW9uIGQodCxlKXtpLmJ1ZmZlcnMuY29sb3Iuc2V0Q2xlYXIodC5yLHQuZyx0LmIsZSxyKX1yZXR1cm57Z2V0Q2xlYXJDb2xvcjpmdW5jdGlvbigpe3JldHVybiBzfSxzZXRDbGVhckNvbG9yOmZ1bmN0aW9uKHQsZT0xKXtzLnNldCh0KSxjPWUsZChzLGMpfSxnZXRDbGVhckFscGhhOmZ1bmN0aW9uKCl7cmV0dXJuIGN9LHNldENsZWFyQWxwaGE6ZnVuY3Rpb24odCl7Yz10LGQocyxjKX0scmVuZGVyOmZ1bmN0aW9uKGkscixwLGYpe2xldCBtPSEwPT09ci5pc1NjZW5lP3IuYmFja2dyb3VuZDpudWxsO20mJm0uaXNUZXh0dXJlJiYobT1lLmdldChtKSk7Y29uc3QgZz10LnhyLF89Zy5nZXRTZXNzaW9uJiZnLmdldFNlc3Npb24oKTtfJiZcImFkZGl0aXZlXCI9PT1fLmVudmlyb25tZW50QmxlbmRNb2RlJiYobT1udWxsKSxudWxsPT09bT9kKHMsYyk6bSYmbS5pc0NvbG9yJiYoZChtLDEpLGY9ITApLCh0LmF1dG9DbGVhcnx8ZikmJnQuY2xlYXIodC5hdXRvQ2xlYXJDb2xvcix0LmF1dG9DbGVhckRlcHRoLHQuYXV0b0NsZWFyU3RlbmNpbCksbSYmKG0uaXNDdWJlVGV4dHVyZXx8bS5pc1dlYkdMQ3ViZVJlbmRlclRhcmdldHx8MzA2PT09bS5tYXBwaW5nKT8odm9pZCAwPT09YSYmKGE9bmV3IEVzKG5ldyBBcygxLDEsMSksbmV3IE9zKHtuYW1lOlwiQmFja2dyb3VuZEN1YmVNYXRlcmlhbFwiLHVuaWZvcm1zOlBzKFlzLmN1YmUudW5pZm9ybXMpLHZlcnRleFNoYWRlcjpZcy5jdWJlLnZlcnRleFNoYWRlcixmcmFnbWVudFNoYWRlcjpZcy5jdWJlLmZyYWdtZW50U2hhZGVyLHNpZGU6MSxkZXB0aFRlc3Q6ITEsZGVwdGhXcml0ZTohMSxmb2c6ITF9KSksYS5nZW9tZXRyeS5kZWxldGVBdHRyaWJ1dGUoXCJub3JtYWxcIiksYS5nZW9tZXRyeS5kZWxldGVBdHRyaWJ1dGUoXCJ1dlwiKSxhLm9uQmVmb3JlUmVuZGVyPWZ1bmN0aW9uKHQsZSxpKXt0aGlzLm1hdHJpeFdvcmxkLmNvcHlQb3NpdGlvbihpLm1hdHJpeFdvcmxkKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KGEubWF0ZXJpYWwsXCJlbnZNYXBcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5pZm9ybXMuZW52TWFwLnZhbHVlfX0pLG4udXBkYXRlKGEpKSxtLmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0JiYobT1tLnRleHR1cmUpLGEubWF0ZXJpYWwudW5pZm9ybXMuZW52TWFwLnZhbHVlPW0sYS5tYXRlcmlhbC51bmlmb3Jtcy5mbGlwRW52TWFwLnZhbHVlPW0uaXNDdWJlVGV4dHVyZSYmbS5fbmVlZHNGbGlwRW52TWFwPy0xOjEsaD09PW0mJmw9PT1tLnZlcnNpb24mJnU9PT10LnRvbmVNYXBwaW5nfHwoYS5tYXRlcmlhbC5uZWVkc1VwZGF0ZT0hMCxoPW0sbD1tLnZlcnNpb24sdT10LnRvbmVNYXBwaW5nKSxpLnVuc2hpZnQoYSxhLmdlb21ldHJ5LGEubWF0ZXJpYWwsMCwwLG51bGwpKTptJiZtLmlzVGV4dHVyZSYmKHZvaWQgMD09PW8mJihvPW5ldyBFcyhuZXcgcXMoMiwyKSxuZXcgT3Moe25hbWU6XCJCYWNrZ3JvdW5kTWF0ZXJpYWxcIix1bmlmb3JtczpQcyhZcy5iYWNrZ3JvdW5kLnVuaWZvcm1zKSx2ZXJ0ZXhTaGFkZXI6WXMuYmFja2dyb3VuZC52ZXJ0ZXhTaGFkZXIsZnJhZ21lbnRTaGFkZXI6WXMuYmFja2dyb3VuZC5mcmFnbWVudFNoYWRlcixzaWRlOjAsZGVwdGhUZXN0OiExLGRlcHRoV3JpdGU6ITEsZm9nOiExfSkpLG8uZ2VvbWV0cnkuZGVsZXRlQXR0cmlidXRlKFwibm9ybWFsXCIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLm1hdGVyaWFsLFwibWFwXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVuaWZvcm1zLnQyRC52YWx1ZX19KSxuLnVwZGF0ZShvKSksby5tYXRlcmlhbC51bmlmb3Jtcy50MkQudmFsdWU9bSwhMD09PW0ubWF0cml4QXV0b1VwZGF0ZSYmbS51cGRhdGVNYXRyaXgoKSxvLm1hdGVyaWFsLnVuaWZvcm1zLnV2VHJhbnNmb3JtLnZhbHVlLmNvcHkobS5tYXRyaXgpLGg9PT1tJiZsPT09bS52ZXJzaW9uJiZ1PT09dC50b25lTWFwcGluZ3x8KG8ubWF0ZXJpYWwubmVlZHNVcGRhdGU9ITAsaD1tLGw9bS52ZXJzaW9uLHU9dC50b25lTWFwcGluZyksaS51bnNoaWZ0KG8sby5nZW9tZXRyeSxvLm1hdGVyaWFsLDAsMCxudWxsKSl9fX1mdW5jdGlvbiBKcyh0LGUsaSxuKXtjb25zdCByPXQuZ2V0UGFyYW1ldGVyKDM0OTIxKSxzPW4uaXNXZWJHTDI/bnVsbDplLmdldChcIk9FU192ZXJ0ZXhfYXJyYXlfb2JqZWN0XCIpLG89bi5pc1dlYkdMMnx8bnVsbCE9PXMsYT17fSxjPWQobnVsbCk7bGV0IGg9YztmdW5jdGlvbiBsKGUpe3JldHVybiBuLmlzV2ViR0wyP3QuYmluZFZlcnRleEFycmF5KGUpOnMuYmluZFZlcnRleEFycmF5T0VTKGUpfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIG4uaXNXZWJHTDI/dC5kZWxldGVWZXJ0ZXhBcnJheShlKTpzLmRlbGV0ZVZlcnRleEFycmF5T0VTKGUpfWZ1bmN0aW9uIGQodCl7Y29uc3QgZT1bXSxpPVtdLG49W107Zm9yKGxldCB0PTA7dDxyO3QrKyllW3RdPTAsaVt0XT0wLG5bdF09MDtyZXR1cm57Z2VvbWV0cnk6bnVsbCxwcm9ncmFtOm51bGwsd2lyZWZyYW1lOiExLG5ld0F0dHJpYnV0ZXM6ZSxlbmFibGVkQXR0cmlidXRlczppLGF0dHJpYnV0ZURpdmlzb3JzOm4sb2JqZWN0OnQsYXR0cmlidXRlczp7fSxpbmRleDpudWxsfX1mdW5jdGlvbiBwKCl7Y29uc3QgdD1oLm5ld0F0dHJpYnV0ZXM7Zm9yKGxldCBlPTAsaT10Lmxlbmd0aDtlPGk7ZSsrKXRbZV09MH1mdW5jdGlvbiBmKHQpe20odCwwKX1mdW5jdGlvbiBtKGkscil7Y29uc3Qgcz1oLm5ld0F0dHJpYnV0ZXMsbz1oLmVuYWJsZWRBdHRyaWJ1dGVzLGE9aC5hdHRyaWJ1dGVEaXZpc29ycztpZihzW2ldPTEsMD09PW9baV0mJih0LmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGkpLG9baV09MSksYVtpXSE9PXIpeyhuLmlzV2ViR0wyP3Q6ZS5nZXQoXCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzXCIpKVtuLmlzV2ViR0wyP1widmVydGV4QXR0cmliRGl2aXNvclwiOlwidmVydGV4QXR0cmliRGl2aXNvckFOR0xFXCJdKGksciksYVtpXT1yfX1mdW5jdGlvbiBnKCl7Y29uc3QgZT1oLm5ld0F0dHJpYnV0ZXMsaT1oLmVuYWJsZWRBdHRyaWJ1dGVzO2ZvcihsZXQgbj0wLHI9aS5sZW5ndGg7bjxyO24rKylpW25dIT09ZVtuXSYmKHQuZGlzYWJsZVZlcnRleEF0dHJpYkFycmF5KG4pLGlbbl09MCl9ZnVuY3Rpb24gXyhlLGkscixzLG8sYSl7ITAhPT1uLmlzV2ViR0wyfHw1MTI0IT09ciYmNTEyNSE9PXI/dC52ZXJ0ZXhBdHRyaWJQb2ludGVyKGUsaSxyLHMsbyxhKTp0LnZlcnRleEF0dHJpYklQb2ludGVyKGUsaSxyLG8sYSl9ZnVuY3Rpb24gdigpe3koKSxoIT09YyYmKGg9YyxsKGgub2JqZWN0KSl9ZnVuY3Rpb24geSgpe2MuZ2VvbWV0cnk9bnVsbCxjLnByb2dyYW09bnVsbCxjLndpcmVmcmFtZT0hMX1yZXR1cm57c2V0dXA6ZnVuY3Rpb24ocixjLHUsdix5KXtsZXQgYj0hMTtpZihvKXtjb25zdCBlPWZ1bmN0aW9uKGUsaSxyKXtjb25zdCBvPSEwPT09ci53aXJlZnJhbWU7bGV0IGM9YVtlLmlkXTt2b2lkIDA9PT1jJiYoYz17fSxhW2UuaWRdPWMpO2xldCBoPWNbaS5pZF07dm9pZCAwPT09aCYmKGg9e30sY1tpLmlkXT1oKTtsZXQgbD1oW29dO3ZvaWQgMD09PWwmJihsPWQobi5pc1dlYkdMMj90LmNyZWF0ZVZlcnRleEFycmF5KCk6cy5jcmVhdGVWZXJ0ZXhBcnJheU9FUygpKSxoW29dPWwpO3JldHVybiBsfSh2LHUsYyk7aCE9PWUmJihoPWUsbChoLm9iamVjdCkpLGI9ZnVuY3Rpb24odCxlKXtjb25zdCBpPWguYXR0cmlidXRlcyxuPXQuYXR0cmlidXRlcztsZXQgcj0wO2Zvcihjb25zdCB0IGluIG4pe2NvbnN0IGU9aVt0XSxzPW5bdF07aWYodm9pZCAwPT09ZSlyZXR1cm4hMDtpZihlLmF0dHJpYnV0ZSE9PXMpcmV0dXJuITA7aWYoZS5kYXRhIT09cy5kYXRhKXJldHVybiEwO3IrK31yZXR1cm4gaC5hdHRyaWJ1dGVzTnVtIT09cnx8aC5pbmRleCE9PWV9KHYseSksYiYmZnVuY3Rpb24odCxlKXtjb25zdCBpPXt9LG49dC5hdHRyaWJ1dGVzO2xldCByPTA7Zm9yKGNvbnN0IHQgaW4gbil7Y29uc3QgZT1uW3RdLHM9e307cy5hdHRyaWJ1dGU9ZSxlLmRhdGEmJihzLmRhdGE9ZS5kYXRhKSxpW3RdPXMscisrfWguYXR0cmlidXRlcz1pLGguYXR0cmlidXRlc051bT1yLGguaW5kZXg9ZX0odix5KX1lbHNle2NvbnN0IHQ9ITA9PT1jLndpcmVmcmFtZTtoLmdlb21ldHJ5PT09di5pZCYmaC5wcm9ncmFtPT09dS5pZCYmaC53aXJlZnJhbWU9PT10fHwoaC5nZW9tZXRyeT12LmlkLGgucHJvZ3JhbT11LmlkLGgud2lyZWZyYW1lPXQsYj0hMCl9ITA9PT1yLmlzSW5zdGFuY2VkTWVzaCYmKGI9ITApLG51bGwhPT15JiZpLnVwZGF0ZSh5LDM0OTYzKSxiJiYoIWZ1bmN0aW9uKHIscyxvLGEpe2lmKCExPT09bi5pc1dlYkdMMiYmKHIuaXNJbnN0YW5jZWRNZXNofHxhLmlzSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkpJiZudWxsPT09ZS5nZXQoXCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzXCIpKXJldHVybjtwKCk7Y29uc3QgYz1hLmF0dHJpYnV0ZXMsaD1vLmdldEF0dHJpYnV0ZXMoKSxsPXMuZGVmYXVsdEF0dHJpYnV0ZVZhbHVlcztmb3IoY29uc3QgZSBpbiBoKXtjb25zdCBuPWhbZV07aWYobj49MCl7Y29uc3Qgcz1jW2VdO2lmKHZvaWQgMCE9PXMpe2NvbnN0IGU9cy5ub3JtYWxpemVkLHI9cy5pdGVtU2l6ZSxvPWkuZ2V0KHMpO2lmKHZvaWQgMD09PW8pY29udGludWU7Y29uc3QgYz1vLmJ1ZmZlcixoPW8udHlwZSxsPW8uYnl0ZXNQZXJFbGVtZW50O2lmKHMuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZSl7Y29uc3QgaT1zLmRhdGEsbz1pLnN0cmlkZSx1PXMub2Zmc2V0O2kmJmkuaXNJbnN0YW5jZWRJbnRlcmxlYXZlZEJ1ZmZlcj8obShuLGkubWVzaFBlckF0dHJpYnV0ZSksdm9pZCAwPT09YS5fbWF4SW5zdGFuY2VDb3VudCYmKGEuX21heEluc3RhbmNlQ291bnQ9aS5tZXNoUGVyQXR0cmlidXRlKmkuY291bnQpKTpmKG4pLHQuYmluZEJ1ZmZlcigzNDk2MixjKSxfKG4scixoLGUsbypsLHUqbCl9ZWxzZSBzLmlzSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlPyhtKG4scy5tZXNoUGVyQXR0cmlidXRlKSx2b2lkIDA9PT1hLl9tYXhJbnN0YW5jZUNvdW50JiYoYS5fbWF4SW5zdGFuY2VDb3VudD1zLm1lc2hQZXJBdHRyaWJ1dGUqcy5jb3VudCkpOmYobiksdC5iaW5kQnVmZmVyKDM0OTYyLGMpLF8obixyLGgsZSwwLDApfWVsc2UgaWYoXCJpbnN0YW5jZU1hdHJpeFwiPT09ZSl7Y29uc3QgZT1pLmdldChyLmluc3RhbmNlTWF0cml4KTtpZih2b2lkIDA9PT1lKWNvbnRpbnVlO2NvbnN0IHM9ZS5idWZmZXIsbz1lLnR5cGU7bShuKzAsMSksbShuKzEsMSksbShuKzIsMSksbShuKzMsMSksdC5iaW5kQnVmZmVyKDM0OTYyLHMpLHQudmVydGV4QXR0cmliUG9pbnRlcihuKzAsNCxvLCExLDY0LDApLHQudmVydGV4QXR0cmliUG9pbnRlcihuKzEsNCxvLCExLDY0LDE2KSx0LnZlcnRleEF0dHJpYlBvaW50ZXIobisyLDQsbywhMSw2NCwzMiksdC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG4rMyw0LG8sITEsNjQsNDgpfWVsc2UgaWYoXCJpbnN0YW5jZUNvbG9yXCI9PT1lKXtjb25zdCBlPWkuZ2V0KHIuaW5zdGFuY2VDb2xvcik7aWYodm9pZCAwPT09ZSljb250aW51ZTtjb25zdCBzPWUuYnVmZmVyLG89ZS50eXBlO20obiwxKSx0LmJpbmRCdWZmZXIoMzQ5NjIscyksdC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG4sMyxvLCExLDEyLDApfWVsc2UgaWYodm9pZCAwIT09bCl7Y29uc3QgaT1sW2VdO2lmKHZvaWQgMCE9PWkpc3dpdGNoKGkubGVuZ3RoKXtjYXNlIDI6dC52ZXJ0ZXhBdHRyaWIyZnYobixpKTticmVhaztjYXNlIDM6dC52ZXJ0ZXhBdHRyaWIzZnYobixpKTticmVhaztjYXNlIDQ6dC52ZXJ0ZXhBdHRyaWI0ZnYobixpKTticmVhaztkZWZhdWx0OnQudmVydGV4QXR0cmliMWZ2KG4saSl9fX19ZygpfShyLGMsdSx2KSxudWxsIT09eSYmdC5iaW5kQnVmZmVyKDM0OTYzLGkuZ2V0KHkpLmJ1ZmZlcikpfSxyZXNldDp2LHJlc2V0RGVmYXVsdFN0YXRlOnksZGlzcG9zZTpmdW5jdGlvbigpe3YoKTtmb3IoY29uc3QgdCBpbiBhKXtjb25zdCBlPWFbdF07Zm9yKGNvbnN0IHQgaW4gZSl7Y29uc3QgaT1lW3RdO2Zvcihjb25zdCB0IGluIGkpdShpW3RdLm9iamVjdCksZGVsZXRlIGlbdF07ZGVsZXRlIGVbdF19ZGVsZXRlIGFbdF19fSxyZWxlYXNlU3RhdGVzT2ZHZW9tZXRyeTpmdW5jdGlvbih0KXtpZih2b2lkIDA9PT1hW3QuaWRdKXJldHVybjtjb25zdCBlPWFbdC5pZF07Zm9yKGNvbnN0IHQgaW4gZSl7Y29uc3QgaT1lW3RdO2Zvcihjb25zdCB0IGluIGkpdShpW3RdLm9iamVjdCksZGVsZXRlIGlbdF07ZGVsZXRlIGVbdF19ZGVsZXRlIGFbdC5pZF19LHJlbGVhc2VTdGF0ZXNPZlByb2dyYW06ZnVuY3Rpb24odCl7Zm9yKGNvbnN0IGUgaW4gYSl7Y29uc3QgaT1hW2VdO2lmKHZvaWQgMD09PWlbdC5pZF0pY29udGludWU7Y29uc3Qgbj1pW3QuaWRdO2Zvcihjb25zdCB0IGluIG4pdShuW3RdLm9iamVjdCksZGVsZXRlIG5bdF07ZGVsZXRlIGlbdC5pZF19fSxpbml0QXR0cmlidXRlczpwLGVuYWJsZUF0dHJpYnV0ZTpmLGRpc2FibGVVbnVzZWRBdHRyaWJ1dGVzOmd9fWZ1bmN0aW9uIEtzKHQsZSxpLG4pe2NvbnN0IHI9bi5pc1dlYkdMMjtsZXQgczt0aGlzLnNldE1vZGU9ZnVuY3Rpb24odCl7cz10fSx0aGlzLnJlbmRlcj1mdW5jdGlvbihlLG4pe3QuZHJhd0FycmF5cyhzLGUsbiksaS51cGRhdGUobixzLDEpfSx0aGlzLnJlbmRlckluc3RhbmNlcz1mdW5jdGlvbihuLG8sYSl7aWYoMD09PWEpcmV0dXJuO2xldCBjLGg7aWYociljPXQsaD1cImRyYXdBcnJheXNJbnN0YW5jZWRcIjtlbHNlIGlmKGM9ZS5nZXQoXCJBTkdMRV9pbnN0YW5jZWRfYXJyYXlzXCIpLGg9XCJkcmF3QXJyYXlzSW5zdGFuY2VkQU5HTEVcIixudWxsPT09YylyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuV2ViR0xCdWZmZXJSZW5kZXJlcjogdXNpbmcgVEhSRUUuSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkgYnV0IGhhcmR3YXJlIGRvZXMgbm90IHN1cHBvcnQgZXh0ZW5zaW9uIEFOR0xFX2luc3RhbmNlZF9hcnJheXMuXCIpO2NbaF0ocyxuLG8sYSksaS51cGRhdGUobyxzLGEpfX1mdW5jdGlvbiBRcyh0LGUsaSl7bGV0IG47ZnVuY3Rpb24gcihlKXtpZihcImhpZ2hwXCI9PT1lKXtpZih0LmdldFNoYWRlclByZWNpc2lvbkZvcm1hdCgzNTYzMywzNjMzOCkucHJlY2lzaW9uPjAmJnQuZ2V0U2hhZGVyUHJlY2lzaW9uRm9ybWF0KDM1NjMyLDM2MzM4KS5wcmVjaXNpb24+MClyZXR1cm5cImhpZ2hwXCI7ZT1cIm1lZGl1bXBcIn1yZXR1cm5cIm1lZGl1bXBcIj09PWUmJnQuZ2V0U2hhZGVyUHJlY2lzaW9uRm9ybWF0KDM1NjMzLDM2MzM3KS5wcmVjaXNpb24+MCYmdC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQoMzU2MzIsMzYzMzcpLnByZWNpc2lvbj4wP1wibWVkaXVtcFwiOlwibG93cFwifWNvbnN0IHM9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFdlYkdMMlJlbmRlcmluZ0NvbnRleHQmJnQgaW5zdGFuY2VvZiBXZWJHTDJSZW5kZXJpbmdDb250ZXh0fHxcInVuZGVmaW5lZFwiIT10eXBlb2YgV2ViR0wyQ29tcHV0ZVJlbmRlcmluZ0NvbnRleHQmJnQgaW5zdGFuY2VvZiBXZWJHTDJDb21wdXRlUmVuZGVyaW5nQ29udGV4dDtsZXQgbz12b2lkIDAhPT1pLnByZWNpc2lvbj9pLnByZWNpc2lvbjpcImhpZ2hwXCI7Y29uc3QgYT1yKG8pO2EhPT1vJiYoY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjpcIixvLFwibm90IHN1cHBvcnRlZCwgdXNpbmdcIixhLFwiaW5zdGVhZC5cIiksbz1hKTtjb25zdCBjPSEwPT09aS5sb2dhcml0aG1pY0RlcHRoQnVmZmVyLGg9dC5nZXRQYXJhbWV0ZXIoMzQ5MzApLGw9dC5nZXRQYXJhbWV0ZXIoMzU2NjApLHU9dC5nZXRQYXJhbWV0ZXIoMzM3OSksZD10LmdldFBhcmFtZXRlcigzNDA3NikscD10LmdldFBhcmFtZXRlcigzNDkyMSksZj10LmdldFBhcmFtZXRlcigzNjM0NyksbT10LmdldFBhcmFtZXRlcigzNjM0OCksZz10LmdldFBhcmFtZXRlcigzNjM0OSksXz1sPjAsdj1zfHwhIWUuZ2V0KFwiT0VTX3RleHR1cmVfZmxvYXRcIik7cmV0dXJue2lzV2ViR0wyOnMsZ2V0TWF4QW5pc290cm9weTpmdW5jdGlvbigpe2lmKHZvaWQgMCE9PW4pcmV0dXJuIG47Y29uc3QgaT1lLmdldChcIkVYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpY1wiKTtyZXR1cm4gbj1udWxsIT09aT90LmdldFBhcmFtZXRlcihpLk1BWF9URVhUVVJFX01BWF9BTklTT1RST1BZX0VYVCk6MCxufSxnZXRNYXhQcmVjaXNpb246cixwcmVjaXNpb246byxsb2dhcml0aG1pY0RlcHRoQnVmZmVyOmMsbWF4VGV4dHVyZXM6aCxtYXhWZXJ0ZXhUZXh0dXJlczpsLG1heFRleHR1cmVTaXplOnUsbWF4Q3ViZW1hcFNpemU6ZCxtYXhBdHRyaWJ1dGVzOnAsbWF4VmVydGV4VW5pZm9ybXM6ZixtYXhWYXJ5aW5nczptLG1heEZyYWdtZW50VW5pZm9ybXM6Zyx2ZXJ0ZXhUZXh0dXJlczpfLGZsb2F0RnJhZ21lbnRUZXh0dXJlczp2LGZsb2F0VmVydGV4VGV4dHVyZXM6XyYmdixtYXhTYW1wbGVzOnM/dC5nZXRQYXJhbWV0ZXIoMzYxODMpOjB9fWZ1bmN0aW9uIHRvKHQpe2NvbnN0IGU9dGhpcztsZXQgaT1udWxsLG49MCxyPSExLHM9ITE7Y29uc3Qgbz1uZXcgX3IsYT1uZXcgc24sYz17dmFsdWU6bnVsbCxuZWVkc1VwZGF0ZTohMX07ZnVuY3Rpb24gaCgpe2MudmFsdWUhPT1pJiYoYy52YWx1ZT1pLGMubmVlZHNVcGRhdGU9bj4wKSxlLm51bVBsYW5lcz1uLGUubnVtSW50ZXJzZWN0aW9uPTB9ZnVuY3Rpb24gbCh0LGksbixyKXtjb25zdCBzPW51bGwhPT10P3QubGVuZ3RoOjA7bGV0IGg9bnVsbDtpZigwIT09cyl7aWYoaD1jLnZhbHVlLCEwIT09cnx8bnVsbD09PWgpe2NvbnN0IGU9bis0KnMscj1pLm1hdHJpeFdvcmxkSW52ZXJzZTthLmdldE5vcm1hbE1hdHJpeChyKSwobnVsbD09PWh8fGgubGVuZ3RoPGUpJiYoaD1uZXcgRmxvYXQzMkFycmF5KGUpKTtmb3IobGV0IGU9MCxpPW47ZSE9PXM7KytlLGkrPTQpby5jb3B5KHRbZV0pLmFwcGx5TWF0cml4NChyLGEpLG8ubm9ybWFsLnRvQXJyYXkoaCxpKSxoW2krM109by5jb25zdGFudH1jLnZhbHVlPWgsYy5uZWVkc1VwZGF0ZT0hMH1yZXR1cm4gZS5udW1QbGFuZXM9cyxlLm51bUludGVyc2VjdGlvbj0wLGh9dGhpcy51bmlmb3JtPWMsdGhpcy5udW1QbGFuZXM9MCx0aGlzLm51bUludGVyc2VjdGlvbj0wLHRoaXMuaW5pdD1mdW5jdGlvbih0LGUscyl7Y29uc3Qgbz0wIT09dC5sZW5ndGh8fGV8fDAhPT1ufHxyO3JldHVybiByPWUsaT1sKHQscywwKSxuPXQubGVuZ3RoLG99LHRoaXMuYmVnaW5TaGFkb3dzPWZ1bmN0aW9uKCl7cz0hMCxsKG51bGwpfSx0aGlzLmVuZFNoYWRvd3M9ZnVuY3Rpb24oKXtzPSExLGgoKX0sdGhpcy5zZXRTdGF0ZT1mdW5jdGlvbihlLG8sYSl7Y29uc3QgdT1lLmNsaXBwaW5nUGxhbmVzLGQ9ZS5jbGlwSW50ZXJzZWN0aW9uLHA9ZS5jbGlwU2hhZG93cyxmPXQuZ2V0KGUpO2lmKCFyfHxudWxsPT09dXx8MD09PXUubGVuZ3RofHxzJiYhcClzP2wobnVsbCk6aCgpO2Vsc2V7Y29uc3QgdD1zPzA6bixlPTQqdDtsZXQgcj1mLmNsaXBwaW5nU3RhdGV8fG51bGw7Yy52YWx1ZT1yLHI9bCh1LG8sZSxhKTtmb3IobGV0IHQ9MDt0IT09ZTsrK3Qpclt0XT1pW3RdO2YuY2xpcHBpbmdTdGF0ZT1yLHRoaXMubnVtSW50ZXJzZWN0aW9uPWQ/dGhpcy5udW1QbGFuZXM6MCx0aGlzLm51bVBsYW5lcys9dH19fWZ1bmN0aW9uIGVvKHQpe2xldCBlPW5ldyBXZWFrTWFwO2Z1bmN0aW9uIGkodCxlKXtyZXR1cm4gMzAzPT09ZT90Lm1hcHBpbmc9MzAxOjMwND09PWUmJih0Lm1hcHBpbmc9MzAyKSx0fWZ1bmN0aW9uIG4odCl7Y29uc3QgaT10LnRhcmdldDtpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIsbik7Y29uc3Qgcj1lLmdldChpKTt2b2lkIDAhPT1yJiYoZS5kZWxldGUoaSksci5kaXNwb3NlKCkpfXJldHVybntnZXQ6ZnVuY3Rpb24ocil7aWYociYmci5pc1RleHR1cmUpe2NvbnN0IHM9ci5tYXBwaW5nO2lmKDMwMz09PXN8fDMwND09PXMpe2lmKGUuaGFzKHIpKXtyZXR1cm4gaShlLmdldChyKS50ZXh0dXJlLHIubWFwcGluZyl9e2NvbnN0IHM9ci5pbWFnZTtpZihzJiZzLmhlaWdodD4wKXtjb25zdCBvPXQuZ2V0UmVuZGVyTGlzdCgpLGE9dC5nZXRSZW5kZXJUYXJnZXQoKSxjPW5ldyBGcyhzLmhlaWdodC8yKTtyZXR1cm4gYy5mcm9tRXF1aXJlY3Rhbmd1bGFyVGV4dHVyZSh0LHIpLGUuc2V0KHIsYyksdC5zZXRSZW5kZXJUYXJnZXQoYSksdC5zZXRSZW5kZXJMaXN0KG8pLHIuYWRkRXZlbnRMaXN0ZW5lcihcImRpc3Bvc2VcIixuKSxpKGMudGV4dHVyZSxyLm1hcHBpbmcpfXJldHVybiBudWxsfX19cmV0dXJuIHJ9LGRpc3Bvc2U6ZnVuY3Rpb24oKXtlPW5ldyBXZWFrTWFwfX19ZnVuY3Rpb24gaW8odCl7Y29uc3QgZT17fTtmdW5jdGlvbiBpKGkpe2lmKHZvaWQgMCE9PWVbaV0pcmV0dXJuIGVbaV07bGV0IG47c3dpdGNoKGkpe2Nhc2VcIldFQkdMX2RlcHRoX3RleHR1cmVcIjpuPXQuZ2V0RXh0ZW5zaW9uKFwiV0VCR0xfZGVwdGhfdGV4dHVyZVwiKXx8dC5nZXRFeHRlbnNpb24oXCJNT1pfV0VCR0xfZGVwdGhfdGV4dHVyZVwiKXx8dC5nZXRFeHRlbnNpb24oXCJXRUJLSVRfV0VCR0xfZGVwdGhfdGV4dHVyZVwiKTticmVhaztjYXNlXCJFWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWNcIjpuPXQuZ2V0RXh0ZW5zaW9uKFwiRVhUX3RleHR1cmVfZmlsdGVyX2FuaXNvdHJvcGljXCIpfHx0LmdldEV4dGVuc2lvbihcIk1PWl9FWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWNcIil8fHQuZ2V0RXh0ZW5zaW9uKFwiV0VCS0lUX0VYVF90ZXh0dXJlX2ZpbHRlcl9hbmlzb3Ryb3BpY1wiKTticmVhaztjYXNlXCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0Y1wiOm49dC5nZXRFeHRlbnNpb24oXCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0Y1wiKXx8dC5nZXRFeHRlbnNpb24oXCJNT1pfV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX3MzdGNcIil8fHQuZ2V0RXh0ZW5zaW9uKFwiV0VCS0lUX1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjXCIpO2JyZWFrO2Nhc2VcIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9wdnJ0Y1wiOm49dC5nZXRFeHRlbnNpb24oXCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGNcIil8fHQuZ2V0RXh0ZW5zaW9uKFwiV0VCS0lUX1dFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9wdnJ0Y1wiKTticmVhaztkZWZhdWx0Om49dC5nZXRFeHRlbnNpb24oaSl9cmV0dXJuIGVbaV09bixufXJldHVybntoYXM6ZnVuY3Rpb24odCl7cmV0dXJuIG51bGwhPT1pKHQpfSxpbml0OmZ1bmN0aW9uKHQpe3QuaXNXZWJHTDI/aShcIkVYVF9jb2xvcl9idWZmZXJfZmxvYXRcIik6KGkoXCJXRUJHTF9kZXB0aF90ZXh0dXJlXCIpLGkoXCJPRVNfdGV4dHVyZV9mbG9hdFwiKSxpKFwiT0VTX3RleHR1cmVfaGFsZl9mbG9hdFwiKSxpKFwiT0VTX3RleHR1cmVfaGFsZl9mbG9hdF9saW5lYXJcIiksaShcIk9FU19zdGFuZGFyZF9kZXJpdmF0aXZlc1wiKSxpKFwiT0VTX2VsZW1lbnRfaW5kZXhfdWludFwiKSxpKFwiT0VTX3ZlcnRleF9hcnJheV9vYmplY3RcIiksaShcIkFOR0xFX2luc3RhbmNlZF9hcnJheXNcIikpLGkoXCJPRVNfdGV4dHVyZV9mbG9hdF9saW5lYXJcIiksaShcIkVYVF9jb2xvcl9idWZmZXJfaGFsZl9mbG9hdFwiKX0sZ2V0OmZ1bmN0aW9uKHQpe2NvbnN0IGU9aSh0KTtyZXR1cm4gbnVsbD09PWUmJmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IFwiK3QrXCIgZXh0ZW5zaW9uIG5vdCBzdXBwb3J0ZWQuXCIpLGV9fX1mdW5jdGlvbiBubyh0LGUsaSxuKXtjb25zdCByPXt9LHM9bmV3IFdlYWtNYXA7ZnVuY3Rpb24gbyh0KXtjb25zdCBhPXQudGFyZ2V0O251bGwhPT1hLmluZGV4JiZlLnJlbW92ZShhLmluZGV4KTtmb3IoY29uc3QgdCBpbiBhLmF0dHJpYnV0ZXMpZS5yZW1vdmUoYS5hdHRyaWJ1dGVzW3RdKTthLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIsbyksZGVsZXRlIHJbYS5pZF07Y29uc3QgYz1zLmdldChhKTtjJiYoZS5yZW1vdmUoYykscy5kZWxldGUoYSkpLG4ucmVsZWFzZVN0YXRlc09mR2VvbWV0cnkoYSksITA9PT1hLmlzSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkmJmRlbGV0ZSBhLl9tYXhJbnN0YW5jZUNvdW50LGkubWVtb3J5Lmdlb21ldHJpZXMtLX1mdW5jdGlvbiBhKHQpe2NvbnN0IGk9W10sbj10LmluZGV4LHI9dC5hdHRyaWJ1dGVzLnBvc2l0aW9uO2xldCBvPTA7aWYobnVsbCE9PW4pe2NvbnN0IHQ9bi5hcnJheTtvPW4udmVyc2lvbjtmb3IobGV0IGU9MCxuPXQubGVuZ3RoO2U8bjtlKz0zKXtjb25zdCBuPXRbZSswXSxyPXRbZSsxXSxzPXRbZSsyXTtpLnB1c2gobixyLHIscyxzLG4pfX1lbHNle2NvbnN0IHQ9ci5hcnJheTtvPXIudmVyc2lvbjtmb3IobGV0IGU9MCxuPXQubGVuZ3RoLzMtMTtlPG47ZSs9Myl7Y29uc3QgdD1lKzAsbj1lKzEscj1lKzI7aS5wdXNoKHQsbixuLHIscix0KX19Y29uc3QgYT1uZXcoUXIoaSk+NjU1MzU/WXI6V3IpKGksMSk7YS52ZXJzaW9uPW87Y29uc3QgYz1zLmdldCh0KTtjJiZlLnJlbW92ZShjKSxzLnNldCh0LGEpfXJldHVybntnZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4hMD09PXJbZS5pZF18fChlLmFkZEV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIsbykscltlLmlkXT0hMCxpLm1lbW9yeS5nZW9tZXRyaWVzKyspLGV9LHVwZGF0ZTpmdW5jdGlvbih0KXtjb25zdCBpPXQuYXR0cmlidXRlcztmb3IoY29uc3QgdCBpbiBpKWUudXBkYXRlKGlbdF0sMzQ5NjIpO2NvbnN0IG49dC5tb3JwaEF0dHJpYnV0ZXM7Zm9yKGNvbnN0IHQgaW4gbil7Y29uc3QgaT1uW3RdO2ZvcihsZXQgdD0wLG49aS5sZW5ndGg7dDxuO3QrKyllLnVwZGF0ZShpW3RdLDM0OTYyKX19LGdldFdpcmVmcmFtZUF0dHJpYnV0ZTpmdW5jdGlvbih0KXtjb25zdCBlPXMuZ2V0KHQpO2lmKGUpe2NvbnN0IGk9dC5pbmRleDtudWxsIT09aSYmZS52ZXJzaW9uPGkudmVyc2lvbiYmYSh0KX1lbHNlIGEodCk7cmV0dXJuIHMuZ2V0KHQpfX19ZnVuY3Rpb24gcm8odCxlLGksbil7Y29uc3Qgcj1uLmlzV2ViR0wyO2xldCBzLG8sYTt0aGlzLnNldE1vZGU9ZnVuY3Rpb24odCl7cz10fSx0aGlzLnNldEluZGV4PWZ1bmN0aW9uKHQpe289dC50eXBlLGE9dC5ieXRlc1BlckVsZW1lbnR9LHRoaXMucmVuZGVyPWZ1bmN0aW9uKGUsbil7dC5kcmF3RWxlbWVudHMocyxuLG8sZSphKSxpLnVwZGF0ZShuLHMsMSl9LHRoaXMucmVuZGVySW5zdGFuY2VzPWZ1bmN0aW9uKG4sYyxoKXtpZigwPT09aClyZXR1cm47bGV0IGwsdTtpZihyKWw9dCx1PVwiZHJhd0VsZW1lbnRzSW5zdGFuY2VkXCI7ZWxzZSBpZihsPWUuZ2V0KFwiQU5HTEVfaW5zdGFuY2VkX2FycmF5c1wiKSx1PVwiZHJhd0VsZW1lbnRzSW5zdGFuY2VkQU5HTEVcIixudWxsPT09bClyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuV2ViR0xJbmRleGVkQnVmZmVyUmVuZGVyZXI6IHVzaW5nIFRIUkVFLkluc3RhbmNlZEJ1ZmZlckdlb21ldHJ5IGJ1dCBoYXJkd2FyZSBkb2VzIG5vdCBzdXBwb3J0IGV4dGVuc2lvbiBBTkdMRV9pbnN0YW5jZWRfYXJyYXlzLlwiKTtsW3VdKHMsYyxvLG4qYSxoKSxpLnVwZGF0ZShjLHMsaCl9fWZ1bmN0aW9uIHNvKHQpe2NvbnN0IGU9e2ZyYW1lOjAsY2FsbHM6MCx0cmlhbmdsZXM6MCxwb2ludHM6MCxsaW5lczowfTtyZXR1cm57bWVtb3J5OntnZW9tZXRyaWVzOjAsdGV4dHVyZXM6MH0scmVuZGVyOmUscHJvZ3JhbXM6bnVsbCxhdXRvUmVzZXQ6ITAscmVzZXQ6ZnVuY3Rpb24oKXtlLmZyYW1lKyssZS5jYWxscz0wLGUudHJpYW5nbGVzPTAsZS5wb2ludHM9MCxlLmxpbmVzPTB9LHVwZGF0ZTpmdW5jdGlvbih0LGksbil7c3dpdGNoKGUuY2FsbHMrKyxpKXtjYXNlIDQ6ZS50cmlhbmdsZXMrPW4qKHQvMyk7YnJlYWs7Y2FzZSAxOmUubGluZXMrPW4qKHQvMik7YnJlYWs7Y2FzZSAzOmUubGluZXMrPW4qKHQtMSk7YnJlYWs7Y2FzZSAyOmUubGluZXMrPW4qdDticmVhaztjYXNlIDA6ZS5wb2ludHMrPW4qdDticmVhaztkZWZhdWx0OmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTEluZm86IFVua25vd24gZHJhdyBtb2RlOlwiLGkpfX19fWZ1bmN0aW9uIG9vKHQsZSl7cmV0dXJuIHRbMF0tZVswXX1mdW5jdGlvbiBhbyh0LGUpe3JldHVybiBNYXRoLmFicyhlWzFdKS1NYXRoLmFicyh0WzFdKX1mdW5jdGlvbiBjbyh0KXtjb25zdCBlPXt9LGk9bmV3IEZsb2F0MzJBcnJheSg4KSxuPVtdO2ZvcihsZXQgdD0wO3Q8ODt0Kyspblt0XT1bdCwwXTtyZXR1cm57dXBkYXRlOmZ1bmN0aW9uKHIscyxvLGEpe2NvbnN0IGM9ci5tb3JwaFRhcmdldEluZmx1ZW5jZXMsaD12b2lkIDA9PT1jPzA6Yy5sZW5ndGg7bGV0IGw9ZVtzLmlkXTtpZih2b2lkIDA9PT1sKXtsPVtdO2ZvcihsZXQgdD0wO3Q8aDt0KyspbFt0XT1bdCwwXTtlW3MuaWRdPWx9Zm9yKGxldCB0PTA7dDxoO3QrKyl7Y29uc3QgZT1sW3RdO2VbMF09dCxlWzFdPWNbdF19bC5zb3J0KGFvKTtmb3IobGV0IHQ9MDt0PDg7dCsrKXQ8aCYmbFt0XVsxXT8oblt0XVswXT1sW3RdWzBdLG5bdF1bMV09bFt0XVsxXSk6KG5bdF1bMF09TnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsblt0XVsxXT0wKTtuLnNvcnQob28pO2NvbnN0IHU9by5tb3JwaFRhcmdldHMmJnMubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uLGQ9by5tb3JwaE5vcm1hbHMmJnMubW9ycGhBdHRyaWJ1dGVzLm5vcm1hbDtsZXQgcD0wO2ZvcihsZXQgdD0wO3Q8ODt0Kyspe2NvbnN0IGU9blt0XSxyPWVbMF0sbz1lWzFdO3IhPT1OdW1iZXIuTUFYX1NBRkVfSU5URUdFUiYmbz8odSYmcy5nZXRBdHRyaWJ1dGUoXCJtb3JwaFRhcmdldFwiK3QpIT09dVtyXSYmcy5zZXRBdHRyaWJ1dGUoXCJtb3JwaFRhcmdldFwiK3QsdVtyXSksZCYmcy5nZXRBdHRyaWJ1dGUoXCJtb3JwaE5vcm1hbFwiK3QpIT09ZFtyXSYmcy5zZXRBdHRyaWJ1dGUoXCJtb3JwaE5vcm1hbFwiK3QsZFtyXSksaVt0XT1vLHArPW8pOih1JiYhMD09PXMuaGFzQXR0cmlidXRlKFwibW9ycGhUYXJnZXRcIit0KSYmcy5kZWxldGVBdHRyaWJ1dGUoXCJtb3JwaFRhcmdldFwiK3QpLGQmJiEwPT09cy5oYXNBdHRyaWJ1dGUoXCJtb3JwaE5vcm1hbFwiK3QpJiZzLmRlbGV0ZUF0dHJpYnV0ZShcIm1vcnBoTm9ybWFsXCIrdCksaVt0XT0wKX1jb25zdCBmPXMubW9ycGhUYXJnZXRzUmVsYXRpdmU/MToxLXA7YS5nZXRVbmlmb3JtcygpLnNldFZhbHVlKHQsXCJtb3JwaFRhcmdldEJhc2VJbmZsdWVuY2VcIixmKSxhLmdldFVuaWZvcm1zKCkuc2V0VmFsdWUodCxcIm1vcnBoVGFyZ2V0SW5mbHVlbmNlc1wiLGkpfX19ZnVuY3Rpb24gaG8odCxlLGksbil7bGV0IHI9bmV3IFdlYWtNYXA7ZnVuY3Rpb24gcyh0KXtjb25zdCBlPXQudGFyZ2V0O2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImRpc3Bvc2VcIixzKSxpLnJlbW92ZShlLmluc3RhbmNlTWF0cml4KSxudWxsIT09ZS5pbnN0YW5jZUNvbG9yJiZpLnJlbW92ZShlLmluc3RhbmNlQ29sb3IpfXJldHVybnt1cGRhdGU6ZnVuY3Rpb24odCl7Y29uc3Qgbz1uLnJlbmRlci5mcmFtZSxhPXQuZ2VvbWV0cnksYz1lLmdldCh0LGEpO3JldHVybiByLmdldChjKSE9PW8mJihlLnVwZGF0ZShjKSxyLnNldChjLG8pKSx0LmlzSW5zdGFuY2VkTWVzaCYmKCExPT09dC5oYXNFdmVudExpc3RlbmVyKFwiZGlzcG9zZVwiLHMpJiZ0LmFkZEV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIscyksaS51cGRhdGUodC5pbnN0YW5jZU1hdHJpeCwzNDk2MiksbnVsbCE9PXQuaW5zdGFuY2VDb2xvciYmaS51cGRhdGUodC5pbnN0YW5jZUNvbG9yLDM0OTYyKSksY30sZGlzcG9zZTpmdW5jdGlvbigpe3I9bmV3IFdlYWtNYXB9fX1mdW5jdGlvbiBsbyh0PW51bGwsZT0xLGk9MSxuPTEpe2huLmNhbGwodGhpcyxudWxsKSx0aGlzLmltYWdlPXtkYXRhOnQsd2lkdGg6ZSxoZWlnaHQ6aSxkZXB0aDpufSx0aGlzLm1hZ0ZpbHRlcj1JaSx0aGlzLm1pbkZpbHRlcj1JaSx0aGlzLndyYXBSPUNpLHRoaXMuZ2VuZXJhdGVNaXBtYXBzPSExLHRoaXMuZmxpcFk9ITEsdGhpcy5uZWVkc1VwZGF0ZT0hMH1mdW5jdGlvbiB1byh0PW51bGwsZT0xLGk9MSxuPTEpe2huLmNhbGwodGhpcyxudWxsKSx0aGlzLmltYWdlPXtkYXRhOnQsd2lkdGg6ZSxoZWlnaHQ6aSxkZXB0aDpufSx0aGlzLm1hZ0ZpbHRlcj1JaSx0aGlzLm1pbkZpbHRlcj1JaSx0aGlzLndyYXBSPUNpLHRoaXMuZ2VuZXJhdGVNaXBtYXBzPSExLHRoaXMuZmxpcFk9ITEsdGhpcy5uZWVkc1VwZGF0ZT0hMH1Zcy5waHlzaWNhbD17dW5pZm9ybXM6UnMoW1lzLnN0YW5kYXJkLnVuaWZvcm1zLHtjbGVhcmNvYXQ6e3ZhbHVlOjB9LGNsZWFyY29hdE1hcDp7dmFsdWU6bnVsbH0sY2xlYXJjb2F0Um91Z2huZXNzOnt2YWx1ZTowfSxjbGVhcmNvYXRSb3VnaG5lc3NNYXA6e3ZhbHVlOm51bGx9LGNsZWFyY29hdE5vcm1hbFNjYWxlOnt2YWx1ZTpuZXcgcm4oMSwxKX0sY2xlYXJjb2F0Tm9ybWFsTWFwOnt2YWx1ZTpudWxsfSxzaGVlbjp7dmFsdWU6bmV3IERyKDApfSx0cmFuc21pc3Npb246e3ZhbHVlOjB9LHRyYW5zbWlzc2lvbk1hcDp7dmFsdWU6bnVsbH19XSksdmVydGV4U2hhZGVyOldzLm1lc2hwaHlzaWNhbF92ZXJ0LGZyYWdtZW50U2hhZGVyOldzLm1lc2hwaHlzaWNhbF9mcmFnfSxsby5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShobi5wcm90b3R5cGUpLGxvLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1sbyxsby5wcm90b3R5cGUuaXNEYXRhVGV4dHVyZTJEQXJyYXk9ITAsdW8ucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoaG4ucHJvdG90eXBlKSx1by5wcm90b3R5cGUuY29uc3RydWN0b3I9dW8sdW8ucHJvdG90eXBlLmlzRGF0YVRleHR1cmUzRD0hMDtjb25zdCBwbz1uZXcgaG4sZm89bmV3IGxvLG1vPW5ldyB1byxnbz1uZXcgenMsX289W10sdm89W10seW89bmV3IEZsb2F0MzJBcnJheSgxNiksYm89bmV3IEZsb2F0MzJBcnJheSg5KSx4bz1uZXcgRmxvYXQzMkFycmF5KDQpO2Z1bmN0aW9uIHdvKHQsZSxpKXtjb25zdCBuPXRbMF07aWYobjw9MHx8bj4wKXJldHVybiB0O2NvbnN0IHI9ZSppO2xldCBzPV9vW3JdO2lmKHZvaWQgMD09PXMmJihzPW5ldyBGbG9hdDMyQXJyYXkociksX29bcl09cyksMCE9PWUpe24udG9BcnJheShzLDApO2ZvcihsZXQgbj0xLHI9MDtuIT09ZTsrK24pcis9aSx0W25dLnRvQXJyYXkocyxyKX1yZXR1cm4gc31mdW5jdGlvbiBTbyh0LGUpe2lmKHQubGVuZ3RoIT09ZS5sZW5ndGgpcmV0dXJuITE7Zm9yKGxldCBpPTAsbj10Lmxlbmd0aDtpPG47aSsrKWlmKHRbaV0hPT1lW2ldKXJldHVybiExO3JldHVybiEwfWZ1bmN0aW9uIE1vKHQsZSl7Zm9yKGxldCBpPTAsbj1lLmxlbmd0aDtpPG47aSsrKXRbaV09ZVtpXX1mdW5jdGlvbiBUbyh0LGUpe2xldCBpPXZvW2VdO3ZvaWQgMD09PWkmJihpPW5ldyBJbnQzMkFycmF5KGUpLHZvW2VdPWkpO2ZvcihsZXQgbj0wO24hPT1lOysrbilpW25dPXQuYWxsb2NhdGVUZXh0dXJlVW5pdCgpO3JldHVybiBpfWZ1bmN0aW9uIENvKHQsZSl7Y29uc3QgaT10aGlzLmNhY2hlO2lbMF0hPT1lJiYodC51bmlmb3JtMWYodGhpcy5hZGRyLGUpLGlbMF09ZSl9ZnVuY3Rpb24gRW8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGU7aWYodm9pZCAwIT09ZS54KWlbMF09PT1lLngmJmlbMV09PT1lLnl8fCh0LnVuaWZvcm0yZih0aGlzLmFkZHIsZS54LGUueSksaVswXT1lLngsaVsxXT1lLnkpO2Vsc2V7aWYoU28oaSxlKSlyZXR1cm47dC51bmlmb3JtMmZ2KHRoaXMuYWRkcixlKSxNbyhpLGUpfX1mdW5jdGlvbiBJbyh0LGUpe2NvbnN0IGk9dGhpcy5jYWNoZTtpZih2b2lkIDAhPT1lLngpaVswXT09PWUueCYmaVsxXT09PWUueSYmaVsyXT09PWUuenx8KHQudW5pZm9ybTNmKHRoaXMuYWRkcixlLngsZS55LGUueiksaVswXT1lLngsaVsxXT1lLnksaVsyXT1lLnopO2Vsc2UgaWYodm9pZCAwIT09ZS5yKWlbMF09PT1lLnImJmlbMV09PT1lLmcmJmlbMl09PT1lLmJ8fCh0LnVuaWZvcm0zZih0aGlzLmFkZHIsZS5yLGUuZyxlLmIpLGlbMF09ZS5yLGlbMV09ZS5nLGlbMl09ZS5iKTtlbHNle2lmKFNvKGksZSkpcmV0dXJuO3QudW5pZm9ybTNmdih0aGlzLmFkZHIsZSksTW8oaSxlKX19ZnVuY3Rpb24gQW8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGU7aWYodm9pZCAwIT09ZS54KWlbMF09PT1lLngmJmlbMV09PT1lLnkmJmlbMl09PT1lLnomJmlbM109PT1lLnd8fCh0LnVuaWZvcm00Zih0aGlzLmFkZHIsZS54LGUueSxlLnosZS53KSxpWzBdPWUueCxpWzFdPWUueSxpWzJdPWUueixpWzNdPWUudyk7ZWxzZXtpZihTbyhpLGUpKXJldHVybjt0LnVuaWZvcm00ZnYodGhpcy5hZGRyLGUpLE1vKGksZSl9fWZ1bmN0aW9uIFBvKHQsZSl7Y29uc3QgaT10aGlzLmNhY2hlLG49ZS5lbGVtZW50cztpZih2b2lkIDA9PT1uKXtpZihTbyhpLGUpKXJldHVybjt0LnVuaWZvcm1NYXRyaXgyZnYodGhpcy5hZGRyLCExLGUpLE1vKGksZSl9ZWxzZXtpZihTbyhpLG4pKXJldHVybjt4by5zZXQobiksdC51bmlmb3JtTWF0cml4MmZ2KHRoaXMuYWRkciwhMSx4byksTW8oaSxuKX19ZnVuY3Rpb24gUm8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGUsbj1lLmVsZW1lbnRzO2lmKHZvaWQgMD09PW4pe2lmKFNvKGksZSkpcmV0dXJuO3QudW5pZm9ybU1hdHJpeDNmdih0aGlzLmFkZHIsITEsZSksTW8oaSxlKX1lbHNle2lmKFNvKGksbikpcmV0dXJuO2JvLnNldChuKSx0LnVuaWZvcm1NYXRyaXgzZnYodGhpcy5hZGRyLCExLGJvKSxNbyhpLG4pfX1mdW5jdGlvbiBMbyh0LGUpe2NvbnN0IGk9dGhpcy5jYWNoZSxuPWUuZWxlbWVudHM7aWYodm9pZCAwPT09bil7aWYoU28oaSxlKSlyZXR1cm47dC51bmlmb3JtTWF0cml4NGZ2KHRoaXMuYWRkciwhMSxlKSxNbyhpLGUpfWVsc2V7aWYoU28oaSxuKSlyZXR1cm47eW8uc2V0KG4pLHQudW5pZm9ybU1hdHJpeDRmdih0aGlzLmFkZHIsITEseW8pLE1vKGksbil9fWZ1bmN0aW9uIE9vKHQsZSxpKXtjb25zdCBuPXRoaXMuY2FjaGUscj1pLmFsbG9jYXRlVGV4dHVyZVVuaXQoKTtuWzBdIT09ciYmKHQudW5pZm9ybTFpKHRoaXMuYWRkcixyKSxuWzBdPXIpLGkuc2FmZVNldFRleHR1cmUyRChlfHxwbyxyKX1mdW5jdGlvbiBObyh0LGUsaSl7Y29uc3Qgbj10aGlzLmNhY2hlLHI9aS5hbGxvY2F0ZVRleHR1cmVVbml0KCk7blswXSE9PXImJih0LnVuaWZvcm0xaSh0aGlzLmFkZHIsciksblswXT1yKSxpLnNldFRleHR1cmUyREFycmF5KGV8fGZvLHIpfWZ1bmN0aW9uIERvKHQsZSxpKXtjb25zdCBuPXRoaXMuY2FjaGUscj1pLmFsbG9jYXRlVGV4dHVyZVVuaXQoKTtuWzBdIT09ciYmKHQudW5pZm9ybTFpKHRoaXMuYWRkcixyKSxuWzBdPXIpLGkuc2V0VGV4dHVyZTNEKGV8fG1vLHIpfWZ1bmN0aW9uICRvKHQsZSxpKXtjb25zdCBuPXRoaXMuY2FjaGUscj1pLmFsbG9jYXRlVGV4dHVyZVVuaXQoKTtuWzBdIT09ciYmKHQudW5pZm9ybTFpKHRoaXMuYWRkcixyKSxuWzBdPXIpLGkuc2FmZVNldFRleHR1cmVDdWJlKGV8fGdvLHIpfWZ1bmN0aW9uIGtvKHQsZSl7Y29uc3QgaT10aGlzLmNhY2hlO2lbMF0hPT1lJiYodC51bmlmb3JtMWkodGhpcy5hZGRyLGUpLGlbMF09ZSl9ZnVuY3Rpb24gem8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGU7U28oaSxlKXx8KHQudW5pZm9ybTJpdih0aGlzLmFkZHIsZSksTW8oaSxlKSl9ZnVuY3Rpb24gRm8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGU7U28oaSxlKXx8KHQudW5pZm9ybTNpdih0aGlzLmFkZHIsZSksTW8oaSxlKSl9ZnVuY3Rpb24gQm8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGU7U28oaSxlKXx8KHQudW5pZm9ybTRpdih0aGlzLmFkZHIsZSksTW8oaSxlKSl9ZnVuY3Rpb24gam8odCxlKXtjb25zdCBpPXRoaXMuY2FjaGU7aVswXSE9PWUmJih0LnVuaWZvcm0xdWkodGhpcy5hZGRyLGUpLGlbMF09ZSl9ZnVuY3Rpb24gSG8odCxlKXt0LnVuaWZvcm0xZnYodGhpcy5hZGRyLGUpfWZ1bmN0aW9uIFVvKHQsZSl7dC51bmlmb3JtMWl2KHRoaXMuYWRkcixlKX1mdW5jdGlvbiBWbyh0LGUpe3QudW5pZm9ybTJpdih0aGlzLmFkZHIsZSl9ZnVuY3Rpb24gR28odCxlKXt0LnVuaWZvcm0zaXYodGhpcy5hZGRyLGUpfWZ1bmN0aW9uIHFvKHQsZSl7dC51bmlmb3JtNGl2KHRoaXMuYWRkcixlKX1mdW5jdGlvbiBXbyh0LGUpe2NvbnN0IGk9d28oZSx0aGlzLnNpemUsMik7dC51bmlmb3JtMmZ2KHRoaXMuYWRkcixpKX1mdW5jdGlvbiBYbyh0LGUpe2NvbnN0IGk9d28oZSx0aGlzLnNpemUsMyk7dC51bmlmb3JtM2Z2KHRoaXMuYWRkcixpKX1mdW5jdGlvbiBZbyh0LGUpe2NvbnN0IGk9d28oZSx0aGlzLnNpemUsNCk7dC51bmlmb3JtNGZ2KHRoaXMuYWRkcixpKX1mdW5jdGlvbiBabyh0LGUpe2NvbnN0IGk9d28oZSx0aGlzLnNpemUsNCk7dC51bmlmb3JtTWF0cml4MmZ2KHRoaXMuYWRkciwhMSxpKX1mdW5jdGlvbiBKbyh0LGUpe2NvbnN0IGk9d28oZSx0aGlzLnNpemUsOSk7dC51bmlmb3JtTWF0cml4M2Z2KHRoaXMuYWRkciwhMSxpKX1mdW5jdGlvbiBLbyh0LGUpe2NvbnN0IGk9d28oZSx0aGlzLnNpemUsMTYpO3QudW5pZm9ybU1hdHJpeDRmdih0aGlzLmFkZHIsITEsaSl9ZnVuY3Rpb24gUW8odCxlLGkpe2NvbnN0IG49ZS5sZW5ndGgscj1UbyhpLG4pO3QudW5pZm9ybTFpdih0aGlzLmFkZHIscik7Zm9yKGxldCB0PTA7dCE9PW47Kyt0KWkuc2FmZVNldFRleHR1cmUyRChlW3RdfHxwbyxyW3RdKX1mdW5jdGlvbiB0YSh0LGUsaSl7Y29uc3Qgbj1lLmxlbmd0aCxyPVRvKGksbik7dC51bmlmb3JtMWl2KHRoaXMuYWRkcixyKTtmb3IobGV0IHQ9MDt0IT09bjsrK3QpaS5zYWZlU2V0VGV4dHVyZUN1YmUoZVt0XXx8Z28sclt0XSl9ZnVuY3Rpb24gZWEodCxlLGkpe3RoaXMuaWQ9dCx0aGlzLmFkZHI9aSx0aGlzLmNhY2hlPVtdLHRoaXMuc2V0VmFsdWU9ZnVuY3Rpb24odCl7c3dpdGNoKHQpe2Nhc2UgNTEyNjpyZXR1cm4gQ287Y2FzZSAzNTY2NDpyZXR1cm4gRW87Y2FzZSAzNTY2NTpyZXR1cm4gSW87Y2FzZSAzNTY2NjpyZXR1cm4gQW87Y2FzZSAzNTY3NDpyZXR1cm4gUG87Y2FzZSAzNTY3NTpyZXR1cm4gUm87Y2FzZSAzNTY3NjpyZXR1cm4gTG87Y2FzZSA1MTI0OmNhc2UgMzU2NzA6cmV0dXJuIGtvO2Nhc2UgMzU2Njc6Y2FzZSAzNTY3MTpyZXR1cm4gem87Y2FzZSAzNTY2ODpjYXNlIDM1NjcyOnJldHVybiBGbztjYXNlIDM1NjY5OmNhc2UgMzU2NzM6cmV0dXJuIEJvO2Nhc2UgNTEyNTpyZXR1cm4gam87Y2FzZSAzNTY3ODpjYXNlIDM2MTk4OmNhc2UgMzYyOTg6Y2FzZSAzNjMwNjpjYXNlIDM1NjgyOnJldHVybiBPbztjYXNlIDM1Njc5OmNhc2UgMzYyOTk6Y2FzZSAzNjMwNzpyZXR1cm4gRG87Y2FzZSAzNTY4MDpjYXNlIDM2MzAwOmNhc2UgMzYzMDg6Y2FzZSAzNjI5MzpyZXR1cm4gJG87Y2FzZSAzNjI4OTpjYXNlIDM2MzAzOmNhc2UgMzYzMTE6Y2FzZSAzNjI5MjpyZXR1cm4gTm99fShlLnR5cGUpfWZ1bmN0aW9uIGlhKHQsZSxpKXt0aGlzLmlkPXQsdGhpcy5hZGRyPWksdGhpcy5jYWNoZT1bXSx0aGlzLnNpemU9ZS5zaXplLHRoaXMuc2V0VmFsdWU9ZnVuY3Rpb24odCl7c3dpdGNoKHQpe2Nhc2UgNTEyNjpyZXR1cm4gSG87Y2FzZSAzNTY2NDpyZXR1cm4gV287Y2FzZSAzNTY2NTpyZXR1cm4gWG87Y2FzZSAzNTY2NjpyZXR1cm4gWW87Y2FzZSAzNTY3NDpyZXR1cm4gWm87Y2FzZSAzNTY3NTpyZXR1cm4gSm87Y2FzZSAzNTY3NjpyZXR1cm4gS287Y2FzZSA1MTI0OmNhc2UgMzU2NzA6cmV0dXJuIFVvO2Nhc2UgMzU2Njc6Y2FzZSAzNTY3MTpyZXR1cm4gVm87Y2FzZSAzNTY2ODpjYXNlIDM1NjcyOnJldHVybiBHbztjYXNlIDM1NjY5OmNhc2UgMzU2NzM6cmV0dXJuIHFvO2Nhc2UgMzU2Nzg6Y2FzZSAzNjE5ODpjYXNlIDM2Mjk4OmNhc2UgMzYzMDY6Y2FzZSAzNTY4MjpyZXR1cm4gUW87Y2FzZSAzNTY4MDpjYXNlIDM2MzAwOmNhc2UgMzYzMDg6Y2FzZSAzNjI5MzpyZXR1cm4gdGF9fShlLnR5cGUpfWZ1bmN0aW9uIG5hKHQpe3RoaXMuaWQ9dCx0aGlzLnNlcT1bXSx0aGlzLm1hcD17fX1pYS5wcm90b3R5cGUudXBkYXRlQ2FjaGU9ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLmNhY2hlO3QgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXkmJmUubGVuZ3RoIT09dC5sZW5ndGgmJih0aGlzLmNhY2hlPW5ldyBGbG9hdDMyQXJyYXkodC5sZW5ndGgpKSxNbyhlLHQpfSxuYS5wcm90b3R5cGUuc2V0VmFsdWU9ZnVuY3Rpb24odCxlLGkpe2NvbnN0IG49dGhpcy5zZXE7Zm9yKGxldCByPTAscz1uLmxlbmd0aDtyIT09czsrK3Ipe2NvbnN0IHM9bltyXTtzLnNldFZhbHVlKHQsZVtzLmlkXSxpKX19O2NvbnN0IHJhPS8oXFx3KykoXFxdKT8oXFxbfFxcLik/L2c7ZnVuY3Rpb24gc2EodCxlKXt0LnNlcS5wdXNoKGUpLHQubWFwW2UuaWRdPWV9ZnVuY3Rpb24gb2EodCxlLGkpe2NvbnN0IG49dC5uYW1lLHI9bi5sZW5ndGg7Zm9yKHJhLmxhc3RJbmRleD0wOzspe2NvbnN0IHM9cmEuZXhlYyhuKSxvPXJhLmxhc3RJbmRleDtsZXQgYT1zWzFdO2NvbnN0IGM9XCJdXCI9PT1zWzJdLGg9c1szXTtpZihjJiYoYXw9MCksdm9pZCAwPT09aHx8XCJbXCI9PT1oJiZvKzI9PT1yKXtzYShpLHZvaWQgMD09PWg/bmV3IGVhKGEsdCxlKTpuZXcgaWEoYSx0LGUpKTticmVha317bGV0IHQ9aS5tYXBbYV07dm9pZCAwPT09dCYmKHQ9bmV3IG5hKGEpLHNhKGksdCkpLGk9dH19fWZ1bmN0aW9uIGFhKHQsZSl7dGhpcy5zZXE9W10sdGhpcy5tYXA9e307Y29uc3QgaT10LmdldFByb2dyYW1QYXJhbWV0ZXIoZSwzNTcxOCk7Zm9yKGxldCBuPTA7bjxpOysrbil7Y29uc3QgaT10LmdldEFjdGl2ZVVuaWZvcm0oZSxuKTtvYShpLHQuZ2V0VW5pZm9ybUxvY2F0aW9uKGUsaS5uYW1lKSx0aGlzKX19ZnVuY3Rpb24gY2EodCxlLGkpe2NvbnN0IG49dC5jcmVhdGVTaGFkZXIoZSk7cmV0dXJuIHQuc2hhZGVyU291cmNlKG4saSksdC5jb21waWxlU2hhZGVyKG4pLG59YWEucHJvdG90eXBlLnNldFZhbHVlPWZ1bmN0aW9uKHQsZSxpLG4pe2NvbnN0IHI9dGhpcy5tYXBbZV07dm9pZCAwIT09ciYmci5zZXRWYWx1ZSh0LGksbil9LGFhLnByb3RvdHlwZS5zZXRPcHRpb25hbD1mdW5jdGlvbih0LGUsaSl7Y29uc3Qgbj1lW2ldO3ZvaWQgMCE9PW4mJnRoaXMuc2V0VmFsdWUodCxpLG4pfSxhYS51cGxvYWQ9ZnVuY3Rpb24odCxlLGksbil7Zm9yKGxldCByPTAscz1lLmxlbmd0aDtyIT09czsrK3Ipe2NvbnN0IHM9ZVtyXSxvPWlbcy5pZF07ITEhPT1vLm5lZWRzVXBkYXRlJiZzLnNldFZhbHVlKHQsby52YWx1ZSxuKX19LGFhLnNlcVdpdGhWYWx1ZT1mdW5jdGlvbih0LGUpe2NvbnN0IGk9W107Zm9yKGxldCBuPTAscj10Lmxlbmd0aDtuIT09cjsrK24pe2NvbnN0IHI9dFtuXTtyLmlkIGluIGUmJmkucHVzaChyKX1yZXR1cm4gaX07bGV0IGhhPTA7ZnVuY3Rpb24gbGEodCl7c3dpdGNoKHQpe2Nhc2UgWGk6cmV0dXJuW1wiTGluZWFyXCIsXCIoIHZhbHVlIClcIl07Y2FzZSAzMDAxOnJldHVybltcInNSR0JcIixcIiggdmFsdWUgKVwiXTtjYXNlIDMwMDI6cmV0dXJuW1wiUkdCRVwiLFwiKCB2YWx1ZSApXCJdO2Nhc2UgMzAwNDpyZXR1cm5bXCJSR0JNXCIsXCIoIHZhbHVlLCA3LjAgKVwiXTtjYXNlIDMwMDU6cmV0dXJuW1wiUkdCTVwiLFwiKCB2YWx1ZSwgMTYuMCApXCJdO2Nhc2UgMzAwNjpyZXR1cm5bXCJSR0JEXCIsXCIoIHZhbHVlLCAyNTYuMCApXCJdO2Nhc2UgMzAwNzpyZXR1cm5bXCJHYW1tYVwiLFwiKCB2YWx1ZSwgZmxvYXQoIEdBTU1BX0ZBQ1RPUiApIClcIl07Y2FzZSAzMDAzOnJldHVybltcIkxvZ0x1dlwiLFwiKCB2YWx1ZSApXCJdO2RlZmF1bHQ6cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUHJvZ3JhbTogVW5zdXBwb3J0ZWQgZW5jb2Rpbmc6XCIsdCksW1wiTGluZWFyXCIsXCIoIHZhbHVlIClcIl19fWZ1bmN0aW9uIHVhKHQsZSxpKXtjb25zdCBuPXQuZ2V0U2hhZGVyUGFyYW1ldGVyKGUsMzU3MTMpLHI9dC5nZXRTaGFkZXJJbmZvTG9nKGUpLnRyaW0oKTtpZihuJiZcIlwiPT09cilyZXR1cm5cIlwiO3JldHVyblwiVEhSRUUuV2ViR0xTaGFkZXI6IGdsLmdldFNoYWRlckluZm9Mb2coKSBcIitpK1wiXFxuXCIrcitmdW5jdGlvbih0KXtjb25zdCBlPXQuc3BsaXQoXCJcXG5cIik7Zm9yKGxldCB0PTA7dDxlLmxlbmd0aDt0KyspZVt0XT10KzErXCI6IFwiK2VbdF07cmV0dXJuIGUuam9pbihcIlxcblwiKX0odC5nZXRTaGFkZXJTb3VyY2UoZSkpfWZ1bmN0aW9uIGRhKHQsZSl7Y29uc3QgaT1sYShlKTtyZXR1cm5cInZlYzQgXCIrdCtcIiggdmVjNCB2YWx1ZSApIHsgcmV0dXJuIFwiK2lbMF0rXCJUb0xpbmVhclwiK2lbMV0rXCI7IH1cIn1mdW5jdGlvbiBwYSh0LGUpe2NvbnN0IGk9bGEoZSk7cmV0dXJuXCJ2ZWM0IFwiK3QrXCIoIHZlYzQgdmFsdWUgKSB7IHJldHVybiBMaW5lYXJUb1wiK2lbMF0raVsxXStcIjsgfVwifWZ1bmN0aW9uIGZhKHQsZSl7bGV0IGk7c3dpdGNoKGUpe2Nhc2UgMTppPVwiTGluZWFyXCI7YnJlYWs7Y2FzZSAyOmk9XCJSZWluaGFyZFwiO2JyZWFrO2Nhc2UgMzppPVwiT3B0aW1pemVkQ2luZW9uXCI7YnJlYWs7Y2FzZSA0Omk9XCJBQ0VTRmlsbWljXCI7YnJlYWs7Y2FzZSA1Omk9XCJDdXN0b21cIjticmVhaztkZWZhdWx0OmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUHJvZ3JhbTogVW5zdXBwb3J0ZWQgdG9uZU1hcHBpbmc6XCIsZSksaT1cIkxpbmVhclwifXJldHVyblwidmVjMyBcIit0K1wiKCB2ZWMzIGNvbG9yICkgeyByZXR1cm4gXCIraStcIlRvbmVNYXBwaW5nKCBjb2xvciApOyB9XCJ9ZnVuY3Rpb24gbWEodCl7cmV0dXJuXCJcIiE9PXR9ZnVuY3Rpb24gZ2EodCxlKXtyZXR1cm4gdC5yZXBsYWNlKC9OVU1fRElSX0xJR0hUUy9nLGUubnVtRGlyTGlnaHRzKS5yZXBsYWNlKC9OVU1fU1BPVF9MSUdIVFMvZyxlLm51bVNwb3RMaWdodHMpLnJlcGxhY2UoL05VTV9SRUNUX0FSRUFfTElHSFRTL2csZS5udW1SZWN0QXJlYUxpZ2h0cykucmVwbGFjZSgvTlVNX1BPSU5UX0xJR0hUUy9nLGUubnVtUG9pbnRMaWdodHMpLnJlcGxhY2UoL05VTV9IRU1JX0xJR0hUUy9nLGUubnVtSGVtaUxpZ2h0cykucmVwbGFjZSgvTlVNX0RJUl9MSUdIVF9TSEFET1dTL2csZS5udW1EaXJMaWdodFNoYWRvd3MpLnJlcGxhY2UoL05VTV9TUE9UX0xJR0hUX1NIQURPV1MvZyxlLm51bVNwb3RMaWdodFNoYWRvd3MpLnJlcGxhY2UoL05VTV9QT0lOVF9MSUdIVF9TSEFET1dTL2csZS5udW1Qb2ludExpZ2h0U2hhZG93cyl9ZnVuY3Rpb24gX2EodCxlKXtyZXR1cm4gdC5yZXBsYWNlKC9OVU1fQ0xJUFBJTkdfUExBTkVTL2csZS5udW1DbGlwcGluZ1BsYW5lcykucmVwbGFjZSgvVU5JT05fQ0xJUFBJTkdfUExBTkVTL2csZS5udW1DbGlwcGluZ1BsYW5lcy1lLm51bUNsaXBJbnRlcnNlY3Rpb24pfWNvbnN0IHZhPS9eWyBcXHRdKiNpbmNsdWRlICs8KFtcXHdcXGQuL10rKT4vZ207ZnVuY3Rpb24geWEodCl7cmV0dXJuIHQucmVwbGFjZSh2YSxiYSl9ZnVuY3Rpb24gYmEodCxlKXtjb25zdCBpPVdzW2VdO2lmKHZvaWQgMD09PWkpdGhyb3cgbmV3IEVycm9yKFwiQ2FuIG5vdCByZXNvbHZlICNpbmNsdWRlIDxcIitlK1wiPlwiKTtyZXR1cm4geWEoaSl9Y29uc3QgeGE9LyNwcmFnbWEgdW5yb2xsX2xvb3BbXFxzXSs/Zm9yIFxcKCBpbnQgaSBcXD0gKFxcZCspXFw7IGkgPCAoXFxkKylcXDsgaSBcXCtcXCsgXFwpIFxceyhbXFxzXFxTXSs/KSg/PVxcfSlcXH0vZyx3YT0vI3ByYWdtYSB1bnJvbGxfbG9vcF9zdGFydFxccytmb3JcXHMqXFwoXFxzKmludFxccytpXFxzKj1cXHMqKFxcZCspXFxzKjtcXHMqaVxccyo8XFxzKihcXGQrKVxccyo7XFxzKmlcXHMqXFwrXFwrXFxzKlxcKVxccyp7KFtcXHNcXFNdKz8pfVxccysjcHJhZ21hIHVucm9sbF9sb29wX2VuZC9nO2Z1bmN0aW9uIFNhKHQpe3JldHVybiB0LnJlcGxhY2Uod2EsVGEpLnJlcGxhY2UoeGEsTWEpfWZ1bmN0aW9uIE1hKHQsZSxpLG4pe3JldHVybiBjb25zb2xlLndhcm4oXCJXZWJHTFByb2dyYW06ICNwcmFnbWEgdW5yb2xsX2xvb3Agc2hhZGVyIHN5bnRheCBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlICNwcmFnbWEgdW5yb2xsX2xvb3Bfc3RhcnQgc3ludGF4IGluc3RlYWQuXCIpLFRhKHQsZSxpLG4pfWZ1bmN0aW9uIFRhKHQsZSxpLG4pe2xldCByPVwiXCI7Zm9yKGxldCB0PXBhcnNlSW50KGUpO3Q8cGFyc2VJbnQoaSk7dCsrKXIrPW4ucmVwbGFjZSgvXFxbXFxzKmlcXHMqXFxdL2csXCJbIFwiK3QrXCIgXVwiKS5yZXBsYWNlKC9VTlJPTExFRF9MT09QX0lOREVYL2csdCk7cmV0dXJuIHJ9ZnVuY3Rpb24gQ2EodCl7bGV0IGU9XCJwcmVjaXNpb24gXCIrdC5wcmVjaXNpb24rXCIgZmxvYXQ7XFxucHJlY2lzaW9uIFwiK3QucHJlY2lzaW9uK1wiIGludDtcIjtyZXR1cm5cImhpZ2hwXCI9PT10LnByZWNpc2lvbj9lKz1cIlxcbiNkZWZpbmUgSElHSF9QUkVDSVNJT05cIjpcIm1lZGl1bXBcIj09PXQucHJlY2lzaW9uP2UrPVwiXFxuI2RlZmluZSBNRURJVU1fUFJFQ0lTSU9OXCI6XCJsb3dwXCI9PT10LnByZWNpc2lvbiYmKGUrPVwiXFxuI2RlZmluZSBMT1dfUFJFQ0lTSU9OXCIpLGV9ZnVuY3Rpb24gRWEodCxlLGksbil7Y29uc3Qgcj10LmdldENvbnRleHQoKSxzPWkuZGVmaW5lcztsZXQgbz1pLnZlcnRleFNoYWRlcixhPWkuZnJhZ21lbnRTaGFkZXI7Y29uc3QgYz1mdW5jdGlvbih0KXtsZXQgZT1cIlNIQURPV01BUF9UWVBFX0JBU0lDXCI7cmV0dXJuIDE9PT10LnNoYWRvd01hcFR5cGU/ZT1cIlNIQURPV01BUF9UWVBFX1BDRlwiOjI9PT10LnNoYWRvd01hcFR5cGU/ZT1cIlNIQURPV01BUF9UWVBFX1BDRl9TT0ZUXCI6Mz09PXQuc2hhZG93TWFwVHlwZSYmKGU9XCJTSEFET1dNQVBfVFlQRV9WU01cIiksZX0oaSksaD1mdW5jdGlvbih0KXtsZXQgZT1cIkVOVk1BUF9UWVBFX0NVQkVcIjtpZih0LmVudk1hcClzd2l0Y2godC5lbnZNYXBNb2RlKXtjYXNlIDMwMTpjYXNlIDMwMjplPVwiRU5WTUFQX1RZUEVfQ1VCRVwiO2JyZWFrO2Nhc2UgMzA2OmNhc2UgMzA3OmU9XCJFTlZNQVBfVFlQRV9DVUJFX1VWXCJ9cmV0dXJuIGV9KGkpLGw9ZnVuY3Rpb24odCl7bGV0IGU9XCJFTlZNQVBfTU9ERV9SRUZMRUNUSU9OXCI7aWYodC5lbnZNYXApc3dpdGNoKHQuZW52TWFwTW9kZSl7Y2FzZSAzMDI6Y2FzZSAzMDc6ZT1cIkVOVk1BUF9NT0RFX1JFRlJBQ1RJT05cIn1yZXR1cm4gZX0oaSksdT1mdW5jdGlvbih0KXtsZXQgZT1cIkVOVk1BUF9CTEVORElOR19OT05FXCI7aWYodC5lbnZNYXApc3dpdGNoKHQuY29tYmluZSl7Y2FzZSAwOmU9XCJFTlZNQVBfQkxFTkRJTkdfTVVMVElQTFlcIjticmVhaztjYXNlIDE6ZT1cIkVOVk1BUF9CTEVORElOR19NSVhcIjticmVhaztjYXNlIDI6ZT1cIkVOVk1BUF9CTEVORElOR19BRERcIn1yZXR1cm4gZX0oaSksZD10LmdhbW1hRmFjdG9yPjA/dC5nYW1tYUZhY3RvcjoxLHA9aS5pc1dlYkdMMj9cIlwiOmZ1bmN0aW9uKHQpe3JldHVyblt0LmV4dGVuc2lvbkRlcml2YXRpdmVzfHx0LmVudk1hcEN1YmVVVnx8dC5idW1wTWFwfHx0LnRhbmdlbnRTcGFjZU5vcm1hbE1hcHx8dC5jbGVhcmNvYXROb3JtYWxNYXB8fHQuZmxhdFNoYWRpbmd8fFwicGh5c2ljYWxcIj09PXQuc2hhZGVySUQ/XCIjZXh0ZW5zaW9uIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGVuYWJsZVwiOlwiXCIsKHQuZXh0ZW5zaW9uRnJhZ0RlcHRofHx0LmxvZ2FyaXRobWljRGVwdGhCdWZmZXIpJiZ0LnJlbmRlcmVyRXh0ZW5zaW9uRnJhZ0RlcHRoP1wiI2V4dGVuc2lvbiBHTF9FWFRfZnJhZ19kZXB0aCA6IGVuYWJsZVwiOlwiXCIsdC5leHRlbnNpb25EcmF3QnVmZmVycyYmdC5yZW5kZXJlckV4dGVuc2lvbkRyYXdCdWZmZXJzP1wiI2V4dGVuc2lvbiBHTF9FWFRfZHJhd19idWZmZXJzIDogcmVxdWlyZVwiOlwiXCIsKHQuZXh0ZW5zaW9uU2hhZGVyVGV4dHVyZUxPRHx8dC5lbnZNYXApJiZ0LnJlbmRlcmVyRXh0ZW5zaW9uU2hhZGVyVGV4dHVyZUxvZD9cIiNleHRlbnNpb24gR0xfRVhUX3NoYWRlcl90ZXh0dXJlX2xvZCA6IGVuYWJsZVwiOlwiXCJdLmZpbHRlcihtYSkuam9pbihcIlxcblwiKX0oaSksZj1mdW5jdGlvbih0KXtjb25zdCBlPVtdO2Zvcihjb25zdCBpIGluIHQpe2NvbnN0IG49dFtpXTshMSE9PW4mJmUucHVzaChcIiNkZWZpbmUgXCIraStcIiBcIituKX1yZXR1cm4gZS5qb2luKFwiXFxuXCIpfShzKSxtPXIuY3JlYXRlUHJvZ3JhbSgpO2xldCBnLF8sdj1pLmdsc2xWZXJzaW9uP1wiI3ZlcnNpb24gXCIraS5nbHNsVmVyc2lvbitcIlxcblwiOlwiXCI7aS5pc1Jhd1NoYWRlck1hdGVyaWFsPyhnPVtmXS5maWx0ZXIobWEpLmpvaW4oXCJcXG5cIiksZy5sZW5ndGg+MCYmKGcrPVwiXFxuXCIpLF89W3AsZl0uZmlsdGVyKG1hKS5qb2luKFwiXFxuXCIpLF8ubGVuZ3RoPjAmJihfKz1cIlxcblwiKSk6KGc9W0NhKGkpLFwiI2RlZmluZSBTSEFERVJfTkFNRSBcIitpLnNoYWRlck5hbWUsZixpLmluc3RhbmNpbmc/XCIjZGVmaW5lIFVTRV9JTlNUQU5DSU5HXCI6XCJcIixpLmluc3RhbmNpbmdDb2xvcj9cIiNkZWZpbmUgVVNFX0lOU1RBTkNJTkdfQ09MT1JcIjpcIlwiLGkuc3VwcG9ydHNWZXJ0ZXhUZXh0dXJlcz9cIiNkZWZpbmUgVkVSVEVYX1RFWFRVUkVTXCI6XCJcIixcIiNkZWZpbmUgR0FNTUFfRkFDVE9SIFwiK2QsXCIjZGVmaW5lIE1BWF9CT05FUyBcIitpLm1heEJvbmVzLGkudXNlRm9nJiZpLmZvZz9cIiNkZWZpbmUgVVNFX0ZPR1wiOlwiXCIsaS51c2VGb2cmJmkuZm9nRXhwMj9cIiNkZWZpbmUgRk9HX0VYUDJcIjpcIlwiLGkubWFwP1wiI2RlZmluZSBVU0VfTUFQXCI6XCJcIixpLmVudk1hcD9cIiNkZWZpbmUgVVNFX0VOVk1BUFwiOlwiXCIsaS5lbnZNYXA/XCIjZGVmaW5lIFwiK2w6XCJcIixpLmxpZ2h0TWFwP1wiI2RlZmluZSBVU0VfTElHSFRNQVBcIjpcIlwiLGkuYW9NYXA/XCIjZGVmaW5lIFVTRV9BT01BUFwiOlwiXCIsaS5lbWlzc2l2ZU1hcD9cIiNkZWZpbmUgVVNFX0VNSVNTSVZFTUFQXCI6XCJcIixpLmJ1bXBNYXA/XCIjZGVmaW5lIFVTRV9CVU1QTUFQXCI6XCJcIixpLm5vcm1hbE1hcD9cIiNkZWZpbmUgVVNFX05PUk1BTE1BUFwiOlwiXCIsaS5ub3JtYWxNYXAmJmkub2JqZWN0U3BhY2VOb3JtYWxNYXA/XCIjZGVmaW5lIE9CSkVDVFNQQUNFX05PUk1BTE1BUFwiOlwiXCIsaS5ub3JtYWxNYXAmJmkudGFuZ2VudFNwYWNlTm9ybWFsTWFwP1wiI2RlZmluZSBUQU5HRU5UU1BBQ0VfTk9STUFMTUFQXCI6XCJcIixpLmNsZWFyY29hdE1hcD9cIiNkZWZpbmUgVVNFX0NMRUFSQ09BVE1BUFwiOlwiXCIsaS5jbGVhcmNvYXRSb3VnaG5lc3NNYXA/XCIjZGVmaW5lIFVTRV9DTEVBUkNPQVRfUk9VR0hORVNTTUFQXCI6XCJcIixpLmNsZWFyY29hdE5vcm1hbE1hcD9cIiNkZWZpbmUgVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVBcIjpcIlwiLGkuZGlzcGxhY2VtZW50TWFwJiZpLnN1cHBvcnRzVmVydGV4VGV4dHVyZXM/XCIjZGVmaW5lIFVTRV9ESVNQTEFDRU1FTlRNQVBcIjpcIlwiLGkuc3BlY3VsYXJNYXA/XCIjZGVmaW5lIFVTRV9TUEVDVUxBUk1BUFwiOlwiXCIsaS5yb3VnaG5lc3NNYXA/XCIjZGVmaW5lIFVTRV9ST1VHSE5FU1NNQVBcIjpcIlwiLGkubWV0YWxuZXNzTWFwP1wiI2RlZmluZSBVU0VfTUVUQUxORVNTTUFQXCI6XCJcIixpLmFscGhhTWFwP1wiI2RlZmluZSBVU0VfQUxQSEFNQVBcIjpcIlwiLGkudHJhbnNtaXNzaW9uTWFwP1wiI2RlZmluZSBVU0VfVFJBTlNNSVNTSU9OTUFQXCI6XCJcIixpLnZlcnRleFRhbmdlbnRzP1wiI2RlZmluZSBVU0VfVEFOR0VOVFwiOlwiXCIsaS52ZXJ0ZXhDb2xvcnM/XCIjZGVmaW5lIFVTRV9DT0xPUlwiOlwiXCIsaS52ZXJ0ZXhVdnM/XCIjZGVmaW5lIFVTRV9VVlwiOlwiXCIsaS51dnNWZXJ0ZXhPbmx5P1wiI2RlZmluZSBVVlNfVkVSVEVYX09OTFlcIjpcIlwiLGkuZmxhdFNoYWRpbmc/XCIjZGVmaW5lIEZMQVRfU0hBREVEXCI6XCJcIixpLnNraW5uaW5nP1wiI2RlZmluZSBVU0VfU0tJTk5JTkdcIjpcIlwiLGkudXNlVmVydGV4VGV4dHVyZT9cIiNkZWZpbmUgQk9ORV9URVhUVVJFXCI6XCJcIixpLm1vcnBoVGFyZ2V0cz9cIiNkZWZpbmUgVVNFX01PUlBIVEFSR0VUU1wiOlwiXCIsaS5tb3JwaE5vcm1hbHMmJiExPT09aS5mbGF0U2hhZGluZz9cIiNkZWZpbmUgVVNFX01PUlBITk9STUFMU1wiOlwiXCIsaS5kb3VibGVTaWRlZD9cIiNkZWZpbmUgRE9VQkxFX1NJREVEXCI6XCJcIixpLmZsaXBTaWRlZD9cIiNkZWZpbmUgRkxJUF9TSURFRFwiOlwiXCIsaS5zaGFkb3dNYXBFbmFibGVkP1wiI2RlZmluZSBVU0VfU0hBRE9XTUFQXCI6XCJcIixpLnNoYWRvd01hcEVuYWJsZWQ/XCIjZGVmaW5lIFwiK2M6XCJcIixpLnNpemVBdHRlbnVhdGlvbj9cIiNkZWZpbmUgVVNFX1NJWkVBVFRFTlVBVElPTlwiOlwiXCIsaS5sb2dhcml0aG1pY0RlcHRoQnVmZmVyP1wiI2RlZmluZSBVU0VfTE9HREVQVEhCVUZcIjpcIlwiLGkubG9nYXJpdGhtaWNEZXB0aEJ1ZmZlciYmaS5yZW5kZXJlckV4dGVuc2lvbkZyYWdEZXB0aD9cIiNkZWZpbmUgVVNFX0xPR0RFUFRIQlVGX0VYVFwiOlwiXCIsXCJ1bmlmb3JtIG1hdDQgbW9kZWxNYXRyaXg7XCIsXCJ1bmlmb3JtIG1hdDQgbW9kZWxWaWV3TWF0cml4O1wiLFwidW5pZm9ybSBtYXQ0IHByb2plY3Rpb25NYXRyaXg7XCIsXCJ1bmlmb3JtIG1hdDQgdmlld01hdHJpeDtcIixcInVuaWZvcm0gbWF0MyBub3JtYWxNYXRyaXg7XCIsXCJ1bmlmb3JtIHZlYzMgY2FtZXJhUG9zaXRpb247XCIsXCJ1bmlmb3JtIGJvb2wgaXNPcnRob2dyYXBoaWM7XCIsXCIjaWZkZWYgVVNFX0lOU1RBTkNJTkdcIixcIlxcdGF0dHJpYnV0ZSBtYXQ0IGluc3RhbmNlTWF0cml4O1wiLFwiI2VuZGlmXCIsXCIjaWZkZWYgVVNFX0lOU1RBTkNJTkdfQ09MT1JcIixcIlxcdGF0dHJpYnV0ZSB2ZWMzIGluc3RhbmNlQ29sb3I7XCIsXCIjZW5kaWZcIixcImF0dHJpYnV0ZSB2ZWMzIHBvc2l0aW9uO1wiLFwiYXR0cmlidXRlIHZlYzMgbm9ybWFsO1wiLFwiYXR0cmlidXRlIHZlYzIgdXY7XCIsXCIjaWZkZWYgVVNFX1RBTkdFTlRcIixcIlxcdGF0dHJpYnV0ZSB2ZWM0IHRhbmdlbnQ7XCIsXCIjZW5kaWZcIixcIiNpZmRlZiBVU0VfQ09MT1JcIixcIlxcdGF0dHJpYnV0ZSB2ZWMzIGNvbG9yO1wiLFwiI2VuZGlmXCIsXCIjaWZkZWYgVVNFX01PUlBIVEFSR0VUU1wiLFwiXFx0YXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQwO1wiLFwiXFx0YXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQxO1wiLFwiXFx0YXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQyO1wiLFwiXFx0YXR0cmlidXRlIHZlYzMgbW9ycGhUYXJnZXQzO1wiLFwiXFx0I2lmZGVmIFVTRV9NT1JQSE5PUk1BTFNcIixcIlxcdFxcdGF0dHJpYnV0ZSB2ZWMzIG1vcnBoTm9ybWFsMDtcIixcIlxcdFxcdGF0dHJpYnV0ZSB2ZWMzIG1vcnBoTm9ybWFsMTtcIixcIlxcdFxcdGF0dHJpYnV0ZSB2ZWMzIG1vcnBoTm9ybWFsMjtcIixcIlxcdFxcdGF0dHJpYnV0ZSB2ZWMzIG1vcnBoTm9ybWFsMztcIixcIlxcdCNlbHNlXCIsXCJcXHRcXHRhdHRyaWJ1dGUgdmVjMyBtb3JwaFRhcmdldDQ7XCIsXCJcXHRcXHRhdHRyaWJ1dGUgdmVjMyBtb3JwaFRhcmdldDU7XCIsXCJcXHRcXHRhdHRyaWJ1dGUgdmVjMyBtb3JwaFRhcmdldDY7XCIsXCJcXHRcXHRhdHRyaWJ1dGUgdmVjMyBtb3JwaFRhcmdldDc7XCIsXCJcXHQjZW5kaWZcIixcIiNlbmRpZlwiLFwiI2lmZGVmIFVTRV9TS0lOTklOR1wiLFwiXFx0YXR0cmlidXRlIHZlYzQgc2tpbkluZGV4O1wiLFwiXFx0YXR0cmlidXRlIHZlYzQgc2tpbldlaWdodDtcIixcIiNlbmRpZlwiLFwiXFxuXCJdLmZpbHRlcihtYSkuam9pbihcIlxcblwiKSxfPVtwLENhKGkpLFwiI2RlZmluZSBTSEFERVJfTkFNRSBcIitpLnNoYWRlck5hbWUsZixpLmFscGhhVGVzdD9cIiNkZWZpbmUgQUxQSEFURVNUIFwiK2kuYWxwaGFUZXN0KyhpLmFscGhhVGVzdCUxP1wiXCI6XCIuMFwiKTpcIlwiLFwiI2RlZmluZSBHQU1NQV9GQUNUT1IgXCIrZCxpLnVzZUZvZyYmaS5mb2c/XCIjZGVmaW5lIFVTRV9GT0dcIjpcIlwiLGkudXNlRm9nJiZpLmZvZ0V4cDI/XCIjZGVmaW5lIEZPR19FWFAyXCI6XCJcIixpLm1hcD9cIiNkZWZpbmUgVVNFX01BUFwiOlwiXCIsaS5tYXRjYXA/XCIjZGVmaW5lIFVTRV9NQVRDQVBcIjpcIlwiLGkuZW52TWFwP1wiI2RlZmluZSBVU0VfRU5WTUFQXCI6XCJcIixpLmVudk1hcD9cIiNkZWZpbmUgXCIraDpcIlwiLGkuZW52TWFwP1wiI2RlZmluZSBcIitsOlwiXCIsaS5lbnZNYXA/XCIjZGVmaW5lIFwiK3U6XCJcIixpLmxpZ2h0TWFwP1wiI2RlZmluZSBVU0VfTElHSFRNQVBcIjpcIlwiLGkuYW9NYXA/XCIjZGVmaW5lIFVTRV9BT01BUFwiOlwiXCIsaS5lbWlzc2l2ZU1hcD9cIiNkZWZpbmUgVVNFX0VNSVNTSVZFTUFQXCI6XCJcIixpLmJ1bXBNYXA/XCIjZGVmaW5lIFVTRV9CVU1QTUFQXCI6XCJcIixpLm5vcm1hbE1hcD9cIiNkZWZpbmUgVVNFX05PUk1BTE1BUFwiOlwiXCIsaS5ub3JtYWxNYXAmJmkub2JqZWN0U3BhY2VOb3JtYWxNYXA/XCIjZGVmaW5lIE9CSkVDVFNQQUNFX05PUk1BTE1BUFwiOlwiXCIsaS5ub3JtYWxNYXAmJmkudGFuZ2VudFNwYWNlTm9ybWFsTWFwP1wiI2RlZmluZSBUQU5HRU5UU1BBQ0VfTk9STUFMTUFQXCI6XCJcIixpLmNsZWFyY29hdE1hcD9cIiNkZWZpbmUgVVNFX0NMRUFSQ09BVE1BUFwiOlwiXCIsaS5jbGVhcmNvYXRSb3VnaG5lc3NNYXA/XCIjZGVmaW5lIFVTRV9DTEVBUkNPQVRfUk9VR0hORVNTTUFQXCI6XCJcIixpLmNsZWFyY29hdE5vcm1hbE1hcD9cIiNkZWZpbmUgVVNFX0NMRUFSQ09BVF9OT1JNQUxNQVBcIjpcIlwiLGkuc3BlY3VsYXJNYXA/XCIjZGVmaW5lIFVTRV9TUEVDVUxBUk1BUFwiOlwiXCIsaS5yb3VnaG5lc3NNYXA/XCIjZGVmaW5lIFVTRV9ST1VHSE5FU1NNQVBcIjpcIlwiLGkubWV0YWxuZXNzTWFwP1wiI2RlZmluZSBVU0VfTUVUQUxORVNTTUFQXCI6XCJcIixpLmFscGhhTWFwP1wiI2RlZmluZSBVU0VfQUxQSEFNQVBcIjpcIlwiLGkuc2hlZW4/XCIjZGVmaW5lIFVTRV9TSEVFTlwiOlwiXCIsaS50cmFuc21pc3Npb25NYXA/XCIjZGVmaW5lIFVTRV9UUkFOU01JU1NJT05NQVBcIjpcIlwiLGkudmVydGV4VGFuZ2VudHM/XCIjZGVmaW5lIFVTRV9UQU5HRU5UXCI6XCJcIixpLnZlcnRleENvbG9yc3x8aS5pbnN0YW5jaW5nQ29sb3I/XCIjZGVmaW5lIFVTRV9DT0xPUlwiOlwiXCIsaS52ZXJ0ZXhVdnM/XCIjZGVmaW5lIFVTRV9VVlwiOlwiXCIsaS51dnNWZXJ0ZXhPbmx5P1wiI2RlZmluZSBVVlNfVkVSVEVYX09OTFlcIjpcIlwiLGkuZ3JhZGllbnRNYXA/XCIjZGVmaW5lIFVTRV9HUkFESUVOVE1BUFwiOlwiXCIsaS5mbGF0U2hhZGluZz9cIiNkZWZpbmUgRkxBVF9TSEFERURcIjpcIlwiLGkuZG91YmxlU2lkZWQ/XCIjZGVmaW5lIERPVUJMRV9TSURFRFwiOlwiXCIsaS5mbGlwU2lkZWQ/XCIjZGVmaW5lIEZMSVBfU0lERURcIjpcIlwiLGkuc2hhZG93TWFwRW5hYmxlZD9cIiNkZWZpbmUgVVNFX1NIQURPV01BUFwiOlwiXCIsaS5zaGFkb3dNYXBFbmFibGVkP1wiI2RlZmluZSBcIitjOlwiXCIsaS5wcmVtdWx0aXBsaWVkQWxwaGE/XCIjZGVmaW5lIFBSRU1VTFRJUExJRURfQUxQSEFcIjpcIlwiLGkucGh5c2ljYWxseUNvcnJlY3RMaWdodHM/XCIjZGVmaW5lIFBIWVNJQ0FMTFlfQ09SUkVDVF9MSUdIVFNcIjpcIlwiLGkubG9nYXJpdGhtaWNEZXB0aEJ1ZmZlcj9cIiNkZWZpbmUgVVNFX0xPR0RFUFRIQlVGXCI6XCJcIixpLmxvZ2FyaXRobWljRGVwdGhCdWZmZXImJmkucmVuZGVyZXJFeHRlbnNpb25GcmFnRGVwdGg/XCIjZGVmaW5lIFVTRV9MT0dERVBUSEJVRl9FWFRcIjpcIlwiLChpLmV4dGVuc2lvblNoYWRlclRleHR1cmVMT0R8fGkuZW52TWFwKSYmaS5yZW5kZXJlckV4dGVuc2lvblNoYWRlclRleHR1cmVMb2Q/XCIjZGVmaW5lIFRFWFRVUkVfTE9EX0VYVFwiOlwiXCIsXCJ1bmlmb3JtIG1hdDQgdmlld01hdHJpeDtcIixcInVuaWZvcm0gdmVjMyBjYW1lcmFQb3NpdGlvbjtcIixcInVuaWZvcm0gYm9vbCBpc09ydGhvZ3JhcGhpYztcIiwwIT09aS50b25lTWFwcGluZz9cIiNkZWZpbmUgVE9ORV9NQVBQSU5HXCI6XCJcIiwwIT09aS50b25lTWFwcGluZz9Xcy50b25lbWFwcGluZ19wYXJzX2ZyYWdtZW50OlwiXCIsMCE9PWkudG9uZU1hcHBpbmc/ZmEoXCJ0b25lTWFwcGluZ1wiLGkudG9uZU1hcHBpbmcpOlwiXCIsaS5kaXRoZXJpbmc/XCIjZGVmaW5lIERJVEhFUklOR1wiOlwiXCIsV3MuZW5jb2RpbmdzX3BhcnNfZnJhZ21lbnQsaS5tYXA/ZGEoXCJtYXBUZXhlbFRvTGluZWFyXCIsaS5tYXBFbmNvZGluZyk6XCJcIixpLm1hdGNhcD9kYShcIm1hdGNhcFRleGVsVG9MaW5lYXJcIixpLm1hdGNhcEVuY29kaW5nKTpcIlwiLGkuZW52TWFwP2RhKFwiZW52TWFwVGV4ZWxUb0xpbmVhclwiLGkuZW52TWFwRW5jb2RpbmcpOlwiXCIsaS5lbWlzc2l2ZU1hcD9kYShcImVtaXNzaXZlTWFwVGV4ZWxUb0xpbmVhclwiLGkuZW1pc3NpdmVNYXBFbmNvZGluZyk6XCJcIixpLmxpZ2h0TWFwP2RhKFwibGlnaHRNYXBUZXhlbFRvTGluZWFyXCIsaS5saWdodE1hcEVuY29kaW5nKTpcIlwiLHBhKFwibGluZWFyVG9PdXRwdXRUZXhlbFwiLGkub3V0cHV0RW5jb2RpbmcpLGkuZGVwdGhQYWNraW5nP1wiI2RlZmluZSBERVBUSF9QQUNLSU5HIFwiK2kuZGVwdGhQYWNraW5nOlwiXCIsXCJcXG5cIl0uZmlsdGVyKG1hKS5qb2luKFwiXFxuXCIpKSxvPXlhKG8pLG89Z2EobyxpKSxvPV9hKG8saSksYT15YShhKSxhPWdhKGEsaSksYT1fYShhLGkpLG89U2EobyksYT1TYShhKSxpLmlzV2ViR0wyJiYhMCE9PWkuaXNSYXdTaGFkZXJNYXRlcmlhbCYmKHY9XCIjdmVyc2lvbiAzMDAgZXNcXG5cIixnPVtcIiNkZWZpbmUgYXR0cmlidXRlIGluXCIsXCIjZGVmaW5lIHZhcnlpbmcgb3V0XCIsXCIjZGVmaW5lIHRleHR1cmUyRCB0ZXh0dXJlXCJdLmpvaW4oXCJcXG5cIikrXCJcXG5cIitnLF89W1wiI2RlZmluZSB2YXJ5aW5nIGluXCIsaS5nbHNsVmVyc2lvbj09PUtpP1wiXCI6XCJvdXQgaGlnaHAgdmVjNCBwY19mcmFnQ29sb3I7XCIsaS5nbHNsVmVyc2lvbj09PUtpP1wiXCI6XCIjZGVmaW5lIGdsX0ZyYWdDb2xvciBwY19mcmFnQ29sb3JcIixcIiNkZWZpbmUgZ2xfRnJhZ0RlcHRoRVhUIGdsX0ZyYWdEZXB0aFwiLFwiI2RlZmluZSB0ZXh0dXJlMkQgdGV4dHVyZVwiLFwiI2RlZmluZSB0ZXh0dXJlQ3ViZSB0ZXh0dXJlXCIsXCIjZGVmaW5lIHRleHR1cmUyRFByb2ogdGV4dHVyZVByb2pcIixcIiNkZWZpbmUgdGV4dHVyZTJETG9kRVhUIHRleHR1cmVMb2RcIixcIiNkZWZpbmUgdGV4dHVyZTJEUHJvakxvZEVYVCB0ZXh0dXJlUHJvakxvZFwiLFwiI2RlZmluZSB0ZXh0dXJlQ3ViZUxvZEVYVCB0ZXh0dXJlTG9kXCIsXCIjZGVmaW5lIHRleHR1cmUyREdyYWRFWFQgdGV4dHVyZUdyYWRcIixcIiNkZWZpbmUgdGV4dHVyZTJEUHJvakdyYWRFWFQgdGV4dHVyZVByb2pHcmFkXCIsXCIjZGVmaW5lIHRleHR1cmVDdWJlR3JhZEVYVCB0ZXh0dXJlR3JhZFwiXS5qb2luKFwiXFxuXCIpK1wiXFxuXCIrXyk7Y29uc3QgeT12K18rYSxiPWNhKHIsMzU2MzMsditnK28pLHg9Y2EociwzNTYzMix5KTtpZihyLmF0dGFjaFNoYWRlcihtLGIpLHIuYXR0YWNoU2hhZGVyKG0seCksdm9pZCAwIT09aS5pbmRleDBBdHRyaWJ1dGVOYW1lP3IuYmluZEF0dHJpYkxvY2F0aW9uKG0sMCxpLmluZGV4MEF0dHJpYnV0ZU5hbWUpOiEwPT09aS5tb3JwaFRhcmdldHMmJnIuYmluZEF0dHJpYkxvY2F0aW9uKG0sMCxcInBvc2l0aW9uXCIpLHIubGlua1Byb2dyYW0obSksdC5kZWJ1Zy5jaGVja1NoYWRlckVycm9ycyl7Y29uc3QgdD1yLmdldFByb2dyYW1JbmZvTG9nKG0pLnRyaW0oKSxlPXIuZ2V0U2hhZGVySW5mb0xvZyhiKS50cmltKCksaT1yLmdldFNoYWRlckluZm9Mb2coeCkudHJpbSgpO2xldCBuPSEwLHM9ITA7aWYoITE9PT1yLmdldFByb2dyYW1QYXJhbWV0ZXIobSwzNTcxNCkpe249ITE7Y29uc3QgZT11YShyLGIsXCJ2ZXJ0ZXhcIiksaT11YShyLHgsXCJmcmFnbWVudFwiKTtjb25zb2xlLmVycm9yKFwiVEhSRUUuV2ViR0xQcm9ncmFtOiBzaGFkZXIgZXJyb3I6IFwiLHIuZ2V0RXJyb3IoKSxcIjM1NzE1XCIsci5nZXRQcm9ncmFtUGFyYW1ldGVyKG0sMzU3MTUpLFwiZ2wuZ2V0UHJvZ3JhbUluZm9Mb2dcIix0LGUsaSl9ZWxzZVwiXCIhPT10P2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUHJvZ3JhbTogZ2wuZ2V0UHJvZ3JhbUluZm9Mb2coKVwiLHQpOlwiXCIhPT1lJiZcIlwiIT09aXx8KHM9ITEpO3MmJih0aGlzLmRpYWdub3N0aWNzPXtydW5uYWJsZTpuLHByb2dyYW1Mb2c6dCx2ZXJ0ZXhTaGFkZXI6e2xvZzplLHByZWZpeDpnfSxmcmFnbWVudFNoYWRlcjp7bG9nOmkscHJlZml4Ol99fSl9bGV0IHcsUztyZXR1cm4gci5kZWxldGVTaGFkZXIoYiksci5kZWxldGVTaGFkZXIoeCksdGhpcy5nZXRVbmlmb3Jtcz1mdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT13JiYodz1uZXcgYWEocixtKSksd30sdGhpcy5nZXRBdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHZvaWQgMD09PVMmJihTPWZ1bmN0aW9uKHQsZSl7Y29uc3QgaT17fSxuPXQuZ2V0UHJvZ3JhbVBhcmFtZXRlcihlLDM1NzIxKTtmb3IobGV0IHI9MDtyPG47cisrKXtjb25zdCBuPXQuZ2V0QWN0aXZlQXR0cmliKGUscikubmFtZTtpW25dPXQuZ2V0QXR0cmliTG9jYXRpb24oZSxuKX1yZXR1cm4gaX0ocixtKSksU30sdGhpcy5kZXN0cm95PWZ1bmN0aW9uKCl7bi5yZWxlYXNlU3RhdGVzT2ZQcm9ncmFtKHRoaXMpLHIuZGVsZXRlUHJvZ3JhbShtKSx0aGlzLnByb2dyYW09dm9pZCAwfSx0aGlzLm5hbWU9aS5zaGFkZXJOYW1lLHRoaXMuaWQ9aGErKyx0aGlzLmNhY2hlS2V5PWUsdGhpcy51c2VkVGltZXM9MSx0aGlzLnByb2dyYW09bSx0aGlzLnZlcnRleFNoYWRlcj1iLHRoaXMuZnJhZ21lbnRTaGFkZXI9eCx0aGlzfWZ1bmN0aW9uIElhKHQsZSxpLG4scixzKXtjb25zdCBvPVtdLGE9bi5pc1dlYkdMMixjPW4ubG9nYXJpdGhtaWNEZXB0aEJ1ZmZlcixoPW4uZmxvYXRWZXJ0ZXhUZXh0dXJlcyxsPW4ubWF4VmVydGV4VW5pZm9ybXMsdT1uLnZlcnRleFRleHR1cmVzO2xldCBkPW4ucHJlY2lzaW9uO2NvbnN0IHA9e01lc2hEZXB0aE1hdGVyaWFsOlwiZGVwdGhcIixNZXNoRGlzdGFuY2VNYXRlcmlhbDpcImRpc3RhbmNlUkdCQVwiLE1lc2hOb3JtYWxNYXRlcmlhbDpcIm5vcm1hbFwiLE1lc2hCYXNpY01hdGVyaWFsOlwiYmFzaWNcIixNZXNoTGFtYmVydE1hdGVyaWFsOlwibGFtYmVydFwiLE1lc2hQaG9uZ01hdGVyaWFsOlwicGhvbmdcIixNZXNoVG9vbk1hdGVyaWFsOlwidG9vblwiLE1lc2hTdGFuZGFyZE1hdGVyaWFsOlwicGh5c2ljYWxcIixNZXNoUGh5c2ljYWxNYXRlcmlhbDpcInBoeXNpY2FsXCIsTWVzaE1hdGNhcE1hdGVyaWFsOlwibWF0Y2FwXCIsTGluZUJhc2ljTWF0ZXJpYWw6XCJiYXNpY1wiLExpbmVEYXNoZWRNYXRlcmlhbDpcImRhc2hlZFwiLFBvaW50c01hdGVyaWFsOlwicG9pbnRzXCIsU2hhZG93TWF0ZXJpYWw6XCJzaGFkb3dcIixTcHJpdGVNYXRlcmlhbDpcInNwcml0ZVwifSxmPVtcInByZWNpc2lvblwiLFwiaXNXZWJHTDJcIixcInN1cHBvcnRzVmVydGV4VGV4dHVyZXNcIixcIm91dHB1dEVuY29kaW5nXCIsXCJpbnN0YW5jaW5nXCIsXCJpbnN0YW5jaW5nQ29sb3JcIixcIm1hcFwiLFwibWFwRW5jb2RpbmdcIixcIm1hdGNhcFwiLFwibWF0Y2FwRW5jb2RpbmdcIixcImVudk1hcFwiLFwiZW52TWFwTW9kZVwiLFwiZW52TWFwRW5jb2RpbmdcIixcImVudk1hcEN1YmVVVlwiLFwibGlnaHRNYXBcIixcImxpZ2h0TWFwRW5jb2RpbmdcIixcImFvTWFwXCIsXCJlbWlzc2l2ZU1hcFwiLFwiZW1pc3NpdmVNYXBFbmNvZGluZ1wiLFwiYnVtcE1hcFwiLFwibm9ybWFsTWFwXCIsXCJvYmplY3RTcGFjZU5vcm1hbE1hcFwiLFwidGFuZ2VudFNwYWNlTm9ybWFsTWFwXCIsXCJjbGVhcmNvYXRNYXBcIixcImNsZWFyY29hdFJvdWdobmVzc01hcFwiLFwiY2xlYXJjb2F0Tm9ybWFsTWFwXCIsXCJkaXNwbGFjZW1lbnRNYXBcIixcInNwZWN1bGFyTWFwXCIsXCJyb3VnaG5lc3NNYXBcIixcIm1ldGFsbmVzc01hcFwiLFwiZ3JhZGllbnRNYXBcIixcImFscGhhTWFwXCIsXCJjb21iaW5lXCIsXCJ2ZXJ0ZXhDb2xvcnNcIixcInZlcnRleFRhbmdlbnRzXCIsXCJ2ZXJ0ZXhVdnNcIixcInV2c1ZlcnRleE9ubHlcIixcImZvZ1wiLFwidXNlRm9nXCIsXCJmb2dFeHAyXCIsXCJmbGF0U2hhZGluZ1wiLFwic2l6ZUF0dGVudWF0aW9uXCIsXCJsb2dhcml0aG1pY0RlcHRoQnVmZmVyXCIsXCJza2lubmluZ1wiLFwibWF4Qm9uZXNcIixcInVzZVZlcnRleFRleHR1cmVcIixcIm1vcnBoVGFyZ2V0c1wiLFwibW9ycGhOb3JtYWxzXCIsXCJtYXhNb3JwaFRhcmdldHNcIixcIm1heE1vcnBoTm9ybWFsc1wiLFwicHJlbXVsdGlwbGllZEFscGhhXCIsXCJudW1EaXJMaWdodHNcIixcIm51bVBvaW50TGlnaHRzXCIsXCJudW1TcG90TGlnaHRzXCIsXCJudW1IZW1pTGlnaHRzXCIsXCJudW1SZWN0QXJlYUxpZ2h0c1wiLFwibnVtRGlyTGlnaHRTaGFkb3dzXCIsXCJudW1Qb2ludExpZ2h0U2hhZG93c1wiLFwibnVtU3BvdExpZ2h0U2hhZG93c1wiLFwic2hhZG93TWFwRW5hYmxlZFwiLFwic2hhZG93TWFwVHlwZVwiLFwidG9uZU1hcHBpbmdcIixcInBoeXNpY2FsbHlDb3JyZWN0TGlnaHRzXCIsXCJhbHBoYVRlc3RcIixcImRvdWJsZVNpZGVkXCIsXCJmbGlwU2lkZWRcIixcIm51bUNsaXBwaW5nUGxhbmVzXCIsXCJudW1DbGlwSW50ZXJzZWN0aW9uXCIsXCJkZXB0aFBhY2tpbmdcIixcImRpdGhlcmluZ1wiLFwic2hlZW5cIixcInRyYW5zbWlzc2lvbk1hcFwiXTtmdW5jdGlvbiBtKHQpe2xldCBlO3JldHVybiB0JiZ0LmlzVGV4dHVyZT9lPXQuZW5jb2Rpbmc6dCYmdC5pc1dlYkdMUmVuZGVyVGFyZ2V0Pyhjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFByb2dyYW1zLmdldFRleHR1cmVFbmNvZGluZ0Zyb21NYXA6IGRvbid0IHVzZSByZW5kZXIgdGFyZ2V0cyBhcyB0ZXh0dXJlcy4gVXNlIHRoZWlyIC50ZXh0dXJlIHByb3BlcnR5IGluc3RlYWQuXCIpLGU9dC50ZXh0dXJlLmVuY29kaW5nKTplPVhpLGV9cmV0dXJue2dldFBhcmFtZXRlcnM6ZnVuY3Rpb24ocixvLGYsZyxfKXtjb25zdCB2PWcuZm9nLHk9ci5pc01lc2hTdGFuZGFyZE1hdGVyaWFsP2cuZW52aXJvbm1lbnQ6bnVsbCxiPWUuZ2V0KHIuZW52TWFwfHx5KSx4PXBbci50eXBlXSx3PV8uaXNTa2lubmVkTWVzaD9mdW5jdGlvbih0KXtjb25zdCBlPXQuc2tlbGV0b24uYm9uZXM7aWYoaClyZXR1cm4gMTAyNDt7Y29uc3QgdD1sLGk9TWF0aC5mbG9vcigodC0yMCkvNCksbj1NYXRoLm1pbihpLGUubGVuZ3RoKTtyZXR1cm4gbjxlLmxlbmd0aD8oY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogU2tlbGV0b24gaGFzIFwiK2UubGVuZ3RoK1wiIGJvbmVzLiBUaGlzIEdQVSBzdXBwb3J0cyBcIituK1wiLlwiKSwwKTpufX0oXyk6MDtsZXQgUyxNO2lmKG51bGwhPT1yLnByZWNpc2lvbiYmKGQ9bi5nZXRNYXhQcmVjaXNpb24oci5wcmVjaXNpb24pLGQhPT1yLnByZWNpc2lvbiYmY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xQcm9ncmFtLmdldFBhcmFtZXRlcnM6XCIsci5wcmVjaXNpb24sXCJub3Qgc3VwcG9ydGVkLCB1c2luZ1wiLGQsXCJpbnN0ZWFkLlwiKSkseCl7Y29uc3QgdD1Zc1t4XTtTPXQudmVydGV4U2hhZGVyLE09dC5mcmFnbWVudFNoYWRlcn1lbHNlIFM9ci52ZXJ0ZXhTaGFkZXIsTT1yLmZyYWdtZW50U2hhZGVyO2NvbnN0IFQ9dC5nZXRSZW5kZXJUYXJnZXQoKTtyZXR1cm57aXNXZWJHTDI6YSxzaGFkZXJJRDp4LHNoYWRlck5hbWU6ci50eXBlLHZlcnRleFNoYWRlcjpTLGZyYWdtZW50U2hhZGVyOk0sZGVmaW5lczpyLmRlZmluZXMsaXNSYXdTaGFkZXJNYXRlcmlhbDohMD09PXIuaXNSYXdTaGFkZXJNYXRlcmlhbCxnbHNsVmVyc2lvbjpyLmdsc2xWZXJzaW9uLHByZWNpc2lvbjpkLGluc3RhbmNpbmc6ITA9PT1fLmlzSW5zdGFuY2VkTWVzaCxpbnN0YW5jaW5nQ29sb3I6ITA9PT1fLmlzSW5zdGFuY2VkTWVzaCYmbnVsbCE9PV8uaW5zdGFuY2VDb2xvcixzdXBwb3J0c1ZlcnRleFRleHR1cmVzOnUsb3V0cHV0RW5jb2Rpbmc6bnVsbCE9PVQ/bShULnRleHR1cmUpOnQub3V0cHV0RW5jb2RpbmcsbWFwOiEhci5tYXAsbWFwRW5jb2Rpbmc6bShyLm1hcCksbWF0Y2FwOiEhci5tYXRjYXAsbWF0Y2FwRW5jb2Rpbmc6bShyLm1hdGNhcCksZW52TWFwOiEhYixlbnZNYXBNb2RlOmImJmIubWFwcGluZyxlbnZNYXBFbmNvZGluZzptKGIpLGVudk1hcEN1YmVVVjohIWImJigzMDY9PT1iLm1hcHBpbmd8fDMwNz09PWIubWFwcGluZyksbGlnaHRNYXA6ISFyLmxpZ2h0TWFwLGxpZ2h0TWFwRW5jb2Rpbmc6bShyLmxpZ2h0TWFwKSxhb01hcDohIXIuYW9NYXAsZW1pc3NpdmVNYXA6ISFyLmVtaXNzaXZlTWFwLGVtaXNzaXZlTWFwRW5jb2Rpbmc6bShyLmVtaXNzaXZlTWFwKSxidW1wTWFwOiEhci5idW1wTWFwLG5vcm1hbE1hcDohIXIubm9ybWFsTWFwLG9iamVjdFNwYWNlTm9ybWFsTWFwOjE9PT1yLm5vcm1hbE1hcFR5cGUsdGFuZ2VudFNwYWNlTm9ybWFsTWFwOjA9PT1yLm5vcm1hbE1hcFR5cGUsY2xlYXJjb2F0TWFwOiEhci5jbGVhcmNvYXRNYXAsY2xlYXJjb2F0Um91Z2huZXNzTWFwOiEhci5jbGVhcmNvYXRSb3VnaG5lc3NNYXAsY2xlYXJjb2F0Tm9ybWFsTWFwOiEhci5jbGVhcmNvYXROb3JtYWxNYXAsZGlzcGxhY2VtZW50TWFwOiEhci5kaXNwbGFjZW1lbnRNYXAscm91Z2huZXNzTWFwOiEhci5yb3VnaG5lc3NNYXAsbWV0YWxuZXNzTWFwOiEhci5tZXRhbG5lc3NNYXAsc3BlY3VsYXJNYXA6ISFyLnNwZWN1bGFyTWFwLGFscGhhTWFwOiEhci5hbHBoYU1hcCxncmFkaWVudE1hcDohIXIuZ3JhZGllbnRNYXAsc2hlZW46ISFyLnNoZWVuLHRyYW5zbWlzc2lvbk1hcDohIXIudHJhbnNtaXNzaW9uTWFwLGNvbWJpbmU6ci5jb21iaW5lLHZlcnRleFRhbmdlbnRzOnIubm9ybWFsTWFwJiZyLnZlcnRleFRhbmdlbnRzLHZlcnRleENvbG9yczpyLnZlcnRleENvbG9ycyx2ZXJ0ZXhVdnM6ISEoci5tYXB8fHIuYnVtcE1hcHx8ci5ub3JtYWxNYXB8fHIuc3BlY3VsYXJNYXB8fHIuYWxwaGFNYXB8fHIuZW1pc3NpdmVNYXB8fHIucm91Z2huZXNzTWFwfHxyLm1ldGFsbmVzc01hcHx8ci5jbGVhcmNvYXRNYXB8fHIuY2xlYXJjb2F0Um91Z2huZXNzTWFwfHxyLmNsZWFyY29hdE5vcm1hbE1hcHx8ci5kaXNwbGFjZW1lbnRNYXB8fHIudHJhbnNtaXNzaW9uTWFwKSx1dnNWZXJ0ZXhPbmx5OiEoci5tYXB8fHIuYnVtcE1hcHx8ci5ub3JtYWxNYXB8fHIuc3BlY3VsYXJNYXB8fHIuYWxwaGFNYXB8fHIuZW1pc3NpdmVNYXB8fHIucm91Z2huZXNzTWFwfHxyLm1ldGFsbmVzc01hcHx8ci5jbGVhcmNvYXROb3JtYWxNYXB8fHIudHJhbnNtaXNzaW9uTWFwfHwhci5kaXNwbGFjZW1lbnRNYXApLGZvZzohIXYsdXNlRm9nOnIuZm9nLGZvZ0V4cDI6diYmdi5pc0ZvZ0V4cDIsZmxhdFNoYWRpbmc6ci5mbGF0U2hhZGluZyxzaXplQXR0ZW51YXRpb246ci5zaXplQXR0ZW51YXRpb24sbG9nYXJpdGhtaWNEZXB0aEJ1ZmZlcjpjLHNraW5uaW5nOnIuc2tpbm5pbmcmJnc+MCxtYXhCb25lczp3LHVzZVZlcnRleFRleHR1cmU6aCxtb3JwaFRhcmdldHM6ci5tb3JwaFRhcmdldHMsbW9ycGhOb3JtYWxzOnIubW9ycGhOb3JtYWxzLG1heE1vcnBoVGFyZ2V0czp0Lm1heE1vcnBoVGFyZ2V0cyxtYXhNb3JwaE5vcm1hbHM6dC5tYXhNb3JwaE5vcm1hbHMsbnVtRGlyTGlnaHRzOm8uZGlyZWN0aW9uYWwubGVuZ3RoLG51bVBvaW50TGlnaHRzOm8ucG9pbnQubGVuZ3RoLG51bVNwb3RMaWdodHM6by5zcG90Lmxlbmd0aCxudW1SZWN0QXJlYUxpZ2h0czpvLnJlY3RBcmVhLmxlbmd0aCxudW1IZW1pTGlnaHRzOm8uaGVtaS5sZW5ndGgsbnVtRGlyTGlnaHRTaGFkb3dzOm8uZGlyZWN0aW9uYWxTaGFkb3dNYXAubGVuZ3RoLG51bVBvaW50TGlnaHRTaGFkb3dzOm8ucG9pbnRTaGFkb3dNYXAubGVuZ3RoLG51bVNwb3RMaWdodFNoYWRvd3M6by5zcG90U2hhZG93TWFwLmxlbmd0aCxudW1DbGlwcGluZ1BsYW5lczpzLm51bVBsYW5lcyxudW1DbGlwSW50ZXJzZWN0aW9uOnMubnVtSW50ZXJzZWN0aW9uLGRpdGhlcmluZzpyLmRpdGhlcmluZyxzaGFkb3dNYXBFbmFibGVkOnQuc2hhZG93TWFwLmVuYWJsZWQmJmYubGVuZ3RoPjAsc2hhZG93TWFwVHlwZTp0LnNoYWRvd01hcC50eXBlLHRvbmVNYXBwaW5nOnIudG9uZU1hcHBlZD90LnRvbmVNYXBwaW5nOjAscGh5c2ljYWxseUNvcnJlY3RMaWdodHM6dC5waHlzaWNhbGx5Q29ycmVjdExpZ2h0cyxwcmVtdWx0aXBsaWVkQWxwaGE6ci5wcmVtdWx0aXBsaWVkQWxwaGEsYWxwaGFUZXN0OnIuYWxwaGFUZXN0LGRvdWJsZVNpZGVkOjI9PT1yLnNpZGUsZmxpcFNpZGVkOjE9PT1yLnNpZGUsZGVwdGhQYWNraW5nOnZvaWQgMCE9PXIuZGVwdGhQYWNraW5nJiZyLmRlcHRoUGFja2luZyxpbmRleDBBdHRyaWJ1dGVOYW1lOnIuaW5kZXgwQXR0cmlidXRlTmFtZSxleHRlbnNpb25EZXJpdmF0aXZlczpyLmV4dGVuc2lvbnMmJnIuZXh0ZW5zaW9ucy5kZXJpdmF0aXZlcyxleHRlbnNpb25GcmFnRGVwdGg6ci5leHRlbnNpb25zJiZyLmV4dGVuc2lvbnMuZnJhZ0RlcHRoLGV4dGVuc2lvbkRyYXdCdWZmZXJzOnIuZXh0ZW5zaW9ucyYmci5leHRlbnNpb25zLmRyYXdCdWZmZXJzLGV4dGVuc2lvblNoYWRlclRleHR1cmVMT0Q6ci5leHRlbnNpb25zJiZyLmV4dGVuc2lvbnMuc2hhZGVyVGV4dHVyZUxPRCxyZW5kZXJlckV4dGVuc2lvbkZyYWdEZXB0aDphfHxpLmhhcyhcIkVYVF9mcmFnX2RlcHRoXCIpLHJlbmRlcmVyRXh0ZW5zaW9uRHJhd0J1ZmZlcnM6YXx8aS5oYXMoXCJXRUJHTF9kcmF3X2J1ZmZlcnNcIikscmVuZGVyZXJFeHRlbnNpb25TaGFkZXJUZXh0dXJlTG9kOmF8fGkuaGFzKFwiRVhUX3NoYWRlcl90ZXh0dXJlX2xvZFwiKSxjdXN0b21Qcm9ncmFtQ2FjaGVLZXk6ci5jdXN0b21Qcm9ncmFtQ2FjaGVLZXkoKX19LGdldFByb2dyYW1DYWNoZUtleTpmdW5jdGlvbihlKXtjb25zdCBpPVtdO2lmKGUuc2hhZGVySUQ/aS5wdXNoKGUuc2hhZGVySUQpOihpLnB1c2goZS5mcmFnbWVudFNoYWRlciksaS5wdXNoKGUudmVydGV4U2hhZGVyKSksdm9pZCAwIT09ZS5kZWZpbmVzKWZvcihjb25zdCB0IGluIGUuZGVmaW5lcylpLnB1c2godCksaS5wdXNoKGUuZGVmaW5lc1t0XSk7aWYoITE9PT1lLmlzUmF3U2hhZGVyTWF0ZXJpYWwpe2ZvcihsZXQgdD0wO3Q8Zi5sZW5ndGg7dCsrKWkucHVzaChlW2ZbdF1dKTtpLnB1c2godC5vdXRwdXRFbmNvZGluZyksaS5wdXNoKHQuZ2FtbWFGYWN0b3IpfXJldHVybiBpLnB1c2goZS5jdXN0b21Qcm9ncmFtQ2FjaGVLZXkpLGkuam9pbigpfSxnZXRVbmlmb3JtczpmdW5jdGlvbih0KXtjb25zdCBlPXBbdC50eXBlXTtsZXQgaTtpZihlKXtjb25zdCB0PVlzW2VdO2k9THMuY2xvbmUodC51bmlmb3Jtcyl9ZWxzZSBpPXQudW5pZm9ybXM7cmV0dXJuIGl9LGFjcXVpcmVQcm9ncmFtOmZ1bmN0aW9uKGUsaSl7bGV0IG47Zm9yKGxldCB0PTAsZT1vLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPW9bdF07aWYoZS5jYWNoZUtleT09PWkpe249ZSwrK24udXNlZFRpbWVzO2JyZWFrfX1yZXR1cm4gdm9pZCAwPT09biYmKG49bmV3IEVhKHQsaSxlLHIpLG8ucHVzaChuKSksbn0scmVsZWFzZVByb2dyYW06ZnVuY3Rpb24odCl7aWYoMD09LS10LnVzZWRUaW1lcyl7Y29uc3QgZT1vLmluZGV4T2YodCk7b1tlXT1vW28ubGVuZ3RoLTFdLG8ucG9wKCksdC5kZXN0cm95KCl9fSxwcm9ncmFtczpvfX1mdW5jdGlvbiBBYSgpe2xldCB0PW5ldyBXZWFrTWFwO3JldHVybntnZXQ6ZnVuY3Rpb24oZSl7bGV0IGk9dC5nZXQoZSk7cmV0dXJuIHZvaWQgMD09PWkmJihpPXt9LHQuc2V0KGUsaSkpLGl9LHJlbW92ZTpmdW5jdGlvbihlKXt0LmRlbGV0ZShlKX0sdXBkYXRlOmZ1bmN0aW9uKGUsaSxuKXt0LmdldChlKVtpXT1ufSxkaXNwb3NlOmZ1bmN0aW9uKCl7dD1uZXcgV2Vha01hcH19fWZ1bmN0aW9uIFBhKHQsZSl7cmV0dXJuIHQuZ3JvdXBPcmRlciE9PWUuZ3JvdXBPcmRlcj90Lmdyb3VwT3JkZXItZS5ncm91cE9yZGVyOnQucmVuZGVyT3JkZXIhPT1lLnJlbmRlck9yZGVyP3QucmVuZGVyT3JkZXItZS5yZW5kZXJPcmRlcjp0LnByb2dyYW0hPT1lLnByb2dyYW0/dC5wcm9ncmFtLmlkLWUucHJvZ3JhbS5pZDp0Lm1hdGVyaWFsLmlkIT09ZS5tYXRlcmlhbC5pZD90Lm1hdGVyaWFsLmlkLWUubWF0ZXJpYWwuaWQ6dC56IT09ZS56P3Quei1lLno6dC5pZC1lLmlkfWZ1bmN0aW9uIFJhKHQsZSl7cmV0dXJuIHQuZ3JvdXBPcmRlciE9PWUuZ3JvdXBPcmRlcj90Lmdyb3VwT3JkZXItZS5ncm91cE9yZGVyOnQucmVuZGVyT3JkZXIhPT1lLnJlbmRlck9yZGVyP3QucmVuZGVyT3JkZXItZS5yZW5kZXJPcmRlcjp0LnohPT1lLno/ZS56LXQuejp0LmlkLWUuaWR9ZnVuY3Rpb24gTGEodCl7Y29uc3QgZT1bXTtsZXQgaT0wO2NvbnN0IG49W10scj1bXSxzPXtpZDotMX07ZnVuY3Rpb24gbyhuLHIsbyxhLGMsaCl7bGV0IGw9ZVtpXTtjb25zdCB1PXQuZ2V0KG8pO3JldHVybiB2b2lkIDA9PT1sPyhsPXtpZDpuLmlkLG9iamVjdDpuLGdlb21ldHJ5OnIsbWF0ZXJpYWw6byxwcm9ncmFtOnUucHJvZ3JhbXx8cyxncm91cE9yZGVyOmEscmVuZGVyT3JkZXI6bi5yZW5kZXJPcmRlcix6OmMsZ3JvdXA6aH0sZVtpXT1sKToobC5pZD1uLmlkLGwub2JqZWN0PW4sbC5nZW9tZXRyeT1yLGwubWF0ZXJpYWw9byxsLnByb2dyYW09dS5wcm9ncmFtfHxzLGwuZ3JvdXBPcmRlcj1hLGwucmVuZGVyT3JkZXI9bi5yZW5kZXJPcmRlcixsLno9YyxsLmdyb3VwPWgpLGkrKyxsfXJldHVybntvcGFxdWU6bix0cmFuc3BhcmVudDpyLGluaXQ6ZnVuY3Rpb24oKXtpPTAsbi5sZW5ndGg9MCxyLmxlbmd0aD0wfSxwdXNoOmZ1bmN0aW9uKHQsZSxpLHMsYSxjKXtjb25zdCBoPW8odCxlLGkscyxhLGMpOyghMD09PWkudHJhbnNwYXJlbnQ/cjpuKS5wdXNoKGgpfSx1bnNoaWZ0OmZ1bmN0aW9uKHQsZSxpLHMsYSxjKXtjb25zdCBoPW8odCxlLGkscyxhLGMpOyghMD09PWkudHJhbnNwYXJlbnQ/cjpuKS51bnNoaWZ0KGgpfSxmaW5pc2g6ZnVuY3Rpb24oKXtmb3IobGV0IHQ9aSxuPWUubGVuZ3RoO3Q8bjt0Kyspe2NvbnN0IGk9ZVt0XTtpZihudWxsPT09aS5pZClicmVhaztpLmlkPW51bGwsaS5vYmplY3Q9bnVsbCxpLmdlb21ldHJ5PW51bGwsaS5tYXRlcmlhbD1udWxsLGkucHJvZ3JhbT1udWxsLGkuZ3JvdXA9bnVsbH19LHNvcnQ6ZnVuY3Rpb24odCxlKXtuLmxlbmd0aD4xJiZuLnNvcnQodHx8UGEpLHIubGVuZ3RoPjEmJnIuc29ydChlfHxSYSl9fX1mdW5jdGlvbiBPYSh0KXtsZXQgZT1uZXcgV2Vha01hcDtyZXR1cm57Z2V0OmZ1bmN0aW9uKGksbil7Y29uc3Qgcj1lLmdldChpKTtsZXQgcztyZXR1cm4gdm9pZCAwPT09cj8ocz1uZXcgTGEodCksZS5zZXQoaSxuZXcgV2Vha01hcCksZS5nZXQoaSkuc2V0KG4scykpOihzPXIuZ2V0KG4pLHZvaWQgMD09PXMmJihzPW5ldyBMYSh0KSxyLnNldChuLHMpKSksc30sZGlzcG9zZTpmdW5jdGlvbigpe2U9bmV3IFdlYWtNYXB9fX1mdW5jdGlvbiBOYSgpe2NvbnN0IHQ9e307cmV0dXJue2dldDpmdW5jdGlvbihlKXtpZih2b2lkIDAhPT10W2UuaWRdKXJldHVybiB0W2UuaWRdO2xldCBpO3N3aXRjaChlLnR5cGUpe2Nhc2VcIkRpcmVjdGlvbmFsTGlnaHRcIjppPXtkaXJlY3Rpb246bmV3IGZuLGNvbG9yOm5ldyBEcn07YnJlYWs7Y2FzZVwiU3BvdExpZ2h0XCI6aT17cG9zaXRpb246bmV3IGZuLGRpcmVjdGlvbjpuZXcgZm4sY29sb3I6bmV3IERyLGRpc3RhbmNlOjAsY29uZUNvczowLHBlbnVtYnJhQ29zOjAsZGVjYXk6MH07YnJlYWs7Y2FzZVwiUG9pbnRMaWdodFwiOmk9e3Bvc2l0aW9uOm5ldyBmbixjb2xvcjpuZXcgRHIsZGlzdGFuY2U6MCxkZWNheTowfTticmVhaztjYXNlXCJIZW1pc3BoZXJlTGlnaHRcIjppPXtkaXJlY3Rpb246bmV3IGZuLHNreUNvbG9yOm5ldyBEcixncm91bmRDb2xvcjpuZXcgRHJ9O2JyZWFrO2Nhc2VcIlJlY3RBcmVhTGlnaHRcIjppPXtjb2xvcjpuZXcgRHIscG9zaXRpb246bmV3IGZuLGhhbGZXaWR0aDpuZXcgZm4saGFsZkhlaWdodDpuZXcgZm59fXJldHVybiB0W2UuaWRdPWksaX19fWxldCBEYT0wO2Z1bmN0aW9uICRhKHQsZSl7cmV0dXJuKGUuY2FzdFNoYWRvdz8xOjApLSh0LmNhc3RTaGFkb3c/MTowKX1mdW5jdGlvbiBrYSh0LGUpe2NvbnN0IGk9bmV3IE5hLG49ZnVuY3Rpb24oKXtjb25zdCB0PXt9O3JldHVybntnZXQ6ZnVuY3Rpb24oZSl7aWYodm9pZCAwIT09dFtlLmlkXSlyZXR1cm4gdFtlLmlkXTtsZXQgaTtzd2l0Y2goZS50eXBlKXtjYXNlXCJEaXJlY3Rpb25hbExpZ2h0XCI6Y2FzZVwiU3BvdExpZ2h0XCI6aT17c2hhZG93QmlhczowLHNoYWRvd05vcm1hbEJpYXM6MCxzaGFkb3dSYWRpdXM6MSxzaGFkb3dNYXBTaXplOm5ldyBybn07YnJlYWs7Y2FzZVwiUG9pbnRMaWdodFwiOmk9e3NoYWRvd0JpYXM6MCxzaGFkb3dOb3JtYWxCaWFzOjAsc2hhZG93UmFkaXVzOjEsc2hhZG93TWFwU2l6ZTpuZXcgcm4sc2hhZG93Q2FtZXJhTmVhcjoxLHNoYWRvd0NhbWVyYUZhcjoxZTN9fXJldHVybiB0W2UuaWRdPWksaX19fSgpLHI9e3ZlcnNpb246MCxoYXNoOntkaXJlY3Rpb25hbExlbmd0aDotMSxwb2ludExlbmd0aDotMSxzcG90TGVuZ3RoOi0xLHJlY3RBcmVhTGVuZ3RoOi0xLGhlbWlMZW5ndGg6LTEsbnVtRGlyZWN0aW9uYWxTaGFkb3dzOi0xLG51bVBvaW50U2hhZG93czotMSxudW1TcG90U2hhZG93czotMX0sYW1iaWVudDpbMCwwLDBdLHByb2JlOltdLGRpcmVjdGlvbmFsOltdLGRpcmVjdGlvbmFsU2hhZG93OltdLGRpcmVjdGlvbmFsU2hhZG93TWFwOltdLGRpcmVjdGlvbmFsU2hhZG93TWF0cml4OltdLHNwb3Q6W10sc3BvdFNoYWRvdzpbXSxzcG90U2hhZG93TWFwOltdLHNwb3RTaGFkb3dNYXRyaXg6W10scmVjdEFyZWE6W10scmVjdEFyZWFMVEMxOm51bGwscmVjdEFyZWFMVEMyOm51bGwscG9pbnQ6W10scG9pbnRTaGFkb3c6W10scG9pbnRTaGFkb3dNYXA6W10scG9pbnRTaGFkb3dNYXRyaXg6W10saGVtaTpbXX07Zm9yKGxldCB0PTA7dDw5O3QrKylyLnByb2JlLnB1c2gobmV3IGZuKTtjb25zdCBzPW5ldyBmbixvPW5ldyBIbixhPW5ldyBIbjtyZXR1cm57c2V0dXA6ZnVuY3Rpb24ocyl7bGV0IG89MCxhPTAsYz0wO2ZvcihsZXQgdD0wO3Q8OTt0Kyspci5wcm9iZVt0XS5zZXQoMCwwLDApO2xldCBoPTAsbD0wLHU9MCxkPTAscD0wLGY9MCxtPTAsZz0wO3Muc29ydCgkYSk7Zm9yKGxldCB0PTAsZT1zLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPXNbdF0sXz1lLmNvbG9yLHY9ZS5pbnRlbnNpdHkseT1lLmRpc3RhbmNlLGI9ZS5zaGFkb3cmJmUuc2hhZG93Lm1hcD9lLnNoYWRvdy5tYXAudGV4dHVyZTpudWxsO2lmKGUuaXNBbWJpZW50TGlnaHQpbys9Xy5yKnYsYSs9Xy5nKnYsYys9Xy5iKnY7ZWxzZSBpZihlLmlzTGlnaHRQcm9iZSlmb3IobGV0IHQ9MDt0PDk7dCsrKXIucHJvYmVbdF0uYWRkU2NhbGVkVmVjdG9yKGUuc2guY29lZmZpY2llbnRzW3RdLHYpO2Vsc2UgaWYoZS5pc0RpcmVjdGlvbmFsTGlnaHQpe2NvbnN0IHQ9aS5nZXQoZSk7aWYodC5jb2xvci5jb3B5KGUuY29sb3IpLm11bHRpcGx5U2NhbGFyKGUuaW50ZW5zaXR5KSxlLmNhc3RTaGFkb3cpe2NvbnN0IHQ9ZS5zaGFkb3csaT1uLmdldChlKTtpLnNoYWRvd0JpYXM9dC5iaWFzLGkuc2hhZG93Tm9ybWFsQmlhcz10Lm5vcm1hbEJpYXMsaS5zaGFkb3dSYWRpdXM9dC5yYWRpdXMsaS5zaGFkb3dNYXBTaXplPXQubWFwU2l6ZSxyLmRpcmVjdGlvbmFsU2hhZG93W2hdPWksci5kaXJlY3Rpb25hbFNoYWRvd01hcFtoXT1iLHIuZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXhbaF09ZS5zaGFkb3cubWF0cml4LGYrK31yLmRpcmVjdGlvbmFsW2hdPXQsaCsrfWVsc2UgaWYoZS5pc1Nwb3RMaWdodCl7Y29uc3QgdD1pLmdldChlKTtpZih0LnBvc2l0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihlLm1hdHJpeFdvcmxkKSx0LmNvbG9yLmNvcHkoXykubXVsdGlwbHlTY2FsYXIodiksdC5kaXN0YW5jZT15LHQuY29uZUNvcz1NYXRoLmNvcyhlLmFuZ2xlKSx0LnBlbnVtYnJhQ29zPU1hdGguY29zKGUuYW5nbGUqKDEtZS5wZW51bWJyYSkpLHQuZGVjYXk9ZS5kZWNheSxlLmNhc3RTaGFkb3cpe2NvbnN0IHQ9ZS5zaGFkb3csaT1uLmdldChlKTtpLnNoYWRvd0JpYXM9dC5iaWFzLGkuc2hhZG93Tm9ybWFsQmlhcz10Lm5vcm1hbEJpYXMsaS5zaGFkb3dSYWRpdXM9dC5yYWRpdXMsaS5zaGFkb3dNYXBTaXplPXQubWFwU2l6ZSxyLnNwb3RTaGFkb3dbdV09aSxyLnNwb3RTaGFkb3dNYXBbdV09YixyLnNwb3RTaGFkb3dNYXRyaXhbdV09ZS5zaGFkb3cubWF0cml4LGcrK31yLnNwb3RbdV09dCx1Kyt9ZWxzZSBpZihlLmlzUmVjdEFyZWFMaWdodCl7Y29uc3QgdD1pLmdldChlKTt0LmNvbG9yLmNvcHkoXykubXVsdGlwbHlTY2FsYXIodiksdC5oYWxmV2lkdGguc2V0KC41KmUud2lkdGgsMCwwKSx0LmhhbGZIZWlnaHQuc2V0KDAsLjUqZS5oZWlnaHQsMCksci5yZWN0QXJlYVtkXT10LGQrK31lbHNlIGlmKGUuaXNQb2ludExpZ2h0KXtjb25zdCB0PWkuZ2V0KGUpO2lmKHQuY29sb3IuY29weShlLmNvbG9yKS5tdWx0aXBseVNjYWxhcihlLmludGVuc2l0eSksdC5kaXN0YW5jZT1lLmRpc3RhbmNlLHQuZGVjYXk9ZS5kZWNheSxlLmNhc3RTaGFkb3cpe2NvbnN0IHQ9ZS5zaGFkb3csaT1uLmdldChlKTtpLnNoYWRvd0JpYXM9dC5iaWFzLGkuc2hhZG93Tm9ybWFsQmlhcz10Lm5vcm1hbEJpYXMsaS5zaGFkb3dSYWRpdXM9dC5yYWRpdXMsaS5zaGFkb3dNYXBTaXplPXQubWFwU2l6ZSxpLnNoYWRvd0NhbWVyYU5lYXI9dC5jYW1lcmEubmVhcixpLnNoYWRvd0NhbWVyYUZhcj10LmNhbWVyYS5mYXIsci5wb2ludFNoYWRvd1tsXT1pLHIucG9pbnRTaGFkb3dNYXBbbF09YixyLnBvaW50U2hhZG93TWF0cml4W2xdPWUuc2hhZG93Lm1hdHJpeCxtKyt9ci5wb2ludFtsXT10LGwrK31lbHNlIGlmKGUuaXNIZW1pc3BoZXJlTGlnaHQpe2NvbnN0IHQ9aS5nZXQoZSk7dC5za3lDb2xvci5jb3B5KGUuY29sb3IpLm11bHRpcGx5U2NhbGFyKHYpLHQuZ3JvdW5kQ29sb3IuY29weShlLmdyb3VuZENvbG9yKS5tdWx0aXBseVNjYWxhcih2KSxyLmhlbWlbcF09dCxwKyt9fWQ+MCYmKGUuaXNXZWJHTDJ8fCEwPT09dC5oYXMoXCJPRVNfdGV4dHVyZV9mbG9hdF9saW5lYXJcIik/KHIucmVjdEFyZWFMVEMxPVhzLkxUQ19GTE9BVF8xLHIucmVjdEFyZWFMVEMyPVhzLkxUQ19GTE9BVF8yKTohMD09PXQuaGFzKFwiT0VTX3RleHR1cmVfaGFsZl9mbG9hdF9saW5lYXJcIik/KHIucmVjdEFyZWFMVEMxPVhzLkxUQ19IQUxGXzEsci5yZWN0QXJlYUxUQzI9WHMuTFRDX0hBTEZfMik6Y29uc29sZS5lcnJvcihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IFVuYWJsZSB0byB1c2UgUmVjdEFyZWFMaWdodC4gTWlzc2luZyBXZWJHTCBleHRlbnNpb25zLlwiKSksci5hbWJpZW50WzBdPW8sci5hbWJpZW50WzFdPWEsci5hbWJpZW50WzJdPWM7Y29uc3QgXz1yLmhhc2g7Xy5kaXJlY3Rpb25hbExlbmd0aD09PWgmJl8ucG9pbnRMZW5ndGg9PT1sJiZfLnNwb3RMZW5ndGg9PT11JiZfLnJlY3RBcmVhTGVuZ3RoPT09ZCYmXy5oZW1pTGVuZ3RoPT09cCYmXy5udW1EaXJlY3Rpb25hbFNoYWRvd3M9PT1mJiZfLm51bVBvaW50U2hhZG93cz09PW0mJl8ubnVtU3BvdFNoYWRvd3M9PT1nfHwoci5kaXJlY3Rpb25hbC5sZW5ndGg9aCxyLnNwb3QubGVuZ3RoPXUsci5yZWN0QXJlYS5sZW5ndGg9ZCxyLnBvaW50Lmxlbmd0aD1sLHIuaGVtaS5sZW5ndGg9cCxyLmRpcmVjdGlvbmFsU2hhZG93Lmxlbmd0aD1mLHIuZGlyZWN0aW9uYWxTaGFkb3dNYXAubGVuZ3RoPWYsci5wb2ludFNoYWRvdy5sZW5ndGg9bSxyLnBvaW50U2hhZG93TWFwLmxlbmd0aD1tLHIuc3BvdFNoYWRvdy5sZW5ndGg9ZyxyLnNwb3RTaGFkb3dNYXAubGVuZ3RoPWcsci5kaXJlY3Rpb25hbFNoYWRvd01hdHJpeC5sZW5ndGg9ZixyLnBvaW50U2hhZG93TWF0cml4Lmxlbmd0aD1tLHIuc3BvdFNoYWRvd01hdHJpeC5sZW5ndGg9ZyxfLmRpcmVjdGlvbmFsTGVuZ3RoPWgsXy5wb2ludExlbmd0aD1sLF8uc3BvdExlbmd0aD11LF8ucmVjdEFyZWFMZW5ndGg9ZCxfLmhlbWlMZW5ndGg9cCxfLm51bURpcmVjdGlvbmFsU2hhZG93cz1mLF8ubnVtUG9pbnRTaGFkb3dzPW0sXy5udW1TcG90U2hhZG93cz1nLHIudmVyc2lvbj1EYSsrKX0sc2V0dXBWaWV3OmZ1bmN0aW9uKHQsZSl7bGV0IGk9MCxuPTAsYz0wLGg9MCxsPTA7Y29uc3QgdT1lLm1hdHJpeFdvcmxkSW52ZXJzZTtmb3IobGV0IGU9MCxkPXQubGVuZ3RoO2U8ZDtlKyspe2NvbnN0IGQ9dFtlXTtpZihkLmlzRGlyZWN0aW9uYWxMaWdodCl7Y29uc3QgdD1yLmRpcmVjdGlvbmFsW2ldO3QuZGlyZWN0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihkLm1hdHJpeFdvcmxkKSxzLnNldEZyb21NYXRyaXhQb3NpdGlvbihkLnRhcmdldC5tYXRyaXhXb3JsZCksdC5kaXJlY3Rpb24uc3ViKHMpLHQuZGlyZWN0aW9uLnRyYW5zZm9ybURpcmVjdGlvbih1KSxpKyt9ZWxzZSBpZihkLmlzU3BvdExpZ2h0KXtjb25zdCB0PXIuc3BvdFtjXTt0LnBvc2l0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihkLm1hdHJpeFdvcmxkKSx0LnBvc2l0aW9uLmFwcGx5TWF0cml4NCh1KSx0LmRpcmVjdGlvbi5zZXRGcm9tTWF0cml4UG9zaXRpb24oZC5tYXRyaXhXb3JsZCkscy5zZXRGcm9tTWF0cml4UG9zaXRpb24oZC50YXJnZXQubWF0cml4V29ybGQpLHQuZGlyZWN0aW9uLnN1YihzKSx0LmRpcmVjdGlvbi50cmFuc2Zvcm1EaXJlY3Rpb24odSksYysrfWVsc2UgaWYoZC5pc1JlY3RBcmVhTGlnaHQpe2NvbnN0IHQ9ci5yZWN0QXJlYVtoXTt0LnBvc2l0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihkLm1hdHJpeFdvcmxkKSx0LnBvc2l0aW9uLmFwcGx5TWF0cml4NCh1KSxhLmlkZW50aXR5KCksby5jb3B5KGQubWF0cml4V29ybGQpLG8ucHJlbXVsdGlwbHkodSksYS5leHRyYWN0Um90YXRpb24obyksdC5oYWxmV2lkdGguc2V0KC41KmQud2lkdGgsMCwwKSx0LmhhbGZIZWlnaHQuc2V0KDAsLjUqZC5oZWlnaHQsMCksdC5oYWxmV2lkdGguYXBwbHlNYXRyaXg0KGEpLHQuaGFsZkhlaWdodC5hcHBseU1hdHJpeDQoYSksaCsrfWVsc2UgaWYoZC5pc1BvaW50TGlnaHQpe2NvbnN0IHQ9ci5wb2ludFtuXTt0LnBvc2l0aW9uLnNldEZyb21NYXRyaXhQb3NpdGlvbihkLm1hdHJpeFdvcmxkKSx0LnBvc2l0aW9uLmFwcGx5TWF0cml4NCh1KSxuKyt9ZWxzZSBpZihkLmlzSGVtaXNwaGVyZUxpZ2h0KXtjb25zdCB0PXIuaGVtaVtsXTt0LmRpcmVjdGlvbi5zZXRGcm9tTWF0cml4UG9zaXRpb24oZC5tYXRyaXhXb3JsZCksdC5kaXJlY3Rpb24udHJhbnNmb3JtRGlyZWN0aW9uKHUpLHQuZGlyZWN0aW9uLm5vcm1hbGl6ZSgpLGwrK319fSxzdGF0ZTpyfX1mdW5jdGlvbiB6YSh0LGUpe2NvbnN0IGk9bmV3IGthKHQsZSksbj1bXSxyPVtdO3JldHVybntpbml0OmZ1bmN0aW9uKCl7bi5sZW5ndGg9MCxyLmxlbmd0aD0wfSxzdGF0ZTp7bGlnaHRzQXJyYXk6bixzaGFkb3dzQXJyYXk6cixsaWdodHM6aX0sc2V0dXBMaWdodHM6ZnVuY3Rpb24oKXtpLnNldHVwKG4pfSxzZXR1cExpZ2h0c1ZpZXc6ZnVuY3Rpb24odCl7aS5zZXR1cFZpZXcobix0KX0scHVzaExpZ2h0OmZ1bmN0aW9uKHQpe24ucHVzaCh0KX0scHVzaFNoYWRvdzpmdW5jdGlvbih0KXtyLnB1c2godCl9fX1mdW5jdGlvbiBGYSh0LGUpe2xldCBpPW5ldyBXZWFrTWFwO3JldHVybntnZXQ6ZnVuY3Rpb24obixyPTApe2xldCBzO3JldHVybiExPT09aS5oYXMobik/KHM9bmV3IHphKHQsZSksaS5zZXQobixbXSksaS5nZXQobikucHVzaChzKSk6cj49aS5nZXQobikubGVuZ3RoPyhzPW5ldyB6YSh0LGUpLGkuZ2V0KG4pLnB1c2gocykpOnM9aS5nZXQobilbcl0sc30sZGlzcG9zZTpmdW5jdGlvbigpe2k9bmV3IFdlYWtNYXB9fX1mdW5jdGlvbiBCYSh0KXt6ci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIk1lc2hEZXB0aE1hdGVyaWFsXCIsdGhpcy5kZXB0aFBhY2tpbmc9MzIwMCx0aGlzLnNraW5uaW5nPSExLHRoaXMubW9ycGhUYXJnZXRzPSExLHRoaXMubWFwPW51bGwsdGhpcy5hbHBoYU1hcD1udWxsLHRoaXMuZGlzcGxhY2VtZW50TWFwPW51bGwsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT0xLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz0wLHRoaXMud2lyZWZyYW1lPSExLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPTEsdGhpcy5mb2c9ITEsdGhpcy5zZXRWYWx1ZXModCl9ZnVuY3Rpb24gamEodCl7enIuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJNZXNoRGlzdGFuY2VNYXRlcmlhbFwiLHRoaXMucmVmZXJlbmNlUG9zaXRpb249bmV3IGZuLHRoaXMubmVhckRpc3RhbmNlPTEsdGhpcy5mYXJEaXN0YW5jZT0xZTMsdGhpcy5za2lubmluZz0hMSx0aGlzLm1vcnBoVGFyZ2V0cz0hMSx0aGlzLm1hcD1udWxsLHRoaXMuYWxwaGFNYXA9bnVsbCx0aGlzLmRpc3BsYWNlbWVudE1hcD1udWxsLHRoaXMuZGlzcGxhY2VtZW50U2NhbGU9MSx0aGlzLmRpc3BsYWNlbWVudEJpYXM9MCx0aGlzLmZvZz0hMSx0aGlzLnNldFZhbHVlcyh0KX1CYS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh6ci5wcm90b3R5cGUpLEJhLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1CYSxCYS5wcm90b3R5cGUuaXNNZXNoRGVwdGhNYXRlcmlhbD0hMCxCYS5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4genIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuZGVwdGhQYWNraW5nPXQuZGVwdGhQYWNraW5nLHRoaXMuc2tpbm5pbmc9dC5za2lubmluZyx0aGlzLm1vcnBoVGFyZ2V0cz10Lm1vcnBoVGFyZ2V0cyx0aGlzLm1hcD10Lm1hcCx0aGlzLmFscGhhTWFwPXQuYWxwaGFNYXAsdGhpcy5kaXNwbGFjZW1lbnRNYXA9dC5kaXNwbGFjZW1lbnRNYXAsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT10LmRpc3BsYWNlbWVudFNjYWxlLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz10LmRpc3BsYWNlbWVudEJpYXMsdGhpcy53aXJlZnJhbWU9dC53aXJlZnJhbWUsdGhpcy53aXJlZnJhbWVMaW5ld2lkdGg9dC53aXJlZnJhbWVMaW5ld2lkdGgsdGhpc30samEucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoenIucHJvdG90eXBlKSxqYS5wcm90b3R5cGUuY29uc3RydWN0b3I9amEsamEucHJvdG90eXBlLmlzTWVzaERpc3RhbmNlTWF0ZXJpYWw9ITAsamEucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHpyLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLnJlZmVyZW5jZVBvc2l0aW9uLmNvcHkodC5yZWZlcmVuY2VQb3NpdGlvbiksdGhpcy5uZWFyRGlzdGFuY2U9dC5uZWFyRGlzdGFuY2UsdGhpcy5mYXJEaXN0YW5jZT10LmZhckRpc3RhbmNlLHRoaXMuc2tpbm5pbmc9dC5za2lubmluZyx0aGlzLm1vcnBoVGFyZ2V0cz10Lm1vcnBoVGFyZ2V0cyx0aGlzLm1hcD10Lm1hcCx0aGlzLmFscGhhTWFwPXQuYWxwaGFNYXAsdGhpcy5kaXNwbGFjZW1lbnRNYXA9dC5kaXNwbGFjZW1lbnRNYXAsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT10LmRpc3BsYWNlbWVudFNjYWxlLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz10LmRpc3BsYWNlbWVudEJpYXMsdGhpc307ZnVuY3Rpb24gSGEodCxlLGkpe2xldCBuPW5ldyBVcztjb25zdCByPW5ldyBybixzPW5ldyBybixvPW5ldyB1bixhPVtdLGM9W10saD17fSxsPXswOjEsMTowLDI6Mn0sdT1uZXcgT3Moe2RlZmluZXM6e1NBTVBMRV9SQVRFOjIvOCxIQUxGX1NBTVBMRV9SQVRFOjEvOH0sdW5pZm9ybXM6e3NoYWRvd19wYXNzOnt2YWx1ZTpudWxsfSxyZXNvbHV0aW9uOnt2YWx1ZTpuZXcgcm59LHJhZGl1czp7dmFsdWU6NH19LHZlcnRleFNoYWRlcjpcInZvaWQgbWFpbigpIHtcXG5cXHRnbF9Qb3NpdGlvbiA9IHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcXG59XCIsZnJhZ21lbnRTaGFkZXI6XCJ1bmlmb3JtIHNhbXBsZXIyRCBzaGFkb3dfcGFzcztcXG51bmlmb3JtIHZlYzIgcmVzb2x1dGlvbjtcXG51bmlmb3JtIGZsb2F0IHJhZGl1cztcXG4jaW5jbHVkZSA8cGFja2luZz5cXG52b2lkIG1haW4oKSB7XFxuXFx0ZmxvYXQgbWVhbiA9IDAuMDtcXG5cXHRmbG9hdCBzcXVhcmVkX21lYW4gPSAwLjA7XFxuXFx0ZmxvYXQgZGVwdGggPSB1bnBhY2tSR0JBVG9EZXB0aCggdGV4dHVyZTJEKCBzaGFkb3dfcGFzcywgKCBnbF9GcmFnQ29vcmQueHkgKSAvIHJlc29sdXRpb24gKSApO1xcblxcdGZvciAoIGZsb2F0IGkgPSAtMS4wOyBpIDwgMS4wIDsgaSArPSBTQU1QTEVfUkFURSkge1xcblxcdFxcdCNpZmRlZiBIT1JJWk9OVEFMX1BBU1NcXG5cXHRcXHRcXHR2ZWMyIGRpc3RyaWJ1dGlvbiA9IHVucGFja1JHQkFUbzJIYWxmKCB0ZXh0dXJlMkQoIHNoYWRvd19wYXNzLCAoIGdsX0ZyYWdDb29yZC54eSArIHZlYzIoIGksIDAuMCApICogcmFkaXVzICkgLyByZXNvbHV0aW9uICkgKTtcXG5cXHRcXHRcXHRtZWFuICs9IGRpc3RyaWJ1dGlvbi54O1xcblxcdFxcdFxcdHNxdWFyZWRfbWVhbiArPSBkaXN0cmlidXRpb24ueSAqIGRpc3RyaWJ1dGlvbi55ICsgZGlzdHJpYnV0aW9uLnggKiBkaXN0cmlidXRpb24ueDtcXG5cXHRcXHQjZWxzZVxcblxcdFxcdFxcdGZsb2F0IGRlcHRoID0gdW5wYWNrUkdCQVRvRGVwdGgoIHRleHR1cmUyRCggc2hhZG93X3Bhc3MsICggZ2xfRnJhZ0Nvb3JkLnh5ICsgdmVjMiggMC4wLCBpICkgKiByYWRpdXMgKSAvIHJlc29sdXRpb24gKSApO1xcblxcdFxcdFxcdG1lYW4gKz0gZGVwdGg7XFxuXFx0XFx0XFx0c3F1YXJlZF9tZWFuICs9IGRlcHRoICogZGVwdGg7XFxuXFx0XFx0I2VuZGlmXFxuXFx0fVxcblxcdG1lYW4gPSBtZWFuICogSEFMRl9TQU1QTEVfUkFURTtcXG5cXHRzcXVhcmVkX21lYW4gPSBzcXVhcmVkX21lYW4gKiBIQUxGX1NBTVBMRV9SQVRFO1xcblxcdGZsb2F0IHN0ZF9kZXYgPSBzcXJ0KCBzcXVhcmVkX21lYW4gLSBtZWFuICogbWVhbiApO1xcblxcdGdsX0ZyYWdDb2xvciA9IHBhY2sySGFsZlRvUkdCQSggdmVjMiggbWVhbiwgc3RkX2RldiApICk7XFxufVwifSksZD11LmNsb25lKCk7ZC5kZWZpbmVzLkhPUklaT05UQUxfUEFTUz0xO2NvbnN0IHA9bmV3IGhzO3Auc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSHIobmV3IEZsb2F0MzJBcnJheShbLTEsLTEsLjUsMywtMSwuNSwtMSwzLC41XSksMykpO2NvbnN0IGY9bmV3IEVzKHAsdSksbT10aGlzO2Z1bmN0aW9uIGcoaSxuKXtjb25zdCByPWUudXBkYXRlKGYpO3UudW5pZm9ybXMuc2hhZG93X3Bhc3MudmFsdWU9aS5tYXAudGV4dHVyZSx1LnVuaWZvcm1zLnJlc29sdXRpb24udmFsdWU9aS5tYXBTaXplLHUudW5pZm9ybXMucmFkaXVzLnZhbHVlPWkucmFkaXVzLHQuc2V0UmVuZGVyVGFyZ2V0KGkubWFwUGFzcyksdC5jbGVhcigpLHQucmVuZGVyQnVmZmVyRGlyZWN0KG4sbnVsbCxyLHUsZixudWxsKSxkLnVuaWZvcm1zLnNoYWRvd19wYXNzLnZhbHVlPWkubWFwUGFzcy50ZXh0dXJlLGQudW5pZm9ybXMucmVzb2x1dGlvbi52YWx1ZT1pLm1hcFNpemUsZC51bmlmb3Jtcy5yYWRpdXMudmFsdWU9aS5yYWRpdXMsdC5zZXRSZW5kZXJUYXJnZXQoaS5tYXApLHQuY2xlYXIoKSx0LnJlbmRlckJ1ZmZlckRpcmVjdChuLG51bGwscixkLGYsbnVsbCl9ZnVuY3Rpb24gXyh0LGUsaSl7Y29uc3Qgbj10PDwwfGU8PDF8aTw8MjtsZXQgcj1hW25dO3JldHVybiB2b2lkIDA9PT1yJiYocj1uZXcgQmEoe2RlcHRoUGFja2luZzozMjAxLG1vcnBoVGFyZ2V0czp0LHNraW5uaW5nOmV9KSxhW25dPXIpLHJ9ZnVuY3Rpb24gdih0LGUsaSl7Y29uc3Qgbj10PDwwfGU8PDF8aTw8MjtsZXQgcj1jW25dO3JldHVybiB2b2lkIDA9PT1yJiYocj1uZXcgamEoe21vcnBoVGFyZ2V0czp0LHNraW5uaW5nOmV9KSxjW25dPXIpLHJ9ZnVuY3Rpb24geShlLGksbixyLHMsbyxhKXtsZXQgYz1udWxsLHU9XyxkPWUuY3VzdG9tRGVwdGhNYXRlcmlhbDtpZighMD09PXIuaXNQb2ludExpZ2h0JiYodT12LGQ9ZS5jdXN0b21EaXN0YW5jZU1hdGVyaWFsKSx2b2lkIDA9PT1kKXtsZXQgdD0hMTshMD09PW4ubW9ycGhUYXJnZXRzJiYodD1pLm1vcnBoQXR0cmlidXRlcyYmaS5tb3JwaEF0dHJpYnV0ZXMucG9zaXRpb24mJmkubW9ycGhBdHRyaWJ1dGVzLnBvc2l0aW9uLmxlbmd0aD4wKTtsZXQgcj0hMTshMD09PWUuaXNTa2lubmVkTWVzaCYmKCEwPT09bi5za2lubmluZz9yPSEwOmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMU2hhZG93TWFwOiBUSFJFRS5Ta2lubmVkTWVzaCB3aXRoIG1hdGVyaWFsLnNraW5uaW5nIHNldCB0byBmYWxzZTpcIixlKSk7Yz11KHQsciwhMD09PWUuaXNJbnN0YW5jZWRNZXNoKX1lbHNlIGM9ZDtpZih0LmxvY2FsQ2xpcHBpbmdFbmFibGVkJiYhMD09PW4uY2xpcFNoYWRvd3MmJjAhPT1uLmNsaXBwaW5nUGxhbmVzLmxlbmd0aCl7Y29uc3QgdD1jLnV1aWQsZT1uLnV1aWQ7bGV0IGk9aFt0XTt2b2lkIDA9PT1pJiYoaT17fSxoW3RdPWkpO2xldCByPWlbZV07dm9pZCAwPT09ciYmKHI9Yy5jbG9uZSgpLGlbZV09ciksYz1yfXJldHVybiBjLnZpc2libGU9bi52aXNpYmxlLGMud2lyZWZyYW1lPW4ud2lyZWZyYW1lLGMuc2lkZT0zPT09YT9udWxsIT09bi5zaGFkb3dTaWRlP24uc2hhZG93U2lkZTpuLnNpZGU6bnVsbCE9PW4uc2hhZG93U2lkZT9uLnNoYWRvd1NpZGU6bFtuLnNpZGVdLGMuY2xpcFNoYWRvd3M9bi5jbGlwU2hhZG93cyxjLmNsaXBwaW5nUGxhbmVzPW4uY2xpcHBpbmdQbGFuZXMsYy5jbGlwSW50ZXJzZWN0aW9uPW4uY2xpcEludGVyc2VjdGlvbixjLndpcmVmcmFtZUxpbmV3aWR0aD1uLndpcmVmcmFtZUxpbmV3aWR0aCxjLmxpbmV3aWR0aD1uLmxpbmV3aWR0aCwhMD09PXIuaXNQb2ludExpZ2h0JiYhMD09PWMuaXNNZXNoRGlzdGFuY2VNYXRlcmlhbCYmKGMucmVmZXJlbmNlUG9zaXRpb24uc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHIubWF0cml4V29ybGQpLGMubmVhckRpc3RhbmNlPXMsYy5mYXJEaXN0YW5jZT1vKSxjfWZ1bmN0aW9uIGIoaSxyLHMsbyxhKXtpZighMT09PWkudmlzaWJsZSlyZXR1cm47aWYoaS5sYXllcnMudGVzdChyLmxheWVycykmJihpLmlzTWVzaHx8aS5pc0xpbmV8fGkuaXNQb2ludHMpJiYoaS5jYXN0U2hhZG93fHxpLnJlY2VpdmVTaGFkb3cmJjM9PT1hKSYmKCFpLmZydXN0dW1DdWxsZWR8fG4uaW50ZXJzZWN0c09iamVjdChpKSkpe2kubW9kZWxWaWV3TWF0cml4Lm11bHRpcGx5TWF0cmljZXMocy5tYXRyaXhXb3JsZEludmVyc2UsaS5tYXRyaXhXb3JsZCk7Y29uc3Qgbj1lLnVwZGF0ZShpKSxyPWkubWF0ZXJpYWw7aWYoQXJyYXkuaXNBcnJheShyKSl7Y29uc3QgZT1uLmdyb3Vwcztmb3IobGV0IGM9MCxoPWUubGVuZ3RoO2M8aDtjKyspe2NvbnN0IGg9ZVtjXSxsPXJbaC5tYXRlcmlhbEluZGV4XTtpZihsJiZsLnZpc2libGUpe2NvbnN0IGU9eShpLG4sbCxvLHMubmVhcixzLmZhcixhKTt0LnJlbmRlckJ1ZmZlckRpcmVjdChzLG51bGwsbixlLGksaCl9fX1lbHNlIGlmKHIudmlzaWJsZSl7Y29uc3QgZT15KGksbixyLG8scy5uZWFyLHMuZmFyLGEpO3QucmVuZGVyQnVmZmVyRGlyZWN0KHMsbnVsbCxuLGUsaSxudWxsKX19Y29uc3QgYz1pLmNoaWxkcmVuO2ZvcihsZXQgdD0wLGU9Yy5sZW5ndGg7dDxlO3QrKyliKGNbdF0scixzLG8sYSl9dGhpcy5lbmFibGVkPSExLHRoaXMuYXV0b1VwZGF0ZT0hMCx0aGlzLm5lZWRzVXBkYXRlPSExLHRoaXMudHlwZT0xLHRoaXMucmVuZGVyPWZ1bmN0aW9uKGUsYSxjKXtpZighMT09PW0uZW5hYmxlZClyZXR1cm47aWYoITE9PT1tLmF1dG9VcGRhdGUmJiExPT09bS5uZWVkc1VwZGF0ZSlyZXR1cm47aWYoMD09PWUubGVuZ3RoKXJldHVybjtjb25zdCBoPXQuZ2V0UmVuZGVyVGFyZ2V0KCksbD10LmdldEFjdGl2ZUN1YmVGYWNlKCksdT10LmdldEFjdGl2ZU1pcG1hcExldmVsKCksZD10LnN0YXRlO2Quc2V0QmxlbmRpbmcoMCksZC5idWZmZXJzLmNvbG9yLnNldENsZWFyKDEsMSwxLDEpLGQuYnVmZmVycy5kZXB0aC5zZXRUZXN0KCEwKSxkLnNldFNjaXNzb3JUZXN0KCExKTtmb3IobGV0IGg9MCxsPWUubGVuZ3RoO2g8bDtoKyspe2NvbnN0IGw9ZVtoXSx1PWwuc2hhZG93O2lmKHZvaWQgMD09PXUpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMU2hhZG93TWFwOlwiLGwsXCJoYXMgbm8gc2hhZG93LlwiKTtjb250aW51ZX1pZighMT09PXUuYXV0b1VwZGF0ZSYmITE9PT11Lm5lZWRzVXBkYXRlKWNvbnRpbnVlO3IuY29weSh1Lm1hcFNpemUpO2NvbnN0IHA9dS5nZXRGcmFtZUV4dGVudHMoKTtpZihyLm11bHRpcGx5KHApLHMuY29weSh1Lm1hcFNpemUpLChyLng+aXx8ci55PmkpJiYoci54PmkmJihzLng9TWF0aC5mbG9vcihpL3AueCksci54PXMueCpwLngsdS5tYXBTaXplLng9cy54KSxyLnk+aSYmKHMueT1NYXRoLmZsb29yKGkvcC55KSxyLnk9cy55KnAueSx1Lm1hcFNpemUueT1zLnkpKSxudWxsPT09dS5tYXAmJiF1LmlzUG9pbnRMaWdodFNoYWRvdyYmMz09PXRoaXMudHlwZSl7Y29uc3QgdD17bWluRmlsdGVyOkFpLG1hZ0ZpbHRlcjpBaSxmb3JtYXQ6eml9O3UubWFwPW5ldyBkbihyLngsci55LHQpLHUubWFwLnRleHR1cmUubmFtZT1sLm5hbWUrXCIuc2hhZG93TWFwXCIsdS5tYXBQYXNzPW5ldyBkbihyLngsci55LHQpLHUuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKX1pZihudWxsPT09dS5tYXApe2NvbnN0IHQ9e21pbkZpbHRlcjpJaSxtYWdGaWx0ZXI6SWksZm9ybWF0OnppfTt1Lm1hcD1uZXcgZG4oci54LHIueSx0KSx1Lm1hcC50ZXh0dXJlLm5hbWU9bC5uYW1lK1wiLnNoYWRvd01hcFwiLHUuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKX10LnNldFJlbmRlclRhcmdldCh1Lm1hcCksdC5jbGVhcigpO2NvbnN0IGY9dS5nZXRWaWV3cG9ydENvdW50KCk7Zm9yKGxldCB0PTA7dDxmO3QrKyl7Y29uc3QgZT11LmdldFZpZXdwb3J0KHQpO28uc2V0KHMueCplLngscy55KmUueSxzLngqZS56LHMueSplLncpLGQudmlld3BvcnQobyksdS51cGRhdGVNYXRyaWNlcyhsLHQpLG49dS5nZXRGcnVzdHVtKCksYihhLGMsdS5jYW1lcmEsbCx0aGlzLnR5cGUpfXUuaXNQb2ludExpZ2h0U2hhZG93fHwzIT09dGhpcy50eXBlfHxnKHUsYyksdS5uZWVkc1VwZGF0ZT0hMX1tLm5lZWRzVXBkYXRlPSExLHQuc2V0UmVuZGVyVGFyZ2V0KGgsbCx1KX19ZnVuY3Rpb24gVWEodCxlLGkpe2NvbnN0IG49aS5pc1dlYkdMMjtjb25zdCByPW5ldyBmdW5jdGlvbigpe2xldCBlPSExO2NvbnN0IGk9bmV3IHVuO2xldCBuPW51bGw7Y29uc3Qgcj1uZXcgdW4oMCwwLDAsMCk7cmV0dXJue3NldE1hc2s6ZnVuY3Rpb24oaSl7bj09PWl8fGV8fCh0LmNvbG9yTWFzayhpLGksaSxpKSxuPWkpfSxzZXRMb2NrZWQ6ZnVuY3Rpb24odCl7ZT10fSxzZXRDbGVhcjpmdW5jdGlvbihlLG4scyxvLGEpeyEwPT09YSYmKGUqPW8sbio9byxzKj1vKSxpLnNldChlLG4scyxvKSwhMT09PXIuZXF1YWxzKGkpJiYodC5jbGVhckNvbG9yKGUsbixzLG8pLHIuY29weShpKSl9LHJlc2V0OmZ1bmN0aW9uKCl7ZT0hMSxuPW51bGwsci5zZXQoLTEsMCwwLDApfX19LHM9bmV3IGZ1bmN0aW9uKCl7bGV0IGU9ITEsaT1udWxsLG49bnVsbCxyPW51bGw7cmV0dXJue3NldFRlc3Q6ZnVuY3Rpb24odCl7dD9PKDI5MjkpOk4oMjkyOSl9LHNldE1hc2s6ZnVuY3Rpb24obil7aT09PW58fGV8fCh0LmRlcHRoTWFzayhuKSxpPW4pfSxzZXRGdW5jOmZ1bmN0aW9uKGUpe2lmKG4hPT1lKXtpZihlKXN3aXRjaChlKXtjYXNlIDA6dC5kZXB0aEZ1bmMoNTEyKTticmVhaztjYXNlIDE6dC5kZXB0aEZ1bmMoNTE5KTticmVhaztjYXNlIDI6dC5kZXB0aEZ1bmMoNTEzKTticmVhaztjYXNlIDM6dC5kZXB0aEZ1bmMoNTE1KTticmVhaztjYXNlIDQ6dC5kZXB0aEZ1bmMoNTE0KTticmVhaztjYXNlIDU6dC5kZXB0aEZ1bmMoNTE4KTticmVhaztjYXNlIDY6dC5kZXB0aEZ1bmMoNTE2KTticmVhaztjYXNlIDc6dC5kZXB0aEZ1bmMoNTE3KTticmVhaztkZWZhdWx0OnQuZGVwdGhGdW5jKDUxNSl9ZWxzZSB0LmRlcHRoRnVuYyg1MTUpO249ZX19LHNldExvY2tlZDpmdW5jdGlvbih0KXtlPXR9LHNldENsZWFyOmZ1bmN0aW9uKGUpe3IhPT1lJiYodC5jbGVhckRlcHRoKGUpLHI9ZSl9LHJlc2V0OmZ1bmN0aW9uKCl7ZT0hMSxpPW51bGwsbj1udWxsLHI9bnVsbH19fSxvPW5ldyBmdW5jdGlvbigpe2xldCBlPSExLGk9bnVsbCxuPW51bGwscj1udWxsLHM9bnVsbCxvPW51bGwsYT1udWxsLGM9bnVsbCxoPW51bGw7cmV0dXJue3NldFRlc3Q6ZnVuY3Rpb24odCl7ZXx8KHQ/TygyOTYwKTpOKDI5NjApKX0sc2V0TWFzazpmdW5jdGlvbihuKXtpPT09bnx8ZXx8KHQuc3RlbmNpbE1hc2sobiksaT1uKX0sc2V0RnVuYzpmdW5jdGlvbihlLGksbyl7bj09PWUmJnI9PT1pJiZzPT09b3x8KHQuc3RlbmNpbEZ1bmMoZSxpLG8pLG49ZSxyPWkscz1vKX0sc2V0T3A6ZnVuY3Rpb24oZSxpLG4pe289PT1lJiZhPT09aSYmYz09PW58fCh0LnN0ZW5jaWxPcChlLGksbiksbz1lLGE9aSxjPW4pfSxzZXRMb2NrZWQ6ZnVuY3Rpb24odCl7ZT10fSxzZXRDbGVhcjpmdW5jdGlvbihlKXtoIT09ZSYmKHQuY2xlYXJTdGVuY2lsKGUpLGg9ZSl9LHJlc2V0OmZ1bmN0aW9uKCl7ZT0hMSxpPW51bGwsbj1udWxsLHI9bnVsbCxzPW51bGwsbz1udWxsLGE9bnVsbCxjPW51bGwsaD1udWxsfX19O2xldCBhPXt9LGM9bnVsbCxoPW51bGwsbD1udWxsLHU9bnVsbCxkPW51bGwscD1udWxsLGY9bnVsbCxtPW51bGwsZz1udWxsLF89ITEsdj1udWxsLHk9bnVsbCxiPW51bGwseD1udWxsLHc9bnVsbDtjb25zdCBTPXQuZ2V0UGFyYW1ldGVyKDM1NjYxKTtsZXQgTT0hMSxUPTA7Y29uc3QgQz10LmdldFBhcmFtZXRlcig3OTM4KTstMSE9PUMuaW5kZXhPZihcIldlYkdMXCIpPyhUPXBhcnNlRmxvYXQoL15XZWJHTCAoXFxkKS8uZXhlYyhDKVsxXSksTT1UPj0xKTotMSE9PUMuaW5kZXhPZihcIk9wZW5HTCBFU1wiKSYmKFQ9cGFyc2VGbG9hdCgvXk9wZW5HTCBFUyAoXFxkKS8uZXhlYyhDKVsxXSksTT1UPj0yKTtsZXQgRT1udWxsLEk9e307Y29uc3QgQT1uZXcgdW4sUD1uZXcgdW47ZnVuY3Rpb24gUihlLGksbil7Y29uc3Qgcj1uZXcgVWludDhBcnJheSg0KSxzPXQuY3JlYXRlVGV4dHVyZSgpO3QuYmluZFRleHR1cmUoZSxzKSx0LnRleFBhcmFtZXRlcmkoZSwxMDI0MSw5NzI4KSx0LnRleFBhcmFtZXRlcmkoZSwxMDI0MCw5NzI4KTtmb3IobGV0IGU9MDtlPG47ZSsrKXQudGV4SW1hZ2UyRChpK2UsMCw2NDA4LDEsMSwwLDY0MDgsNTEyMSxyKTtyZXR1cm4gc31jb25zdCBMPXt9O2Z1bmN0aW9uIE8oZSl7ITAhPT1hW2VdJiYodC5lbmFibGUoZSksYVtlXT0hMCl9ZnVuY3Rpb24gTihlKXshMSE9PWFbZV0mJih0LmRpc2FibGUoZSksYVtlXT0hMSl9TFszNTUzXT1SKDM1NTMsMzU1MywxKSxMWzM0MDY3XT1SKDM0MDY3LDM0MDY5LDYpLHIuc2V0Q2xlYXIoMCwwLDAsMSkscy5zZXRDbGVhcigxKSxvLnNldENsZWFyKDApLE8oMjkyOSkscy5zZXRGdW5jKDMpLHooITEpLEYoMSksTygyODg0KSxrKDApO2NvbnN0IEQ9e1tNaV06MzI3NzQsMTAxOjMyNzc4LDEwMjozMjc3OX07aWYobilEWzEwM109MzI3NzUsRFsxMDRdPTMyNzc2O2Vsc2V7Y29uc3QgdD1lLmdldChcIkVYVF9ibGVuZF9taW5tYXhcIik7bnVsbCE9PXQmJihEWzEwM109dC5NSU5fRVhULERbMTA0XT10Lk1BWF9FWFQpfWNvbnN0ICQ9ezIwMDowLDIwMToxLDIwMjo3NjgsMjA0Ojc3MCwyMTA6Nzc2LDIwODo3NzQsMjA2Ojc3MiwyMDM6NzY5LDIwNTo3NzEsMjA5Ojc3NSwyMDc6NzczfTtmdW5jdGlvbiBrKGUsaSxuLHIscyxvLGEsYyl7aWYoMCE9PWUpe2lmKGh8fChPKDMwNDIpLGg9ITApLDU9PT1lKXM9c3x8aSxvPW98fG4sYT1hfHxyLGk9PT11JiZzPT09Znx8KHQuYmxlbmRFcXVhdGlvblNlcGFyYXRlKERbaV0sRFtzXSksdT1pLGY9cyksbj09PWQmJnI9PT1wJiZvPT09bSYmYT09PWd8fCh0LmJsZW5kRnVuY1NlcGFyYXRlKCRbbl0sJFtyXSwkW29dLCRbYV0pLGQ9bixwPXIsbT1vLGc9YSksbD1lLF89bnVsbDtlbHNlIGlmKGUhPT1sfHxjIT09Xyl7aWYodT09PU1pJiZmPT09TWl8fCh0LmJsZW5kRXF1YXRpb24oMzI3NzQpLHU9TWksZj1NaSksYylzd2l0Y2goZSl7Y2FzZSAxOnQuYmxlbmRGdW5jU2VwYXJhdGUoMSw3NzEsMSw3NzEpO2JyZWFrO2Nhc2UgMjp0LmJsZW5kRnVuYygxLDEpO2JyZWFrO2Nhc2UgMzp0LmJsZW5kRnVuY1NlcGFyYXRlKDAsMCw3NjksNzcxKTticmVhaztjYXNlIDQ6dC5ibGVuZEZ1bmNTZXBhcmF0ZSgwLDc2OCwwLDc3MCk7YnJlYWs7ZGVmYXVsdDpjb25zb2xlLmVycm9yKFwiVEhSRUUuV2ViR0xTdGF0ZTogSW52YWxpZCBibGVuZGluZzogXCIsZSl9ZWxzZSBzd2l0Y2goZSl7Y2FzZSAxOnQuYmxlbmRGdW5jU2VwYXJhdGUoNzcwLDc3MSwxLDc3MSk7YnJlYWs7Y2FzZSAyOnQuYmxlbmRGdW5jKDc3MCwxKTticmVhaztjYXNlIDM6dC5ibGVuZEZ1bmMoMCw3NjkpO2JyZWFrO2Nhc2UgNDp0LmJsZW5kRnVuYygwLDc2OCk7YnJlYWs7ZGVmYXVsdDpjb25zb2xlLmVycm9yKFwiVEhSRUUuV2ViR0xTdGF0ZTogSW52YWxpZCBibGVuZGluZzogXCIsZSl9ZD1udWxsLHA9bnVsbCxtPW51bGwsZz1udWxsLGw9ZSxfPWN9fWVsc2UgaCYmKE4oMzA0MiksaD0hMSl9ZnVuY3Rpb24geihlKXt2IT09ZSYmKGU/dC5mcm9udEZhY2UoMjMwNCk6dC5mcm9udEZhY2UoMjMwNSksdj1lKX1mdW5jdGlvbiBGKGUpezAhPT1lPyhPKDI4ODQpLGUhPT15JiYoMT09PWU/dC5jdWxsRmFjZSgxMDI5KToyPT09ZT90LmN1bGxGYWNlKDEwMjgpOnQuY3VsbEZhY2UoMTAzMikpKTpOKDI4ODQpLHk9ZX1mdW5jdGlvbiBCKGUsaSxuKXtlPyhPKDMyODIzKSx4PT09aSYmdz09PW58fCh0LnBvbHlnb25PZmZzZXQoaSxuKSx4PWksdz1uKSk6TigzMjgyMyl9ZnVuY3Rpb24gaihlKXt2b2lkIDA9PT1lJiYoZT0zMzk4NCtTLTEpLEUhPT1lJiYodC5hY3RpdmVUZXh0dXJlKGUpLEU9ZSl9cmV0dXJue2J1ZmZlcnM6e2NvbG9yOnIsZGVwdGg6cyxzdGVuY2lsOm99LGVuYWJsZTpPLGRpc2FibGU6Tix1c2VQcm9ncmFtOmZ1bmN0aW9uKGUpe3JldHVybiBjIT09ZSYmKHQudXNlUHJvZ3JhbShlKSxjPWUsITApfSxzZXRCbGVuZGluZzprLHNldE1hdGVyaWFsOmZ1bmN0aW9uKHQsZSl7Mj09PXQuc2lkZT9OKDI4ODQpOk8oMjg4NCk7bGV0IGk9MT09PXQuc2lkZTtlJiYoaT0haSkseihpKSwxPT09dC5ibGVuZGluZyYmITE9PT10LnRyYW5zcGFyZW50P2soMCk6ayh0LmJsZW5kaW5nLHQuYmxlbmRFcXVhdGlvbix0LmJsZW5kU3JjLHQuYmxlbmREc3QsdC5ibGVuZEVxdWF0aW9uQWxwaGEsdC5ibGVuZFNyY0FscGhhLHQuYmxlbmREc3RBbHBoYSx0LnByZW11bHRpcGxpZWRBbHBoYSkscy5zZXRGdW5jKHQuZGVwdGhGdW5jKSxzLnNldFRlc3QodC5kZXB0aFRlc3QpLHMuc2V0TWFzayh0LmRlcHRoV3JpdGUpLHIuc2V0TWFzayh0LmNvbG9yV3JpdGUpO2NvbnN0IG49dC5zdGVuY2lsV3JpdGU7by5zZXRUZXN0KG4pLG4mJihvLnNldE1hc2sodC5zdGVuY2lsV3JpdGVNYXNrKSxvLnNldEZ1bmModC5zdGVuY2lsRnVuYyx0LnN0ZW5jaWxSZWYsdC5zdGVuY2lsRnVuY01hc2spLG8uc2V0T3AodC5zdGVuY2lsRmFpbCx0LnN0ZW5jaWxaRmFpbCx0LnN0ZW5jaWxaUGFzcykpLEIodC5wb2x5Z29uT2Zmc2V0LHQucG9seWdvbk9mZnNldEZhY3Rvcix0LnBvbHlnb25PZmZzZXRVbml0cyl9LHNldEZsaXBTaWRlZDp6LHNldEN1bGxGYWNlOkYsc2V0TGluZVdpZHRoOmZ1bmN0aW9uKGUpe2UhPT1iJiYoTSYmdC5saW5lV2lkdGgoZSksYj1lKX0sc2V0UG9seWdvbk9mZnNldDpCLHNldFNjaXNzb3JUZXN0OmZ1bmN0aW9uKHQpe3Q/TygzMDg5KTpOKDMwODkpfSxhY3RpdmVUZXh0dXJlOmosYmluZFRleHR1cmU6ZnVuY3Rpb24oZSxpKXtudWxsPT09RSYmaigpO2xldCBuPUlbRV07dm9pZCAwPT09biYmKG49e3R5cGU6dm9pZCAwLHRleHR1cmU6dm9pZCAwfSxJW0VdPW4pLG4udHlwZT09PWUmJm4udGV4dHVyZT09PWl8fCh0LmJpbmRUZXh0dXJlKGUsaXx8TFtlXSksbi50eXBlPWUsbi50ZXh0dXJlPWkpfSx1bmJpbmRUZXh0dXJlOmZ1bmN0aW9uKCl7Y29uc3QgZT1JW0VdO3ZvaWQgMCE9PWUmJnZvaWQgMCE9PWUudHlwZSYmKHQuYmluZFRleHR1cmUoZS50eXBlLG51bGwpLGUudHlwZT12b2lkIDAsZS50ZXh0dXJlPXZvaWQgMCl9LGNvbXByZXNzZWRUZXhJbWFnZTJEOmZ1bmN0aW9uKCl7dHJ5e3QuY29tcHJlc3NlZFRleEltYWdlMkQuYXBwbHkodCxhcmd1bWVudHMpfWNhdGNoKHQpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTFN0YXRlOlwiLHQpfX0sdGV4SW1hZ2UyRDpmdW5jdGlvbigpe3RyeXt0LnRleEltYWdlMkQuYXBwbHkodCxhcmd1bWVudHMpfWNhdGNoKHQpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTFN0YXRlOlwiLHQpfX0sdGV4SW1hZ2UzRDpmdW5jdGlvbigpe3RyeXt0LnRleEltYWdlM0QuYXBwbHkodCxhcmd1bWVudHMpfWNhdGNoKHQpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTFN0YXRlOlwiLHQpfX0sc2Npc3NvcjpmdW5jdGlvbihlKXshMT09PUEuZXF1YWxzKGUpJiYodC5zY2lzc29yKGUueCxlLnksZS56LGUudyksQS5jb3B5KGUpKX0sdmlld3BvcnQ6ZnVuY3Rpb24oZSl7ITE9PT1QLmVxdWFscyhlKSYmKHQudmlld3BvcnQoZS54LGUueSxlLnosZS53KSxQLmNvcHkoZSkpfSxyZXNldDpmdW5jdGlvbigpe2E9e30sRT1udWxsLEk9e30sYz1udWxsLGg9bnVsbCxsPW51bGwsdT1udWxsLGQ9bnVsbCxwPW51bGwsZj1udWxsLG09bnVsbCxnPW51bGwsXz0hMSx2PW51bGwseT1udWxsLGI9bnVsbCx4PW51bGwsdz1udWxsLHIucmVzZXQoKSxzLnJlc2V0KCksby5yZXNldCgpfX19ZnVuY3Rpb24gVmEodCxlLGksbixyLHMsbyl7Y29uc3QgYT1yLmlzV2ViR0wyLGM9ci5tYXhUZXh0dXJlcyxoPXIubWF4Q3ViZW1hcFNpemUsbD1yLm1heFRleHR1cmVTaXplLHU9ci5tYXhTYW1wbGVzLGQ9bmV3IFdlYWtNYXA7bGV0IHAsZj0hMTt0cnl7Zj1cInVuZGVmaW5lZFwiIT10eXBlb2YgT2Zmc2NyZWVuQ2FudmFzJiZudWxsIT09bmV3IE9mZnNjcmVlbkNhbnZhcygxLDEpLmdldENvbnRleHQoXCIyZFwiKX1jYXRjaCh0KXt9ZnVuY3Rpb24gbSh0LGUpe3JldHVybiBmP25ldyBPZmZzY3JlZW5DYW52YXModCxlKTpkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIsXCJjYW52YXNcIil9ZnVuY3Rpb24gZyh0LGUsaSxuKXtsZXQgcj0xO2lmKCh0LndpZHRoPm58fHQuaGVpZ2h0Pm4pJiYocj1uL01hdGgubWF4KHQud2lkdGgsdC5oZWlnaHQpKSxyPDF8fCEwPT09ZSl7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIEhUTUxJbWFnZUVsZW1lbnQmJnQgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50fHxcInVuZGVmaW5lZFwiIT10eXBlb2YgSFRNTENhbnZhc0VsZW1lbnQmJnQgaW5zdGFuY2VvZiBIVE1MQ2FudmFzRWxlbWVudHx8XCJ1bmRlZmluZWRcIiE9dHlwZW9mIEltYWdlQml0bWFwJiZ0IGluc3RhbmNlb2YgSW1hZ2VCaXRtYXApe2NvbnN0IG49ZT9ubi5mbG9vclBvd2VyT2ZUd286TWF0aC5mbG9vcixzPW4ocip0LndpZHRoKSxvPW4ocip0LmhlaWdodCk7dm9pZCAwPT09cCYmKHA9bShzLG8pKTtjb25zdCBhPWk/bShzLG8pOnA7YS53aWR0aD1zLGEuaGVpZ2h0PW87cmV0dXJuIGEuZ2V0Q29udGV4dChcIjJkXCIpLmRyYXdJbWFnZSh0LDAsMCxzLG8pLGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IFRleHR1cmUgaGFzIGJlZW4gcmVzaXplZCBmcm9tIChcIit0LndpZHRoK1wieFwiK3QuaGVpZ2h0K1wiKSB0byAoXCIrcytcInhcIitvK1wiKS5cIiksYX1yZXR1cm5cImRhdGFcImluIHQmJmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IEltYWdlIGluIERhdGFUZXh0dXJlIGlzIHRvbyBiaWcgKFwiK3Qud2lkdGgrXCJ4XCIrdC5oZWlnaHQrXCIpLlwiKSx0fXJldHVybiB0fWZ1bmN0aW9uIF8odCl7cmV0dXJuIG5uLmlzUG93ZXJPZlR3byh0LndpZHRoKSYmbm4uaXNQb3dlck9mVHdvKHQuaGVpZ2h0KX1mdW5jdGlvbiB2KHQsZSl7cmV0dXJuIHQuZ2VuZXJhdGVNaXBtYXBzJiZlJiZ0Lm1pbkZpbHRlciE9PUlpJiZ0Lm1pbkZpbHRlciE9PUFpfWZ1bmN0aW9uIHkoZSxpLHIscyl7dC5nZW5lcmF0ZU1pcG1hcChlKTtuLmdldChpKS5fX21heE1pcExldmVsPU1hdGgubG9nKE1hdGgubWF4KHIscykpKk1hdGguTE9HMkV9ZnVuY3Rpb24gYihpLG4scil7aWYoITE9PT1hKXJldHVybiBuO2lmKG51bGwhPT1pKXtpZih2b2lkIDAhPT10W2ldKXJldHVybiB0W2ldO2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IEF0dGVtcHQgdG8gdXNlIG5vbi1leGlzdGluZyBXZWJHTCBpbnRlcm5hbCBmb3JtYXQgJ1wiK2krXCInXCIpfWxldCBzPW47cmV0dXJuIDY0MDM9PT1uJiYoNTEyNj09PXImJihzPTMzMzI2KSw1MTMxPT09ciYmKHM9MzMzMjUpLDUxMjE9PT1yJiYocz0zMzMyMSkpLDY0MDc9PT1uJiYoNTEyNj09PXImJihzPTM0ODM3KSw1MTMxPT09ciYmKHM9MzQ4NDMpLDUxMjE9PT1yJiYocz0zMjg0OSkpLDY0MDg9PT1uJiYoNTEyNj09PXImJihzPTM0ODM2KSw1MTMxPT09ciYmKHM9MzQ4NDIpLDUxMjE9PT1yJiYocz0zMjg1NikpLDMzMzI1IT09cyYmMzMzMjYhPT1zJiYzNDg0MiE9PXMmJjM0ODM2IT09c3x8ZS5nZXQoXCJFWFRfY29sb3JfYnVmZmVyX2Zsb2F0XCIpLHN9ZnVuY3Rpb24geCh0KXtyZXR1cm4gdD09PUlpfHwxMDA0PT09dHx8MTAwNT09PXQ/OTcyODo5NzI5fWZ1bmN0aW9uIHcoZSl7Y29uc3QgaT1lLnRhcmdldDtpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIsdyksZnVuY3Rpb24oZSl7Y29uc3QgaT1uLmdldChlKTtpZih2b2lkIDA9PT1pLl9fd2ViZ2xJbml0KXJldHVybjt0LmRlbGV0ZVRleHR1cmUoaS5fX3dlYmdsVGV4dHVyZSksbi5yZW1vdmUoZSl9KGkpLGkuaXNWaWRlb1RleHR1cmUmJmQuZGVsZXRlKGkpLG8ubWVtb3J5LnRleHR1cmVzLS19ZnVuY3Rpb24gUyhlKXtjb25zdCBpPWUudGFyZ2V0O2kucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImRpc3Bvc2VcIixTKSxmdW5jdGlvbihlKXtjb25zdCBpPW4uZ2V0KGUpLHI9bi5nZXQoZS50ZXh0dXJlKTtpZighZSlyZXR1cm47dm9pZCAwIT09ci5fX3dlYmdsVGV4dHVyZSYmdC5kZWxldGVUZXh0dXJlKHIuX193ZWJnbFRleHR1cmUpO2UuZGVwdGhUZXh0dXJlJiZlLmRlcHRoVGV4dHVyZS5kaXNwb3NlKCk7aWYoZS5pc1dlYkdMQ3ViZVJlbmRlclRhcmdldClmb3IobGV0IGU9MDtlPDY7ZSsrKXQuZGVsZXRlRnJhbWVidWZmZXIoaS5fX3dlYmdsRnJhbWVidWZmZXJbZV0pLGkuX193ZWJnbERlcHRoYnVmZmVyJiZ0LmRlbGV0ZVJlbmRlcmJ1ZmZlcihpLl9fd2ViZ2xEZXB0aGJ1ZmZlcltlXSk7ZWxzZSB0LmRlbGV0ZUZyYW1lYnVmZmVyKGkuX193ZWJnbEZyYW1lYnVmZmVyKSxpLl9fd2ViZ2xEZXB0aGJ1ZmZlciYmdC5kZWxldGVSZW5kZXJidWZmZXIoaS5fX3dlYmdsRGVwdGhidWZmZXIpLGkuX193ZWJnbE11bHRpc2FtcGxlZEZyYW1lYnVmZmVyJiZ0LmRlbGV0ZUZyYW1lYnVmZmVyKGkuX193ZWJnbE11bHRpc2FtcGxlZEZyYW1lYnVmZmVyKSxpLl9fd2ViZ2xDb2xvclJlbmRlcmJ1ZmZlciYmdC5kZWxldGVSZW5kZXJidWZmZXIoaS5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXIpLGkuX193ZWJnbERlcHRoUmVuZGVyYnVmZmVyJiZ0LmRlbGV0ZVJlbmRlcmJ1ZmZlcihpLl9fd2ViZ2xEZXB0aFJlbmRlcmJ1ZmZlcik7bi5yZW1vdmUoZS50ZXh0dXJlKSxuLnJlbW92ZShlKX0oaSksby5tZW1vcnkudGV4dHVyZXMtLX1sZXQgTT0wO2Z1bmN0aW9uIFQodCxlKXtjb25zdCByPW4uZ2V0KHQpO2lmKHQuaXNWaWRlb1RleHR1cmUmJmZ1bmN0aW9uKHQpe2NvbnN0IGU9by5yZW5kZXIuZnJhbWU7ZC5nZXQodCkhPT1lJiYoZC5zZXQodCxlKSx0LnVwZGF0ZSgpKX0odCksdC52ZXJzaW9uPjAmJnIuX192ZXJzaW9uIT09dC52ZXJzaW9uKXtjb25zdCBpPXQuaW1hZ2U7aWYodm9pZCAwPT09aSljb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBUZXh0dXJlIG1hcmtlZCBmb3IgdXBkYXRlIGJ1dCBpbWFnZSBpcyB1bmRlZmluZWRcIik7ZWxzZXtpZighMSE9PWkuY29tcGxldGUpcmV0dXJuIHZvaWQgUihyLHQsZSk7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogVGV4dHVyZSBtYXJrZWQgZm9yIHVwZGF0ZSBidXQgaW1hZ2UgaXMgaW5jb21wbGV0ZVwiKX19aS5hY3RpdmVUZXh0dXJlKDMzOTg0K2UpLGkuYmluZFRleHR1cmUoMzU1MyxyLl9fd2ViZ2xUZXh0dXJlKX1mdW5jdGlvbiBDKGUscil7Y29uc3Qgbz1uLmdldChlKTtlLnZlcnNpb24+MCYmby5fX3ZlcnNpb24hPT1lLnZlcnNpb24/ZnVuY3Rpb24oZSxuLHIpe2lmKDYhPT1uLmltYWdlLmxlbmd0aClyZXR1cm47UChlLG4pLGkuYWN0aXZlVGV4dHVyZSgzMzk4NCtyKSxpLmJpbmRUZXh0dXJlKDM0MDY3LGUuX193ZWJnbFRleHR1cmUpLHQucGl4ZWxTdG9yZWkoMzc0NDAsbi5mbGlwWSksdC5waXhlbFN0b3JlaSgzNzQ0MSxuLnByZW11bHRpcGx5QWxwaGEpLHQucGl4ZWxTdG9yZWkoMzMxNyxuLnVucGFja0FsaWdubWVudCk7Y29uc3Qgbz1uJiYobi5pc0NvbXByZXNzZWRUZXh0dXJlfHxuLmltYWdlWzBdLmlzQ29tcHJlc3NlZFRleHR1cmUpLGM9bi5pbWFnZVswXSYmbi5pbWFnZVswXS5pc0RhdGFUZXh0dXJlLGw9W107Zm9yKGxldCB0PTA7dDw2O3QrKylsW3RdPW98fGM/Yz9uLmltYWdlW3RdLmltYWdlOm4uaW1hZ2VbdF06ZyhuLmltYWdlW3RdLCExLCEwLGgpO2NvbnN0IHU9bFswXSxkPV8odSl8fGEscD1zLmNvbnZlcnQobi5mb3JtYXQpLGY9cy5jb252ZXJ0KG4udHlwZSksbT1iKG4uaW50ZXJuYWxGb3JtYXQscCxmKTtsZXQgeDtpZihBKDM0MDY3LG4sZCksbyl7Zm9yKGxldCB0PTA7dDw2O3QrKyl7eD1sW3RdLm1pcG1hcHM7Zm9yKGxldCBlPTA7ZTx4Lmxlbmd0aDtlKyspe2NvbnN0IHI9eFtlXTtuLmZvcm1hdCE9PXppJiZuLmZvcm1hdCE9PWtpP251bGwhPT1wP2kuY29tcHJlc3NlZFRleEltYWdlMkQoMzQwNjkrdCxlLG0sci53aWR0aCxyLmhlaWdodCwwLHIuZGF0YSk6Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogQXR0ZW1wdCB0byBsb2FkIHVuc3VwcG9ydGVkIGNvbXByZXNzZWQgdGV4dHVyZSBmb3JtYXQgaW4gLnNldFRleHR1cmVDdWJlKClcIik6aS50ZXhJbWFnZTJEKDM0MDY5K3QsZSxtLHIud2lkdGgsci5oZWlnaHQsMCxwLGYsci5kYXRhKX19ZS5fX21heE1pcExldmVsPXgubGVuZ3RoLTF9ZWxzZXt4PW4ubWlwbWFwcztmb3IobGV0IHQ9MDt0PDY7dCsrKWlmKGMpe2kudGV4SW1hZ2UyRCgzNDA2OSt0LDAsbSxsW3RdLndpZHRoLGxbdF0uaGVpZ2h0LDAscCxmLGxbdF0uZGF0YSk7Zm9yKGxldCBlPTA7ZTx4Lmxlbmd0aDtlKyspe2NvbnN0IG49eFtlXS5pbWFnZVt0XS5pbWFnZTtpLnRleEltYWdlMkQoMzQwNjkrdCxlKzEsbSxuLndpZHRoLG4uaGVpZ2h0LDAscCxmLG4uZGF0YSl9fWVsc2V7aS50ZXhJbWFnZTJEKDM0MDY5K3QsMCxtLHAsZixsW3RdKTtmb3IobGV0IGU9MDtlPHgubGVuZ3RoO2UrKyl7Y29uc3Qgbj14W2VdO2kudGV4SW1hZ2UyRCgzNDA2OSt0LGUrMSxtLHAsZixuLmltYWdlW3RdKX19ZS5fX21heE1pcExldmVsPXgubGVuZ3RofXYobixkKSYmeSgzNDA2NyxuLHUud2lkdGgsdS5oZWlnaHQpO2UuX192ZXJzaW9uPW4udmVyc2lvbixuLm9uVXBkYXRlJiZuLm9uVXBkYXRlKG4pfShvLGUscik6KGkuYWN0aXZlVGV4dHVyZSgzMzk4NCtyKSxpLmJpbmRUZXh0dXJlKDM0MDY3LG8uX193ZWJnbFRleHR1cmUpKX1jb25zdCBFPXtbVGldOjEwNDk3LFtDaV06MzMwNzEsW0VpXTozMzY0OH0sST17W0lpXTo5NzI4LDEwMDQ6OTk4NCwxMDA1Ojk5ODYsW0FpXTo5NzI5LDEwMDc6OTk4NSxbUGldOjk5ODd9O2Z1bmN0aW9uIEEoaSxzLG8pe28/KHQudGV4UGFyYW1ldGVyaShpLDEwMjQyLEVbcy53cmFwU10pLHQudGV4UGFyYW1ldGVyaShpLDEwMjQzLEVbcy53cmFwVF0pLDMyODc5IT09aSYmMzU4NjYhPT1pfHx0LnRleFBhcmFtZXRlcmkoaSwzMjg4MixFW3Mud3JhcFJdKSx0LnRleFBhcmFtZXRlcmkoaSwxMDI0MCxJW3MubWFnRmlsdGVyXSksdC50ZXhQYXJhbWV0ZXJpKGksMTAyNDEsSVtzLm1pbkZpbHRlcl0pKToodC50ZXhQYXJhbWV0ZXJpKGksMTAyNDIsMzMwNzEpLHQudGV4UGFyYW1ldGVyaShpLDEwMjQzLDMzMDcxKSwzMjg3OSE9PWkmJjM1ODY2IT09aXx8dC50ZXhQYXJhbWV0ZXJpKGksMzI4ODIsMzMwNzEpLHMud3JhcFM9PT1DaSYmcy53cmFwVD09PUNpfHxjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBUZXh0dXJlIGlzIG5vdCBwb3dlciBvZiB0d28uIFRleHR1cmUud3JhcFMgYW5kIFRleHR1cmUud3JhcFQgc2hvdWxkIGJlIHNldCB0byBUSFJFRS5DbGFtcFRvRWRnZVdyYXBwaW5nLlwiKSx0LnRleFBhcmFtZXRlcmkoaSwxMDI0MCx4KHMubWFnRmlsdGVyKSksdC50ZXhQYXJhbWV0ZXJpKGksMTAyNDEseChzLm1pbkZpbHRlcikpLHMubWluRmlsdGVyIT09SWkmJnMubWluRmlsdGVyIT09QWkmJmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IFRleHR1cmUgaXMgbm90IHBvd2VyIG9mIHR3by4gVGV4dHVyZS5taW5GaWx0ZXIgc2hvdWxkIGJlIHNldCB0byBUSFJFRS5OZWFyZXN0RmlsdGVyIG9yIFRIUkVFLkxpbmVhckZpbHRlci5cIikpO2NvbnN0IGM9ZS5nZXQoXCJFWFRfdGV4dHVyZV9maWx0ZXJfYW5pc290cm9waWNcIik7aWYoYyl7aWYocy50eXBlPT09TmkmJm51bGw9PT1lLmdldChcIk9FU190ZXh0dXJlX2Zsb2F0X2xpbmVhclwiKSlyZXR1cm47aWYocy50eXBlPT09RGkmJm51bGw9PT0oYXx8ZS5nZXQoXCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0X2xpbmVhclwiKSkpcmV0dXJuOyhzLmFuaXNvdHJvcHk+MXx8bi5nZXQocykuX19jdXJyZW50QW5pc290cm9weSkmJih0LnRleFBhcmFtZXRlcmYoaSxjLlRFWFRVUkVfTUFYX0FOSVNPVFJPUFlfRVhULE1hdGgubWluKHMuYW5pc290cm9weSxyLmdldE1heEFuaXNvdHJvcHkoKSkpLG4uZ2V0KHMpLl9fY3VycmVudEFuaXNvdHJvcHk9cy5hbmlzb3Ryb3B5KX19ZnVuY3Rpb24gUChlLGkpe3ZvaWQgMD09PWUuX193ZWJnbEluaXQmJihlLl9fd2ViZ2xJbml0PSEwLGkuYWRkRXZlbnRMaXN0ZW5lcihcImRpc3Bvc2VcIix3KSxlLl9fd2ViZ2xUZXh0dXJlPXQuY3JlYXRlVGV4dHVyZSgpLG8ubWVtb3J5LnRleHR1cmVzKyspfWZ1bmN0aW9uIFIoZSxuLHIpe2xldCBvPTM1NTM7bi5pc0RhdGFUZXh0dXJlMkRBcnJheSYmKG89MzU4NjYpLG4uaXNEYXRhVGV4dHVyZTNEJiYobz0zMjg3OSksUChlLG4pLGkuYWN0aXZlVGV4dHVyZSgzMzk4NCtyKSxpLmJpbmRUZXh0dXJlKG8sZS5fX3dlYmdsVGV4dHVyZSksdC5waXhlbFN0b3JlaSgzNzQ0MCxuLmZsaXBZKSx0LnBpeGVsU3RvcmVpKDM3NDQxLG4ucHJlbXVsdGlwbHlBbHBoYSksdC5waXhlbFN0b3JlaSgzMzE3LG4udW5wYWNrQWxpZ25tZW50KTtjb25zdCBjPWZ1bmN0aW9uKHQpe3JldHVybiFhJiYodC53cmFwUyE9PUNpfHx0LndyYXBUIT09Q2l8fHQubWluRmlsdGVyIT09SWkmJnQubWluRmlsdGVyIT09QWkpfShuKSYmITE9PT1fKG4uaW1hZ2UpLGg9ZyhuLmltYWdlLGMsITEsbCksdT1fKGgpfHxhLGQ9cy5jb252ZXJ0KG4uZm9ybWF0KTtsZXQgcCxmPXMuY29udmVydChuLnR5cGUpLG09YihuLmludGVybmFsRm9ybWF0LGQsZik7QShvLG4sdSk7Y29uc3QgeD1uLm1pcG1hcHM7aWYobi5pc0RlcHRoVGV4dHVyZSltPTY0MDIsYT9tPW4udHlwZT09PU5pPzM2MDEyOm4udHlwZT09PU9pPzMzMTkwOm4udHlwZT09PSRpPzM1MDU2OjMzMTg5Om4udHlwZT09PU5pJiZjb25zb2xlLmVycm9yKFwiV2ViR0xSZW5kZXJlcjogRmxvYXRpbmcgcG9pbnQgZGVwdGggdGV4dHVyZSByZXF1aXJlcyBXZWJHTDIuXCIpLG4uZm9ybWF0PT09RmkmJjY0MDI9PT1tJiZuLnR5cGUhPT1MaSYmbi50eXBlIT09T2kmJihjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBVc2UgVW5zaWduZWRTaG9ydFR5cGUgb3IgVW5zaWduZWRJbnRUeXBlIGZvciBEZXB0aEZvcm1hdCBEZXB0aFRleHR1cmUuXCIpLG4udHlwZT1MaSxmPXMuY29udmVydChuLnR5cGUpKSxuLmZvcm1hdD09PUJpJiY2NDAyPT09bSYmKG09MzQwNDEsbi50eXBlIT09JGkmJihjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBVc2UgVW5zaWduZWRJbnQyNDhUeXBlIGZvciBEZXB0aFN0ZW5jaWxGb3JtYXQgRGVwdGhUZXh0dXJlLlwiKSxuLnR5cGU9JGksZj1zLmNvbnZlcnQobi50eXBlKSkpLGkudGV4SW1hZ2UyRCgzNTUzLDAsbSxoLndpZHRoLGguaGVpZ2h0LDAsZCxmLG51bGwpO2Vsc2UgaWYobi5pc0RhdGFUZXh0dXJlKWlmKHgubGVuZ3RoPjAmJnUpe2ZvcihsZXQgdD0wLGU9eC5sZW5ndGg7dDxlO3QrKylwPXhbdF0saS50ZXhJbWFnZTJEKDM1NTMsdCxtLHAud2lkdGgscC5oZWlnaHQsMCxkLGYscC5kYXRhKTtuLmdlbmVyYXRlTWlwbWFwcz0hMSxlLl9fbWF4TWlwTGV2ZWw9eC5sZW5ndGgtMX1lbHNlIGkudGV4SW1hZ2UyRCgzNTUzLDAsbSxoLndpZHRoLGguaGVpZ2h0LDAsZCxmLGguZGF0YSksZS5fX21heE1pcExldmVsPTA7ZWxzZSBpZihuLmlzQ29tcHJlc3NlZFRleHR1cmUpe2ZvcihsZXQgdD0wLGU9eC5sZW5ndGg7dDxlO3QrKylwPXhbdF0sbi5mb3JtYXQhPT16aSYmbi5mb3JtYXQhPT1raT9udWxsIT09ZD9pLmNvbXByZXNzZWRUZXhJbWFnZTJEKDM1NTMsdCxtLHAud2lkdGgscC5oZWlnaHQsMCxwLmRhdGEpOmNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IEF0dGVtcHQgdG8gbG9hZCB1bnN1cHBvcnRlZCBjb21wcmVzc2VkIHRleHR1cmUgZm9ybWF0IGluIC51cGxvYWRUZXh0dXJlKClcIik6aS50ZXhJbWFnZTJEKDM1NTMsdCxtLHAud2lkdGgscC5oZWlnaHQsMCxkLGYscC5kYXRhKTtlLl9fbWF4TWlwTGV2ZWw9eC5sZW5ndGgtMX1lbHNlIGlmKG4uaXNEYXRhVGV4dHVyZTJEQXJyYXkpaS50ZXhJbWFnZTNEKDM1ODY2LDAsbSxoLndpZHRoLGguaGVpZ2h0LGguZGVwdGgsMCxkLGYsaC5kYXRhKSxlLl9fbWF4TWlwTGV2ZWw9MDtlbHNlIGlmKG4uaXNEYXRhVGV4dHVyZTNEKWkudGV4SW1hZ2UzRCgzMjg3OSwwLG0saC53aWR0aCxoLmhlaWdodCxoLmRlcHRoLDAsZCxmLGguZGF0YSksZS5fX21heE1pcExldmVsPTA7ZWxzZSBpZih4Lmxlbmd0aD4wJiZ1KXtmb3IobGV0IHQ9MCxlPXgubGVuZ3RoO3Q8ZTt0KyspcD14W3RdLGkudGV4SW1hZ2UyRCgzNTUzLHQsbSxkLGYscCk7bi5nZW5lcmF0ZU1pcG1hcHM9ITEsZS5fX21heE1pcExldmVsPXgubGVuZ3RoLTF9ZWxzZSBpLnRleEltYWdlMkQoMzU1MywwLG0sZCxmLGgpLGUuX19tYXhNaXBMZXZlbD0wO3Yobix1KSYmeShvLG4saC53aWR0aCxoLmhlaWdodCksZS5fX3ZlcnNpb249bi52ZXJzaW9uLG4ub25VcGRhdGUmJm4ub25VcGRhdGUobil9ZnVuY3Rpb24gTChlLHIsbyxhKXtjb25zdCBjPXMuY29udmVydChyLnRleHR1cmUuZm9ybWF0KSxoPXMuY29udmVydChyLnRleHR1cmUudHlwZSksbD1iKHIudGV4dHVyZS5pbnRlcm5hbEZvcm1hdCxjLGgpO2kudGV4SW1hZ2UyRChhLDAsbCxyLndpZHRoLHIuaGVpZ2h0LDAsYyxoLG51bGwpLHQuYmluZEZyYW1lYnVmZmVyKDM2MTYwLGUpLHQuZnJhbWVidWZmZXJUZXh0dXJlMkQoMzYxNjAsbyxhLG4uZ2V0KHIudGV4dHVyZSkuX193ZWJnbFRleHR1cmUsMCksdC5iaW5kRnJhbWVidWZmZXIoMzYxNjAsbnVsbCl9ZnVuY3Rpb24gTyhlLGksbil7aWYodC5iaW5kUmVuZGVyYnVmZmVyKDM2MTYxLGUpLGkuZGVwdGhCdWZmZXImJiFpLnN0ZW5jaWxCdWZmZXIpe2xldCByPTMzMTg5O2lmKG4pe2NvbnN0IGU9aS5kZXB0aFRleHR1cmU7ZSYmZS5pc0RlcHRoVGV4dHVyZSYmKGUudHlwZT09PU5pP3I9MzYwMTI6ZS50eXBlPT09T2kmJihyPTMzMTkwKSk7Y29uc3Qgbj1EKGkpO3QucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKDM2MTYxLG4scixpLndpZHRoLGkuaGVpZ2h0KX1lbHNlIHQucmVuZGVyYnVmZmVyU3RvcmFnZSgzNjE2MSxyLGkud2lkdGgsaS5oZWlnaHQpO3QuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoMzYxNjAsMzYwOTYsMzYxNjEsZSl9ZWxzZSBpZihpLmRlcHRoQnVmZmVyJiZpLnN0ZW5jaWxCdWZmZXIpe2lmKG4pe2NvbnN0IGU9RChpKTt0LnJlbmRlcmJ1ZmZlclN0b3JhZ2VNdWx0aXNhbXBsZSgzNjE2MSxlLDM1MDU2LGkud2lkdGgsaS5oZWlnaHQpfWVsc2UgdC5yZW5kZXJidWZmZXJTdG9yYWdlKDM2MTYxLDM0MDQxLGkud2lkdGgsaS5oZWlnaHQpO3QuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoMzYxNjAsMzMzMDYsMzYxNjEsZSl9ZWxzZXtjb25zdCBlPXMuY29udmVydChpLnRleHR1cmUuZm9ybWF0KSxyPXMuY29udmVydChpLnRleHR1cmUudHlwZSksbz1iKGkudGV4dHVyZS5pbnRlcm5hbEZvcm1hdCxlLHIpO2lmKG4pe2NvbnN0IGU9RChpKTt0LnJlbmRlcmJ1ZmZlclN0b3JhZ2VNdWx0aXNhbXBsZSgzNjE2MSxlLG8saS53aWR0aCxpLmhlaWdodCl9ZWxzZSB0LnJlbmRlcmJ1ZmZlclN0b3JhZ2UoMzYxNjEsbyxpLndpZHRoLGkuaGVpZ2h0KX10LmJpbmRSZW5kZXJidWZmZXIoMzYxNjEsbnVsbCl9ZnVuY3Rpb24gTihlKXtjb25zdCBpPW4uZ2V0KGUpLHI9ITA9PT1lLmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0O2lmKGUuZGVwdGhUZXh0dXJlKXtpZihyKXRocm93IG5ldyBFcnJvcihcInRhcmdldC5kZXB0aFRleHR1cmUgbm90IHN1cHBvcnRlZCBpbiBDdWJlIHJlbmRlciB0YXJnZXRzXCIpOyFmdW5jdGlvbihlLGkpe2lmKGkmJmkuaXNXZWJHTEN1YmVSZW5kZXJUYXJnZXQpdGhyb3cgbmV3IEVycm9yKFwiRGVwdGggVGV4dHVyZSB3aXRoIGN1YmUgcmVuZGVyIHRhcmdldHMgaXMgbm90IHN1cHBvcnRlZFwiKTtpZih0LmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCxlKSwhaS5kZXB0aFRleHR1cmV8fCFpLmRlcHRoVGV4dHVyZS5pc0RlcHRoVGV4dHVyZSl0aHJvdyBuZXcgRXJyb3IoXCJyZW5kZXJUYXJnZXQuZGVwdGhUZXh0dXJlIG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgVEhSRUUuRGVwdGhUZXh0dXJlXCIpO24uZ2V0KGkuZGVwdGhUZXh0dXJlKS5fX3dlYmdsVGV4dHVyZSYmaS5kZXB0aFRleHR1cmUuaW1hZ2Uud2lkdGg9PT1pLndpZHRoJiZpLmRlcHRoVGV4dHVyZS5pbWFnZS5oZWlnaHQ9PT1pLmhlaWdodHx8KGkuZGVwdGhUZXh0dXJlLmltYWdlLndpZHRoPWkud2lkdGgsaS5kZXB0aFRleHR1cmUuaW1hZ2UuaGVpZ2h0PWkuaGVpZ2h0LGkuZGVwdGhUZXh0dXJlLm5lZWRzVXBkYXRlPSEwKSxUKGkuZGVwdGhUZXh0dXJlLDApO2NvbnN0IHI9bi5nZXQoaS5kZXB0aFRleHR1cmUpLl9fd2ViZ2xUZXh0dXJlO2lmKGkuZGVwdGhUZXh0dXJlLmZvcm1hdD09PUZpKXQuZnJhbWVidWZmZXJUZXh0dXJlMkQoMzYxNjAsMzYwOTYsMzU1MyxyLDApO2Vsc2V7aWYoaS5kZXB0aFRleHR1cmUuZm9ybWF0IT09QmkpdGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biBkZXB0aFRleHR1cmUgZm9ybWF0XCIpO3QuZnJhbWVidWZmZXJUZXh0dXJlMkQoMzYxNjAsMzMzMDYsMzU1MyxyLDApfX0oaS5fX3dlYmdsRnJhbWVidWZmZXIsZSl9ZWxzZSBpZihyKXtpLl9fd2ViZ2xEZXB0aGJ1ZmZlcj1bXTtmb3IobGV0IG49MDtuPDY7bisrKXQuYmluZEZyYW1lYnVmZmVyKDM2MTYwLGkuX193ZWJnbEZyYW1lYnVmZmVyW25dKSxpLl9fd2ViZ2xEZXB0aGJ1ZmZlcltuXT10LmNyZWF0ZVJlbmRlcmJ1ZmZlcigpLE8oaS5fX3dlYmdsRGVwdGhidWZmZXJbbl0sZSwhMSl9ZWxzZSB0LmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCxpLl9fd2ViZ2xGcmFtZWJ1ZmZlciksaS5fX3dlYmdsRGVwdGhidWZmZXI9dC5jcmVhdGVSZW5kZXJidWZmZXIoKSxPKGkuX193ZWJnbERlcHRoYnVmZmVyLGUsITEpO3QuYmluZEZyYW1lYnVmZmVyKDM2MTYwLG51bGwpfWZ1bmN0aW9uIEQodCl7cmV0dXJuIGEmJnQuaXNXZWJHTE11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0P01hdGgubWluKHUsdC5zYW1wbGVzKTowfWxldCAkPSExLGs9ITE7dGhpcy5hbGxvY2F0ZVRleHR1cmVVbml0PWZ1bmN0aW9uKCl7Y29uc3QgdD1NO3JldHVybiB0Pj1jJiZjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFRleHR1cmVzOiBUcnlpbmcgdG8gdXNlIFwiK3QrXCIgdGV4dHVyZSB1bml0cyB3aGlsZSB0aGlzIEdQVSBzdXBwb3J0cyBvbmx5IFwiK2MpLE0rPTEsdH0sdGhpcy5yZXNldFRleHR1cmVVbml0cz1mdW5jdGlvbigpe009MH0sdGhpcy5zZXRUZXh0dXJlMkQ9VCx0aGlzLnNldFRleHR1cmUyREFycmF5PWZ1bmN0aW9uKHQsZSl7Y29uc3Qgcj1uLmdldCh0KTt0LnZlcnNpb24+MCYmci5fX3ZlcnNpb24hPT10LnZlcnNpb24/UihyLHQsZSk6KGkuYWN0aXZlVGV4dHVyZSgzMzk4NCtlKSxpLmJpbmRUZXh0dXJlKDM1ODY2LHIuX193ZWJnbFRleHR1cmUpKX0sdGhpcy5zZXRUZXh0dXJlM0Q9ZnVuY3Rpb24odCxlKXtjb25zdCByPW4uZ2V0KHQpO3QudmVyc2lvbj4wJiZyLl9fdmVyc2lvbiE9PXQudmVyc2lvbj9SKHIsdCxlKTooaS5hY3RpdmVUZXh0dXJlKDMzOTg0K2UpLGkuYmluZFRleHR1cmUoMzI4Nzksci5fX3dlYmdsVGV4dHVyZSkpfSx0aGlzLnNldFRleHR1cmVDdWJlPUMsdGhpcy5zZXR1cFJlbmRlclRhcmdldD1mdW5jdGlvbihlKXtjb25zdCByPW4uZ2V0KGUpLGM9bi5nZXQoZS50ZXh0dXJlKTtlLmFkZEV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIsUyksYy5fX3dlYmdsVGV4dHVyZT10LmNyZWF0ZVRleHR1cmUoKSxvLm1lbW9yeS50ZXh0dXJlcysrO2NvbnN0IGg9ITA9PT1lLmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0LGw9ITA9PT1lLmlzV2ViR0xNdWx0aXNhbXBsZVJlbmRlclRhcmdldCx1PV8oZSl8fGE7aWYoIWF8fGUudGV4dHVyZS5mb3JtYXQhPT1raXx8ZS50ZXh0dXJlLnR5cGUhPT1OaSYmZS50ZXh0dXJlLnR5cGUhPT1EaXx8KGUudGV4dHVyZS5mb3JtYXQ9emksY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogUmVuZGVyaW5nIHRvIHRleHR1cmVzIHdpdGggUkdCIGZvcm1hdCBpcyBub3Qgc3VwcG9ydGVkLiBVc2luZyBSR0JBIGZvcm1hdCBpbnN0ZWFkLlwiKSksaCl7ci5fX3dlYmdsRnJhbWVidWZmZXI9W107Zm9yKGxldCBlPTA7ZTw2O2UrKylyLl9fd2ViZ2xGcmFtZWJ1ZmZlcltlXT10LmNyZWF0ZUZyYW1lYnVmZmVyKCl9ZWxzZSBpZihyLl9fd2ViZ2xGcmFtZWJ1ZmZlcj10LmNyZWF0ZUZyYW1lYnVmZmVyKCksbClpZihhKXtyLl9fd2ViZ2xNdWx0aXNhbXBsZWRGcmFtZWJ1ZmZlcj10LmNyZWF0ZUZyYW1lYnVmZmVyKCksci5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXI9dC5jcmVhdGVSZW5kZXJidWZmZXIoKSx0LmJpbmRSZW5kZXJidWZmZXIoMzYxNjEsci5fX3dlYmdsQ29sb3JSZW5kZXJidWZmZXIpO2NvbnN0IGk9cy5jb252ZXJ0KGUudGV4dHVyZS5mb3JtYXQpLG49cy5jb252ZXJ0KGUudGV4dHVyZS50eXBlKSxvPWIoZS50ZXh0dXJlLmludGVybmFsRm9ybWF0LGksbiksYT1EKGUpO3QucmVuZGVyYnVmZmVyU3RvcmFnZU11bHRpc2FtcGxlKDM2MTYxLGEsbyxlLndpZHRoLGUuaGVpZ2h0KSx0LmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCxyLl9fd2ViZ2xNdWx0aXNhbXBsZWRGcmFtZWJ1ZmZlciksdC5mcmFtZWJ1ZmZlclJlbmRlcmJ1ZmZlcigzNjE2MCwzNjA2NCwzNjE2MSxyLl9fd2ViZ2xDb2xvclJlbmRlcmJ1ZmZlciksdC5iaW5kUmVuZGVyYnVmZmVyKDM2MTYxLG51bGwpLGUuZGVwdGhCdWZmZXImJihyLl9fd2ViZ2xEZXB0aFJlbmRlcmJ1ZmZlcj10LmNyZWF0ZVJlbmRlcmJ1ZmZlcigpLE8oci5fX3dlYmdsRGVwdGhSZW5kZXJidWZmZXIsZSwhMCkpLHQuYmluZEZyYW1lYnVmZmVyKDM2MTYwLG51bGwpfWVsc2UgY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogV2ViR0xNdWx0aXNhbXBsZVJlbmRlclRhcmdldCBjYW4gb25seSBiZSB1c2VkIHdpdGggV2ViR0wyLlwiKTtpZihoKXtpLmJpbmRUZXh0dXJlKDM0MDY3LGMuX193ZWJnbFRleHR1cmUpLEEoMzQwNjcsZS50ZXh0dXJlLHUpO2ZvcihsZXQgdD0wO3Q8Njt0KyspTChyLl9fd2ViZ2xGcmFtZWJ1ZmZlclt0XSxlLDM2MDY0LDM0MDY5K3QpO3YoZS50ZXh0dXJlLHUpJiZ5KDM0MDY3LGUudGV4dHVyZSxlLndpZHRoLGUuaGVpZ2h0KSxpLmJpbmRUZXh0dXJlKDM0MDY3LG51bGwpfWVsc2UgaS5iaW5kVGV4dHVyZSgzNTUzLGMuX193ZWJnbFRleHR1cmUpLEEoMzU1MyxlLnRleHR1cmUsdSksTChyLl9fd2ViZ2xGcmFtZWJ1ZmZlcixlLDM2MDY0LDM1NTMpLHYoZS50ZXh0dXJlLHUpJiZ5KDM1NTMsZS50ZXh0dXJlLGUud2lkdGgsZS5oZWlnaHQpLGkuYmluZFRleHR1cmUoMzU1MyxudWxsKTtlLmRlcHRoQnVmZmVyJiZOKGUpfSx0aGlzLnVwZGF0ZVJlbmRlclRhcmdldE1pcG1hcD1mdW5jdGlvbih0KXtjb25zdCBlPXQudGV4dHVyZTtpZih2KGUsXyh0KXx8YSkpe2NvbnN0IHI9dC5pc1dlYkdMQ3ViZVJlbmRlclRhcmdldD8zNDA2NzozNTUzLHM9bi5nZXQoZSkuX193ZWJnbFRleHR1cmU7aS5iaW5kVGV4dHVyZShyLHMpLHkocixlLHQud2lkdGgsdC5oZWlnaHQpLGkuYmluZFRleHR1cmUocixudWxsKX19LHRoaXMudXBkYXRlTXVsdGlzYW1wbGVSZW5kZXJUYXJnZXQ9ZnVuY3Rpb24oZSl7aWYoZS5pc1dlYkdMTXVsdGlzYW1wbGVSZW5kZXJUYXJnZXQpaWYoYSl7Y29uc3QgaT1uLmdldChlKTt0LmJpbmRGcmFtZWJ1ZmZlcigzNjAwOCxpLl9fd2ViZ2xNdWx0aXNhbXBsZWRGcmFtZWJ1ZmZlciksdC5iaW5kRnJhbWVidWZmZXIoMzYwMDksaS5fX3dlYmdsRnJhbWVidWZmZXIpO2NvbnN0IHI9ZS53aWR0aCxzPWUuaGVpZ2h0O2xldCBvPTE2Mzg0O2UuZGVwdGhCdWZmZXImJihvfD0yNTYpLGUuc3RlbmNpbEJ1ZmZlciYmKG98PTEwMjQpLHQuYmxpdEZyYW1lYnVmZmVyKDAsMCxyLHMsMCwwLHIscyxvLDk3MjgpLHQuYmluZEZyYW1lYnVmZmVyKDM2MTYwLGkuX193ZWJnbE11bHRpc2FtcGxlZEZyYW1lYnVmZmVyKX1lbHNlIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IFdlYkdMTXVsdGlzYW1wbGVSZW5kZXJUYXJnZXQgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIFdlYkdMMi5cIil9LHRoaXMuc2FmZVNldFRleHR1cmUyRD1mdW5jdGlvbih0LGUpe3QmJnQuaXNXZWJHTFJlbmRlclRhcmdldCYmKCExPT09JCYmKGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMVGV4dHVyZXMuc2FmZVNldFRleHR1cmUyRDogZG9uJ3QgdXNlIHJlbmRlciB0YXJnZXRzIGFzIHRleHR1cmVzLiBVc2UgdGhlaXIgLnRleHR1cmUgcHJvcGVydHkgaW5zdGVhZC5cIiksJD0hMCksdD10LnRleHR1cmUpLFQodCxlKX0sdGhpcy5zYWZlU2V0VGV4dHVyZUN1YmU9ZnVuY3Rpb24odCxlKXt0JiZ0LmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0JiYoITE9PT1rJiYoY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xUZXh0dXJlcy5zYWZlU2V0VGV4dHVyZUN1YmU6IGRvbid0IHVzZSBjdWJlIHJlbmRlciB0YXJnZXRzIGFzIHRleHR1cmVzLiBVc2UgdGhlaXIgLnRleHR1cmUgcHJvcGVydHkgaW5zdGVhZC5cIiksaz0hMCksdD10LnRleHR1cmUpLEModCxlKX19ZnVuY3Rpb24gR2EodCxlLGkpe2NvbnN0IG49aS5pc1dlYkdMMjtyZXR1cm57Y29udmVydDpmdW5jdGlvbih0KXtsZXQgaTtpZih0PT09UmkpcmV0dXJuIDUxMjE7aWYoMTAxNz09PXQpcmV0dXJuIDMyODE5O2lmKDEwMTg9PT10KXJldHVybiAzMjgyMDtpZigxMDE5PT09dClyZXR1cm4gMzM2MzU7aWYoMTAxMD09PXQpcmV0dXJuIDUxMjA7aWYoMTAxMT09PXQpcmV0dXJuIDUxMjI7aWYodD09PUxpKXJldHVybiA1MTIzO2lmKDEwMTM9PT10KXJldHVybiA1MTI0O2lmKHQ9PT1PaSlyZXR1cm4gNTEyNTtpZih0PT09TmkpcmV0dXJuIDUxMjY7aWYodD09PURpKXJldHVybiBuPzUxMzE6KGk9ZS5nZXQoXCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0XCIpLG51bGwhPT1pP2kuSEFMRl9GTE9BVF9PRVM6bnVsbCk7aWYoMTAyMT09PXQpcmV0dXJuIDY0MDY7aWYodD09PWtpKXJldHVybiA2NDA3O2lmKHQ9PT16aSlyZXR1cm4gNjQwODtpZigxMDI0PT09dClyZXR1cm4gNjQwOTtpZigxMDI1PT09dClyZXR1cm4gNjQxMDtpZih0PT09RmkpcmV0dXJuIDY0MDI7aWYodD09PUJpKXJldHVybiAzNDA0MTtpZigxMDI4PT09dClyZXR1cm4gNjQwMztpZigxMDI5PT09dClyZXR1cm4gMzYyNDQ7aWYoMTAzMD09PXQpcmV0dXJuIDMzMzE5O2lmKDEwMzE9PT10KXJldHVybiAzMzMyMDtpZigxMDMyPT09dClyZXR1cm4gMzYyNDg7aWYoMTAzMz09PXQpcmV0dXJuIDM2MjQ5O2lmKDMzNzc2PT09dHx8MzM3Nzc9PT10fHwzMzc3OD09PXR8fDMzNzc5PT09dCl7aWYoaT1lLmdldChcIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjXCIpLG51bGw9PT1pKXJldHVybiBudWxsO2lmKDMzNzc2PT09dClyZXR1cm4gaS5DT01QUkVTU0VEX1JHQl9TM1RDX0RYVDFfRVhUO2lmKDMzNzc3PT09dClyZXR1cm4gaS5DT01QUkVTU0VEX1JHQkFfUzNUQ19EWFQxX0VYVDtpZigzMzc3OD09PXQpcmV0dXJuIGkuQ09NUFJFU1NFRF9SR0JBX1MzVENfRFhUM19FWFQ7aWYoMzM3Nzk9PT10KXJldHVybiBpLkNPTVBSRVNTRURfUkdCQV9TM1RDX0RYVDVfRVhUfWlmKDM1ODQwPT09dHx8MzU4NDE9PT10fHwzNTg0Mj09PXR8fDM1ODQzPT09dCl7aWYoaT1lLmdldChcIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9wdnJ0Y1wiKSxudWxsPT09aSlyZXR1cm4gbnVsbDtpZigzNTg0MD09PXQpcmV0dXJuIGkuQ09NUFJFU1NFRF9SR0JfUFZSVENfNEJQUFYxX0lNRztpZigzNTg0MT09PXQpcmV0dXJuIGkuQ09NUFJFU1NFRF9SR0JfUFZSVENfMkJQUFYxX0lNRztpZigzNTg0Mj09PXQpcmV0dXJuIGkuQ09NUFJFU1NFRF9SR0JBX1BWUlRDXzRCUFBWMV9JTUc7aWYoMzU4NDM9PT10KXJldHVybiBpLkNPTVBSRVNTRURfUkdCQV9QVlJUQ18yQlBQVjFfSU1HfWlmKDM2MTk2PT09dClyZXR1cm4gaT1lLmdldChcIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9ldGMxXCIpLG51bGwhPT1pP2kuQ09NUFJFU1NFRF9SR0JfRVRDMV9XRUJHTDpudWxsO2lmKCgzNzQ5Mj09PXR8fDM3NDk2PT09dCkmJihpPWUuZ2V0KFwiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2V0Y1wiKSxudWxsIT09aSkpe2lmKDM3NDkyPT09dClyZXR1cm4gaS5DT01QUkVTU0VEX1JHQjhfRVRDMjtpZigzNzQ5Nj09PXQpcmV0dXJuIGkuQ09NUFJFU1NFRF9SR0JBOF9FVEMyX0VBQ31yZXR1cm4gMzc4MDg9PT10fHwzNzgwOT09PXR8fDM3ODEwPT09dHx8Mzc4MTE9PT10fHwzNzgxMj09PXR8fDM3ODEzPT09dHx8Mzc4MTQ9PT10fHwzNzgxNT09PXR8fDM3ODE2PT09dHx8Mzc4MTc9PT10fHwzNzgxOD09PXR8fDM3ODE5PT09dHx8Mzc4MjA9PT10fHwzNzgyMT09PXR8fDM3ODQwPT09dHx8Mzc4NDE9PT10fHwzNzg0Mj09PXR8fDM3ODQzPT09dHx8Mzc4NDQ9PT10fHwzNzg0NT09PXR8fDM3ODQ2PT09dHx8Mzc4NDc9PT10fHwzNzg0OD09PXR8fDM3ODQ5PT09dHx8Mzc4NTA9PT10fHwzNzg1MT09PXR8fDM3ODUyPT09dHx8Mzc4NTM9PT10PyhpPWUuZ2V0KFwiV0VCR0xfY29tcHJlc3NlZF90ZXh0dXJlX2FzdGNcIiksbnVsbCE9PWk/dDpudWxsKTozNjQ5Mj09PXQ/KGk9ZS5nZXQoXCJFWFRfdGV4dHVyZV9jb21wcmVzc2lvbl9icHRjXCIpLG51bGwhPT1pP3Q6bnVsbCk6dD09PSRpP24/MzQwNDI6KGk9ZS5nZXQoXCJXRUJHTF9kZXB0aF90ZXh0dXJlXCIpLG51bGwhPT1pP2kuVU5TSUdORURfSU5UXzI0XzhfV0VCR0w6bnVsbCk6dm9pZCAwfX19ZnVuY3Rpb24gcWEodD1bXSl7RHMuY2FsbCh0aGlzKSx0aGlzLmNhbWVyYXM9dH1mdW5jdGlvbiBXYSgpe3ByLmNhbGwodGhpcyksdGhpcy50eXBlPVwiR3JvdXBcIn1mdW5jdGlvbiBYYSgpe3RoaXMuX3RhcmdldFJheT1udWxsLHRoaXMuX2dyaXA9bnVsbCx0aGlzLl9oYW5kPW51bGx9ZnVuY3Rpb24gWWEodCxlKXtjb25zdCBpPXRoaXM7bGV0IG49bnVsbCxyPTEscz1udWxsLG89XCJsb2NhbC1mbG9vclwiLGE9bnVsbDtjb25zdCBjPVtdLGg9bmV3IE1hcCxsPW5ldyBEcztsLmxheWVycy5lbmFibGUoMSksbC52aWV3cG9ydD1uZXcgdW47Y29uc3QgdT1uZXcgRHM7dS5sYXllcnMuZW5hYmxlKDIpLHUudmlld3BvcnQ9bmV3IHVuO2NvbnN0IGQ9W2wsdV0scD1uZXcgcWE7cC5sYXllcnMuZW5hYmxlKDEpLHAubGF5ZXJzLmVuYWJsZSgyKTtsZXQgZj1udWxsLG09bnVsbDtmdW5jdGlvbiBnKHQpe2NvbnN0IGU9aC5nZXQodC5pbnB1dFNvdXJjZSk7ZSYmZS5kaXNwYXRjaEV2ZW50KHt0eXBlOnQudHlwZSxkYXRhOnQuaW5wdXRTb3VyY2V9KX1mdW5jdGlvbiBfKCl7aC5mb3JFYWNoKChmdW5jdGlvbih0LGUpe3QuZGlzY29ubmVjdChlKX0pKSxoLmNsZWFyKCksZj1udWxsLG09bnVsbCx0LnNldEZyYW1lYnVmZmVyKG51bGwpLHQuc2V0UmVuZGVyVGFyZ2V0KHQuZ2V0UmVuZGVyVGFyZ2V0KCkpLFMuc3RvcCgpLGkuaXNQcmVzZW50aW5nPSExLGkuZGlzcGF0Y2hFdmVudCh7dHlwZTpcInNlc3Npb25lbmRcIn0pfWZ1bmN0aW9uIHYodCl7Y29uc3QgZT1uLmlucHV0U291cmNlcztmb3IobGV0IHQ9MDt0PGMubGVuZ3RoO3QrKyloLnNldChlW3RdLGNbdF0pO2ZvcihsZXQgZT0wO2U8dC5yZW1vdmVkLmxlbmd0aDtlKyspe2NvbnN0IGk9dC5yZW1vdmVkW2VdLG49aC5nZXQoaSk7biYmKG4uZGlzcGF0Y2hFdmVudCh7dHlwZTpcImRpc2Nvbm5lY3RlZFwiLGRhdGE6aX0pLGguZGVsZXRlKGkpKX1mb3IobGV0IGU9MDtlPHQuYWRkZWQubGVuZ3RoO2UrKyl7Y29uc3QgaT10LmFkZGVkW2VdLG49aC5nZXQoaSk7biYmbi5kaXNwYXRjaEV2ZW50KHt0eXBlOlwiY29ubmVjdGVkXCIsZGF0YTppfSl9fXRoaXMuZW5hYmxlZD0hMSx0aGlzLmlzUHJlc2VudGluZz0hMSx0aGlzLmdldENvbnRyb2xsZXI9ZnVuY3Rpb24odCl7bGV0IGU9Y1t0XTtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9bmV3IFhhLGNbdF09ZSksZS5nZXRUYXJnZXRSYXlTcGFjZSgpfSx0aGlzLmdldENvbnRyb2xsZXJHcmlwPWZ1bmN0aW9uKHQpe2xldCBlPWNbdF07cmV0dXJuIHZvaWQgMD09PWUmJihlPW5ldyBYYSxjW3RdPWUpLGUuZ2V0R3JpcFNwYWNlKCl9LHRoaXMuZ2V0SGFuZD1mdW5jdGlvbih0KXtsZXQgZT1jW3RdO3JldHVybiB2b2lkIDA9PT1lJiYoZT1uZXcgWGEsY1t0XT1lKSxlLmdldEhhbmRTcGFjZSgpfSx0aGlzLnNldEZyYW1lYnVmZmVyU2NhbGVGYWN0b3I9ZnVuY3Rpb24odCl7cj10LCEwPT09aS5pc1ByZXNlbnRpbmcmJmNvbnNvbGUud2FybihcIlRIUkVFLldlYlhSTWFuYWdlcjogQ2Fubm90IGNoYW5nZSBmcmFtZWJ1ZmZlciBzY2FsZSB3aGlsZSBwcmVzZW50aW5nLlwiKX0sdGhpcy5zZXRSZWZlcmVuY2VTcGFjZVR5cGU9ZnVuY3Rpb24odCl7bz10LCEwPT09aS5pc1ByZXNlbnRpbmcmJmNvbnNvbGUud2FybihcIlRIUkVFLldlYlhSTWFuYWdlcjogQ2Fubm90IGNoYW5nZSByZWZlcmVuY2Ugc3BhY2UgdHlwZSB3aGlsZSBwcmVzZW50aW5nLlwiKX0sdGhpcy5nZXRSZWZlcmVuY2VTcGFjZT1mdW5jdGlvbigpe3JldHVybiBzfSx0aGlzLmdldFNlc3Npb249ZnVuY3Rpb24oKXtyZXR1cm4gbn0sdGhpcy5zZXRTZXNzaW9uPWFzeW5jIGZ1bmN0aW9uKHQpe2lmKG49dCxudWxsIT09bil7bi5hZGRFdmVudExpc3RlbmVyKFwic2VsZWN0XCIsZyksbi5hZGRFdmVudExpc3RlbmVyKFwic2VsZWN0c3RhcnRcIixnKSxuLmFkZEV2ZW50TGlzdGVuZXIoXCJzZWxlY3RlbmRcIixnKSxuLmFkZEV2ZW50TGlzdGVuZXIoXCJzcXVlZXplXCIsZyksbi5hZGRFdmVudExpc3RlbmVyKFwic3F1ZWV6ZXN0YXJ0XCIsZyksbi5hZGRFdmVudExpc3RlbmVyKFwic3F1ZWV6ZWVuZFwiLGcpLG4uYWRkRXZlbnRMaXN0ZW5lcihcImVuZFwiLF8pLG4uYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0c291cmNlc2NoYW5nZVwiLHYpO2NvbnN0IHQ9ZS5nZXRDb250ZXh0QXR0cmlidXRlcygpOyEwIT09dC54ckNvbXBhdGlibGUmJmF3YWl0IGUubWFrZVhSQ29tcGF0aWJsZSgpO2NvbnN0IGE9e2FudGlhbGlhczp0LmFudGlhbGlhcyxhbHBoYTp0LmFscGhhLGRlcHRoOnQuZGVwdGgsc3RlbmNpbDp0LnN0ZW5jaWwsZnJhbWVidWZmZXJTY2FsZUZhY3RvcjpyfSxjPW5ldyBYUldlYkdMTGF5ZXIobixlLGEpO24udXBkYXRlUmVuZGVyU3RhdGUoe2Jhc2VMYXllcjpjfSkscz1hd2FpdCBuLnJlcXVlc3RSZWZlcmVuY2VTcGFjZShvKSxTLnNldENvbnRleHQobiksUy5zdGFydCgpLGkuaXNQcmVzZW50aW5nPSEwLGkuZGlzcGF0Y2hFdmVudCh7dHlwZTpcInNlc3Npb25zdGFydFwifSl9fTtjb25zdCB5PW5ldyBmbixiPW5ldyBmbjtmdW5jdGlvbiB4KHQsZSl7bnVsbD09PWU/dC5tYXRyaXhXb3JsZC5jb3B5KHQubWF0cml4KTp0Lm1hdHJpeFdvcmxkLm11bHRpcGx5TWF0cmljZXMoZS5tYXRyaXhXb3JsZCx0Lm1hdHJpeCksdC5tYXRyaXhXb3JsZEludmVyc2UuY29weSh0Lm1hdHJpeFdvcmxkKS5pbnZlcnQoKX10aGlzLmdldENhbWVyYT1mdW5jdGlvbih0KXtwLm5lYXI9dS5uZWFyPWwubmVhcj10Lm5lYXIscC5mYXI9dS5mYXI9bC5mYXI9dC5mYXIsZj09PXAubmVhciYmbT09PXAuZmFyfHwobi51cGRhdGVSZW5kZXJTdGF0ZSh7ZGVwdGhOZWFyOnAubmVhcixkZXB0aEZhcjpwLmZhcn0pLGY9cC5uZWFyLG09cC5mYXIpO2NvbnN0IGU9dC5wYXJlbnQsaT1wLmNhbWVyYXM7eChwLGUpO2ZvcihsZXQgdD0wO3Q8aS5sZW5ndGg7dCsrKXgoaVt0XSxlKTt0Lm1hdHJpeFdvcmxkLmNvcHkocC5tYXRyaXhXb3JsZCksdC5tYXRyaXguY29weShwLm1hdHJpeCksdC5tYXRyaXguZGVjb21wb3NlKHQucG9zaXRpb24sdC5xdWF0ZXJuaW9uLHQuc2NhbGUpO2NvbnN0IHI9dC5jaGlsZHJlbjtmb3IobGV0IHQ9MCxlPXIubGVuZ3RoO3Q8ZTt0Kyspclt0XS51cGRhdGVNYXRyaXhXb3JsZCghMCk7cmV0dXJuIDI9PT1pLmxlbmd0aD9mdW5jdGlvbih0LGUsaSl7eS5zZXRGcm9tTWF0cml4UG9zaXRpb24oZS5tYXRyaXhXb3JsZCksYi5zZXRGcm9tTWF0cml4UG9zaXRpb24oaS5tYXRyaXhXb3JsZCk7Y29uc3Qgbj15LmRpc3RhbmNlVG8oYikscj1lLnByb2plY3Rpb25NYXRyaXguZWxlbWVudHMscz1pLnByb2plY3Rpb25NYXRyaXguZWxlbWVudHMsbz1yWzE0XS8oclsxMF0tMSksYT1yWzE0XS8oclsxMF0rMSksYz0ocls5XSsxKS9yWzVdLGg9KHJbOV0tMSkvcls1XSxsPShyWzhdLTEpL3JbMF0sdT0oc1s4XSsxKS9zWzBdLGQ9bypsLHA9byp1LGY9bi8oLWwrdSksbT1mKi1sO2UubWF0cml4V29ybGQuZGVjb21wb3NlKHQucG9zaXRpb24sdC5xdWF0ZXJuaW9uLHQuc2NhbGUpLHQudHJhbnNsYXRlWChtKSx0LnRyYW5zbGF0ZVooZiksdC5tYXRyaXhXb3JsZC5jb21wb3NlKHQucG9zaXRpb24sdC5xdWF0ZXJuaW9uLHQuc2NhbGUpLHQubWF0cml4V29ybGRJbnZlcnNlLmNvcHkodC5tYXRyaXhXb3JsZCkuaW52ZXJ0KCk7Y29uc3QgZz1vK2YsXz1hK2Ysdj1kLW0seD1wKyhuLW0pLHc9YyphL18qZyxTPWgqYS9fKmc7dC5wcm9qZWN0aW9uTWF0cml4Lm1ha2VQZXJzcGVjdGl2ZSh2LHgsdyxTLGcsXyl9KHAsbCx1KTpwLnByb2plY3Rpb25NYXRyaXguY29weShsLnByb2plY3Rpb25NYXRyaXgpLHB9O2xldCB3PW51bGw7Y29uc3QgUz1uZXcgVnM7Uy5zZXRBbmltYXRpb25Mb29wKChmdW5jdGlvbihlLGkpe2lmKGE9aS5nZXRWaWV3ZXJQb3NlKHMpLG51bGwhPT1hKXtjb25zdCBlPWEudmlld3MsaT1uLnJlbmRlclN0YXRlLmJhc2VMYXllcjt0LnNldEZyYW1lYnVmZmVyKGkuZnJhbWVidWZmZXIpO2xldCByPSExO2UubGVuZ3RoIT09cC5jYW1lcmFzLmxlbmd0aCYmKHAuY2FtZXJhcy5sZW5ndGg9MCxyPSEwKTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoO3QrKyl7Y29uc3Qgbj1lW3RdLHM9aS5nZXRWaWV3cG9ydChuKSxvPWRbdF07by5tYXRyaXguZnJvbUFycmF5KG4udHJhbnNmb3JtLm1hdHJpeCksby5wcm9qZWN0aW9uTWF0cml4LmZyb21BcnJheShuLnByb2plY3Rpb25NYXRyaXgpLG8udmlld3BvcnQuc2V0KHMueCxzLnkscy53aWR0aCxzLmhlaWdodCksMD09PXQmJnAubWF0cml4LmNvcHkoby5tYXRyaXgpLCEwPT09ciYmcC5jYW1lcmFzLnB1c2gobyl9fWNvbnN0IHI9bi5pbnB1dFNvdXJjZXM7Zm9yKGxldCB0PTA7dDxjLmxlbmd0aDt0Kyspe2NvbnN0IGU9Y1t0XSxuPXJbdF07ZS51cGRhdGUobixpLHMpfXcmJncoZSxpKX0pKSx0aGlzLnNldEFuaW1hdGlvbkxvb3A9ZnVuY3Rpb24odCl7dz10fSx0aGlzLmRpc3Bvc2U9ZnVuY3Rpb24oKXt9fWZ1bmN0aW9uIFphKHQpe2Z1bmN0aW9uIGUoZSxpKXtlLm9wYWNpdHkudmFsdWU9aS5vcGFjaXR5LGkuY29sb3ImJmUuZGlmZnVzZS52YWx1ZS5jb3B5KGkuY29sb3IpLGkuZW1pc3NpdmUmJmUuZW1pc3NpdmUudmFsdWUuY29weShpLmVtaXNzaXZlKS5tdWx0aXBseVNjYWxhcihpLmVtaXNzaXZlSW50ZW5zaXR5KSxpLm1hcCYmKGUubWFwLnZhbHVlPWkubWFwKSxpLmFscGhhTWFwJiYoZS5hbHBoYU1hcC52YWx1ZT1pLmFscGhhTWFwKSxpLnNwZWN1bGFyTWFwJiYoZS5zcGVjdWxhck1hcC52YWx1ZT1pLnNwZWN1bGFyTWFwKTtjb25zdCBuPXQuZ2V0KGkpLmVudk1hcDtpZihuKXtlLmVudk1hcC52YWx1ZT1uLGUuZmxpcEVudk1hcC52YWx1ZT1uLmlzQ3ViZVRleHR1cmUmJm4uX25lZWRzRmxpcEVudk1hcD8tMToxLGUucmVmbGVjdGl2aXR5LnZhbHVlPWkucmVmbGVjdGl2aXR5LGUucmVmcmFjdGlvblJhdGlvLnZhbHVlPWkucmVmcmFjdGlvblJhdGlvO2NvbnN0IHI9dC5nZXQobikuX19tYXhNaXBMZXZlbDt2b2lkIDAhPT1yJiYoZS5tYXhNaXBMZXZlbC52YWx1ZT1yKX1sZXQgcixzO2kubGlnaHRNYXAmJihlLmxpZ2h0TWFwLnZhbHVlPWkubGlnaHRNYXAsZS5saWdodE1hcEludGVuc2l0eS52YWx1ZT1pLmxpZ2h0TWFwSW50ZW5zaXR5KSxpLmFvTWFwJiYoZS5hb01hcC52YWx1ZT1pLmFvTWFwLGUuYW9NYXBJbnRlbnNpdHkudmFsdWU9aS5hb01hcEludGVuc2l0eSksaS5tYXA/cj1pLm1hcDppLnNwZWN1bGFyTWFwP3I9aS5zcGVjdWxhck1hcDppLmRpc3BsYWNlbWVudE1hcD9yPWkuZGlzcGxhY2VtZW50TWFwOmkubm9ybWFsTWFwP3I9aS5ub3JtYWxNYXA6aS5idW1wTWFwP3I9aS5idW1wTWFwOmkucm91Z2huZXNzTWFwP3I9aS5yb3VnaG5lc3NNYXA6aS5tZXRhbG5lc3NNYXA/cj1pLm1ldGFsbmVzc01hcDppLmFscGhhTWFwP3I9aS5hbHBoYU1hcDppLmVtaXNzaXZlTWFwP3I9aS5lbWlzc2l2ZU1hcDppLmNsZWFyY29hdE1hcD9yPWkuY2xlYXJjb2F0TWFwOmkuY2xlYXJjb2F0Tm9ybWFsTWFwP3I9aS5jbGVhcmNvYXROb3JtYWxNYXA6aS5jbGVhcmNvYXRSb3VnaG5lc3NNYXAmJihyPWkuY2xlYXJjb2F0Um91Z2huZXNzTWFwKSx2b2lkIDAhPT1yJiYoci5pc1dlYkdMUmVuZGVyVGFyZ2V0JiYocj1yLnRleHR1cmUpLCEwPT09ci5tYXRyaXhBdXRvVXBkYXRlJiZyLnVwZGF0ZU1hdHJpeCgpLGUudXZUcmFuc2Zvcm0udmFsdWUuY29weShyLm1hdHJpeCkpLGkuYW9NYXA/cz1pLmFvTWFwOmkubGlnaHRNYXAmJihzPWkubGlnaHRNYXApLHZvaWQgMCE9PXMmJihzLmlzV2ViR0xSZW5kZXJUYXJnZXQmJihzPXMudGV4dHVyZSksITA9PT1zLm1hdHJpeEF1dG9VcGRhdGUmJnMudXBkYXRlTWF0cml4KCksZS51djJUcmFuc2Zvcm0udmFsdWUuY29weShzLm1hdHJpeCkpfWZ1bmN0aW9uIGkoZSxpKXtlLnJvdWdobmVzcy52YWx1ZT1pLnJvdWdobmVzcyxlLm1ldGFsbmVzcy52YWx1ZT1pLm1ldGFsbmVzcyxpLnJvdWdobmVzc01hcCYmKGUucm91Z2huZXNzTWFwLnZhbHVlPWkucm91Z2huZXNzTWFwKSxpLm1ldGFsbmVzc01hcCYmKGUubWV0YWxuZXNzTWFwLnZhbHVlPWkubWV0YWxuZXNzTWFwKSxpLmVtaXNzaXZlTWFwJiYoZS5lbWlzc2l2ZU1hcC52YWx1ZT1pLmVtaXNzaXZlTWFwKSxpLmJ1bXBNYXAmJihlLmJ1bXBNYXAudmFsdWU9aS5idW1wTWFwLGUuYnVtcFNjYWxlLnZhbHVlPWkuYnVtcFNjYWxlLDE9PT1pLnNpZGUmJihlLmJ1bXBTY2FsZS52YWx1ZSo9LTEpKSxpLm5vcm1hbE1hcCYmKGUubm9ybWFsTWFwLnZhbHVlPWkubm9ybWFsTWFwLGUubm9ybWFsU2NhbGUudmFsdWUuY29weShpLm5vcm1hbFNjYWxlKSwxPT09aS5zaWRlJiZlLm5vcm1hbFNjYWxlLnZhbHVlLm5lZ2F0ZSgpKSxpLmRpc3BsYWNlbWVudE1hcCYmKGUuZGlzcGxhY2VtZW50TWFwLnZhbHVlPWkuZGlzcGxhY2VtZW50TWFwLGUuZGlzcGxhY2VtZW50U2NhbGUudmFsdWU9aS5kaXNwbGFjZW1lbnRTY2FsZSxlLmRpc3BsYWNlbWVudEJpYXMudmFsdWU9aS5kaXNwbGFjZW1lbnRCaWFzKTt0LmdldChpKS5lbnZNYXAmJihlLmVudk1hcEludGVuc2l0eS52YWx1ZT1pLmVudk1hcEludGVuc2l0eSl9cmV0dXJue3JlZnJlc2hGb2dVbmlmb3JtczpmdW5jdGlvbih0LGUpe3QuZm9nQ29sb3IudmFsdWUuY29weShlLmNvbG9yKSxlLmlzRm9nPyh0LmZvZ05lYXIudmFsdWU9ZS5uZWFyLHQuZm9nRmFyLnZhbHVlPWUuZmFyKTplLmlzRm9nRXhwMiYmKHQuZm9nRGVuc2l0eS52YWx1ZT1lLmRlbnNpdHkpfSxyZWZyZXNoTWF0ZXJpYWxVbmlmb3JtczpmdW5jdGlvbih0LG4scixzKXtuLmlzTWVzaEJhc2ljTWF0ZXJpYWw/ZSh0LG4pOm4uaXNNZXNoTGFtYmVydE1hdGVyaWFsPyhlKHQsbiksZnVuY3Rpb24odCxlKXtlLmVtaXNzaXZlTWFwJiYodC5lbWlzc2l2ZU1hcC52YWx1ZT1lLmVtaXNzaXZlTWFwKX0odCxuKSk6bi5pc01lc2hUb29uTWF0ZXJpYWw/KGUodCxuKSxmdW5jdGlvbih0LGUpe2UuZ3JhZGllbnRNYXAmJih0LmdyYWRpZW50TWFwLnZhbHVlPWUuZ3JhZGllbnRNYXApO2UuZW1pc3NpdmVNYXAmJih0LmVtaXNzaXZlTWFwLnZhbHVlPWUuZW1pc3NpdmVNYXApO2UuYnVtcE1hcCYmKHQuYnVtcE1hcC52YWx1ZT1lLmJ1bXBNYXAsdC5idW1wU2NhbGUudmFsdWU9ZS5idW1wU2NhbGUsMT09PWUuc2lkZSYmKHQuYnVtcFNjYWxlLnZhbHVlKj0tMSkpO2Uubm9ybWFsTWFwJiYodC5ub3JtYWxNYXAudmFsdWU9ZS5ub3JtYWxNYXAsdC5ub3JtYWxTY2FsZS52YWx1ZS5jb3B5KGUubm9ybWFsU2NhbGUpLDE9PT1lLnNpZGUmJnQubm9ybWFsU2NhbGUudmFsdWUubmVnYXRlKCkpO2UuZGlzcGxhY2VtZW50TWFwJiYodC5kaXNwbGFjZW1lbnRNYXAudmFsdWU9ZS5kaXNwbGFjZW1lbnRNYXAsdC5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZT1lLmRpc3BsYWNlbWVudFNjYWxlLHQuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZT1lLmRpc3BsYWNlbWVudEJpYXMpfSh0LG4pKTpuLmlzTWVzaFBob25nTWF0ZXJpYWw/KGUodCxuKSxmdW5jdGlvbih0LGUpe3Quc3BlY3VsYXIudmFsdWUuY29weShlLnNwZWN1bGFyKSx0LnNoaW5pbmVzcy52YWx1ZT1NYXRoLm1heChlLnNoaW5pbmVzcywxZS00KSxlLmVtaXNzaXZlTWFwJiYodC5lbWlzc2l2ZU1hcC52YWx1ZT1lLmVtaXNzaXZlTWFwKTtlLmJ1bXBNYXAmJih0LmJ1bXBNYXAudmFsdWU9ZS5idW1wTWFwLHQuYnVtcFNjYWxlLnZhbHVlPWUuYnVtcFNjYWxlLDE9PT1lLnNpZGUmJih0LmJ1bXBTY2FsZS52YWx1ZSo9LTEpKTtlLm5vcm1hbE1hcCYmKHQubm9ybWFsTWFwLnZhbHVlPWUubm9ybWFsTWFwLHQubm9ybWFsU2NhbGUudmFsdWUuY29weShlLm5vcm1hbFNjYWxlKSwxPT09ZS5zaWRlJiZ0Lm5vcm1hbFNjYWxlLnZhbHVlLm5lZ2F0ZSgpKTtlLmRpc3BsYWNlbWVudE1hcCYmKHQuZGlzcGxhY2VtZW50TWFwLnZhbHVlPWUuZGlzcGxhY2VtZW50TWFwLHQuZGlzcGxhY2VtZW50U2NhbGUudmFsdWU9ZS5kaXNwbGFjZW1lbnRTY2FsZSx0LmRpc3BsYWNlbWVudEJpYXMudmFsdWU9ZS5kaXNwbGFjZW1lbnRCaWFzKX0odCxuKSk6bi5pc01lc2hTdGFuZGFyZE1hdGVyaWFsPyhlKHQsbiksbi5pc01lc2hQaHlzaWNhbE1hdGVyaWFsP2Z1bmN0aW9uKHQsZSl7aSh0LGUpLHQucmVmbGVjdGl2aXR5LnZhbHVlPWUucmVmbGVjdGl2aXR5LHQuY2xlYXJjb2F0LnZhbHVlPWUuY2xlYXJjb2F0LHQuY2xlYXJjb2F0Um91Z2huZXNzLnZhbHVlPWUuY2xlYXJjb2F0Um91Z2huZXNzLGUuc2hlZW4mJnQuc2hlZW4udmFsdWUuY29weShlLnNoZWVuKTtlLmNsZWFyY29hdE1hcCYmKHQuY2xlYXJjb2F0TWFwLnZhbHVlPWUuY2xlYXJjb2F0TWFwKTtlLmNsZWFyY29hdFJvdWdobmVzc01hcCYmKHQuY2xlYXJjb2F0Um91Z2huZXNzTWFwLnZhbHVlPWUuY2xlYXJjb2F0Um91Z2huZXNzTWFwKTtlLmNsZWFyY29hdE5vcm1hbE1hcCYmKHQuY2xlYXJjb2F0Tm9ybWFsU2NhbGUudmFsdWUuY29weShlLmNsZWFyY29hdE5vcm1hbFNjYWxlKSx0LmNsZWFyY29hdE5vcm1hbE1hcC52YWx1ZT1lLmNsZWFyY29hdE5vcm1hbE1hcCwxPT09ZS5zaWRlJiZ0LmNsZWFyY29hdE5vcm1hbFNjYWxlLnZhbHVlLm5lZ2F0ZSgpKTt0LnRyYW5zbWlzc2lvbi52YWx1ZT1lLnRyYW5zbWlzc2lvbixlLnRyYW5zbWlzc2lvbk1hcCYmKHQudHJhbnNtaXNzaW9uTWFwLnZhbHVlPWUudHJhbnNtaXNzaW9uTWFwKX0odCxuKTppKHQsbikpOm4uaXNNZXNoTWF0Y2FwTWF0ZXJpYWw/KGUodCxuKSxmdW5jdGlvbih0LGUpe2UubWF0Y2FwJiYodC5tYXRjYXAudmFsdWU9ZS5tYXRjYXApO2UuYnVtcE1hcCYmKHQuYnVtcE1hcC52YWx1ZT1lLmJ1bXBNYXAsdC5idW1wU2NhbGUudmFsdWU9ZS5idW1wU2NhbGUsMT09PWUuc2lkZSYmKHQuYnVtcFNjYWxlLnZhbHVlKj0tMSkpO2Uubm9ybWFsTWFwJiYodC5ub3JtYWxNYXAudmFsdWU9ZS5ub3JtYWxNYXAsdC5ub3JtYWxTY2FsZS52YWx1ZS5jb3B5KGUubm9ybWFsU2NhbGUpLDE9PT1lLnNpZGUmJnQubm9ybWFsU2NhbGUudmFsdWUubmVnYXRlKCkpO2UuZGlzcGxhY2VtZW50TWFwJiYodC5kaXNwbGFjZW1lbnRNYXAudmFsdWU9ZS5kaXNwbGFjZW1lbnRNYXAsdC5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZT1lLmRpc3BsYWNlbWVudFNjYWxlLHQuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZT1lLmRpc3BsYWNlbWVudEJpYXMpfSh0LG4pKTpuLmlzTWVzaERlcHRoTWF0ZXJpYWw/KGUodCxuKSxmdW5jdGlvbih0LGUpe2UuZGlzcGxhY2VtZW50TWFwJiYodC5kaXNwbGFjZW1lbnRNYXAudmFsdWU9ZS5kaXNwbGFjZW1lbnRNYXAsdC5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZT1lLmRpc3BsYWNlbWVudFNjYWxlLHQuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZT1lLmRpc3BsYWNlbWVudEJpYXMpfSh0LG4pKTpuLmlzTWVzaERpc3RhbmNlTWF0ZXJpYWw/KGUodCxuKSxmdW5jdGlvbih0LGUpe2UuZGlzcGxhY2VtZW50TWFwJiYodC5kaXNwbGFjZW1lbnRNYXAudmFsdWU9ZS5kaXNwbGFjZW1lbnRNYXAsdC5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZT1lLmRpc3BsYWNlbWVudFNjYWxlLHQuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZT1lLmRpc3BsYWNlbWVudEJpYXMpO3QucmVmZXJlbmNlUG9zaXRpb24udmFsdWUuY29weShlLnJlZmVyZW5jZVBvc2l0aW9uKSx0Lm5lYXJEaXN0YW5jZS52YWx1ZT1lLm5lYXJEaXN0YW5jZSx0LmZhckRpc3RhbmNlLnZhbHVlPWUuZmFyRGlzdGFuY2V9KHQsbikpOm4uaXNNZXNoTm9ybWFsTWF0ZXJpYWw/KGUodCxuKSxmdW5jdGlvbih0LGUpe2UuYnVtcE1hcCYmKHQuYnVtcE1hcC52YWx1ZT1lLmJ1bXBNYXAsdC5idW1wU2NhbGUudmFsdWU9ZS5idW1wU2NhbGUsMT09PWUuc2lkZSYmKHQuYnVtcFNjYWxlLnZhbHVlKj0tMSkpO2Uubm9ybWFsTWFwJiYodC5ub3JtYWxNYXAudmFsdWU9ZS5ub3JtYWxNYXAsdC5ub3JtYWxTY2FsZS52YWx1ZS5jb3B5KGUubm9ybWFsU2NhbGUpLDE9PT1lLnNpZGUmJnQubm9ybWFsU2NhbGUudmFsdWUubmVnYXRlKCkpO2UuZGlzcGxhY2VtZW50TWFwJiYodC5kaXNwbGFjZW1lbnRNYXAudmFsdWU9ZS5kaXNwbGFjZW1lbnRNYXAsdC5kaXNwbGFjZW1lbnRTY2FsZS52YWx1ZT1lLmRpc3BsYWNlbWVudFNjYWxlLHQuZGlzcGxhY2VtZW50Qmlhcy52YWx1ZT1lLmRpc3BsYWNlbWVudEJpYXMpfSh0LG4pKTpuLmlzTGluZUJhc2ljTWF0ZXJpYWw/KGZ1bmN0aW9uKHQsZSl7dC5kaWZmdXNlLnZhbHVlLmNvcHkoZS5jb2xvciksdC5vcGFjaXR5LnZhbHVlPWUub3BhY2l0eX0odCxuKSxuLmlzTGluZURhc2hlZE1hdGVyaWFsJiZmdW5jdGlvbih0LGUpe3QuZGFzaFNpemUudmFsdWU9ZS5kYXNoU2l6ZSx0LnRvdGFsU2l6ZS52YWx1ZT1lLmRhc2hTaXplK2UuZ2FwU2l6ZSx0LnNjYWxlLnZhbHVlPWUuc2NhbGV9KHQsbikpOm4uaXNQb2ludHNNYXRlcmlhbD9mdW5jdGlvbih0LGUsaSxuKXt0LmRpZmZ1c2UudmFsdWUuY29weShlLmNvbG9yKSx0Lm9wYWNpdHkudmFsdWU9ZS5vcGFjaXR5LHQuc2l6ZS52YWx1ZT1lLnNpemUqaSx0LnNjYWxlLnZhbHVlPS41Km4sZS5tYXAmJih0Lm1hcC52YWx1ZT1lLm1hcCk7ZS5hbHBoYU1hcCYmKHQuYWxwaGFNYXAudmFsdWU9ZS5hbHBoYU1hcCk7bGV0IHI7ZS5tYXA/cj1lLm1hcDplLmFscGhhTWFwJiYocj1lLmFscGhhTWFwKTt2b2lkIDAhPT1yJiYoITA9PT1yLm1hdHJpeEF1dG9VcGRhdGUmJnIudXBkYXRlTWF0cml4KCksdC51dlRyYW5zZm9ybS52YWx1ZS5jb3B5KHIubWF0cml4KSl9KHQsbixyLHMpOm4uaXNTcHJpdGVNYXRlcmlhbD9mdW5jdGlvbih0LGUpe3QuZGlmZnVzZS52YWx1ZS5jb3B5KGUuY29sb3IpLHQub3BhY2l0eS52YWx1ZT1lLm9wYWNpdHksdC5yb3RhdGlvbi52YWx1ZT1lLnJvdGF0aW9uLGUubWFwJiYodC5tYXAudmFsdWU9ZS5tYXApO2UuYWxwaGFNYXAmJih0LmFscGhhTWFwLnZhbHVlPWUuYWxwaGFNYXApO2xldCBpO2UubWFwP2k9ZS5tYXA6ZS5hbHBoYU1hcCYmKGk9ZS5hbHBoYU1hcCk7dm9pZCAwIT09aSYmKCEwPT09aS5tYXRyaXhBdXRvVXBkYXRlJiZpLnVwZGF0ZU1hdHJpeCgpLHQudXZUcmFuc2Zvcm0udmFsdWUuY29weShpLm1hdHJpeCkpfSh0LG4pOm4uaXNTaGFkb3dNYXRlcmlhbD8odC5jb2xvci52YWx1ZS5jb3B5KG4uY29sb3IpLHQub3BhY2l0eS52YWx1ZT1uLm9wYWNpdHkpOm4uaXNTaGFkZXJNYXRlcmlhbCYmKG4udW5pZm9ybXNOZWVkVXBkYXRlPSExKX19fWZ1bmN0aW9uIEphKHQpe2NvbnN0IGU9dm9pZCAwIT09KHQ9dHx8e30pLmNhbnZhcz90LmNhbnZhczpmdW5jdGlvbigpe2NvbnN0IHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiLFwiY2FudmFzXCIpO3JldHVybiB0LnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiLHR9KCksaT12b2lkIDAhPT10LmNvbnRleHQ/dC5jb250ZXh0Om51bGwsbj12b2lkIDAhPT10LmFscGhhJiZ0LmFscGhhLHI9dm9pZCAwPT09dC5kZXB0aHx8dC5kZXB0aCxzPXZvaWQgMD09PXQuc3RlbmNpbHx8dC5zdGVuY2lsLG89dm9pZCAwIT09dC5hbnRpYWxpYXMmJnQuYW50aWFsaWFzLGE9dm9pZCAwPT09dC5wcmVtdWx0aXBsaWVkQWxwaGF8fHQucHJlbXVsdGlwbGllZEFscGhhLGM9dm9pZCAwIT09dC5wcmVzZXJ2ZURyYXdpbmdCdWZmZXImJnQucHJlc2VydmVEcmF3aW5nQnVmZmVyLGg9dm9pZCAwIT09dC5wb3dlclByZWZlcmVuY2U/dC5wb3dlclByZWZlcmVuY2U6XCJkZWZhdWx0XCIsbD12b2lkIDAhPT10LmZhaWxJZk1ham9yUGVyZm9ybWFuY2VDYXZlYXQmJnQuZmFpbElmTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDtsZXQgdT1udWxsLGQ9bnVsbDtjb25zdCBwPVtdO3RoaXMuZG9tRWxlbWVudD1lLHRoaXMuZGVidWc9e2NoZWNrU2hhZGVyRXJyb3JzOiEwfSx0aGlzLmF1dG9DbGVhcj0hMCx0aGlzLmF1dG9DbGVhckNvbG9yPSEwLHRoaXMuYXV0b0NsZWFyRGVwdGg9ITAsdGhpcy5hdXRvQ2xlYXJTdGVuY2lsPSEwLHRoaXMuc29ydE9iamVjdHM9ITAsdGhpcy5jbGlwcGluZ1BsYW5lcz1bXSx0aGlzLmxvY2FsQ2xpcHBpbmdFbmFibGVkPSExLHRoaXMuZ2FtbWFGYWN0b3I9Mix0aGlzLm91dHB1dEVuY29kaW5nPVhpLHRoaXMucGh5c2ljYWxseUNvcnJlY3RMaWdodHM9ITEsdGhpcy50b25lTWFwcGluZz0wLHRoaXMudG9uZU1hcHBpbmdFeHBvc3VyZT0xLHRoaXMubWF4TW9ycGhUYXJnZXRzPTgsdGhpcy5tYXhNb3JwaE5vcm1hbHM9NDtjb25zdCBmPXRoaXM7bGV0IG09ITEsZz1udWxsLF89MCx2PTAseT1udWxsLGI9bnVsbCx4PS0xLHc9bnVsbDtjb25zdCBTPW5ldyB1bixNPW5ldyB1bjtsZXQgVD1udWxsLEM9ZS53aWR0aCxFPWUuaGVpZ2h0LEk9MSxBPW51bGwsUD1udWxsO2NvbnN0IFI9bmV3IHVuKDAsMCxDLEUpLEw9bmV3IHVuKDAsMCxDLEUpO2xldCBPPSExO2NvbnN0IE49bmV3IFVzO2xldCBEPSExLCQ9ITE7Y29uc3Qgaz1uZXcgSG4sej1uZXcgZm4sRj17YmFja2dyb3VuZDpudWxsLGZvZzpudWxsLGVudmlyb25tZW50Om51bGwsb3ZlcnJpZGVNYXRlcmlhbDpudWxsLGlzU2NlbmU6ITB9O2Z1bmN0aW9uIEIoKXtyZXR1cm4gbnVsbD09PXk/SToxfWxldCBqLEgsVSxWLEcscSxXLFgsWSxaLEosSyxRLHR0LGV0LGl0LG50LHJ0LHN0LG90LGF0LGN0PWk7ZnVuY3Rpb24gaHQodCxpKXtmb3IobGV0IG49MDtuPHQubGVuZ3RoO24rKyl7Y29uc3Qgcj10W25dLHM9ZS5nZXRDb250ZXh0KHIsaSk7aWYobnVsbCE9PXMpcmV0dXJuIHN9cmV0dXJuIG51bGx9dHJ5e2NvbnN0IHQ9e2FscGhhOm4sZGVwdGg6cixzdGVuY2lsOnMsYW50aWFsaWFzOm8scHJlbXVsdGlwbGllZEFscGhhOmEscHJlc2VydmVEcmF3aW5nQnVmZmVyOmMscG93ZXJQcmVmZXJlbmNlOmgsZmFpbElmTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDpsfTtpZihlLmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJnbGNvbnRleHRsb3N0XCIscHQsITEpLGUuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmdsY29udGV4dHJlc3RvcmVkXCIsZnQsITEpLG51bGw9PT1jdCl7Y29uc3QgZT1bXCJ3ZWJnbDJcIixcIndlYmdsXCIsXCJleHBlcmltZW50YWwtd2ViZ2xcIl07aWYoITA9PT1mLmlzV2ViR0wxUmVuZGVyZXImJmUuc2hpZnQoKSxjdD1odChlLHQpLG51bGw9PT1jdCl0aHJvdyBodChlKT9uZXcgRXJyb3IoXCJFcnJvciBjcmVhdGluZyBXZWJHTCBjb250ZXh0IHdpdGggeW91ciBzZWxlY3RlZCBhdHRyaWJ1dGVzLlwiKTpuZXcgRXJyb3IoXCJFcnJvciBjcmVhdGluZyBXZWJHTCBjb250ZXh0LlwiKX12b2lkIDA9PT1jdC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQmJihjdC5nZXRTaGFkZXJQcmVjaXNpb25Gb3JtYXQ9ZnVuY3Rpb24oKXtyZXR1cm57cmFuZ2VNaW46MSxyYW5nZU1heDoxLHByZWNpc2lvbjoxfX0pfWNhdGNoKHQpe3Rocm93IGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBcIit0Lm1lc3NhZ2UpLHR9ZnVuY3Rpb24gbHQoKXtqPW5ldyBpbyhjdCksSD1uZXcgUXMoY3Qsaix0KSxqLmluaXQoSCksb3Q9bmV3IEdhKGN0LGosSCksVT1uZXcgVWEoY3QsaixIKSxVLnNjaXNzb3IoTS5jb3B5KEwpLm11bHRpcGx5U2NhbGFyKEkpLmZsb29yKCkpLFUudmlld3BvcnQoUy5jb3B5KFIpLm11bHRpcGx5U2NhbGFyKEkpLmZsb29yKCkpLFY9bmV3IHNvKGN0KSxHPW5ldyBBYSxxPW5ldyBWYShjdCxqLFUsRyxILG90LFYpLFc9bmV3IGVvKGYpLFg9bmV3IEdzKGN0LEgpLGF0PW5ldyBKcyhjdCxqLFgsSCksWT1uZXcgbm8oY3QsWCxWLGF0KSxaPW5ldyBobyhjdCxZLFgsViksbnQ9bmV3IGNvKGN0KSxldD1uZXcgdG8oRyksSj1uZXcgSWEoZixXLGosSCxhdCxldCksSz1uZXcgWmEoRyksUT1uZXcgT2EoRyksdHQ9bmV3IEZhKGosSCksaXQ9bmV3IFpzKGYsVyxVLFosYSkscnQ9bmV3IEtzKGN0LGosVixIKSxzdD1uZXcgcm8oY3QsaixWLEgpLFYucHJvZ3JhbXM9Si5wcm9ncmFtcyxmLmNhcGFiaWxpdGllcz1ILGYuZXh0ZW5zaW9ucz1qLGYucHJvcGVydGllcz1HLGYucmVuZGVyTGlzdHM9USxmLnN0YXRlPVUsZi5pbmZvPVZ9bHQoKTtjb25zdCB1dD1uZXcgWWEoZixjdCk7dGhpcy54cj11dDtjb25zdCBkdD1uZXcgSGEoZixaLEgubWF4VGV4dHVyZVNpemUpO2Z1bmN0aW9uIHB0KHQpe3QucHJldmVudERlZmF1bHQoKSxjb25zb2xlLmxvZyhcIlRIUkVFLldlYkdMUmVuZGVyZXI6IENvbnRleHQgTG9zdC5cIiksbT0hMH1mdW5jdGlvbiBmdCgpe2NvbnNvbGUubG9nKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogQ29udGV4dCBSZXN0b3JlZC5cIiksbT0hMSxsdCgpfWZ1bmN0aW9uIG10KHQpe2NvbnN0IGU9dC50YXJnZXQ7ZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiZGlzcG9zZVwiLG10KSxmdW5jdGlvbih0KXtndCh0KSxHLnJlbW92ZSh0KX0oZSl9ZnVuY3Rpb24gZ3QodCl7Y29uc3QgZT1HLmdldCh0KS5wcm9ncmFtO3ZvaWQgMCE9PWUmJkoucmVsZWFzZVByb2dyYW0oZSl9dGhpcy5zaGFkb3dNYXA9ZHQsdGhpcy5nZXRDb250ZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIGN0fSx0aGlzLmdldENvbnRleHRBdHRyaWJ1dGVzPWZ1bmN0aW9uKCl7cmV0dXJuIGN0LmdldENvbnRleHRBdHRyaWJ1dGVzKCl9LHRoaXMuZm9yY2VDb250ZXh0TG9zcz1mdW5jdGlvbigpe2NvbnN0IHQ9ai5nZXQoXCJXRUJHTF9sb3NlX2NvbnRleHRcIik7dCYmdC5sb3NlQ29udGV4dCgpfSx0aGlzLmZvcmNlQ29udGV4dFJlc3RvcmU9ZnVuY3Rpb24oKXtjb25zdCB0PWouZ2V0KFwiV0VCR0xfbG9zZV9jb250ZXh0XCIpO3QmJnQucmVzdG9yZUNvbnRleHQoKX0sdGhpcy5nZXRQaXhlbFJhdGlvPWZ1bmN0aW9uKCl7cmV0dXJuIEl9LHRoaXMuc2V0UGl4ZWxSYXRpbz1mdW5jdGlvbih0KXt2b2lkIDAhPT10JiYoST10LHRoaXMuc2V0U2l6ZShDLEUsITEpKX0sdGhpcy5nZXRTaXplPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiV2ViR0xSZW5kZXJlcjogLmdldHNpemUoKSBub3cgcmVxdWlyZXMgYSBWZWN0b3IyIGFzIGFuIGFyZ3VtZW50XCIpLHQ9bmV3IHJuKSx0LnNldChDLEUpfSx0aGlzLnNldFNpemU9ZnVuY3Rpb24odCxpLG4pe3V0LmlzUHJlc2VudGluZz9jb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiBDYW4ndCBjaGFuZ2Ugc2l6ZSB3aGlsZSBWUiBkZXZpY2UgaXMgcHJlc2VudGluZy5cIik6KEM9dCxFPWksZS53aWR0aD1NYXRoLmZsb29yKHQqSSksZS5oZWlnaHQ9TWF0aC5mbG9vcihpKkkpLCExIT09biYmKGUuc3R5bGUud2lkdGg9dCtcInB4XCIsZS5zdHlsZS5oZWlnaHQ9aStcInB4XCIpLHRoaXMuc2V0Vmlld3BvcnQoMCwwLHQsaSkpfSx0aGlzLmdldERyYXdpbmdCdWZmZXJTaXplPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiV2ViR0xSZW5kZXJlcjogLmdldGRyYXdpbmdCdWZmZXJTaXplKCkgbm93IHJlcXVpcmVzIGEgVmVjdG9yMiBhcyBhbiBhcmd1bWVudFwiKSx0PW5ldyBybiksdC5zZXQoQypJLEUqSSkuZmxvb3IoKX0sdGhpcy5zZXREcmF3aW5nQnVmZmVyU2l6ZT1mdW5jdGlvbih0LGksbil7Qz10LEU9aSxJPW4sZS53aWR0aD1NYXRoLmZsb29yKHQqbiksZS5oZWlnaHQ9TWF0aC5mbG9vcihpKm4pLHRoaXMuc2V0Vmlld3BvcnQoMCwwLHQsaSl9LHRoaXMuZ2V0Q3VycmVudFZpZXdwb3J0PWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiV2ViR0xSZW5kZXJlcjogLmdldEN1cnJlbnRWaWV3cG9ydCgpIG5vdyByZXF1aXJlcyBhIFZlY3RvcjQgYXMgYW4gYXJndW1lbnRcIiksdD1uZXcgdW4pLHQuY29weShTKX0sdGhpcy5nZXRWaWV3cG9ydD1mdW5jdGlvbih0KXtyZXR1cm4gdC5jb3B5KFIpfSx0aGlzLnNldFZpZXdwb3J0PWZ1bmN0aW9uKHQsZSxpLG4pe3QuaXNWZWN0b3I0P1Iuc2V0KHQueCx0LnksdC56LHQudyk6Ui5zZXQodCxlLGksbiksVS52aWV3cG9ydChTLmNvcHkoUikubXVsdGlwbHlTY2FsYXIoSSkuZmxvb3IoKSl9LHRoaXMuZ2V0U2Npc3Nvcj1mdW5jdGlvbih0KXtyZXR1cm4gdC5jb3B5KEwpfSx0aGlzLnNldFNjaXNzb3I9ZnVuY3Rpb24odCxlLGksbil7dC5pc1ZlY3RvcjQ/TC5zZXQodC54LHQueSx0LnosdC53KTpMLnNldCh0LGUsaSxuKSxVLnNjaXNzb3IoTS5jb3B5KEwpLm11bHRpcGx5U2NhbGFyKEkpLmZsb29yKCkpfSx0aGlzLmdldFNjaXNzb3JUZXN0PWZ1bmN0aW9uKCl7cmV0dXJuIE99LHRoaXMuc2V0U2Npc3NvclRlc3Q9ZnVuY3Rpb24odCl7VS5zZXRTY2lzc29yVGVzdChPPXQpfSx0aGlzLnNldE9wYXF1ZVNvcnQ9ZnVuY3Rpb24odCl7QT10fSx0aGlzLnNldFRyYW5zcGFyZW50U29ydD1mdW5jdGlvbih0KXtQPXR9LHRoaXMuZ2V0Q2xlYXJDb2xvcj1mdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwPT09dCYmKGNvbnNvbGUud2FybihcIldlYkdMUmVuZGVyZXI6IC5nZXRDbGVhckNvbG9yKCkgbm93IHJlcXVpcmVzIGEgQ29sb3IgYXMgYW4gYXJndW1lbnRcIiksdD1uZXcgRHIpLHQuY29weShpdC5nZXRDbGVhckNvbG9yKCkpfSx0aGlzLnNldENsZWFyQ29sb3I9ZnVuY3Rpb24oKXtpdC5zZXRDbGVhckNvbG9yLmFwcGx5KGl0LGFyZ3VtZW50cyl9LHRoaXMuZ2V0Q2xlYXJBbHBoYT1mdW5jdGlvbigpe3JldHVybiBpdC5nZXRDbGVhckFscGhhKCl9LHRoaXMuc2V0Q2xlYXJBbHBoYT1mdW5jdGlvbigpe2l0LnNldENsZWFyQWxwaGEuYXBwbHkoaXQsYXJndW1lbnRzKX0sdGhpcy5jbGVhcj1mdW5jdGlvbih0LGUsaSl7bGV0IG49MDsodm9pZCAwPT09dHx8dCkmJihufD0xNjM4NCksKHZvaWQgMD09PWV8fGUpJiYobnw9MjU2KSwodm9pZCAwPT09aXx8aSkmJihufD0xMDI0KSxjdC5jbGVhcihuKX0sdGhpcy5jbGVhckNvbG9yPWZ1bmN0aW9uKCl7dGhpcy5jbGVhcighMCwhMSwhMSl9LHRoaXMuY2xlYXJEZXB0aD1mdW5jdGlvbigpe3RoaXMuY2xlYXIoITEsITAsITEpfSx0aGlzLmNsZWFyU3RlbmNpbD1mdW5jdGlvbigpe3RoaXMuY2xlYXIoITEsITEsITApfSx0aGlzLmRpc3Bvc2U9ZnVuY3Rpb24oKXtlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3ZWJnbGNvbnRleHRsb3N0XCIscHQsITEpLGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndlYmdsY29udGV4dHJlc3RvcmVkXCIsZnQsITEpLFEuZGlzcG9zZSgpLHR0LmRpc3Bvc2UoKSxHLmRpc3Bvc2UoKSxXLmRpc3Bvc2UoKSxaLmRpc3Bvc2UoKSxhdC5kaXNwb3NlKCksdXQuZGlzcG9zZSgpLHZ0LnN0b3AoKX0sdGhpcy5yZW5kZXJCdWZmZXJJbW1lZGlhdGU9ZnVuY3Rpb24odCxlKXthdC5pbml0QXR0cmlidXRlcygpO2NvbnN0IGk9Ry5nZXQodCk7dC5oYXNQb3NpdGlvbnMmJiFpLnBvc2l0aW9uJiYoaS5wb3NpdGlvbj1jdC5jcmVhdGVCdWZmZXIoKSksdC5oYXNOb3JtYWxzJiYhaS5ub3JtYWwmJihpLm5vcm1hbD1jdC5jcmVhdGVCdWZmZXIoKSksdC5oYXNVdnMmJiFpLnV2JiYoaS51dj1jdC5jcmVhdGVCdWZmZXIoKSksdC5oYXNDb2xvcnMmJiFpLmNvbG9yJiYoaS5jb2xvcj1jdC5jcmVhdGVCdWZmZXIoKSk7Y29uc3Qgbj1lLmdldEF0dHJpYnV0ZXMoKTt0Lmhhc1Bvc2l0aW9ucyYmKGN0LmJpbmRCdWZmZXIoMzQ5NjIsaS5wb3NpdGlvbiksY3QuYnVmZmVyRGF0YSgzNDk2Mix0LnBvc2l0aW9uQXJyYXksMzUwNDgpLGF0LmVuYWJsZUF0dHJpYnV0ZShuLnBvc2l0aW9uKSxjdC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG4ucG9zaXRpb24sMyw1MTI2LCExLDAsMCkpLHQuaGFzTm9ybWFscyYmKGN0LmJpbmRCdWZmZXIoMzQ5NjIsaS5ub3JtYWwpLGN0LmJ1ZmZlckRhdGEoMzQ5NjIsdC5ub3JtYWxBcnJheSwzNTA0OCksYXQuZW5hYmxlQXR0cmlidXRlKG4ubm9ybWFsKSxjdC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG4ubm9ybWFsLDMsNTEyNiwhMSwwLDApKSx0Lmhhc1V2cyYmKGN0LmJpbmRCdWZmZXIoMzQ5NjIsaS51diksY3QuYnVmZmVyRGF0YSgzNDk2Mix0LnV2QXJyYXksMzUwNDgpLGF0LmVuYWJsZUF0dHJpYnV0ZShuLnV2KSxjdC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG4udXYsMiw1MTI2LCExLDAsMCkpLHQuaGFzQ29sb3JzJiYoY3QuYmluZEJ1ZmZlcigzNDk2MixpLmNvbG9yKSxjdC5idWZmZXJEYXRhKDM0OTYyLHQuY29sb3JBcnJheSwzNTA0OCksYXQuZW5hYmxlQXR0cmlidXRlKG4uY29sb3IpLGN0LnZlcnRleEF0dHJpYlBvaW50ZXIobi5jb2xvciwzLDUxMjYsITEsMCwwKSksYXQuZGlzYWJsZVVudXNlZEF0dHJpYnV0ZXMoKSxjdC5kcmF3QXJyYXlzKDQsMCx0LmNvdW50KSx0LmNvdW50PTB9LHRoaXMucmVuZGVyQnVmZmVyRGlyZWN0PWZ1bmN0aW9uKHQsZSxpLG4scixzKXtudWxsPT09ZSYmKGU9Rik7Y29uc3Qgbz1yLmlzTWVzaCYmci5tYXRyaXhXb3JsZC5kZXRlcm1pbmFudCgpPDAsYT1TdCh0LGUsbixyKTtVLnNldE1hdGVyaWFsKG4sbyk7bGV0IGM9aS5pbmRleDtjb25zdCBoPWkuYXR0cmlidXRlcy5wb3NpdGlvbjtpZihudWxsPT09Yyl7aWYodm9pZCAwPT09aHx8MD09PWguY291bnQpcmV0dXJufWVsc2UgaWYoMD09PWMuY291bnQpcmV0dXJuO2xldCBsLHU9MTshMD09PW4ud2lyZWZyYW1lJiYoYz1ZLmdldFdpcmVmcmFtZUF0dHJpYnV0ZShpKSx1PTIpLChuLm1vcnBoVGFyZ2V0c3x8bi5tb3JwaE5vcm1hbHMpJiZudC51cGRhdGUocixpLG4sYSksYXQuc2V0dXAocixuLGEsaSxjKTtsZXQgZD1ydDtudWxsIT09YyYmKGw9WC5nZXQoYyksZD1zdCxkLnNldEluZGV4KGwpKTtjb25zdCBwPW51bGwhPT1jP2MuY291bnQ6aC5jb3VudCxmPWkuZHJhd1JhbmdlLnN0YXJ0KnUsbT1pLmRyYXdSYW5nZS5jb3VudCp1LGc9bnVsbCE9PXM/cy5zdGFydCp1OjAsXz1udWxsIT09cz9zLmNvdW50KnU6MS8wLHY9TWF0aC5tYXgoZixnKSx5PU1hdGgubWluKHAsZittLGcrXyktMSxiPU1hdGgubWF4KDAseS12KzEpO2lmKDAhPT1iKXtpZihyLmlzTWVzaCkhMD09PW4ud2lyZWZyYW1lPyhVLnNldExpbmVXaWR0aChuLndpcmVmcmFtZUxpbmV3aWR0aCpCKCkpLGQuc2V0TW9kZSgxKSk6ZC5zZXRNb2RlKDQpO2Vsc2UgaWYoci5pc0xpbmUpe2xldCB0PW4ubGluZXdpZHRoO3ZvaWQgMD09PXQmJih0PTEpLFUuc2V0TGluZVdpZHRoKHQqQigpKSxyLmlzTGluZVNlZ21lbnRzP2Quc2V0TW9kZSgxKTpyLmlzTGluZUxvb3A/ZC5zZXRNb2RlKDIpOmQuc2V0TW9kZSgzKX1lbHNlIHIuaXNQb2ludHM/ZC5zZXRNb2RlKDApOnIuaXNTcHJpdGUmJmQuc2V0TW9kZSg0KTtpZihyLmlzSW5zdGFuY2VkTWVzaClkLnJlbmRlckluc3RhbmNlcyh2LGIsci5jb3VudCk7ZWxzZSBpZihpLmlzSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnkpe2NvbnN0IHQ9TWF0aC5taW4oaS5pbnN0YW5jZUNvdW50LGkuX21heEluc3RhbmNlQ291bnQpO2QucmVuZGVySW5zdGFuY2VzKHYsYix0KX1lbHNlIGQucmVuZGVyKHYsYil9fSx0aGlzLmNvbXBpbGU9ZnVuY3Rpb24odCxlKXtkPXR0LmdldCh0KSxkLmluaXQoKSx0LnRyYXZlcnNlVmlzaWJsZSgoZnVuY3Rpb24odCl7dC5pc0xpZ2h0JiZ0LmxheWVycy50ZXN0KGUubGF5ZXJzKSYmKGQucHVzaExpZ2h0KHQpLHQuY2FzdFNoYWRvdyYmZC5wdXNoU2hhZG93KHQpKX0pKSxkLnNldHVwTGlnaHRzKCk7Y29uc3QgaT1uZXcgV2Vha01hcDt0LnRyYXZlcnNlKChmdW5jdGlvbihlKXtjb25zdCBuPWUubWF0ZXJpYWw7aWYobilpZihBcnJheS5pc0FycmF5KG4pKWZvcihsZXQgcj0wO3I8bi5sZW5ndGg7cisrKXtjb25zdCBzPW5bcl07ITE9PT1pLmhhcyhzKSYmKHd0KHMsdCxlKSxpLnNldChzKSl9ZWxzZSExPT09aS5oYXMobikmJih3dChuLHQsZSksaS5zZXQobikpfSkpfTtsZXQgX3Q9bnVsbDtjb25zdCB2dD1uZXcgVnM7ZnVuY3Rpb24geXQodCxlLGksbil7aWYoITE9PT10LnZpc2libGUpcmV0dXJuO2lmKHQubGF5ZXJzLnRlc3QoZS5sYXllcnMpKWlmKHQuaXNHcm91cClpPXQucmVuZGVyT3JkZXI7ZWxzZSBpZih0LmlzTE9EKSEwPT09dC5hdXRvVXBkYXRlJiZ0LnVwZGF0ZShlKTtlbHNlIGlmKHQuaXNMaWdodClkLnB1c2hMaWdodCh0KSx0LmNhc3RTaGFkb3cmJmQucHVzaFNoYWRvdyh0KTtlbHNlIGlmKHQuaXNTcHJpdGUpe2lmKCF0LmZydXN0dW1DdWxsZWR8fE4uaW50ZXJzZWN0c1Nwcml0ZSh0KSl7biYmei5zZXRGcm9tTWF0cml4UG9zaXRpb24odC5tYXRyaXhXb3JsZCkuYXBwbHlNYXRyaXg0KGspO2NvbnN0IGU9Wi51cGRhdGUodCkscj10Lm1hdGVyaWFsO3IudmlzaWJsZSYmdS5wdXNoKHQsZSxyLGksei56LG51bGwpfX1lbHNlIGlmKHQuaXNJbW1lZGlhdGVSZW5kZXJPYmplY3QpbiYmei5zZXRGcm9tTWF0cml4UG9zaXRpb24odC5tYXRyaXhXb3JsZCkuYXBwbHlNYXRyaXg0KGspLHUucHVzaCh0LG51bGwsdC5tYXRlcmlhbCxpLHoueixudWxsKTtlbHNlIGlmKCh0LmlzTWVzaHx8dC5pc0xpbmV8fHQuaXNQb2ludHMpJiYodC5pc1NraW5uZWRNZXNoJiZ0LnNrZWxldG9uLmZyYW1lIT09Vi5yZW5kZXIuZnJhbWUmJih0LnNrZWxldG9uLnVwZGF0ZSgpLHQuc2tlbGV0b24uZnJhbWU9Vi5yZW5kZXIuZnJhbWUpLCF0LmZydXN0dW1DdWxsZWR8fE4uaW50ZXJzZWN0c09iamVjdCh0KSkpe24mJnouc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHQubWF0cml4V29ybGQpLmFwcGx5TWF0cml4NChrKTtjb25zdCBlPVoudXBkYXRlKHQpLHI9dC5tYXRlcmlhbDtpZihBcnJheS5pc0FycmF5KHIpKXtjb25zdCBuPWUuZ3JvdXBzO2ZvcihsZXQgcz0wLG89bi5sZW5ndGg7czxvO3MrKyl7Y29uc3Qgbz1uW3NdLGE9cltvLm1hdGVyaWFsSW5kZXhdO2EmJmEudmlzaWJsZSYmdS5wdXNoKHQsZSxhLGksei56LG8pfX1lbHNlIHIudmlzaWJsZSYmdS5wdXNoKHQsZSxyLGksei56LG51bGwpfWNvbnN0IHI9dC5jaGlsZHJlbjtmb3IobGV0IHQ9MCxzPXIubGVuZ3RoO3Q8czt0KyspeXQoclt0XSxlLGksbil9ZnVuY3Rpb24gYnQodCxlLGkpe2NvbnN0IG49ITA9PT1lLmlzU2NlbmU/ZS5vdmVycmlkZU1hdGVyaWFsOm51bGw7Zm9yKGxldCByPTAscz10Lmxlbmd0aDtyPHM7cisrKXtjb25zdCBzPXRbcl0sbz1zLm9iamVjdCxhPXMuZ2VvbWV0cnksYz1udWxsPT09bj9zLm1hdGVyaWFsOm4saD1zLmdyb3VwO2lmKGkuaXNBcnJheUNhbWVyYSl7Y29uc3QgdD1pLmNhbWVyYXM7Zm9yKGxldCBpPTAsbj10Lmxlbmd0aDtpPG47aSsrKXtjb25zdCBuPXRbaV07by5sYXllcnMudGVzdChuLmxheWVycykmJihVLnZpZXdwb3J0KFMuY29weShuLnZpZXdwb3J0KSksZC5zZXR1cExpZ2h0c1ZpZXcobikseHQobyxlLG4sYSxjLGgpKX19ZWxzZSB4dChvLGUsaSxhLGMsaCl9fWZ1bmN0aW9uIHh0KHQsZSxpLG4scixzKXtpZih0Lm9uQmVmb3JlUmVuZGVyKGYsZSxpLG4scixzKSx0Lm1vZGVsVmlld01hdHJpeC5tdWx0aXBseU1hdHJpY2VzKGkubWF0cml4V29ybGRJbnZlcnNlLHQubWF0cml4V29ybGQpLHQubm9ybWFsTWF0cml4LmdldE5vcm1hbE1hdHJpeCh0Lm1vZGVsVmlld01hdHJpeCksdC5pc0ltbWVkaWF0ZVJlbmRlck9iamVjdCl7Y29uc3Qgbj1TdChpLGUscix0KTtVLnNldE1hdGVyaWFsKHIpLGF0LnJlc2V0KCksZnVuY3Rpb24odCxlKXt0LnJlbmRlcigoZnVuY3Rpb24odCl7Zi5yZW5kZXJCdWZmZXJJbW1lZGlhdGUodCxlKX0pKX0odCxuKX1lbHNlIGYucmVuZGVyQnVmZmVyRGlyZWN0KGksZSxuLHIsdCxzKTt0Lm9uQWZ0ZXJSZW5kZXIoZixlLGksbixyLHMpfWZ1bmN0aW9uIHd0KHQsZSxpKXshMCE9PWUuaXNTY2VuZSYmKGU9Rik7Y29uc3Qgbj1HLmdldCh0KSxyPWQuc3RhdGUubGlnaHRzLHM9ZC5zdGF0ZS5zaGFkb3dzQXJyYXksbz1yLnN0YXRlLnZlcnNpb24sYT1KLmdldFBhcmFtZXRlcnModCxyLnN0YXRlLHMsZSxpKSxjPUouZ2V0UHJvZ3JhbUNhY2hlS2V5KGEpO2xldCBoPW4ucHJvZ3JhbSxsPSEwO2lmKG4uZW52aXJvbm1lbnQ9dC5pc01lc2hTdGFuZGFyZE1hdGVyaWFsP2UuZW52aXJvbm1lbnQ6bnVsbCxuLmZvZz1lLmZvZyxuLmVudk1hcD1XLmdldCh0LmVudk1hcHx8bi5lbnZpcm9ubWVudCksdm9pZCAwPT09aCl0LmFkZEV2ZW50TGlzdGVuZXIoXCJkaXNwb3NlXCIsbXQpO2Vsc2UgaWYoaC5jYWNoZUtleSE9PWMpZ3QodCk7ZWxzZSBpZihuLmxpZ2h0c1N0YXRlVmVyc2lvbiE9PW8pbD0hMTtlbHNle2lmKHZvaWQgMCE9PWEuc2hhZGVySUQpcmV0dXJuO2w9ITF9bCYmKGEudW5pZm9ybXM9Si5nZXRVbmlmb3Jtcyh0KSx0Lm9uQmVmb3JlQ29tcGlsZShhLGYpLGg9Si5hY3F1aXJlUHJvZ3JhbShhLGMpLG4ucHJvZ3JhbT1oLG4udW5pZm9ybXM9YS51bmlmb3JtcyxuLm91dHB1dEVuY29kaW5nPWEub3V0cHV0RW5jb2RpbmcpO2NvbnN0IHU9bi51bmlmb3JtczsodC5pc1NoYWRlck1hdGVyaWFsfHx0LmlzUmF3U2hhZGVyTWF0ZXJpYWwpJiYhMCE9PXQuY2xpcHBpbmd8fChuLm51bUNsaXBwaW5nUGxhbmVzPWV0Lm51bVBsYW5lcyxuLm51bUludGVyc2VjdGlvbj1ldC5udW1JbnRlcnNlY3Rpb24sdS5jbGlwcGluZ1BsYW5lcz1ldC51bmlmb3JtKSxuLm5lZWRzTGlnaHRzPWZ1bmN0aW9uKHQpe3JldHVybiB0LmlzTWVzaExhbWJlcnRNYXRlcmlhbHx8dC5pc01lc2hUb29uTWF0ZXJpYWx8fHQuaXNNZXNoUGhvbmdNYXRlcmlhbHx8dC5pc01lc2hTdGFuZGFyZE1hdGVyaWFsfHx0LmlzU2hhZG93TWF0ZXJpYWx8fHQuaXNTaGFkZXJNYXRlcmlhbCYmITA9PT10LmxpZ2h0c30odCksbi5saWdodHNTdGF0ZVZlcnNpb249byxuLm5lZWRzTGlnaHRzJiYodS5hbWJpZW50TGlnaHRDb2xvci52YWx1ZT1yLnN0YXRlLmFtYmllbnQsdS5saWdodFByb2JlLnZhbHVlPXIuc3RhdGUucHJvYmUsdS5kaXJlY3Rpb25hbExpZ2h0cy52YWx1ZT1yLnN0YXRlLmRpcmVjdGlvbmFsLHUuZGlyZWN0aW9uYWxMaWdodFNoYWRvd3MudmFsdWU9ci5zdGF0ZS5kaXJlY3Rpb25hbFNoYWRvdyx1LnNwb3RMaWdodHMudmFsdWU9ci5zdGF0ZS5zcG90LHUuc3BvdExpZ2h0U2hhZG93cy52YWx1ZT1yLnN0YXRlLnNwb3RTaGFkb3csdS5yZWN0QXJlYUxpZ2h0cy52YWx1ZT1yLnN0YXRlLnJlY3RBcmVhLHUubHRjXzEudmFsdWU9ci5zdGF0ZS5yZWN0QXJlYUxUQzEsdS5sdGNfMi52YWx1ZT1yLnN0YXRlLnJlY3RBcmVhTFRDMix1LnBvaW50TGlnaHRzLnZhbHVlPXIuc3RhdGUucG9pbnQsdS5wb2ludExpZ2h0U2hhZG93cy52YWx1ZT1yLnN0YXRlLnBvaW50U2hhZG93LHUuaGVtaXNwaGVyZUxpZ2h0cy52YWx1ZT1yLnN0YXRlLmhlbWksdS5kaXJlY3Rpb25hbFNoYWRvd01hcC52YWx1ZT1yLnN0YXRlLmRpcmVjdGlvbmFsU2hhZG93TWFwLHUuZGlyZWN0aW9uYWxTaGFkb3dNYXRyaXgudmFsdWU9ci5zdGF0ZS5kaXJlY3Rpb25hbFNoYWRvd01hdHJpeCx1LnNwb3RTaGFkb3dNYXAudmFsdWU9ci5zdGF0ZS5zcG90U2hhZG93TWFwLHUuc3BvdFNoYWRvd01hdHJpeC52YWx1ZT1yLnN0YXRlLnNwb3RTaGFkb3dNYXRyaXgsdS5wb2ludFNoYWRvd01hcC52YWx1ZT1yLnN0YXRlLnBvaW50U2hhZG93TWFwLHUucG9pbnRTaGFkb3dNYXRyaXgudmFsdWU9ci5zdGF0ZS5wb2ludFNoYWRvd01hdHJpeCk7Y29uc3QgcD1uLnByb2dyYW0uZ2V0VW5pZm9ybXMoKSxtPWFhLnNlcVdpdGhWYWx1ZShwLnNlcSx1KTtuLnVuaWZvcm1zTGlzdD1tfWZ1bmN0aW9uIFN0KHQsZSxpLG4peyEwIT09ZS5pc1NjZW5lJiYoZT1GKSxxLnJlc2V0VGV4dHVyZVVuaXRzKCk7Y29uc3Qgcj1lLmZvZyxzPWkuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbD9lLmVudmlyb25tZW50Om51bGwsbz1udWxsPT09eT9mLm91dHB1dEVuY29kaW5nOnkudGV4dHVyZS5lbmNvZGluZyxhPVcuZ2V0KGkuZW52TWFwfHxzKSxjPUcuZ2V0KGkpLGg9ZC5zdGF0ZS5saWdodHM7aWYoITA9PT1EJiYoITA9PT0kfHx0IT09dykpe2NvbnN0IGU9dD09PXcmJmkuaWQ9PT14O2V0LnNldFN0YXRlKGksdCxlKX1pLnZlcnNpb249PT1jLl9fdmVyc2lvbj9pLmZvZyYmYy5mb2chPT1yfHxjLmVudmlyb25tZW50IT09c3x8Yy5uZWVkc0xpZ2h0cyYmYy5saWdodHNTdGF0ZVZlcnNpb24hPT1oLnN0YXRlLnZlcnNpb24/d3QoaSxlLG4pOnZvaWQgMD09PWMubnVtQ2xpcHBpbmdQbGFuZXN8fGMubnVtQ2xpcHBpbmdQbGFuZXM9PT1ldC5udW1QbGFuZXMmJmMubnVtSW50ZXJzZWN0aW9uPT09ZXQubnVtSW50ZXJzZWN0aW9uPyhjLm91dHB1dEVuY29kaW5nIT09b3x8Yy5lbnZNYXAhPT1hKSYmd3QoaSxlLG4pOnd0KGksZSxuKTood3QoaSxlLG4pLGMuX192ZXJzaW9uPWkudmVyc2lvbik7bGV0IGw9ITEsdT0hMSxwPSExO2NvbnN0IG09Yy5wcm9ncmFtLGc9bS5nZXRVbmlmb3JtcygpLF89Yy51bmlmb3JtcztpZihVLnVzZVByb2dyYW0obS5wcm9ncmFtKSYmKGw9ITAsdT0hMCxwPSEwKSxpLmlkIT09eCYmKHg9aS5pZCx1PSEwKSxsfHx3IT09dCl7aWYoZy5zZXRWYWx1ZShjdCxcInByb2plY3Rpb25NYXRyaXhcIix0LnByb2plY3Rpb25NYXRyaXgpLEgubG9nYXJpdGhtaWNEZXB0aEJ1ZmZlciYmZy5zZXRWYWx1ZShjdCxcImxvZ0RlcHRoQnVmRkNcIiwyLyhNYXRoLmxvZyh0LmZhcisxKS9NYXRoLkxOMikpLHchPT10JiYodz10LHU9ITAscD0hMCksaS5pc1NoYWRlck1hdGVyaWFsfHxpLmlzTWVzaFBob25nTWF0ZXJpYWx8fGkuaXNNZXNoVG9vbk1hdGVyaWFsfHxpLmlzTWVzaFN0YW5kYXJkTWF0ZXJpYWx8fGkuZW52TWFwKXtjb25zdCBlPWcubWFwLmNhbWVyYVBvc2l0aW9uO3ZvaWQgMCE9PWUmJmUuc2V0VmFsdWUoY3Qsei5zZXRGcm9tTWF0cml4UG9zaXRpb24odC5tYXRyaXhXb3JsZCkpfShpLmlzTWVzaFBob25nTWF0ZXJpYWx8fGkuaXNNZXNoVG9vbk1hdGVyaWFsfHxpLmlzTWVzaExhbWJlcnRNYXRlcmlhbHx8aS5pc01lc2hCYXNpY01hdGVyaWFsfHxpLmlzTWVzaFN0YW5kYXJkTWF0ZXJpYWx8fGkuaXNTaGFkZXJNYXRlcmlhbCkmJmcuc2V0VmFsdWUoY3QsXCJpc09ydGhvZ3JhcGhpY1wiLCEwPT09dC5pc09ydGhvZ3JhcGhpY0NhbWVyYSksKGkuaXNNZXNoUGhvbmdNYXRlcmlhbHx8aS5pc01lc2hUb29uTWF0ZXJpYWx8fGkuaXNNZXNoTGFtYmVydE1hdGVyaWFsfHxpLmlzTWVzaEJhc2ljTWF0ZXJpYWx8fGkuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbHx8aS5pc1NoYWRlck1hdGVyaWFsfHxpLmlzU2hhZG93TWF0ZXJpYWx8fGkuc2tpbm5pbmcpJiZnLnNldFZhbHVlKGN0LFwidmlld01hdHJpeFwiLHQubWF0cml4V29ybGRJbnZlcnNlKX1pZihpLnNraW5uaW5nKXtnLnNldE9wdGlvbmFsKGN0LG4sXCJiaW5kTWF0cml4XCIpLGcuc2V0T3B0aW9uYWwoY3QsbixcImJpbmRNYXRyaXhJbnZlcnNlXCIpO2NvbnN0IHQ9bi5za2VsZXRvbjtpZih0KXtjb25zdCBlPXQuYm9uZXM7aWYoSC5mbG9hdFZlcnRleFRleHR1cmVzKXtpZihudWxsPT09dC5ib25lVGV4dHVyZSl7bGV0IGk9TWF0aC5zcXJ0KDQqZS5sZW5ndGgpO2k9bm4uY2VpbFBvd2VyT2ZUd28oaSksaT1NYXRoLm1heChpLDQpO2NvbnN0IG49bmV3IEZsb2F0MzJBcnJheShpKmkqNCk7bi5zZXQodC5ib25lTWF0cmljZXMpO2NvbnN0IHI9bmV3IEJzKG4saSxpLHppLE5pKTt0LmJvbmVNYXRyaWNlcz1uLHQuYm9uZVRleHR1cmU9cix0LmJvbmVUZXh0dXJlU2l6ZT1pfWcuc2V0VmFsdWUoY3QsXCJib25lVGV4dHVyZVwiLHQuYm9uZVRleHR1cmUscSksZy5zZXRWYWx1ZShjdCxcImJvbmVUZXh0dXJlU2l6ZVwiLHQuYm9uZVRleHR1cmVTaXplKX1lbHNlIGcuc2V0T3B0aW9uYWwoY3QsdCxcImJvbmVNYXRyaWNlc1wiKX19dmFyIHYsYjtyZXR1cm4odXx8Yy5yZWNlaXZlU2hhZG93IT09bi5yZWNlaXZlU2hhZG93KSYmKGMucmVjZWl2ZVNoYWRvdz1uLnJlY2VpdmVTaGFkb3csZy5zZXRWYWx1ZShjdCxcInJlY2VpdmVTaGFkb3dcIixuLnJlY2VpdmVTaGFkb3cpKSx1JiYoZy5zZXRWYWx1ZShjdCxcInRvbmVNYXBwaW5nRXhwb3N1cmVcIixmLnRvbmVNYXBwaW5nRXhwb3N1cmUpLGMubmVlZHNMaWdodHMmJihiPXAsKHY9XykuYW1iaWVudExpZ2h0Q29sb3IubmVlZHNVcGRhdGU9Yix2LmxpZ2h0UHJvYmUubmVlZHNVcGRhdGU9Yix2LmRpcmVjdGlvbmFsTGlnaHRzLm5lZWRzVXBkYXRlPWIsdi5kaXJlY3Rpb25hbExpZ2h0U2hhZG93cy5uZWVkc1VwZGF0ZT1iLHYucG9pbnRMaWdodHMubmVlZHNVcGRhdGU9Yix2LnBvaW50TGlnaHRTaGFkb3dzLm5lZWRzVXBkYXRlPWIsdi5zcG90TGlnaHRzLm5lZWRzVXBkYXRlPWIsdi5zcG90TGlnaHRTaGFkb3dzLm5lZWRzVXBkYXRlPWIsdi5yZWN0QXJlYUxpZ2h0cy5uZWVkc1VwZGF0ZT1iLHYuaGVtaXNwaGVyZUxpZ2h0cy5uZWVkc1VwZGF0ZT1iKSxyJiZpLmZvZyYmSy5yZWZyZXNoRm9nVW5pZm9ybXMoXyxyKSxLLnJlZnJlc2hNYXRlcmlhbFVuaWZvcm1zKF8saSxJLEUpLGFhLnVwbG9hZChjdCxjLnVuaWZvcm1zTGlzdCxfLHEpKSxpLmlzU2hhZGVyTWF0ZXJpYWwmJiEwPT09aS51bmlmb3Jtc05lZWRVcGRhdGUmJihhYS51cGxvYWQoY3QsYy51bmlmb3Jtc0xpc3QsXyxxKSxpLnVuaWZvcm1zTmVlZFVwZGF0ZT0hMSksaS5pc1Nwcml0ZU1hdGVyaWFsJiZnLnNldFZhbHVlKGN0LFwiY2VudGVyXCIsbi5jZW50ZXIpLGcuc2V0VmFsdWUoY3QsXCJtb2RlbFZpZXdNYXRyaXhcIixuLm1vZGVsVmlld01hdHJpeCksZy5zZXRWYWx1ZShjdCxcIm5vcm1hbE1hdHJpeFwiLG4ubm9ybWFsTWF0cml4KSxnLnNldFZhbHVlKGN0LFwibW9kZWxNYXRyaXhcIixuLm1hdHJpeFdvcmxkKSxtfXZ0LnNldEFuaW1hdGlvbkxvb3AoKGZ1bmN0aW9uKHQpe3V0LmlzUHJlc2VudGluZ3x8X3QmJl90KHQpfSkpLFwidW5kZWZpbmVkXCIhPXR5cGVvZiB3aW5kb3cmJnZ0LnNldENvbnRleHQod2luZG93KSx0aGlzLnNldEFuaW1hdGlvbkxvb3A9ZnVuY3Rpb24odCl7X3Q9dCx1dC5zZXRBbmltYXRpb25Mb29wKHQpLG51bGw9PT10P3Z0LnN0b3AoKTp2dC5zdGFydCgpfSx0aGlzLnJlbmRlcj1mdW5jdGlvbih0LGUpe2xldCBpLG47aWYodm9pZCAwIT09YXJndW1lbnRzWzJdJiYoY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlci5yZW5kZXIoKTogdGhlIHJlbmRlclRhcmdldCBhcmd1bWVudCBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLnNldFJlbmRlclRhcmdldCgpIGluc3RlYWQuXCIpLGk9YXJndW1lbnRzWzJdKSx2b2lkIDAhPT1hcmd1bWVudHNbM10mJihjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyLnJlbmRlcigpOiB0aGUgZm9yY2VDbGVhciBhcmd1bWVudCBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLmNsZWFyKCkgaW5zdGVhZC5cIiksbj1hcmd1bWVudHNbM10pLHZvaWQgMCE9PWUmJiEwIT09ZS5pc0NhbWVyYSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuV2ViR0xSZW5kZXJlci5yZW5kZXI6IGNhbWVyYSBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgVEhSRUUuQ2FtZXJhLlwiKTtpZighMD09PW0pcmV0dXJuO2F0LnJlc2V0RGVmYXVsdFN0YXRlKCkseD0tMSx3PW51bGwsITA9PT10LmF1dG9VcGRhdGUmJnQudXBkYXRlTWF0cml4V29ybGQoKSxudWxsPT09ZS5wYXJlbnQmJmUudXBkYXRlTWF0cml4V29ybGQoKSwhMD09PXV0LmVuYWJsZWQmJiEwPT09dXQuaXNQcmVzZW50aW5nJiYoZT11dC5nZXRDYW1lcmEoZSkpLCEwPT09dC5pc1NjZW5lJiZ0Lm9uQmVmb3JlUmVuZGVyKGYsdCxlLGl8fHkpLGQ9dHQuZ2V0KHQscC5sZW5ndGgpLGQuaW5pdCgpLHAucHVzaChkKSxrLm11bHRpcGx5TWF0cmljZXMoZS5wcm9qZWN0aW9uTWF0cml4LGUubWF0cml4V29ybGRJbnZlcnNlKSxOLnNldEZyb21Qcm9qZWN0aW9uTWF0cml4KGspLCQ9dGhpcy5sb2NhbENsaXBwaW5nRW5hYmxlZCxEPWV0LmluaXQodGhpcy5jbGlwcGluZ1BsYW5lcywkLGUpLHU9US5nZXQodCxlKSx1LmluaXQoKSx5dCh0LGUsMCxmLnNvcnRPYmplY3RzKSx1LmZpbmlzaCgpLCEwPT09Zi5zb3J0T2JqZWN0cyYmdS5zb3J0KEEsUCksITA9PT1EJiZldC5iZWdpblNoYWRvd3MoKTtjb25zdCByPWQuc3RhdGUuc2hhZG93c0FycmF5O2R0LnJlbmRlcihyLHQsZSksZC5zZXR1cExpZ2h0cygpLGQuc2V0dXBMaWdodHNWaWV3KGUpLCEwPT09RCYmZXQuZW5kU2hhZG93cygpLCEwPT09dGhpcy5pbmZvLmF1dG9SZXNldCYmdGhpcy5pbmZvLnJlc2V0KCksdm9pZCAwIT09aSYmdGhpcy5zZXRSZW5kZXJUYXJnZXQoaSksaXQucmVuZGVyKHUsdCxlLG4pO2NvbnN0IHM9dS5vcGFxdWUsbz11LnRyYW5zcGFyZW50O3MubGVuZ3RoPjAmJmJ0KHMsdCxlKSxvLmxlbmd0aD4wJiZidChvLHQsZSksITA9PT10LmlzU2NlbmUmJnQub25BZnRlclJlbmRlcihmLHQsZSksbnVsbCE9PXkmJihxLnVwZGF0ZVJlbmRlclRhcmdldE1pcG1hcCh5KSxxLnVwZGF0ZU11bHRpc2FtcGxlUmVuZGVyVGFyZ2V0KHkpKSxVLmJ1ZmZlcnMuZGVwdGguc2V0VGVzdCghMCksVS5idWZmZXJzLmRlcHRoLnNldE1hc2soITApLFUuYnVmZmVycy5jb2xvci5zZXRNYXNrKCEwKSxVLnNldFBvbHlnb25PZmZzZXQoITEpLHAucG9wKCksZD1wLmxlbmd0aD4wP3BbcC5sZW5ndGgtMV06bnVsbCx1PW51bGx9LHRoaXMuc2V0RnJhbWVidWZmZXI9ZnVuY3Rpb24odCl7ZyE9PXQmJm51bGw9PT15JiZjdC5iaW5kRnJhbWVidWZmZXIoMzYxNjAsdCksZz10fSx0aGlzLmdldEFjdGl2ZUN1YmVGYWNlPWZ1bmN0aW9uKCl7cmV0dXJuIF99LHRoaXMuZ2V0QWN0aXZlTWlwbWFwTGV2ZWw9ZnVuY3Rpb24oKXtyZXR1cm4gdn0sdGhpcy5nZXRSZW5kZXJMaXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHV9LHRoaXMuc2V0UmVuZGVyTGlzdD1mdW5jdGlvbih0KXt1PXR9LHRoaXMuZ2V0UmVuZGVyVGFyZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHl9LHRoaXMuc2V0UmVuZGVyVGFyZ2V0PWZ1bmN0aW9uKHQsZT0wLGk9MCl7eT10LF89ZSx2PWksdCYmdm9pZCAwPT09Ry5nZXQodCkuX193ZWJnbEZyYW1lYnVmZmVyJiZxLnNldHVwUmVuZGVyVGFyZ2V0KHQpO2xldCBuPWcscj0hMTtpZih0KXtjb25zdCBpPUcuZ2V0KHQpLl9fd2ViZ2xGcmFtZWJ1ZmZlcjt0LmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0PyhuPWlbZV0scj0hMCk6bj10LmlzV2ViR0xNdWx0aXNhbXBsZVJlbmRlclRhcmdldD9HLmdldCh0KS5fX3dlYmdsTXVsdGlzYW1wbGVkRnJhbWVidWZmZXI6aSxTLmNvcHkodC52aWV3cG9ydCksTS5jb3B5KHQuc2Npc3NvciksVD10LnNjaXNzb3JUZXN0fWVsc2UgUy5jb3B5KFIpLm11bHRpcGx5U2NhbGFyKEkpLmZsb29yKCksTS5jb3B5KEwpLm11bHRpcGx5U2NhbGFyKEkpLmZsb29yKCksVD1PO2lmKGIhPT1uJiYoY3QuYmluZEZyYW1lYnVmZmVyKDM2MTYwLG4pLGI9biksVS52aWV3cG9ydChTKSxVLnNjaXNzb3IoTSksVS5zZXRTY2lzc29yVGVzdChUKSxyKXtjb25zdCBuPUcuZ2V0KHQudGV4dHVyZSk7Y3QuZnJhbWVidWZmZXJUZXh0dXJlMkQoMzYxNjAsMzYwNjQsMzQwNjkrZSxuLl9fd2ViZ2xUZXh0dXJlLGkpfX0sdGhpcy5yZWFkUmVuZGVyVGFyZ2V0UGl4ZWxzPWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe2lmKCF0fHwhdC5pc1dlYkdMUmVuZGVyVGFyZ2V0KXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTFJlbmRlcmVyLnJlYWRSZW5kZXJUYXJnZXRQaXhlbHM6IHJlbmRlclRhcmdldCBpcyBub3QgVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQuXCIpO2xldCBhPUcuZ2V0KHQpLl9fd2ViZ2xGcmFtZWJ1ZmZlcjtpZih0LmlzV2ViR0xDdWJlUmVuZGVyVGFyZ2V0JiZ2b2lkIDAhPT1vJiYoYT1hW29dKSxhKXtsZXQgbz0hMTthIT09YiYmKGN0LmJpbmRGcmFtZWJ1ZmZlcigzNjE2MCxhKSxvPSEwKTt0cnl7Y29uc3QgYT10LnRleHR1cmUsYz1hLmZvcm1hdCxoPWEudHlwZTtpZihjIT09emkmJm90LmNvbnZlcnQoYykhPT1jdC5nZXRQYXJhbWV0ZXIoMzU3MzkpKXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5XZWJHTFJlbmRlcmVyLnJlYWRSZW5kZXJUYXJnZXRQaXhlbHM6IHJlbmRlclRhcmdldCBpcyBub3QgaW4gUkdCQSBvciBpbXBsZW1lbnRhdGlvbiBkZWZpbmVkIGZvcm1hdC5cIik7Y29uc3QgbD1oPT09RGkmJihqLmhhcyhcIkVYVF9jb2xvcl9idWZmZXJfaGFsZl9mbG9hdFwiKXx8SC5pc1dlYkdMMiYmai5oYXMoXCJFWFRfY29sb3JfYnVmZmVyX2Zsb2F0XCIpKTtpZighKGg9PT1SaXx8b3QuY29udmVydChoKT09PWN0LmdldFBhcmFtZXRlcigzNTczOCl8fGg9PT1OaSYmKEguaXNXZWJHTDJ8fGouaGFzKFwiT0VTX3RleHR1cmVfZmxvYXRcIil8fGouaGFzKFwiV0VCR0xfY29sb3JfYnVmZmVyX2Zsb2F0XCIpKXx8bCkpcmV0dXJuIHZvaWQgY29uc29sZS5lcnJvcihcIlRIUkVFLldlYkdMUmVuZGVyZXIucmVhZFJlbmRlclRhcmdldFBpeGVsczogcmVuZGVyVGFyZ2V0IGlzIG5vdCBpbiBVbnNpZ25lZEJ5dGVUeXBlIG9yIGltcGxlbWVudGF0aW9uIGRlZmluZWQgdHlwZS5cIik7MzYwNTM9PT1jdC5jaGVja0ZyYW1lYnVmZmVyU3RhdHVzKDM2MTYwKT9lPj0wJiZlPD10LndpZHRoLW4mJmk+PTAmJmk8PXQuaGVpZ2h0LXImJmN0LnJlYWRQaXhlbHMoZSxpLG4scixvdC5jb252ZXJ0KGMpLG90LmNvbnZlcnQoaCkscyk6Y29uc29sZS5lcnJvcihcIlRIUkVFLldlYkdMUmVuZGVyZXIucmVhZFJlbmRlclRhcmdldFBpeGVsczogcmVhZFBpeGVscyBmcm9tIHJlbmRlclRhcmdldCBmYWlsZWQuIEZyYW1lYnVmZmVyIG5vdCBjb21wbGV0ZS5cIil9ZmluYWxseXtvJiZjdC5iaW5kRnJhbWVidWZmZXIoMzYxNjAsYil9fX0sdGhpcy5jb3B5RnJhbWVidWZmZXJUb1RleHR1cmU9ZnVuY3Rpb24odCxlLGk9MCl7Y29uc3Qgbj1NYXRoLnBvdygyLC1pKSxyPU1hdGguZmxvb3IoZS5pbWFnZS53aWR0aCpuKSxzPU1hdGguZmxvb3IoZS5pbWFnZS5oZWlnaHQqbiksbz1vdC5jb252ZXJ0KGUuZm9ybWF0KTtxLnNldFRleHR1cmUyRChlLDApLGN0LmNvcHlUZXhJbWFnZTJEKDM1NTMsaSxvLHQueCx0LnkscixzLDApLFUudW5iaW5kVGV4dHVyZSgpfSx0aGlzLmNvcHlUZXh0dXJlVG9UZXh0dXJlPWZ1bmN0aW9uKHQsZSxpLG49MCl7Y29uc3Qgcj1lLmltYWdlLndpZHRoLHM9ZS5pbWFnZS5oZWlnaHQsbz1vdC5jb252ZXJ0KGkuZm9ybWF0KSxhPW90LmNvbnZlcnQoaS50eXBlKTtxLnNldFRleHR1cmUyRChpLDApLGN0LnBpeGVsU3RvcmVpKDM3NDQwLGkuZmxpcFkpLGN0LnBpeGVsU3RvcmVpKDM3NDQxLGkucHJlbXVsdGlwbHlBbHBoYSksY3QucGl4ZWxTdG9yZWkoMzMxNyxpLnVucGFja0FsaWdubWVudCksZS5pc0RhdGFUZXh0dXJlP2N0LnRleFN1YkltYWdlMkQoMzU1MyxuLHQueCx0LnkscixzLG8sYSxlLmltYWdlLmRhdGEpOmUuaXNDb21wcmVzc2VkVGV4dHVyZT9jdC5jb21wcmVzc2VkVGV4U3ViSW1hZ2UyRCgzNTUzLG4sdC54LHQueSxlLm1pcG1hcHNbMF0ud2lkdGgsZS5taXBtYXBzWzBdLmhlaWdodCxvLGUubWlwbWFwc1swXS5kYXRhKTpjdC50ZXhTdWJJbWFnZTJEKDM1NTMsbix0LngsdC55LG8sYSxlLmltYWdlKSwwPT09biYmaS5nZW5lcmF0ZU1pcG1hcHMmJmN0LmdlbmVyYXRlTWlwbWFwKDM1NTMpLFUudW5iaW5kVGV4dHVyZSgpfSx0aGlzLmluaXRUZXh0dXJlPWZ1bmN0aW9uKHQpe3Euc2V0VGV4dHVyZTJEKHQsMCksVS51bmJpbmRUZXh0dXJlKCl9LHRoaXMucmVzZXRTdGF0ZT1mdW5jdGlvbigpe1UucmVzZXQoKSxhdC5yZXNldCgpfSxcInVuZGVmaW5lZFwiIT10eXBlb2YgX19USFJFRV9ERVZUT09MU19fJiZfX1RIUkVFX0RFVlRPT0xTX18uZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJvYnNlcnZlXCIse2RldGFpbDp0aGlzfSkpfWZ1bmN0aW9uIEthKHQpe0phLmNhbGwodGhpcyx0KX1xYS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKERzLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnFhLGlzQXJyYXlDYW1lcmE6ITB9KSxXYS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHByLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOldhLGlzR3JvdXA6ITB9KSxPYmplY3QuYXNzaWduKFhhLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6WGEsZ2V0SGFuZFNwYWNlOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PT10aGlzLl9oYW5kJiYodGhpcy5faGFuZD1uZXcgV2EsdGhpcy5faGFuZC5tYXRyaXhBdXRvVXBkYXRlPSExLHRoaXMuX2hhbmQudmlzaWJsZT0hMSx0aGlzLl9oYW5kLmpvaW50cz17fSx0aGlzLl9oYW5kLmlucHV0U3RhdGU9e3BpbmNoaW5nOiExfSksdGhpcy5faGFuZH0sZ2V0VGFyZ2V0UmF5U3BhY2U6ZnVuY3Rpb24oKXtyZXR1cm4gbnVsbD09PXRoaXMuX3RhcmdldFJheSYmKHRoaXMuX3RhcmdldFJheT1uZXcgV2EsdGhpcy5fdGFyZ2V0UmF5Lm1hdHJpeEF1dG9VcGRhdGU9ITEsdGhpcy5fdGFyZ2V0UmF5LnZpc2libGU9ITEpLHRoaXMuX3RhcmdldFJheX0sZ2V0R3JpcFNwYWNlOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGw9PT10aGlzLl9ncmlwJiYodGhpcy5fZ3JpcD1uZXcgV2EsdGhpcy5fZ3JpcC5tYXRyaXhBdXRvVXBkYXRlPSExLHRoaXMuX2dyaXAudmlzaWJsZT0hMSksdGhpcy5fZ3JpcH0sZGlzcGF0Y2hFdmVudDpmdW5jdGlvbih0KXtyZXR1cm4gbnVsbCE9PXRoaXMuX3RhcmdldFJheSYmdGhpcy5fdGFyZ2V0UmF5LmRpc3BhdGNoRXZlbnQodCksbnVsbCE9PXRoaXMuX2dyaXAmJnRoaXMuX2dyaXAuZGlzcGF0Y2hFdmVudCh0KSxudWxsIT09dGhpcy5faGFuZCYmdGhpcy5faGFuZC5kaXNwYXRjaEV2ZW50KHQpLHRoaXN9LGRpc2Nvbm5lY3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGlzcGF0Y2hFdmVudCh7dHlwZTpcImRpc2Nvbm5lY3RlZFwiLGRhdGE6dH0pLG51bGwhPT10aGlzLl90YXJnZXRSYXkmJih0aGlzLl90YXJnZXRSYXkudmlzaWJsZT0hMSksbnVsbCE9PXRoaXMuX2dyaXAmJih0aGlzLl9ncmlwLnZpc2libGU9ITEpLG51bGwhPT10aGlzLl9oYW5kJiYodGhpcy5faGFuZC52aXNpYmxlPSExKSx0aGlzfSx1cGRhdGU6ZnVuY3Rpb24odCxlLGkpe2xldCBuPW51bGwscj1udWxsLHM9bnVsbDtjb25zdCBvPXRoaXMuX3RhcmdldFJheSxhPXRoaXMuX2dyaXAsYz10aGlzLl9oYW5kO2lmKHQmJlwidmlzaWJsZS1ibHVycmVkXCIhPT1lLnNlc3Npb24udmlzaWJpbGl0eVN0YXRlKWlmKGMmJnQuaGFuZCl7cz0hMDtmb3IoY29uc3QgbiBvZiB0LmhhbmQudmFsdWVzKCkpe2NvbnN0IHQ9ZS5nZXRKb2ludFBvc2UobixpKTtpZih2b2lkIDA9PT1jLmpvaW50c1tuLmpvaW50TmFtZV0pe2NvbnN0IHQ9bmV3IFdhO3QubWF0cml4QXV0b1VwZGF0ZT0hMSx0LnZpc2libGU9ITEsYy5qb2ludHNbbi5qb2ludE5hbWVdPXQsYy5hZGQodCl9Y29uc3Qgcj1jLmpvaW50c1tuLmpvaW50TmFtZV07bnVsbCE9PXQmJihyLm1hdHJpeC5mcm9tQXJyYXkodC50cmFuc2Zvcm0ubWF0cml4KSxyLm1hdHJpeC5kZWNvbXBvc2Uoci5wb3NpdGlvbixyLnJvdGF0aW9uLHIuc2NhbGUpLHIuam9pbnRSYWRpdXM9dC5yYWRpdXMpLHIudmlzaWJsZT1udWxsIT09dH1jb25zdCBuPWMuam9pbnRzW1wiaW5kZXgtZmluZ2VyLXRpcFwiXSxyPWMuam9pbnRzW1widGh1bWItdGlwXCJdLG89bi5wb3NpdGlvbi5kaXN0YW5jZVRvKHIucG9zaXRpb24pLGE9LjAyLGg9LjAwNTtjLmlucHV0U3RhdGUucGluY2hpbmcmJm8+YStoPyhjLmlucHV0U3RhdGUucGluY2hpbmc9ITEsdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOlwicGluY2hlbmRcIixoYW5kZWRuZXNzOnQuaGFuZGVkbmVzcyx0YXJnZXQ6dGhpc30pKTohYy5pbnB1dFN0YXRlLnBpbmNoaW5nJiZvPD1hLWgmJihjLmlucHV0U3RhdGUucGluY2hpbmc9ITAsdGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOlwicGluY2hzdGFydFwiLGhhbmRlZG5lc3M6dC5oYW5kZWRuZXNzLHRhcmdldDp0aGlzfSkpfWVsc2UgbnVsbCE9PW8mJihuPWUuZ2V0UG9zZSh0LnRhcmdldFJheVNwYWNlLGkpLG51bGwhPT1uJiYoby5tYXRyaXguZnJvbUFycmF5KG4udHJhbnNmb3JtLm1hdHJpeCksby5tYXRyaXguZGVjb21wb3NlKG8ucG9zaXRpb24sby5yb3RhdGlvbixvLnNjYWxlKSkpLG51bGwhPT1hJiZ0LmdyaXBTcGFjZSYmKHI9ZS5nZXRQb3NlKHQuZ3JpcFNwYWNlLGkpLG51bGwhPT1yJiYoYS5tYXRyaXguZnJvbUFycmF5KHIudHJhbnNmb3JtLm1hdHJpeCksYS5tYXRyaXguZGVjb21wb3NlKGEucG9zaXRpb24sYS5yb3RhdGlvbixhLnNjYWxlKSkpO3JldHVybiBudWxsIT09byYmKG8udmlzaWJsZT1udWxsIT09biksbnVsbCE9PWEmJihhLnZpc2libGU9bnVsbCE9PXIpLG51bGwhPT1jJiYoYy52aXNpYmxlPW51bGwhPT1zKSx0aGlzfX0pLE9iamVjdC5hc3NpZ24oWWEucHJvdG90eXBlLFFpLnByb3RvdHlwZSksS2EucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKYS5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpLYSxpc1dlYkdMMVJlbmRlcmVyOiEwfSk7Y2xhc3MgUWEgZXh0ZW5kcyBwcntjb25zdHJ1Y3Rvcigpe3N1cGVyKCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpc1NjZW5lXCIse3ZhbHVlOiEwfSksdGhpcy50eXBlPVwiU2NlbmVcIix0aGlzLmJhY2tncm91bmQ9bnVsbCx0aGlzLmVudmlyb25tZW50PW51bGwsdGhpcy5mb2c9bnVsbCx0aGlzLm92ZXJyaWRlTWF0ZXJpYWw9bnVsbCx0aGlzLmF1dG9VcGRhdGU9ITAsXCJ1bmRlZmluZWRcIiE9dHlwZW9mIF9fVEhSRUVfREVWVE9PTFNfXyYmX19USFJFRV9ERVZUT09MU19fLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwib2JzZXJ2ZVwiLHtkZXRhaWw6dGhpc30pKX1jb3B5KHQsZSl7cmV0dXJuIHN1cGVyLmNvcHkodCxlKSxudWxsIT09dC5iYWNrZ3JvdW5kJiYodGhpcy5iYWNrZ3JvdW5kPXQuYmFja2dyb3VuZC5jbG9uZSgpKSxudWxsIT09dC5lbnZpcm9ubWVudCYmKHRoaXMuZW52aXJvbm1lbnQ9dC5lbnZpcm9ubWVudC5jbG9uZSgpKSxudWxsIT09dC5mb2cmJih0aGlzLmZvZz10LmZvZy5jbG9uZSgpKSxudWxsIT09dC5vdmVycmlkZU1hdGVyaWFsJiYodGhpcy5vdmVycmlkZU1hdGVyaWFsPXQub3ZlcnJpZGVNYXRlcmlhbC5jbG9uZSgpKSx0aGlzLmF1dG9VcGRhdGU9dC5hdXRvVXBkYXRlLHRoaXMubWF0cml4QXV0b1VwZGF0ZT10Lm1hdHJpeEF1dG9VcGRhdGUsdGhpc310b0pTT04odCl7Y29uc3QgZT1zdXBlci50b0pTT04odCk7cmV0dXJuIG51bGwhPT10aGlzLmJhY2tncm91bmQmJihlLm9iamVjdC5iYWNrZ3JvdW5kPXRoaXMuYmFja2dyb3VuZC50b0pTT04odCkpLG51bGwhPT10aGlzLmVudmlyb25tZW50JiYoZS5vYmplY3QuZW52aXJvbm1lbnQ9dGhpcy5lbnZpcm9ubWVudC50b0pTT04odCkpLG51bGwhPT10aGlzLmZvZyYmKGUub2JqZWN0LmZvZz10aGlzLmZvZy50b0pTT04oKSksZX19ZnVuY3Rpb24gdGModCxlKXt0aGlzLmFycmF5PXQsdGhpcy5zdHJpZGU9ZSx0aGlzLmNvdW50PXZvaWQgMCE9PXQ/dC5sZW5ndGgvZTowLHRoaXMudXNhZ2U9WmksdGhpcy51cGRhdGVSYW5nZT17b2Zmc2V0OjAsY291bnQ6LTF9LHRoaXMudmVyc2lvbj0wLHRoaXMudXVpZD1ubi5nZW5lcmF0ZVVVSUQoKX1PYmplY3QuZGVmaW5lUHJvcGVydHkodGMucHJvdG90eXBlLFwibmVlZHNVcGRhdGVcIix7c2V0OmZ1bmN0aW9uKHQpeyEwPT09dCYmdGhpcy52ZXJzaW9uKyt9fSksT2JqZWN0LmFzc2lnbih0Yy5wcm90b3R5cGUse2lzSW50ZXJsZWF2ZWRCdWZmZXI6ITAsb25VcGxvYWRDYWxsYmFjazpmdW5jdGlvbigpe30sc2V0VXNhZ2U6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudXNhZ2U9dCx0aGlzfSxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmFycmF5PW5ldyB0LmFycmF5LmNvbnN0cnVjdG9yKHQuYXJyYXkpLHRoaXMuY291bnQ9dC5jb3VudCx0aGlzLnN0cmlkZT10LnN0cmlkZSx0aGlzLnVzYWdlPXQudXNhZ2UsdGhpc30sY29weUF0OmZ1bmN0aW9uKHQsZSxpKXt0Kj10aGlzLnN0cmlkZSxpKj1lLnN0cmlkZTtmb3IobGV0IG49MCxyPXRoaXMuc3RyaWRlO248cjtuKyspdGhpcy5hcnJheVt0K25dPWUuYXJyYXlbaStuXTtyZXR1cm4gdGhpc30sc2V0OmZ1bmN0aW9uKHQsZT0wKXtyZXR1cm4gdGhpcy5hcnJheS5zZXQodCxlKSx0aGlzfSxjbG9uZTpmdW5jdGlvbih0KXt2b2lkIDA9PT10LmFycmF5QnVmZmVycyYmKHQuYXJyYXlCdWZmZXJzPXt9KSx2b2lkIDA9PT10aGlzLmFycmF5LmJ1ZmZlci5fdXVpZCYmKHRoaXMuYXJyYXkuYnVmZmVyLl91dWlkPW5uLmdlbmVyYXRlVVVJRCgpKSx2b2lkIDA9PT10LmFycmF5QnVmZmVyc1t0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZF0mJih0LmFycmF5QnVmZmVyc1t0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZF09dGhpcy5hcnJheS5zbGljZSgwKS5idWZmZXIpO2NvbnN0IGU9bmV3IHRjKG5ldyB0aGlzLmFycmF5LmNvbnN0cnVjdG9yKHQuYXJyYXlCdWZmZXJzW3RoaXMuYXJyYXkuYnVmZmVyLl91dWlkXSksdGhpcy5zdHJpZGUpO3JldHVybiBlLnNldFVzYWdlKHRoaXMudXNhZ2UpLGV9LG9uVXBsb2FkOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9uVXBsb2FkQ2FsbGJhY2s9dCx0aGlzfSx0b0pTT046ZnVuY3Rpb24odCl7cmV0dXJuIHZvaWQgMD09PXQuYXJyYXlCdWZmZXJzJiYodC5hcnJheUJ1ZmZlcnM9e30pLHZvaWQgMD09PXRoaXMuYXJyYXkuYnVmZmVyLl91dWlkJiYodGhpcy5hcnJheS5idWZmZXIuX3V1aWQ9bm4uZ2VuZXJhdGVVVUlEKCkpLHZvaWQgMD09PXQuYXJyYXlCdWZmZXJzW3RoaXMuYXJyYXkuYnVmZmVyLl91dWlkXSYmKHQuYXJyYXlCdWZmZXJzW3RoaXMuYXJyYXkuYnVmZmVyLl91dWlkXT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChuZXcgVWludDMyQXJyYXkodGhpcy5hcnJheS5idWZmZXIpKSkse3V1aWQ6dGhpcy51dWlkLGJ1ZmZlcjp0aGlzLmFycmF5LmJ1ZmZlci5fdXVpZCx0eXBlOnRoaXMuYXJyYXkuY29uc3RydWN0b3IubmFtZSxzdHJpZGU6dGhpcy5zdHJpZGV9fX0pO2NvbnN0IGVjPW5ldyBmbjtmdW5jdGlvbiBpYyh0LGUsaSxuKXt0aGlzLm5hbWU9XCJcIix0aGlzLmRhdGE9dCx0aGlzLml0ZW1TaXplPWUsdGhpcy5vZmZzZXQ9aSx0aGlzLm5vcm1hbGl6ZWQ9ITA9PT1ufWZ1bmN0aW9uIG5jKHQpe3pyLmNhbGwodGhpcyksdGhpcy50eXBlPVwiU3ByaXRlTWF0ZXJpYWxcIix0aGlzLmNvbG9yPW5ldyBEcigxNjc3NzIxNSksdGhpcy5tYXA9bnVsbCx0aGlzLmFscGhhTWFwPW51bGwsdGhpcy5yb3RhdGlvbj0wLHRoaXMuc2l6ZUF0dGVudWF0aW9uPSEwLHRoaXMudHJhbnNwYXJlbnQ9ITAsdGhpcy5zZXRWYWx1ZXModCl9bGV0IHJjO09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGljLnByb3RvdHlwZSx7Y291bnQ6e2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRhdGEuY291bnR9fSxhcnJheTp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGF0YS5hcnJheX19LG5lZWRzVXBkYXRlOntzZXQ6ZnVuY3Rpb24odCl7dGhpcy5kYXRhLm5lZWRzVXBkYXRlPXR9fX0pLE9iamVjdC5hc3NpZ24oaWMucHJvdG90eXBlLHtpc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlOiEwLGFwcGx5TWF0cml4NDpmdW5jdGlvbih0KXtmb3IobGV0IGU9MCxpPXRoaXMuZGF0YS5jb3VudDtlPGk7ZSsrKWVjLng9dGhpcy5nZXRYKGUpLGVjLnk9dGhpcy5nZXRZKGUpLGVjLno9dGhpcy5nZXRaKGUpLGVjLmFwcGx5TWF0cml4NCh0KSx0aGlzLnNldFhZWihlLGVjLngsZWMueSxlYy56KTtyZXR1cm4gdGhpc30sc2V0WDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmRhdGEuYXJyYXlbdCp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0XT1lLHRoaXN9LHNldFk6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5kYXRhLmFycmF5W3QqdGhpcy5kYXRhLnN0cmlkZSt0aGlzLm9mZnNldCsxXT1lLHRoaXN9LHNldFo6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5kYXRhLmFycmF5W3QqdGhpcy5kYXRhLnN0cmlkZSt0aGlzLm9mZnNldCsyXT1lLHRoaXN9LHNldFc6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5kYXRhLmFycmF5W3QqdGhpcy5kYXRhLnN0cmlkZSt0aGlzLm9mZnNldCszXT1lLHRoaXN9LGdldFg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZGF0YS5hcnJheVt0KnRoaXMuZGF0YS5zdHJpZGUrdGhpcy5vZmZzZXRdfSxnZXRZOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRhdGEuYXJyYXlbdCp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0KzFdfSxnZXRaOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRhdGEuYXJyYXlbdCp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0KzJdfSxnZXRXOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmRhdGEuYXJyYXlbdCp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0KzNdfSxzZXRYWTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHQ9dCp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0LHRoaXMuZGF0YS5hcnJheVt0KzBdPWUsdGhpcy5kYXRhLmFycmF5W3QrMV09aSx0aGlzfSxzZXRYWVo6ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIHQ9dCp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0LHRoaXMuZGF0YS5hcnJheVt0KzBdPWUsdGhpcy5kYXRhLmFycmF5W3QrMV09aSx0aGlzLmRhdGEuYXJyYXlbdCsyXT1uLHRoaXN9LHNldFhZWlc6ZnVuY3Rpb24odCxlLGksbixyKXtyZXR1cm4gdD10KnRoaXMuZGF0YS5zdHJpZGUrdGhpcy5vZmZzZXQsdGhpcy5kYXRhLmFycmF5W3QrMF09ZSx0aGlzLmRhdGEuYXJyYXlbdCsxXT1pLHRoaXMuZGF0YS5hcnJheVt0KzJdPW4sdGhpcy5kYXRhLmFycmF5W3QrM109cix0aGlzfSxjbG9uZTpmdW5jdGlvbih0KXtpZih2b2lkIDA9PT10KXtjb25zb2xlLmxvZyhcIlRIUkVFLkludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlLmNsb25lKCk6IENsb25pbmcgYW4gaW50ZXJsYXZlZCBidWZmZXIgYXR0cmlidXRlIHdpbGwgZGVpbnRlcmxlYXZlIGJ1ZmZlciBkYXRhLlwiKTtjb25zdCB0PVtdO2ZvcihsZXQgZT0wO2U8dGhpcy5jb3VudDtlKyspe2NvbnN0IGk9ZSp0aGlzLmRhdGEuc3RyaWRlK3RoaXMub2Zmc2V0O2ZvcihsZXQgZT0wO2U8dGhpcy5pdGVtU2l6ZTtlKyspdC5wdXNoKHRoaXMuZGF0YS5hcnJheVtpK2VdKX1yZXR1cm4gbmV3IEhyKG5ldyB0aGlzLmFycmF5LmNvbnN0cnVjdG9yKHQpLHRoaXMuaXRlbVNpemUsdGhpcy5ub3JtYWxpemVkKX1yZXR1cm4gdm9pZCAwPT09dC5pbnRlcmxlYXZlZEJ1ZmZlcnMmJih0LmludGVybGVhdmVkQnVmZmVycz17fSksdm9pZCAwPT09dC5pbnRlcmxlYXZlZEJ1ZmZlcnNbdGhpcy5kYXRhLnV1aWRdJiYodC5pbnRlcmxlYXZlZEJ1ZmZlcnNbdGhpcy5kYXRhLnV1aWRdPXRoaXMuZGF0YS5jbG9uZSh0KSksbmV3IGljKHQuaW50ZXJsZWF2ZWRCdWZmZXJzW3RoaXMuZGF0YS51dWlkXSx0aGlzLml0ZW1TaXplLHRoaXMub2Zmc2V0LHRoaXMubm9ybWFsaXplZCl9LHRvSlNPTjpmdW5jdGlvbih0KXtpZih2b2lkIDA9PT10KXtjb25zb2xlLmxvZyhcIlRIUkVFLkludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlLnRvSlNPTigpOiBTZXJpYWxpemluZyBhbiBpbnRlcmxhdmVkIGJ1ZmZlciBhdHRyaWJ1dGUgd2lsbCBkZWludGVybGVhdmUgYnVmZmVyIGRhdGEuXCIpO2NvbnN0IHQ9W107Zm9yKGxldCBlPTA7ZTx0aGlzLmNvdW50O2UrKyl7Y29uc3QgaT1lKnRoaXMuZGF0YS5zdHJpZGUrdGhpcy5vZmZzZXQ7Zm9yKGxldCBlPTA7ZTx0aGlzLml0ZW1TaXplO2UrKyl0LnB1c2godGhpcy5kYXRhLmFycmF5W2krZV0pfXJldHVybntpdGVtU2l6ZTp0aGlzLml0ZW1TaXplLHR5cGU6dGhpcy5hcnJheS5jb25zdHJ1Y3Rvci5uYW1lLGFycmF5OnQsbm9ybWFsaXplZDp0aGlzLm5vcm1hbGl6ZWR9fXJldHVybiB2b2lkIDA9PT10LmludGVybGVhdmVkQnVmZmVycyYmKHQuaW50ZXJsZWF2ZWRCdWZmZXJzPXt9KSx2b2lkIDA9PT10LmludGVybGVhdmVkQnVmZmVyc1t0aGlzLmRhdGEudXVpZF0mJih0LmludGVybGVhdmVkQnVmZmVyc1t0aGlzLmRhdGEudXVpZF09dGhpcy5kYXRhLnRvSlNPTih0KSkse2lzSW50ZXJsZWF2ZWRCdWZmZXJBdHRyaWJ1dGU6ITAsaXRlbVNpemU6dGhpcy5pdGVtU2l6ZSxkYXRhOnRoaXMuZGF0YS51dWlkLG9mZnNldDp0aGlzLm9mZnNldCxub3JtYWxpemVkOnRoaXMubm9ybWFsaXplZH19fSksbmMucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoenIucHJvdG90eXBlKSxuYy5wcm90b3R5cGUuY29uc3RydWN0b3I9bmMsbmMucHJvdG90eXBlLmlzU3ByaXRlTWF0ZXJpYWw9ITAsbmMucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHpyLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmNvbG9yLmNvcHkodC5jb2xvciksdGhpcy5tYXA9dC5tYXAsdGhpcy5hbHBoYU1hcD10LmFscGhhTWFwLHRoaXMucm90YXRpb249dC5yb3RhdGlvbix0aGlzLnNpemVBdHRlbnVhdGlvbj10LnNpemVBdHRlbnVhdGlvbix0aGlzfTtjb25zdCBzYz1uZXcgZm4sb2M9bmV3IGZuLGFjPW5ldyBmbixjYz1uZXcgcm4saGM9bmV3IHJuLGxjPW5ldyBIbix1Yz1uZXcgZm4sZGM9bmV3IGZuLHBjPW5ldyBmbixmYz1uZXcgcm4sbWM9bmV3IHJuLGdjPW5ldyBybjtmdW5jdGlvbiBfYyh0KXtpZihwci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIlNwcml0ZVwiLHZvaWQgMD09PXJjKXtyYz1uZXcgaHM7Y29uc3QgdD1uZXcgdGMobmV3IEZsb2F0MzJBcnJheShbLS41LC0uNSwwLDAsMCwuNSwtLjUsMCwxLDAsLjUsLjUsMCwxLDEsLS41LC41LDAsMCwxXSksNSk7cmMuc2V0SW5kZXgoWzAsMSwyLDAsMiwzXSkscmMuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgaWModCwzLDAsITEpKSxyYy5zZXRBdHRyaWJ1dGUoXCJ1dlwiLG5ldyBpYyh0LDIsMywhMSkpfXRoaXMuZ2VvbWV0cnk9cmMsdGhpcy5tYXRlcmlhbD12b2lkIDAhPT10P3Q6bmV3IG5jLHRoaXMuY2VudGVyPW5ldyBybiguNSwuNSl9ZnVuY3Rpb24gdmModCxlLGksbixyLHMpe2NjLnN1YlZlY3RvcnModCxpKS5hZGRTY2FsYXIoLjUpLm11bHRpcGx5KG4pLHZvaWQgMCE9PXI/KGhjLng9cypjYy54LXIqY2MueSxoYy55PXIqY2MueCtzKmNjLnkpOmhjLmNvcHkoY2MpLHQuY29weShlKSx0LngrPWhjLngsdC55Kz1oYy55LHQuYXBwbHlNYXRyaXg0KGxjKX1fYy5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHByLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOl9jLGlzU3ByaXRlOiEwLHJheWNhc3Q6ZnVuY3Rpb24odCxlKXtudWxsPT09dC5jYW1lcmEmJmNvbnNvbGUuZXJyb3IoJ1RIUkVFLlNwcml0ZTogXCJSYXljYXN0ZXIuY2FtZXJhXCIgbmVlZHMgdG8gYmUgc2V0IGluIG9yZGVyIHRvIHJheWNhc3QgYWdhaW5zdCBzcHJpdGVzLicpLG9jLnNldEZyb21NYXRyaXhTY2FsZSh0aGlzLm1hdHJpeFdvcmxkKSxsYy5jb3B5KHQuY2FtZXJhLm1hdHJpeFdvcmxkKSx0aGlzLm1vZGVsVmlld01hdHJpeC5tdWx0aXBseU1hdHJpY2VzKHQuY2FtZXJhLm1hdHJpeFdvcmxkSW52ZXJzZSx0aGlzLm1hdHJpeFdvcmxkKSxhYy5zZXRGcm9tTWF0cml4UG9zaXRpb24odGhpcy5tb2RlbFZpZXdNYXRyaXgpLHQuY2FtZXJhLmlzUGVyc3BlY3RpdmVDYW1lcmEmJiExPT09dGhpcy5tYXRlcmlhbC5zaXplQXR0ZW51YXRpb24mJm9jLm11bHRpcGx5U2NhbGFyKC1hYy56KTtjb25zdCBpPXRoaXMubWF0ZXJpYWwucm90YXRpb247bGV0IG4scjswIT09aSYmKHI9TWF0aC5jb3MoaSksbj1NYXRoLnNpbihpKSk7Y29uc3Qgcz10aGlzLmNlbnRlcjt2Yyh1Yy5zZXQoLS41LC0uNSwwKSxhYyxzLG9jLG4sciksdmMoZGMuc2V0KC41LC0uNSwwKSxhYyxzLG9jLG4sciksdmMocGMuc2V0KC41LC41LDApLGFjLHMsb2MsbixyKSxmYy5zZXQoMCwwKSxtYy5zZXQoMSwwKSxnYy5zZXQoMSwxKTtsZXQgbz10LnJheS5pbnRlcnNlY3RUcmlhbmdsZSh1YyxkYyxwYywhMSxzYyk7aWYobnVsbD09PW8mJih2YyhkYy5zZXQoLS41LC41LDApLGFjLHMsb2MsbixyKSxtYy5zZXQoMCwxKSxvPXQucmF5LmludGVyc2VjdFRyaWFuZ2xlKHVjLHBjLGRjLCExLHNjKSxudWxsPT09bykpcmV0dXJuO2NvbnN0IGE9dC5yYXkub3JpZ2luLmRpc3RhbmNlVG8oc2MpO2E8dC5uZWFyfHxhPnQuZmFyfHxlLnB1c2goe2Rpc3RhbmNlOmEscG9pbnQ6c2MuY2xvbmUoKSx1djpJci5nZXRVVihzYyx1YyxkYyxwYyxmYyxtYyxnYyxuZXcgcm4pLGZhY2U6bnVsbCxvYmplY3Q6dGhpc30pfSxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiBwci5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdm9pZCAwIT09dC5jZW50ZXImJnRoaXMuY2VudGVyLmNvcHkodC5jZW50ZXIpLHRoaXMubWF0ZXJpYWw9dC5tYXRlcmlhbCx0aGlzfX0pO2NvbnN0IHljPW5ldyBmbixiYz1uZXcgZm47ZnVuY3Rpb24geGMoKXtwci5jYWxsKHRoaXMpLHRoaXMuX2N1cnJlbnRMZXZlbD0wLHRoaXMudHlwZT1cIkxPRFwiLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse2xldmVsczp7ZW51bWVyYWJsZTohMCx2YWx1ZTpbXX19KSx0aGlzLmF1dG9VcGRhdGU9ITB9eGMucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShwci5wcm90b3R5cGUpLHtjb25zdHJ1Y3Rvcjp4Yyxpc0xPRDohMCxjb3B5OmZ1bmN0aW9uKHQpe3ByLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0LCExKTtjb25zdCBlPXQubGV2ZWxzO2ZvcihsZXQgdD0wLGk9ZS5sZW5ndGg7dDxpO3QrKyl7Y29uc3QgaT1lW3RdO3RoaXMuYWRkTGV2ZWwoaS5vYmplY3QuY2xvbmUoKSxpLmRpc3RhbmNlKX1yZXR1cm4gdGhpcy5hdXRvVXBkYXRlPXQuYXV0b1VwZGF0ZSx0aGlzfSxhZGRMZXZlbDpmdW5jdGlvbih0LGU9MCl7ZT1NYXRoLmFicyhlKTtjb25zdCBpPXRoaXMubGV2ZWxzO2xldCBuO2ZvcihuPTA7bjxpLmxlbmd0aCYmIShlPGlbbl0uZGlzdGFuY2UpO24rKyk7cmV0dXJuIGkuc3BsaWNlKG4sMCx7ZGlzdGFuY2U6ZSxvYmplY3Q6dH0pLHRoaXMuYWRkKHQpLHRoaXN9LGdldEN1cnJlbnRMZXZlbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJyZW50TGV2ZWx9LGdldE9iamVjdEZvckRpc3RhbmNlOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5sZXZlbHM7aWYoZS5sZW5ndGg+MCl7bGV0IGksbjtmb3IoaT0xLG49ZS5sZW5ndGg7aTxuJiYhKHQ8ZVtpXS5kaXN0YW5jZSk7aSsrKTtyZXR1cm4gZVtpLTFdLm9iamVjdH1yZXR1cm4gbnVsbH0scmF5Y2FzdDpmdW5jdGlvbih0LGUpe2lmKHRoaXMubGV2ZWxzLmxlbmd0aD4wKXt5Yy5zZXRGcm9tTWF0cml4UG9zaXRpb24odGhpcy5tYXRyaXhXb3JsZCk7Y29uc3QgaT10LnJheS5vcmlnaW4uZGlzdGFuY2VUbyh5Yyk7dGhpcy5nZXRPYmplY3RGb3JEaXN0YW5jZShpKS5yYXljYXN0KHQsZSl9fSx1cGRhdGU6ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLmxldmVscztpZihlLmxlbmd0aD4xKXt5Yy5zZXRGcm9tTWF0cml4UG9zaXRpb24odC5tYXRyaXhXb3JsZCksYmMuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHRoaXMubWF0cml4V29ybGQpO2NvbnN0IGk9eWMuZGlzdGFuY2VUbyhiYykvdC56b29tO2xldCBuLHI7Zm9yKGVbMF0ub2JqZWN0LnZpc2libGU9ITAsbj0xLHI9ZS5sZW5ndGg7bjxyJiZpPj1lW25dLmRpc3RhbmNlO24rKyllW24tMV0ub2JqZWN0LnZpc2libGU9ITEsZVtuXS5vYmplY3QudmlzaWJsZT0hMDtmb3IodGhpcy5fY3VycmVudExldmVsPW4tMTtuPHI7bisrKWVbbl0ub2JqZWN0LnZpc2libGU9ITF9fSx0b0pTT046ZnVuY3Rpb24odCl7Y29uc3QgZT1wci5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyx0KTshMT09PXRoaXMuYXV0b1VwZGF0ZSYmKGUub2JqZWN0LmF1dG9VcGRhdGU9ITEpLGUub2JqZWN0LmxldmVscz1bXTtjb25zdCBpPXRoaXMubGV2ZWxzO2ZvcihsZXQgdD0wLG49aS5sZW5ndGg7dDxuO3QrKyl7Y29uc3Qgbj1pW3RdO2Uub2JqZWN0LmxldmVscy5wdXNoKHtvYmplY3Q6bi5vYmplY3QudXVpZCxkaXN0YW5jZTpuLmRpc3RhbmNlfSl9cmV0dXJuIGV9fSk7Y29uc3Qgd2M9bmV3IGZuLFNjPW5ldyB1bixNYz1uZXcgdW4sVGM9bmV3IGZuLENjPW5ldyBIbjtmdW5jdGlvbiBFYyh0LGUpe3QmJnQuaXNHZW9tZXRyeSYmY29uc29sZS5lcnJvcihcIlRIUkVFLlNraW5uZWRNZXNoIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuXCIpLEVzLmNhbGwodGhpcyx0LGUpLHRoaXMudHlwZT1cIlNraW5uZWRNZXNoXCIsdGhpcy5iaW5kTW9kZT1cImF0dGFjaGVkXCIsdGhpcy5iaW5kTWF0cml4PW5ldyBIbix0aGlzLmJpbmRNYXRyaXhJbnZlcnNlPW5ldyBIbn1mdW5jdGlvbiBJYygpe3ByLmNhbGwodGhpcyksdGhpcy50eXBlPVwiQm9uZVwifUVjLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoRXMucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6RWMsaXNTa2lubmVkTWVzaDohMCxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiBFcy5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5iaW5kTW9kZT10LmJpbmRNb2RlLHRoaXMuYmluZE1hdHJpeC5jb3B5KHQuYmluZE1hdHJpeCksdGhpcy5iaW5kTWF0cml4SW52ZXJzZS5jb3B5KHQuYmluZE1hdHJpeEludmVyc2UpLHRoaXMuc2tlbGV0b249dC5za2VsZXRvbix0aGlzfSxiaW5kOmZ1bmN0aW9uKHQsZSl7dGhpcy5za2VsZXRvbj10LHZvaWQgMD09PWUmJih0aGlzLnVwZGF0ZU1hdHJpeFdvcmxkKCEwKSx0aGlzLnNrZWxldG9uLmNhbGN1bGF0ZUludmVyc2VzKCksZT10aGlzLm1hdHJpeFdvcmxkKSx0aGlzLmJpbmRNYXRyaXguY29weShlKSx0aGlzLmJpbmRNYXRyaXhJbnZlcnNlLmNvcHkoZSkuaW52ZXJ0KCl9LHBvc2U6ZnVuY3Rpb24oKXt0aGlzLnNrZWxldG9uLnBvc2UoKX0sbm9ybWFsaXplU2tpbldlaWdodHM6ZnVuY3Rpb24oKXtjb25zdCB0PW5ldyB1bixlPXRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5za2luV2VpZ2h0O2ZvcihsZXQgaT0wLG49ZS5jb3VudDtpPG47aSsrKXt0Lng9ZS5nZXRYKGkpLHQueT1lLmdldFkoaSksdC56PWUuZ2V0WihpKSx0Lnc9ZS5nZXRXKGkpO2NvbnN0IG49MS90Lm1hbmhhdHRhbkxlbmd0aCgpO24hPT0xLzA/dC5tdWx0aXBseVNjYWxhcihuKTp0LnNldCgxLDAsMCwwKSxlLnNldFhZWlcoaSx0LngsdC55LHQueix0LncpfX0sdXBkYXRlTWF0cml4V29ybGQ6ZnVuY3Rpb24odCl7RXMucHJvdG90eXBlLnVwZGF0ZU1hdHJpeFdvcmxkLmNhbGwodGhpcyx0KSxcImF0dGFjaGVkXCI9PT10aGlzLmJpbmRNb2RlP3RoaXMuYmluZE1hdHJpeEludmVyc2UuY29weSh0aGlzLm1hdHJpeFdvcmxkKS5pbnZlcnQoKTpcImRldGFjaGVkXCI9PT10aGlzLmJpbmRNb2RlP3RoaXMuYmluZE1hdHJpeEludmVyc2UuY29weSh0aGlzLmJpbmRNYXRyaXgpLmludmVydCgpOmNvbnNvbGUud2FybihcIlRIUkVFLlNraW5uZWRNZXNoOiBVbnJlY29nbml6ZWQgYmluZE1vZGU6IFwiK3RoaXMuYmluZE1vZGUpfSxib25lVHJhbnNmb3JtOmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLnNrZWxldG9uLG49dGhpcy5nZW9tZXRyeTtTYy5mcm9tQnVmZmVyQXR0cmlidXRlKG4uYXR0cmlidXRlcy5za2luSW5kZXgsdCksTWMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShuLmF0dHJpYnV0ZXMuc2tpbldlaWdodCx0KSx3Yy5mcm9tQnVmZmVyQXR0cmlidXRlKG4uYXR0cmlidXRlcy5wb3NpdGlvbix0KS5hcHBseU1hdHJpeDQodGhpcy5iaW5kTWF0cml4KSxlLnNldCgwLDAsMCk7Zm9yKGxldCB0PTA7dDw0O3QrKyl7Y29uc3Qgbj1NYy5nZXRDb21wb25lbnQodCk7aWYoMCE9PW4pe2NvbnN0IHI9U2MuZ2V0Q29tcG9uZW50KHQpO0NjLm11bHRpcGx5TWF0cmljZXMoaS5ib25lc1tyXS5tYXRyaXhXb3JsZCxpLmJvbmVJbnZlcnNlc1tyXSksZS5hZGRTY2FsZWRWZWN0b3IoVGMuY29weSh3YykuYXBwbHlNYXRyaXg0KENjKSxuKX19cmV0dXJuIGUuYXBwbHlNYXRyaXg0KHRoaXMuYmluZE1hdHJpeEludmVyc2UpfX0pLEljLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocHIucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6SWMsaXNCb25lOiEwfSk7Y29uc3QgQWM9bmV3IEhuLFBjPW5ldyBIbjtmdW5jdGlvbiBSYyh0PVtdLGU9W10pe3RoaXMudXVpZD1ubi5nZW5lcmF0ZVVVSUQoKSx0aGlzLmJvbmVzPXQuc2xpY2UoMCksdGhpcy5ib25lSW52ZXJzZXM9ZSx0aGlzLmJvbmVNYXRyaWNlcz1udWxsLHRoaXMuYm9uZVRleHR1cmU9bnVsbCx0aGlzLmJvbmVUZXh0dXJlU2l6ZT0wLHRoaXMuZnJhbWU9LTEsdGhpcy5pbml0KCl9T2JqZWN0LmFzc2lnbihSYy5wcm90b3R5cGUse2luaXQ6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuYm9uZXMsZT10aGlzLmJvbmVJbnZlcnNlcztpZih0aGlzLmJvbmVNYXRyaWNlcz1uZXcgRmxvYXQzMkFycmF5KDE2KnQubGVuZ3RoKSwwPT09ZS5sZW5ndGgpdGhpcy5jYWxjdWxhdGVJbnZlcnNlcygpO2Vsc2UgaWYodC5sZW5ndGghPT1lLmxlbmd0aCl7Y29uc29sZS53YXJuKFwiVEhSRUUuU2tlbGV0b246IE51bWJlciBvZiBpbnZlcnNlIGJvbmUgbWF0cmljZXMgZG9lcyBub3QgbWF0Y2ggYW1vdW50IG9mIGJvbmVzLlwiKSx0aGlzLmJvbmVJbnZlcnNlcz1bXTtmb3IobGV0IHQ9MCxlPXRoaXMuYm9uZXMubGVuZ3RoO3Q8ZTt0KyspdGhpcy5ib25lSW52ZXJzZXMucHVzaChuZXcgSG4pfX0sY2FsY3VsYXRlSW52ZXJzZXM6ZnVuY3Rpb24oKXt0aGlzLmJvbmVJbnZlcnNlcy5sZW5ndGg9MDtmb3IobGV0IHQ9MCxlPXRoaXMuYm9uZXMubGVuZ3RoO3Q8ZTt0Kyspe2NvbnN0IGU9bmV3IEhuO3RoaXMuYm9uZXNbdF0mJmUuY29weSh0aGlzLmJvbmVzW3RdLm1hdHJpeFdvcmxkKS5pbnZlcnQoKSx0aGlzLmJvbmVJbnZlcnNlcy5wdXNoKGUpfX0scG9zZTpmdW5jdGlvbigpe2ZvcihsZXQgdD0wLGU9dGhpcy5ib25lcy5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT10aGlzLmJvbmVzW3RdO2UmJmUubWF0cml4V29ybGQuY29weSh0aGlzLmJvbmVJbnZlcnNlc1t0XSkuaW52ZXJ0KCl9Zm9yKGxldCB0PTAsZT10aGlzLmJvbmVzLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPXRoaXMuYm9uZXNbdF07ZSYmKGUucGFyZW50JiZlLnBhcmVudC5pc0JvbmU/KGUubWF0cml4LmNvcHkoZS5wYXJlbnQubWF0cml4V29ybGQpLmludmVydCgpLGUubWF0cml4Lm11bHRpcGx5KGUubWF0cml4V29ybGQpKTplLm1hdHJpeC5jb3B5KGUubWF0cml4V29ybGQpLGUubWF0cml4LmRlY29tcG9zZShlLnBvc2l0aW9uLGUucXVhdGVybmlvbixlLnNjYWxlKSl9fSx1cGRhdGU6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuYm9uZXMsZT10aGlzLmJvbmVJbnZlcnNlcyxpPXRoaXMuYm9uZU1hdHJpY2VzLG49dGhpcy5ib25lVGV4dHVyZTtmb3IobGV0IG49MCxyPXQubGVuZ3RoO248cjtuKyspe2NvbnN0IHI9dFtuXT90W25dLm1hdHJpeFdvcmxkOlBjO0FjLm11bHRpcGx5TWF0cmljZXMocixlW25dKSxBYy50b0FycmF5KGksMTYqbil9bnVsbCE9PW4mJihuLm5lZWRzVXBkYXRlPSEwKX0sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFJjKHRoaXMuYm9uZXMsdGhpcy5ib25lSW52ZXJzZXMpfSxnZXRCb25lQnlOYW1lOmZ1bmN0aW9uKHQpe2ZvcihsZXQgZT0wLGk9dGhpcy5ib25lcy5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10aGlzLmJvbmVzW2VdO2lmKGkubmFtZT09PXQpcmV0dXJuIGl9fSxkaXNwb3NlOmZ1bmN0aW9uKCl7bnVsbCE9PXRoaXMuYm9uZVRleHR1cmUmJih0aGlzLmJvbmVUZXh0dXJlLmRpc3Bvc2UoKSx0aGlzLmJvbmVUZXh0dXJlPW51bGwpfSxmcm9tSlNPTjpmdW5jdGlvbih0LGUpe3RoaXMudXVpZD10LnV1aWQ7Zm9yKGxldCBpPTAsbj10LmJvbmVzLmxlbmd0aDtpPG47aSsrKXtjb25zdCBuPXQuYm9uZXNbaV07bGV0IHI9ZVtuXTt2b2lkIDA9PT1yJiYoY29uc29sZS53YXJuKFwiVEhSRUUuU2tlbGV0b246IE5vIGJvbmUgZm91bmQgd2l0aCBVVUlEOlwiLG4pLHI9bmV3IEljKSx0aGlzLmJvbmVzLnB1c2gociksdGhpcy5ib25lSW52ZXJzZXMucHVzaCgobmV3IEhuKS5mcm9tQXJyYXkodC5ib25lSW52ZXJzZXNbaV0pKX1yZXR1cm4gdGhpcy5pbml0KCksdGhpc30sdG9KU09OOmZ1bmN0aW9uKCl7Y29uc3QgdD17bWV0YWRhdGE6e3ZlcnNpb246NC41LHR5cGU6XCJTa2VsZXRvblwiLGdlbmVyYXRvcjpcIlNrZWxldG9uLnRvSlNPTlwifSxib25lczpbXSxib25lSW52ZXJzZXM6W119O3QudXVpZD10aGlzLnV1aWQ7Y29uc3QgZT10aGlzLmJvbmVzLGk9dGhpcy5ib25lSW52ZXJzZXM7Zm9yKGxldCBuPTAscj1lLmxlbmd0aDtuPHI7bisrKXtjb25zdCByPWVbbl07dC5ib25lcy5wdXNoKHIudXVpZCk7Y29uc3Qgcz1pW25dO3QuYm9uZUludmVyc2VzLnB1c2gocy50b0FycmF5KCkpfXJldHVybiB0fX0pO2NvbnN0IExjPW5ldyBIbixPYz1uZXcgSG4sTmM9W10sRGM9bmV3IEVzO2Z1bmN0aW9uICRjKHQsZSxpKXtFcy5jYWxsKHRoaXMsdCxlKSx0aGlzLmluc3RhbmNlTWF0cml4PW5ldyBIcihuZXcgRmxvYXQzMkFycmF5KDE2KmkpLDE2KSx0aGlzLmluc3RhbmNlQ29sb3I9bnVsbCx0aGlzLmNvdW50PWksdGhpcy5mcnVzdHVtQ3VsbGVkPSExfWZ1bmN0aW9uIGtjKHQpe3pyLmNhbGwodGhpcyksdGhpcy50eXBlPVwiTGluZUJhc2ljTWF0ZXJpYWxcIix0aGlzLmNvbG9yPW5ldyBEcigxNjc3NzIxNSksdGhpcy5saW5ld2lkdGg9MSx0aGlzLmxpbmVjYXA9XCJyb3VuZFwiLHRoaXMubGluZWpvaW49XCJyb3VuZFwiLHRoaXMubW9ycGhUYXJnZXRzPSExLHRoaXMuc2V0VmFsdWVzKHQpfSRjLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoRXMucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6JGMsaXNJbnN0YW5jZWRNZXNoOiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIEVzLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmluc3RhbmNlTWF0cml4LmNvcHkodC5pbnN0YW5jZU1hdHJpeCksbnVsbCE9PXQuaW5zdGFuY2VDb2xvciYmKHRoaXMuaW5zdGFuY2VDb2xvcj10Lmluc3RhbmNlQ29sb3IuY2xvbmUoKSksdGhpcy5jb3VudD10LmNvdW50LHRoaXN9LGdldENvbG9yQXQ6ZnVuY3Rpb24odCxlKXtlLmZyb21BcnJheSh0aGlzLmluc3RhbmNlQ29sb3IuYXJyYXksMyp0KX0sZ2V0TWF0cml4QXQ6ZnVuY3Rpb24odCxlKXtlLmZyb21BcnJheSh0aGlzLmluc3RhbmNlTWF0cml4LmFycmF5LDE2KnQpfSxyYXljYXN0OmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLm1hdHJpeFdvcmxkLG49dGhpcy5jb3VudDtpZihEYy5nZW9tZXRyeT10aGlzLmdlb21ldHJ5LERjLm1hdGVyaWFsPXRoaXMubWF0ZXJpYWwsdm9pZCAwIT09RGMubWF0ZXJpYWwpZm9yKGxldCByPTA7cjxuO3IrKyl7dGhpcy5nZXRNYXRyaXhBdChyLExjKSxPYy5tdWx0aXBseU1hdHJpY2VzKGksTGMpLERjLm1hdHJpeFdvcmxkPU9jLERjLnJheWNhc3QodCxOYyk7Zm9yKGxldCB0PTAsaT1OYy5sZW5ndGg7dDxpO3QrKyl7Y29uc3QgaT1OY1t0XTtpLmluc3RhbmNlSWQ9cixpLm9iamVjdD10aGlzLGUucHVzaChpKX1OYy5sZW5ndGg9MH19LHNldENvbG9yQXQ6ZnVuY3Rpb24odCxlKXtudWxsPT09dGhpcy5pbnN0YW5jZUNvbG9yJiYodGhpcy5pbnN0YW5jZUNvbG9yPW5ldyBIcihuZXcgRmxvYXQzMkFycmF5KDMqdGhpcy5jb3VudCksMykpLGUudG9BcnJheSh0aGlzLmluc3RhbmNlQ29sb3IuYXJyYXksMyp0KX0sc2V0TWF0cml4QXQ6ZnVuY3Rpb24odCxlKXtlLnRvQXJyYXkodGhpcy5pbnN0YW5jZU1hdHJpeC5hcnJheSwxNip0KX0sdXBkYXRlTW9ycGhUYXJnZXRzOmZ1bmN0aW9uKCl7fSxkaXNwb3NlOmZ1bmN0aW9uKCl7dGhpcy5kaXNwYXRjaEV2ZW50KHt0eXBlOlwiZGlzcG9zZVwifSl9fSksa2MucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoenIucHJvdG90eXBlKSxrYy5wcm90b3R5cGUuY29uc3RydWN0b3I9a2Msa2MucHJvdG90eXBlLmlzTGluZUJhc2ljTWF0ZXJpYWw9ITAsa2MucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHpyLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmNvbG9yLmNvcHkodC5jb2xvciksdGhpcy5saW5ld2lkdGg9dC5saW5ld2lkdGgsdGhpcy5saW5lY2FwPXQubGluZWNhcCx0aGlzLmxpbmVqb2luPXQubGluZWpvaW4sdGhpcy5tb3JwaFRhcmdldHM9dC5tb3JwaFRhcmdldHMsdGhpc307Y29uc3QgemM9bmV3IGZuLEZjPW5ldyBmbixCYz1uZXcgSG4samM9bmV3IGpuLEhjPW5ldyBPbjtmdW5jdGlvbiBVYyh0PW5ldyBocyxlPW5ldyBrYyl7cHIuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJMaW5lXCIsdGhpcy5nZW9tZXRyeT10LHRoaXMubWF0ZXJpYWw9ZSx0aGlzLnVwZGF0ZU1vcnBoVGFyZ2V0cygpfVVjLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocHIucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6VWMsaXNMaW5lOiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHByLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLm1hdGVyaWFsPXQubWF0ZXJpYWwsdGhpcy5nZW9tZXRyeT10Lmdlb21ldHJ5LHRoaXN9LGNvbXB1dGVMaW5lRGlzdGFuY2VzOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLmdlb21ldHJ5O2lmKHQuaXNCdWZmZXJHZW9tZXRyeSlpZihudWxsPT09dC5pbmRleCl7Y29uc3QgZT10LmF0dHJpYnV0ZXMucG9zaXRpb24saT1bMF07Zm9yKGxldCB0PTEsbj1lLmNvdW50O3Q8bjt0KyspemMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShlLHQtMSksRmMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShlLHQpLGlbdF09aVt0LTFdLGlbdF0rPXpjLmRpc3RhbmNlVG8oRmMpO3Quc2V0QXR0cmlidXRlKFwibGluZURpc3RhbmNlXCIsbmV3IEpyKGksMSkpfWVsc2UgY29uc29sZS53YXJuKFwiVEhSRUUuTGluZS5jb21wdXRlTGluZURpc3RhbmNlcygpOiBDb21wdXRhdGlvbiBvbmx5IHBvc3NpYmxlIHdpdGggbm9uLWluZGV4ZWQgQnVmZmVyR2VvbWV0cnkuXCIpO2Vsc2UgdC5pc0dlb21ldHJ5JiZjb25zb2xlLmVycm9yKFwiVEhSRUUuTGluZS5jb21wdXRlTGluZURpc3RhbmNlcygpIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuXCIpO3JldHVybiB0aGlzfSxyYXljYXN0OmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLmdlb21ldHJ5LG49dGhpcy5tYXRyaXhXb3JsZCxyPXQucGFyYW1zLkxpbmUudGhyZXNob2xkO2lmKG51bGw9PT1pLmJvdW5kaW5nU3BoZXJlJiZpLmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpLEhjLmNvcHkoaS5ib3VuZGluZ1NwaGVyZSksSGMuYXBwbHlNYXRyaXg0KG4pLEhjLnJhZGl1cys9ciwhMT09PXQucmF5LmludGVyc2VjdHNTcGhlcmUoSGMpKXJldHVybjtCYy5jb3B5KG4pLmludmVydCgpLGpjLmNvcHkodC5yYXkpLmFwcGx5TWF0cml4NChCYyk7Y29uc3Qgcz1yLygodGhpcy5zY2FsZS54K3RoaXMuc2NhbGUueSt0aGlzLnNjYWxlLnopLzMpLG89cypzLGE9bmV3IGZuLGM9bmV3IGZuLGg9bmV3IGZuLGw9bmV3IGZuLHU9dGhpcy5pc0xpbmVTZWdtZW50cz8yOjE7aWYoaS5pc0J1ZmZlckdlb21ldHJ5KXtjb25zdCBuPWkuaW5kZXgscj1pLmF0dHJpYnV0ZXMucG9zaXRpb247aWYobnVsbCE9PW4pe2NvbnN0IGk9bi5hcnJheTtmb3IobGV0IG49MCxzPWkubGVuZ3RoLTE7bjxzO24rPXUpe2NvbnN0IHM9aVtuXSx1PWlbbisxXTthLmZyb21CdWZmZXJBdHRyaWJ1dGUocixzKSxjLmZyb21CdWZmZXJBdHRyaWJ1dGUocix1KTtpZihqYy5kaXN0YW5jZVNxVG9TZWdtZW50KGEsYyxsLGgpPm8pY29udGludWU7bC5hcHBseU1hdHJpeDQodGhpcy5tYXRyaXhXb3JsZCk7Y29uc3QgZD10LnJheS5vcmlnaW4uZGlzdGFuY2VUbyhsKTtkPHQubmVhcnx8ZD50LmZhcnx8ZS5wdXNoKHtkaXN0YW5jZTpkLHBvaW50OmguY2xvbmUoKS5hcHBseU1hdHJpeDQodGhpcy5tYXRyaXhXb3JsZCksaW5kZXg6bixmYWNlOm51bGwsZmFjZUluZGV4Om51bGwsb2JqZWN0OnRoaXN9KX19ZWxzZSBmb3IobGV0IGk9MCxuPXIuY291bnQtMTtpPG47aSs9dSl7YS5mcm9tQnVmZmVyQXR0cmlidXRlKHIsaSksYy5mcm9tQnVmZmVyQXR0cmlidXRlKHIsaSsxKTtpZihqYy5kaXN0YW5jZVNxVG9TZWdtZW50KGEsYyxsLGgpPm8pY29udGludWU7bC5hcHBseU1hdHJpeDQodGhpcy5tYXRyaXhXb3JsZCk7Y29uc3Qgbj10LnJheS5vcmlnaW4uZGlzdGFuY2VUbyhsKTtuPHQubmVhcnx8bj50LmZhcnx8ZS5wdXNoKHtkaXN0YW5jZTpuLHBvaW50OmguY2xvbmUoKS5hcHBseU1hdHJpeDQodGhpcy5tYXRyaXhXb3JsZCksaW5kZXg6aSxmYWNlOm51bGwsZmFjZUluZGV4Om51bGwsb2JqZWN0OnRoaXN9KX19ZWxzZSBpLmlzR2VvbWV0cnkmJmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5MaW5lLnJheWNhc3QoKSBubyBsb25nZXIgc3VwcG9ydHMgVEhSRUUuR2VvbWV0cnkuIFVzZSBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLlwiKX0sdXBkYXRlTW9ycGhUYXJnZXRzOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLmdlb21ldHJ5O2lmKHQuaXNCdWZmZXJHZW9tZXRyeSl7Y29uc3QgZT10Lm1vcnBoQXR0cmlidXRlcyxpPU9iamVjdC5rZXlzKGUpO2lmKGkubGVuZ3RoPjApe2NvbnN0IHQ9ZVtpWzBdXTtpZih2b2lkIDAhPT10KXt0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcz1bXSx0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeT17fTtmb3IobGV0IGU9MCxpPXQubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dFtlXS5uYW1lfHxTdHJpbmcoZSk7dGhpcy5tb3JwaFRhcmdldEluZmx1ZW5jZXMucHVzaCgwKSx0aGlzLm1vcnBoVGFyZ2V0RGljdGlvbmFyeVtpXT1lfX19fWVsc2V7Y29uc3QgZT10Lm1vcnBoVGFyZ2V0czt2b2lkIDAhPT1lJiZlLmxlbmd0aD4wJiZjb25zb2xlLmVycm9yKFwiVEhSRUUuTGluZS51cGRhdGVNb3JwaFRhcmdldHMoKSBkb2VzIG5vdCBzdXBwb3J0IFRIUkVFLkdlb21ldHJ5LiBVc2UgVEhSRUUuQnVmZmVyR2VvbWV0cnkgaW5zdGVhZC5cIil9fX0pO2NvbnN0IFZjPW5ldyBmbixHYz1uZXcgZm47ZnVuY3Rpb24gcWModCxlKXtVYy5jYWxsKHRoaXMsdCxlKSx0aGlzLnR5cGU9XCJMaW5lU2VnbWVudHNcIn1mdW5jdGlvbiBXYyh0LGUpe1VjLmNhbGwodGhpcyx0LGUpLHRoaXMudHlwZT1cIkxpbmVMb29wXCJ9ZnVuY3Rpb24gWGModCl7enIuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJQb2ludHNNYXRlcmlhbFwiLHRoaXMuY29sb3I9bmV3IERyKDE2Nzc3MjE1KSx0aGlzLm1hcD1udWxsLHRoaXMuYWxwaGFNYXA9bnVsbCx0aGlzLnNpemU9MSx0aGlzLnNpemVBdHRlbnVhdGlvbj0hMCx0aGlzLm1vcnBoVGFyZ2V0cz0hMSx0aGlzLnNldFZhbHVlcyh0KX1xYy5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKFVjLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnFjLGlzTGluZVNlZ21lbnRzOiEwLGNvbXB1dGVMaW5lRGlzdGFuY2VzOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLmdlb21ldHJ5O2lmKHQuaXNCdWZmZXJHZW9tZXRyeSlpZihudWxsPT09dC5pbmRleCl7Y29uc3QgZT10LmF0dHJpYnV0ZXMucG9zaXRpb24saT1bXTtmb3IobGV0IHQ9MCxuPWUuY291bnQ7dDxuO3QrPTIpVmMuZnJvbUJ1ZmZlckF0dHJpYnV0ZShlLHQpLEdjLmZyb21CdWZmZXJBdHRyaWJ1dGUoZSx0KzEpLGlbdF09MD09PXQ/MDppW3QtMV0saVt0KzFdPWlbdF0rVmMuZGlzdGFuY2VUbyhHYyk7dC5zZXRBdHRyaWJ1dGUoXCJsaW5lRGlzdGFuY2VcIixuZXcgSnIoaSwxKSl9ZWxzZSBjb25zb2xlLndhcm4oXCJUSFJFRS5MaW5lU2VnbWVudHMuY29tcHV0ZUxpbmVEaXN0YW5jZXMoKTogQ29tcHV0YXRpb24gb25seSBwb3NzaWJsZSB3aXRoIG5vbi1pbmRleGVkIEJ1ZmZlckdlb21ldHJ5LlwiKTtlbHNlIHQuaXNHZW9tZXRyeSYmY29uc29sZS5lcnJvcihcIlRIUkVFLkxpbmVTZWdtZW50cy5jb21wdXRlTGluZURpc3RhbmNlcygpIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuXCIpO3JldHVybiB0aGlzfX0pLFdjLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoVWMucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6V2MsaXNMaW5lTG9vcDohMH0pLFhjLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHpyLnByb3RvdHlwZSksWGMucHJvdG90eXBlLmNvbnN0cnVjdG9yPVhjLFhjLnByb3RvdHlwZS5pc1BvaW50c01hdGVyaWFsPSEwLFhjLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiB6ci5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5jb2xvci5jb3B5KHQuY29sb3IpLHRoaXMubWFwPXQubWFwLHRoaXMuYWxwaGFNYXA9dC5hbHBoYU1hcCx0aGlzLnNpemU9dC5zaXplLHRoaXMuc2l6ZUF0dGVudWF0aW9uPXQuc2l6ZUF0dGVudWF0aW9uLHRoaXMubW9ycGhUYXJnZXRzPXQubW9ycGhUYXJnZXRzLHRoaXN9O2NvbnN0IFljPW5ldyBIbixaYz1uZXcgam4sSmM9bmV3IE9uLEtjPW5ldyBmbjtmdW5jdGlvbiBRYyh0PW5ldyBocyxlPW5ldyBYYyl7cHIuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJQb2ludHNcIix0aGlzLmdlb21ldHJ5PXQsdGhpcy5tYXRlcmlhbD1lLHRoaXMudXBkYXRlTW9ycGhUYXJnZXRzKCl9ZnVuY3Rpb24gdGgodCxlLGksbixyLHMsbyl7Y29uc3QgYT1aYy5kaXN0YW5jZVNxVG9Qb2ludCh0KTtpZihhPGkpe2NvbnN0IGk9bmV3IGZuO1pjLmNsb3Nlc3RQb2ludFRvUG9pbnQodCxpKSxpLmFwcGx5TWF0cml4NChuKTtjb25zdCBjPXIucmF5Lm9yaWdpbi5kaXN0YW5jZVRvKGkpO2lmKGM8ci5uZWFyfHxjPnIuZmFyKXJldHVybjtzLnB1c2goe2Rpc3RhbmNlOmMsZGlzdGFuY2VUb1JheTpNYXRoLnNxcnQoYSkscG9pbnQ6aSxpbmRleDplLGZhY2U6bnVsbCxvYmplY3Q6b30pfX1mdW5jdGlvbiBlaCh0LGUsaSxuLHIscyxvLGEsYyl7aG4uY2FsbCh0aGlzLHQsZSxpLG4scixzLG8sYSxjKSx0aGlzLmZvcm1hdD12b2lkIDAhPT1vP286a2ksdGhpcy5taW5GaWx0ZXI9dm9pZCAwIT09cz9zOkFpLHRoaXMubWFnRmlsdGVyPXZvaWQgMCE9PXI/cjpBaSx0aGlzLmdlbmVyYXRlTWlwbWFwcz0hMTtjb25zdCBoPXRoaXM7XCJyZXF1ZXN0VmlkZW9GcmFtZUNhbGxiYWNrXCJpbiB0JiZ0LnJlcXVlc3RWaWRlb0ZyYW1lQ2FsbGJhY2soKGZ1bmN0aW9uIGUoKXtoLm5lZWRzVXBkYXRlPSEwLHQucmVxdWVzdFZpZGVvRnJhbWVDYWxsYmFjayhlKX0pKX1mdW5jdGlvbiBpaCh0LGUsaSxuLHIscyxvLGEsYyxoLGwsdSl7aG4uY2FsbCh0aGlzLG51bGwscyxvLGEsYyxoLG4scixsLHUpLHRoaXMuaW1hZ2U9e3dpZHRoOmUsaGVpZ2h0Oml9LHRoaXMubWlwbWFwcz10LHRoaXMuZmxpcFk9ITEsdGhpcy5nZW5lcmF0ZU1pcG1hcHM9ITF9ZnVuY3Rpb24gbmgodCxlLGksbixyLHMsbyxhLGMpe2huLmNhbGwodGhpcyx0LGUsaSxuLHIscyxvLGEsYyksdGhpcy5uZWVkc1VwZGF0ZT0hMH1mdW5jdGlvbiByaCh0LGUsaSxuLHIscyxvLGEsYyxoKXtpZigoaD12b2lkIDAhPT1oP2g6RmkpIT09RmkmJmghPT1CaSl0aHJvdyBuZXcgRXJyb3IoXCJEZXB0aFRleHR1cmUgZm9ybWF0IG11c3QgYmUgZWl0aGVyIFRIUkVFLkRlcHRoRm9ybWF0IG9yIFRIUkVFLkRlcHRoU3RlbmNpbEZvcm1hdFwiKTt2b2lkIDA9PT1pJiZoPT09RmkmJihpPUxpKSx2b2lkIDA9PT1pJiZoPT09QmkmJihpPSRpKSxobi5jYWxsKHRoaXMsbnVsbCxuLHIscyxvLGEsaCxpLGMpLHRoaXMuaW1hZ2U9e3dpZHRoOnQsaGVpZ2h0OmV9LHRoaXMubWFnRmlsdGVyPXZvaWQgMCE9PW8/bzpJaSx0aGlzLm1pbkZpbHRlcj12b2lkIDAhPT1hP2E6SWksdGhpcy5mbGlwWT0hMSx0aGlzLmdlbmVyYXRlTWlwbWFwcz0hMX1RYy5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHByLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOlFjLGlzUG9pbnRzOiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHByLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLm1hdGVyaWFsPXQubWF0ZXJpYWwsdGhpcy5nZW9tZXRyeT10Lmdlb21ldHJ5LHRoaXN9LHJheWNhc3Q6ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMuZ2VvbWV0cnksbj10aGlzLm1hdHJpeFdvcmxkLHI9dC5wYXJhbXMuUG9pbnRzLnRocmVzaG9sZDtpZihudWxsPT09aS5ib3VuZGluZ1NwaGVyZSYmaS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKSxKYy5jb3B5KGkuYm91bmRpbmdTcGhlcmUpLEpjLmFwcGx5TWF0cml4NChuKSxKYy5yYWRpdXMrPXIsITE9PT10LnJheS5pbnRlcnNlY3RzU3BoZXJlKEpjKSlyZXR1cm47WWMuY29weShuKS5pbnZlcnQoKSxaYy5jb3B5KHQucmF5KS5hcHBseU1hdHJpeDQoWWMpO2NvbnN0IHM9ci8oKHRoaXMuc2NhbGUueCt0aGlzLnNjYWxlLnkrdGhpcy5zY2FsZS56KS8zKSxvPXMqcztpZihpLmlzQnVmZmVyR2VvbWV0cnkpe2NvbnN0IHI9aS5pbmRleCxzPWkuYXR0cmlidXRlcy5wb3NpdGlvbjtpZihudWxsIT09cil7Y29uc3QgaT1yLmFycmF5O2ZvcihsZXQgcj0wLGE9aS5sZW5ndGg7cjxhO3IrKyl7Y29uc3QgYT1pW3JdO0tjLmZyb21CdWZmZXJBdHRyaWJ1dGUocyxhKSx0aChLYyxhLG8sbix0LGUsdGhpcyl9fWVsc2UgZm9yKGxldCBpPTAscj1zLmNvdW50O2k8cjtpKyspS2MuZnJvbUJ1ZmZlckF0dHJpYnV0ZShzLGkpLHRoKEtjLGksbyxuLHQsZSx0aGlzKX1lbHNlIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qb2ludHMucmF5Y2FzdCgpIG5vIGxvbmdlciBzdXBwb3J0cyBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuXCIpfSx1cGRhdGVNb3JwaFRhcmdldHM6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuZ2VvbWV0cnk7aWYodC5pc0J1ZmZlckdlb21ldHJ5KXtjb25zdCBlPXQubW9ycGhBdHRyaWJ1dGVzLGk9T2JqZWN0LmtleXMoZSk7aWYoaS5sZW5ndGg+MCl7Y29uc3QgdD1lW2lbMF1dO2lmKHZvaWQgMCE9PXQpe3RoaXMubW9ycGhUYXJnZXRJbmZsdWVuY2VzPVtdLHRoaXMubW9ycGhUYXJnZXREaWN0aW9uYXJ5PXt9O2ZvcihsZXQgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10W2VdLm5hbWV8fFN0cmluZyhlKTt0aGlzLm1vcnBoVGFyZ2V0SW5mbHVlbmNlcy5wdXNoKDApLHRoaXMubW9ycGhUYXJnZXREaWN0aW9uYXJ5W2ldPWV9fX19ZWxzZXtjb25zdCBlPXQubW9ycGhUYXJnZXRzO3ZvaWQgMCE9PWUmJmUubGVuZ3RoPjAmJmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qb2ludHMudXBkYXRlTW9ycGhUYXJnZXRzKCkgZG9lcyBub3Qgc3VwcG9ydCBUSFJFRS5HZW9tZXRyeS4gVXNlIFRIUkVFLkJ1ZmZlckdlb21ldHJ5IGluc3RlYWQuXCIpfX19KSxlaC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGhuLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOmVoLGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuaW1hZ2UpLmNvcHkodGhpcyl9LGlzVmlkZW9UZXh0dXJlOiEwLHVwZGF0ZTpmdW5jdGlvbigpe2NvbnN0IHQ9dGhpcy5pbWFnZTshMT09PVwicmVxdWVzdFZpZGVvRnJhbWVDYWxsYmFja1wiaW4gdCYmdC5yZWFkeVN0YXRlPj10LkhBVkVfQ1VSUkVOVF9EQVRBJiYodGhpcy5uZWVkc1VwZGF0ZT0hMCl9fSksaWgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoaG4ucHJvdG90eXBlKSxpaC5wcm90b3R5cGUuY29uc3RydWN0b3I9aWgsaWgucHJvdG90eXBlLmlzQ29tcHJlc3NlZFRleHR1cmU9ITAsbmgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoaG4ucHJvdG90eXBlKSxuaC5wcm90b3R5cGUuY29uc3RydWN0b3I9bmgsbmgucHJvdG90eXBlLmlzQ2FudmFzVGV4dHVyZT0hMCxyaC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShobi5wcm90b3R5cGUpLHJoLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1yaCxyaC5wcm90b3R5cGUuaXNEZXB0aFRleHR1cmU9ITA7Y2xhc3Mgc2ggZXh0ZW5kcyBoc3tjb25zdHJ1Y3Rvcih0PTEsZT04LGk9MCxuPTIqTWF0aC5QSSl7c3VwZXIoKSx0aGlzLnR5cGU9XCJDaXJjbGVHZW9tZXRyeVwiLHRoaXMucGFyYW1ldGVycz17cmFkaXVzOnQsc2VnbWVudHM6ZSx0aGV0YVN0YXJ0OmksdGhldGFMZW5ndGg6bn0sZT1NYXRoLm1heCgzLGUpO2NvbnN0IHI9W10scz1bXSxvPVtdLGE9W10sYz1uZXcgZm4saD1uZXcgcm47cy5wdXNoKDAsMCwwKSxvLnB1c2goMCwwLDEpLGEucHVzaCguNSwuNSk7Zm9yKGxldCByPTAsbD0zO3I8PWU7cisrLGwrPTMpe2NvbnN0IHU9aStyL2UqbjtjLng9dCpNYXRoLmNvcyh1KSxjLnk9dCpNYXRoLnNpbih1KSxzLnB1c2goYy54LGMueSxjLnopLG8ucHVzaCgwLDAsMSksaC54PShzW2xdL3QrMSkvMixoLnk9KHNbbCsxXS90KzEpLzIsYS5wdXNoKGgueCxoLnkpfWZvcihsZXQgdD0xO3Q8PWU7dCsrKXIucHVzaCh0LHQrMSwwKTt0aGlzLnNldEluZGV4KHIpLHRoaXMuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSnIocywzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJub3JtYWxcIixuZXcgSnIobywzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJ1dlwiLG5ldyBKcihhLDIpKX19bmV3IGZuLG5ldyBmbixuZXcgZm4sbmV3IElyO2NvbnN0IG9oPWZ1bmN0aW9uKHQsZSxpKXtpPWl8fDI7Y29uc3Qgbj1lJiZlLmxlbmd0aCxyPW4/ZVswXSppOnQubGVuZ3RoO2xldCBzPWFoKHQsMCxyLGksITApO2NvbnN0IG89W107aWYoIXN8fHMubmV4dD09PXMucHJldilyZXR1cm4gbztsZXQgYSxjLGgsbCx1LGQscDtpZihuJiYocz1mdW5jdGlvbih0LGUsaSxuKXtjb25zdCByPVtdO2xldCBzLG8sYSxjLGg7Zm9yKHM9MCxvPWUubGVuZ3RoO3M8bztzKyspYT1lW3NdKm4sYz1zPG8tMT9lW3MrMV0qbjp0Lmxlbmd0aCxoPWFoKHQsYSxjLG4sITEpLGg9PT1oLm5leHQmJihoLnN0ZWluZXI9ITApLHIucHVzaCh2aChoKSk7Zm9yKHIuc29ydChmaCkscz0wO3M8ci5sZW5ndGg7cysrKW1oKHJbc10saSksaT1jaChpLGkubmV4dCk7cmV0dXJuIGl9KHQsZSxzLGkpKSx0Lmxlbmd0aD44MCppKXthPWg9dFswXSxjPWw9dFsxXTtmb3IobGV0IGU9aTtlPHI7ZSs9aSl1PXRbZV0sZD10W2UrMV0sdTxhJiYoYT11KSxkPGMmJihjPWQpLHU+aCYmKGg9dSksZD5sJiYobD1kKTtwPU1hdGgubWF4KGgtYSxsLWMpLHA9MCE9PXA/MS9wOjB9cmV0dXJuIGhoKHMsbyxpLGEsYyxwKSxvfTtmdW5jdGlvbiBhaCh0LGUsaSxuLHIpe2xldCBzLG87aWYocj09PWZ1bmN0aW9uKHQsZSxpLG4pe2xldCByPTA7Zm9yKGxldCBzPWUsbz1pLW47czxpO3MrPW4pcis9KHRbb10tdFtzXSkqKHRbcysxXSt0W28rMV0pLG89cztyZXR1cm4gcn0odCxlLGksbik+MClmb3Iocz1lO3M8aTtzKz1uKW89SWgocyx0W3NdLHRbcysxXSxvKTtlbHNlIGZvcihzPWktbjtzPj1lO3MtPW4pbz1JaChzLHRbc10sdFtzKzFdLG8pO3JldHVybiBvJiZ3aChvLG8ubmV4dCkmJihBaChvKSxvPW8ubmV4dCksb31mdW5jdGlvbiBjaCh0LGUpe2lmKCF0KXJldHVybiB0O2V8fChlPXQpO2xldCBpLG49dDtkb3tpZihpPSExLG4uc3RlaW5lcnx8IXdoKG4sbi5uZXh0KSYmMCE9PXhoKG4ucHJldixuLG4ubmV4dCkpbj1uLm5leHQ7ZWxzZXtpZihBaChuKSxuPWU9bi5wcmV2LG49PT1uLm5leHQpYnJlYWs7aT0hMH19d2hpbGUoaXx8biE9PWUpO3JldHVybiBlfWZ1bmN0aW9uIGhoKHQsZSxpLG4scixzLG8pe2lmKCF0KXJldHVybjshbyYmcyYmZnVuY3Rpb24odCxlLGksbil7bGV0IHI9dDtkb3tudWxsPT09ci56JiYoci56PV9oKHIueCxyLnksZSxpLG4pKSxyLnByZXZaPXIucHJldixyLm5leHRaPXIubmV4dCxyPXIubmV4dH13aGlsZShyIT09dCk7ci5wcmV2Wi5uZXh0Wj1udWxsLHIucHJldlo9bnVsbCxmdW5jdGlvbih0KXtsZXQgZSxpLG4scixzLG8sYSxjLGg9MTtkb3tmb3IoaT10LHQ9bnVsbCxzPW51bGwsbz0wO2k7KXtmb3IobysrLG49aSxhPTAsZT0wO2U8aCYmKGErKyxuPW4ubmV4dFosbik7ZSsrKTtmb3IoYz1oO2E+MHx8Yz4wJiZuOykwIT09YSYmKDA9PT1jfHwhbnx8aS56PD1uLnopPyhyPWksaT1pLm5leHRaLGEtLSk6KHI9bixuPW4ubmV4dFosYy0tKSxzP3MubmV4dFo9cjp0PXIsci5wcmV2Wj1zLHM9cjtpPW59cy5uZXh0Wj1udWxsLGgqPTJ9d2hpbGUobz4xKX0ocil9KHQsbixyLHMpO2xldCBhLGMsaD10O2Zvcig7dC5wcmV2IT09dC5uZXh0OylpZihhPXQucHJldixjPXQubmV4dCxzP3VoKHQsbixyLHMpOmxoKHQpKWUucHVzaChhLmkvaSksZS5wdXNoKHQuaS9pKSxlLnB1c2goYy5pL2kpLEFoKHQpLHQ9Yy5uZXh0LGg9Yy5uZXh0O2Vsc2UgaWYoKHQ9Yyk9PT1oKXtvPzE9PT1vP2hoKHQ9ZGgoY2godCksZSxpKSxlLGksbixyLHMsMik6Mj09PW8mJnBoKHQsZSxpLG4scixzKTpoaChjaCh0KSxlLGksbixyLHMsMSk7YnJlYWt9fWZ1bmN0aW9uIGxoKHQpe2NvbnN0IGU9dC5wcmV2LGk9dCxuPXQubmV4dDtpZih4aChlLGksbik+PTApcmV0dXJuITE7bGV0IHI9dC5uZXh0Lm5leHQ7Zm9yKDtyIT09dC5wcmV2Oyl7aWYoeWgoZS54LGUueSxpLngsaS55LG4ueCxuLnksci54LHIueSkmJnhoKHIucHJldixyLHIubmV4dCk+PTApcmV0dXJuITE7cj1yLm5leHR9cmV0dXJuITB9ZnVuY3Rpb24gdWgodCxlLGksbil7Y29uc3Qgcj10LnByZXYscz10LG89dC5uZXh0O2lmKHhoKHIscyxvKT49MClyZXR1cm4hMTtjb25zdCBhPXIueDxzLng/ci54PG8ueD9yLng6by54OnMueDxvLng/cy54Om8ueCxjPXIueTxzLnk/ci55PG8ueT9yLnk6by55OnMueTxvLnk/cy55Om8ueSxoPXIueD5zLng/ci54Pm8ueD9yLng6by54OnMueD5vLng/cy54Om8ueCxsPXIueT5zLnk/ci55Pm8ueT9yLnk6by55OnMueT5vLnk/cy55Om8ueSx1PV9oKGEsYyxlLGksbiksZD1faChoLGwsZSxpLG4pO2xldCBwPXQucHJldlosZj10Lm5leHRaO2Zvcig7cCYmcC56Pj11JiZmJiZmLno8PWQ7KXtpZihwIT09dC5wcmV2JiZwIT09dC5uZXh0JiZ5aChyLngsci55LHMueCxzLnksby54LG8ueSxwLngscC55KSYmeGgocC5wcmV2LHAscC5uZXh0KT49MClyZXR1cm4hMTtpZihwPXAucHJldlosZiE9PXQucHJldiYmZiE9PXQubmV4dCYmeWgoci54LHIueSxzLngscy55LG8ueCxvLnksZi54LGYueSkmJnhoKGYucHJldixmLGYubmV4dCk+PTApcmV0dXJuITE7Zj1mLm5leHRafWZvcig7cCYmcC56Pj11Oyl7aWYocCE9PXQucHJldiYmcCE9PXQubmV4dCYmeWgoci54LHIueSxzLngscy55LG8ueCxvLnkscC54LHAueSkmJnhoKHAucHJldixwLHAubmV4dCk+PTApcmV0dXJuITE7cD1wLnByZXZafWZvcig7ZiYmZi56PD1kOyl7aWYoZiE9PXQucHJldiYmZiE9PXQubmV4dCYmeWgoci54LHIueSxzLngscy55LG8ueCxvLnksZi54LGYueSkmJnhoKGYucHJldixmLGYubmV4dCk+PTApcmV0dXJuITE7Zj1mLm5leHRafXJldHVybiEwfWZ1bmN0aW9uIGRoKHQsZSxpKXtsZXQgbj10O2Rve2NvbnN0IHI9bi5wcmV2LHM9bi5uZXh0Lm5leHQ7IXdoKHIscykmJlNoKHIsbixuLm5leHQscykmJkNoKHIscykmJkNoKHMscikmJihlLnB1c2goci5pL2kpLGUucHVzaChuLmkvaSksZS5wdXNoKHMuaS9pKSxBaChuKSxBaChuLm5leHQpLG49dD1zKSxuPW4ubmV4dH13aGlsZShuIT09dCk7cmV0dXJuIGNoKG4pfWZ1bmN0aW9uIHBoKHQsZSxpLG4scixzKXtsZXQgbz10O2Rve2xldCB0PW8ubmV4dC5uZXh0O2Zvcig7dCE9PW8ucHJldjspe2lmKG8uaSE9PXQuaSYmYmgobyx0KSl7bGV0IGE9RWgobyx0KTtyZXR1cm4gbz1jaChvLG8ubmV4dCksYT1jaChhLGEubmV4dCksaGgobyxlLGksbixyLHMpLHZvaWQgaGgoYSxlLGksbixyLHMpfXQ9dC5uZXh0fW89by5uZXh0fXdoaWxlKG8hPT10KX1mdW5jdGlvbiBmaCh0LGUpe3JldHVybiB0LngtZS54fWZ1bmN0aW9uIG1oKHQsZSl7aWYoZT1mdW5jdGlvbih0LGUpe2xldCBpPWU7Y29uc3Qgbj10Lngscj10Lnk7bGV0IHMsbz0tMS8wO2Rve2lmKHI8PWkueSYmcj49aS5uZXh0LnkmJmkubmV4dC55IT09aS55KXtjb25zdCB0PWkueCsoci1pLnkpKihpLm5leHQueC1pLngpLyhpLm5leHQueS1pLnkpO2lmKHQ8PW4mJnQ+byl7aWYobz10LHQ9PT1uKXtpZihyPT09aS55KXJldHVybiBpO2lmKHI9PT1pLm5leHQueSlyZXR1cm4gaS5uZXh0fXM9aS54PGkubmV4dC54P2k6aS5uZXh0fX1pPWkubmV4dH13aGlsZShpIT09ZSk7aWYoIXMpcmV0dXJuIG51bGw7aWYobj09PW8pcmV0dXJuIHM7Y29uc3QgYT1zLGM9cy54LGg9cy55O2xldCBsLHU9MS8wO2k9cztkb3tuPj1pLngmJmkueD49YyYmbiE9PWkueCYmeWgocjxoP246byxyLGMsaCxyPGg/bzpuLHIsaS54LGkueSkmJihsPU1hdGguYWJzKHItaS55KS8obi1pLngpLENoKGksdCkmJihsPHV8fGw9PT11JiYoaS54PnMueHx8aS54PT09cy54JiZnaChzLGkpKSkmJihzPWksdT1sKSksaT1pLm5leHR9d2hpbGUoaSE9PWEpO3JldHVybiBzfSh0LGUpKXtjb25zdCBpPUVoKGUsdCk7Y2goZSxlLm5leHQpLGNoKGksaS5uZXh0KX19ZnVuY3Rpb24gZ2godCxlKXtyZXR1cm4geGgodC5wcmV2LHQsZS5wcmV2KTwwJiZ4aChlLm5leHQsdCx0Lm5leHQpPDB9ZnVuY3Rpb24gX2godCxlLGksbixyKXtyZXR1cm4odD0xNDMxNjU1NzY1JigodD04NTg5OTM0NTkmKCh0PTI1MjY0NTEzNSYoKHQ9MTY3MTE5MzUmKCh0PTMyNzY3Kih0LWkpKnIpfHQ8PDgpKXx0PDw0KSl8dDw8MikpfHQ8PDEpKXwoZT0xNDMxNjU1NzY1JigoZT04NTg5OTM0NTkmKChlPTI1MjY0NTEzNSYoKGU9MTY3MTE5MzUmKChlPTMyNzY3KihlLW4pKnIpfGU8PDgpKXxlPDw0KSl8ZTw8MikpfGU8PDEpKTw8MX1mdW5jdGlvbiB2aCh0KXtsZXQgZT10LGk9dDtkb3soZS54PGkueHx8ZS54PT09aS54JiZlLnk8aS55KSYmKGk9ZSksZT1lLm5leHR9d2hpbGUoZSE9PXQpO3JldHVybiBpfWZ1bmN0aW9uIHloKHQsZSxpLG4scixzLG8sYSl7cmV0dXJuKHItbykqKGUtYSktKHQtbykqKHMtYSk+PTAmJih0LW8pKihuLWEpLShpLW8pKihlLWEpPj0wJiYoaS1vKSoocy1hKS0oci1vKSoobi1hKT49MH1mdW5jdGlvbiBiaCh0LGUpe3JldHVybiB0Lm5leHQuaSE9PWUuaSYmdC5wcmV2LmkhPT1lLmkmJiFmdW5jdGlvbih0LGUpe2xldCBpPXQ7ZG97aWYoaS5pIT09dC5pJiZpLm5leHQuaSE9PXQuaSYmaS5pIT09ZS5pJiZpLm5leHQuaSE9PWUuaSYmU2goaSxpLm5leHQsdCxlKSlyZXR1cm4hMDtpPWkubmV4dH13aGlsZShpIT09dCk7cmV0dXJuITF9KHQsZSkmJihDaCh0LGUpJiZDaChlLHQpJiZmdW5jdGlvbih0LGUpe2xldCBpPXQsbj0hMTtjb25zdCByPSh0LngrZS54KS8yLHM9KHQueStlLnkpLzI7ZG97aS55PnMhPWkubmV4dC55PnMmJmkubmV4dC55IT09aS55JiZyPChpLm5leHQueC1pLngpKihzLWkueSkvKGkubmV4dC55LWkueSkraS54JiYobj0hbiksaT1pLm5leHR9d2hpbGUoaSE9PXQpO3JldHVybiBufSh0LGUpJiYoeGgodC5wcmV2LHQsZS5wcmV2KXx8eGgodCxlLnByZXYsZSkpfHx3aCh0LGUpJiZ4aCh0LnByZXYsdCx0Lm5leHQpPjAmJnhoKGUucHJldixlLGUubmV4dCk+MCl9ZnVuY3Rpb24geGgodCxlLGkpe3JldHVybihlLnktdC55KSooaS54LWUueCktKGUueC10LngpKihpLnktZS55KX1mdW5jdGlvbiB3aCh0LGUpe3JldHVybiB0Lng9PT1lLngmJnQueT09PWUueX1mdW5jdGlvbiBTaCh0LGUsaSxuKXtjb25zdCByPVRoKHhoKHQsZSxpKSkscz1UaCh4aCh0LGUsbikpLG89VGgoeGgoaSxuLHQpKSxhPVRoKHhoKGksbixlKSk7cmV0dXJuIHIhPT1zJiZvIT09YXx8KCEoMCE9PXJ8fCFNaCh0LGksZSkpfHwoISgwIT09c3x8IU1oKHQsbixlKSl8fCghKDAhPT1vfHwhTWgoaSx0LG4pKXx8ISgwIT09YXx8IU1oKGksZSxuKSkpKSl9ZnVuY3Rpb24gTWgodCxlLGkpe3JldHVybiBlLng8PU1hdGgubWF4KHQueCxpLngpJiZlLng+PU1hdGgubWluKHQueCxpLngpJiZlLnk8PU1hdGgubWF4KHQueSxpLnkpJiZlLnk+PU1hdGgubWluKHQueSxpLnkpfWZ1bmN0aW9uIFRoKHQpe3JldHVybiB0PjA/MTp0PDA/LTE6MH1mdW5jdGlvbiBDaCh0LGUpe3JldHVybiB4aCh0LnByZXYsdCx0Lm5leHQpPDA/eGgodCxlLHQubmV4dCk+PTAmJnhoKHQsdC5wcmV2LGUpPj0wOnhoKHQsZSx0LnByZXYpPDB8fHhoKHQsdC5uZXh0LGUpPDB9ZnVuY3Rpb24gRWgodCxlKXtjb25zdCBpPW5ldyBQaCh0LmksdC54LHQueSksbj1uZXcgUGgoZS5pLGUueCxlLnkpLHI9dC5uZXh0LHM9ZS5wcmV2O3JldHVybiB0Lm5leHQ9ZSxlLnByZXY9dCxpLm5leHQ9cixyLnByZXY9aSxuLm5leHQ9aSxpLnByZXY9bixzLm5leHQ9bixuLnByZXY9cyxufWZ1bmN0aW9uIEloKHQsZSxpLG4pe2NvbnN0IHI9bmV3IFBoKHQsZSxpKTtyZXR1cm4gbj8oci5uZXh0PW4ubmV4dCxyLnByZXY9bixuLm5leHQucHJldj1yLG4ubmV4dD1yKTooci5wcmV2PXIsci5uZXh0PXIpLHJ9ZnVuY3Rpb24gQWgodCl7dC5uZXh0LnByZXY9dC5wcmV2LHQucHJldi5uZXh0PXQubmV4dCx0LnByZXZaJiYodC5wcmV2Wi5uZXh0Wj10Lm5leHRaKSx0Lm5leHRaJiYodC5uZXh0Wi5wcmV2Wj10LnByZXZaKX1mdW5jdGlvbiBQaCh0LGUsaSl7dGhpcy5pPXQsdGhpcy54PWUsdGhpcy55PWksdGhpcy5wcmV2PW51bGwsdGhpcy5uZXh0PW51bGwsdGhpcy56PW51bGwsdGhpcy5wcmV2Wj1udWxsLHRoaXMubmV4dFo9bnVsbCx0aGlzLnN0ZWluZXI9ITF9Y29uc3QgUmg9e2FyZWE6ZnVuY3Rpb24odCl7Y29uc3QgZT10Lmxlbmd0aDtsZXQgaT0wO2ZvcihsZXQgbj1lLTEscj0wO3I8ZTtuPXIrKylpKz10W25dLngqdFtyXS55LXRbcl0ueCp0W25dLnk7cmV0dXJuLjUqaX0saXNDbG9ja1dpc2U6ZnVuY3Rpb24odCl7cmV0dXJuIFJoLmFyZWEodCk8MH0sdHJpYW5ndWxhdGVTaGFwZTpmdW5jdGlvbih0LGUpe2NvbnN0IGk9W10sbj1bXSxyPVtdO0xoKHQpLE9oKGksdCk7bGV0IHM9dC5sZW5ndGg7ZS5mb3JFYWNoKExoKTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoO3QrKyluLnB1c2gocykscys9ZVt0XS5sZW5ndGgsT2goaSxlW3RdKTtjb25zdCBvPW9oKGksbik7Zm9yKGxldCB0PTA7dDxvLmxlbmd0aDt0Kz0zKXIucHVzaChvLnNsaWNlKHQsdCszKSk7cmV0dXJuIHJ9fTtmdW5jdGlvbiBMaCh0KXtjb25zdCBlPXQubGVuZ3RoO2U+MiYmdFtlLTFdLmVxdWFscyh0WzBdKSYmdC5wb3AoKX1mdW5jdGlvbiBPaCh0LGUpe2ZvcihsZXQgaT0wO2k8ZS5sZW5ndGg7aSsrKXQucHVzaChlW2ldLngpLHQucHVzaChlW2ldLnkpfWNsYXNzIE5oIGV4dGVuZHMgaHN7Y29uc3RydWN0b3IodCxlKXtzdXBlcigpLHRoaXMudHlwZT1cIkV4dHJ1ZGVHZW9tZXRyeVwiLHRoaXMucGFyYW1ldGVycz17c2hhcGVzOnQsb3B0aW9uczplfSx0PUFycmF5LmlzQXJyYXkodCk/dDpbdF07Y29uc3QgaT10aGlzLG49W10scj1bXTtmb3IobGV0IGU9MCxpPXQubGVuZ3RoO2U8aTtlKyspe3ModFtlXSl9ZnVuY3Rpb24gcyh0KXtjb25zdCBzPVtdLG89dm9pZCAwIT09ZS5jdXJ2ZVNlZ21lbnRzP2UuY3VydmVTZWdtZW50czoxMixhPXZvaWQgMCE9PWUuc3RlcHM/ZS5zdGVwczoxO2xldCBjPXZvaWQgMCE9PWUuZGVwdGg/ZS5kZXB0aDoxMDAsaD12b2lkIDA9PT1lLmJldmVsRW5hYmxlZHx8ZS5iZXZlbEVuYWJsZWQsbD12b2lkIDAhPT1lLmJldmVsVGhpY2tuZXNzP2UuYmV2ZWxUaGlja25lc3M6Nix1PXZvaWQgMCE9PWUuYmV2ZWxTaXplP2UuYmV2ZWxTaXplOmwtMixkPXZvaWQgMCE9PWUuYmV2ZWxPZmZzZXQ/ZS5iZXZlbE9mZnNldDowLHA9dm9pZCAwIT09ZS5iZXZlbFNlZ21lbnRzP2UuYmV2ZWxTZWdtZW50czozO2NvbnN0IGY9ZS5leHRydWRlUGF0aCxtPXZvaWQgMCE9PWUuVVZHZW5lcmF0b3I/ZS5VVkdlbmVyYXRvcjpEaDt2b2lkIDAhPT1lLmFtb3VudCYmKGNvbnNvbGUud2FybihcIlRIUkVFLkV4dHJ1ZGVCdWZmZXJHZW9tZXRyeTogYW1vdW50IGhhcyBiZWVuIHJlbmFtZWQgdG8gZGVwdGguXCIpLGM9ZS5hbW91bnQpO2xldCBnLF8sdix5LGIseD0hMTtmJiYoZz1mLmdldFNwYWNlZFBvaW50cyhhKSx4PSEwLGg9ITEsXz1mLmNvbXB1dGVGcmVuZXRGcmFtZXMoYSwhMSksdj1uZXcgZm4seT1uZXcgZm4sYj1uZXcgZm4pLGh8fChwPTAsbD0wLHU9MCxkPTApO2NvbnN0IHc9dC5leHRyYWN0UG9pbnRzKG8pO2xldCBTPXcuc2hhcGU7Y29uc3QgTT13LmhvbGVzO2lmKCFSaC5pc0Nsb2NrV2lzZShTKSl7Uz1TLnJldmVyc2UoKTtmb3IobGV0IHQ9MCxlPU0ubGVuZ3RoO3Q8ZTt0Kyspe2NvbnN0IGU9TVt0XTtSaC5pc0Nsb2NrV2lzZShlKSYmKE1bdF09ZS5yZXZlcnNlKCkpfX1jb25zdCBUPVJoLnRyaWFuZ3VsYXRlU2hhcGUoUyxNKSxDPVM7Zm9yKGxldCB0PTAsZT1NLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPU1bdF07Uz1TLmNvbmNhdChlKX1mdW5jdGlvbiBFKHQsZSxpKXtyZXR1cm4gZXx8Y29uc29sZS5lcnJvcihcIlRIUkVFLkV4dHJ1ZGVHZW9tZXRyeTogdmVjIGRvZXMgbm90IGV4aXN0XCIpLGUuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihpKS5hZGQodCl9Y29uc3QgST1TLmxlbmd0aCxBPVQubGVuZ3RoO2Z1bmN0aW9uIFAodCxlLGkpe2xldCBuLHIscztjb25zdCBvPXQueC1lLngsYT10LnktZS55LGM9aS54LXQueCxoPWkueS10LnksbD1vKm8rYSphLHU9bypoLWEqYztpZihNYXRoLmFicyh1KT5OdW1iZXIuRVBTSUxPTil7Y29uc3QgdT1NYXRoLnNxcnQobCksZD1NYXRoLnNxcnQoYypjK2gqaCkscD1lLngtYS91LGY9ZS55K28vdSxtPSgoaS54LWgvZC1wKSpoLShpLnkrYy9kLWYpKmMpLyhvKmgtYSpjKTtuPXArbyptLXQueCxyPWYrYSptLXQueTtjb25zdCBnPW4qbityKnI7aWYoZzw9MilyZXR1cm4gbmV3IHJuKG4scik7cz1NYXRoLnNxcnQoZy8yKX1lbHNle2xldCB0PSExO28+TnVtYmVyLkVQU0lMT04/Yz5OdW1iZXIuRVBTSUxPTiYmKHQ9ITApOm88LU51bWJlci5FUFNJTE9OP2M8LU51bWJlci5FUFNJTE9OJiYodD0hMCk6TWF0aC5zaWduKGEpPT09TWF0aC5zaWduKGgpJiYodD0hMCksdD8obj0tYSxyPW8scz1NYXRoLnNxcnQobCkpOihuPW8scj1hLHM9TWF0aC5zcXJ0KGwvMikpfXJldHVybiBuZXcgcm4obi9zLHIvcyl9Y29uc3QgUj1bXTtmb3IobGV0IHQ9MCxlPUMubGVuZ3RoLGk9ZS0xLG49dCsxO3Q8ZTt0KyssaSsrLG4rKylpPT09ZSYmKGk9MCksbj09PWUmJihuPTApLFJbdF09UChDW3RdLENbaV0sQ1tuXSk7Y29uc3QgTD1bXTtsZXQgTyxOPVIuY29uY2F0KCk7Zm9yKGxldCB0PTAsZT1NLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPU1bdF07Tz1bXTtmb3IobGV0IHQ9MCxpPWUubGVuZ3RoLG49aS0xLHI9dCsxO3Q8aTt0KyssbisrLHIrKyluPT09aSYmKG49MCkscj09PWkmJihyPTApLE9bdF09UChlW3RdLGVbbl0sZVtyXSk7TC5wdXNoKE8pLE49Ti5jb25jYXQoTyl9Zm9yKGxldCB0PTA7dDxwO3QrKyl7Y29uc3QgZT10L3AsaT1sKk1hdGguY29zKGUqTWF0aC5QSS8yKSxuPXUqTWF0aC5zaW4oZSpNYXRoLlBJLzIpK2Q7Zm9yKGxldCB0PTAsZT1DLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPUUoQ1t0XSxSW3RdLG4pO2soZS54LGUueSwtaSl9Zm9yKGxldCB0PTAsZT1NLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPU1bdF07Tz1MW3RdO2ZvcihsZXQgdD0wLHI9ZS5sZW5ndGg7dDxyO3QrKyl7Y29uc3Qgcj1FKGVbdF0sT1t0XSxuKTtrKHIueCxyLnksLWkpfX19Y29uc3QgRD11K2Q7Zm9yKGxldCB0PTA7dDxJO3QrKyl7Y29uc3QgZT1oP0UoU1t0XSxOW3RdLEQpOlNbdF07eD8oeS5jb3B5KF8ubm9ybWFsc1swXSkubXVsdGlwbHlTY2FsYXIoZS54KSx2LmNvcHkoXy5iaW5vcm1hbHNbMF0pLm11bHRpcGx5U2NhbGFyKGUueSksYi5jb3B5KGdbMF0pLmFkZCh5KS5hZGQodiksayhiLngsYi55LGIueikpOmsoZS54LGUueSwwKX1mb3IobGV0IHQ9MTt0PD1hO3QrKylmb3IobGV0IGU9MDtlPEk7ZSsrKXtjb25zdCBpPWg/RShTW2VdLE5bZV0sRCk6U1tlXTt4Pyh5LmNvcHkoXy5ub3JtYWxzW3RdKS5tdWx0aXBseVNjYWxhcihpLngpLHYuY29weShfLmJpbm9ybWFsc1t0XSkubXVsdGlwbHlTY2FsYXIoaS55KSxiLmNvcHkoZ1t0XSkuYWRkKHkpLmFkZCh2KSxrKGIueCxiLnksYi56KSk6ayhpLngsaS55LGMvYSp0KX1mb3IobGV0IHQ9cC0xO3Q+PTA7dC0tKXtjb25zdCBlPXQvcCxpPWwqTWF0aC5jb3MoZSpNYXRoLlBJLzIpLG49dSpNYXRoLnNpbihlKk1hdGguUEkvMikrZDtmb3IobGV0IHQ9MCxlPUMubGVuZ3RoO3Q8ZTt0Kyspe2NvbnN0IGU9RShDW3RdLFJbdF0sbik7ayhlLngsZS55LGMraSl9Zm9yKGxldCB0PTAsZT1NLmxlbmd0aDt0PGU7dCsrKXtjb25zdCBlPU1bdF07Tz1MW3RdO2ZvcihsZXQgdD0wLHI9ZS5sZW5ndGg7dDxyO3QrKyl7Y29uc3Qgcj1FKGVbdF0sT1t0XSxuKTt4P2soci54LHIueStnW2EtMV0ueSxnW2EtMV0ueCtpKTprKHIueCxyLnksYytpKX19fWZ1bmN0aW9uICQodCxlKXtsZXQgaT10Lmxlbmd0aDtmb3IoOy0taT49MDspe2NvbnN0IG49aTtsZXQgcj1pLTE7cjwwJiYocj10Lmxlbmd0aC0xKTtmb3IobGV0IHQ9MCxpPWErMipwO3Q8aTt0Kyspe2NvbnN0IGk9SSp0LHM9SSoodCsxKTtGKGUrbitpLGUrcitpLGUrcitzLGUrbitzKX19fWZ1bmN0aW9uIGsodCxlLGkpe3MucHVzaCh0KSxzLnB1c2goZSkscy5wdXNoKGkpfWZ1bmN0aW9uIHoodCxlLHIpe0IodCksQihlKSxCKHIpO2NvbnN0IHM9bi5sZW5ndGgvMyxvPW0uZ2VuZXJhdGVUb3BVVihpLG4scy0zLHMtMixzLTEpO2oob1swXSksaihvWzFdKSxqKG9bMl0pfWZ1bmN0aW9uIEYodCxlLHIscyl7Qih0KSxCKGUpLEIocyksQihlKSxCKHIpLEIocyk7Y29uc3Qgbz1uLmxlbmd0aC8zLGE9bS5nZW5lcmF0ZVNpZGVXYWxsVVYoaSxuLG8tNixvLTMsby0yLG8tMSk7aihhWzBdKSxqKGFbMV0pLGooYVszXSksaihhWzFdKSxqKGFbMl0pLGooYVszXSl9ZnVuY3Rpb24gQih0KXtuLnB1c2goc1szKnQrMF0pLG4ucHVzaChzWzMqdCsxXSksbi5wdXNoKHNbMyp0KzJdKX1mdW5jdGlvbiBqKHQpe3IucHVzaCh0LngpLHIucHVzaCh0LnkpfSFmdW5jdGlvbigpe2NvbnN0IHQ9bi5sZW5ndGgvMztpZihoKXtsZXQgdD0wLGU9SSp0O2ZvcihsZXQgdD0wO3Q8QTt0Kyspe2NvbnN0IGk9VFt0XTt6KGlbMl0rZSxpWzFdK2UsaVswXStlKX10PWErMipwLGU9SSp0O2ZvcihsZXQgdD0wO3Q8QTt0Kyspe2NvbnN0IGk9VFt0XTt6KGlbMF0rZSxpWzFdK2UsaVsyXStlKX19ZWxzZXtmb3IobGV0IHQ9MDt0PEE7dCsrKXtjb25zdCBlPVRbdF07eihlWzJdLGVbMV0sZVswXSl9Zm9yKGxldCB0PTA7dDxBO3QrKyl7Y29uc3QgZT1UW3RdO3ooZVswXStJKmEsZVsxXStJKmEsZVsyXStJKmEpfX1pLmFkZEdyb3VwKHQsbi5sZW5ndGgvMy10LDApfSgpLGZ1bmN0aW9uKCl7Y29uc3QgdD1uLmxlbmd0aC8zO2xldCBlPTA7JChDLGUpLGUrPUMubGVuZ3RoO2ZvcihsZXQgdD0wLGk9TS5sZW5ndGg7dDxpO3QrKyl7Y29uc3QgaT1NW3RdOyQoaSxlKSxlKz1pLmxlbmd0aH1pLmFkZEdyb3VwKHQsbi5sZW5ndGgvMy10LDEpfSgpfXRoaXMuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSnIobiwzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJ1dlwiLG5ldyBKcihyLDIpKSx0aGlzLmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCl9dG9KU09OKCl7Y29uc3QgdD1ocy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7cmV0dXJuIGZ1bmN0aW9uKHQsZSxpKXtpZihpLnNoYXBlcz1bXSxBcnJheS5pc0FycmF5KHQpKWZvcihsZXQgZT0wLG49dC5sZW5ndGg7ZTxuO2UrKyl7Y29uc3Qgbj10W2VdO2kuc2hhcGVzLnB1c2gobi51dWlkKX1lbHNlIGkuc2hhcGVzLnB1c2godC51dWlkKTt2b2lkIDAhPT1lLmV4dHJ1ZGVQYXRoJiYoaS5vcHRpb25zLmV4dHJ1ZGVQYXRoPWUuZXh0cnVkZVBhdGgudG9KU09OKCkpO3JldHVybiBpfSh0aGlzLnBhcmFtZXRlcnMuc2hhcGVzLHRoaXMucGFyYW1ldGVycy5vcHRpb25zLHQpfX1jb25zdCBEaD17Z2VuZXJhdGVUb3BVVjpmdW5jdGlvbih0LGUsaSxuLHIpe2NvbnN0IHM9ZVszKmldLG89ZVszKmkrMV0sYT1lWzMqbl0sYz1lWzMqbisxXSxoPWVbMypyXSxsPWVbMypyKzFdO3JldHVybltuZXcgcm4ocyxvKSxuZXcgcm4oYSxjKSxuZXcgcm4oaCxsKV19LGdlbmVyYXRlU2lkZVdhbGxVVjpmdW5jdGlvbih0LGUsaSxuLHIscyl7Y29uc3Qgbz1lWzMqaV0sYT1lWzMqaSsxXSxjPWVbMyppKzJdLGg9ZVszKm5dLGw9ZVszKm4rMV0sdT1lWzMqbisyXSxkPWVbMypyXSxwPWVbMypyKzFdLGY9ZVszKnIrMl0sbT1lWzMqc10sZz1lWzMqcysxXSxfPWVbMypzKzJdO3JldHVybiBNYXRoLmFicyhhLWwpPC4wMT9bbmV3IHJuKG8sMS1jKSxuZXcgcm4oaCwxLXUpLG5ldyBybihkLDEtZiksbmV3IHJuKG0sMS1fKV06W25ldyBybihhLDEtYyksbmV3IHJuKGwsMS11KSxuZXcgcm4ocCwxLWYpLG5ldyBybihnLDEtXyldfX07ZnVuY3Rpb24gJGgodCxlLGkpe2hzLmNhbGwodGhpcyksdGhpcy50eXBlPVwiUGFyYW1ldHJpY0dlb21ldHJ5XCIsdGhpcy5wYXJhbWV0ZXJzPXtmdW5jOnQsc2xpY2VzOmUsc3RhY2tzOml9O2NvbnN0IG49W10scj1bXSxzPVtdLG89W10sYT0xZS01LGM9bmV3IGZuLGg9bmV3IGZuLGw9bmV3IGZuLHU9bmV3IGZuLGQ9bmV3IGZuO3QubGVuZ3RoPDMmJmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5QYXJhbWV0cmljR2VvbWV0cnk6IEZ1bmN0aW9uIG11c3Qgbm93IG1vZGlmeSBhIFZlY3RvcjMgYXMgdGhpcmQgcGFyYW1ldGVyLlwiKTtjb25zdCBwPWUrMTtmb3IobGV0IG49MDtuPD1pO24rKyl7Y29uc3QgcD1uL2k7Zm9yKGxldCBpPTA7aTw9ZTtpKyspe2NvbnN0IG49aS9lO3QobixwLGgpLHIucHVzaChoLngsaC55LGgueiksbi1hPj0wPyh0KG4tYSxwLGwpLHUuc3ViVmVjdG9ycyhoLGwpKToodChuK2EscCxsKSx1LnN1YlZlY3RvcnMobCxoKSkscC1hPj0wPyh0KG4scC1hLGwpLGQuc3ViVmVjdG9ycyhoLGwpKToodChuLHArYSxsKSxkLnN1YlZlY3RvcnMobCxoKSksYy5jcm9zc1ZlY3RvcnModSxkKS5ub3JtYWxpemUoKSxzLnB1c2goYy54LGMueSxjLnopLG8ucHVzaChuLHApfX1mb3IobGV0IHQ9MDt0PGk7dCsrKWZvcihsZXQgaT0wO2k8ZTtpKyspe2NvbnN0IGU9dCpwK2kscj10KnAraSsxLHM9KHQrMSkqcCtpKzEsbz0odCsxKSpwK2k7bi5wdXNoKGUscixvKSxuLnB1c2gocixzLG8pfXRoaXMuc2V0SW5kZXgobiksdGhpcy5zZXRBdHRyaWJ1dGUoXCJwb3NpdGlvblwiLG5ldyBKcihyLDMpKSx0aGlzLnNldEF0dHJpYnV0ZShcIm5vcm1hbFwiLG5ldyBKcihzLDMpKSx0aGlzLnNldEF0dHJpYnV0ZShcInV2XCIsbmV3IEpyKG8sMikpfSRoLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGhzLnByb3RvdHlwZSksJGgucHJvdG90eXBlLmNvbnN0cnVjdG9yPSRoO2NsYXNzIGtoIGV4dGVuZHMgaHN7Y29uc3RydWN0b3IodCxlPTEyKXtzdXBlcigpLHRoaXMudHlwZT1cIlNoYXBlR2VvbWV0cnlcIix0aGlzLnBhcmFtZXRlcnM9e3NoYXBlczp0LGN1cnZlU2VnbWVudHM6ZX07Y29uc3QgaT1bXSxuPVtdLHI9W10scz1bXTtsZXQgbz0wLGE9MDtpZighMT09PUFycmF5LmlzQXJyYXkodCkpYyh0KTtlbHNlIGZvcihsZXQgZT0wO2U8dC5sZW5ndGg7ZSsrKWModFtlXSksdGhpcy5hZGRHcm91cChvLGEsZSksbys9YSxhPTA7ZnVuY3Rpb24gYyh0KXtjb25zdCBvPW4ubGVuZ3RoLzMsYz10LmV4dHJhY3RQb2ludHMoZSk7bGV0IGg9Yy5zaGFwZTtjb25zdCBsPWMuaG9sZXM7ITE9PT1SaC5pc0Nsb2NrV2lzZShoKSYmKGg9aC5yZXZlcnNlKCkpO2ZvcihsZXQgdD0wLGU9bC5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT1sW3RdOyEwPT09UmguaXNDbG9ja1dpc2UoZSkmJihsW3RdPWUucmV2ZXJzZSgpKX1jb25zdCB1PVJoLnRyaWFuZ3VsYXRlU2hhcGUoaCxsKTtmb3IobGV0IHQ9MCxlPWwubGVuZ3RoO3Q8ZTt0Kyspe2NvbnN0IGU9bFt0XTtoPWguY29uY2F0KGUpfWZvcihsZXQgdD0wLGU9aC5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT1oW3RdO24ucHVzaChlLngsZS55LDApLHIucHVzaCgwLDAsMSkscy5wdXNoKGUueCxlLnkpfWZvcihsZXQgdD0wLGU9dS5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT11W3RdLG49ZVswXStvLHI9ZVsxXStvLHM9ZVsyXStvO2kucHVzaChuLHIscyksYSs9M319dGhpcy5zZXRJbmRleChpKSx0aGlzLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEpyKG4sMykpLHRoaXMuc2V0QXR0cmlidXRlKFwibm9ybWFsXCIsbmV3IEpyKHIsMykpLHRoaXMuc2V0QXR0cmlidXRlKFwidXZcIixuZXcgSnIocywyKSl9dG9KU09OKCl7Y29uc3QgdD1ocy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7aWYoZS5zaGFwZXM9W10sQXJyYXkuaXNBcnJheSh0KSlmb3IobGV0IGk9MCxuPXQubGVuZ3RoO2k8bjtpKyspe2NvbnN0IG49dFtpXTtlLnNoYXBlcy5wdXNoKG4udXVpZCl9ZWxzZSBlLnNoYXBlcy5wdXNoKHQudXVpZCk7cmV0dXJuIGV9KHRoaXMucGFyYW1ldGVycy5zaGFwZXMsdCl9fWNsYXNzIHpoIGV4dGVuZHMgaHN7Y29uc3RydWN0b3IodD0xLGU9OCxpPTYsbj0wLHI9MipNYXRoLlBJLHM9MCxvPU1hdGguUEkpe3N1cGVyKCksdGhpcy50eXBlPVwiU3BoZXJlR2VvbWV0cnlcIix0aGlzLnBhcmFtZXRlcnM9e3JhZGl1czp0LHdpZHRoU2VnbWVudHM6ZSxoZWlnaHRTZWdtZW50czppLHBoaVN0YXJ0Om4scGhpTGVuZ3RoOnIsdGhldGFTdGFydDpzLHRoZXRhTGVuZ3RoOm99LGU9TWF0aC5tYXgoMyxNYXRoLmZsb29yKGUpKSxpPU1hdGgubWF4KDIsTWF0aC5mbG9vcihpKSk7Y29uc3QgYT1NYXRoLm1pbihzK28sTWF0aC5QSSk7bGV0IGM9MDtjb25zdCBoPVtdLGw9bmV3IGZuLHU9bmV3IGZuLGQ9W10scD1bXSxmPVtdLG09W107Zm9yKGxldCBkPTA7ZDw9aTtkKyspe2NvbnN0IGc9W10sXz1kL2k7bGV0IHY9MDswPT1kJiYwPT1zP3Y9LjUvZTpkPT1pJiZhPT1NYXRoLlBJJiYodj0tLjUvZSk7Zm9yKGxldCBpPTA7aTw9ZTtpKyspe2NvbnN0IGE9aS9lO2wueD0tdCpNYXRoLmNvcyhuK2EqcikqTWF0aC5zaW4ocytfKm8pLGwueT10Kk1hdGguY29zKHMrXypvKSxsLno9dCpNYXRoLnNpbihuK2EqcikqTWF0aC5zaW4ocytfKm8pLHAucHVzaChsLngsbC55LGwueiksdS5jb3B5KGwpLm5vcm1hbGl6ZSgpLGYucHVzaCh1LngsdS55LHUueiksbS5wdXNoKGErdiwxLV8pLGcucHVzaChjKyspfWgucHVzaChnKX1mb3IobGV0IHQ9MDt0PGk7dCsrKWZvcihsZXQgbj0wO248ZTtuKyspe2NvbnN0IGU9aFt0XVtuKzFdLHI9aFt0XVtuXSxvPWhbdCsxXVtuXSxjPWhbdCsxXVtuKzFdOygwIT09dHx8cz4wKSYmZC5wdXNoKGUscixjKSwodCE9PWktMXx8YTxNYXRoLlBJKSYmZC5wdXNoKHIsbyxjKX10aGlzLnNldEluZGV4KGQpLHRoaXMuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSnIocCwzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJub3JtYWxcIixuZXcgSnIoZiwzKSksdGhpcy5zZXRBdHRyaWJ1dGUoXCJ1dlwiLG5ldyBKcihtLDIpKX19ZnVuY3Rpb24gRmgodCl7enIuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJTaGFkb3dNYXRlcmlhbFwiLHRoaXMuY29sb3I9bmV3IERyKDApLHRoaXMudHJhbnNwYXJlbnQ9ITAsdGhpcy5zZXRWYWx1ZXModCl9ZnVuY3Rpb24gQmgodCl7T3MuY2FsbCh0aGlzLHQpLHRoaXMudHlwZT1cIlJhd1NoYWRlck1hdGVyaWFsXCJ9ZnVuY3Rpb24gamgodCl7enIuY2FsbCh0aGlzKSx0aGlzLmRlZmluZXM9e1NUQU5EQVJEOlwiXCJ9LHRoaXMudHlwZT1cIk1lc2hTdGFuZGFyZE1hdGVyaWFsXCIsdGhpcy5jb2xvcj1uZXcgRHIoMTY3NzcyMTUpLHRoaXMucm91Z2huZXNzPTEsdGhpcy5tZXRhbG5lc3M9MCx0aGlzLm1hcD1udWxsLHRoaXMubGlnaHRNYXA9bnVsbCx0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5PTEsdGhpcy5hb01hcD1udWxsLHRoaXMuYW9NYXBJbnRlbnNpdHk9MSx0aGlzLmVtaXNzaXZlPW5ldyBEcigwKSx0aGlzLmVtaXNzaXZlSW50ZW5zaXR5PTEsdGhpcy5lbWlzc2l2ZU1hcD1udWxsLHRoaXMuYnVtcE1hcD1udWxsLHRoaXMuYnVtcFNjYWxlPTEsdGhpcy5ub3JtYWxNYXA9bnVsbCx0aGlzLm5vcm1hbE1hcFR5cGU9MCx0aGlzLm5vcm1hbFNjYWxlPW5ldyBybigxLDEpLHRoaXMuZGlzcGxhY2VtZW50TWFwPW51bGwsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT0xLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz0wLHRoaXMucm91Z2huZXNzTWFwPW51bGwsdGhpcy5tZXRhbG5lc3NNYXA9bnVsbCx0aGlzLmFscGhhTWFwPW51bGwsdGhpcy5lbnZNYXA9bnVsbCx0aGlzLmVudk1hcEludGVuc2l0eT0xLHRoaXMucmVmcmFjdGlvblJhdGlvPS45OCx0aGlzLndpcmVmcmFtZT0hMSx0aGlzLndpcmVmcmFtZUxpbmV3aWR0aD0xLHRoaXMud2lyZWZyYW1lTGluZWNhcD1cInJvdW5kXCIsdGhpcy53aXJlZnJhbWVMaW5lam9pbj1cInJvdW5kXCIsdGhpcy5za2lubmluZz0hMSx0aGlzLm1vcnBoVGFyZ2V0cz0hMSx0aGlzLm1vcnBoTm9ybWFscz0hMSx0aGlzLnZlcnRleFRhbmdlbnRzPSExLHRoaXMuc2V0VmFsdWVzKHQpfWZ1bmN0aW9uIEhoKHQpe2poLmNhbGwodGhpcyksdGhpcy5kZWZpbmVzPXtTVEFOREFSRDpcIlwiLFBIWVNJQ0FMOlwiXCJ9LHRoaXMudHlwZT1cIk1lc2hQaHlzaWNhbE1hdGVyaWFsXCIsdGhpcy5jbGVhcmNvYXQ9MCx0aGlzLmNsZWFyY29hdE1hcD1udWxsLHRoaXMuY2xlYXJjb2F0Um91Z2huZXNzPTAsdGhpcy5jbGVhcmNvYXRSb3VnaG5lc3NNYXA9bnVsbCx0aGlzLmNsZWFyY29hdE5vcm1hbFNjYWxlPW5ldyBybigxLDEpLHRoaXMuY2xlYXJjb2F0Tm9ybWFsTWFwPW51bGwsdGhpcy5yZWZsZWN0aXZpdHk9LjUsT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpb3JcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuKDErLjQqdGhpcy5yZWZsZWN0aXZpdHkpLygxLS40KnRoaXMucmVmbGVjdGl2aXR5KX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMucmVmbGVjdGl2aXR5PW5uLmNsYW1wKDIuNSoodC0xKS8odCsxKSwwLDEpfX0pLHRoaXMuc2hlZW49bnVsbCx0aGlzLnRyYW5zbWlzc2lvbj0wLHRoaXMudHJhbnNtaXNzaW9uTWFwPW51bGwsdGhpcy5zZXRWYWx1ZXModCl9ZnVuY3Rpb24gVWgodCl7enIuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJNZXNoUGhvbmdNYXRlcmlhbFwiLHRoaXMuY29sb3I9bmV3IERyKDE2Nzc3MjE1KSx0aGlzLnNwZWN1bGFyPW5ldyBEcigxMTE4NDgxKSx0aGlzLnNoaW5pbmVzcz0zMCx0aGlzLm1hcD1udWxsLHRoaXMubGlnaHRNYXA9bnVsbCx0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5PTEsdGhpcy5hb01hcD1udWxsLHRoaXMuYW9NYXBJbnRlbnNpdHk9MSx0aGlzLmVtaXNzaXZlPW5ldyBEcigwKSx0aGlzLmVtaXNzaXZlSW50ZW5zaXR5PTEsdGhpcy5lbWlzc2l2ZU1hcD1udWxsLHRoaXMuYnVtcE1hcD1udWxsLHRoaXMuYnVtcFNjYWxlPTEsdGhpcy5ub3JtYWxNYXA9bnVsbCx0aGlzLm5vcm1hbE1hcFR5cGU9MCx0aGlzLm5vcm1hbFNjYWxlPW5ldyBybigxLDEpLHRoaXMuZGlzcGxhY2VtZW50TWFwPW51bGwsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT0xLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz0wLHRoaXMuc3BlY3VsYXJNYXA9bnVsbCx0aGlzLmFscGhhTWFwPW51bGwsdGhpcy5lbnZNYXA9bnVsbCx0aGlzLmNvbWJpbmU9MCx0aGlzLnJlZmxlY3Rpdml0eT0xLHRoaXMucmVmcmFjdGlvblJhdGlvPS45OCx0aGlzLndpcmVmcmFtZT0hMSx0aGlzLndpcmVmcmFtZUxpbmV3aWR0aD0xLHRoaXMud2lyZWZyYW1lTGluZWNhcD1cInJvdW5kXCIsdGhpcy53aXJlZnJhbWVMaW5lam9pbj1cInJvdW5kXCIsdGhpcy5za2lubmluZz0hMSx0aGlzLm1vcnBoVGFyZ2V0cz0hMSx0aGlzLm1vcnBoTm9ybWFscz0hMSx0aGlzLnNldFZhbHVlcyh0KX1mdW5jdGlvbiBWaCh0KXt6ci5jYWxsKHRoaXMpLHRoaXMuZGVmaW5lcz17VE9PTjpcIlwifSx0aGlzLnR5cGU9XCJNZXNoVG9vbk1hdGVyaWFsXCIsdGhpcy5jb2xvcj1uZXcgRHIoMTY3NzcyMTUpLHRoaXMubWFwPW51bGwsdGhpcy5ncmFkaWVudE1hcD1udWxsLHRoaXMubGlnaHRNYXA9bnVsbCx0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5PTEsdGhpcy5hb01hcD1udWxsLHRoaXMuYW9NYXBJbnRlbnNpdHk9MSx0aGlzLmVtaXNzaXZlPW5ldyBEcigwKSx0aGlzLmVtaXNzaXZlSW50ZW5zaXR5PTEsdGhpcy5lbWlzc2l2ZU1hcD1udWxsLHRoaXMuYnVtcE1hcD1udWxsLHRoaXMuYnVtcFNjYWxlPTEsdGhpcy5ub3JtYWxNYXA9bnVsbCx0aGlzLm5vcm1hbE1hcFR5cGU9MCx0aGlzLm5vcm1hbFNjYWxlPW5ldyBybigxLDEpLHRoaXMuZGlzcGxhY2VtZW50TWFwPW51bGwsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT0xLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz0wLHRoaXMuYWxwaGFNYXA9bnVsbCx0aGlzLndpcmVmcmFtZT0hMSx0aGlzLndpcmVmcmFtZUxpbmV3aWR0aD0xLHRoaXMud2lyZWZyYW1lTGluZWNhcD1cInJvdW5kXCIsdGhpcy53aXJlZnJhbWVMaW5lam9pbj1cInJvdW5kXCIsdGhpcy5za2lubmluZz0hMSx0aGlzLm1vcnBoVGFyZ2V0cz0hMSx0aGlzLm1vcnBoTm9ybWFscz0hMSx0aGlzLnNldFZhbHVlcyh0KX1mdW5jdGlvbiBHaCh0KXt6ci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIk1lc2hOb3JtYWxNYXRlcmlhbFwiLHRoaXMuYnVtcE1hcD1udWxsLHRoaXMuYnVtcFNjYWxlPTEsdGhpcy5ub3JtYWxNYXA9bnVsbCx0aGlzLm5vcm1hbE1hcFR5cGU9MCx0aGlzLm5vcm1hbFNjYWxlPW5ldyBybigxLDEpLHRoaXMuZGlzcGxhY2VtZW50TWFwPW51bGwsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT0xLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz0wLHRoaXMud2lyZWZyYW1lPSExLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPTEsdGhpcy5mb2c9ITEsdGhpcy5za2lubmluZz0hMSx0aGlzLm1vcnBoVGFyZ2V0cz0hMSx0aGlzLm1vcnBoTm9ybWFscz0hMSx0aGlzLnNldFZhbHVlcyh0KX1mdW5jdGlvbiBxaCh0KXt6ci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIk1lc2hMYW1iZXJ0TWF0ZXJpYWxcIix0aGlzLmNvbG9yPW5ldyBEcigxNjc3NzIxNSksdGhpcy5tYXA9bnVsbCx0aGlzLmxpZ2h0TWFwPW51bGwsdGhpcy5saWdodE1hcEludGVuc2l0eT0xLHRoaXMuYW9NYXA9bnVsbCx0aGlzLmFvTWFwSW50ZW5zaXR5PTEsdGhpcy5lbWlzc2l2ZT1uZXcgRHIoMCksdGhpcy5lbWlzc2l2ZUludGVuc2l0eT0xLHRoaXMuZW1pc3NpdmVNYXA9bnVsbCx0aGlzLnNwZWN1bGFyTWFwPW51bGwsdGhpcy5hbHBoYU1hcD1udWxsLHRoaXMuZW52TWFwPW51bGwsdGhpcy5jb21iaW5lPTAsdGhpcy5yZWZsZWN0aXZpdHk9MSx0aGlzLnJlZnJhY3Rpb25SYXRpbz0uOTgsdGhpcy53aXJlZnJhbWU9ITEsdGhpcy53aXJlZnJhbWVMaW5ld2lkdGg9MSx0aGlzLndpcmVmcmFtZUxpbmVjYXA9XCJyb3VuZFwiLHRoaXMud2lyZWZyYW1lTGluZWpvaW49XCJyb3VuZFwiLHRoaXMuc2tpbm5pbmc9ITEsdGhpcy5tb3JwaFRhcmdldHM9ITEsdGhpcy5tb3JwaE5vcm1hbHM9ITEsdGhpcy5zZXRWYWx1ZXModCl9ZnVuY3Rpb24gV2godCl7enIuY2FsbCh0aGlzKSx0aGlzLmRlZmluZXM9e01BVENBUDpcIlwifSx0aGlzLnR5cGU9XCJNZXNoTWF0Y2FwTWF0ZXJpYWxcIix0aGlzLmNvbG9yPW5ldyBEcigxNjc3NzIxNSksdGhpcy5tYXRjYXA9bnVsbCx0aGlzLm1hcD1udWxsLHRoaXMuYnVtcE1hcD1udWxsLHRoaXMuYnVtcFNjYWxlPTEsdGhpcy5ub3JtYWxNYXA9bnVsbCx0aGlzLm5vcm1hbE1hcFR5cGU9MCx0aGlzLm5vcm1hbFNjYWxlPW5ldyBybigxLDEpLHRoaXMuZGlzcGxhY2VtZW50TWFwPW51bGwsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT0xLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz0wLHRoaXMuYWxwaGFNYXA9bnVsbCx0aGlzLnNraW5uaW5nPSExLHRoaXMubW9ycGhUYXJnZXRzPSExLHRoaXMubW9ycGhOb3JtYWxzPSExLHRoaXMuc2V0VmFsdWVzKHQpfWZ1bmN0aW9uIFhoKHQpe2tjLmNhbGwodGhpcyksdGhpcy50eXBlPVwiTGluZURhc2hlZE1hdGVyaWFsXCIsdGhpcy5zY2FsZT0xLHRoaXMuZGFzaFNpemU9Myx0aGlzLmdhcFNpemU9MSx0aGlzLnNldFZhbHVlcyh0KX1GaC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh6ci5wcm90b3R5cGUpLEZoLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1GaCxGaC5wcm90b3R5cGUuaXNTaGFkb3dNYXRlcmlhbD0hMCxGaC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4genIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuY29sb3IuY29weSh0LmNvbG9yKSx0aGlzfSxCaC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShPcy5wcm90b3R5cGUpLEJoLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1CaCxCaC5wcm90b3R5cGUuaXNSYXdTaGFkZXJNYXRlcmlhbD0hMCxqaC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh6ci5wcm90b3R5cGUpLGpoLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1qaCxqaC5wcm90b3R5cGUuaXNNZXNoU3RhbmRhcmRNYXRlcmlhbD0hMCxqaC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4genIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuZGVmaW5lcz17U1RBTkRBUkQ6XCJcIn0sdGhpcy5jb2xvci5jb3B5KHQuY29sb3IpLHRoaXMucm91Z2huZXNzPXQucm91Z2huZXNzLHRoaXMubWV0YWxuZXNzPXQubWV0YWxuZXNzLHRoaXMubWFwPXQubWFwLHRoaXMubGlnaHRNYXA9dC5saWdodE1hcCx0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5PXQubGlnaHRNYXBJbnRlbnNpdHksdGhpcy5hb01hcD10LmFvTWFwLHRoaXMuYW9NYXBJbnRlbnNpdHk9dC5hb01hcEludGVuc2l0eSx0aGlzLmVtaXNzaXZlLmNvcHkodC5lbWlzc2l2ZSksdGhpcy5lbWlzc2l2ZU1hcD10LmVtaXNzaXZlTWFwLHRoaXMuZW1pc3NpdmVJbnRlbnNpdHk9dC5lbWlzc2l2ZUludGVuc2l0eSx0aGlzLmJ1bXBNYXA9dC5idW1wTWFwLHRoaXMuYnVtcFNjYWxlPXQuYnVtcFNjYWxlLHRoaXMubm9ybWFsTWFwPXQubm9ybWFsTWFwLHRoaXMubm9ybWFsTWFwVHlwZT10Lm5vcm1hbE1hcFR5cGUsdGhpcy5ub3JtYWxTY2FsZS5jb3B5KHQubm9ybWFsU2NhbGUpLHRoaXMuZGlzcGxhY2VtZW50TWFwPXQuZGlzcGxhY2VtZW50TWFwLHRoaXMuZGlzcGxhY2VtZW50U2NhbGU9dC5kaXNwbGFjZW1lbnRTY2FsZSx0aGlzLmRpc3BsYWNlbWVudEJpYXM9dC5kaXNwbGFjZW1lbnRCaWFzLHRoaXMucm91Z2huZXNzTWFwPXQucm91Z2huZXNzTWFwLHRoaXMubWV0YWxuZXNzTWFwPXQubWV0YWxuZXNzTWFwLHRoaXMuYWxwaGFNYXA9dC5hbHBoYU1hcCx0aGlzLmVudk1hcD10LmVudk1hcCx0aGlzLmVudk1hcEludGVuc2l0eT10LmVudk1hcEludGVuc2l0eSx0aGlzLnJlZnJhY3Rpb25SYXRpbz10LnJlZnJhY3Rpb25SYXRpbyx0aGlzLndpcmVmcmFtZT10LndpcmVmcmFtZSx0aGlzLndpcmVmcmFtZUxpbmV3aWR0aD10LndpcmVmcmFtZUxpbmV3aWR0aCx0aGlzLndpcmVmcmFtZUxpbmVjYXA9dC53aXJlZnJhbWVMaW5lY2FwLHRoaXMud2lyZWZyYW1lTGluZWpvaW49dC53aXJlZnJhbWVMaW5lam9pbix0aGlzLnNraW5uaW5nPXQuc2tpbm5pbmcsdGhpcy5tb3JwaFRhcmdldHM9dC5tb3JwaFRhcmdldHMsdGhpcy5tb3JwaE5vcm1hbHM9dC5tb3JwaE5vcm1hbHMsdGhpcy52ZXJ0ZXhUYW5nZW50cz10LnZlcnRleFRhbmdlbnRzLHRoaXN9LEhoLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGpoLnByb3RvdHlwZSksSGgucHJvdG90eXBlLmNvbnN0cnVjdG9yPUhoLEhoLnByb3RvdHlwZS5pc01lc2hQaHlzaWNhbE1hdGVyaWFsPSEwLEhoLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiBqaC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5kZWZpbmVzPXtTVEFOREFSRDpcIlwiLFBIWVNJQ0FMOlwiXCJ9LHRoaXMuY2xlYXJjb2F0PXQuY2xlYXJjb2F0LHRoaXMuY2xlYXJjb2F0TWFwPXQuY2xlYXJjb2F0TWFwLHRoaXMuY2xlYXJjb2F0Um91Z2huZXNzPXQuY2xlYXJjb2F0Um91Z2huZXNzLHRoaXMuY2xlYXJjb2F0Um91Z2huZXNzTWFwPXQuY2xlYXJjb2F0Um91Z2huZXNzTWFwLHRoaXMuY2xlYXJjb2F0Tm9ybWFsTWFwPXQuY2xlYXJjb2F0Tm9ybWFsTWFwLHRoaXMuY2xlYXJjb2F0Tm9ybWFsU2NhbGUuY29weSh0LmNsZWFyY29hdE5vcm1hbFNjYWxlKSx0aGlzLnJlZmxlY3Rpdml0eT10LnJlZmxlY3Rpdml0eSx0LnNoZWVuP3RoaXMuc2hlZW49KHRoaXMuc2hlZW58fG5ldyBEcikuY29weSh0LnNoZWVuKTp0aGlzLnNoZWVuPW51bGwsdGhpcy50cmFuc21pc3Npb249dC50cmFuc21pc3Npb24sdGhpcy50cmFuc21pc3Npb25NYXA9dC50cmFuc21pc3Npb25NYXAsdGhpc30sVWgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoenIucHJvdG90eXBlKSxVaC5wcm90b3R5cGUuY29uc3RydWN0b3I9VWgsVWgucHJvdG90eXBlLmlzTWVzaFBob25nTWF0ZXJpYWw9ITAsVWgucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHpyLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmNvbG9yLmNvcHkodC5jb2xvciksdGhpcy5zcGVjdWxhci5jb3B5KHQuc3BlY3VsYXIpLHRoaXMuc2hpbmluZXNzPXQuc2hpbmluZXNzLHRoaXMubWFwPXQubWFwLHRoaXMubGlnaHRNYXA9dC5saWdodE1hcCx0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5PXQubGlnaHRNYXBJbnRlbnNpdHksdGhpcy5hb01hcD10LmFvTWFwLHRoaXMuYW9NYXBJbnRlbnNpdHk9dC5hb01hcEludGVuc2l0eSx0aGlzLmVtaXNzaXZlLmNvcHkodC5lbWlzc2l2ZSksdGhpcy5lbWlzc2l2ZU1hcD10LmVtaXNzaXZlTWFwLHRoaXMuZW1pc3NpdmVJbnRlbnNpdHk9dC5lbWlzc2l2ZUludGVuc2l0eSx0aGlzLmJ1bXBNYXA9dC5idW1wTWFwLHRoaXMuYnVtcFNjYWxlPXQuYnVtcFNjYWxlLHRoaXMubm9ybWFsTWFwPXQubm9ybWFsTWFwLHRoaXMubm9ybWFsTWFwVHlwZT10Lm5vcm1hbE1hcFR5cGUsdGhpcy5ub3JtYWxTY2FsZS5jb3B5KHQubm9ybWFsU2NhbGUpLHRoaXMuZGlzcGxhY2VtZW50TWFwPXQuZGlzcGxhY2VtZW50TWFwLHRoaXMuZGlzcGxhY2VtZW50U2NhbGU9dC5kaXNwbGFjZW1lbnRTY2FsZSx0aGlzLmRpc3BsYWNlbWVudEJpYXM9dC5kaXNwbGFjZW1lbnRCaWFzLHRoaXMuc3BlY3VsYXJNYXA9dC5zcGVjdWxhck1hcCx0aGlzLmFscGhhTWFwPXQuYWxwaGFNYXAsdGhpcy5lbnZNYXA9dC5lbnZNYXAsdGhpcy5jb21iaW5lPXQuY29tYmluZSx0aGlzLnJlZmxlY3Rpdml0eT10LnJlZmxlY3Rpdml0eSx0aGlzLnJlZnJhY3Rpb25SYXRpbz10LnJlZnJhY3Rpb25SYXRpbyx0aGlzLndpcmVmcmFtZT10LndpcmVmcmFtZSx0aGlzLndpcmVmcmFtZUxpbmV3aWR0aD10LndpcmVmcmFtZUxpbmV3aWR0aCx0aGlzLndpcmVmcmFtZUxpbmVjYXA9dC53aXJlZnJhbWVMaW5lY2FwLHRoaXMud2lyZWZyYW1lTGluZWpvaW49dC53aXJlZnJhbWVMaW5lam9pbix0aGlzLnNraW5uaW5nPXQuc2tpbm5pbmcsdGhpcy5tb3JwaFRhcmdldHM9dC5tb3JwaFRhcmdldHMsdGhpcy5tb3JwaE5vcm1hbHM9dC5tb3JwaE5vcm1hbHMsdGhpc30sVmgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoenIucHJvdG90eXBlKSxWaC5wcm90b3R5cGUuY29uc3RydWN0b3I9VmgsVmgucHJvdG90eXBlLmlzTWVzaFRvb25NYXRlcmlhbD0hMCxWaC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4genIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuY29sb3IuY29weSh0LmNvbG9yKSx0aGlzLm1hcD10Lm1hcCx0aGlzLmdyYWRpZW50TWFwPXQuZ3JhZGllbnRNYXAsdGhpcy5saWdodE1hcD10LmxpZ2h0TWFwLHRoaXMubGlnaHRNYXBJbnRlbnNpdHk9dC5saWdodE1hcEludGVuc2l0eSx0aGlzLmFvTWFwPXQuYW9NYXAsdGhpcy5hb01hcEludGVuc2l0eT10LmFvTWFwSW50ZW5zaXR5LHRoaXMuZW1pc3NpdmUuY29weSh0LmVtaXNzaXZlKSx0aGlzLmVtaXNzaXZlTWFwPXQuZW1pc3NpdmVNYXAsdGhpcy5lbWlzc2l2ZUludGVuc2l0eT10LmVtaXNzaXZlSW50ZW5zaXR5LHRoaXMuYnVtcE1hcD10LmJ1bXBNYXAsdGhpcy5idW1wU2NhbGU9dC5idW1wU2NhbGUsdGhpcy5ub3JtYWxNYXA9dC5ub3JtYWxNYXAsdGhpcy5ub3JtYWxNYXBUeXBlPXQubm9ybWFsTWFwVHlwZSx0aGlzLm5vcm1hbFNjYWxlLmNvcHkodC5ub3JtYWxTY2FsZSksdGhpcy5kaXNwbGFjZW1lbnRNYXA9dC5kaXNwbGFjZW1lbnRNYXAsdGhpcy5kaXNwbGFjZW1lbnRTY2FsZT10LmRpc3BsYWNlbWVudFNjYWxlLHRoaXMuZGlzcGxhY2VtZW50Qmlhcz10LmRpc3BsYWNlbWVudEJpYXMsdGhpcy5hbHBoYU1hcD10LmFscGhhTWFwLHRoaXMud2lyZWZyYW1lPXQud2lyZWZyYW1lLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPXQud2lyZWZyYW1lTGluZXdpZHRoLHRoaXMud2lyZWZyYW1lTGluZWNhcD10LndpcmVmcmFtZUxpbmVjYXAsdGhpcy53aXJlZnJhbWVMaW5lam9pbj10LndpcmVmcmFtZUxpbmVqb2luLHRoaXMuc2tpbm5pbmc9dC5za2lubmluZyx0aGlzLm1vcnBoVGFyZ2V0cz10Lm1vcnBoVGFyZ2V0cyx0aGlzLm1vcnBoTm9ybWFscz10Lm1vcnBoTm9ybWFscyx0aGlzfSxHaC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh6ci5wcm90b3R5cGUpLEdoLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1HaCxHaC5wcm90b3R5cGUuaXNNZXNoTm9ybWFsTWF0ZXJpYWw9ITAsR2gucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7cmV0dXJuIHpyLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmJ1bXBNYXA9dC5idW1wTWFwLHRoaXMuYnVtcFNjYWxlPXQuYnVtcFNjYWxlLHRoaXMubm9ybWFsTWFwPXQubm9ybWFsTWFwLHRoaXMubm9ybWFsTWFwVHlwZT10Lm5vcm1hbE1hcFR5cGUsdGhpcy5ub3JtYWxTY2FsZS5jb3B5KHQubm9ybWFsU2NhbGUpLHRoaXMuZGlzcGxhY2VtZW50TWFwPXQuZGlzcGxhY2VtZW50TWFwLHRoaXMuZGlzcGxhY2VtZW50U2NhbGU9dC5kaXNwbGFjZW1lbnRTY2FsZSx0aGlzLmRpc3BsYWNlbWVudEJpYXM9dC5kaXNwbGFjZW1lbnRCaWFzLHRoaXMud2lyZWZyYW1lPXQud2lyZWZyYW1lLHRoaXMud2lyZWZyYW1lTGluZXdpZHRoPXQud2lyZWZyYW1lTGluZXdpZHRoLHRoaXMuc2tpbm5pbmc9dC5za2lubmluZyx0aGlzLm1vcnBoVGFyZ2V0cz10Lm1vcnBoVGFyZ2V0cyx0aGlzLm1vcnBoTm9ybWFscz10Lm1vcnBoTm9ybWFscyx0aGlzfSxxaC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh6ci5wcm90b3R5cGUpLHFoLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1xaCxxaC5wcm90b3R5cGUuaXNNZXNoTGFtYmVydE1hdGVyaWFsPSEwLHFoLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiB6ci5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5jb2xvci5jb3B5KHQuY29sb3IpLHRoaXMubWFwPXQubWFwLHRoaXMubGlnaHRNYXA9dC5saWdodE1hcCx0aGlzLmxpZ2h0TWFwSW50ZW5zaXR5PXQubGlnaHRNYXBJbnRlbnNpdHksdGhpcy5hb01hcD10LmFvTWFwLHRoaXMuYW9NYXBJbnRlbnNpdHk9dC5hb01hcEludGVuc2l0eSx0aGlzLmVtaXNzaXZlLmNvcHkodC5lbWlzc2l2ZSksdGhpcy5lbWlzc2l2ZU1hcD10LmVtaXNzaXZlTWFwLHRoaXMuZW1pc3NpdmVJbnRlbnNpdHk9dC5lbWlzc2l2ZUludGVuc2l0eSx0aGlzLnNwZWN1bGFyTWFwPXQuc3BlY3VsYXJNYXAsdGhpcy5hbHBoYU1hcD10LmFscGhhTWFwLHRoaXMuZW52TWFwPXQuZW52TWFwLHRoaXMuY29tYmluZT10LmNvbWJpbmUsdGhpcy5yZWZsZWN0aXZpdHk9dC5yZWZsZWN0aXZpdHksdGhpcy5yZWZyYWN0aW9uUmF0aW89dC5yZWZyYWN0aW9uUmF0aW8sdGhpcy53aXJlZnJhbWU9dC53aXJlZnJhbWUsdGhpcy53aXJlZnJhbWVMaW5ld2lkdGg9dC53aXJlZnJhbWVMaW5ld2lkdGgsdGhpcy53aXJlZnJhbWVMaW5lY2FwPXQud2lyZWZyYW1lTGluZWNhcCx0aGlzLndpcmVmcmFtZUxpbmVqb2luPXQud2lyZWZyYW1lTGluZWpvaW4sdGhpcy5za2lubmluZz10LnNraW5uaW5nLHRoaXMubW9ycGhUYXJnZXRzPXQubW9ycGhUYXJnZXRzLHRoaXMubW9ycGhOb3JtYWxzPXQubW9ycGhOb3JtYWxzLHRoaXN9LFdoLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHpyLnByb3RvdHlwZSksV2gucHJvdG90eXBlLmNvbnN0cnVjdG9yPVdoLFdoLnByb3RvdHlwZS5pc01lc2hNYXRjYXBNYXRlcmlhbD0hMCxXaC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4genIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuZGVmaW5lcz17TUFUQ0FQOlwiXCJ9LHRoaXMuY29sb3IuY29weSh0LmNvbG9yKSx0aGlzLm1hdGNhcD10Lm1hdGNhcCx0aGlzLm1hcD10Lm1hcCx0aGlzLmJ1bXBNYXA9dC5idW1wTWFwLHRoaXMuYnVtcFNjYWxlPXQuYnVtcFNjYWxlLHRoaXMubm9ybWFsTWFwPXQubm9ybWFsTWFwLHRoaXMubm9ybWFsTWFwVHlwZT10Lm5vcm1hbE1hcFR5cGUsdGhpcy5ub3JtYWxTY2FsZS5jb3B5KHQubm9ybWFsU2NhbGUpLHRoaXMuZGlzcGxhY2VtZW50TWFwPXQuZGlzcGxhY2VtZW50TWFwLHRoaXMuZGlzcGxhY2VtZW50U2NhbGU9dC5kaXNwbGFjZW1lbnRTY2FsZSx0aGlzLmRpc3BsYWNlbWVudEJpYXM9dC5kaXNwbGFjZW1lbnRCaWFzLHRoaXMuYWxwaGFNYXA9dC5hbHBoYU1hcCx0aGlzLnNraW5uaW5nPXQuc2tpbm5pbmcsdGhpcy5tb3JwaFRhcmdldHM9dC5tb3JwaFRhcmdldHMsdGhpcy5tb3JwaE5vcm1hbHM9dC5tb3JwaE5vcm1hbHMsdGhpc30sWGgucHJvdG90eXBlPU9iamVjdC5jcmVhdGUoa2MucHJvdG90eXBlKSxYaC5wcm90b3R5cGUuY29uc3RydWN0b3I9WGgsWGgucHJvdG90eXBlLmlzTGluZURhc2hlZE1hdGVyaWFsPSEwLFhoLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiBrYy5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5zY2FsZT10LnNjYWxlLHRoaXMuZGFzaFNpemU9dC5kYXNoU2l6ZSx0aGlzLmdhcFNpemU9dC5nYXBTaXplLHRoaXN9O3ZhciBZaD1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxTaGFkb3dNYXRlcmlhbDpGaCxTcHJpdGVNYXRlcmlhbDpuYyxSYXdTaGFkZXJNYXRlcmlhbDpCaCxTaGFkZXJNYXRlcmlhbDpPcyxQb2ludHNNYXRlcmlhbDpYYyxNZXNoUGh5c2ljYWxNYXRlcmlhbDpIaCxNZXNoU3RhbmRhcmRNYXRlcmlhbDpqaCxNZXNoUGhvbmdNYXRlcmlhbDpVaCxNZXNoVG9vbk1hdGVyaWFsOlZoLE1lc2hOb3JtYWxNYXRlcmlhbDpHaCxNZXNoTGFtYmVydE1hdGVyaWFsOnFoLE1lc2hEZXB0aE1hdGVyaWFsOkJhLE1lc2hEaXN0YW5jZU1hdGVyaWFsOmphLE1lc2hCYXNpY01hdGVyaWFsOkZyLE1lc2hNYXRjYXBNYXRlcmlhbDpXaCxMaW5lRGFzaGVkTWF0ZXJpYWw6WGgsTGluZUJhc2ljTWF0ZXJpYWw6a2MsTWF0ZXJpYWw6enJ9KTtjb25zdCBaaD17YXJyYXlTbGljZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIFpoLmlzVHlwZWRBcnJheSh0KT9uZXcgdC5jb25zdHJ1Y3Rvcih0LnN1YmFycmF5KGUsdm9pZCAwIT09aT9pOnQubGVuZ3RoKSk6dC5zbGljZShlLGkpfSxjb252ZXJ0QXJyYXk6ZnVuY3Rpb24odCxlLGkpe3JldHVybiF0fHwhaSYmdC5jb25zdHJ1Y3Rvcj09PWU/dDpcIm51bWJlclwiPT10eXBlb2YgZS5CWVRFU19QRVJfRUxFTUVOVD9uZXcgZSh0KTpBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KX0saXNUeXBlZEFycmF5OmZ1bmN0aW9uKHQpe3JldHVybiBBcnJheUJ1ZmZlci5pc1ZpZXcodCkmJiEodCBpbnN0YW5jZW9mIERhdGFWaWV3KX0sZ2V0S2V5ZnJhbWVPcmRlcjpmdW5jdGlvbih0KXtjb25zdCBlPXQubGVuZ3RoLGk9bmV3IEFycmF5KGUpO2ZvcihsZXQgdD0wO3QhPT1lOysrdClpW3RdPXQ7cmV0dXJuIGkuc29ydCgoZnVuY3Rpb24oZSxpKXtyZXR1cm4gdFtlXS10W2ldfSkpLGl9LHNvcnRlZEFycmF5OmZ1bmN0aW9uKHQsZSxpKXtjb25zdCBuPXQubGVuZ3RoLHI9bmV3IHQuY29uc3RydWN0b3Iobik7Zm9yKGxldCBzPTAsbz0wO28hPT1uOysrcyl7Y29uc3Qgbj1pW3NdKmU7Zm9yKGxldCBpPTA7aSE9PWU7KytpKXJbbysrXT10W24raV19cmV0dXJuIHJ9LGZsYXR0ZW5KU09OOmZ1bmN0aW9uKHQsZSxpLG4pe2xldCByPTEscz10WzBdO2Zvcig7dm9pZCAwIT09cyYmdm9pZCAwPT09c1tuXTspcz10W3IrK107aWYodm9pZCAwPT09cylyZXR1cm47bGV0IG89c1tuXTtpZih2b2lkIDAhPT1vKWlmKEFycmF5LmlzQXJyYXkobykpZG97bz1zW25dLHZvaWQgMCE9PW8mJihlLnB1c2gocy50aW1lKSxpLnB1c2guYXBwbHkoaSxvKSkscz10W3IrK119d2hpbGUodm9pZCAwIT09cyk7ZWxzZSBpZih2b2lkIDAhPT1vLnRvQXJyYXkpZG97bz1zW25dLHZvaWQgMCE9PW8mJihlLnB1c2gocy50aW1lKSxvLnRvQXJyYXkoaSxpLmxlbmd0aCkpLHM9dFtyKytdfXdoaWxlKHZvaWQgMCE9PXMpO2Vsc2UgZG97bz1zW25dLHZvaWQgMCE9PW8mJihlLnB1c2gocy50aW1lKSxpLnB1c2gobykpLHM9dFtyKytdfXdoaWxlKHZvaWQgMCE9PXMpfSxzdWJjbGlwOmZ1bmN0aW9uKHQsZSxpLG4scj0zMCl7Y29uc3Qgcz10LmNsb25lKCk7cy5uYW1lPWU7Y29uc3Qgbz1bXTtmb3IobGV0IHQ9MDt0PHMudHJhY2tzLmxlbmd0aDsrK3Qpe2NvbnN0IGU9cy50cmFja3NbdF0sYT1lLmdldFZhbHVlU2l6ZSgpLGM9W10saD1bXTtmb3IobGV0IHQ9MDt0PGUudGltZXMubGVuZ3RoOysrdCl7Y29uc3Qgcz1lLnRpbWVzW3RdKnI7aWYoIShzPGl8fHM+PW4pKXtjLnB1c2goZS50aW1lc1t0XSk7Zm9yKGxldCBpPTA7aTxhOysraSloLnB1c2goZS52YWx1ZXNbdCphK2ldKX19MCE9PWMubGVuZ3RoJiYoZS50aW1lcz1aaC5jb252ZXJ0QXJyYXkoYyxlLnRpbWVzLmNvbnN0cnVjdG9yKSxlLnZhbHVlcz1aaC5jb252ZXJ0QXJyYXkoaCxlLnZhbHVlcy5jb25zdHJ1Y3Rvciksby5wdXNoKGUpKX1zLnRyYWNrcz1vO2xldCBhPTEvMDtmb3IobGV0IHQ9MDt0PHMudHJhY2tzLmxlbmd0aDsrK3QpYT5zLnRyYWNrc1t0XS50aW1lc1swXSYmKGE9cy50cmFja3NbdF0udGltZXNbMF0pO2ZvcihsZXQgdD0wO3Q8cy50cmFja3MubGVuZ3RoOysrdClzLnRyYWNrc1t0XS5zaGlmdCgtMSphKTtyZXR1cm4gcy5yZXNldER1cmF0aW9uKCksc30sbWFrZUNsaXBBZGRpdGl2ZTpmdW5jdGlvbih0LGU9MCxpPXQsbj0zMCl7bjw9MCYmKG49MzApO2NvbnN0IHI9aS50cmFja3MubGVuZ3RoLHM9ZS9uO2ZvcihsZXQgZT0wO2U8cjsrK2Upe2NvbnN0IG49aS50cmFja3NbZV0scj1uLlZhbHVlVHlwZU5hbWU7aWYoXCJib29sXCI9PT1yfHxcInN0cmluZ1wiPT09ciljb250aW51ZTtjb25zdCBvPXQudHJhY2tzLmZpbmQoKGZ1bmN0aW9uKHQpe3JldHVybiB0Lm5hbWU9PT1uLm5hbWUmJnQuVmFsdWVUeXBlTmFtZT09PXJ9KSk7aWYodm9pZCAwPT09byljb250aW51ZTtsZXQgYT0wO2NvbnN0IGM9bi5nZXRWYWx1ZVNpemUoKTtuLmNyZWF0ZUludGVycG9sYW50LmlzSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kR0xURkN1YmljU3BsaW5lJiYoYT1jLzMpO2xldCBoPTA7Y29uc3QgbD1vLmdldFZhbHVlU2l6ZSgpO28uY3JlYXRlSW50ZXJwb2xhbnQuaXNJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RHTFRGQ3ViaWNTcGxpbmUmJihoPWwvMyk7Y29uc3QgdT1uLnRpbWVzLmxlbmd0aC0xO2xldCBkO2lmKHM8PW4udGltZXNbMF0pe2NvbnN0IHQ9YSxlPWMtYTtkPVpoLmFycmF5U2xpY2Uobi52YWx1ZXMsdCxlKX1lbHNlIGlmKHM+PW4udGltZXNbdV0pe2NvbnN0IHQ9dSpjK2EsZT10K2MtYTtkPVpoLmFycmF5U2xpY2Uobi52YWx1ZXMsdCxlKX1lbHNle2NvbnN0IHQ9bi5jcmVhdGVJbnRlcnBvbGFudCgpLGU9YSxpPWMtYTt0LmV2YWx1YXRlKHMpLGQ9WmguYXJyYXlTbGljZSh0LnJlc3VsdEJ1ZmZlcixlLGkpfWlmKFwicXVhdGVybmlvblwiPT09cil7KG5ldyBwbikuZnJvbUFycmF5KGQpLm5vcm1hbGl6ZSgpLmNvbmp1Z2F0ZSgpLnRvQXJyYXkoZCl9Y29uc3QgcD1vLnRpbWVzLmxlbmd0aDtmb3IobGV0IHQ9MDt0PHA7Kyt0KXtjb25zdCBlPXQqbCtoO2lmKFwicXVhdGVybmlvblwiPT09cilwbi5tdWx0aXBseVF1YXRlcm5pb25zRmxhdChvLnZhbHVlcyxlLGQsMCxvLnZhbHVlcyxlKTtlbHNle2NvbnN0IHQ9bC0yKmg7Zm9yKGxldCBpPTA7aTx0OysraSlvLnZhbHVlc1tlK2ldLT1kW2ldfX19cmV0dXJuIHQuYmxlbmRNb2RlPTI1MDEsdH19O2Z1bmN0aW9uIEpoKHQsZSxpLG4pe3RoaXMucGFyYW1ldGVyUG9zaXRpb25zPXQsdGhpcy5fY2FjaGVkSW5kZXg9MCx0aGlzLnJlc3VsdEJ1ZmZlcj12b2lkIDAhPT1uP246bmV3IGUuY29uc3RydWN0b3IoaSksdGhpcy5zYW1wbGVWYWx1ZXM9ZSx0aGlzLnZhbHVlU2l6ZT1pfWZ1bmN0aW9uIEtoKHQsZSxpLG4pe0poLmNhbGwodGhpcyx0LGUsaSxuKSx0aGlzLl93ZWlnaHRQcmV2PS0wLHRoaXMuX29mZnNldFByZXY9LTAsdGhpcy5fd2VpZ2h0TmV4dD0tMCx0aGlzLl9vZmZzZXROZXh0PS0wfWZ1bmN0aW9uIFFoKHQsZSxpLG4pe0poLmNhbGwodGhpcyx0LGUsaSxuKX1mdW5jdGlvbiB0bCh0LGUsaSxuKXtKaC5jYWxsKHRoaXMsdCxlLGksbil9ZnVuY3Rpb24gZWwodCxlLGksbil7aWYodm9pZCAwPT09dCl0aHJvdyBuZXcgRXJyb3IoXCJUSFJFRS5LZXlmcmFtZVRyYWNrOiB0cmFjayBuYW1lIGlzIHVuZGVmaW5lZFwiKTtpZih2b2lkIDA9PT1lfHwwPT09ZS5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKFwiVEhSRUUuS2V5ZnJhbWVUcmFjazogbm8ga2V5ZnJhbWVzIGluIHRyYWNrIG5hbWVkIFwiK3QpO3RoaXMubmFtZT10LHRoaXMudGltZXM9WmguY29udmVydEFycmF5KGUsdGhpcy5UaW1lQnVmZmVyVHlwZSksdGhpcy52YWx1ZXM9WmguY29udmVydEFycmF5KGksdGhpcy5WYWx1ZUJ1ZmZlclR5cGUpLHRoaXMuc2V0SW50ZXJwb2xhdGlvbihufHx0aGlzLkRlZmF1bHRJbnRlcnBvbGF0aW9uKX1mdW5jdGlvbiBpbCh0LGUsaSl7ZWwuY2FsbCh0aGlzLHQsZSxpKX1mdW5jdGlvbiBubCh0LGUsaSxuKXtlbC5jYWxsKHRoaXMsdCxlLGksbil9ZnVuY3Rpb24gcmwodCxlLGksbil7ZWwuY2FsbCh0aGlzLHQsZSxpLG4pfWZ1bmN0aW9uIHNsKHQsZSxpLG4pe0poLmNhbGwodGhpcyx0LGUsaSxuKX1mdW5jdGlvbiBvbCh0LGUsaSxuKXtlbC5jYWxsKHRoaXMsdCxlLGksbil9ZnVuY3Rpb24gYWwodCxlLGksbil7ZWwuY2FsbCh0aGlzLHQsZSxpLG4pfWZ1bmN0aW9uIGNsKHQsZSxpLG4pe2VsLmNhbGwodGhpcyx0LGUsaSxuKX1mdW5jdGlvbiBobCh0LGU9LTEsaSxuPTI1MDApe3RoaXMubmFtZT10LHRoaXMudHJhY2tzPWksdGhpcy5kdXJhdGlvbj1lLHRoaXMuYmxlbmRNb2RlPW4sdGhpcy51dWlkPW5uLmdlbmVyYXRlVVVJRCgpLHRoaXMuZHVyYXRpb248MCYmdGhpcy5yZXNldER1cmF0aW9uKCl9ZnVuY3Rpb24gbGwodCl7aWYodm9pZCAwPT09dC50eXBlKXRocm93IG5ldyBFcnJvcihcIlRIUkVFLktleWZyYW1lVHJhY2s6IHRyYWNrIHR5cGUgdW5kZWZpbmVkLCBjYW4gbm90IHBhcnNlXCIpO2NvbnN0IGU9ZnVuY3Rpb24odCl7c3dpdGNoKHQudG9Mb3dlckNhc2UoKSl7Y2FzZVwic2NhbGFyXCI6Y2FzZVwiZG91YmxlXCI6Y2FzZVwiZmxvYXRcIjpjYXNlXCJudW1iZXJcIjpjYXNlXCJpbnRlZ2VyXCI6cmV0dXJuIHJsO2Nhc2VcInZlY3RvclwiOmNhc2VcInZlY3RvcjJcIjpjYXNlXCJ2ZWN0b3IzXCI6Y2FzZVwidmVjdG9yNFwiOnJldHVybiBjbDtjYXNlXCJjb2xvclwiOnJldHVybiBubDtjYXNlXCJxdWF0ZXJuaW9uXCI6cmV0dXJuIG9sO2Nhc2VcImJvb2xcIjpjYXNlXCJib29sZWFuXCI6cmV0dXJuIGlsO2Nhc2VcInN0cmluZ1wiOnJldHVybiBhbH10aHJvdyBuZXcgRXJyb3IoXCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBVbnN1cHBvcnRlZCB0eXBlTmFtZTogXCIrdCl9KHQudHlwZSk7aWYodm9pZCAwPT09dC50aW1lcyl7Y29uc3QgZT1bXSxpPVtdO1poLmZsYXR0ZW5KU09OKHQua2V5cyxlLGksXCJ2YWx1ZVwiKSx0LnRpbWVzPWUsdC52YWx1ZXM9aX1yZXR1cm4gdm9pZCAwIT09ZS5wYXJzZT9lLnBhcnNlKHQpOm5ldyBlKHQubmFtZSx0LnRpbWVzLHQudmFsdWVzLHQuaW50ZXJwb2xhdGlvbil9T2JqZWN0LmFzc2lnbihKaC5wcm90b3R5cGUse2V2YWx1YXRlOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5wYXJhbWV0ZXJQb3NpdGlvbnM7bGV0IGk9dGhpcy5fY2FjaGVkSW5kZXgsbj1lW2ldLHI9ZVtpLTFdO3Q6e2U6e2xldCBzO2k6e246aWYoISh0PG4pKXtmb3IobGV0IHM9aSsyOzspe2lmKHZvaWQgMD09PW4pe2lmKHQ8cilicmVhayBuO3JldHVybiBpPWUubGVuZ3RoLHRoaXMuX2NhY2hlZEluZGV4PWksdGhpcy5hZnRlckVuZF8oaS0xLHQscil9aWYoaT09PXMpYnJlYWs7aWYocj1uLG49ZVsrK2ldLHQ8bilicmVhayBlfXM9ZS5sZW5ndGg7YnJlYWsgaX1pZih0Pj1yKWJyZWFrIHQ7e2NvbnN0IG89ZVsxXTt0PG8mJihpPTIscj1vKTtmb3IobGV0IHM9aS0yOzspe2lmKHZvaWQgMD09PXIpcmV0dXJuIHRoaXMuX2NhY2hlZEluZGV4PTAsdGhpcy5iZWZvcmVTdGFydF8oMCx0LG4pO2lmKGk9PT1zKWJyZWFrO2lmKG49cixyPWVbLS1pLTFdLHQ+PXIpYnJlYWsgZX1zPWksaT0wfX1mb3IoO2k8czspe2NvbnN0IG49aStzPj4+MTt0PGVbbl0/cz1uOmk9bisxfWlmKG49ZVtpXSxyPWVbaS0xXSx2b2lkIDA9PT1yKXJldHVybiB0aGlzLl9jYWNoZWRJbmRleD0wLHRoaXMuYmVmb3JlU3RhcnRfKDAsdCxuKTtpZih2b2lkIDA9PT1uKXJldHVybiBpPWUubGVuZ3RoLHRoaXMuX2NhY2hlZEluZGV4PWksdGhpcy5hZnRlckVuZF8oaS0xLHIsdCl9dGhpcy5fY2FjaGVkSW5kZXg9aSx0aGlzLmludGVydmFsQ2hhbmdlZF8oaSxyLG4pfXJldHVybiB0aGlzLmludGVycG9sYXRlXyhpLHIsdCxuKX0sc2V0dGluZ3M6bnVsbCxEZWZhdWx0U2V0dGluZ3NfOnt9LGdldFNldHRpbmdzXzpmdW5jdGlvbigpe3JldHVybiB0aGlzLnNldHRpbmdzfHx0aGlzLkRlZmF1bHRTZXR0aW5nc199LGNvcHlTYW1wbGVWYWx1ZV86ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLnJlc3VsdEJ1ZmZlcixpPXRoaXMuc2FtcGxlVmFsdWVzLG49dGhpcy52YWx1ZVNpemUscj10Km47Zm9yKGxldCB0PTA7dCE9PW47Kyt0KWVbdF09aVtyK3RdO3JldHVybiBlfSxpbnRlcnBvbGF0ZV86ZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoXCJjYWxsIHRvIGFic3RyYWN0IG1ldGhvZFwiKX0saW50ZXJ2YWxDaGFuZ2VkXzpmdW5jdGlvbigpe319KSxPYmplY3QuYXNzaWduKEpoLnByb3RvdHlwZSx7YmVmb3JlU3RhcnRfOkpoLnByb3RvdHlwZS5jb3B5U2FtcGxlVmFsdWVfLGFmdGVyRW5kXzpKaC5wcm90b3R5cGUuY29weVNhbXBsZVZhbHVlX30pLEtoLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoSmgucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6S2gsRGVmYXVsdFNldHRpbmdzXzp7ZW5kaW5nU3RhcnQ6VmksZW5kaW5nRW5kOlZpfSxpbnRlcnZhbENoYW5nZWRfOmZ1bmN0aW9uKHQsZSxpKXtjb25zdCBuPXRoaXMucGFyYW1ldGVyUG9zaXRpb25zO2xldCByPXQtMixzPXQrMSxvPW5bcl0sYT1uW3NdO2lmKHZvaWQgMD09PW8pc3dpdGNoKHRoaXMuZ2V0U2V0dGluZ3NfKCkuZW5kaW5nU3RhcnQpe2Nhc2UgR2k6cj10LG89MiplLWk7YnJlYWs7Y2FzZSBxaTpyPW4ubGVuZ3RoLTIsbz1lK25bcl0tbltyKzFdO2JyZWFrO2RlZmF1bHQ6cj10LG89aX1pZih2b2lkIDA9PT1hKXN3aXRjaCh0aGlzLmdldFNldHRpbmdzXygpLmVuZGluZ0VuZCl7Y2FzZSBHaTpzPXQsYT0yKmktZTticmVhaztjYXNlIHFpOnM9MSxhPWkrblsxXS1uWzBdO2JyZWFrO2RlZmF1bHQ6cz10LTEsYT1lfWNvbnN0IGM9LjUqKGktZSksaD10aGlzLnZhbHVlU2l6ZTt0aGlzLl93ZWlnaHRQcmV2PWMvKGUtbyksdGhpcy5fd2VpZ2h0TmV4dD1jLyhhLWkpLHRoaXMuX29mZnNldFByZXY9cipoLHRoaXMuX29mZnNldE5leHQ9cypofSxpbnRlcnBvbGF0ZV86ZnVuY3Rpb24odCxlLGksbil7Y29uc3Qgcj10aGlzLnJlc3VsdEJ1ZmZlcixzPXRoaXMuc2FtcGxlVmFsdWVzLG89dGhpcy52YWx1ZVNpemUsYT10Km8sYz1hLW8saD10aGlzLl9vZmZzZXRQcmV2LGw9dGhpcy5fb2Zmc2V0TmV4dCx1PXRoaXMuX3dlaWdodFByZXYsZD10aGlzLl93ZWlnaHROZXh0LHA9KGktZSkvKG4tZSksZj1wKnAsbT1mKnAsZz0tdSptKzIqdSpmLXUqcCxfPSgxK3UpKm0rKC0xLjUtMip1KSpmKygtLjUrdSkqcCsxLHY9KC0xLWQpKm0rKDEuNStkKSpmKy41KnAseT1kKm0tZCpmO2ZvcihsZXQgdD0wO3QhPT1vOysrdClyW3RdPWcqc1toK3RdK18qc1tjK3RdK3Yqc1thK3RdK3kqc1tsK3RdO3JldHVybiByfX0pLFFoLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoSmgucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6UWgsaW50ZXJwb2xhdGVfOmZ1bmN0aW9uKHQsZSxpLG4pe2NvbnN0IHI9dGhpcy5yZXN1bHRCdWZmZXIscz10aGlzLnNhbXBsZVZhbHVlcyxvPXRoaXMudmFsdWVTaXplLGE9dCpvLGM9YS1vLGg9KGktZSkvKG4tZSksbD0xLWg7Zm9yKGxldCB0PTA7dCE9PW87Kyt0KXJbdF09c1tjK3RdKmwrc1thK3RdKmg7cmV0dXJuIHJ9fSksdGwucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKaC5wcm90b3R5cGUpLHtjb25zdHJ1Y3Rvcjp0bCxpbnRlcnBvbGF0ZV86ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29weVNhbXBsZVZhbHVlXyh0LTEpfX0pLE9iamVjdC5hc3NpZ24oZWwse3RvSlNPTjpmdW5jdGlvbih0KXtjb25zdCBlPXQuY29uc3RydWN0b3I7bGV0IGk7aWYodm9pZCAwIT09ZS50b0pTT04paT1lLnRvSlNPTih0KTtlbHNle2k9e25hbWU6dC5uYW1lLHRpbWVzOlpoLmNvbnZlcnRBcnJheSh0LnRpbWVzLEFycmF5KSx2YWx1ZXM6WmguY29udmVydEFycmF5KHQudmFsdWVzLEFycmF5KX07Y29uc3QgZT10LmdldEludGVycG9sYXRpb24oKTtlIT09dC5EZWZhdWx0SW50ZXJwb2xhdGlvbiYmKGkuaW50ZXJwb2xhdGlvbj1lKX1yZXR1cm4gaS50eXBlPXQuVmFsdWVUeXBlTmFtZSxpfX0pLE9iamVjdC5hc3NpZ24oZWwucHJvdG90eXBlLHtjb25zdHJ1Y3RvcjplbCxUaW1lQnVmZmVyVHlwZTpGbG9hdDMyQXJyYXksVmFsdWVCdWZmZXJUeXBlOkZsb2F0MzJBcnJheSxEZWZhdWx0SW50ZXJwb2xhdGlvbjpIaSxJbnRlcnBvbGFudEZhY3RvcnlNZXRob2REaXNjcmV0ZTpmdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRsKHRoaXMudGltZXMsdGhpcy52YWx1ZXMsdGhpcy5nZXRWYWx1ZVNpemUoKSx0KX0sSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgUWgodGhpcy50aW1lcyx0aGlzLnZhbHVlcyx0aGlzLmdldFZhbHVlU2l6ZSgpLHQpfSxJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGg6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBLaCh0aGlzLnRpbWVzLHRoaXMudmFsdWVzLHRoaXMuZ2V0VmFsdWVTaXplKCksdCl9LHNldEludGVycG9sYXRpb246ZnVuY3Rpb24odCl7bGV0IGU7c3dpdGNoKHQpe2Nhc2Ugamk6ZT10aGlzLkludGVycG9sYW50RmFjdG9yeU1ldGhvZERpc2NyZXRlO2JyZWFrO2Nhc2UgSGk6ZT10aGlzLkludGVycG9sYW50RmFjdG9yeU1ldGhvZExpbmVhcjticmVhaztjYXNlIFVpOmU9dGhpcy5JbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGh9aWYodm9pZCAwPT09ZSl7Y29uc3QgZT1cInVuc3VwcG9ydGVkIGludGVycG9sYXRpb24gZm9yIFwiK3RoaXMuVmFsdWVUeXBlTmFtZStcIiBrZXlmcmFtZSB0cmFjayBuYW1lZCBcIit0aGlzLm5hbWU7aWYodm9pZCAwPT09dGhpcy5jcmVhdGVJbnRlcnBvbGFudCl7aWYodD09PXRoaXMuRGVmYXVsdEludGVycG9sYXRpb24pdGhyb3cgbmV3IEVycm9yKGUpO3RoaXMuc2V0SW50ZXJwb2xhdGlvbih0aGlzLkRlZmF1bHRJbnRlcnBvbGF0aW9uKX1yZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuS2V5ZnJhbWVUcmFjazpcIixlKSx0aGlzfXJldHVybiB0aGlzLmNyZWF0ZUludGVycG9sYW50PWUsdGhpc30sZ2V0SW50ZXJwb2xhdGlvbjpmdW5jdGlvbigpe3N3aXRjaCh0aGlzLmNyZWF0ZUludGVycG9sYW50KXtjYXNlIHRoaXMuSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kRGlzY3JldGU6cmV0dXJuIGppO2Nhc2UgdGhpcy5JbnRlcnBvbGFudEZhY3RvcnlNZXRob2RMaW5lYXI6cmV0dXJuIEhpO2Nhc2UgdGhpcy5JbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGg6cmV0dXJuIFVpfX0sZ2V0VmFsdWVTaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVzLmxlbmd0aC90aGlzLnRpbWVzLmxlbmd0aH0sc2hpZnQ6ZnVuY3Rpb24odCl7aWYoMCE9PXQpe2NvbnN0IGU9dGhpcy50aW1lcztmb3IobGV0IGk9MCxuPWUubGVuZ3RoO2khPT1uOysraSllW2ldKz10fXJldHVybiB0aGlzfSxzY2FsZTpmdW5jdGlvbih0KXtpZigxIT09dCl7Y29uc3QgZT10aGlzLnRpbWVzO2ZvcihsZXQgaT0wLG49ZS5sZW5ndGg7aSE9PW47KytpKWVbaV0qPXR9cmV0dXJuIHRoaXN9LHRyaW06ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMudGltZXMsbj1pLmxlbmd0aDtsZXQgcj0wLHM9bi0xO2Zvcig7ciE9PW4mJmlbcl08dDspKytyO2Zvcig7LTEhPT1zJiZpW3NdPmU7KS0tcztpZigrK3MsMCE9PXJ8fHMhPT1uKXtyPj1zJiYocz1NYXRoLm1heChzLDEpLHI9cy0xKTtjb25zdCB0PXRoaXMuZ2V0VmFsdWVTaXplKCk7dGhpcy50aW1lcz1aaC5hcnJheVNsaWNlKGkscixzKSx0aGlzLnZhbHVlcz1aaC5hcnJheVNsaWNlKHRoaXMudmFsdWVzLHIqdCxzKnQpfXJldHVybiB0aGlzfSx2YWxpZGF0ZTpmdW5jdGlvbigpe2xldCB0PSEwO2NvbnN0IGU9dGhpcy5nZXRWYWx1ZVNpemUoKTtlLU1hdGguZmxvb3IoZSkhPTAmJihjb25zb2xlLmVycm9yKFwiVEhSRUUuS2V5ZnJhbWVUcmFjazogSW52YWxpZCB2YWx1ZSBzaXplIGluIHRyYWNrLlwiLHRoaXMpLHQ9ITEpO2NvbnN0IGk9dGhpcy50aW1lcyxuPXRoaXMudmFsdWVzLHI9aS5sZW5ndGg7MD09PXImJihjb25zb2xlLmVycm9yKFwiVEhSRUUuS2V5ZnJhbWVUcmFjazogVHJhY2sgaXMgZW1wdHkuXCIsdGhpcyksdD0hMSk7bGV0IHM9bnVsbDtmb3IobGV0IGU9MDtlIT09cjtlKyspe2NvbnN0IG49aVtlXTtpZihcIm51bWJlclwiPT10eXBlb2YgbiYmaXNOYU4obikpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBUaW1lIGlzIG5vdCBhIHZhbGlkIG51bWJlci5cIix0aGlzLGUsbiksdD0hMTticmVha31pZihudWxsIT09cyYmcz5uKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuS2V5ZnJhbWVUcmFjazogT3V0IG9mIG9yZGVyIGtleXMuXCIsdGhpcyxlLG4scyksdD0hMTticmVha31zPW59aWYodm9pZCAwIT09biYmWmguaXNUeXBlZEFycmF5KG4pKWZvcihsZXQgZT0wLGk9bi5sZW5ndGg7ZSE9PWk7KytlKXtjb25zdCBpPW5bZV07aWYoaXNOYU4oaSkpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5LZXlmcmFtZVRyYWNrOiBWYWx1ZSBpcyBub3QgYSB2YWxpZCBudW1iZXIuXCIsdGhpcyxlLGkpLHQ9ITE7YnJlYWt9fXJldHVybiB0fSxvcHRpbWl6ZTpmdW5jdGlvbigpe2NvbnN0IHQ9WmguYXJyYXlTbGljZSh0aGlzLnRpbWVzKSxlPVpoLmFycmF5U2xpY2UodGhpcy52YWx1ZXMpLGk9dGhpcy5nZXRWYWx1ZVNpemUoKSxuPXRoaXMuZ2V0SW50ZXJwb2xhdGlvbigpPT09VWkscj10Lmxlbmd0aC0xO2xldCBzPTE7Zm9yKGxldCBvPTE7bzxyOysrbyl7bGV0IHI9ITE7Y29uc3QgYT10W29dO2lmKGEhPT10W28rMV0mJigxIT09b3x8YSE9PXRbMF0pKWlmKG4pcj0hMDtlbHNle2NvbnN0IHQ9byppLG49dC1pLHM9dCtpO2ZvcihsZXQgbz0wO28hPT1pOysrbyl7Y29uc3QgaT1lW3Qrb107aWYoaSE9PWVbbitvXXx8aSE9PWVbcytvXSl7cj0hMDticmVha319fWlmKHIpe2lmKG8hPT1zKXt0W3NdPXRbb107Y29uc3Qgbj1vKmkscj1zKmk7Zm9yKGxldCB0PTA7dCE9PWk7Kyt0KWVbcit0XT1lW24rdF19KytzfX1pZihyPjApe3Rbc109dFtyXTtmb3IobGV0IHQ9cippLG49cyppLG89MDtvIT09aTsrK28pZVtuK29dPWVbdCtvXTsrK3N9cmV0dXJuIHMhPT10Lmxlbmd0aD8odGhpcy50aW1lcz1aaC5hcnJheVNsaWNlKHQsMCxzKSx0aGlzLnZhbHVlcz1aaC5hcnJheVNsaWNlKGUsMCxzKmkpKToodGhpcy50aW1lcz10LHRoaXMudmFsdWVzPWUpLHRoaXN9LGNsb25lOmZ1bmN0aW9uKCl7Y29uc3QgdD1aaC5hcnJheVNsaWNlKHRoaXMudGltZXMsMCksZT1aaC5hcnJheVNsaWNlKHRoaXMudmFsdWVzLDApLGk9bmV3KDAsdGhpcy5jb25zdHJ1Y3RvcikodGhpcy5uYW1lLHQsZSk7cmV0dXJuIGkuY3JlYXRlSW50ZXJwb2xhbnQ9dGhpcy5jcmVhdGVJbnRlcnBvbGFudCxpfX0pLGlsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoZWwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6aWwsVmFsdWVUeXBlTmFtZTpcImJvb2xcIixWYWx1ZUJ1ZmZlclR5cGU6QXJyYXksRGVmYXVsdEludGVycG9sYXRpb246amksSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyOnZvaWQgMCxJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGg6dm9pZCAwfSksbmwucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShlbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpubCxWYWx1ZVR5cGVOYW1lOlwiY29sb3JcIn0pLHJsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoZWwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6cmwsVmFsdWVUeXBlTmFtZTpcIm51bWJlclwifSksc2wucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKaC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpzbCxpbnRlcnBvbGF0ZV86ZnVuY3Rpb24odCxlLGksbil7Y29uc3Qgcj10aGlzLnJlc3VsdEJ1ZmZlcixzPXRoaXMuc2FtcGxlVmFsdWVzLG89dGhpcy52YWx1ZVNpemUsYT0oaS1lKS8obi1lKTtsZXQgYz10Km87Zm9yKGxldCB0PWMrbztjIT09dDtjKz00KXBuLnNsZXJwRmxhdChyLDAscyxjLW8scyxjLGEpO3JldHVybiByfX0pLG9sLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoZWwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6b2wsVmFsdWVUeXBlTmFtZTpcInF1YXRlcm5pb25cIixEZWZhdWx0SW50ZXJwb2xhdGlvbjpIaSxJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RMaW5lYXI6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBzbCh0aGlzLnRpbWVzLHRoaXMudmFsdWVzLHRoaXMuZ2V0VmFsdWVTaXplKCksdCl9LEludGVycG9sYW50RmFjdG9yeU1ldGhvZFNtb290aDp2b2lkIDB9KSxhbC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGVsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOmFsLFZhbHVlVHlwZU5hbWU6XCJzdHJpbmdcIixWYWx1ZUJ1ZmZlclR5cGU6QXJyYXksRGVmYXVsdEludGVycG9sYXRpb246amksSW50ZXJwb2xhbnRGYWN0b3J5TWV0aG9kTGluZWFyOnZvaWQgMCxJbnRlcnBvbGFudEZhY3RvcnlNZXRob2RTbW9vdGg6dm9pZCAwfSksY2wucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShlbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpjbCxWYWx1ZVR5cGVOYW1lOlwidmVjdG9yXCJ9KSxPYmplY3QuYXNzaWduKGhsLHtwYXJzZTpmdW5jdGlvbih0KXtjb25zdCBlPVtdLGk9dC50cmFja3Msbj0xLyh0LmZwc3x8MSk7Zm9yKGxldCB0PTAscj1pLmxlbmd0aDt0IT09cjsrK3QpZS5wdXNoKGxsKGlbdF0pLnNjYWxlKG4pKTtjb25zdCByPW5ldyBobCh0Lm5hbWUsdC5kdXJhdGlvbixlLHQuYmxlbmRNb2RlKTtyZXR1cm4gci51dWlkPXQudXVpZCxyfSx0b0pTT046ZnVuY3Rpb24odCl7Y29uc3QgZT1bXSxpPXQudHJhY2tzLG49e25hbWU6dC5uYW1lLGR1cmF0aW9uOnQuZHVyYXRpb24sdHJhY2tzOmUsdXVpZDp0LnV1aWQsYmxlbmRNb2RlOnQuYmxlbmRNb2RlfTtmb3IobGV0IHQ9MCxuPWkubGVuZ3RoO3QhPT1uOysrdCllLnB1c2goZWwudG9KU09OKGlbdF0pKTtyZXR1cm4gbn0sQ3JlYXRlRnJvbU1vcnBoVGFyZ2V0U2VxdWVuY2U6ZnVuY3Rpb24odCxlLGksbil7Y29uc3Qgcj1lLmxlbmd0aCxzPVtdO2ZvcihsZXQgdD0wO3Q8cjt0Kyspe2xldCBvPVtdLGE9W107by5wdXNoKCh0K3ItMSklcix0LCh0KzEpJXIpLGEucHVzaCgwLDEsMCk7Y29uc3QgYz1aaC5nZXRLZXlmcmFtZU9yZGVyKG8pO289Wmguc29ydGVkQXJyYXkobywxLGMpLGE9Wmguc29ydGVkQXJyYXkoYSwxLGMpLG58fDAhPT1vWzBdfHwoby5wdXNoKHIpLGEucHVzaChhWzBdKSkscy5wdXNoKG5ldyBybChcIi5tb3JwaFRhcmdldEluZmx1ZW5jZXNbXCIrZVt0XS5uYW1lK1wiXVwiLG8sYSkuc2NhbGUoMS9pKSl9cmV0dXJuIG5ldyBobCh0LC0xLHMpfSxmaW5kQnlOYW1lOmZ1bmN0aW9uKHQsZSl7bGV0IGk9dDtpZighQXJyYXkuaXNBcnJheSh0KSl7Y29uc3QgZT10O2k9ZS5nZW9tZXRyeSYmZS5nZW9tZXRyeS5hbmltYXRpb25zfHxlLmFuaW1hdGlvbnN9Zm9yKGxldCB0PTA7dDxpLmxlbmd0aDt0KyspaWYoaVt0XS5uYW1lPT09ZSlyZXR1cm4gaVt0XTtyZXR1cm4gbnVsbH0sQ3JlYXRlQ2xpcHNGcm9tTW9ycGhUYXJnZXRTZXF1ZW5jZXM6ZnVuY3Rpb24odCxlLGkpe2NvbnN0IG49e30scj0vXihbXFx3LV0qPykoW1xcZF0rKSQvO2ZvcihsZXQgZT0wLGk9dC5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10W2VdLHM9aS5uYW1lLm1hdGNoKHIpO2lmKHMmJnMubGVuZ3RoPjEpe2NvbnN0IHQ9c1sxXTtsZXQgZT1uW3RdO2V8fChuW3RdPWU9W10pLGUucHVzaChpKX19Y29uc3Qgcz1bXTtmb3IoY29uc3QgdCBpbiBuKXMucHVzaChobC5DcmVhdGVGcm9tTW9ycGhUYXJnZXRTZXF1ZW5jZSh0LG5bdF0sZSxpKSk7cmV0dXJuIHN9LHBhcnNlQW5pbWF0aW9uOmZ1bmN0aW9uKHQsZSl7aWYoIXQpcmV0dXJuIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5BbmltYXRpb25DbGlwOiBObyBhbmltYXRpb24gaW4gSlNPTkxvYWRlciBkYXRhLlwiKSxudWxsO2NvbnN0IGk9ZnVuY3Rpb24odCxlLGksbixyKXtpZigwIT09aS5sZW5ndGgpe2NvbnN0IHM9W10sbz1bXTtaaC5mbGF0dGVuSlNPTihpLHMsbyxuKSwwIT09cy5sZW5ndGgmJnIucHVzaChuZXcgdChlLHMsbykpfX0sbj1bXSxyPXQubmFtZXx8XCJkZWZhdWx0XCIscz10LmZwc3x8MzAsbz10LmJsZW5kTW9kZTtsZXQgYT10Lmxlbmd0aHx8LTE7Y29uc3QgYz10LmhpZXJhcmNoeXx8W107Zm9yKGxldCB0PTA7dDxjLmxlbmd0aDt0Kyspe2NvbnN0IHI9Y1t0XS5rZXlzO2lmKHImJjAhPT1yLmxlbmd0aClpZihyWzBdLm1vcnBoVGFyZ2V0cyl7Y29uc3QgdD17fTtsZXQgZTtmb3IoZT0wO2U8ci5sZW5ndGg7ZSsrKWlmKHJbZV0ubW9ycGhUYXJnZXRzKWZvcihsZXQgaT0wO2k8cltlXS5tb3JwaFRhcmdldHMubGVuZ3RoO2krKyl0W3JbZV0ubW9ycGhUYXJnZXRzW2ldXT0tMTtmb3IoY29uc3QgaSBpbiB0KXtjb25zdCB0PVtdLHM9W107Zm9yKGxldCBuPTA7biE9PXJbZV0ubW9ycGhUYXJnZXRzLmxlbmd0aDsrK24pe2NvbnN0IG49cltlXTt0LnB1c2gobi50aW1lKSxzLnB1c2gobi5tb3JwaFRhcmdldD09PWk/MTowKX1uLnB1c2gobmV3IHJsKFwiLm1vcnBoVGFyZ2V0SW5mbHVlbmNlW1wiK2krXCJdXCIsdCxzKSl9YT10Lmxlbmd0aCooc3x8MSl9ZWxzZXtjb25zdCBzPVwiLmJvbmVzW1wiK2VbdF0ubmFtZStcIl1cIjtpKGNsLHMrXCIucG9zaXRpb25cIixyLFwicG9zXCIsbiksaShvbCxzK1wiLnF1YXRlcm5pb25cIixyLFwicm90XCIsbiksaShjbCxzK1wiLnNjYWxlXCIscixcInNjbFwiLG4pfX1pZigwPT09bi5sZW5ndGgpcmV0dXJuIG51bGw7cmV0dXJuIG5ldyBobChyLGEsbixvKX19KSxPYmplY3QuYXNzaWduKGhsLnByb3RvdHlwZSx7cmVzZXREdXJhdGlvbjpmdW5jdGlvbigpe2xldCB0PTA7Zm9yKGxldCBlPTAsaT10aGlzLnRyYWNrcy5sZW5ndGg7ZSE9PWk7KytlKXtjb25zdCBpPXRoaXMudHJhY2tzW2VdO3Q9TWF0aC5tYXgodCxpLnRpbWVzW2kudGltZXMubGVuZ3RoLTFdKX1yZXR1cm4gdGhpcy5kdXJhdGlvbj10LHRoaXN9LHRyaW06ZnVuY3Rpb24oKXtmb3IobGV0IHQ9MDt0PHRoaXMudHJhY2tzLmxlbmd0aDt0KyspdGhpcy50cmFja3NbdF0udHJpbSgwLHRoaXMuZHVyYXRpb24pO3JldHVybiB0aGlzfSx2YWxpZGF0ZTpmdW5jdGlvbigpe2xldCB0PSEwO2ZvcihsZXQgZT0wO2U8dGhpcy50cmFja3MubGVuZ3RoO2UrKyl0PXQmJnRoaXMudHJhY2tzW2VdLnZhbGlkYXRlKCk7cmV0dXJuIHR9LG9wdGltaXplOmZ1bmN0aW9uKCl7Zm9yKGxldCB0PTA7dDx0aGlzLnRyYWNrcy5sZW5ndGg7dCsrKXRoaXMudHJhY2tzW3RdLm9wdGltaXplKCk7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKCl7Y29uc3QgdD1bXTtmb3IobGV0IGU9MDtlPHRoaXMudHJhY2tzLmxlbmd0aDtlKyspdC5wdXNoKHRoaXMudHJhY2tzW2VdLmNsb25lKCkpO3JldHVybiBuZXcgaGwodGhpcy5uYW1lLHRoaXMuZHVyYXRpb24sdCx0aGlzLmJsZW5kTW9kZSl9LHRvSlNPTjpmdW5jdGlvbigpe3JldHVybiBobC50b0pTT04odGhpcyl9fSk7Y29uc3QgdWw9e2VuYWJsZWQ6ITEsZmlsZXM6e30sYWRkOmZ1bmN0aW9uKHQsZSl7ITEhPT10aGlzLmVuYWJsZWQmJih0aGlzLmZpbGVzW3RdPWUpfSxnZXQ6ZnVuY3Rpb24odCl7aWYoITEhPT10aGlzLmVuYWJsZWQpcmV0dXJuIHRoaXMuZmlsZXNbdF19LHJlbW92ZTpmdW5jdGlvbih0KXtkZWxldGUgdGhpcy5maWxlc1t0XX0sY2xlYXI6ZnVuY3Rpb24oKXt0aGlzLmZpbGVzPXt9fX07Y29uc3QgZGw9bmV3IGZ1bmN0aW9uKHQsZSxpKXtjb25zdCBuPXRoaXM7bGV0IHIscz0hMSxvPTAsYT0wO2NvbnN0IGM9W107dGhpcy5vblN0YXJ0PXZvaWQgMCx0aGlzLm9uTG9hZD10LHRoaXMub25Qcm9ncmVzcz1lLHRoaXMub25FcnJvcj1pLHRoaXMuaXRlbVN0YXJ0PWZ1bmN0aW9uKHQpe2ErKywhMT09PXMmJnZvaWQgMCE9PW4ub25TdGFydCYmbi5vblN0YXJ0KHQsbyxhKSxzPSEwfSx0aGlzLml0ZW1FbmQ9ZnVuY3Rpb24odCl7bysrLHZvaWQgMCE9PW4ub25Qcm9ncmVzcyYmbi5vblByb2dyZXNzKHQsbyxhKSxvPT09YSYmKHM9ITEsdm9pZCAwIT09bi5vbkxvYWQmJm4ub25Mb2FkKCkpfSx0aGlzLml0ZW1FcnJvcj1mdW5jdGlvbih0KXt2b2lkIDAhPT1uLm9uRXJyb3ImJm4ub25FcnJvcih0KX0sdGhpcy5yZXNvbHZlVVJMPWZ1bmN0aW9uKHQpe3JldHVybiByP3IodCk6dH0sdGhpcy5zZXRVUkxNb2RpZmllcj1mdW5jdGlvbih0KXtyZXR1cm4gcj10LHRoaXN9LHRoaXMuYWRkSGFuZGxlcj1mdW5jdGlvbih0LGUpe3JldHVybiBjLnB1c2godCxlKSx0aGlzfSx0aGlzLnJlbW92ZUhhbmRsZXI9ZnVuY3Rpb24odCl7Y29uc3QgZT1jLmluZGV4T2YodCk7cmV0dXJuLTEhPT1lJiZjLnNwbGljZShlLDIpLHRoaXN9LHRoaXMuZ2V0SGFuZGxlcj1mdW5jdGlvbih0KXtmb3IobGV0IGU9MCxpPWMubGVuZ3RoO2U8aTtlKz0yKXtjb25zdCBpPWNbZV0sbj1jW2UrMV07aWYoaS5nbG9iYWwmJihpLmxhc3RJbmRleD0wKSxpLnRlc3QodCkpcmV0dXJuIG59cmV0dXJuIG51bGx9fTtmdW5jdGlvbiBwbCh0KXt0aGlzLm1hbmFnZXI9dm9pZCAwIT09dD90OmRsLHRoaXMuY3Jvc3NPcmlnaW49XCJhbm9ueW1vdXNcIix0aGlzLndpdGhDcmVkZW50aWFscz0hMSx0aGlzLnBhdGg9XCJcIix0aGlzLnJlc291cmNlUGF0aD1cIlwiLHRoaXMucmVxdWVzdEhlYWRlcj17fX1PYmplY3QuYXNzaWduKHBsLnByb3RvdHlwZSx7bG9hZDpmdW5jdGlvbigpe30sbG9hZEFzeW5jOmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzO3JldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24obixyKXtpLmxvYWQodCxuLGUscil9KSl9LHBhcnNlOmZ1bmN0aW9uKCl7fSxzZXRDcm9zc09yaWdpbjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jcm9zc09yaWdpbj10LHRoaXN9LHNldFdpdGhDcmVkZW50aWFsczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy53aXRoQ3JlZGVudGlhbHM9dCx0aGlzfSxzZXRQYXRoOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnBhdGg9dCx0aGlzfSxzZXRSZXNvdXJjZVBhdGg6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMucmVzb3VyY2VQYXRoPXQsdGhpc30sc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5yZXF1ZXN0SGVhZGVyPXQsdGhpc319KTtjb25zdCBmbD17fTtmdW5jdGlvbiBtbCh0KXtwbC5jYWxsKHRoaXMsdCl9ZnVuY3Rpb24gZ2wodCl7cGwuY2FsbCh0aGlzLHQpfWZ1bmN0aW9uIF9sKHQpe3BsLmNhbGwodGhpcyx0KX1mdW5jdGlvbiB2bCh0KXtwbC5jYWxsKHRoaXMsdCl9ZnVuY3Rpb24geWwodCl7cGwuY2FsbCh0aGlzLHQpfWZ1bmN0aW9uIGJsKHQpe3BsLmNhbGwodGhpcyx0KX1mdW5jdGlvbiB4bCh0KXtwbC5jYWxsKHRoaXMsdCl9ZnVuY3Rpb24gd2woKXt0aGlzLnR5cGU9XCJDdXJ2ZVwiLHRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zPTIwMH1mdW5jdGlvbiBTbCh0LGUsaSxuLHIscyxvLGEpe3dsLmNhbGwodGhpcyksdGhpcy50eXBlPVwiRWxsaXBzZUN1cnZlXCIsdGhpcy5hWD10fHwwLHRoaXMuYVk9ZXx8MCx0aGlzLnhSYWRpdXM9aXx8MSx0aGlzLnlSYWRpdXM9bnx8MSx0aGlzLmFTdGFydEFuZ2xlPXJ8fDAsdGhpcy5hRW5kQW5nbGU9c3x8MipNYXRoLlBJLHRoaXMuYUNsb2Nrd2lzZT1vfHwhMSx0aGlzLmFSb3RhdGlvbj1hfHwwfWZ1bmN0aW9uIE1sKHQsZSxpLG4scixzKXtTbC5jYWxsKHRoaXMsdCxlLGksaSxuLHIscyksdGhpcy50eXBlPVwiQXJjQ3VydmVcIn1mdW5jdGlvbiBUbCgpe2xldCB0PTAsZT0wLGk9MCxuPTA7ZnVuY3Rpb24gcihyLHMsbyxhKXt0PXIsZT1vLGk9LTMqciszKnMtMipvLWEsbj0yKnItMipzK28rYX1yZXR1cm57aW5pdENhdG11bGxSb206ZnVuY3Rpb24odCxlLGksbixzKXtyKGUsaSxzKihpLXQpLHMqKG4tZSkpfSxpbml0Tm9udW5pZm9ybUNhdG11bGxSb206ZnVuY3Rpb24odCxlLGksbixzLG8sYSl7bGV0IGM9KGUtdCkvcy0oaS10KS8ocytvKSsoaS1lKS9vLGg9KGktZSkvby0obi1lKS8obythKSsobi1pKS9hO2MqPW8saCo9byxyKGUsaSxjLGgpfSxjYWxjOmZ1bmN0aW9uKHIpe2NvbnN0IHM9cipyO3JldHVybiB0K2UqcitpKnMrbioocypyKX19fW1sLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6bWwsbG9hZDpmdW5jdGlvbih0LGUsaSxuKXt2b2lkIDA9PT10JiYodD1cIlwiKSx2b2lkIDAhPT10aGlzLnBhdGgmJih0PXRoaXMucGF0aCt0KSx0PXRoaXMubWFuYWdlci5yZXNvbHZlVVJMKHQpO2NvbnN0IHI9dGhpcyxzPXVsLmdldCh0KTtpZih2b2lkIDAhPT1zKXJldHVybiByLm1hbmFnZXIuaXRlbVN0YXJ0KHQpLHNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ZSYmZShzKSxyLm1hbmFnZXIuaXRlbUVuZCh0KX0pLDApLHM7aWYodm9pZCAwIT09ZmxbdF0pcmV0dXJuIHZvaWQgZmxbdF0ucHVzaCh7b25Mb2FkOmUsb25Qcm9ncmVzczppLG9uRXJyb3I6bn0pO2NvbnN0IG89dC5tYXRjaCgvXmRhdGE6KC4qPykoO2Jhc2U2NCk/LCguKikkLyk7bGV0IGE7aWYobyl7Y29uc3QgaT1vWzFdLHM9ISFvWzJdO2xldCBhPW9bM107YT1kZWNvZGVVUklDb21wb25lbnQoYSkscyYmKGE9YXRvYihhKSk7dHJ5e2xldCBuO2NvbnN0IHM9KHRoaXMucmVzcG9uc2VUeXBlfHxcIlwiKS50b0xvd2VyQ2FzZSgpO3N3aXRjaChzKXtjYXNlXCJhcnJheWJ1ZmZlclwiOmNhc2VcImJsb2JcIjpjb25zdCB0PW5ldyBVaW50OEFycmF5KGEubGVuZ3RoKTtmb3IobGV0IGU9MDtlPGEubGVuZ3RoO2UrKyl0W2VdPWEuY2hhckNvZGVBdChlKTtuPVwiYmxvYlwiPT09cz9uZXcgQmxvYihbdC5idWZmZXJdLHt0eXBlOml9KTp0LmJ1ZmZlcjticmVhaztjYXNlXCJkb2N1bWVudFwiOmNvbnN0IGU9bmV3IERPTVBhcnNlcjtuPWUucGFyc2VGcm9tU3RyaW5nKGEsaSk7YnJlYWs7Y2FzZVwianNvblwiOm49SlNPTi5wYXJzZShhKTticmVhaztkZWZhdWx0Om49YX1zZXRUaW1lb3V0KChmdW5jdGlvbigpe2UmJmUobiksci5tYW5hZ2VyLml0ZW1FbmQodCl9KSwwKX1jYXRjaChlKXtzZXRUaW1lb3V0KChmdW5jdGlvbigpe24mJm4oZSksci5tYW5hZ2VyLml0ZW1FcnJvcih0KSxyLm1hbmFnZXIuaXRlbUVuZCh0KX0pLDApfX1lbHNle2ZsW3RdPVtdLGZsW3RdLnB1c2goe29uTG9hZDplLG9uUHJvZ3Jlc3M6aSxvbkVycm9yOm59KSxhPW5ldyBYTUxIdHRwUmVxdWVzdCxhLm9wZW4oXCJHRVRcIix0LCEwKSxhLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsKGZ1bmN0aW9uKGUpe2NvbnN0IGk9dGhpcy5yZXNwb25zZSxuPWZsW3RdO2lmKGRlbGV0ZSBmbFt0XSwyMDA9PT10aGlzLnN0YXR1c3x8MD09PXRoaXMuc3RhdHVzKXswPT09dGhpcy5zdGF0dXMmJmNvbnNvbGUud2FybihcIlRIUkVFLkZpbGVMb2FkZXI6IEhUVFAgU3RhdHVzIDAgcmVjZWl2ZWQuXCIpLHVsLmFkZCh0LGkpO2ZvcihsZXQgdD0wLGU9bi5sZW5ndGg7dDxlO3QrKyl7Y29uc3QgZT1uW3RdO2Uub25Mb2FkJiZlLm9uTG9hZChpKX1yLm1hbmFnZXIuaXRlbUVuZCh0KX1lbHNle2ZvcihsZXQgdD0wLGk9bi5sZW5ndGg7dDxpO3QrKyl7Y29uc3QgaT1uW3RdO2kub25FcnJvciYmaS5vbkVycm9yKGUpfXIubWFuYWdlci5pdGVtRXJyb3IodCksci5tYW5hZ2VyLml0ZW1FbmQodCl9fSksITEpLGEuYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsKGZ1bmN0aW9uKGUpe2NvbnN0IGk9ZmxbdF07Zm9yKGxldCB0PTAsbj1pLmxlbmd0aDt0PG47dCsrKXtjb25zdCBuPWlbdF07bi5vblByb2dyZXNzJiZuLm9uUHJvZ3Jlc3MoZSl9fSksITEpLGEuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsKGZ1bmN0aW9uKGUpe2NvbnN0IGk9ZmxbdF07ZGVsZXRlIGZsW3RdO2ZvcihsZXQgdD0wLG49aS5sZW5ndGg7dDxuO3QrKyl7Y29uc3Qgbj1pW3RdO24ub25FcnJvciYmbi5vbkVycm9yKGUpfXIubWFuYWdlci5pdGVtRXJyb3IodCksci5tYW5hZ2VyLml0ZW1FbmQodCl9KSwhMSksYS5hZGRFdmVudExpc3RlbmVyKFwiYWJvcnRcIiwoZnVuY3Rpb24oZSl7Y29uc3QgaT1mbFt0XTtkZWxldGUgZmxbdF07Zm9yKGxldCB0PTAsbj1pLmxlbmd0aDt0PG47dCsrKXtjb25zdCBuPWlbdF07bi5vbkVycm9yJiZuLm9uRXJyb3IoZSl9ci5tYW5hZ2VyLml0ZW1FcnJvcih0KSxyLm1hbmFnZXIuaXRlbUVuZCh0KX0pLCExKSx2b2lkIDAhPT10aGlzLnJlc3BvbnNlVHlwZSYmKGEucmVzcG9uc2VUeXBlPXRoaXMucmVzcG9uc2VUeXBlKSx2b2lkIDAhPT10aGlzLndpdGhDcmVkZW50aWFscyYmKGEud2l0aENyZWRlbnRpYWxzPXRoaXMud2l0aENyZWRlbnRpYWxzKSxhLm92ZXJyaWRlTWltZVR5cGUmJmEub3ZlcnJpZGVNaW1lVHlwZSh2b2lkIDAhPT10aGlzLm1pbWVUeXBlP3RoaXMubWltZVR5cGU6XCJ0ZXh0L3BsYWluXCIpO2Zvcihjb25zdCB0IGluIHRoaXMucmVxdWVzdEhlYWRlcilhLnNldFJlcXVlc3RIZWFkZXIodCx0aGlzLnJlcXVlc3RIZWFkZXJbdF0pO2Euc2VuZChudWxsKX1yZXR1cm4gci5tYW5hZ2VyLml0ZW1TdGFydCh0KSxhfSxzZXRSZXNwb25zZVR5cGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMucmVzcG9uc2VUeXBlPXQsdGhpc30sc2V0TWltZVR5cGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubWltZVR5cGU9dCx0aGlzfX0pLGdsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6Z2wsbG9hZDpmdW5jdGlvbih0LGUsaSxuKXtjb25zdCByPXRoaXMscz1uZXcgbWwoci5tYW5hZ2VyKTtzLnNldFBhdGgoci5wYXRoKSxzLnNldFJlcXVlc3RIZWFkZXIoci5yZXF1ZXN0SGVhZGVyKSxzLnNldFdpdGhDcmVkZW50aWFscyhyLndpdGhDcmVkZW50aWFscykscy5sb2FkKHQsKGZ1bmN0aW9uKGkpe3RyeXtlKHIucGFyc2UoSlNPTi5wYXJzZShpKSkpfWNhdGNoKGUpe24/bihlKTpjb25zb2xlLmVycm9yKGUpLHIubWFuYWdlci5pdGVtRXJyb3IodCl9fSksaSxuKX0scGFyc2U6ZnVuY3Rpb24odCl7Y29uc3QgZT1bXTtmb3IobGV0IGk9MDtpPHQubGVuZ3RoO2krKyl7Y29uc3Qgbj1obC5wYXJzZSh0W2ldKTtlLnB1c2gobil9cmV0dXJuIGV9fSksX2wucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShwbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpfbCxsb2FkOmZ1bmN0aW9uKHQsZSxpLG4pe2NvbnN0IHI9dGhpcyxzPVtdLG89bmV3IGloLGE9bmV3IG1sKHRoaXMubWFuYWdlcik7YS5zZXRQYXRoKHRoaXMucGF0aCksYS5zZXRSZXNwb25zZVR5cGUoXCJhcnJheWJ1ZmZlclwiKSxhLnNldFJlcXVlc3RIZWFkZXIodGhpcy5yZXF1ZXN0SGVhZGVyKSxhLnNldFdpdGhDcmVkZW50aWFscyhyLndpdGhDcmVkZW50aWFscyk7bGV0IGM9MDtmdW5jdGlvbiBoKGgpe2EubG9hZCh0W2hdLChmdW5jdGlvbih0KXtjb25zdCBpPXIucGFyc2UodCwhMCk7c1toXT17d2lkdGg6aS53aWR0aCxoZWlnaHQ6aS5oZWlnaHQsZm9ybWF0OmkuZm9ybWF0LG1pcG1hcHM6aS5taXBtYXBzfSxjKz0xLDY9PT1jJiYoMT09PWkubWlwbWFwQ291bnQmJihvLm1pbkZpbHRlcj1BaSksby5pbWFnZT1zLG8uZm9ybWF0PWkuZm9ybWF0LG8ubmVlZHNVcGRhdGU9ITAsZSYmZShvKSl9KSxpLG4pfWlmKEFycmF5LmlzQXJyYXkodCkpZm9yKGxldCBlPTAsaT10Lmxlbmd0aDtlPGk7KytlKWgoZSk7ZWxzZSBhLmxvYWQodCwoZnVuY3Rpb24odCl7Y29uc3QgaT1yLnBhcnNlKHQsITApO2lmKGkuaXNDdWJlbWFwKXtjb25zdCB0PWkubWlwbWFwcy5sZW5ndGgvaS5taXBtYXBDb3VudDtmb3IobGV0IGU9MDtlPHQ7ZSsrKXtzW2VdPXttaXBtYXBzOltdfTtmb3IobGV0IHQ9MDt0PGkubWlwbWFwQ291bnQ7dCsrKXNbZV0ubWlwbWFwcy5wdXNoKGkubWlwbWFwc1tlKmkubWlwbWFwQ291bnQrdF0pLHNbZV0uZm9ybWF0PWkuZm9ybWF0LHNbZV0ud2lkdGg9aS53aWR0aCxzW2VdLmhlaWdodD1pLmhlaWdodH1vLmltYWdlPXN9ZWxzZSBvLmltYWdlLndpZHRoPWkud2lkdGgsby5pbWFnZS5oZWlnaHQ9aS5oZWlnaHQsby5taXBtYXBzPWkubWlwbWFwczsxPT09aS5taXBtYXBDb3VudCYmKG8ubWluRmlsdGVyPUFpKSxvLmZvcm1hdD1pLmZvcm1hdCxvLm5lZWRzVXBkYXRlPSEwLGUmJmUobyl9KSxpLG4pO3JldHVybiBvfX0pLHZsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6dmwsbG9hZDpmdW5jdGlvbih0LGUsaSxuKXt2b2lkIDAhPT10aGlzLnBhdGgmJih0PXRoaXMucGF0aCt0KSx0PXRoaXMubWFuYWdlci5yZXNvbHZlVVJMKHQpO2NvbnN0IHI9dGhpcyxzPXVsLmdldCh0KTtpZih2b2lkIDAhPT1zKXJldHVybiByLm1hbmFnZXIuaXRlbVN0YXJ0KHQpLHNldFRpbWVvdXQoKGZ1bmN0aW9uKCl7ZSYmZShzKSxyLm1hbmFnZXIuaXRlbUVuZCh0KX0pLDApLHM7Y29uc3Qgbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIsXCJpbWdcIik7ZnVuY3Rpb24gYSgpe28ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIixhLCExKSxvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLGMsITEpLHVsLmFkZCh0LHRoaXMpLGUmJmUodGhpcyksci5tYW5hZ2VyLml0ZW1FbmQodCl9ZnVuY3Rpb24gYyhlKXtvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsYSwhMSksby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIixjLCExKSxuJiZuKGUpLHIubWFuYWdlci5pdGVtRXJyb3IodCksci5tYW5hZ2VyLml0ZW1FbmQodCl9cmV0dXJuIG8uYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixhLCExKSxvLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLGMsITEpLFwiZGF0YTpcIiE9PXQuc3Vic3RyKDAsNSkmJnZvaWQgMCE9PXRoaXMuY3Jvc3NPcmlnaW4mJihvLmNyb3NzT3JpZ2luPXRoaXMuY3Jvc3NPcmlnaW4pLHIubWFuYWdlci5pdGVtU3RhcnQodCksby5zcmM9dCxvfX0pLHlsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6eWwsbG9hZDpmdW5jdGlvbih0LGUsaSxuKXtjb25zdCByPW5ldyB6cyxzPW5ldyB2bCh0aGlzLm1hbmFnZXIpO3Muc2V0Q3Jvc3NPcmlnaW4odGhpcy5jcm9zc09yaWdpbikscy5zZXRQYXRoKHRoaXMucGF0aCk7bGV0IG89MDtmdW5jdGlvbiBhKGkpe3MubG9hZCh0W2ldLChmdW5jdGlvbih0KXtyLmltYWdlc1tpXT10LG8rKyw2PT09byYmKHIubmVlZHNVcGRhdGU9ITAsZSYmZShyKSl9KSx2b2lkIDAsbil9Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDsrK2UpYShlKTtyZXR1cm4gcn19KSxibC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHBsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOmJsLGxvYWQ6ZnVuY3Rpb24odCxlLGksbil7Y29uc3Qgcj10aGlzLHM9bmV3IEJzLG89bmV3IG1sKHRoaXMubWFuYWdlcik7cmV0dXJuIG8uc2V0UmVzcG9uc2VUeXBlKFwiYXJyYXlidWZmZXJcIiksby5zZXRSZXF1ZXN0SGVhZGVyKHRoaXMucmVxdWVzdEhlYWRlciksby5zZXRQYXRoKHRoaXMucGF0aCksby5zZXRXaXRoQ3JlZGVudGlhbHMoci53aXRoQ3JlZGVudGlhbHMpLG8ubG9hZCh0LChmdW5jdGlvbih0KXtjb25zdCBpPXIucGFyc2UodCk7aSYmKHZvaWQgMCE9PWkuaW1hZ2U/cy5pbWFnZT1pLmltYWdlOnZvaWQgMCE9PWkuZGF0YSYmKHMuaW1hZ2Uud2lkdGg9aS53aWR0aCxzLmltYWdlLmhlaWdodD1pLmhlaWdodCxzLmltYWdlLmRhdGE9aS5kYXRhKSxzLndyYXBTPXZvaWQgMCE9PWkud3JhcFM/aS53cmFwUzpDaSxzLndyYXBUPXZvaWQgMCE9PWkud3JhcFQ/aS53cmFwVDpDaSxzLm1hZ0ZpbHRlcj12b2lkIDAhPT1pLm1hZ0ZpbHRlcj9pLm1hZ0ZpbHRlcjpBaSxzLm1pbkZpbHRlcj12b2lkIDAhPT1pLm1pbkZpbHRlcj9pLm1pbkZpbHRlcjpBaSxzLmFuaXNvdHJvcHk9dm9pZCAwIT09aS5hbmlzb3Ryb3B5P2kuYW5pc290cm9weToxLHZvaWQgMCE9PWkuZW5jb2RpbmcmJihzLmVuY29kaW5nPWkuZW5jb2RpbmcpLHZvaWQgMCE9PWkuZmxpcFkmJihzLmZsaXBZPWkuZmxpcFkpLHZvaWQgMCE9PWkuZm9ybWF0JiYocy5mb3JtYXQ9aS5mb3JtYXQpLHZvaWQgMCE9PWkudHlwZSYmKHMudHlwZT1pLnR5cGUpLHZvaWQgMCE9PWkubWlwbWFwcyYmKHMubWlwbWFwcz1pLm1pcG1hcHMscy5taW5GaWx0ZXI9UGkpLDE9PT1pLm1pcG1hcENvdW50JiYocy5taW5GaWx0ZXI9QWkpLHMubmVlZHNVcGRhdGU9ITAsZSYmZShzLGkpKX0pLGksbiksc319KSx4bC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHBsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnhsLGxvYWQ6ZnVuY3Rpb24odCxlLGksbil7Y29uc3Qgcj1uZXcgaG4scz1uZXcgdmwodGhpcy5tYW5hZ2VyKTtyZXR1cm4gcy5zZXRDcm9zc09yaWdpbih0aGlzLmNyb3NzT3JpZ2luKSxzLnNldFBhdGgodGhpcy5wYXRoKSxzLmxvYWQodCwoZnVuY3Rpb24oaSl7ci5pbWFnZT1pO2NvbnN0IG49dC5zZWFyY2goL1xcLmpwZT9nKCR8XFw/KS9pKT4wfHwwPT09dC5zZWFyY2goL15kYXRhXFw6aW1hZ2VcXC9qcGVnLyk7ci5mb3JtYXQ9bj9raTp6aSxyLm5lZWRzVXBkYXRlPSEwLHZvaWQgMCE9PWUmJmUocil9KSxpLG4pLHJ9fSksT2JqZWN0LmFzc2lnbih3bC5wcm90b3R5cGUse2dldFBvaW50OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkN1cnZlOiAuZ2V0UG9pbnQoKSBub3QgaW1wbGVtZW50ZWQuXCIpLG51bGx9LGdldFBvaW50QXQ6ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMuZ2V0VXRvVG1hcHBpbmcodCk7cmV0dXJuIHRoaXMuZ2V0UG9pbnQoaSxlKX0sZ2V0UG9pbnRzOmZ1bmN0aW9uKHQ9NSl7Y29uc3QgZT1bXTtmb3IobGV0IGk9MDtpPD10O2krKyllLnB1c2godGhpcy5nZXRQb2ludChpL3QpKTtyZXR1cm4gZX0sZ2V0U3BhY2VkUG9pbnRzOmZ1bmN0aW9uKHQ9NSl7Y29uc3QgZT1bXTtmb3IobGV0IGk9MDtpPD10O2krKyllLnB1c2godGhpcy5nZXRQb2ludEF0KGkvdCkpO3JldHVybiBlfSxnZXRMZW5ndGg6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuZ2V0TGVuZ3RocygpO3JldHVybiB0W3QubGVuZ3RoLTFdfSxnZXRMZW5ndGhzOmZ1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXQmJih0PXRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zKSx0aGlzLmNhY2hlQXJjTGVuZ3RocyYmdGhpcy5jYWNoZUFyY0xlbmd0aHMubGVuZ3RoPT09dCsxJiYhdGhpcy5uZWVkc1VwZGF0ZSlyZXR1cm4gdGhpcy5jYWNoZUFyY0xlbmd0aHM7dGhpcy5uZWVkc1VwZGF0ZT0hMTtjb25zdCBlPVtdO2xldCBpLG49dGhpcy5nZXRQb2ludCgwKSxyPTA7ZS5wdXNoKDApO2ZvcihsZXQgcz0xO3M8PXQ7cysrKWk9dGhpcy5nZXRQb2ludChzL3QpLHIrPWkuZGlzdGFuY2VUbyhuKSxlLnB1c2gociksbj1pO3JldHVybiB0aGlzLmNhY2hlQXJjTGVuZ3Rocz1lLGV9LHVwZGF0ZUFyY0xlbmd0aHM6ZnVuY3Rpb24oKXt0aGlzLm5lZWRzVXBkYXRlPSEwLHRoaXMuZ2V0TGVuZ3RocygpfSxnZXRVdG9UbWFwcGluZzpmdW5jdGlvbih0LGUpe2NvbnN0IGk9dGhpcy5nZXRMZW5ndGhzKCk7bGV0IG49MDtjb25zdCByPWkubGVuZ3RoO2xldCBzO3M9ZXx8dCppW3ItMV07bGV0IG8sYT0wLGM9ci0xO2Zvcig7YTw9YzspaWYobj1NYXRoLmZsb29yKGErKGMtYSkvMiksbz1pW25dLXMsbzwwKWE9bisxO2Vsc2V7aWYoIShvPjApKXtjPW47YnJlYWt9Yz1uLTF9aWYobj1jLGlbbl09PT1zKXJldHVybiBuLyhyLTEpO2NvbnN0IGg9aVtuXTtyZXR1cm4obisocy1oKS8oaVtuKzFdLWgpKS8oci0xKX0sZ2V0VGFuZ2VudDpmdW5jdGlvbih0LGUpe2NvbnN0IGk9MWUtNDtsZXQgbj10LWkscj10K2k7bjwwJiYobj0wKSxyPjEmJihyPTEpO2NvbnN0IHM9dGhpcy5nZXRQb2ludChuKSxvPXRoaXMuZ2V0UG9pbnQociksYT1lfHwocy5pc1ZlY3RvcjI/bmV3IHJuOm5ldyBmbik7cmV0dXJuIGEuY29weShvKS5zdWIocykubm9ybWFsaXplKCksYX0sZ2V0VGFuZ2VudEF0OmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLmdldFV0b1RtYXBwaW5nKHQpO3JldHVybiB0aGlzLmdldFRhbmdlbnQoaSxlKX0sY29tcHV0ZUZyZW5ldEZyYW1lczpmdW5jdGlvbih0LGUpe2NvbnN0IGk9bmV3IGZuLG49W10scj1bXSxzPVtdLG89bmV3IGZuLGE9bmV3IEhuO2ZvcihsZXQgZT0wO2U8PXQ7ZSsrKXtjb25zdCBpPWUvdDtuW2VdPXRoaXMuZ2V0VGFuZ2VudEF0KGksbmV3IGZuKSxuW2VdLm5vcm1hbGl6ZSgpfXJbMF09bmV3IGZuLHNbMF09bmV3IGZuO2xldCBjPU51bWJlci5NQVhfVkFMVUU7Y29uc3QgaD1NYXRoLmFicyhuWzBdLngpLGw9TWF0aC5hYnMoblswXS55KSx1PU1hdGguYWJzKG5bMF0ueik7aDw9YyYmKGM9aCxpLnNldCgxLDAsMCkpLGw8PWMmJihjPWwsaS5zZXQoMCwxLDApKSx1PD1jJiZpLnNldCgwLDAsMSksby5jcm9zc1ZlY3RvcnMoblswXSxpKS5ub3JtYWxpemUoKSxyWzBdLmNyb3NzVmVjdG9ycyhuWzBdLG8pLHNbMF0uY3Jvc3NWZWN0b3JzKG5bMF0sclswXSk7Zm9yKGxldCBlPTE7ZTw9dDtlKyspe2lmKHJbZV09cltlLTFdLmNsb25lKCksc1tlXT1zW2UtMV0uY2xvbmUoKSxvLmNyb3NzVmVjdG9ycyhuW2UtMV0sbltlXSksby5sZW5ndGgoKT5OdW1iZXIuRVBTSUxPTil7by5ub3JtYWxpemUoKTtjb25zdCB0PU1hdGguYWNvcyhubi5jbGFtcChuW2UtMV0uZG90KG5bZV0pLC0xLDEpKTtyW2VdLmFwcGx5TWF0cml4NChhLm1ha2VSb3RhdGlvbkF4aXMobyx0KSl9c1tlXS5jcm9zc1ZlY3RvcnMobltlXSxyW2VdKX1pZighMD09PWUpe2xldCBlPU1hdGguYWNvcyhubi5jbGFtcChyWzBdLmRvdChyW3RdKSwtMSwxKSk7ZS89dCxuWzBdLmRvdChvLmNyb3NzVmVjdG9ycyhyWzBdLHJbdF0pKT4wJiYoZT0tZSk7Zm9yKGxldCBpPTE7aTw9dDtpKyspcltpXS5hcHBseU1hdHJpeDQoYS5tYWtlUm90YXRpb25BeGlzKG5baV0sZSppKSksc1tpXS5jcm9zc1ZlY3RvcnMobltpXSxyW2ldKX1yZXR1cm57dGFuZ2VudHM6bixub3JtYWxzOnIsYmlub3JtYWxzOnN9fSxjbG9uZTpmdW5jdGlvbigpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuY29weSh0aGlzKX0sY29weTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnM9dC5hcmNMZW5ndGhEaXZpc2lvbnMsdGhpc30sdG9KU09OOmZ1bmN0aW9uKCl7Y29uc3QgdD17bWV0YWRhdGE6e3ZlcnNpb246NC41LHR5cGU6XCJDdXJ2ZVwiLGdlbmVyYXRvcjpcIkN1cnZlLnRvSlNPTlwifX07cmV0dXJuIHQuYXJjTGVuZ3RoRGl2aXNpb25zPXRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zLHQudHlwZT10aGlzLnR5cGUsdH0sZnJvbUpTT046ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zPXQuYXJjTGVuZ3RoRGl2aXNpb25zLHRoaXN9fSksU2wucHJvdG90eXBlPU9iamVjdC5jcmVhdGUod2wucHJvdG90eXBlKSxTbC5wcm90b3R5cGUuY29uc3RydWN0b3I9U2wsU2wucHJvdG90eXBlLmlzRWxsaXBzZUN1cnZlPSEwLFNsLnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbih0LGUpe2NvbnN0IGk9ZXx8bmV3IHJuLG49MipNYXRoLlBJO2xldCByPXRoaXMuYUVuZEFuZ2xlLXRoaXMuYVN0YXJ0QW5nbGU7Y29uc3Qgcz1NYXRoLmFicyhyKTxOdW1iZXIuRVBTSUxPTjtmb3IoO3I8MDspcis9bjtmb3IoO3I+bjspci09bjtyPE51bWJlci5FUFNJTE9OJiYocj1zPzA6biksITAhPT10aGlzLmFDbG9ja3dpc2V8fHN8fChyPT09bj9yPS1uOnItPW4pO2NvbnN0IG89dGhpcy5hU3RhcnRBbmdsZSt0KnI7bGV0IGE9dGhpcy5hWCt0aGlzLnhSYWRpdXMqTWF0aC5jb3MobyksYz10aGlzLmFZK3RoaXMueVJhZGl1cypNYXRoLnNpbihvKTtpZigwIT09dGhpcy5hUm90YXRpb24pe2NvbnN0IHQ9TWF0aC5jb3ModGhpcy5hUm90YXRpb24pLGU9TWF0aC5zaW4odGhpcy5hUm90YXRpb24pLGk9YS10aGlzLmFYLG49Yy10aGlzLmFZO2E9aSp0LW4qZSt0aGlzLmFYLGM9aSplK24qdCt0aGlzLmFZfXJldHVybiBpLnNldChhLGMpfSxTbC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4gd2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuYVg9dC5hWCx0aGlzLmFZPXQuYVksdGhpcy54UmFkaXVzPXQueFJhZGl1cyx0aGlzLnlSYWRpdXM9dC55UmFkaXVzLHRoaXMuYVN0YXJ0QW5nbGU9dC5hU3RhcnRBbmdsZSx0aGlzLmFFbmRBbmdsZT10LmFFbmRBbmdsZSx0aGlzLmFDbG9ja3dpc2U9dC5hQ2xvY2t3aXNlLHRoaXMuYVJvdGF0aW9uPXQuYVJvdGF0aW9uLHRoaXN9LFNsLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtjb25zdCB0PXdsLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzKTtyZXR1cm4gdC5hWD10aGlzLmFYLHQuYVk9dGhpcy5hWSx0LnhSYWRpdXM9dGhpcy54UmFkaXVzLHQueVJhZGl1cz10aGlzLnlSYWRpdXMsdC5hU3RhcnRBbmdsZT10aGlzLmFTdGFydEFuZ2xlLHQuYUVuZEFuZ2xlPXRoaXMuYUVuZEFuZ2xlLHQuYUNsb2Nrd2lzZT10aGlzLmFDbG9ja3dpc2UsdC5hUm90YXRpb249dGhpcy5hUm90YXRpb24sdH0sU2wucHJvdG90eXBlLmZyb21KU09OPWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLHQpLHRoaXMuYVg9dC5hWCx0aGlzLmFZPXQuYVksdGhpcy54UmFkaXVzPXQueFJhZGl1cyx0aGlzLnlSYWRpdXM9dC55UmFkaXVzLHRoaXMuYVN0YXJ0QW5nbGU9dC5hU3RhcnRBbmdsZSx0aGlzLmFFbmRBbmdsZT10LmFFbmRBbmdsZSx0aGlzLmFDbG9ja3dpc2U9dC5hQ2xvY2t3aXNlLHRoaXMuYVJvdGF0aW9uPXQuYVJvdGF0aW9uLHRoaXN9LE1sLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKFNsLnByb3RvdHlwZSksTWwucHJvdG90eXBlLmNvbnN0cnVjdG9yPU1sLE1sLnByb3RvdHlwZS5pc0FyY0N1cnZlPSEwO2NvbnN0IENsPW5ldyBmbixFbD1uZXcgVGwsSWw9bmV3IFRsLEFsPW5ldyBUbDtmdW5jdGlvbiBQbCh0PVtdLGU9ITEsaT1cImNlbnRyaXBldGFsXCIsbj0uNSl7d2wuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJDYXRtdWxsUm9tQ3VydmUzXCIsdGhpcy5wb2ludHM9dCx0aGlzLmNsb3NlZD1lLHRoaXMuY3VydmVUeXBlPWksdGhpcy50ZW5zaW9uPW59ZnVuY3Rpb24gUmwodCxlLGksbixyKXtjb25zdCBzPS41KihuLWUpLG89LjUqKHItaSksYT10KnQ7cmV0dXJuKDIqaS0yKm4rcytvKSoodCphKSsoLTMqaSszKm4tMipzLW8pKmErcyp0K2l9ZnVuY3Rpb24gTGwodCxlLGksbil7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3QgaT0xLXQ7cmV0dXJuIGkqaSplfSh0LGUpK2Z1bmN0aW9uKHQsZSl7cmV0dXJuIDIqKDEtdCkqdCplfSh0LGkpK2Z1bmN0aW9uKHQsZSl7cmV0dXJuIHQqdCplfSh0LG4pfWZ1bmN0aW9uIE9sKHQsZSxpLG4scil7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Y29uc3QgaT0xLXQ7cmV0dXJuIGkqaSppKmV9KHQsZSkrZnVuY3Rpb24odCxlKXtjb25zdCBpPTEtdDtyZXR1cm4gMyppKmkqdCplfSh0LGkpK2Z1bmN0aW9uKHQsZSl7cmV0dXJuIDMqKDEtdCkqdCp0KmV9KHQsbikrZnVuY3Rpb24odCxlKXtyZXR1cm4gdCp0KnQqZX0odCxyKX1mdW5jdGlvbiBObCh0PW5ldyBybixlPW5ldyBybixpPW5ldyBybixuPW5ldyBybil7d2wuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJDdWJpY0JlemllckN1cnZlXCIsdGhpcy52MD10LHRoaXMudjE9ZSx0aGlzLnYyPWksdGhpcy52Mz1ufWZ1bmN0aW9uIERsKHQ9bmV3IGZuLGU9bmV3IGZuLGk9bmV3IGZuLG49bmV3IGZuKXt3bC5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIkN1YmljQmV6aWVyQ3VydmUzXCIsdGhpcy52MD10LHRoaXMudjE9ZSx0aGlzLnYyPWksdGhpcy52Mz1ufWZ1bmN0aW9uICRsKHQ9bmV3IHJuLGU9bmV3IHJuKXt3bC5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIkxpbmVDdXJ2ZVwiLHRoaXMudjE9dCx0aGlzLnYyPWV9ZnVuY3Rpb24ga2wodD1uZXcgZm4sZT1uZXcgZm4pe3dsLmNhbGwodGhpcyksdGhpcy50eXBlPVwiTGluZUN1cnZlM1wiLHRoaXMudjE9dCx0aGlzLnYyPWV9ZnVuY3Rpb24gemwodD1uZXcgcm4sZT1uZXcgcm4saT1uZXcgcm4pe3dsLmNhbGwodGhpcyksdGhpcy50eXBlPVwiUXVhZHJhdGljQmV6aWVyQ3VydmVcIix0aGlzLnYwPXQsdGhpcy52MT1lLHRoaXMudjI9aX1mdW5jdGlvbiBGbCh0PW5ldyBmbixlPW5ldyBmbixpPW5ldyBmbil7d2wuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJRdWFkcmF0aWNCZXppZXJDdXJ2ZTNcIix0aGlzLnYwPXQsdGhpcy52MT1lLHRoaXMudjI9aX1mdW5jdGlvbiBCbCh0PVtdKXt3bC5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIlNwbGluZUN1cnZlXCIsdGhpcy5wb2ludHM9dH1QbC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh3bC5wcm90b3R5cGUpLFBsLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1QbCxQbC5wcm90b3R5cGUuaXNDYXRtdWxsUm9tQ3VydmUzPSEwLFBsLnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbih0LGU9bmV3IGZuKXtjb25zdCBpPWUsbj10aGlzLnBvaW50cyxyPW4ubGVuZ3RoLHM9KHItKHRoaXMuY2xvc2VkPzA6MSkpKnQ7bGV0IG8sYSxjPU1hdGguZmxvb3IocyksaD1zLWM7dGhpcy5jbG9zZWQ/Yys9Yz4wPzA6KE1hdGguZmxvb3IoTWF0aC5hYnMoYykvcikrMSkqcjowPT09aCYmYz09PXItMSYmKGM9ci0yLGg9MSksdGhpcy5jbG9zZWR8fGM+MD9vPW5bKGMtMSklcl06KENsLnN1YlZlY3RvcnMoblswXSxuWzFdKS5hZGQoblswXSksbz1DbCk7Y29uc3QgbD1uW2Mlcl0sdT1uWyhjKzEpJXJdO2lmKHRoaXMuY2xvc2VkfHxjKzI8cj9hPW5bKGMrMiklcl06KENsLnN1YlZlY3RvcnMobltyLTFdLG5bci0yXSkuYWRkKG5bci0xXSksYT1DbCksXCJjZW50cmlwZXRhbFwiPT09dGhpcy5jdXJ2ZVR5cGV8fFwiY2hvcmRhbFwiPT09dGhpcy5jdXJ2ZVR5cGUpe2NvbnN0IHQ9XCJjaG9yZGFsXCI9PT10aGlzLmN1cnZlVHlwZT8uNTouMjU7bGV0IGU9TWF0aC5wb3coby5kaXN0YW5jZVRvU3F1YXJlZChsKSx0KSxpPU1hdGgucG93KGwuZGlzdGFuY2VUb1NxdWFyZWQodSksdCksbj1NYXRoLnBvdyh1LmRpc3RhbmNlVG9TcXVhcmVkKGEpLHQpO2k8MWUtNCYmKGk9MSksZTwxZS00JiYoZT1pKSxuPDFlLTQmJihuPWkpLEVsLmluaXROb251bmlmb3JtQ2F0bXVsbFJvbShvLngsbC54LHUueCxhLngsZSxpLG4pLElsLmluaXROb251bmlmb3JtQ2F0bXVsbFJvbShvLnksbC55LHUueSxhLnksZSxpLG4pLEFsLmluaXROb251bmlmb3JtQ2F0bXVsbFJvbShvLnosbC56LHUueixhLnosZSxpLG4pfWVsc2VcImNhdG11bGxyb21cIj09PXRoaXMuY3VydmVUeXBlJiYoRWwuaW5pdENhdG11bGxSb20oby54LGwueCx1LngsYS54LHRoaXMudGVuc2lvbiksSWwuaW5pdENhdG11bGxSb20oby55LGwueSx1LnksYS55LHRoaXMudGVuc2lvbiksQWwuaW5pdENhdG11bGxSb20oby56LGwueix1LnosYS56LHRoaXMudGVuc2lvbikpO3JldHVybiBpLnNldChFbC5jYWxjKGgpLElsLmNhbGMoaCksQWwuY2FsYyhoKSksaX0sUGwucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7d2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMucG9pbnRzPVtdO2ZvcihsZXQgZT0wLGk9dC5wb2ludHMubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dC5wb2ludHNbZV07dGhpcy5wb2ludHMucHVzaChpLmNsb25lKCkpfXJldHVybiB0aGlzLmNsb3NlZD10LmNsb3NlZCx0aGlzLmN1cnZlVHlwZT10LmN1cnZlVHlwZSx0aGlzLnRlbnNpb249dC50ZW5zaW9uLHRoaXN9LFBsLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtjb25zdCB0PXdsLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzKTt0LnBvaW50cz1bXTtmb3IobGV0IGU9MCxpPXRoaXMucG9pbnRzLmxlbmd0aDtlPGk7ZSsrKXtjb25zdCBpPXRoaXMucG9pbnRzW2VdO3QucG9pbnRzLnB1c2goaS50b0FycmF5KCkpfXJldHVybiB0LmNsb3NlZD10aGlzLmNsb3NlZCx0LmN1cnZlVHlwZT10aGlzLmN1cnZlVHlwZSx0LnRlbnNpb249dGhpcy50ZW5zaW9uLHR9LFBsLnByb3RvdHlwZS5mcm9tSlNPTj1mdW5jdGlvbih0KXt3bC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLHQpLHRoaXMucG9pbnRzPVtdO2ZvcihsZXQgZT0wLGk9dC5wb2ludHMubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dC5wb2ludHNbZV07dGhpcy5wb2ludHMucHVzaCgobmV3IGZuKS5mcm9tQXJyYXkoaSkpfXJldHVybiB0aGlzLmNsb3NlZD10LmNsb3NlZCx0aGlzLmN1cnZlVHlwZT10LmN1cnZlVHlwZSx0aGlzLnRlbnNpb249dC50ZW5zaW9uLHRoaXN9LE5sLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHdsLnByb3RvdHlwZSksTmwucHJvdG90eXBlLmNvbnN0cnVjdG9yPU5sLE5sLnByb3RvdHlwZS5pc0N1YmljQmV6aWVyQ3VydmU9ITAsTmwucHJvdG90eXBlLmdldFBvaW50PWZ1bmN0aW9uKHQsZT1uZXcgcm4pe2NvbnN0IGk9ZSxuPXRoaXMudjAscj10aGlzLnYxLHM9dGhpcy52MixvPXRoaXMudjM7cmV0dXJuIGkuc2V0KE9sKHQsbi54LHIueCxzLngsby54KSxPbCh0LG4ueSxyLnkscy55LG8ueSkpLGl9LE5sLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy52MC5jb3B5KHQudjApLHRoaXMudjEuY29weSh0LnYxKSx0aGlzLnYyLmNvcHkodC52MiksdGhpcy52My5jb3B5KHQudjMpLHRoaXN9LE5sLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtjb25zdCB0PXdsLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzKTtyZXR1cm4gdC52MD10aGlzLnYwLnRvQXJyYXkoKSx0LnYxPXRoaXMudjEudG9BcnJheSgpLHQudjI9dGhpcy52Mi50b0FycmF5KCksdC52Mz10aGlzLnYzLnRvQXJyYXkoKSx0fSxObC5wcm90b3R5cGUuZnJvbUpTT049ZnVuY3Rpb24odCl7cmV0dXJuIHdsLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsdCksdGhpcy52MC5mcm9tQXJyYXkodC52MCksdGhpcy52MS5mcm9tQXJyYXkodC52MSksdGhpcy52Mi5mcm9tQXJyYXkodC52MiksdGhpcy52My5mcm9tQXJyYXkodC52MyksdGhpc30sRGwucHJvdG90eXBlPU9iamVjdC5jcmVhdGUod2wucHJvdG90eXBlKSxEbC5wcm90b3R5cGUuY29uc3RydWN0b3I9RGwsRGwucHJvdG90eXBlLmlzQ3ViaWNCZXppZXJDdXJ2ZTM9ITAsRGwucHJvdG90eXBlLmdldFBvaW50PWZ1bmN0aW9uKHQsZT1uZXcgZm4pe2NvbnN0IGk9ZSxuPXRoaXMudjAscj10aGlzLnYxLHM9dGhpcy52MixvPXRoaXMudjM7cmV0dXJuIGkuc2V0KE9sKHQsbi54LHIueCxzLngsby54KSxPbCh0LG4ueSxyLnkscy55LG8ueSksT2wodCxuLnosci56LHMueixvLnopKSxpfSxEbC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4gd2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMudjAuY29weSh0LnYwKSx0aGlzLnYxLmNvcHkodC52MSksdGhpcy52Mi5jb3B5KHQudjIpLHRoaXMudjMuY29weSh0LnYzKSx0aGlzfSxEbC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7Y29uc3QgdD13bC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7cmV0dXJuIHQudjA9dGhpcy52MC50b0FycmF5KCksdC52MT10aGlzLnYxLnRvQXJyYXkoKSx0LnYyPXRoaXMudjIudG9BcnJheSgpLHQudjM9dGhpcy52My50b0FycmF5KCksdH0sRGwucHJvdG90eXBlLmZyb21KU09OPWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLHQpLHRoaXMudjAuZnJvbUFycmF5KHQudjApLHRoaXMudjEuZnJvbUFycmF5KHQudjEpLHRoaXMudjIuZnJvbUFycmF5KHQudjIpLHRoaXMudjMuZnJvbUFycmF5KHQudjMpLHRoaXN9LCRsLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHdsLnByb3RvdHlwZSksJGwucHJvdG90eXBlLmNvbnN0cnVjdG9yPSRsLCRsLnByb3RvdHlwZS5pc0xpbmVDdXJ2ZT0hMCwkbC5wcm90b3R5cGUuZ2V0UG9pbnQ9ZnVuY3Rpb24odCxlPW5ldyBybil7Y29uc3QgaT1lO3JldHVybiAxPT09dD9pLmNvcHkodGhpcy52Mik6KGkuY29weSh0aGlzLnYyKS5zdWIodGhpcy52MSksaS5tdWx0aXBseVNjYWxhcih0KS5hZGQodGhpcy52MSkpLGl9LCRsLnByb3RvdHlwZS5nZXRQb2ludEF0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuZ2V0UG9pbnQodCxlKX0sJGwucHJvdG90eXBlLmdldFRhbmdlbnQ9ZnVuY3Rpb24odCxlKXtjb25zdCBpPWV8fG5ldyBybjtyZXR1cm4gaS5jb3B5KHRoaXMudjIpLnN1Yih0aGlzLnYxKS5ub3JtYWxpemUoKSxpfSwkbC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4gd2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMudjEuY29weSh0LnYxKSx0aGlzLnYyLmNvcHkodC52MiksdGhpc30sJGwucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe2NvbnN0IHQ9d2wucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMpO3JldHVybiB0LnYxPXRoaXMudjEudG9BcnJheSgpLHQudjI9dGhpcy52Mi50b0FycmF5KCksdH0sJGwucHJvdG90eXBlLmZyb21KU09OPWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLHQpLHRoaXMudjEuZnJvbUFycmF5KHQudjEpLHRoaXMudjIuZnJvbUFycmF5KHQudjIpLHRoaXN9LGtsLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHdsLnByb3RvdHlwZSksa2wucHJvdG90eXBlLmNvbnN0cnVjdG9yPWtsLGtsLnByb3RvdHlwZS5pc0xpbmVDdXJ2ZTM9ITAsa2wucHJvdG90eXBlLmdldFBvaW50PWZ1bmN0aW9uKHQsZT1uZXcgZm4pe2NvbnN0IGk9ZTtyZXR1cm4gMT09PXQ/aS5jb3B5KHRoaXMudjIpOihpLmNvcHkodGhpcy52Mikuc3ViKHRoaXMudjEpLGkubXVsdGlwbHlTY2FsYXIodCkuYWRkKHRoaXMudjEpKSxpfSxrbC5wcm90b3R5cGUuZ2V0UG9pbnRBdD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmdldFBvaW50KHQsZSl9LGtsLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy52MS5jb3B5KHQudjEpLHRoaXMudjIuY29weSh0LnYyKSx0aGlzfSxrbC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7Y29uc3QgdD13bC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7cmV0dXJuIHQudjE9dGhpcy52MS50b0FycmF5KCksdC52Mj10aGlzLnYyLnRvQXJyYXkoKSx0fSxrbC5wcm90b3R5cGUuZnJvbUpTT049ZnVuY3Rpb24odCl7cmV0dXJuIHdsLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsdCksdGhpcy52MS5mcm9tQXJyYXkodC52MSksdGhpcy52Mi5mcm9tQXJyYXkodC52MiksdGhpc30semwucHJvdG90eXBlPU9iamVjdC5jcmVhdGUod2wucHJvdG90eXBlKSx6bC5wcm90b3R5cGUuY29uc3RydWN0b3I9emwsemwucHJvdG90eXBlLmlzUXVhZHJhdGljQmV6aWVyQ3VydmU9ITAsemwucHJvdG90eXBlLmdldFBvaW50PWZ1bmN0aW9uKHQsZT1uZXcgcm4pe2NvbnN0IGk9ZSxuPXRoaXMudjAscj10aGlzLnYxLHM9dGhpcy52MjtyZXR1cm4gaS5zZXQoTGwodCxuLngsci54LHMueCksTGwodCxuLnksci55LHMueSkpLGl9LHpsLnByb3RvdHlwZS5jb3B5PWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy52MC5jb3B5KHQudjApLHRoaXMudjEuY29weSh0LnYxKSx0aGlzLnYyLmNvcHkodC52MiksdGhpc30semwucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe2NvbnN0IHQ9d2wucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMpO3JldHVybiB0LnYwPXRoaXMudjAudG9BcnJheSgpLHQudjE9dGhpcy52MS50b0FycmF5KCksdC52Mj10aGlzLnYyLnRvQXJyYXkoKSx0fSx6bC5wcm90b3R5cGUuZnJvbUpTT049ZnVuY3Rpb24odCl7cmV0dXJuIHdsLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsdCksdGhpcy52MC5mcm9tQXJyYXkodC52MCksdGhpcy52MS5mcm9tQXJyYXkodC52MSksdGhpcy52Mi5mcm9tQXJyYXkodC52MiksdGhpc30sRmwucHJvdG90eXBlPU9iamVjdC5jcmVhdGUod2wucHJvdG90eXBlKSxGbC5wcm90b3R5cGUuY29uc3RydWN0b3I9RmwsRmwucHJvdG90eXBlLmlzUXVhZHJhdGljQmV6aWVyQ3VydmUzPSEwLEZsLnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbih0LGU9bmV3IGZuKXtjb25zdCBpPWUsbj10aGlzLnYwLHI9dGhpcy52MSxzPXRoaXMudjI7cmV0dXJuIGkuc2V0KExsKHQsbi54LHIueCxzLngpLExsKHQsbi55LHIueSxzLnkpLExsKHQsbi56LHIueixzLnopKSxpfSxGbC5wcm90b3R5cGUuY29weT1mdW5jdGlvbih0KXtyZXR1cm4gd2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMudjAuY29weSh0LnYwKSx0aGlzLnYxLmNvcHkodC52MSksdGhpcy52Mi5jb3B5KHQudjIpLHRoaXN9LEZsLnByb3RvdHlwZS50b0pTT049ZnVuY3Rpb24oKXtjb25zdCB0PXdsLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzKTtyZXR1cm4gdC52MD10aGlzLnYwLnRvQXJyYXkoKSx0LnYxPXRoaXMudjEudG9BcnJheSgpLHQudjI9dGhpcy52Mi50b0FycmF5KCksdH0sRmwucHJvdG90eXBlLmZyb21KU09OPWZ1bmN0aW9uKHQpe3JldHVybiB3bC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLHQpLHRoaXMudjAuZnJvbUFycmF5KHQudjApLHRoaXMudjEuZnJvbUFycmF5KHQudjEpLHRoaXMudjIuZnJvbUFycmF5KHQudjIpLHRoaXN9LEJsLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHdsLnByb3RvdHlwZSksQmwucHJvdG90eXBlLmNvbnN0cnVjdG9yPUJsLEJsLnByb3RvdHlwZS5pc1NwbGluZUN1cnZlPSEwLEJsLnByb3RvdHlwZS5nZXRQb2ludD1mdW5jdGlvbih0LGU9bmV3IHJuKXtjb25zdCBpPWUsbj10aGlzLnBvaW50cyxyPShuLmxlbmd0aC0xKSp0LHM9TWF0aC5mbG9vcihyKSxvPXItcyxhPW5bMD09PXM/czpzLTFdLGM9bltzXSxoPW5bcz5uLmxlbmd0aC0yP24ubGVuZ3RoLTE6cysxXSxsPW5bcz5uLmxlbmd0aC0zP24ubGVuZ3RoLTE6cysyXTtyZXR1cm4gaS5zZXQoUmwobyxhLngsYy54LGgueCxsLngpLFJsKG8sYS55LGMueSxoLnksbC55KSksaX0sQmwucHJvdG90eXBlLmNvcHk9ZnVuY3Rpb24odCl7d2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMucG9pbnRzPVtdO2ZvcihsZXQgZT0wLGk9dC5wb2ludHMubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dC5wb2ludHNbZV07dGhpcy5wb2ludHMucHVzaChpLmNsb25lKCkpfXJldHVybiB0aGlzfSxCbC5wcm90b3R5cGUudG9KU09OPWZ1bmN0aW9uKCl7Y29uc3QgdD13bC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7dC5wb2ludHM9W107Zm9yKGxldCBlPTAsaT10aGlzLnBvaW50cy5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10aGlzLnBvaW50c1tlXTt0LnBvaW50cy5wdXNoKGkudG9BcnJheSgpKX1yZXR1cm4gdH0sQmwucHJvdG90eXBlLmZyb21KU09OPWZ1bmN0aW9uKHQpe3dsLnByb3RvdHlwZS5mcm9tSlNPTi5jYWxsKHRoaXMsdCksdGhpcy5wb2ludHM9W107Zm9yKGxldCBlPTAsaT10LnBvaW50cy5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10LnBvaW50c1tlXTt0aGlzLnBvaW50cy5wdXNoKChuZXcgcm4pLmZyb21BcnJheShpKSl9cmV0dXJuIHRoaXN9O3ZhciBqbD1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxBcmNDdXJ2ZTpNbCxDYXRtdWxsUm9tQ3VydmUzOlBsLEN1YmljQmV6aWVyQ3VydmU6TmwsQ3ViaWNCZXppZXJDdXJ2ZTM6RGwsRWxsaXBzZUN1cnZlOlNsLExpbmVDdXJ2ZTokbCxMaW5lQ3VydmUzOmtsLFF1YWRyYXRpY0JlemllckN1cnZlOnpsLFF1YWRyYXRpY0JlemllckN1cnZlMzpGbCxTcGxpbmVDdXJ2ZTpCbH0pO2Z1bmN0aW9uIEhsKCl7d2wuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJDdXJ2ZVBhdGhcIix0aGlzLmN1cnZlcz1bXSx0aGlzLmF1dG9DbG9zZT0hMX1mdW5jdGlvbiBVbCh0KXtIbC5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIlBhdGhcIix0aGlzLmN1cnJlbnRQb2ludD1uZXcgcm4sdCYmdGhpcy5zZXRGcm9tUG9pbnRzKHQpfWZ1bmN0aW9uIFZsKHQpe1VsLmNhbGwodGhpcyx0KSx0aGlzLnV1aWQ9bm4uZ2VuZXJhdGVVVUlEKCksdGhpcy50eXBlPVwiU2hhcGVcIix0aGlzLmhvbGVzPVtdfWZ1bmN0aW9uIEdsKHQsZT0xKXtwci5jYWxsKHRoaXMpLHRoaXMudHlwZT1cIkxpZ2h0XCIsdGhpcy5jb2xvcj1uZXcgRHIodCksdGhpcy5pbnRlbnNpdHk9ZX1mdW5jdGlvbiBxbCh0LGUsaSl7R2wuY2FsbCh0aGlzLHQsaSksdGhpcy50eXBlPVwiSGVtaXNwaGVyZUxpZ2h0XCIsdGhpcy5wb3NpdGlvbi5jb3B5KHByLkRlZmF1bHRVcCksdGhpcy51cGRhdGVNYXRyaXgoKSx0aGlzLmdyb3VuZENvbG9yPW5ldyBEcihlKX1mdW5jdGlvbiBXbCh0KXt0aGlzLmNhbWVyYT10LHRoaXMuYmlhcz0wLHRoaXMubm9ybWFsQmlhcz0wLHRoaXMucmFkaXVzPTEsdGhpcy5tYXBTaXplPW5ldyBybig1MTIsNTEyKSx0aGlzLm1hcD1udWxsLHRoaXMubWFwUGFzcz1udWxsLHRoaXMubWF0cml4PW5ldyBIbix0aGlzLmF1dG9VcGRhdGU9ITAsdGhpcy5uZWVkc1VwZGF0ZT0hMSx0aGlzLl9mcnVzdHVtPW5ldyBVcyx0aGlzLl9mcmFtZUV4dGVudHM9bmV3IHJuKDEsMSksdGhpcy5fdmlld3BvcnRDb3VudD0xLHRoaXMuX3ZpZXdwb3J0cz1bbmV3IHVuKDAsMCwxLDEpXX1mdW5jdGlvbiBYbCgpe1dsLmNhbGwodGhpcyxuZXcgRHMoNTAsMSwuNSw1MDApKSx0aGlzLmZvY3VzPTF9ZnVuY3Rpb24gWWwodCxlLGksbixyLHMpe0dsLmNhbGwodGhpcyx0LGUpLHRoaXMudHlwZT1cIlNwb3RMaWdodFwiLHRoaXMucG9zaXRpb24uY29weShwci5EZWZhdWx0VXApLHRoaXMudXBkYXRlTWF0cml4KCksdGhpcy50YXJnZXQ9bmV3IHByLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLFwicG93ZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW50ZW5zaXR5Kk1hdGguUEl9LHNldDpmdW5jdGlvbih0KXt0aGlzLmludGVuc2l0eT10L01hdGguUEl9fSksdGhpcy5kaXN0YW5jZT12b2lkIDAhPT1pP2k6MCx0aGlzLmFuZ2xlPXZvaWQgMCE9PW4/bjpNYXRoLlBJLzMsdGhpcy5wZW51bWJyYT12b2lkIDAhPT1yP3I6MCx0aGlzLmRlY2F5PXZvaWQgMCE9PXM/czoxLHRoaXMuc2hhZG93PW5ldyBYbH1mdW5jdGlvbiBabCgpe1dsLmNhbGwodGhpcyxuZXcgRHMoOTAsMSwuNSw1MDApKSx0aGlzLl9mcmFtZUV4dGVudHM9bmV3IHJuKDQsMiksdGhpcy5fdmlld3BvcnRDb3VudD02LHRoaXMuX3ZpZXdwb3J0cz1bbmV3IHVuKDIsMSwxLDEpLG5ldyB1bigwLDEsMSwxKSxuZXcgdW4oMywxLDEsMSksbmV3IHVuKDEsMSwxLDEpLG5ldyB1bigzLDAsMSwxKSxuZXcgdW4oMSwwLDEsMSldLHRoaXMuX2N1YmVEaXJlY3Rpb25zPVtuZXcgZm4oMSwwLDApLG5ldyBmbigtMSwwLDApLG5ldyBmbigwLDAsMSksbmV3IGZuKDAsMCwtMSksbmV3IGZuKDAsMSwwKSxuZXcgZm4oMCwtMSwwKV0sdGhpcy5fY3ViZVVwcz1bbmV3IGZuKDAsMSwwKSxuZXcgZm4oMCwxLDApLG5ldyBmbigwLDEsMCksbmV3IGZuKDAsMSwwKSxuZXcgZm4oMCwwLDEpLG5ldyBmbigwLDAsLTEpXX1mdW5jdGlvbiBKbCh0LGUsaSxuKXtHbC5jYWxsKHRoaXMsdCxlKSx0aGlzLnR5cGU9XCJQb2ludExpZ2h0XCIsT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJwb3dlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gNCp0aGlzLmludGVuc2l0eSpNYXRoLlBJfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5pbnRlbnNpdHk9dC8oNCpNYXRoLlBJKX19KSx0aGlzLmRpc3RhbmNlPXZvaWQgMCE9PWk/aTowLHRoaXMuZGVjYXk9dm9pZCAwIT09bj9uOjEsdGhpcy5zaGFkb3c9bmV3IFpsfWZ1bmN0aW9uIEtsKHQ9LTEsZT0xLGk9MSxuPS0xLHI9LjEscz0yZTMpe05zLmNhbGwodGhpcyksdGhpcy50eXBlPVwiT3J0aG9ncmFwaGljQ2FtZXJhXCIsdGhpcy56b29tPTEsdGhpcy52aWV3PW51bGwsdGhpcy5sZWZ0PXQsdGhpcy5yaWdodD1lLHRoaXMudG9wPWksdGhpcy5ib3R0b209bix0aGlzLm5lYXI9cix0aGlzLmZhcj1zLHRoaXMudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpfWZ1bmN0aW9uIFFsKCl7V2wuY2FsbCh0aGlzLG5ldyBLbCgtNSw1LDUsLTUsLjUsNTAwKSl9ZnVuY3Rpb24gdHUodCxlKXtHbC5jYWxsKHRoaXMsdCxlKSx0aGlzLnR5cGU9XCJEaXJlY3Rpb25hbExpZ2h0XCIsdGhpcy5wb3NpdGlvbi5jb3B5KHByLkRlZmF1bHRVcCksdGhpcy51cGRhdGVNYXRyaXgoKSx0aGlzLnRhcmdldD1uZXcgcHIsdGhpcy5zaGFkb3c9bmV3IFFsfWZ1bmN0aW9uIGV1KHQsZSl7R2wuY2FsbCh0aGlzLHQsZSksdGhpcy50eXBlPVwiQW1iaWVudExpZ2h0XCJ9ZnVuY3Rpb24gaXUodCxlLGksbil7R2wuY2FsbCh0aGlzLHQsZSksdGhpcy50eXBlPVwiUmVjdEFyZWFMaWdodFwiLHRoaXMud2lkdGg9dm9pZCAwIT09aT9pOjEwLHRoaXMuaGVpZ2h0PXZvaWQgMCE9PW4/bjoxMH1IbC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHdsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOkhsLGFkZDpmdW5jdGlvbih0KXt0aGlzLmN1cnZlcy5wdXNoKHQpfSxjbG9zZVBhdGg6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuY3VydmVzWzBdLmdldFBvaW50KDApLGU9dGhpcy5jdXJ2ZXNbdGhpcy5jdXJ2ZXMubGVuZ3RoLTFdLmdldFBvaW50KDEpO3QuZXF1YWxzKGUpfHx0aGlzLmN1cnZlcy5wdXNoKG5ldyAkbChlLHQpKX0sZ2V0UG9pbnQ6ZnVuY3Rpb24odCl7Y29uc3QgZT10KnRoaXMuZ2V0TGVuZ3RoKCksaT10aGlzLmdldEN1cnZlTGVuZ3RocygpO2xldCBuPTA7Zm9yKDtuPGkubGVuZ3RoOyl7aWYoaVtuXT49ZSl7Y29uc3QgdD1pW25dLWUscj10aGlzLmN1cnZlc1tuXSxzPXIuZ2V0TGVuZ3RoKCksbz0wPT09cz8wOjEtdC9zO3JldHVybiByLmdldFBvaW50QXQobyl9bisrfXJldHVybiBudWxsfSxnZXRMZW5ndGg6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuZ2V0Q3VydmVMZW5ndGhzKCk7cmV0dXJuIHRbdC5sZW5ndGgtMV19LHVwZGF0ZUFyY0xlbmd0aHM6ZnVuY3Rpb24oKXt0aGlzLm5lZWRzVXBkYXRlPSEwLHRoaXMuY2FjaGVMZW5ndGhzPW51bGwsdGhpcy5nZXRDdXJ2ZUxlbmd0aHMoKX0sZ2V0Q3VydmVMZW5ndGhzOmZ1bmN0aW9uKCl7aWYodGhpcy5jYWNoZUxlbmd0aHMmJnRoaXMuY2FjaGVMZW5ndGhzLmxlbmd0aD09PXRoaXMuY3VydmVzLmxlbmd0aClyZXR1cm4gdGhpcy5jYWNoZUxlbmd0aHM7Y29uc3QgdD1bXTtsZXQgZT0wO2ZvcihsZXQgaT0wLG49dGhpcy5jdXJ2ZXMubGVuZ3RoO2k8bjtpKyspZSs9dGhpcy5jdXJ2ZXNbaV0uZ2V0TGVuZ3RoKCksdC5wdXNoKGUpO3JldHVybiB0aGlzLmNhY2hlTGVuZ3Rocz10LHR9LGdldFNwYWNlZFBvaW50czpmdW5jdGlvbih0PTQwKXtjb25zdCBlPVtdO2ZvcihsZXQgaT0wO2k8PXQ7aSsrKWUucHVzaCh0aGlzLmdldFBvaW50KGkvdCkpO3JldHVybiB0aGlzLmF1dG9DbG9zZSYmZS5wdXNoKGVbMF0pLGV9LGdldFBvaW50czpmdW5jdGlvbih0PTEyKXtjb25zdCBlPVtdO2xldCBpO2ZvcihsZXQgbj0wLHI9dGhpcy5jdXJ2ZXM7bjxyLmxlbmd0aDtuKyspe2NvbnN0IHM9cltuXSxvPXMmJnMuaXNFbGxpcHNlQ3VydmU/Mip0OnMmJihzLmlzTGluZUN1cnZlfHxzLmlzTGluZUN1cnZlMyk/MTpzJiZzLmlzU3BsaW5lQ3VydmU/dCpzLnBvaW50cy5sZW5ndGg6dCxhPXMuZ2V0UG9pbnRzKG8pO2ZvcihsZXQgdD0wO3Q8YS5sZW5ndGg7dCsrKXtjb25zdCBuPWFbdF07aSYmaS5lcXVhbHMobil8fChlLnB1c2gobiksaT1uKX19cmV0dXJuIHRoaXMuYXV0b0Nsb3NlJiZlLmxlbmd0aD4xJiYhZVtlLmxlbmd0aC0xXS5lcXVhbHMoZVswXSkmJmUucHVzaChlWzBdKSxlfSxjb3B5OmZ1bmN0aW9uKHQpe3dsLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmN1cnZlcz1bXTtmb3IobGV0IGU9MCxpPXQuY3VydmVzLmxlbmd0aDtlPGk7ZSsrKXtjb25zdCBpPXQuY3VydmVzW2VdO3RoaXMuY3VydmVzLnB1c2goaS5jbG9uZSgpKX1yZXR1cm4gdGhpcy5hdXRvQ2xvc2U9dC5hdXRvQ2xvc2UsdGhpc30sdG9KU09OOmZ1bmN0aW9uKCl7Y29uc3QgdD13bC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7dC5hdXRvQ2xvc2U9dGhpcy5hdXRvQ2xvc2UsdC5jdXJ2ZXM9W107Zm9yKGxldCBlPTAsaT10aGlzLmN1cnZlcy5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10aGlzLmN1cnZlc1tlXTt0LmN1cnZlcy5wdXNoKGkudG9KU09OKCkpfXJldHVybiB0fSxmcm9tSlNPTjpmdW5jdGlvbih0KXt3bC5wcm90b3R5cGUuZnJvbUpTT04uY2FsbCh0aGlzLHQpLHRoaXMuYXV0b0Nsb3NlPXQuYXV0b0Nsb3NlLHRoaXMuY3VydmVzPVtdO2ZvcihsZXQgZT0wLGk9dC5jdXJ2ZXMubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dC5jdXJ2ZXNbZV07dGhpcy5jdXJ2ZXMucHVzaCgobmV3IGpsW2kudHlwZV0pLmZyb21KU09OKGkpKX1yZXR1cm4gdGhpc319KSxVbC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEhsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOlVsLHNldEZyb21Qb2ludHM6ZnVuY3Rpb24odCl7dGhpcy5tb3ZlVG8odFswXS54LHRbMF0ueSk7Zm9yKGxldCBlPTEsaT10Lmxlbmd0aDtlPGk7ZSsrKXRoaXMubGluZVRvKHRbZV0ueCx0W2VdLnkpO3JldHVybiB0aGlzfSxtb3ZlVG86ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jdXJyZW50UG9pbnQuc2V0KHQsZSksdGhpc30sbGluZVRvOmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT1uZXcgJGwodGhpcy5jdXJyZW50UG9pbnQuY2xvbmUoKSxuZXcgcm4odCxlKSk7cmV0dXJuIHRoaXMuY3VydmVzLnB1c2goaSksdGhpcy5jdXJyZW50UG9pbnQuc2V0KHQsZSksdGhpc30scXVhZHJhdGljQ3VydmVUbzpmdW5jdGlvbih0LGUsaSxuKXtjb25zdCByPW5ldyB6bCh0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpLG5ldyBybih0LGUpLG5ldyBybihpLG4pKTtyZXR1cm4gdGhpcy5jdXJ2ZXMucHVzaChyKSx0aGlzLmN1cnJlbnRQb2ludC5zZXQoaSxuKSx0aGlzfSxiZXppZXJDdXJ2ZVRvOmZ1bmN0aW9uKHQsZSxpLG4scixzKXtjb25zdCBvPW5ldyBObCh0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpLG5ldyBybih0LGUpLG5ldyBybihpLG4pLG5ldyBybihyLHMpKTtyZXR1cm4gdGhpcy5jdXJ2ZXMucHVzaChvKSx0aGlzLmN1cnJlbnRQb2ludC5zZXQocixzKSx0aGlzfSxzcGxpbmVUaHJ1OmZ1bmN0aW9uKHQpe2NvbnN0IGU9bmV3IEJsKFt0aGlzLmN1cnJlbnRQb2ludC5jbG9uZSgpXS5jb25jYXQodCkpO3JldHVybiB0aGlzLmN1cnZlcy5wdXNoKGUpLHRoaXMuY3VycmVudFBvaW50LmNvcHkodFt0Lmxlbmd0aC0xXSksdGhpc30sYXJjOmZ1bmN0aW9uKHQsZSxpLG4scixzKXtjb25zdCBvPXRoaXMuY3VycmVudFBvaW50LngsYT10aGlzLmN1cnJlbnRQb2ludC55O3JldHVybiB0aGlzLmFic2FyYyh0K28sZSthLGksbixyLHMpLHRoaXN9LGFic2FyYzpmdW5jdGlvbih0LGUsaSxuLHIscyl7cmV0dXJuIHRoaXMuYWJzZWxsaXBzZSh0LGUsaSxpLG4scixzKSx0aGlzfSxlbGxpcHNlOmZ1bmN0aW9uKHQsZSxpLG4scixzLG8sYSl7Y29uc3QgYz10aGlzLmN1cnJlbnRQb2ludC54LGg9dGhpcy5jdXJyZW50UG9pbnQueTtyZXR1cm4gdGhpcy5hYnNlbGxpcHNlKHQrYyxlK2gsaSxuLHIscyxvLGEpLHRoaXN9LGFic2VsbGlwc2U6ZnVuY3Rpb24odCxlLGksbixyLHMsbyxhKXtjb25zdCBjPW5ldyBTbCh0LGUsaSxuLHIscyxvLGEpO2lmKHRoaXMuY3VydmVzLmxlbmd0aD4wKXtjb25zdCB0PWMuZ2V0UG9pbnQoMCk7dC5lcXVhbHModGhpcy5jdXJyZW50UG9pbnQpfHx0aGlzLmxpbmVUbyh0LngsdC55KX10aGlzLmN1cnZlcy5wdXNoKGMpO2NvbnN0IGg9Yy5nZXRQb2ludCgxKTtyZXR1cm4gdGhpcy5jdXJyZW50UG9pbnQuY29weShoKSx0aGlzfSxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiBIbC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5jdXJyZW50UG9pbnQuY29weSh0LmN1cnJlbnRQb2ludCksdGhpc30sdG9KU09OOmZ1bmN0aW9uKCl7Y29uc3QgdD1IbC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7cmV0dXJuIHQuY3VycmVudFBvaW50PXRoaXMuY3VycmVudFBvaW50LnRvQXJyYXkoKSx0fSxmcm9tSlNPTjpmdW5jdGlvbih0KXtyZXR1cm4gSGwucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcyx0KSx0aGlzLmN1cnJlbnRQb2ludC5mcm9tQXJyYXkodC5jdXJyZW50UG9pbnQpLHRoaXN9fSksVmwucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShVbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpWbCxnZXRQb2ludHNIb2xlczpmdW5jdGlvbih0KXtjb25zdCBlPVtdO2ZvcihsZXQgaT0wLG49dGhpcy5ob2xlcy5sZW5ndGg7aTxuO2krKyllW2ldPXRoaXMuaG9sZXNbaV0uZ2V0UG9pbnRzKHQpO3JldHVybiBlfSxleHRyYWN0UG9pbnRzOmZ1bmN0aW9uKHQpe3JldHVybntzaGFwZTp0aGlzLmdldFBvaW50cyh0KSxob2xlczp0aGlzLmdldFBvaW50c0hvbGVzKHQpfX0sY29weTpmdW5jdGlvbih0KXtVbC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5ob2xlcz1bXTtmb3IobGV0IGU9MCxpPXQuaG9sZXMubGVuZ3RoO2U8aTtlKyspe2NvbnN0IGk9dC5ob2xlc1tlXTt0aGlzLmhvbGVzLnB1c2goaS5jbG9uZSgpKX1yZXR1cm4gdGhpc30sdG9KU09OOmZ1bmN0aW9uKCl7Y29uc3QgdD1VbC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7dC51dWlkPXRoaXMudXVpZCx0LmhvbGVzPVtdO2ZvcihsZXQgZT0wLGk9dGhpcy5ob2xlcy5sZW5ndGg7ZTxpO2UrKyl7Y29uc3QgaT10aGlzLmhvbGVzW2VdO3QuaG9sZXMucHVzaChpLnRvSlNPTigpKX1yZXR1cm4gdH0sZnJvbUpTT046ZnVuY3Rpb24odCl7VWwucHJvdG90eXBlLmZyb21KU09OLmNhbGwodGhpcyx0KSx0aGlzLnV1aWQ9dC51dWlkLHRoaXMuaG9sZXM9W107Zm9yKGxldCBlPTAsaT10LmhvbGVzLmxlbmd0aDtlPGk7ZSsrKXtjb25zdCBpPXQuaG9sZXNbZV07dGhpcy5ob2xlcy5wdXNoKChuZXcgVWwpLmZyb21KU09OKGkpKX1yZXR1cm4gdGhpc319KSxHbC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHByLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOkdsLGlzTGlnaHQ6ITAsY29weTpmdW5jdGlvbih0KXtyZXR1cm4gcHIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuY29sb3IuY29weSh0LmNvbG9yKSx0aGlzLmludGVuc2l0eT10LmludGVuc2l0eSx0aGlzfSx0b0pTT046ZnVuY3Rpb24odCl7Y29uc3QgZT1wci5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyx0KTtyZXR1cm4gZS5vYmplY3QuY29sb3I9dGhpcy5jb2xvci5nZXRIZXgoKSxlLm9iamVjdC5pbnRlbnNpdHk9dGhpcy5pbnRlbnNpdHksdm9pZCAwIT09dGhpcy5ncm91bmRDb2xvciYmKGUub2JqZWN0Lmdyb3VuZENvbG9yPXRoaXMuZ3JvdW5kQ29sb3IuZ2V0SGV4KCkpLHZvaWQgMCE9PXRoaXMuZGlzdGFuY2UmJihlLm9iamVjdC5kaXN0YW5jZT10aGlzLmRpc3RhbmNlKSx2b2lkIDAhPT10aGlzLmFuZ2xlJiYoZS5vYmplY3QuYW5nbGU9dGhpcy5hbmdsZSksdm9pZCAwIT09dGhpcy5kZWNheSYmKGUub2JqZWN0LmRlY2F5PXRoaXMuZGVjYXkpLHZvaWQgMCE9PXRoaXMucGVudW1icmEmJihlLm9iamVjdC5wZW51bWJyYT10aGlzLnBlbnVtYnJhKSx2b2lkIDAhPT10aGlzLnNoYWRvdyYmKGUub2JqZWN0LnNoYWRvdz10aGlzLnNoYWRvdy50b0pTT04oKSksZX19KSxxbC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEdsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnFsLGlzSGVtaXNwaGVyZUxpZ2h0OiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIEdsLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmdyb3VuZENvbG9yLmNvcHkodC5ncm91bmRDb2xvciksdGhpc319KSxPYmplY3QuYXNzaWduKFdsLnByb3RvdHlwZSx7X3Byb2pTY3JlZW5NYXRyaXg6bmV3IEhuLF9saWdodFBvc2l0aW9uV29ybGQ6bmV3IGZuLF9sb29rVGFyZ2V0Om5ldyBmbixnZXRWaWV3cG9ydENvdW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZpZXdwb3J0Q291bnR9LGdldEZydXN0dW06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZnJ1c3R1bX0sdXBkYXRlTWF0cmljZXM6ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLmNhbWVyYSxpPXRoaXMubWF0cml4LG49dGhpcy5fcHJvalNjcmVlbk1hdHJpeCxyPXRoaXMuX2xvb2tUYXJnZXQscz10aGlzLl9saWdodFBvc2l0aW9uV29ybGQ7cy5zZXRGcm9tTWF0cml4UG9zaXRpb24odC5tYXRyaXhXb3JsZCksZS5wb3NpdGlvbi5jb3B5KHMpLHIuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHQudGFyZ2V0Lm1hdHJpeFdvcmxkKSxlLmxvb2tBdChyKSxlLnVwZGF0ZU1hdHJpeFdvcmxkKCksbi5tdWx0aXBseU1hdHJpY2VzKGUucHJvamVjdGlvbk1hdHJpeCxlLm1hdHJpeFdvcmxkSW52ZXJzZSksdGhpcy5fZnJ1c3R1bS5zZXRGcm9tUHJvamVjdGlvbk1hdHJpeChuKSxpLnNldCguNSwwLDAsLjUsMCwuNSwwLC41LDAsMCwuNSwuNSwwLDAsMCwxKSxpLm11bHRpcGx5KGUucHJvamVjdGlvbk1hdHJpeCksaS5tdWx0aXBseShlLm1hdHJpeFdvcmxkSW52ZXJzZSl9LGdldFZpZXdwb3J0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl92aWV3cG9ydHNbdF19LGdldEZyYW1lRXh0ZW50czpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9mcmFtZUV4dGVudHN9LGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY2FtZXJhPXQuY2FtZXJhLmNsb25lKCksdGhpcy5iaWFzPXQuYmlhcyx0aGlzLnJhZGl1cz10LnJhZGl1cyx0aGlzLm1hcFNpemUuY29weSh0Lm1hcFNpemUpLHRoaXN9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuKG5ldyB0aGlzLmNvbnN0cnVjdG9yKS5jb3B5KHRoaXMpfSx0b0pTT046ZnVuY3Rpb24oKXtjb25zdCB0PXt9O3JldHVybiAwIT09dGhpcy5iaWFzJiYodC5iaWFzPXRoaXMuYmlhcyksMCE9PXRoaXMubm9ybWFsQmlhcyYmKHQubm9ybWFsQmlhcz10aGlzLm5vcm1hbEJpYXMpLDEhPT10aGlzLnJhZGl1cyYmKHQucmFkaXVzPXRoaXMucmFkaXVzKSw1MTI9PT10aGlzLm1hcFNpemUueCYmNTEyPT09dGhpcy5tYXBTaXplLnl8fCh0Lm1hcFNpemU9dGhpcy5tYXBTaXplLnRvQXJyYXkoKSksdC5jYW1lcmE9dGhpcy5jYW1lcmEudG9KU09OKCExKS5vYmplY3QsZGVsZXRlIHQuY2FtZXJhLm1hdHJpeCx0fX0pLFhsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoV2wucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6WGwsaXNTcG90TGlnaHRTaGFkb3c6ITAsdXBkYXRlTWF0cmljZXM6ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLmNhbWVyYSxpPTIqbm4uUkFEMkRFRyp0LmFuZ2xlKnRoaXMuZm9jdXMsbj10aGlzLm1hcFNpemUud2lkdGgvdGhpcy5tYXBTaXplLmhlaWdodCxyPXQuZGlzdGFuY2V8fGUuZmFyO2k9PT1lLmZvdiYmbj09PWUuYXNwZWN0JiZyPT09ZS5mYXJ8fChlLmZvdj1pLGUuYXNwZWN0PW4sZS5mYXI9cixlLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKSksV2wucHJvdG90eXBlLnVwZGF0ZU1hdHJpY2VzLmNhbGwodGhpcyx0KX19KSxZbC5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEdsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOllsLGlzU3BvdExpZ2h0OiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIEdsLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLmRpc3RhbmNlPXQuZGlzdGFuY2UsdGhpcy5hbmdsZT10LmFuZ2xlLHRoaXMucGVudW1icmE9dC5wZW51bWJyYSx0aGlzLmRlY2F5PXQuZGVjYXksdGhpcy50YXJnZXQ9dC50YXJnZXQuY2xvbmUoKSx0aGlzLnNoYWRvdz10LnNoYWRvdy5jbG9uZSgpLHRoaXN9fSksWmwucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShXbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpabCxpc1BvaW50TGlnaHRTaGFkb3c6ITAsdXBkYXRlTWF0cmljZXM6ZnVuY3Rpb24odCxlPTApe2NvbnN0IGk9dGhpcy5jYW1lcmEsbj10aGlzLm1hdHJpeCxyPXRoaXMuX2xpZ2h0UG9zaXRpb25Xb3JsZCxzPXRoaXMuX2xvb2tUYXJnZXQsbz10aGlzLl9wcm9qU2NyZWVuTWF0cml4O3Iuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKHQubWF0cml4V29ybGQpLGkucG9zaXRpb24uY29weShyKSxzLmNvcHkoaS5wb3NpdGlvbikscy5hZGQodGhpcy5fY3ViZURpcmVjdGlvbnNbZV0pLGkudXAuY29weSh0aGlzLl9jdWJlVXBzW2VdKSxpLmxvb2tBdChzKSxpLnVwZGF0ZU1hdHJpeFdvcmxkKCksbi5tYWtlVHJhbnNsYXRpb24oLXIueCwtci55LC1yLnopLG8ubXVsdGlwbHlNYXRyaWNlcyhpLnByb2plY3Rpb25NYXRyaXgsaS5tYXRyaXhXb3JsZEludmVyc2UpLHRoaXMuX2ZydXN0dW0uc2V0RnJvbVByb2plY3Rpb25NYXRyaXgobyl9fSksSmwucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShHbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpKbCxpc1BvaW50TGlnaHQ6ITAsY29weTpmdW5jdGlvbih0KXtyZXR1cm4gR2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuZGlzdGFuY2U9dC5kaXN0YW5jZSx0aGlzLmRlY2F5PXQuZGVjYXksdGhpcy5zaGFkb3c9dC5zaGFkb3cuY2xvbmUoKSx0aGlzfX0pLEtsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoTnMucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6S2wsaXNPcnRob2dyYXBoaWNDYW1lcmE6ITAsY29weTpmdW5jdGlvbih0LGUpe3JldHVybiBOcy5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCxlKSx0aGlzLmxlZnQ9dC5sZWZ0LHRoaXMucmlnaHQ9dC5yaWdodCx0aGlzLnRvcD10LnRvcCx0aGlzLmJvdHRvbT10LmJvdHRvbSx0aGlzLm5lYXI9dC5uZWFyLHRoaXMuZmFyPXQuZmFyLHRoaXMuem9vbT10Lnpvb20sdGhpcy52aWV3PW51bGw9PT10LnZpZXc/bnVsbDpPYmplY3QuYXNzaWduKHt9LHQudmlldyksdGhpc30sc2V0Vmlld09mZnNldDpmdW5jdGlvbih0LGUsaSxuLHIscyl7bnVsbD09PXRoaXMudmlldyYmKHRoaXMudmlldz17ZW5hYmxlZDohMCxmdWxsV2lkdGg6MSxmdWxsSGVpZ2h0OjEsb2Zmc2V0WDowLG9mZnNldFk6MCx3aWR0aDoxLGhlaWdodDoxfSksdGhpcy52aWV3LmVuYWJsZWQ9ITAsdGhpcy52aWV3LmZ1bGxXaWR0aD10LHRoaXMudmlldy5mdWxsSGVpZ2h0PWUsdGhpcy52aWV3Lm9mZnNldFg9aSx0aGlzLnZpZXcub2Zmc2V0WT1uLHRoaXMudmlldy53aWR0aD1yLHRoaXMudmlldy5oZWlnaHQ9cyx0aGlzLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKX0sY2xlYXJWaWV3T2Zmc2V0OmZ1bmN0aW9uKCl7bnVsbCE9PXRoaXMudmlldyYmKHRoaXMudmlldy5lbmFibGVkPSExKSx0aGlzLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKX0sdXBkYXRlUHJvamVjdGlvbk1hdHJpeDpmdW5jdGlvbigpe2NvbnN0IHQ9KHRoaXMucmlnaHQtdGhpcy5sZWZ0KS8oMip0aGlzLnpvb20pLGU9KHRoaXMudG9wLXRoaXMuYm90dG9tKS8oMip0aGlzLnpvb20pLGk9KHRoaXMucmlnaHQrdGhpcy5sZWZ0KS8yLG49KHRoaXMudG9wK3RoaXMuYm90dG9tKS8yO2xldCByPWktdCxzPWkrdCxvPW4rZSxhPW4tZTtpZihudWxsIT09dGhpcy52aWV3JiZ0aGlzLnZpZXcuZW5hYmxlZCl7Y29uc3QgdD0odGhpcy5yaWdodC10aGlzLmxlZnQpL3RoaXMudmlldy5mdWxsV2lkdGgvdGhpcy56b29tLGU9KHRoaXMudG9wLXRoaXMuYm90dG9tKS90aGlzLnZpZXcuZnVsbEhlaWdodC90aGlzLnpvb207cis9dCp0aGlzLnZpZXcub2Zmc2V0WCxzPXIrdCp0aGlzLnZpZXcud2lkdGgsby09ZSp0aGlzLnZpZXcub2Zmc2V0WSxhPW8tZSp0aGlzLnZpZXcuaGVpZ2h0fXRoaXMucHJvamVjdGlvbk1hdHJpeC5tYWtlT3J0aG9ncmFwaGljKHIscyxvLGEsdGhpcy5uZWFyLHRoaXMuZmFyKSx0aGlzLnByb2plY3Rpb25NYXRyaXhJbnZlcnNlLmNvcHkodGhpcy5wcm9qZWN0aW9uTWF0cml4KS5pbnZlcnQoKX0sdG9KU09OOmZ1bmN0aW9uKHQpe2NvbnN0IGU9cHIucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsdCk7cmV0dXJuIGUub2JqZWN0Lnpvb209dGhpcy56b29tLGUub2JqZWN0LmxlZnQ9dGhpcy5sZWZ0LGUub2JqZWN0LnJpZ2h0PXRoaXMucmlnaHQsZS5vYmplY3QudG9wPXRoaXMudG9wLGUub2JqZWN0LmJvdHRvbT10aGlzLmJvdHRvbSxlLm9iamVjdC5uZWFyPXRoaXMubmVhcixlLm9iamVjdC5mYXI9dGhpcy5mYXIsbnVsbCE9PXRoaXMudmlldyYmKGUub2JqZWN0LnZpZXc9T2JqZWN0LmFzc2lnbih7fSx0aGlzLnZpZXcpKSxlfX0pLFFsLnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoV2wucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6UWwsaXNEaXJlY3Rpb25hbExpZ2h0U2hhZG93OiEwLHVwZGF0ZU1hdHJpY2VzOmZ1bmN0aW9uKHQpe1dsLnByb3RvdHlwZS51cGRhdGVNYXRyaWNlcy5jYWxsKHRoaXMsdCl9fSksdHUucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShHbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3Rvcjp0dSxpc0RpcmVjdGlvbmFsTGlnaHQ6ITAsY29weTpmdW5jdGlvbih0KXtyZXR1cm4gR2wucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMudGFyZ2V0PXQudGFyZ2V0LmNsb25lKCksdGhpcy5zaGFkb3c9dC5zaGFkb3cuY2xvbmUoKSx0aGlzfX0pLGV1LnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoR2wucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6ZXUsaXNBbWJpZW50TGlnaHQ6ITB9KSxpdS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEdsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOml1LGlzUmVjdEFyZWFMaWdodDohMCxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiBHbC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy53aWR0aD10LndpZHRoLHRoaXMuaGVpZ2h0PXQuaGVpZ2h0LHRoaXN9LHRvSlNPTjpmdW5jdGlvbih0KXtjb25zdCBlPUdsLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzLHQpO3JldHVybiBlLm9iamVjdC53aWR0aD10aGlzLndpZHRoLGUub2JqZWN0LmhlaWdodD10aGlzLmhlaWdodCxlfX0pO2NsYXNzIG51e2NvbnN0cnVjdG9yKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpc1NwaGVyaWNhbEhhcm1vbmljczNcIix7dmFsdWU6ITB9KSx0aGlzLmNvZWZmaWNpZW50cz1bXTtmb3IobGV0IHQ9MDt0PDk7dCsrKXRoaXMuY29lZmZpY2llbnRzLnB1c2gobmV3IGZuKX1zZXQodCl7Zm9yKGxldCBlPTA7ZTw5O2UrKyl0aGlzLmNvZWZmaWNpZW50c1tlXS5jb3B5KHRbZV0pO3JldHVybiB0aGlzfXplcm8oKXtmb3IobGV0IHQ9MDt0PDk7dCsrKXRoaXMuY29lZmZpY2llbnRzW3RdLnNldCgwLDAsMCk7cmV0dXJuIHRoaXN9Z2V0QXQodCxlKXtjb25zdCBpPXQueCxuPXQueSxyPXQueixzPXRoaXMuY29lZmZpY2llbnRzO3JldHVybiBlLmNvcHkoc1swXSkubXVsdGlwbHlTY2FsYXIoLjI4MjA5NSksZS5hZGRTY2FsZWRWZWN0b3Ioc1sxXSwuNDg4NjAzKm4pLGUuYWRkU2NhbGVkVmVjdG9yKHNbMl0sLjQ4ODYwMypyKSxlLmFkZFNjYWxlZFZlY3RvcihzWzNdLC40ODg2MDMqaSksZS5hZGRTY2FsZWRWZWN0b3Ioc1s0XSxpKm4qMS4wOTI1NDgpLGUuYWRkU2NhbGVkVmVjdG9yKHNbNV0sbipyKjEuMDkyNTQ4KSxlLmFkZFNjYWxlZFZlY3RvcihzWzZdLC4zMTUzOTIqKDMqcipyLTEpKSxlLmFkZFNjYWxlZFZlY3RvcihzWzddLGkqcioxLjA5MjU0OCksZS5hZGRTY2FsZWRWZWN0b3Ioc1s4XSwuNTQ2Mjc0KihpKmktbipuKSksZX1nZXRJcnJhZGlhbmNlQXQodCxlKXtjb25zdCBpPXQueCxuPXQueSxyPXQueixzPXRoaXMuY29lZmZpY2llbnRzO3JldHVybiBlLmNvcHkoc1swXSkubXVsdGlwbHlTY2FsYXIoLjg4NjIyNyksZS5hZGRTY2FsZWRWZWN0b3Ioc1sxXSwxLjAyMzMyOCpuKSxlLmFkZFNjYWxlZFZlY3RvcihzWzJdLDEuMDIzMzI4KnIpLGUuYWRkU2NhbGVkVmVjdG9yKHNbM10sMS4wMjMzMjgqaSksZS5hZGRTY2FsZWRWZWN0b3Ioc1s0XSwuODU4MDg2KmkqbiksZS5hZGRTY2FsZWRWZWN0b3Ioc1s1XSwuODU4MDg2Km4qciksZS5hZGRTY2FsZWRWZWN0b3Ioc1s2XSwuNzQzMTI1KnIqci0uMjQ3NzA4KSxlLmFkZFNjYWxlZFZlY3RvcihzWzddLC44NTgwODYqaSpyKSxlLmFkZFNjYWxlZFZlY3RvcihzWzhdLC40MjkwNDMqKGkqaS1uKm4pKSxlfWFkZCh0KXtmb3IobGV0IGU9MDtlPDk7ZSsrKXRoaXMuY29lZmZpY2llbnRzW2VdLmFkZCh0LmNvZWZmaWNpZW50c1tlXSk7cmV0dXJuIHRoaXN9YWRkU2NhbGVkU0godCxlKXtmb3IobGV0IGk9MDtpPDk7aSsrKXRoaXMuY29lZmZpY2llbnRzW2ldLmFkZFNjYWxlZFZlY3Rvcih0LmNvZWZmaWNpZW50c1tpXSxlKTtyZXR1cm4gdGhpc31zY2FsZSh0KXtmb3IobGV0IGU9MDtlPDk7ZSsrKXRoaXMuY29lZmZpY2llbnRzW2VdLm11bHRpcGx5U2NhbGFyKHQpO3JldHVybiB0aGlzfWxlcnAodCxlKXtmb3IobGV0IGk9MDtpPDk7aSsrKXRoaXMuY29lZmZpY2llbnRzW2ldLmxlcnAodC5jb2VmZmljaWVudHNbaV0sZSk7cmV0dXJuIHRoaXN9ZXF1YWxzKHQpe2ZvcihsZXQgZT0wO2U8OTtlKyspaWYoIXRoaXMuY29lZmZpY2llbnRzW2VdLmVxdWFscyh0LmNvZWZmaWNpZW50c1tlXSkpcmV0dXJuITE7cmV0dXJuITB9Y29weSh0KXtyZXR1cm4gdGhpcy5zZXQodC5jb2VmZmljaWVudHMpfWNsb25lKCl7cmV0dXJuKG5ldyB0aGlzLmNvbnN0cnVjdG9yKS5jb3B5KHRoaXMpfWZyb21BcnJheSh0LGU9MCl7Y29uc3QgaT10aGlzLmNvZWZmaWNpZW50cztmb3IobGV0IG49MDtuPDk7bisrKWlbbl0uZnJvbUFycmF5KHQsZSszKm4pO3JldHVybiB0aGlzfXRvQXJyYXkodD1bXSxlPTApe2NvbnN0IGk9dGhpcy5jb2VmZmljaWVudHM7Zm9yKGxldCBuPTA7bjw5O24rKylpW25dLnRvQXJyYXkodCxlKzMqbik7cmV0dXJuIHR9c3RhdGljIGdldEJhc2lzQXQodCxlKXtjb25zdCBpPXQueCxuPXQueSxyPXQuejtlWzBdPS4yODIwOTUsZVsxXT0uNDg4NjAzKm4sZVsyXT0uNDg4NjAzKnIsZVszXT0uNDg4NjAzKmksZVs0XT0xLjA5MjU0OCppKm4sZVs1XT0xLjA5MjU0OCpuKnIsZVs2XT0uMzE1MzkyKigzKnIqci0xKSxlWzddPTEuMDkyNTQ4KmkqcixlWzhdPS41NDYyNzQqKGkqaS1uKm4pfX1mdW5jdGlvbiBydSh0LGUpe0dsLmNhbGwodGhpcyx2b2lkIDAsZSksdGhpcy50eXBlPVwiTGlnaHRQcm9iZVwiLHRoaXMuc2g9dm9pZCAwIT09dD90Om5ldyBudX1mdW5jdGlvbiBzdSh0KXtwbC5jYWxsKHRoaXMsdCksdGhpcy50ZXh0dXJlcz17fX1ydS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEdsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnJ1LGlzTGlnaHRQcm9iZTohMCxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiBHbC5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpcy5zaC5jb3B5KHQuc2gpLHRoaXN9LGZyb21KU09OOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmludGVuc2l0eT10LmludGVuc2l0eSx0aGlzLnNoLmZyb21BcnJheSh0LnNoKSx0aGlzfSx0b0pTT046ZnVuY3Rpb24odCl7Y29uc3QgZT1HbC5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyx0KTtyZXR1cm4gZS5vYmplY3Quc2g9dGhpcy5zaC50b0FycmF5KCksZX19KSxzdS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHBsLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnN1LGxvYWQ6ZnVuY3Rpb24odCxlLGksbil7Y29uc3Qgcj10aGlzLHM9bmV3IG1sKHIubWFuYWdlcik7cy5zZXRQYXRoKHIucGF0aCkscy5zZXRSZXF1ZXN0SGVhZGVyKHIucmVxdWVzdEhlYWRlcikscy5zZXRXaXRoQ3JlZGVudGlhbHMoci53aXRoQ3JlZGVudGlhbHMpLHMubG9hZCh0LChmdW5jdGlvbihpKXt0cnl7ZShyLnBhcnNlKEpTT04ucGFyc2UoaSkpKX1jYXRjaChlKXtuP24oZSk6Y29uc29sZS5lcnJvcihlKSxyLm1hbmFnZXIuaXRlbUVycm9yKHQpfX0pLGksbil9LHBhcnNlOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy50ZXh0dXJlcztmdW5jdGlvbiBpKHQpe3JldHVybiB2b2lkIDA9PT1lW3RdJiZjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRlcmlhbExvYWRlcjogVW5kZWZpbmVkIHRleHR1cmVcIix0KSxlW3RdfWNvbnN0IG49bmV3IFloW3QudHlwZV07aWYodm9pZCAwIT09dC51dWlkJiYobi51dWlkPXQudXVpZCksdm9pZCAwIT09dC5uYW1lJiYobi5uYW1lPXQubmFtZSksdm9pZCAwIT09dC5jb2xvciYmdm9pZCAwIT09bi5jb2xvciYmbi5jb2xvci5zZXRIZXgodC5jb2xvciksdm9pZCAwIT09dC5yb3VnaG5lc3MmJihuLnJvdWdobmVzcz10LnJvdWdobmVzcyksdm9pZCAwIT09dC5tZXRhbG5lc3MmJihuLm1ldGFsbmVzcz10Lm1ldGFsbmVzcyksdm9pZCAwIT09dC5zaGVlbiYmKG4uc2hlZW49KG5ldyBEcikuc2V0SGV4KHQuc2hlZW4pKSx2b2lkIDAhPT10LmVtaXNzaXZlJiZ2b2lkIDAhPT1uLmVtaXNzaXZlJiZuLmVtaXNzaXZlLnNldEhleCh0LmVtaXNzaXZlKSx2b2lkIDAhPT10LnNwZWN1bGFyJiZ2b2lkIDAhPT1uLnNwZWN1bGFyJiZuLnNwZWN1bGFyLnNldEhleCh0LnNwZWN1bGFyKSx2b2lkIDAhPT10LnNoaW5pbmVzcyYmKG4uc2hpbmluZXNzPXQuc2hpbmluZXNzKSx2b2lkIDAhPT10LmNsZWFyY29hdCYmKG4uY2xlYXJjb2F0PXQuY2xlYXJjb2F0KSx2b2lkIDAhPT10LmNsZWFyY29hdFJvdWdobmVzcyYmKG4uY2xlYXJjb2F0Um91Z2huZXNzPXQuY2xlYXJjb2F0Um91Z2huZXNzKSx2b2lkIDAhPT10LmZvZyYmKG4uZm9nPXQuZm9nKSx2b2lkIDAhPT10LmZsYXRTaGFkaW5nJiYobi5mbGF0U2hhZGluZz10LmZsYXRTaGFkaW5nKSx2b2lkIDAhPT10LmJsZW5kaW5nJiYobi5ibGVuZGluZz10LmJsZW5kaW5nKSx2b2lkIDAhPT10LmNvbWJpbmUmJihuLmNvbWJpbmU9dC5jb21iaW5lKSx2b2lkIDAhPT10LnNpZGUmJihuLnNpZGU9dC5zaWRlKSx2b2lkIDAhPT10Lm9wYWNpdHkmJihuLm9wYWNpdHk9dC5vcGFjaXR5KSx2b2lkIDAhPT10LnRyYW5zcGFyZW50JiYobi50cmFuc3BhcmVudD10LnRyYW5zcGFyZW50KSx2b2lkIDAhPT10LmFscGhhVGVzdCYmKG4uYWxwaGFUZXN0PXQuYWxwaGFUZXN0KSx2b2lkIDAhPT10LmRlcHRoVGVzdCYmKG4uZGVwdGhUZXN0PXQuZGVwdGhUZXN0KSx2b2lkIDAhPT10LmRlcHRoV3JpdGUmJihuLmRlcHRoV3JpdGU9dC5kZXB0aFdyaXRlKSx2b2lkIDAhPT10LmNvbG9yV3JpdGUmJihuLmNvbG9yV3JpdGU9dC5jb2xvcldyaXRlKSx2b2lkIDAhPT10LnN0ZW5jaWxXcml0ZSYmKG4uc3RlbmNpbFdyaXRlPXQuc3RlbmNpbFdyaXRlKSx2b2lkIDAhPT10LnN0ZW5jaWxXcml0ZU1hc2smJihuLnN0ZW5jaWxXcml0ZU1hc2s9dC5zdGVuY2lsV3JpdGVNYXNrKSx2b2lkIDAhPT10LnN0ZW5jaWxGdW5jJiYobi5zdGVuY2lsRnVuYz10LnN0ZW5jaWxGdW5jKSx2b2lkIDAhPT10LnN0ZW5jaWxSZWYmJihuLnN0ZW5jaWxSZWY9dC5zdGVuY2lsUmVmKSx2b2lkIDAhPT10LnN0ZW5jaWxGdW5jTWFzayYmKG4uc3RlbmNpbEZ1bmNNYXNrPXQuc3RlbmNpbEZ1bmNNYXNrKSx2b2lkIDAhPT10LnN0ZW5jaWxGYWlsJiYobi5zdGVuY2lsRmFpbD10LnN0ZW5jaWxGYWlsKSx2b2lkIDAhPT10LnN0ZW5jaWxaRmFpbCYmKG4uc3RlbmNpbFpGYWlsPXQuc3RlbmNpbFpGYWlsKSx2b2lkIDAhPT10LnN0ZW5jaWxaUGFzcyYmKG4uc3RlbmNpbFpQYXNzPXQuc3RlbmNpbFpQYXNzKSx2b2lkIDAhPT10LndpcmVmcmFtZSYmKG4ud2lyZWZyYW1lPXQud2lyZWZyYW1lKSx2b2lkIDAhPT10LndpcmVmcmFtZUxpbmV3aWR0aCYmKG4ud2lyZWZyYW1lTGluZXdpZHRoPXQud2lyZWZyYW1lTGluZXdpZHRoKSx2b2lkIDAhPT10LndpcmVmcmFtZUxpbmVjYXAmJihuLndpcmVmcmFtZUxpbmVjYXA9dC53aXJlZnJhbWVMaW5lY2FwKSx2b2lkIDAhPT10LndpcmVmcmFtZUxpbmVqb2luJiYobi53aXJlZnJhbWVMaW5lam9pbj10LndpcmVmcmFtZUxpbmVqb2luKSx2b2lkIDAhPT10LnJvdGF0aW9uJiYobi5yb3RhdGlvbj10LnJvdGF0aW9uKSwxIT09dC5saW5ld2lkdGgmJihuLmxpbmV3aWR0aD10LmxpbmV3aWR0aCksdm9pZCAwIT09dC5kYXNoU2l6ZSYmKG4uZGFzaFNpemU9dC5kYXNoU2l6ZSksdm9pZCAwIT09dC5nYXBTaXplJiYobi5nYXBTaXplPXQuZ2FwU2l6ZSksdm9pZCAwIT09dC5zY2FsZSYmKG4uc2NhbGU9dC5zY2FsZSksdm9pZCAwIT09dC5wb2x5Z29uT2Zmc2V0JiYobi5wb2x5Z29uT2Zmc2V0PXQucG9seWdvbk9mZnNldCksdm9pZCAwIT09dC5wb2x5Z29uT2Zmc2V0RmFjdG9yJiYobi5wb2x5Z29uT2Zmc2V0RmFjdG9yPXQucG9seWdvbk9mZnNldEZhY3Rvciksdm9pZCAwIT09dC5wb2x5Z29uT2Zmc2V0VW5pdHMmJihuLnBvbHlnb25PZmZzZXRVbml0cz10LnBvbHlnb25PZmZzZXRVbml0cyksdm9pZCAwIT09dC5za2lubmluZyYmKG4uc2tpbm5pbmc9dC5za2lubmluZyksdm9pZCAwIT09dC5tb3JwaFRhcmdldHMmJihuLm1vcnBoVGFyZ2V0cz10Lm1vcnBoVGFyZ2V0cyksdm9pZCAwIT09dC5tb3JwaE5vcm1hbHMmJihuLm1vcnBoTm9ybWFscz10Lm1vcnBoTm9ybWFscyksdm9pZCAwIT09dC5kaXRoZXJpbmcmJihuLmRpdGhlcmluZz10LmRpdGhlcmluZyksdm9pZCAwIT09dC52ZXJ0ZXhUYW5nZW50cyYmKG4udmVydGV4VGFuZ2VudHM9dC52ZXJ0ZXhUYW5nZW50cyksdm9pZCAwIT09dC52aXNpYmxlJiYobi52aXNpYmxlPXQudmlzaWJsZSksdm9pZCAwIT09dC50b25lTWFwcGVkJiYobi50b25lTWFwcGVkPXQudG9uZU1hcHBlZCksdm9pZCAwIT09dC51c2VyRGF0YSYmKG4udXNlckRhdGE9dC51c2VyRGF0YSksdm9pZCAwIT09dC52ZXJ0ZXhDb2xvcnMmJihcIm51bWJlclwiPT10eXBlb2YgdC52ZXJ0ZXhDb2xvcnM/bi52ZXJ0ZXhDb2xvcnM9dC52ZXJ0ZXhDb2xvcnM+MDpuLnZlcnRleENvbG9ycz10LnZlcnRleENvbG9ycyksdm9pZCAwIT09dC51bmlmb3Jtcylmb3IoY29uc3QgZSBpbiB0LnVuaWZvcm1zKXtjb25zdCByPXQudW5pZm9ybXNbZV07c3dpdGNoKG4udW5pZm9ybXNbZV09e30sci50eXBlKXtjYXNlXCJ0XCI6bi51bmlmb3Jtc1tlXS52YWx1ZT1pKHIudmFsdWUpO2JyZWFrO2Nhc2VcImNcIjpuLnVuaWZvcm1zW2VdLnZhbHVlPShuZXcgRHIpLnNldEhleChyLnZhbHVlKTticmVhaztjYXNlXCJ2MlwiOm4udW5pZm9ybXNbZV0udmFsdWU9KG5ldyBybikuZnJvbUFycmF5KHIudmFsdWUpO2JyZWFrO2Nhc2VcInYzXCI6bi51bmlmb3Jtc1tlXS52YWx1ZT0obmV3IGZuKS5mcm9tQXJyYXkoci52YWx1ZSk7YnJlYWs7Y2FzZVwidjRcIjpuLnVuaWZvcm1zW2VdLnZhbHVlPShuZXcgdW4pLmZyb21BcnJheShyLnZhbHVlKTticmVhaztjYXNlXCJtM1wiOm4udW5pZm9ybXNbZV0udmFsdWU9KG5ldyBzbikuZnJvbUFycmF5KHIudmFsdWUpO2JyZWFrO2Nhc2VcIm00XCI6bi51bmlmb3Jtc1tlXS52YWx1ZT0obmV3IEhuKS5mcm9tQXJyYXkoci52YWx1ZSk7YnJlYWs7ZGVmYXVsdDpuLnVuaWZvcm1zW2VdLnZhbHVlPXIudmFsdWV9fWlmKHZvaWQgMCE9PXQuZGVmaW5lcyYmKG4uZGVmaW5lcz10LmRlZmluZXMpLHZvaWQgMCE9PXQudmVydGV4U2hhZGVyJiYobi52ZXJ0ZXhTaGFkZXI9dC52ZXJ0ZXhTaGFkZXIpLHZvaWQgMCE9PXQuZnJhZ21lbnRTaGFkZXImJihuLmZyYWdtZW50U2hhZGVyPXQuZnJhZ21lbnRTaGFkZXIpLHZvaWQgMCE9PXQuZXh0ZW5zaW9ucylmb3IoY29uc3QgZSBpbiB0LmV4dGVuc2lvbnMpbi5leHRlbnNpb25zW2VdPXQuZXh0ZW5zaW9uc1tlXTtpZih2b2lkIDAhPT10LnNoYWRpbmcmJihuLmZsYXRTaGFkaW5nPTE9PT10LnNoYWRpbmcpLHZvaWQgMCE9PXQuc2l6ZSYmKG4uc2l6ZT10LnNpemUpLHZvaWQgMCE9PXQuc2l6ZUF0dGVudWF0aW9uJiYobi5zaXplQXR0ZW51YXRpb249dC5zaXplQXR0ZW51YXRpb24pLHZvaWQgMCE9PXQubWFwJiYobi5tYXA9aSh0Lm1hcCkpLHZvaWQgMCE9PXQubWF0Y2FwJiYobi5tYXRjYXA9aSh0Lm1hdGNhcCkpLHZvaWQgMCE9PXQuYWxwaGFNYXAmJihuLmFscGhhTWFwPWkodC5hbHBoYU1hcCkpLHZvaWQgMCE9PXQuYnVtcE1hcCYmKG4uYnVtcE1hcD1pKHQuYnVtcE1hcCkpLHZvaWQgMCE9PXQuYnVtcFNjYWxlJiYobi5idW1wU2NhbGU9dC5idW1wU2NhbGUpLHZvaWQgMCE9PXQubm9ybWFsTWFwJiYobi5ub3JtYWxNYXA9aSh0Lm5vcm1hbE1hcCkpLHZvaWQgMCE9PXQubm9ybWFsTWFwVHlwZSYmKG4ubm9ybWFsTWFwVHlwZT10Lm5vcm1hbE1hcFR5cGUpLHZvaWQgMCE9PXQubm9ybWFsU2NhbGUpe2xldCBlPXQubm9ybWFsU2NhbGU7ITE9PT1BcnJheS5pc0FycmF5KGUpJiYoZT1bZSxlXSksbi5ub3JtYWxTY2FsZT0obmV3IHJuKS5mcm9tQXJyYXkoZSl9cmV0dXJuIHZvaWQgMCE9PXQuZGlzcGxhY2VtZW50TWFwJiYobi5kaXNwbGFjZW1lbnRNYXA9aSh0LmRpc3BsYWNlbWVudE1hcCkpLHZvaWQgMCE9PXQuZGlzcGxhY2VtZW50U2NhbGUmJihuLmRpc3BsYWNlbWVudFNjYWxlPXQuZGlzcGxhY2VtZW50U2NhbGUpLHZvaWQgMCE9PXQuZGlzcGxhY2VtZW50QmlhcyYmKG4uZGlzcGxhY2VtZW50Qmlhcz10LmRpc3BsYWNlbWVudEJpYXMpLHZvaWQgMCE9PXQucm91Z2huZXNzTWFwJiYobi5yb3VnaG5lc3NNYXA9aSh0LnJvdWdobmVzc01hcCkpLHZvaWQgMCE9PXQubWV0YWxuZXNzTWFwJiYobi5tZXRhbG5lc3NNYXA9aSh0Lm1ldGFsbmVzc01hcCkpLHZvaWQgMCE9PXQuZW1pc3NpdmVNYXAmJihuLmVtaXNzaXZlTWFwPWkodC5lbWlzc2l2ZU1hcCkpLHZvaWQgMCE9PXQuZW1pc3NpdmVJbnRlbnNpdHkmJihuLmVtaXNzaXZlSW50ZW5zaXR5PXQuZW1pc3NpdmVJbnRlbnNpdHkpLHZvaWQgMCE9PXQuc3BlY3VsYXJNYXAmJihuLnNwZWN1bGFyTWFwPWkodC5zcGVjdWxhck1hcCkpLHZvaWQgMCE9PXQuZW52TWFwJiYobi5lbnZNYXA9aSh0LmVudk1hcCkpLHZvaWQgMCE9PXQuZW52TWFwSW50ZW5zaXR5JiYobi5lbnZNYXBJbnRlbnNpdHk9dC5lbnZNYXBJbnRlbnNpdHkpLHZvaWQgMCE9PXQucmVmbGVjdGl2aXR5JiYobi5yZWZsZWN0aXZpdHk9dC5yZWZsZWN0aXZpdHkpLHZvaWQgMCE9PXQucmVmcmFjdGlvblJhdGlvJiYobi5yZWZyYWN0aW9uUmF0aW89dC5yZWZyYWN0aW9uUmF0aW8pLHZvaWQgMCE9PXQubGlnaHRNYXAmJihuLmxpZ2h0TWFwPWkodC5saWdodE1hcCkpLHZvaWQgMCE9PXQubGlnaHRNYXBJbnRlbnNpdHkmJihuLmxpZ2h0TWFwSW50ZW5zaXR5PXQubGlnaHRNYXBJbnRlbnNpdHkpLHZvaWQgMCE9PXQuYW9NYXAmJihuLmFvTWFwPWkodC5hb01hcCkpLHZvaWQgMCE9PXQuYW9NYXBJbnRlbnNpdHkmJihuLmFvTWFwSW50ZW5zaXR5PXQuYW9NYXBJbnRlbnNpdHkpLHZvaWQgMCE9PXQuZ3JhZGllbnRNYXAmJihuLmdyYWRpZW50TWFwPWkodC5ncmFkaWVudE1hcCkpLHZvaWQgMCE9PXQuY2xlYXJjb2F0TWFwJiYobi5jbGVhcmNvYXRNYXA9aSh0LmNsZWFyY29hdE1hcCkpLHZvaWQgMCE9PXQuY2xlYXJjb2F0Um91Z2huZXNzTWFwJiYobi5jbGVhcmNvYXRSb3VnaG5lc3NNYXA9aSh0LmNsZWFyY29hdFJvdWdobmVzc01hcCkpLHZvaWQgMCE9PXQuY2xlYXJjb2F0Tm9ybWFsTWFwJiYobi5jbGVhcmNvYXROb3JtYWxNYXA9aSh0LmNsZWFyY29hdE5vcm1hbE1hcCkpLHZvaWQgMCE9PXQuY2xlYXJjb2F0Tm9ybWFsU2NhbGUmJihuLmNsZWFyY29hdE5vcm1hbFNjYWxlPShuZXcgcm4pLmZyb21BcnJheSh0LmNsZWFyY29hdE5vcm1hbFNjYWxlKSksdm9pZCAwIT09dC50cmFuc21pc3Npb24mJihuLnRyYW5zbWlzc2lvbj10LnRyYW5zbWlzc2lvbiksdm9pZCAwIT09dC50cmFuc21pc3Npb25NYXAmJihuLnRyYW5zbWlzc2lvbk1hcD1pKHQudHJhbnNtaXNzaW9uTWFwKSksbn0sc2V0VGV4dHVyZXM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMudGV4dHVyZXM9dCx0aGlzfX0pO2NvbnN0IG91PWZ1bmN0aW9uKHQpe2NvbnN0IGU9dC5sYXN0SW5kZXhPZihcIi9cIik7cmV0dXJuLTE9PT1lP1wiLi9cIjp0LnN1YnN0cigwLGUrMSl9O2Z1bmN0aW9uIGF1KCl7aHMuY2FsbCh0aGlzKSx0aGlzLnR5cGU9XCJJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeVwiLHRoaXMuaW5zdGFuY2VDb3VudD0xLzB9ZnVuY3Rpb24gY3UodCxlLGksbil7XCJudW1iZXJcIj09dHlwZW9mIGkmJihuPWksaT0hMSxjb25zb2xlLmVycm9yKFwiVEhSRUUuSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlOiBUaGUgY29uc3RydWN0b3Igbm93IGV4cGVjdHMgbm9ybWFsaXplZCBhcyB0aGUgdGhpcmQgYXJndW1lbnQuXCIpKSxIci5jYWxsKHRoaXMsdCxlLGkpLHRoaXMubWVzaFBlckF0dHJpYnV0ZT1ufHwxfWZ1bmN0aW9uIGh1KHQpe3BsLmNhbGwodGhpcyx0KX1mdW5jdGlvbiBsdSh0KXtcInVuZGVmaW5lZFwiPT10eXBlb2YgY3JlYXRlSW1hZ2VCaXRtYXAmJmNvbnNvbGUud2FybihcIlRIUkVFLkltYWdlQml0bWFwTG9hZGVyOiBjcmVhdGVJbWFnZUJpdG1hcCgpIG5vdCBzdXBwb3J0ZWQuXCIpLFwidW5kZWZpbmVkXCI9PXR5cGVvZiBmZXRjaCYmY29uc29sZS53YXJuKFwiVEhSRUUuSW1hZ2VCaXRtYXBMb2FkZXI6IGZldGNoKCkgbm90IHN1cHBvcnRlZC5cIikscGwuY2FsbCh0aGlzLHQpLHRoaXMub3B0aW9ucz17cHJlbXVsdGlwbHlBbHBoYTpcIm5vbmVcIn19ZnVuY3Rpb24gdXUoKXt0aGlzLnR5cGU9XCJTaGFwZVBhdGhcIix0aGlzLmNvbG9yPW5ldyBEcix0aGlzLnN1YlBhdGhzPVtdLHRoaXMuY3VycmVudFBhdGg9bnVsbH1hdS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGhzLnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOmF1LGlzSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnk6ITAsY29weTpmdW5jdGlvbih0KXtyZXR1cm4gaHMucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMuaW5zdGFuY2VDb3VudD10Lmluc3RhbmNlQ291bnQsdGhpc30sY2xvbmU6ZnVuY3Rpb24oKXtyZXR1cm4obmV3IHRoaXMuY29uc3RydWN0b3IpLmNvcHkodGhpcyl9LHRvSlNPTjpmdW5jdGlvbigpe2NvbnN0IHQ9aHMucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMpO3JldHVybiB0Lmluc3RhbmNlQ291bnQ9dGhpcy5pbnN0YW5jZUNvdW50LHQuaXNJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeT0hMCx0fX0pLGN1LnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoSHIucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6Y3UsaXNJbnN0YW5jZWRCdWZmZXJBdHRyaWJ1dGU6ITAsY29weTpmdW5jdGlvbih0KXtyZXR1cm4gSHIucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXMubWVzaFBlckF0dHJpYnV0ZT10Lm1lc2hQZXJBdHRyaWJ1dGUsdGhpc30sdG9KU09OOmZ1bmN0aW9uKCl7Y29uc3QgdD1Ici5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyk7cmV0dXJuIHQubWVzaFBlckF0dHJpYnV0ZT10aGlzLm1lc2hQZXJBdHRyaWJ1dGUsdC5pc0luc3RhbmNlZEJ1ZmZlckF0dHJpYnV0ZT0hMCx0fX0pLGh1LnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6aHUsbG9hZDpmdW5jdGlvbih0LGUsaSxuKXtjb25zdCByPXRoaXMscz1uZXcgbWwoci5tYW5hZ2VyKTtzLnNldFBhdGgoci5wYXRoKSxzLnNldFJlcXVlc3RIZWFkZXIoci5yZXF1ZXN0SGVhZGVyKSxzLnNldFdpdGhDcmVkZW50aWFscyhyLndpdGhDcmVkZW50aWFscykscy5sb2FkKHQsKGZ1bmN0aW9uKGkpe3RyeXtlKHIucGFyc2UoSlNPTi5wYXJzZShpKSkpfWNhdGNoKGUpe24/bihlKTpjb25zb2xlLmVycm9yKGUpLHIubWFuYWdlci5pdGVtRXJyb3IodCl9fSksaSxuKX0scGFyc2U6ZnVuY3Rpb24odCl7Y29uc3QgZT17fSxpPXt9O2Z1bmN0aW9uIG4odCxuKXtpZih2b2lkIDAhPT1lW25dKXJldHVybiBlW25dO2NvbnN0IHI9dC5pbnRlcmxlYXZlZEJ1ZmZlcnNbbl0scz1mdW5jdGlvbih0LGUpe2lmKHZvaWQgMCE9PWlbZV0pcmV0dXJuIGlbZV07Y29uc3Qgbj10LmFycmF5QnVmZmVyc1tlXSxyPW5ldyBVaW50MzJBcnJheShuKS5idWZmZXI7cmV0dXJuIGlbZV09cixyfSh0LHIuYnVmZmVyKSxvPW5ldyB0YyhlcyhyLnR5cGUscyksci5zdHJpZGUpO3JldHVybiBvLnV1aWQ9ci51dWlkLGVbbl09byxvfWNvbnN0IHI9dC5pc0luc3RhbmNlZEJ1ZmZlckdlb21ldHJ5P25ldyBhdTpuZXcgaHMscz10LmRhdGEuaW5kZXg7aWYodm9pZCAwIT09cyl7Y29uc3QgdD1lcyhzLnR5cGUscy5hcnJheSk7ci5zZXRJbmRleChuZXcgSHIodCwxKSl9Y29uc3Qgbz10LmRhdGEuYXR0cmlidXRlcztmb3IoY29uc3QgZSBpbiBvKXtjb25zdCBpPW9bZV07bGV0IHM7aWYoaS5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKXtzPW5ldyBpYyhuKHQuZGF0YSxpLmRhdGEpLGkuaXRlbVNpemUsaS5vZmZzZXQsaS5ub3JtYWxpemVkKX1lbHNle2NvbnN0IHQ9ZXMoaS50eXBlLGkuYXJyYXkpO3M9bmV3KGkuaXNJbnN0YW5jZWRCdWZmZXJBdHRyaWJ1dGU/Y3U6SHIpKHQsaS5pdGVtU2l6ZSxpLm5vcm1hbGl6ZWQpfXZvaWQgMCE9PWkubmFtZSYmKHMubmFtZT1pLm5hbWUpLHIuc2V0QXR0cmlidXRlKGUscyl9Y29uc3QgYT10LmRhdGEubW9ycGhBdHRyaWJ1dGVzO2lmKGEpZm9yKGNvbnN0IGUgaW4gYSl7Y29uc3QgaT1hW2VdLHM9W107Zm9yKGxldCBlPTAscj1pLmxlbmd0aDtlPHI7ZSsrKXtjb25zdCByPWlbZV07bGV0IG87aWYoci5pc0ludGVybGVhdmVkQnVmZmVyQXR0cmlidXRlKXtvPW5ldyBpYyhuKHQuZGF0YSxyLmRhdGEpLHIuaXRlbVNpemUsci5vZmZzZXQsci5ub3JtYWxpemVkKX1lbHNle289bmV3IEhyKGVzKHIudHlwZSxyLmFycmF5KSxyLml0ZW1TaXplLHIubm9ybWFsaXplZCl9dm9pZCAwIT09ci5uYW1lJiYoby5uYW1lPXIubmFtZSkscy5wdXNoKG8pfXIubW9ycGhBdHRyaWJ1dGVzW2VdPXN9dC5kYXRhLm1vcnBoVGFyZ2V0c1JlbGF0aXZlJiYoci5tb3JwaFRhcmdldHNSZWxhdGl2ZT0hMCk7Y29uc3QgYz10LmRhdGEuZ3JvdXBzfHx0LmRhdGEuZHJhd2NhbGxzfHx0LmRhdGEub2Zmc2V0cztpZih2b2lkIDAhPT1jKWZvcihsZXQgdD0wLGU9Yy5sZW5ndGg7dCE9PWU7Kyt0KXtjb25zdCBlPWNbdF07ci5hZGRHcm91cChlLnN0YXJ0LGUuY291bnQsZS5tYXRlcmlhbEluZGV4KX1jb25zdCBoPXQuZGF0YS5ib3VuZGluZ1NwaGVyZTtpZih2b2lkIDAhPT1oKXtjb25zdCB0PW5ldyBmbjt2b2lkIDAhPT1oLmNlbnRlciYmdC5mcm9tQXJyYXkoaC5jZW50ZXIpLHIuYm91bmRpbmdTcGhlcmU9bmV3IE9uKHQsaC5yYWRpdXMpfXJldHVybiB0Lm5hbWUmJihyLm5hbWU9dC5uYW1lKSx0LnVzZXJEYXRhJiYoci51c2VyRGF0YT10LnVzZXJEYXRhKSxyfX0pLGx1LnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6bHUsaXNJbWFnZUJpdG1hcExvYWRlcjohMCxzZXRPcHRpb25zOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnM9dCx0aGlzfSxsb2FkOmZ1bmN0aW9uKHQsZSxpLG4pe3ZvaWQgMD09PXQmJih0PVwiXCIpLHZvaWQgMCE9PXRoaXMucGF0aCYmKHQ9dGhpcy5wYXRoK3QpLHQ9dGhpcy5tYW5hZ2VyLnJlc29sdmVVUkwodCk7Y29uc3Qgcj10aGlzLHM9dWwuZ2V0KHQpO2lmKHZvaWQgMCE9PXMpcmV0dXJuIHIubWFuYWdlci5pdGVtU3RhcnQodCksc2V0VGltZW91dCgoZnVuY3Rpb24oKXtlJiZlKHMpLHIubWFuYWdlci5pdGVtRW5kKHQpfSksMCkscztjb25zdCBvPXt9O28uY3JlZGVudGlhbHM9XCJhbm9ueW1vdXNcIj09PXRoaXMuY3Jvc3NPcmlnaW4/XCJzYW1lLW9yaWdpblwiOlwiaW5jbHVkZVwiLGZldGNoKHQsbykudGhlbigoZnVuY3Rpb24odCl7cmV0dXJuIHQuYmxvYigpfSkpLnRoZW4oKGZ1bmN0aW9uKHQpe3JldHVybiBjcmVhdGVJbWFnZUJpdG1hcCh0LHIub3B0aW9ucyl9KSkudGhlbigoZnVuY3Rpb24oaSl7dWwuYWRkKHQsaSksZSYmZShpKSxyLm1hbmFnZXIuaXRlbUVuZCh0KX0pKS5jYXRjaCgoZnVuY3Rpb24oZSl7biYmbihlKSxyLm1hbmFnZXIuaXRlbUVycm9yKHQpLHIubWFuYWdlci5pdGVtRW5kKHQpfSkpLHIubWFuYWdlci5pdGVtU3RhcnQodCl9fSksT2JqZWN0LmFzc2lnbih1dS5wcm90b3R5cGUse21vdmVUbzpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmN1cnJlbnRQYXRoPW5ldyBVbCx0aGlzLnN1YlBhdGhzLnB1c2godGhpcy5jdXJyZW50UGF0aCksdGhpcy5jdXJyZW50UGF0aC5tb3ZlVG8odCxlKSx0aGlzfSxsaW5lVG86ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jdXJyZW50UGF0aC5saW5lVG8odCxlKSx0aGlzfSxxdWFkcmF0aWNDdXJ2ZVRvOmZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiB0aGlzLmN1cnJlbnRQYXRoLnF1YWRyYXRpY0N1cnZlVG8odCxlLGksbiksdGhpc30sYmV6aWVyQ3VydmVUbzpmdW5jdGlvbih0LGUsaSxuLHIscyl7cmV0dXJuIHRoaXMuY3VycmVudFBhdGguYmV6aWVyQ3VydmVUbyh0LGUsaSxuLHIscyksdGhpc30sc3BsaW5lVGhydTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jdXJyZW50UGF0aC5zcGxpbmVUaHJ1KHQpLHRoaXN9LHRvU2hhcGVzOmZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0KXtjb25zdCBlPVtdO2ZvcihsZXQgaT0wLG49dC5sZW5ndGg7aTxuO2krKyl7Y29uc3Qgbj10W2ldLHI9bmV3IFZsO3IuY3VydmVzPW4uY3VydmVzLGUucHVzaChyKX1yZXR1cm4gZX1mdW5jdGlvbiBuKHQsZSl7Y29uc3QgaT1lLmxlbmd0aDtsZXQgbj0hMTtmb3IobGV0IHI9aS0xLHM9MDtzPGk7cj1zKyspe2xldCBpPWVbcl0sbz1lW3NdLGE9by54LWkueCxjPW8ueS1pLnk7aWYoTWF0aC5hYnMoYyk+TnVtYmVyLkVQU0lMT04pe2lmKGM8MCYmKGk9ZVtzXSxhPS1hLG89ZVtyXSxjPS1jKSx0Lnk8aS55fHx0Lnk+by55KWNvbnRpbnVlO2lmKHQueT09PWkueSl7aWYodC54PT09aS54KXJldHVybiEwfWVsc2V7Y29uc3QgZT1jKih0LngtaS54KS1hKih0LnktaS55KTtpZigwPT09ZSlyZXR1cm4hMDtpZihlPDApY29udGludWU7bj0hbn19ZWxzZXtpZih0LnkhPT1pLnkpY29udGludWU7aWYoby54PD10LngmJnQueDw9aS54fHxpLng8PXQueCYmdC54PD1vLngpcmV0dXJuITB9fXJldHVybiBufWNvbnN0IHI9UmguaXNDbG9ja1dpc2Uscz10aGlzLnN1YlBhdGhzO2lmKDA9PT1zLmxlbmd0aClyZXR1cm5bXTtpZighMD09PWUpcmV0dXJuIGkocyk7bGV0IG8sYSxjO2NvbnN0IGg9W107aWYoMT09PXMubGVuZ3RoKXJldHVybiBhPXNbMF0sYz1uZXcgVmwsYy5jdXJ2ZXM9YS5jdXJ2ZXMsaC5wdXNoKGMpLGg7bGV0IGw9IXIoc1swXS5nZXRQb2ludHMoKSk7bD10PyFsOmw7Y29uc3QgdT1bXSxkPVtdO2xldCBwLGYsbT1bXSxnPTA7ZFtnXT12b2lkIDAsbVtnXT1bXTtmb3IobGV0IGU9MCxpPXMubGVuZ3RoO2U8aTtlKyspYT1zW2VdLHA9YS5nZXRQb2ludHMoKSxvPXIocCksbz10PyFvOm8sbz8oIWwmJmRbZ10mJmcrKyxkW2ddPXtzOm5ldyBWbCxwOnB9LGRbZ10ucy5jdXJ2ZXM9YS5jdXJ2ZXMsbCYmZysrLG1bZ109W10pOm1bZ10ucHVzaCh7aDphLHA6cFswXX0pO2lmKCFkWzBdKXJldHVybiBpKHMpO2lmKGQubGVuZ3RoPjEpe2xldCB0PSExO2NvbnN0IGU9W107Zm9yKGxldCB0PTAsZT1kLmxlbmd0aDt0PGU7dCsrKXVbdF09W107Zm9yKGxldCBpPTAscj1kLmxlbmd0aDtpPHI7aSsrKXtjb25zdCByPW1baV07Zm9yKGxldCBzPTA7czxyLmxlbmd0aDtzKyspe2NvbnN0IG89cltzXTtsZXQgYT0hMDtmb3IobGV0IHI9MDtyPGQubGVuZ3RoO3IrKyluKG8ucCxkW3JdLnApJiYoaSE9PXImJmUucHVzaCh7ZnJvbXM6aSx0b3M6cixob2xlOnN9KSxhPyhhPSExLHVbcl0ucHVzaChvKSk6dD0hMCk7YSYmdVtpXS5wdXNoKG8pfX1lLmxlbmd0aD4wJiYodHx8KG09dSkpfWZvcihsZXQgdD0wLGU9ZC5sZW5ndGg7dDxlO3QrKyl7Yz1kW3RdLnMsaC5wdXNoKGMpLGY9bVt0XTtmb3IobGV0IHQ9MCxlPWYubGVuZ3RoO3Q8ZTt0KyspYy5ob2xlcy5wdXNoKGZbdF0uaCl9cmV0dXJuIGh9fSk7Y2xhc3MgZHV7Y29uc3RydWN0b3IodCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJpc0ZvbnRcIix7dmFsdWU6ITB9KSx0aGlzLnR5cGU9XCJGb250XCIsdGhpcy5kYXRhPXR9Z2VuZXJhdGVTaGFwZXModCxlPTEwMCl7Y29uc3QgaT1bXSxuPWZ1bmN0aW9uKHQsZSxpKXtjb25zdCBuPUFycmF5LmZyb20/QXJyYXkuZnJvbSh0KTpTdHJpbmcodCkuc3BsaXQoXCJcIikscj1lL2kucmVzb2x1dGlvbixzPShpLmJvdW5kaW5nQm94LnlNYXgtaS5ib3VuZGluZ0JveC55TWluK2kudW5kZXJsaW5lVGhpY2tuZXNzKSpyLG89W107bGV0IGE9MCxjPTA7Zm9yKGxldCB0PTA7dDxuLmxlbmd0aDt0Kyspe2NvbnN0IGU9blt0XTtpZihcIlxcblwiPT09ZSlhPTAsYy09cztlbHNle2NvbnN0IHQ9cHUoZSxyLGEsYyxpKTthKz10Lm9mZnNldFgsby5wdXNoKHQucGF0aCl9fXJldHVybiBvfSh0LGUsdGhpcy5kYXRhKTtmb3IobGV0IHQ9MCxlPW4ubGVuZ3RoO3Q8ZTt0KyspQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoaSxuW3RdLnRvU2hhcGVzKCkpO3JldHVybiBpfX1mdW5jdGlvbiBwdSh0LGUsaSxuLHIpe2NvbnN0IHM9ci5nbHlwaHNbdF18fHIuZ2x5cGhzW1wiP1wiXTtpZighcylyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKCdUSFJFRS5Gb250OiBjaGFyYWN0ZXIgXCInK3QrJ1wiIGRvZXMgbm90IGV4aXN0cyBpbiBmb250IGZhbWlseSAnK3IuZmFtaWx5TmFtZStcIi5cIik7Y29uc3Qgbz1uZXcgdXU7bGV0IGEsYyxoLGwsdSxkLHAsZjtpZihzLm8pe2NvbnN0IHQ9cy5fY2FjaGVkT3V0bGluZXx8KHMuX2NhY2hlZE91dGxpbmU9cy5vLnNwbGl0KFwiIFwiKSk7Zm9yKGxldCByPTAscz10Lmxlbmd0aDtyPHM7KXtzd2l0Y2godFtyKytdKXtjYXNlXCJtXCI6YT10W3IrK10qZStpLGM9dFtyKytdKmUrbixvLm1vdmVUbyhhLGMpO2JyZWFrO2Nhc2VcImxcIjphPXRbcisrXSplK2ksYz10W3IrK10qZStuLG8ubGluZVRvKGEsYyk7YnJlYWs7Y2FzZVwicVwiOmg9dFtyKytdKmUraSxsPXRbcisrXSplK24sdT10W3IrK10qZStpLGQ9dFtyKytdKmUrbixvLnF1YWRyYXRpY0N1cnZlVG8odSxkLGgsbCk7YnJlYWs7Y2FzZVwiYlwiOmg9dFtyKytdKmUraSxsPXRbcisrXSplK24sdT10W3IrK10qZStpLGQ9dFtyKytdKmUrbixwPXRbcisrXSplK2ksZj10W3IrK10qZStuLG8uYmV6aWVyQ3VydmVUbyh1LGQscCxmLGgsbCl9fX1yZXR1cm57b2Zmc2V0WDpzLmhhKmUscGF0aDpvfX1mdW5jdGlvbiBmdSh0KXtwbC5jYWxsKHRoaXMsdCl9bGV0IG11O2Z1LnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocGwucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6ZnUsbG9hZDpmdW5jdGlvbih0LGUsaSxuKXtjb25zdCByPXRoaXMscz1uZXcgbWwodGhpcy5tYW5hZ2VyKTtzLnNldFBhdGgodGhpcy5wYXRoKSxzLnNldFJlcXVlc3RIZWFkZXIodGhpcy5yZXF1ZXN0SGVhZGVyKSxzLnNldFdpdGhDcmVkZW50aWFscyhyLndpdGhDcmVkZW50aWFscykscy5sb2FkKHQsKGZ1bmN0aW9uKHQpe2xldCBpO3RyeXtpPUpTT04ucGFyc2UodCl9Y2F0Y2goZSl7Y29uc29sZS53YXJuKFwiVEhSRUUuRm9udExvYWRlcjogdHlwZWZhY2UuanMgc3VwcG9ydCBpcyBiZWluZyBkZXByZWNhdGVkLiBVc2UgdHlwZWZhY2UuanNvbiBpbnN0ZWFkLlwiKSxpPUpTT04ucGFyc2UodC5zdWJzdHJpbmcoNjUsdC5sZW5ndGgtMikpfWNvbnN0IG49ci5wYXJzZShpKTtlJiZlKG4pfSksaSxuKX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBkdSh0KX19KTtjb25zdCBndT1mdW5jdGlvbigpe3JldHVybiB2b2lkIDA9PT1tdSYmKG11PW5ldyh3aW5kb3cuQXVkaW9Db250ZXh0fHx3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSksbXV9O2Z1bmN0aW9uIF91KHQpe3BsLmNhbGwodGhpcyx0KX1mdW5jdGlvbiB2dSh0LGUsaSl7cnUuY2FsbCh0aGlzLHZvaWQgMCxpKTtjb25zdCBuPShuZXcgRHIpLnNldCh0KSxyPShuZXcgRHIpLnNldChlKSxzPW5ldyBmbihuLnIsbi5nLG4uYiksbz1uZXcgZm4oci5yLHIuZyxyLmIpLGE9TWF0aC5zcXJ0KE1hdGguUEkpLGM9YSpNYXRoLnNxcnQoLjc1KTt0aGlzLnNoLmNvZWZmaWNpZW50c1swXS5jb3B5KHMpLmFkZChvKS5tdWx0aXBseVNjYWxhcihhKSx0aGlzLnNoLmNvZWZmaWNpZW50c1sxXS5jb3B5KHMpLnN1YihvKS5tdWx0aXBseVNjYWxhcihjKX1mdW5jdGlvbiB5dSh0LGUpe3J1LmNhbGwodGhpcyx2b2lkIDAsZSk7Y29uc3QgaT0obmV3IERyKS5zZXQodCk7dGhpcy5zaC5jb2VmZmljaWVudHNbMF0uc2V0KGkucixpLmcsaS5iKS5tdWx0aXBseVNjYWxhcigyKk1hdGguc3FydChNYXRoLlBJKSl9X3UucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShwbC5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjpfdSxsb2FkOmZ1bmN0aW9uKHQsZSxpLG4pe2NvbnN0IHI9dGhpcyxzPW5ldyBtbChyLm1hbmFnZXIpO3Muc2V0UmVzcG9uc2VUeXBlKFwiYXJyYXlidWZmZXJcIikscy5zZXRQYXRoKHIucGF0aCkscy5zZXRSZXF1ZXN0SGVhZGVyKHIucmVxdWVzdEhlYWRlcikscy5zZXRXaXRoQ3JlZGVudGlhbHMoci53aXRoQ3JlZGVudGlhbHMpLHMubG9hZCh0LChmdW5jdGlvbihpKXt0cnl7Y29uc3QgdD1pLnNsaWNlKDApO2d1KCkuZGVjb2RlQXVkaW9EYXRhKHQsKGZ1bmN0aW9uKHQpe2UodCl9KSl9Y2F0Y2goZSl7bj9uKGUpOmNvbnNvbGUuZXJyb3IoZSksci5tYW5hZ2VyLml0ZW1FcnJvcih0KX19KSxpLG4pfX0pLHZ1LnByb3RvdHlwZT1PYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUocnUucHJvdG90eXBlKSx7Y29uc3RydWN0b3I6dnUsaXNIZW1pc3BoZXJlTGlnaHRQcm9iZTohMCxjb3B5OmZ1bmN0aW9uKHQpe3JldHVybiBydS5wcm90b3R5cGUuY29weS5jYWxsKHRoaXMsdCksdGhpc30sdG9KU09OOmZ1bmN0aW9uKHQpe3JldHVybiBydS5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyx0KX19KSx5dS5wcm90b3R5cGU9T2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKHJ1LnByb3RvdHlwZSkse2NvbnN0cnVjdG9yOnl1LGlzQW1iaWVudExpZ2h0UHJvYmU6ITAsY29weTpmdW5jdGlvbih0KXtyZXR1cm4gcnUucHJvdG90eXBlLmNvcHkuY2FsbCh0aGlzLHQpLHRoaXN9LHRvSlNPTjpmdW5jdGlvbih0KXtyZXR1cm4gcnUucHJvdG90eXBlLnRvSlNPTi5jYWxsKHRoaXMsdCl9fSk7Y29uc3QgYnU9bmV3IEhuLHh1PW5ldyBIbjtPYmplY3QuYXNzaWduKGZ1bmN0aW9uKCl7dGhpcy50eXBlPVwiU3RlcmVvQ2FtZXJhXCIsdGhpcy5hc3BlY3Q9MSx0aGlzLmV5ZVNlcD0uMDY0LHRoaXMuY2FtZXJhTD1uZXcgRHMsdGhpcy5jYW1lcmFMLmxheWVycy5lbmFibGUoMSksdGhpcy5jYW1lcmFMLm1hdHJpeEF1dG9VcGRhdGU9ITEsdGhpcy5jYW1lcmFSPW5ldyBEcyx0aGlzLmNhbWVyYVIubGF5ZXJzLmVuYWJsZSgyKSx0aGlzLmNhbWVyYVIubWF0cml4QXV0b1VwZGF0ZT0hMSx0aGlzLl9jYWNoZT17Zm9jdXM6bnVsbCxmb3Y6bnVsbCxhc3BlY3Q6bnVsbCxuZWFyOm51bGwsZmFyOm51bGwsem9vbTpudWxsLGV5ZVNlcDpudWxsfX0ucHJvdG90eXBlLHt1cGRhdGU6ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLl9jYWNoZTtpZihlLmZvY3VzIT09dC5mb2N1c3x8ZS5mb3YhPT10LmZvdnx8ZS5hc3BlY3QhPT10LmFzcGVjdCp0aGlzLmFzcGVjdHx8ZS5uZWFyIT09dC5uZWFyfHxlLmZhciE9PXQuZmFyfHxlLnpvb20hPT10Lnpvb218fGUuZXllU2VwIT09dGhpcy5leWVTZXApe2UuZm9jdXM9dC5mb2N1cyxlLmZvdj10LmZvdixlLmFzcGVjdD10LmFzcGVjdCp0aGlzLmFzcGVjdCxlLm5lYXI9dC5uZWFyLGUuZmFyPXQuZmFyLGUuem9vbT10Lnpvb20sZS5leWVTZXA9dGhpcy5leWVTZXA7Y29uc3QgaT10LnByb2plY3Rpb25NYXRyaXguY2xvbmUoKSxuPWUuZXllU2VwLzIscj1uKmUubmVhci9lLmZvY3VzLHM9ZS5uZWFyKk1hdGgudGFuKG5uLkRFRzJSQUQqZS5mb3YqLjUpL2Uuem9vbTtsZXQgbyxhO3h1LmVsZW1lbnRzWzEyXT0tbixidS5lbGVtZW50c1sxMl09bixvPS1zKmUuYXNwZWN0K3IsYT1zKmUuYXNwZWN0K3IsaS5lbGVtZW50c1swXT0yKmUubmVhci8oYS1vKSxpLmVsZW1lbnRzWzhdPShhK28pLyhhLW8pLHRoaXMuY2FtZXJhTC5wcm9qZWN0aW9uTWF0cml4LmNvcHkoaSksbz0tcyplLmFzcGVjdC1yLGE9cyplLmFzcGVjdC1yLGkuZWxlbWVudHNbMF09MiplLm5lYXIvKGEtbyksaS5lbGVtZW50c1s4XT0oYStvKS8oYS1vKSx0aGlzLmNhbWVyYVIucHJvamVjdGlvbk1hdHJpeC5jb3B5KGkpfXRoaXMuY2FtZXJhTC5tYXRyaXhXb3JsZC5jb3B5KHQubWF0cml4V29ybGQpLm11bHRpcGx5KHh1KSx0aGlzLmNhbWVyYVIubWF0cml4V29ybGQuY29weSh0Lm1hdHJpeFdvcmxkKS5tdWx0aXBseShidSl9fSk7ZnVuY3Rpb24gd3UodCxlLGkpe2xldCBuLHIscztzd2l0Y2godGhpcy5iaW5kaW5nPXQsdGhpcy52YWx1ZVNpemU9aSxlKXtjYXNlXCJxdWF0ZXJuaW9uXCI6bj10aGlzLl9zbGVycCxyPXRoaXMuX3NsZXJwQWRkaXRpdmUscz10aGlzLl9zZXRBZGRpdGl2ZUlkZW50aXR5UXVhdGVybmlvbix0aGlzLmJ1ZmZlcj1uZXcgRmxvYXQ2NEFycmF5KDYqaSksdGhpcy5fd29ya0luZGV4PTU7YnJlYWs7Y2FzZVwic3RyaW5nXCI6Y2FzZVwiYm9vbFwiOm49dGhpcy5fc2VsZWN0LHI9dGhpcy5fc2VsZWN0LHM9dGhpcy5fc2V0QWRkaXRpdmVJZGVudGl0eU90aGVyLHRoaXMuYnVmZmVyPW5ldyBBcnJheSg1KmkpO2JyZWFrO2RlZmF1bHQ6bj10aGlzLl9sZXJwLHI9dGhpcy5fbGVycEFkZGl0aXZlLHM9dGhpcy5fc2V0QWRkaXRpdmVJZGVudGl0eU51bWVyaWMsdGhpcy5idWZmZXI9bmV3IEZsb2F0NjRBcnJheSg1KmkpfXRoaXMuX21peEJ1ZmZlclJlZ2lvbj1uLHRoaXMuX21peEJ1ZmZlclJlZ2lvbkFkZGl0aXZlPXIsdGhpcy5fc2V0SWRlbnRpdHk9cyx0aGlzLl9vcmlnSW5kZXg9Myx0aGlzLl9hZGRJbmRleD00LHRoaXMuY3VtdWxhdGl2ZVdlaWdodD0wLHRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlPTAsdGhpcy51c2VDb3VudD0wLHRoaXMucmVmZXJlbmNlQ291bnQ9MH1PYmplY3QuYXNzaWduKHd1LnByb3RvdHlwZSx7YWNjdW11bGF0ZTpmdW5jdGlvbih0LGUpe2NvbnN0IGk9dGhpcy5idWZmZXIsbj10aGlzLnZhbHVlU2l6ZSxyPXQqbituO2xldCBzPXRoaXMuY3VtdWxhdGl2ZVdlaWdodDtpZigwPT09cyl7Zm9yKGxldCB0PTA7dCE9PW47Kyt0KWlbcit0XT1pW3RdO3M9ZX1lbHNle3MrPWU7Y29uc3QgdD1lL3M7dGhpcy5fbWl4QnVmZmVyUmVnaW9uKGksciwwLHQsbil9dGhpcy5jdW11bGF0aXZlV2VpZ2h0PXN9LGFjY3VtdWxhdGVBZGRpdGl2ZTpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMuYnVmZmVyLGk9dGhpcy52YWx1ZVNpemUsbj1pKnRoaXMuX2FkZEluZGV4OzA9PT10aGlzLmN1bXVsYXRpdmVXZWlnaHRBZGRpdGl2ZSYmdGhpcy5fc2V0SWRlbnRpdHkoKSx0aGlzLl9taXhCdWZmZXJSZWdpb25BZGRpdGl2ZShlLG4sMCx0LGkpLHRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlKz10fSxhcHBseTpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMudmFsdWVTaXplLGk9dGhpcy5idWZmZXIsbj10KmUrZSxyPXRoaXMuY3VtdWxhdGl2ZVdlaWdodCxzPXRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlLG89dGhpcy5iaW5kaW5nO2lmKHRoaXMuY3VtdWxhdGl2ZVdlaWdodD0wLHRoaXMuY3VtdWxhdGl2ZVdlaWdodEFkZGl0aXZlPTAscjwxKXtjb25zdCB0PWUqdGhpcy5fb3JpZ0luZGV4O3RoaXMuX21peEJ1ZmZlclJlZ2lvbihpLG4sdCwxLXIsZSl9cz4wJiZ0aGlzLl9taXhCdWZmZXJSZWdpb25BZGRpdGl2ZShpLG4sdGhpcy5fYWRkSW5kZXgqZSwxLGUpO2ZvcihsZXQgdD1lLHI9ZStlO3QhPT1yOysrdClpZihpW3RdIT09aVt0K2VdKXtvLnNldFZhbHVlKGksbik7YnJlYWt9fSxzYXZlT3JpZ2luYWxTdGF0ZTpmdW5jdGlvbigpe2NvbnN0IHQ9dGhpcy5iaW5kaW5nLGU9dGhpcy5idWZmZXIsaT10aGlzLnZhbHVlU2l6ZSxuPWkqdGhpcy5fb3JpZ0luZGV4O3QuZ2V0VmFsdWUoZSxuKTtmb3IobGV0IHQ9aSxyPW47dCE9PXI7Kyt0KWVbdF09ZVtuK3QlaV07dGhpcy5fc2V0SWRlbnRpdHkoKSx0aGlzLmN1bXVsYXRpdmVXZWlnaHQ9MCx0aGlzLmN1bXVsYXRpdmVXZWlnaHRBZGRpdGl2ZT0wfSxyZXN0b3JlT3JpZ2luYWxTdGF0ZTpmdW5jdGlvbigpe2NvbnN0IHQ9Myp0aGlzLnZhbHVlU2l6ZTt0aGlzLmJpbmRpbmcuc2V0VmFsdWUodGhpcy5idWZmZXIsdCl9LF9zZXRBZGRpdGl2ZUlkZW50aXR5TnVtZXJpYzpmdW5jdGlvbigpe2NvbnN0IHQ9dGhpcy5fYWRkSW5kZXgqdGhpcy52YWx1ZVNpemUsZT10K3RoaXMudmFsdWVTaXplO2ZvcihsZXQgaT10O2k8ZTtpKyspdGhpcy5idWZmZXJbaV09MH0sX3NldEFkZGl0aXZlSWRlbnRpdHlRdWF0ZXJuaW9uOmZ1bmN0aW9uKCl7dGhpcy5fc2V0QWRkaXRpdmVJZGVudGl0eU51bWVyaWMoKSx0aGlzLmJ1ZmZlclt0aGlzLl9hZGRJbmRleCp0aGlzLnZhbHVlU2l6ZSszXT0xfSxfc2V0QWRkaXRpdmVJZGVudGl0eU90aGVyOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLl9vcmlnSW5kZXgqdGhpcy52YWx1ZVNpemUsZT10aGlzLl9hZGRJbmRleCp0aGlzLnZhbHVlU2l6ZTtmb3IobGV0IGk9MDtpPHRoaXMudmFsdWVTaXplO2krKyl0aGlzLmJ1ZmZlcltlK2ldPXRoaXMuYnVmZmVyW3QraV19LF9zZWxlY3Q6ZnVuY3Rpb24odCxlLGksbixyKXtpZihuPj0uNSlmb3IobGV0IG49MDtuIT09cjsrK24pdFtlK25dPXRbaStuXX0sX3NsZXJwOmZ1bmN0aW9uKHQsZSxpLG4pe3BuLnNsZXJwRmxhdCh0LGUsdCxlLHQsaSxuKX0sX3NsZXJwQWRkaXRpdmU6ZnVuY3Rpb24odCxlLGksbixyKXtjb25zdCBzPXRoaXMuX3dvcmtJbmRleCpyO3BuLm11bHRpcGx5UXVhdGVybmlvbnNGbGF0KHQscyx0LGUsdCxpKSxwbi5zbGVycEZsYXQodCxlLHQsZSx0LHMsbil9LF9sZXJwOmZ1bmN0aW9uKHQsZSxpLG4scil7Y29uc3Qgcz0xLW47Zm9yKGxldCBvPTA7byE9PXI7KytvKXtjb25zdCByPWUrbzt0W3JdPXRbcl0qcyt0W2krb10qbn19LF9sZXJwQWRkaXRpdmU6ZnVuY3Rpb24odCxlLGksbixyKXtmb3IobGV0IHM9MDtzIT09cjsrK3Mpe2NvbnN0IHI9ZStzO3Rbcl09dFtyXSt0W2krc10qbn19fSk7Y29uc3QgU3U9XCJcXFxcW1xcXFxdXFxcXC46XFxcXC9cIixNdT1uZXcgUmVnRXhwKFwiW1xcXFxbXFxcXF1cXFxcLjpcXFxcL11cIixcImdcIiksVHU9XCJbXlxcXFxbXFxcXF1cXFxcLjpcXFxcL11cIixDdT1cIlteXCIrU3UucmVwbGFjZShcIlxcXFwuXCIsXCJcIikrXCJdXCIsRXU9LygoPzpXQytbXFwvOl0pKikvLnNvdXJjZS5yZXBsYWNlKFwiV0NcIixUdSksSXU9LyhXQ09EKyk/Ly5zb3VyY2UucmVwbGFjZShcIldDT0RcIixDdSksQXU9Lyg/OlxcLihXQyspKD86XFxbKC4rKVxcXSk/KT8vLnNvdXJjZS5yZXBsYWNlKFwiV0NcIixUdSksUHU9L1xcLihXQyspKD86XFxbKC4rKVxcXSk/Ly5zb3VyY2UucmVwbGFjZShcIldDXCIsVHUpLFJ1PW5ldyBSZWdFeHAoXCJeXCIrRXUrSXUrQXUrUHUrXCIkXCIpLEx1PVtcIm1hdGVyaWFsXCIsXCJtYXRlcmlhbHNcIixcImJvbmVzXCJdO2Z1bmN0aW9uIE91KHQsZSxpKXtjb25zdCBuPWl8fE51LnBhcnNlVHJhY2tOYW1lKGUpO3RoaXMuX3RhcmdldEdyb3VwPXQsdGhpcy5fYmluZGluZ3M9dC5zdWJzY3JpYmVfKGUsbil9ZnVuY3Rpb24gTnUodCxlLGkpe3RoaXMucGF0aD1lLHRoaXMucGFyc2VkUGF0aD1pfHxOdS5wYXJzZVRyYWNrTmFtZShlKSx0aGlzLm5vZGU9TnUuZmluZE5vZGUodCx0aGlzLnBhcnNlZFBhdGgubm9kZU5hbWUpfHx0LHRoaXMucm9vdE5vZGU9dH1PYmplY3QuYXNzaWduKE91LnByb3RvdHlwZSx7Z2V0VmFsdWU6ZnVuY3Rpb24odCxlKXt0aGlzLmJpbmQoKTtjb25zdCBpPXRoaXMuX3RhcmdldEdyb3VwLm5DYWNoZWRPYmplY3RzXyxuPXRoaXMuX2JpbmRpbmdzW2ldO3ZvaWQgMCE9PW4mJm4uZ2V0VmFsdWUodCxlKX0sc2V0VmFsdWU6ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMuX2JpbmRpbmdzO2ZvcihsZXQgbj10aGlzLl90YXJnZXRHcm91cC5uQ2FjaGVkT2JqZWN0c18scj1pLmxlbmd0aDtuIT09cjsrK24paVtuXS5zZXRWYWx1ZSh0LGUpfSxiaW5kOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLl9iaW5kaW5ncztmb3IobGV0IGU9dGhpcy5fdGFyZ2V0R3JvdXAubkNhY2hlZE9iamVjdHNfLGk9dC5sZW5ndGg7ZSE9PWk7KytlKXRbZV0uYmluZCgpfSx1bmJpbmQ6ZnVuY3Rpb24oKXtjb25zdCB0PXRoaXMuX2JpbmRpbmdzO2ZvcihsZXQgZT10aGlzLl90YXJnZXRHcm91cC5uQ2FjaGVkT2JqZWN0c18saT10Lmxlbmd0aDtlIT09aTsrK2UpdFtlXS51bmJpbmQoKX19KSxPYmplY3QuYXNzaWduKE51LHtDb21wb3NpdGU6T3UsY3JlYXRlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdCYmdC5pc0FuaW1hdGlvbk9iamVjdEdyb3VwP25ldyBOdS5Db21wb3NpdGUodCxlLGkpOm5ldyBOdSh0LGUsaSl9LHNhbml0aXplTm9kZU5hbWU6ZnVuY3Rpb24odCl7cmV0dXJuIHQucmVwbGFjZSgvXFxzL2csXCJfXCIpLnJlcGxhY2UoTXUsXCJcIil9LHBhcnNlVHJhY2tOYW1lOmZ1bmN0aW9uKHQpe2NvbnN0IGU9UnUuZXhlYyh0KTtpZighZSl0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eUJpbmRpbmc6IENhbm5vdCBwYXJzZSB0cmFja05hbWU6IFwiK3QpO2NvbnN0IGk9e25vZGVOYW1lOmVbMl0sb2JqZWN0TmFtZTplWzNdLG9iamVjdEluZGV4OmVbNF0scHJvcGVydHlOYW1lOmVbNV0scHJvcGVydHlJbmRleDplWzZdfSxuPWkubm9kZU5hbWUmJmkubm9kZU5hbWUubGFzdEluZGV4T2YoXCIuXCIpO2lmKHZvaWQgMCE9PW4mJi0xIT09bil7Y29uc3QgdD1pLm5vZGVOYW1lLnN1YnN0cmluZyhuKzEpOy0xIT09THUuaW5kZXhPZih0KSYmKGkubm9kZU5hbWU9aS5ub2RlTmFtZS5zdWJzdHJpbmcoMCxuKSxpLm9iamVjdE5hbWU9dCl9aWYobnVsbD09PWkucHJvcGVydHlOYW1lfHwwPT09aS5wcm9wZXJ0eU5hbWUubGVuZ3RoKXRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5QmluZGluZzogY2FuIG5vdCBwYXJzZSBwcm9wZXJ0eU5hbWUgZnJvbSB0cmFja05hbWU6IFwiK3QpO3JldHVybiBpfSxmaW5kTm9kZTpmdW5jdGlvbih0LGUpe2lmKCFlfHxcIlwiPT09ZXx8XCIuXCI9PT1lfHwtMT09PWV8fGU9PT10Lm5hbWV8fGU9PT10LnV1aWQpcmV0dXJuIHQ7aWYodC5za2VsZXRvbil7Y29uc3QgaT10LnNrZWxldG9uLmdldEJvbmVCeU5hbWUoZSk7aWYodm9pZCAwIT09aSlyZXR1cm4gaX1pZih0LmNoaWxkcmVuKXtjb25zdCBpPWZ1bmN0aW9uKHQpe2ZvcihsZXQgbj0wO248dC5sZW5ndGg7bisrKXtjb25zdCByPXRbbl07aWYoci5uYW1lPT09ZXx8ci51dWlkPT09ZSlyZXR1cm4gcjtjb25zdCBzPWkoci5jaGlsZHJlbik7aWYocylyZXR1cm4gc31yZXR1cm4gbnVsbH0sbj1pKHQuY2hpbGRyZW4pO2lmKG4pcmV0dXJuIG59cmV0dXJuIG51bGx9fSksT2JqZWN0LmFzc2lnbihOdS5wcm90b3R5cGUse19nZXRWYWx1ZV91bmF2YWlsYWJsZTpmdW5jdGlvbigpe30sX3NldFZhbHVlX3VuYXZhaWxhYmxlOmZ1bmN0aW9uKCl7fSxCaW5kaW5nVHlwZTp7RGlyZWN0OjAsRW50aXJlQXJyYXk6MSxBcnJheUVsZW1lbnQ6MixIYXNGcm9tVG9BcnJheTozfSxWZXJzaW9uaW5nOntOb25lOjAsTmVlZHNVcGRhdGU6MSxNYXRyaXhXb3JsZE5lZWRzVXBkYXRlOjJ9LEdldHRlckJ5QmluZGluZ1R5cGU6W2Z1bmN0aW9uKHQsZSl7dFtlXT10aGlzLm5vZGVbdGhpcy5wcm9wZXJ0eU5hbWVdfSxmdW5jdGlvbih0LGUpe2NvbnN0IGk9dGhpcy5yZXNvbHZlZFByb3BlcnR5O2ZvcihsZXQgbj0wLHI9aS5sZW5ndGg7biE9PXI7KytuKXRbZSsrXT1pW25dfSxmdW5jdGlvbih0LGUpe3RbZV09dGhpcy5yZXNvbHZlZFByb3BlcnR5W3RoaXMucHJvcGVydHlJbmRleF19LGZ1bmN0aW9uKHQsZSl7dGhpcy5yZXNvbHZlZFByb3BlcnR5LnRvQXJyYXkodCxlKX1dLFNldHRlckJ5QmluZGluZ1R5cGVBbmRWZXJzaW9uaW5nOltbZnVuY3Rpb24odCxlKXt0aGlzLnRhcmdldE9iamVjdFt0aGlzLnByb3BlcnR5TmFtZV09dFtlXX0sZnVuY3Rpb24odCxlKXt0aGlzLnRhcmdldE9iamVjdFt0aGlzLnByb3BlcnR5TmFtZV09dFtlXSx0aGlzLnRhcmdldE9iamVjdC5uZWVkc1VwZGF0ZT0hMH0sZnVuY3Rpb24odCxlKXt0aGlzLnRhcmdldE9iamVjdFt0aGlzLnByb3BlcnR5TmFtZV09dFtlXSx0aGlzLnRhcmdldE9iamVjdC5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlPSEwfV0sW2Z1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLnJlc29sdmVkUHJvcGVydHk7Zm9yKGxldCBuPTAscj1pLmxlbmd0aDtuIT09cjsrK24paVtuXT10W2UrK119LGZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLnJlc29sdmVkUHJvcGVydHk7Zm9yKGxldCBuPTAscj1pLmxlbmd0aDtuIT09cjsrK24paVtuXT10W2UrK107dGhpcy50YXJnZXRPYmplY3QubmVlZHNVcGRhdGU9ITB9LGZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLnJlc29sdmVkUHJvcGVydHk7Zm9yKGxldCBuPTAscj1pLmxlbmd0aDtuIT09cjsrK24paVtuXT10W2UrK107dGhpcy50YXJnZXRPYmplY3QubWF0cml4V29ybGROZWVkc1VwZGF0ZT0hMH1dLFtmdW5jdGlvbih0LGUpe3RoaXMucmVzb2x2ZWRQcm9wZXJ0eVt0aGlzLnByb3BlcnR5SW5kZXhdPXRbZV19LGZ1bmN0aW9uKHQsZSl7dGhpcy5yZXNvbHZlZFByb3BlcnR5W3RoaXMucHJvcGVydHlJbmRleF09dFtlXSx0aGlzLnRhcmdldE9iamVjdC5uZWVkc1VwZGF0ZT0hMH0sZnVuY3Rpb24odCxlKXt0aGlzLnJlc29sdmVkUHJvcGVydHlbdGhpcy5wcm9wZXJ0eUluZGV4XT10W2VdLHRoaXMudGFyZ2V0T2JqZWN0Lm1hdHJpeFdvcmxkTmVlZHNVcGRhdGU9ITB9XSxbZnVuY3Rpb24odCxlKXt0aGlzLnJlc29sdmVkUHJvcGVydHkuZnJvbUFycmF5KHQsZSl9LGZ1bmN0aW9uKHQsZSl7dGhpcy5yZXNvbHZlZFByb3BlcnR5LmZyb21BcnJheSh0LGUpLHRoaXMudGFyZ2V0T2JqZWN0Lm5lZWRzVXBkYXRlPSEwfSxmdW5jdGlvbih0LGUpe3RoaXMucmVzb2x2ZWRQcm9wZXJ0eS5mcm9tQXJyYXkodCxlKSx0aGlzLnRhcmdldE9iamVjdC5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlPSEwfV1dLGdldFZhbHVlOmZ1bmN0aW9uKHQsZSl7dGhpcy5iaW5kKCksdGhpcy5nZXRWYWx1ZSh0LGUpfSxzZXRWYWx1ZTpmdW5jdGlvbih0LGUpe3RoaXMuYmluZCgpLHRoaXMuc2V0VmFsdWUodCxlKX0sYmluZDpmdW5jdGlvbigpe2xldCB0PXRoaXMubm9kZTtjb25zdCBlPXRoaXMucGFyc2VkUGF0aCxpPWUub2JqZWN0TmFtZSxuPWUucHJvcGVydHlOYW1lO2xldCByPWUucHJvcGVydHlJbmRleDtpZih0fHwodD1OdS5maW5kTm9kZSh0aGlzLnJvb3ROb2RlLGUubm9kZU5hbWUpfHx0aGlzLnJvb3ROb2RlLHRoaXMubm9kZT10KSx0aGlzLmdldFZhbHVlPXRoaXMuX2dldFZhbHVlX3VuYXZhaWxhYmxlLHRoaXMuc2V0VmFsdWU9dGhpcy5fc2V0VmFsdWVfdW5hdmFpbGFibGUsIXQpcmV0dXJuIHZvaWQgY29uc29sZS5lcnJvcihcIlRIUkVFLlByb3BlcnR5QmluZGluZzogVHJ5aW5nIHRvIHVwZGF0ZSBub2RlIGZvciB0cmFjazogXCIrdGhpcy5wYXRoK1wiIGJ1dCBpdCB3YXNuJ3QgZm91bmQuXCIpO2lmKGkpe2xldCBuPWUub2JqZWN0SW5kZXg7c3dpdGNoKGkpe2Nhc2VcIm1hdGVyaWFsc1wiOmlmKCF0Lm1hdGVyaWFsKXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBtYXRlcmlhbCBhcyBub2RlIGRvZXMgbm90IGhhdmUgYSBtYXRlcmlhbC5cIix0aGlzKTtpZighdC5tYXRlcmlhbC5tYXRlcmlhbHMpcmV0dXJuIHZvaWQgY29uc29sZS5lcnJvcihcIlRIUkVFLlByb3BlcnR5QmluZGluZzogQ2FuIG5vdCBiaW5kIHRvIG1hdGVyaWFsLm1hdGVyaWFscyBhcyBub2RlLm1hdGVyaWFsIGRvZXMgbm90IGhhdmUgYSBtYXRlcmlhbHMgYXJyYXkuXCIsdGhpcyk7dD10Lm1hdGVyaWFsLm1hdGVyaWFsczticmVhaztjYXNlXCJib25lc1wiOmlmKCF0LnNrZWxldG9uKXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBib25lcyBhcyBub2RlIGRvZXMgbm90IGhhdmUgYSBza2VsZXRvbi5cIix0aGlzKTt0PXQuc2tlbGV0b24uYm9uZXM7Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aDtlKyspaWYodFtlXS5uYW1lPT09bil7bj1lO2JyZWFrfWJyZWFrO2RlZmF1bHQ6aWYodm9pZCAwPT09dFtpXSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBDYW4gbm90IGJpbmQgdG8gb2JqZWN0TmFtZSBvZiBub2RlIHVuZGVmaW5lZC5cIix0aGlzKTt0PXRbaV19aWYodm9pZCAwIT09bil7aWYodm9pZCAwPT09dFtuXSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBUcnlpbmcgdG8gYmluZCB0byBvYmplY3RJbmRleCBvZiBvYmplY3ROYW1lLCBidXQgaXMgdW5kZWZpbmVkLlwiLHRoaXMsdCk7dD10W25dfX1jb25zdCBzPXRbbl07aWYodm9pZCAwPT09cyl7Y29uc3QgaT1lLm5vZGVOYW1lO3JldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IFRyeWluZyB0byB1cGRhdGUgcHJvcGVydHkgZm9yIHRyYWNrOiBcIitpK1wiLlwiK24rXCIgYnV0IGl0IHdhc24ndCBmb3VuZC5cIix0KX1sZXQgbz10aGlzLlZlcnNpb25pbmcuTm9uZTt0aGlzLnRhcmdldE9iamVjdD10LHZvaWQgMCE9PXQubmVlZHNVcGRhdGU/bz10aGlzLlZlcnNpb25pbmcuTmVlZHNVcGRhdGU6dm9pZCAwIT09dC5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlJiYobz10aGlzLlZlcnNpb25pbmcuTWF0cml4V29ybGROZWVkc1VwZGF0ZSk7bGV0IGE9dGhpcy5CaW5kaW5nVHlwZS5EaXJlY3Q7aWYodm9pZCAwIT09cil7aWYoXCJtb3JwaFRhcmdldEluZmx1ZW5jZXNcIj09PW4pe2lmKCF0Lmdlb21ldHJ5KXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBtb3JwaFRhcmdldEluZmx1ZW5jZXMgYmVjYXVzZSBub2RlIGRvZXMgbm90IGhhdmUgYSBnZW9tZXRyeS5cIix0aGlzKTtpZighdC5nZW9tZXRyeS5pc0J1ZmZlckdlb21ldHJ5KXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5Qcm9wZXJ0eUJpbmRpbmc6IENhbiBub3QgYmluZCB0byBtb3JwaFRhcmdldEluZmx1ZW5jZXMgb24gVEhSRUUuR2VvbWV0cnkuIFVzZSBUSFJFRS5CdWZmZXJHZW9tZXRyeSBpbnN0ZWFkLlwiLHRoaXMpO2lmKCF0Lmdlb21ldHJ5Lm1vcnBoQXR0cmlidXRlcylyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVEhSRUUuUHJvcGVydHlCaW5kaW5nOiBDYW4gbm90IGJpbmQgdG8gbW9ycGhUYXJnZXRJbmZsdWVuY2VzIGJlY2F1c2Ugbm9kZSBkb2VzIG5vdCBoYXZlIGEgZ2VvbWV0cnkubW9ycGhBdHRyaWJ1dGVzLlwiLHRoaXMpO3ZvaWQgMCE9PXQubW9ycGhUYXJnZXREaWN0aW9uYXJ5W3JdJiYocj10Lm1vcnBoVGFyZ2V0RGljdGlvbmFyeVtyXSl9YT10aGlzLkJpbmRpbmdUeXBlLkFycmF5RWxlbWVudCx0aGlzLnJlc29sdmVkUHJvcGVydHk9cyx0aGlzLnByb3BlcnR5SW5kZXg9cn1lbHNlIHZvaWQgMCE9PXMuZnJvbUFycmF5JiZ2b2lkIDAhPT1zLnRvQXJyYXk/KGE9dGhpcy5CaW5kaW5nVHlwZS5IYXNGcm9tVG9BcnJheSx0aGlzLnJlc29sdmVkUHJvcGVydHk9cyk6QXJyYXkuaXNBcnJheShzKT8oYT10aGlzLkJpbmRpbmdUeXBlLkVudGlyZUFycmF5LHRoaXMucmVzb2x2ZWRQcm9wZXJ0eT1zKTp0aGlzLnByb3BlcnR5TmFtZT1uO3RoaXMuZ2V0VmFsdWU9dGhpcy5HZXR0ZXJCeUJpbmRpbmdUeXBlW2FdLHRoaXMuc2V0VmFsdWU9dGhpcy5TZXR0ZXJCeUJpbmRpbmdUeXBlQW5kVmVyc2lvbmluZ1thXVtvXX0sdW5iaW5kOmZ1bmN0aW9uKCl7dGhpcy5ub2RlPW51bGwsdGhpcy5nZXRWYWx1ZT10aGlzLl9nZXRWYWx1ZV91bmJvdW5kLHRoaXMuc2V0VmFsdWU9dGhpcy5fc2V0VmFsdWVfdW5ib3VuZH19KSxPYmplY3QuYXNzaWduKE51LnByb3RvdHlwZSx7X2dldFZhbHVlX3VuYm91bmQ6TnUucHJvdG90eXBlLmdldFZhbHVlLF9zZXRWYWx1ZV91bmJvdW5kOk51LnByb3RvdHlwZS5zZXRWYWx1ZX0pLE9iamVjdC5hc3NpZ24oZnVuY3Rpb24oKXt0aGlzLnV1aWQ9bm4uZ2VuZXJhdGVVVUlEKCksdGhpcy5fb2JqZWN0cz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLHRoaXMubkNhY2hlZE9iamVjdHNfPTA7Y29uc3QgdD17fTt0aGlzLl9pbmRpY2VzQnlVVUlEPXQ7Zm9yKGxldCBlPTAsaT1hcmd1bWVudHMubGVuZ3RoO2UhPT1pOysrZSl0W2FyZ3VtZW50c1tlXS51dWlkXT1lO3RoaXMuX3BhdGhzPVtdLHRoaXMuX3BhcnNlZFBhdGhzPVtdLHRoaXMuX2JpbmRpbmdzPVtdLHRoaXMuX2JpbmRpbmdzSW5kaWNlc0J5UGF0aD17fTtjb25zdCBlPXRoaXM7dGhpcy5zdGF0cz17b2JqZWN0czp7Z2V0IHRvdGFsKCl7cmV0dXJuIGUuX29iamVjdHMubGVuZ3RofSxnZXQgaW5Vc2UoKXtyZXR1cm4gdGhpcy50b3RhbC1lLm5DYWNoZWRPYmplY3RzX319LGdldCBiaW5kaW5nc1Blck9iamVjdCgpe3JldHVybiBlLl9iaW5kaW5ncy5sZW5ndGh9fX0ucHJvdG90eXBlLHtpc0FuaW1hdGlvbk9iamVjdEdyb3VwOiEwLGFkZDpmdW5jdGlvbigpe2NvbnN0IHQ9dGhpcy5fb2JqZWN0cyxlPXRoaXMuX2luZGljZXNCeVVVSUQsaT10aGlzLl9wYXRocyxuPXRoaXMuX3BhcnNlZFBhdGhzLHI9dGhpcy5fYmluZGluZ3Mscz1yLmxlbmd0aDtsZXQgbyxhPXQubGVuZ3RoLGM9dGhpcy5uQ2FjaGVkT2JqZWN0c187Zm9yKGxldCBoPTAsbD1hcmd1bWVudHMubGVuZ3RoO2ghPT1sOysraCl7Y29uc3QgbD1hcmd1bWVudHNbaF0sdT1sLnV1aWQ7bGV0IGQ9ZVt1XTtpZih2b2lkIDA9PT1kKXtkPWErKyxlW3VdPWQsdC5wdXNoKGwpO2ZvcihsZXQgdD0wLGU9czt0IT09ZTsrK3Qpclt0XS5wdXNoKG5ldyBOdShsLGlbdF0sblt0XSkpfWVsc2UgaWYoZDxjKXtvPXRbZF07Y29uc3QgYT0tLWMsaD10W2FdO2VbaC51dWlkXT1kLHRbZF09aCxlW3VdPWEsdFthXT1sO2ZvcihsZXQgdD0wLGU9czt0IT09ZTsrK3Qpe2NvbnN0IGU9clt0XSxzPWVbYV07bGV0IG89ZVtkXTtlW2RdPXMsdm9pZCAwPT09byYmKG89bmV3IE51KGwsaVt0XSxuW3RdKSksZVthXT1vfX1lbHNlIHRbZF0hPT1vJiZjb25zb2xlLmVycm9yKFwiVEhSRUUuQW5pbWF0aW9uT2JqZWN0R3JvdXA6IERpZmZlcmVudCBvYmplY3RzIHdpdGggdGhlIHNhbWUgVVVJRCBkZXRlY3RlZC4gQ2xlYW4gdGhlIGNhY2hlcyBvciByZWNyZWF0ZSB5b3VyIGluZnJhc3RydWN0dXJlIHdoZW4gcmVsb2FkaW5nIHNjZW5lcy5cIil9dGhpcy5uQ2FjaGVkT2JqZWN0c189Y30scmVtb3ZlOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLl9vYmplY3RzLGU9dGhpcy5faW5kaWNlc0J5VVVJRCxpPXRoaXMuX2JpbmRpbmdzLG49aS5sZW5ndGg7bGV0IHI9dGhpcy5uQ2FjaGVkT2JqZWN0c187Zm9yKGxldCBzPTAsbz1hcmd1bWVudHMubGVuZ3RoO3MhPT1vOysrcyl7Y29uc3Qgbz1hcmd1bWVudHNbc10sYT1vLnV1aWQsYz1lW2FdO2lmKHZvaWQgMCE9PWMmJmM+PXIpe2NvbnN0IHM9cisrLGg9dFtzXTtlW2gudXVpZF09Yyx0W2NdPWgsZVthXT1zLHRbc109bztmb3IobGV0IHQ9MCxlPW47dCE9PWU7Kyt0KXtjb25zdCBlPWlbdF0sbj1lW3NdLHI9ZVtjXTtlW2NdPW4sZVtzXT1yfX19dGhpcy5uQ2FjaGVkT2JqZWN0c189cn0sdW5jYWNoZTpmdW5jdGlvbigpe2NvbnN0IHQ9dGhpcy5fb2JqZWN0cyxlPXRoaXMuX2luZGljZXNCeVVVSUQsaT10aGlzLl9iaW5kaW5ncyxuPWkubGVuZ3RoO2xldCByPXRoaXMubkNhY2hlZE9iamVjdHNfLHM9dC5sZW5ndGg7Zm9yKGxldCBvPTAsYT1hcmd1bWVudHMubGVuZ3RoO28hPT1hOysrbyl7Y29uc3QgYT1hcmd1bWVudHNbb10udXVpZCxjPWVbYV07aWYodm9pZCAwIT09YylpZihkZWxldGUgZVthXSxjPHIpe2NvbnN0IG89LS1yLGE9dFtvXSxoPS0tcyxsPXRbaF07ZVthLnV1aWRdPWMsdFtjXT1hLGVbbC51dWlkXT1vLHRbb109bCx0LnBvcCgpO2ZvcihsZXQgdD0wLGU9bjt0IT09ZTsrK3Qpe2NvbnN0IGU9aVt0XSxuPWVbb10scj1lW2hdO2VbY109bixlW29dPXIsZS5wb3AoKX19ZWxzZXtjb25zdCByPS0tcyxvPXRbcl07cj4wJiYoZVtvLnV1aWRdPWMpLHRbY109byx0LnBvcCgpO2ZvcihsZXQgdD0wLGU9bjt0IT09ZTsrK3Qpe2NvbnN0IGU9aVt0XTtlW2NdPWVbcl0sZS5wb3AoKX19fXRoaXMubkNhY2hlZE9iamVjdHNfPXJ9LHN1YnNjcmliZV86ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMuX2JpbmRpbmdzSW5kaWNlc0J5UGF0aDtsZXQgbj1pW3RdO2NvbnN0IHI9dGhpcy5fYmluZGluZ3M7aWYodm9pZCAwIT09bilyZXR1cm4gcltuXTtjb25zdCBzPXRoaXMuX3BhdGhzLG89dGhpcy5fcGFyc2VkUGF0aHMsYT10aGlzLl9vYmplY3RzLGM9YS5sZW5ndGgsaD10aGlzLm5DYWNoZWRPYmplY3RzXyxsPW5ldyBBcnJheShjKTtuPXIubGVuZ3RoLGlbdF09bixzLnB1c2godCksby5wdXNoKGUpLHIucHVzaChsKTtmb3IobGV0IGk9aCxuPWEubGVuZ3RoO2khPT1uOysraSl7Y29uc3Qgbj1hW2ldO2xbaV09bmV3IE51KG4sdCxlKX1yZXR1cm4gbH0sdW5zdWJzY3JpYmVfOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5fYmluZGluZ3NJbmRpY2VzQnlQYXRoLGk9ZVt0XTtpZih2b2lkIDAhPT1pKXtjb25zdCBuPXRoaXMuX3BhdGhzLHI9dGhpcy5fcGFyc2VkUGF0aHMscz10aGlzLl9iaW5kaW5ncyxvPXMubGVuZ3RoLTEsYT1zW29dO2VbdFtvXV09aSxzW2ldPWEscy5wb3AoKSxyW2ldPXJbb10sci5wb3AoKSxuW2ldPW5bb10sbi5wb3AoKX19fSk7Y2xhc3MgRHV7Y29uc3RydWN0b3IodCxlLGk9bnVsbCxuPWUuYmxlbmRNb2RlKXt0aGlzLl9taXhlcj10LHRoaXMuX2NsaXA9ZSx0aGlzLl9sb2NhbFJvb3Q9aSx0aGlzLmJsZW5kTW9kZT1uO2NvbnN0IHI9ZS50cmFja3Mscz1yLmxlbmd0aCxvPW5ldyBBcnJheShzKSxhPXtlbmRpbmdTdGFydDpWaSxlbmRpbmdFbmQ6Vml9O2ZvcihsZXQgdD0wO3QhPT1zOysrdCl7Y29uc3QgZT1yW3RdLmNyZWF0ZUludGVycG9sYW50KG51bGwpO29bdF09ZSxlLnNldHRpbmdzPWF9dGhpcy5faW50ZXJwb2xhbnRTZXR0aW5ncz1hLHRoaXMuX2ludGVycG9sYW50cz1vLHRoaXMuX3Byb3BlcnR5QmluZGluZ3M9bmV3IEFycmF5KHMpLHRoaXMuX2NhY2hlSW5kZXg9bnVsbCx0aGlzLl9ieUNsaXBDYWNoZUluZGV4PW51bGwsdGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQ9bnVsbCx0aGlzLl93ZWlnaHRJbnRlcnBvbGFudD1udWxsLHRoaXMubG9vcD0yMjAxLHRoaXMuX2xvb3BDb3VudD0tMSx0aGlzLl9zdGFydFRpbWU9bnVsbCx0aGlzLnRpbWU9MCx0aGlzLnRpbWVTY2FsZT0xLHRoaXMuX2VmZmVjdGl2ZVRpbWVTY2FsZT0xLHRoaXMud2VpZ2h0PTEsdGhpcy5fZWZmZWN0aXZlV2VpZ2h0PTEsdGhpcy5yZXBldGl0aW9ucz0xLzAsdGhpcy5wYXVzZWQ9ITEsdGhpcy5lbmFibGVkPSEwLHRoaXMuY2xhbXBXaGVuRmluaXNoZWQ9ITEsdGhpcy56ZXJvU2xvcGVBdFN0YXJ0PSEwLHRoaXMuemVyb1Nsb3BlQXRFbmQ9ITB9cGxheSgpe3JldHVybiB0aGlzLl9taXhlci5fYWN0aXZhdGVBY3Rpb24odGhpcyksdGhpc31zdG9wKCl7cmV0dXJuIHRoaXMuX21peGVyLl9kZWFjdGl2YXRlQWN0aW9uKHRoaXMpLHRoaXMucmVzZXQoKX1yZXNldCgpe3JldHVybiB0aGlzLnBhdXNlZD0hMSx0aGlzLmVuYWJsZWQ9ITAsdGhpcy50aW1lPTAsdGhpcy5fbG9vcENvdW50PS0xLHRoaXMuX3N0YXJ0VGltZT1udWxsLHRoaXMuc3RvcEZhZGluZygpLnN0b3BXYXJwaW5nKCl9aXNSdW5uaW5nKCl7cmV0dXJuIHRoaXMuZW5hYmxlZCYmIXRoaXMucGF1c2VkJiYwIT09dGhpcy50aW1lU2NhbGUmJm51bGw9PT10aGlzLl9zdGFydFRpbWUmJnRoaXMuX21peGVyLl9pc0FjdGl2ZUFjdGlvbih0aGlzKX1pc1NjaGVkdWxlZCgpe3JldHVybiB0aGlzLl9taXhlci5faXNBY3RpdmVBY3Rpb24odGhpcyl9c3RhcnRBdCh0KXtyZXR1cm4gdGhpcy5fc3RhcnRUaW1lPXQsdGhpc31zZXRMb29wKHQsZSl7cmV0dXJuIHRoaXMubG9vcD10LHRoaXMucmVwZXRpdGlvbnM9ZSx0aGlzfXNldEVmZmVjdGl2ZVdlaWdodCh0KXtyZXR1cm4gdGhpcy53ZWlnaHQ9dCx0aGlzLl9lZmZlY3RpdmVXZWlnaHQ9dGhpcy5lbmFibGVkP3Q6MCx0aGlzLnN0b3BGYWRpbmcoKX1nZXRFZmZlY3RpdmVXZWlnaHQoKXtyZXR1cm4gdGhpcy5fZWZmZWN0aXZlV2VpZ2h0fWZhZGVJbih0KXtyZXR1cm4gdGhpcy5fc2NoZWR1bGVGYWRpbmcodCwwLDEpfWZhZGVPdXQodCl7cmV0dXJuIHRoaXMuX3NjaGVkdWxlRmFkaW5nKHQsMSwwKX1jcm9zc0ZhZGVGcm9tKHQsZSxpKXtpZih0LmZhZGVPdXQoZSksdGhpcy5mYWRlSW4oZSksaSl7Y29uc3QgaT10aGlzLl9jbGlwLmR1cmF0aW9uLG49dC5fY2xpcC5kdXJhdGlvbixyPW4vaSxzPWkvbjt0LndhcnAoMSxyLGUpLHRoaXMud2FycChzLDEsZSl9cmV0dXJuIHRoaXN9Y3Jvc3NGYWRlVG8odCxlLGkpe3JldHVybiB0LmNyb3NzRmFkZUZyb20odGhpcyxlLGkpfXN0b3BGYWRpbmcoKXtjb25zdCB0PXRoaXMuX3dlaWdodEludGVycG9sYW50O3JldHVybiBudWxsIT09dCYmKHRoaXMuX3dlaWdodEludGVycG9sYW50PW51bGwsdGhpcy5fbWl4ZXIuX3Rha2VCYWNrQ29udHJvbEludGVycG9sYW50KHQpKSx0aGlzfXNldEVmZmVjdGl2ZVRpbWVTY2FsZSh0KXtyZXR1cm4gdGhpcy50aW1lU2NhbGU9dCx0aGlzLl9lZmZlY3RpdmVUaW1lU2NhbGU9dGhpcy5wYXVzZWQ/MDp0LHRoaXMuc3RvcFdhcnBpbmcoKX1nZXRFZmZlY3RpdmVUaW1lU2NhbGUoKXtyZXR1cm4gdGhpcy5fZWZmZWN0aXZlVGltZVNjYWxlfXNldER1cmF0aW9uKHQpe3JldHVybiB0aGlzLnRpbWVTY2FsZT10aGlzLl9jbGlwLmR1cmF0aW9uL3QsdGhpcy5zdG9wV2FycGluZygpfXN5bmNXaXRoKHQpe3JldHVybiB0aGlzLnRpbWU9dC50aW1lLHRoaXMudGltZVNjYWxlPXQudGltZVNjYWxlLHRoaXMuc3RvcFdhcnBpbmcoKX1oYWx0KHQpe3JldHVybiB0aGlzLndhcnAodGhpcy5fZWZmZWN0aXZlVGltZVNjYWxlLDAsdCl9d2FycCh0LGUsaSl7Y29uc3Qgbj10aGlzLl9taXhlcixyPW4udGltZSxzPXRoaXMudGltZVNjYWxlO2xldCBvPXRoaXMuX3RpbWVTY2FsZUludGVycG9sYW50O251bGw9PT1vJiYobz1uLl9sZW5kQ29udHJvbEludGVycG9sYW50KCksdGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQ9byk7Y29uc3QgYT1vLnBhcmFtZXRlclBvc2l0aW9ucyxjPW8uc2FtcGxlVmFsdWVzO3JldHVybiBhWzBdPXIsYVsxXT1yK2ksY1swXT10L3MsY1sxXT1lL3MsdGhpc31zdG9wV2FycGluZygpe2NvbnN0IHQ9dGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQ7cmV0dXJuIG51bGwhPT10JiYodGhpcy5fdGltZVNjYWxlSW50ZXJwb2xhbnQ9bnVsbCx0aGlzLl9taXhlci5fdGFrZUJhY2tDb250cm9sSW50ZXJwb2xhbnQodCkpLHRoaXN9Z2V0TWl4ZXIoKXtyZXR1cm4gdGhpcy5fbWl4ZXJ9Z2V0Q2xpcCgpe3JldHVybiB0aGlzLl9jbGlwfWdldFJvb3QoKXtyZXR1cm4gdGhpcy5fbG9jYWxSb290fHx0aGlzLl9taXhlci5fcm9vdH1fdXBkYXRlKHQsZSxpLG4pe2lmKCF0aGlzLmVuYWJsZWQpcmV0dXJuIHZvaWQgdGhpcy5fdXBkYXRlV2VpZ2h0KHQpO2NvbnN0IHI9dGhpcy5fc3RhcnRUaW1lO2lmKG51bGwhPT1yKXtjb25zdCBuPSh0LXIpKmk7aWYobjwwfHwwPT09aSlyZXR1cm47dGhpcy5fc3RhcnRUaW1lPW51bGwsZT1pKm59ZSo9dGhpcy5fdXBkYXRlVGltZVNjYWxlKHQpO2NvbnN0IHM9dGhpcy5fdXBkYXRlVGltZShlKSxvPXRoaXMuX3VwZGF0ZVdlaWdodCh0KTtpZihvPjApe2NvbnN0IHQ9dGhpcy5faW50ZXJwb2xhbnRzLGU9dGhpcy5fcHJvcGVydHlCaW5kaW5ncztzd2l0Y2godGhpcy5ibGVuZE1vZGUpe2Nhc2UgMjUwMTpmb3IobGV0IGk9MCxuPXQubGVuZ3RoO2khPT1uOysraSl0W2ldLmV2YWx1YXRlKHMpLGVbaV0uYWNjdW11bGF0ZUFkZGl0aXZlKG8pO2JyZWFrO2Nhc2UgV2k6ZGVmYXVsdDpmb3IobGV0IGk9MCxyPXQubGVuZ3RoO2khPT1yOysraSl0W2ldLmV2YWx1YXRlKHMpLGVbaV0uYWNjdW11bGF0ZShuLG8pfX19X3VwZGF0ZVdlaWdodCh0KXtsZXQgZT0wO2lmKHRoaXMuZW5hYmxlZCl7ZT10aGlzLndlaWdodDtjb25zdCBpPXRoaXMuX3dlaWdodEludGVycG9sYW50O2lmKG51bGwhPT1pKXtjb25zdCBuPWkuZXZhbHVhdGUodClbMF07ZSo9bix0PmkucGFyYW1ldGVyUG9zaXRpb25zWzFdJiYodGhpcy5zdG9wRmFkaW5nKCksMD09PW4mJih0aGlzLmVuYWJsZWQ9ITEpKX19cmV0dXJuIHRoaXMuX2VmZmVjdGl2ZVdlaWdodD1lLGV9X3VwZGF0ZVRpbWVTY2FsZSh0KXtsZXQgZT0wO2lmKCF0aGlzLnBhdXNlZCl7ZT10aGlzLnRpbWVTY2FsZTtjb25zdCBpPXRoaXMuX3RpbWVTY2FsZUludGVycG9sYW50O2lmKG51bGwhPT1pKXtlKj1pLmV2YWx1YXRlKHQpWzBdLHQ+aS5wYXJhbWV0ZXJQb3NpdGlvbnNbMV0mJih0aGlzLnN0b3BXYXJwaW5nKCksMD09PWU/dGhpcy5wYXVzZWQ9ITA6dGhpcy50aW1lU2NhbGU9ZSl9fXJldHVybiB0aGlzLl9lZmZlY3RpdmVUaW1lU2NhbGU9ZSxlfV91cGRhdGVUaW1lKHQpe2NvbnN0IGU9dGhpcy5fY2xpcC5kdXJhdGlvbixpPXRoaXMubG9vcDtsZXQgbj10aGlzLnRpbWUrdCxyPXRoaXMuX2xvb3BDb3VudDtjb25zdCBzPTIyMDI9PT1pO2lmKDA9PT10KXJldHVybi0xPT09cj9uOnMmJjE9PSgxJnIpP2UtbjpuO2lmKDIyMDA9PT1pKXstMT09PXImJih0aGlzLl9sb29wQ291bnQ9MCx0aGlzLl9zZXRFbmRpbmdzKCEwLCEwLCExKSk7dDp7aWYobj49ZSluPWU7ZWxzZXtpZighKG48MCkpe3RoaXMudGltZT1uO2JyZWFrIHR9bj0wfXRoaXMuY2xhbXBXaGVuRmluaXNoZWQ/dGhpcy5wYXVzZWQ9ITA6dGhpcy5lbmFibGVkPSExLHRoaXMudGltZT1uLHRoaXMuX21peGVyLmRpc3BhdGNoRXZlbnQoe3R5cGU6XCJmaW5pc2hlZFwiLGFjdGlvbjp0aGlzLGRpcmVjdGlvbjp0PDA/LTE6MX0pfX1lbHNle2lmKC0xPT09ciYmKHQ+PTA/KHI9MCx0aGlzLl9zZXRFbmRpbmdzKCEwLDA9PT10aGlzLnJlcGV0aXRpb25zLHMpKTp0aGlzLl9zZXRFbmRpbmdzKDA9PT10aGlzLnJlcGV0aXRpb25zLCEwLHMpKSxuPj1lfHxuPDApe2NvbnN0IGk9TWF0aC5mbG9vcihuL2UpO24tPWUqaSxyKz1NYXRoLmFicyhpKTtjb25zdCBvPXRoaXMucmVwZXRpdGlvbnMtcjtpZihvPD0wKXRoaXMuY2xhbXBXaGVuRmluaXNoZWQ/dGhpcy5wYXVzZWQ9ITA6dGhpcy5lbmFibGVkPSExLG49dD4wP2U6MCx0aGlzLnRpbWU9bix0aGlzLl9taXhlci5kaXNwYXRjaEV2ZW50KHt0eXBlOlwiZmluaXNoZWRcIixhY3Rpb246dGhpcyxkaXJlY3Rpb246dD4wPzE6LTF9KTtlbHNle2lmKDE9PT1vKXtjb25zdCBlPXQ8MDt0aGlzLl9zZXRFbmRpbmdzKGUsIWUscyl9ZWxzZSB0aGlzLl9zZXRFbmRpbmdzKCExLCExLHMpO3RoaXMuX2xvb3BDb3VudD1yLHRoaXMudGltZT1uLHRoaXMuX21peGVyLmRpc3BhdGNoRXZlbnQoe3R5cGU6XCJsb29wXCIsYWN0aW9uOnRoaXMsbG9vcERlbHRhOml9KX19ZWxzZSB0aGlzLnRpbWU9bjtpZihzJiYxPT0oMSZyKSlyZXR1cm4gZS1ufXJldHVybiBufV9zZXRFbmRpbmdzKHQsZSxpKXtjb25zdCBuPXRoaXMuX2ludGVycG9sYW50U2V0dGluZ3M7aT8obi5lbmRpbmdTdGFydD1HaSxuLmVuZGluZ0VuZD1HaSk6KG4uZW5kaW5nU3RhcnQ9dD90aGlzLnplcm9TbG9wZUF0U3RhcnQ/R2k6Vmk6cWksbi5lbmRpbmdFbmQ9ZT90aGlzLnplcm9TbG9wZUF0RW5kP0dpOlZpOnFpKX1fc2NoZWR1bGVGYWRpbmcodCxlLGkpe2NvbnN0IG49dGhpcy5fbWl4ZXIscj1uLnRpbWU7bGV0IHM9dGhpcy5fd2VpZ2h0SW50ZXJwb2xhbnQ7bnVsbD09PXMmJihzPW4uX2xlbmRDb250cm9sSW50ZXJwb2xhbnQoKSx0aGlzLl93ZWlnaHRJbnRlcnBvbGFudD1zKTtjb25zdCBvPXMucGFyYW1ldGVyUG9zaXRpb25zLGE9cy5zYW1wbGVWYWx1ZXM7cmV0dXJuIG9bMF09cixhWzBdPWUsb1sxXT1yK3QsYVsxXT1pLHRoaXN9fWZ1bmN0aW9uICR1KHQpe3RoaXMuX3Jvb3Q9dCx0aGlzLl9pbml0TWVtb3J5TWFuYWdlcigpLHRoaXMuX2FjY3VJbmRleD0wLHRoaXMudGltZT0wLHRoaXMudGltZVNjYWxlPTF9JHUucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShRaS5wcm90b3R5cGUpLHtjb25zdHJ1Y3RvcjokdSxfYmluZEFjdGlvbjpmdW5jdGlvbih0LGUpe2NvbnN0IGk9dC5fbG9jYWxSb290fHx0aGlzLl9yb290LG49dC5fY2xpcC50cmFja3Mscj1uLmxlbmd0aCxzPXQuX3Byb3BlcnR5QmluZGluZ3Msbz10Ll9pbnRlcnBvbGFudHMsYT1pLnV1aWQsYz10aGlzLl9iaW5kaW5nc0J5Um9vdEFuZE5hbWU7bGV0IGg9Y1thXTt2b2lkIDA9PT1oJiYoaD17fSxjW2FdPWgpO2ZvcihsZXQgdD0wO3QhPT1yOysrdCl7Y29uc3Qgcj1uW3RdLGM9ci5uYW1lO2xldCBsPWhbY107aWYodm9pZCAwIT09bClzW3RdPWw7ZWxzZXtpZihsPXNbdF0sdm9pZCAwIT09bCl7bnVsbD09PWwuX2NhY2hlSW5kZXgmJigrK2wucmVmZXJlbmNlQ291bnQsdGhpcy5fYWRkSW5hY3RpdmVCaW5kaW5nKGwsYSxjKSk7Y29udGludWV9Y29uc3Qgbj1lJiZlLl9wcm9wZXJ0eUJpbmRpbmdzW3RdLmJpbmRpbmcucGFyc2VkUGF0aDtsPW5ldyB3dShOdS5jcmVhdGUoaSxjLG4pLHIuVmFsdWVUeXBlTmFtZSxyLmdldFZhbHVlU2l6ZSgpKSwrK2wucmVmZXJlbmNlQ291bnQsdGhpcy5fYWRkSW5hY3RpdmVCaW5kaW5nKGwsYSxjKSxzW3RdPWx9b1t0XS5yZXN1bHRCdWZmZXI9bC5idWZmZXJ9fSxfYWN0aXZhdGVBY3Rpb246ZnVuY3Rpb24odCl7aWYoIXRoaXMuX2lzQWN0aXZlQWN0aW9uKHQpKXtpZihudWxsPT09dC5fY2FjaGVJbmRleCl7Y29uc3QgZT0odC5fbG9jYWxSb290fHx0aGlzLl9yb290KS51dWlkLGk9dC5fY2xpcC51dWlkLG49dGhpcy5fYWN0aW9uc0J5Q2xpcFtpXTt0aGlzLl9iaW5kQWN0aW9uKHQsbiYmbi5rbm93bkFjdGlvbnNbMF0pLHRoaXMuX2FkZEluYWN0aXZlQWN0aW9uKHQsaSxlKX1jb25zdCBlPXQuX3Byb3BlcnR5QmluZGluZ3M7Zm9yKGxldCB0PTAsaT1lLmxlbmd0aDt0IT09aTsrK3Qpe2NvbnN0IGk9ZVt0XTswPT1pLnVzZUNvdW50KysmJih0aGlzLl9sZW5kQmluZGluZyhpKSxpLnNhdmVPcmlnaW5hbFN0YXRlKCkpfXRoaXMuX2xlbmRBY3Rpb24odCl9fSxfZGVhY3RpdmF0ZUFjdGlvbjpmdW5jdGlvbih0KXtpZih0aGlzLl9pc0FjdGl2ZUFjdGlvbih0KSl7Y29uc3QgZT10Ll9wcm9wZXJ0eUJpbmRpbmdzO2ZvcihsZXQgdD0wLGk9ZS5sZW5ndGg7dCE9PWk7Kyt0KXtjb25zdCBpPWVbdF07MD09LS1pLnVzZUNvdW50JiYoaS5yZXN0b3JlT3JpZ2luYWxTdGF0ZSgpLHRoaXMuX3Rha2VCYWNrQmluZGluZyhpKSl9dGhpcy5fdGFrZUJhY2tBY3Rpb24odCl9fSxfaW5pdE1lbW9yeU1hbmFnZXI6ZnVuY3Rpb24oKXt0aGlzLl9hY3Rpb25zPVtdLHRoaXMuX25BY3RpdmVBY3Rpb25zPTAsdGhpcy5fYWN0aW9uc0J5Q2xpcD17fSx0aGlzLl9iaW5kaW5ncz1bXSx0aGlzLl9uQWN0aXZlQmluZGluZ3M9MCx0aGlzLl9iaW5kaW5nc0J5Um9vdEFuZE5hbWU9e30sdGhpcy5fY29udHJvbEludGVycG9sYW50cz1bXSx0aGlzLl9uQWN0aXZlQ29udHJvbEludGVycG9sYW50cz0wO2NvbnN0IHQ9dGhpczt0aGlzLnN0YXRzPXthY3Rpb25zOntnZXQgdG90YWwoKXtyZXR1cm4gdC5fYWN0aW9ucy5sZW5ndGh9LGdldCBpblVzZSgpe3JldHVybiB0Ll9uQWN0aXZlQWN0aW9uc319LGJpbmRpbmdzOntnZXQgdG90YWwoKXtyZXR1cm4gdC5fYmluZGluZ3MubGVuZ3RofSxnZXQgaW5Vc2UoKXtyZXR1cm4gdC5fbkFjdGl2ZUJpbmRpbmdzfX0sY29udHJvbEludGVycG9sYW50czp7Z2V0IHRvdGFsKCl7cmV0dXJuIHQuX2NvbnRyb2xJbnRlcnBvbGFudHMubGVuZ3RofSxnZXQgaW5Vc2UoKXtyZXR1cm4gdC5fbkFjdGl2ZUNvbnRyb2xJbnRlcnBvbGFudHN9fX19LF9pc0FjdGl2ZUFjdGlvbjpmdW5jdGlvbih0KXtjb25zdCBlPXQuX2NhY2hlSW5kZXg7cmV0dXJuIG51bGwhPT1lJiZlPHRoaXMuX25BY3RpdmVBY3Rpb25zfSxfYWRkSW5hY3RpdmVBY3Rpb246ZnVuY3Rpb24odCxlLGkpe2NvbnN0IG49dGhpcy5fYWN0aW9ucyxyPXRoaXMuX2FjdGlvbnNCeUNsaXA7bGV0IHM9cltlXTtpZih2b2lkIDA9PT1zKXM9e2tub3duQWN0aW9uczpbdF0sYWN0aW9uQnlSb290Ont9fSx0Ll9ieUNsaXBDYWNoZUluZGV4PTAscltlXT1zO2Vsc2V7Y29uc3QgZT1zLmtub3duQWN0aW9uczt0Ll9ieUNsaXBDYWNoZUluZGV4PWUubGVuZ3RoLGUucHVzaCh0KX10Ll9jYWNoZUluZGV4PW4ubGVuZ3RoLG4ucHVzaCh0KSxzLmFjdGlvbkJ5Um9vdFtpXT10fSxfcmVtb3ZlSW5hY3RpdmVBY3Rpb246ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLl9hY3Rpb25zLGk9ZVtlLmxlbmd0aC0xXSxuPXQuX2NhY2hlSW5kZXg7aS5fY2FjaGVJbmRleD1uLGVbbl09aSxlLnBvcCgpLHQuX2NhY2hlSW5kZXg9bnVsbDtjb25zdCByPXQuX2NsaXAudXVpZCxzPXRoaXMuX2FjdGlvbnNCeUNsaXAsbz1zW3JdLGE9by5rbm93bkFjdGlvbnMsYz1hW2EubGVuZ3RoLTFdLGg9dC5fYnlDbGlwQ2FjaGVJbmRleDtjLl9ieUNsaXBDYWNoZUluZGV4PWgsYVtoXT1jLGEucG9wKCksdC5fYnlDbGlwQ2FjaGVJbmRleD1udWxsO2RlbGV0ZSBvLmFjdGlvbkJ5Um9vdFsodC5fbG9jYWxSb290fHx0aGlzLl9yb290KS51dWlkXSwwPT09YS5sZW5ndGgmJmRlbGV0ZSBzW3JdLHRoaXMuX3JlbW92ZUluYWN0aXZlQmluZGluZ3NGb3JBY3Rpb24odCl9LF9yZW1vdmVJbmFjdGl2ZUJpbmRpbmdzRm9yQWN0aW9uOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dC5fcHJvcGVydHlCaW5kaW5ncztmb3IobGV0IHQ9MCxpPWUubGVuZ3RoO3QhPT1pOysrdCl7Y29uc3QgaT1lW3RdOzA9PS0taS5yZWZlcmVuY2VDb3VudCYmdGhpcy5fcmVtb3ZlSW5hY3RpdmVCaW5kaW5nKGkpfX0sX2xlbmRBY3Rpb246ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLl9hY3Rpb25zLGk9dC5fY2FjaGVJbmRleCxuPXRoaXMuX25BY3RpdmVBY3Rpb25zKysscj1lW25dO3QuX2NhY2hlSW5kZXg9bixlW25dPXQsci5fY2FjaGVJbmRleD1pLGVbaV09cn0sX3Rha2VCYWNrQWN0aW9uOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5fYWN0aW9ucyxpPXQuX2NhY2hlSW5kZXgsbj0tLXRoaXMuX25BY3RpdmVBY3Rpb25zLHI9ZVtuXTt0Ll9jYWNoZUluZGV4PW4sZVtuXT10LHIuX2NhY2hlSW5kZXg9aSxlW2ldPXJ9LF9hZGRJbmFjdGl2ZUJpbmRpbmc6ZnVuY3Rpb24odCxlLGkpe2NvbnN0IG49dGhpcy5fYmluZGluZ3NCeVJvb3RBbmROYW1lLHI9dGhpcy5fYmluZGluZ3M7bGV0IHM9bltlXTt2b2lkIDA9PT1zJiYocz17fSxuW2VdPXMpLHNbaV09dCx0Ll9jYWNoZUluZGV4PXIubGVuZ3RoLHIucHVzaCh0KX0sX3JlbW92ZUluYWN0aXZlQmluZGluZzpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMuX2JpbmRpbmdzLGk9dC5iaW5kaW5nLG49aS5yb290Tm9kZS51dWlkLHI9aS5wYXRoLHM9dGhpcy5fYmluZGluZ3NCeVJvb3RBbmROYW1lLG89c1tuXSxhPWVbZS5sZW5ndGgtMV0sYz10Ll9jYWNoZUluZGV4O2EuX2NhY2hlSW5kZXg9YyxlW2NdPWEsZS5wb3AoKSxkZWxldGUgb1tyXSwwPT09T2JqZWN0LmtleXMobykubGVuZ3RoJiZkZWxldGUgc1tuXX0sX2xlbmRCaW5kaW5nOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGhpcy5fYmluZGluZ3MsaT10Ll9jYWNoZUluZGV4LG49dGhpcy5fbkFjdGl2ZUJpbmRpbmdzKysscj1lW25dO3QuX2NhY2hlSW5kZXg9bixlW25dPXQsci5fY2FjaGVJbmRleD1pLGVbaV09cn0sX3Rha2VCYWNrQmluZGluZzpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMuX2JpbmRpbmdzLGk9dC5fY2FjaGVJbmRleCxuPS0tdGhpcy5fbkFjdGl2ZUJpbmRpbmdzLHI9ZVtuXTt0Ll9jYWNoZUluZGV4PW4sZVtuXT10LHIuX2NhY2hlSW5kZXg9aSxlW2ldPXJ9LF9sZW5kQ29udHJvbEludGVycG9sYW50OmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLl9jb250cm9sSW50ZXJwb2xhbnRzLGU9dGhpcy5fbkFjdGl2ZUNvbnRyb2xJbnRlcnBvbGFudHMrKztsZXQgaT10W2VdO3JldHVybiB2b2lkIDA9PT1pJiYoaT1uZXcgUWgobmV3IEZsb2F0MzJBcnJheSgyKSxuZXcgRmxvYXQzMkFycmF5KDIpLDEsdGhpcy5fY29udHJvbEludGVycG9sYW50c1Jlc3VsdEJ1ZmZlciksaS5fX2NhY2hlSW5kZXg9ZSx0W2VdPWkpLGl9LF90YWtlQmFja0NvbnRyb2xJbnRlcnBvbGFudDpmdW5jdGlvbih0KXtjb25zdCBlPXRoaXMuX2NvbnRyb2xJbnRlcnBvbGFudHMsaT10Ll9fY2FjaGVJbmRleCxuPS0tdGhpcy5fbkFjdGl2ZUNvbnRyb2xJbnRlcnBvbGFudHMscj1lW25dO3QuX19jYWNoZUluZGV4PW4sZVtuXT10LHIuX19jYWNoZUluZGV4PWksZVtpXT1yfSxfY29udHJvbEludGVycG9sYW50c1Jlc3VsdEJ1ZmZlcjpuZXcgRmxvYXQzMkFycmF5KDEpLGNsaXBBY3Rpb246ZnVuY3Rpb24odCxlLGkpe2NvbnN0IG49ZXx8dGhpcy5fcm9vdCxyPW4udXVpZDtsZXQgcz1cInN0cmluZ1wiPT10eXBlb2YgdD9obC5maW5kQnlOYW1lKG4sdCk6dDtjb25zdCBvPW51bGwhPT1zP3MudXVpZDp0LGE9dGhpcy5fYWN0aW9uc0J5Q2xpcFtvXTtsZXQgYz1udWxsO2lmKHZvaWQgMD09PWkmJihpPW51bGwhPT1zP3MuYmxlbmRNb2RlOldpKSx2b2lkIDAhPT1hKXtjb25zdCB0PWEuYWN0aW9uQnlSb290W3JdO2lmKHZvaWQgMCE9PXQmJnQuYmxlbmRNb2RlPT09aSlyZXR1cm4gdDtjPWEua25vd25BY3Rpb25zWzBdLG51bGw9PT1zJiYocz1jLl9jbGlwKX1pZihudWxsPT09cylyZXR1cm4gbnVsbDtjb25zdCBoPW5ldyBEdSh0aGlzLHMsZSxpKTtyZXR1cm4gdGhpcy5fYmluZEFjdGlvbihoLGMpLHRoaXMuX2FkZEluYWN0aXZlQWN0aW9uKGgsbyxyKSxofSxleGlzdGluZ0FjdGlvbjpmdW5jdGlvbih0LGUpe2NvbnN0IGk9ZXx8dGhpcy5fcm9vdCxuPWkudXVpZCxyPVwic3RyaW5nXCI9PXR5cGVvZiB0P2hsLmZpbmRCeU5hbWUoaSx0KTp0LHM9cj9yLnV1aWQ6dCxvPXRoaXMuX2FjdGlvbnNCeUNsaXBbc107cmV0dXJuIHZvaWQgMCE9PW8mJm8uYWN0aW9uQnlSb290W25dfHxudWxsfSxzdG9wQWxsQWN0aW9uOmZ1bmN0aW9uKCl7Y29uc3QgdD10aGlzLl9hY3Rpb25zO2ZvcihsZXQgZT10aGlzLl9uQWN0aXZlQWN0aW9ucy0xO2U+PTA7LS1lKXRbZV0uc3RvcCgpO3JldHVybiB0aGlzfSx1cGRhdGU6ZnVuY3Rpb24odCl7dCo9dGhpcy50aW1lU2NhbGU7Y29uc3QgZT10aGlzLl9hY3Rpb25zLGk9dGhpcy5fbkFjdGl2ZUFjdGlvbnMsbj10aGlzLnRpbWUrPXQscj1NYXRoLnNpZ24odCkscz10aGlzLl9hY2N1SW5kZXhePTE7Zm9yKGxldCBvPTA7byE9PWk7KytvKXtlW29dLl91cGRhdGUobix0LHIscyl9Y29uc3Qgbz10aGlzLl9iaW5kaW5ncyxhPXRoaXMuX25BY3RpdmVCaW5kaW5ncztmb3IobGV0IHQ9MDt0IT09YTsrK3Qpb1t0XS5hcHBseShzKTtyZXR1cm4gdGhpc30sc2V0VGltZTpmdW5jdGlvbih0KXt0aGlzLnRpbWU9MDtmb3IobGV0IHQ9MDt0PHRoaXMuX2FjdGlvbnMubGVuZ3RoO3QrKyl0aGlzLl9hY3Rpb25zW3RdLnRpbWU9MDtyZXR1cm4gdGhpcy51cGRhdGUodCl9LGdldFJvb3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcm9vdH0sdW5jYWNoZUNsaXA6ZnVuY3Rpb24odCl7Y29uc3QgZT10aGlzLl9hY3Rpb25zLGk9dC51dWlkLG49dGhpcy5fYWN0aW9uc0J5Q2xpcCxyPW5baV07aWYodm9pZCAwIT09cil7Y29uc3QgdD1yLmtub3duQWN0aW9ucztmb3IobGV0IGk9MCxuPXQubGVuZ3RoO2khPT1uOysraSl7Y29uc3Qgbj10W2ldO3RoaXMuX2RlYWN0aXZhdGVBY3Rpb24obik7Y29uc3Qgcj1uLl9jYWNoZUluZGV4LHM9ZVtlLmxlbmd0aC0xXTtuLl9jYWNoZUluZGV4PW51bGwsbi5fYnlDbGlwQ2FjaGVJbmRleD1udWxsLHMuX2NhY2hlSW5kZXg9cixlW3JdPXMsZS5wb3AoKSx0aGlzLl9yZW1vdmVJbmFjdGl2ZUJpbmRpbmdzRm9yQWN0aW9uKG4pfWRlbGV0ZSBuW2ldfX0sdW5jYWNoZVJvb3Q6ZnVuY3Rpb24odCl7Y29uc3QgZT10LnV1aWQsaT10aGlzLl9hY3Rpb25zQnlDbGlwO2Zvcihjb25zdCB0IGluIGkpe2NvbnN0IG49aVt0XS5hY3Rpb25CeVJvb3RbZV07dm9pZCAwIT09biYmKHRoaXMuX2RlYWN0aXZhdGVBY3Rpb24obiksdGhpcy5fcmVtb3ZlSW5hY3RpdmVBY3Rpb24obikpfWNvbnN0IG49dGhpcy5fYmluZGluZ3NCeVJvb3RBbmROYW1lW2VdO2lmKHZvaWQgMCE9PW4pZm9yKGNvbnN0IHQgaW4gbil7Y29uc3QgZT1uW3RdO2UucmVzdG9yZU9yaWdpbmFsU3RhdGUoKSx0aGlzLl9yZW1vdmVJbmFjdGl2ZUJpbmRpbmcoZSl9fSx1bmNhY2hlQWN0aW9uOmZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLmV4aXN0aW5nQWN0aW9uKHQsZSk7bnVsbCE9PWkmJih0aGlzLl9kZWFjdGl2YXRlQWN0aW9uKGkpLHRoaXMuX3JlbW92ZUluYWN0aXZlQWN0aW9uKGkpKX19KTtjbGFzcyBrdXtjb25zdHJ1Y3Rvcih0KXtcInN0cmluZ1wiPT10eXBlb2YgdCYmKGNvbnNvbGUud2FybihcIlRIUkVFLlVuaWZvcm06IFR5cGUgcGFyYW1ldGVyIGlzIG5vIGxvbmdlciBuZWVkZWQuXCIpLHQ9YXJndW1lbnRzWzFdKSx0aGlzLnZhbHVlPXR9Y2xvbmUoKXtyZXR1cm4gbmV3IGt1KHZvaWQgMD09PXRoaXMudmFsdWUuY2xvbmU/dGhpcy52YWx1ZTp0aGlzLnZhbHVlLmNsb25lKCkpfX1mdW5jdGlvbiB6dSh0LGUsaSl7dGMuY2FsbCh0aGlzLHQsZSksdGhpcy5tZXNoUGVyQXR0cmlidXRlPWl8fDF9ZnVuY3Rpb24gRnUodCxlLGksbixyKXt0aGlzLmJ1ZmZlcj10LHRoaXMudHlwZT1lLHRoaXMuaXRlbVNpemU9aSx0aGlzLmVsZW1lbnRTaXplPW4sdGhpcy5jb3VudD1yLHRoaXMudmVyc2lvbj0wfWZ1bmN0aW9uIEJ1KHQsZSxpLG4pe3RoaXMucmF5PW5ldyBqbih0LGUpLHRoaXMubmVhcj1pfHwwLHRoaXMuZmFyPW58fDEvMCx0aGlzLmNhbWVyYT1udWxsLHRoaXMubGF5ZXJzPW5ldyBRbix0aGlzLnBhcmFtcz17TWVzaDp7fSxMaW5lOnt0aHJlc2hvbGQ6MX0sTE9EOnt9LFBvaW50czp7dGhyZXNob2xkOjF9LFNwcml0ZTp7fX0sT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcy5wYXJhbXMse1BvaW50Q2xvdWQ6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5SYXljYXN0ZXI6IHBhcmFtcy5Qb2ludENsb3VkIGhhcyBiZWVuIHJlbmFtZWQgdG8gcGFyYW1zLlBvaW50cy5cIiksdGhpcy5Qb2ludHN9fX0pfWZ1bmN0aW9uIGp1KHQsZSl7cmV0dXJuIHQuZGlzdGFuY2UtZS5kaXN0YW5jZX1mdW5jdGlvbiBIdSh0LGUsaSxuKXtpZih0LmxheWVycy50ZXN0KGUubGF5ZXJzKSYmdC5yYXljYXN0KGUsaSksITA9PT1uKXtjb25zdCBuPXQuY2hpbGRyZW47Zm9yKGxldCB0PTAscj1uLmxlbmd0aDt0PHI7dCsrKUh1KG5bdF0sZSxpLCEwKX19enUucHJvdG90eXBlPU9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZSh0Yy5wcm90b3R5cGUpLHtjb25zdHJ1Y3Rvcjp6dSxpc0luc3RhbmNlZEludGVybGVhdmVkQnVmZmVyOiEwLGNvcHk6ZnVuY3Rpb24odCl7cmV0dXJuIHRjLnByb3RvdHlwZS5jb3B5LmNhbGwodGhpcyx0KSx0aGlzLm1lc2hQZXJBdHRyaWJ1dGU9dC5tZXNoUGVyQXR0cmlidXRlLHRoaXN9LGNsb25lOmZ1bmN0aW9uKHQpe2NvbnN0IGU9dGMucHJvdG90eXBlLmNsb25lLmNhbGwodGhpcyx0KTtyZXR1cm4gZS5tZXNoUGVyQXR0cmlidXRlPXRoaXMubWVzaFBlckF0dHJpYnV0ZSxlfSx0b0pTT046ZnVuY3Rpb24odCl7Y29uc3QgZT10Yy5wcm90b3R5cGUudG9KU09OLmNhbGwodGhpcyx0KTtyZXR1cm4gZS5pc0luc3RhbmNlZEludGVybGVhdmVkQnVmZmVyPSEwLGUubWVzaFBlckF0dHJpYnV0ZT10aGlzLm1lc2hQZXJBdHRyaWJ1dGUsZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoRnUucHJvdG90eXBlLFwibmVlZHNVcGRhdGVcIix7c2V0OmZ1bmN0aW9uKHQpeyEwPT09dCYmdGhpcy52ZXJzaW9uKyt9fSksT2JqZWN0LmFzc2lnbihGdS5wcm90b3R5cGUse2lzR0xCdWZmZXJBdHRyaWJ1dGU6ITAsc2V0QnVmZmVyOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmJ1ZmZlcj10LHRoaXN9LHNldFR5cGU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy50eXBlPXQsdGhpcy5lbGVtZW50U2l6ZT1lLHRoaXN9LHNldEl0ZW1TaXplOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLml0ZW1TaXplPXQsdGhpc30sc2V0Q291bnQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY291bnQ9dCx0aGlzfX0pLE9iamVjdC5hc3NpZ24oQnUucHJvdG90eXBlLHtzZXQ6ZnVuY3Rpb24odCxlKXt0aGlzLnJheS5zZXQodCxlKX0sc2V0RnJvbUNhbWVyYTpmdW5jdGlvbih0LGUpe2UmJmUuaXNQZXJzcGVjdGl2ZUNhbWVyYT8odGhpcy5yYXkub3JpZ2luLnNldEZyb21NYXRyaXhQb3NpdGlvbihlLm1hdHJpeFdvcmxkKSx0aGlzLnJheS5kaXJlY3Rpb24uc2V0KHQueCx0LnksLjUpLnVucHJvamVjdChlKS5zdWIodGhpcy5yYXkub3JpZ2luKS5ub3JtYWxpemUoKSx0aGlzLmNhbWVyYT1lKTplJiZlLmlzT3J0aG9ncmFwaGljQ2FtZXJhPyh0aGlzLnJheS5vcmlnaW4uc2V0KHQueCx0LnksKGUubmVhcitlLmZhcikvKGUubmVhci1lLmZhcikpLnVucHJvamVjdChlKSx0aGlzLnJheS5kaXJlY3Rpb24uc2V0KDAsMCwtMSkudHJhbnNmb3JtRGlyZWN0aW9uKGUubWF0cml4V29ybGQpLHRoaXMuY2FtZXJhPWUpOmNvbnNvbGUuZXJyb3IoXCJUSFJFRS5SYXljYXN0ZXI6IFVuc3VwcG9ydGVkIGNhbWVyYSB0eXBlOiBcIitlLnR5cGUpfSxpbnRlcnNlY3RPYmplY3Q6ZnVuY3Rpb24odCxlLGkpe2NvbnN0IG49aXx8W107cmV0dXJuIEh1KHQsdGhpcyxuLGUpLG4uc29ydChqdSksbn0saW50ZXJzZWN0T2JqZWN0czpmdW5jdGlvbih0LGUsaSl7Y29uc3Qgbj1pfHxbXTtpZighMT09PUFycmF5LmlzQXJyYXkodCkpcmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlJheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzOiBvYmplY3RzIGlzIG5vdCBhbiBBcnJheS5cIiksbjtmb3IobGV0IGk9MCxyPXQubGVuZ3RoO2k8cjtpKyspSHUodFtpXSx0aGlzLG4sZSk7cmV0dXJuIG4uc29ydChqdSksbn19KTtjb25zdCBVdT1uZXcgcm47ZnVuY3Rpb24gVnUodCl7cHIuY2FsbCh0aGlzKSx0aGlzLm1hdGVyaWFsPXQsdGhpcy5yZW5kZXI9ZnVuY3Rpb24oKXt9LHRoaXMuaGFzUG9zaXRpb25zPSExLHRoaXMuaGFzTm9ybWFscz0hMSx0aGlzLmhhc0NvbG9ycz0hMSx0aGlzLmhhc1V2cz0hMSx0aGlzLnBvc2l0aW9uQXJyYXk9bnVsbCx0aGlzLm5vcm1hbEFycmF5PW51bGwsdGhpcy5jb2xvckFycmF5PW51bGwsdGhpcy51dkFycmF5PW51bGwsdGhpcy5jb3VudD0wfVZ1LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHByLnByb3RvdHlwZSksVnUucHJvdG90eXBlLmNvbnN0cnVjdG9yPVZ1LFZ1LnByb3RvdHlwZS5pc0ltbWVkaWF0ZVJlbmRlck9iamVjdD0hMDtjb25zdCBHdT1uZXcgRnIoe3NpZGU6MSxkZXB0aFdyaXRlOiExLGRlcHRoVGVzdDohMX0pO2Z1bmN0aW9uIHF1KHQpe2NvbnNvbGUud2FybihcIlRIUkVFLlNwbGluZSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgVEhSRUUuQ2F0bXVsbFJvbUN1cnZlMyBpbnN0ZWFkLlwiKSxQbC5jYWxsKHRoaXMsdCksdGhpcy50eXBlPVwiY2F0bXVsbHJvbVwifW5ldyBFcyhuZXcgQXMsR3UpLHdsLmNyZWF0ZT1mdW5jdGlvbih0LGUpe3JldHVybiBjb25zb2xlLmxvZyhcIlRIUkVFLkN1cnZlLmNyZWF0ZSgpIGhhcyBiZWVuIGRlcHJlY2F0ZWRcIiksdC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZSh3bC5wcm90b3R5cGUpLHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXQsdC5wcm90b3R5cGUuZ2V0UG9pbnQ9ZSx0fSxPYmplY3QuYXNzaWduKFVsLnByb3RvdHlwZSx7ZnJvbVBvaW50czpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuUGF0aDogLmZyb21Qb2ludHMoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5zZXRGcm9tUG9pbnRzKCkuXCIpLHRoaXMuc2V0RnJvbVBvaW50cyh0KX19KSxxdS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShQbC5wcm90b3R5cGUpLE9iamVjdC5hc3NpZ24ocXUucHJvdG90eXBlLHtpbml0RnJvbUFycmF5OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLlNwbGluZTogLmluaXRGcm9tQXJyYXkoKSBoYXMgYmVlbiByZW1vdmVkLlwiKX0sZ2V0Q29udHJvbFBvaW50c0FycmF5OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLlNwbGluZTogLmdldENvbnRyb2xQb2ludHNBcnJheSgpIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxyZXBhcmFtZXRyaXplQnlBcmNMZW5ndGg6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuU3BsaW5lOiAucmVwYXJhbWV0cml6ZUJ5QXJjTGVuZ3RoKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9fSksT2JqZWN0LmFzc2lnbihwbC5wcm90b3R5cGUse2V4dHJhY3RVcmxCYXNlOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5Mb2FkZXI6IC5leHRyYWN0VXJsQmFzZSgpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSBUSFJFRS5Mb2FkZXJVdGlscy5leHRyYWN0VXJsQmFzZSgpIGluc3RlYWQuXCIpLG91KHQpfX0pLHBsLkhhbmRsZXJzPXthZGQ6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuTG9hZGVyOiBIYW5kbGVycy5hZGQoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgTG9hZGluZ01hbmFnZXIuYWRkSGFuZGxlcigpIGluc3RlYWQuXCIpfSxnZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuTG9hZGVyOiBIYW5kbGVycy5nZXQoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgTG9hZGluZ01hbmFnZXIuZ2V0SGFuZGxlcigpIGluc3RlYWQuXCIpfX0sT2JqZWN0LmFzc2lnbihjbGFzc3tjb25zdHJ1Y3Rvcih0LGUpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLFwiaXNCb3gyXCIse3ZhbHVlOiEwfSksdGhpcy5taW49dm9pZCAwIT09dD90Om5ldyBybigxLzAsMS8wKSx0aGlzLm1heD12b2lkIDAhPT1lP2U6bmV3IHJuKC0xLzAsLTEvMCl9c2V0KHQsZSl7cmV0dXJuIHRoaXMubWluLmNvcHkodCksdGhpcy5tYXguY29weShlKSx0aGlzfXNldEZyb21Qb2ludHModCl7dGhpcy5tYWtlRW1wdHkoKTtmb3IobGV0IGU9MCxpPXQubGVuZ3RoO2U8aTtlKyspdGhpcy5leHBhbmRCeVBvaW50KHRbZV0pO3JldHVybiB0aGlzfXNldEZyb21DZW50ZXJBbmRTaXplKHQsZSl7Y29uc3QgaT1VdS5jb3B5KGUpLm11bHRpcGx5U2NhbGFyKC41KTtyZXR1cm4gdGhpcy5taW4uY29weSh0KS5zdWIoaSksdGhpcy5tYXguY29weSh0KS5hZGQoaSksdGhpc31jbG9uZSgpe3JldHVybihuZXcgdGhpcy5jb25zdHJ1Y3RvcikuY29weSh0aGlzKX1jb3B5KHQpe3JldHVybiB0aGlzLm1pbi5jb3B5KHQubWluKSx0aGlzLm1heC5jb3B5KHQubWF4KSx0aGlzfW1ha2VFbXB0eSgpe3JldHVybiB0aGlzLm1pbi54PXRoaXMubWluLnk9MS8wLHRoaXMubWF4Lng9dGhpcy5tYXgueT0tMS8wLHRoaXN9aXNFbXB0eSgpe3JldHVybiB0aGlzLm1heC54PHRoaXMubWluLnh8fHRoaXMubWF4Lnk8dGhpcy5taW4ueX1nZXRDZW50ZXIodCl7cmV0dXJuIHZvaWQgMD09PXQmJihjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gyOiAuZ2V0Q2VudGVyKCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSx0PW5ldyBybiksdGhpcy5pc0VtcHR5KCk/dC5zZXQoMCwwKTp0LmFkZFZlY3RvcnModGhpcy5taW4sdGhpcy5tYXgpLm11bHRpcGx5U2NhbGFyKC41KX1nZXRTaXplKHQpe3JldHVybiB2b2lkIDA9PT10JiYoY29uc29sZS53YXJuKFwiVEhSRUUuQm94MjogLmdldFNpemUoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkXCIpLHQ9bmV3IHJuKSx0aGlzLmlzRW1wdHkoKT90LnNldCgwLDApOnQuc3ViVmVjdG9ycyh0aGlzLm1heCx0aGlzLm1pbil9ZXhwYW5kQnlQb2ludCh0KXtyZXR1cm4gdGhpcy5taW4ubWluKHQpLHRoaXMubWF4Lm1heCh0KSx0aGlzfWV4cGFuZEJ5VmVjdG9yKHQpe3JldHVybiB0aGlzLm1pbi5zdWIodCksdGhpcy5tYXguYWRkKHQpLHRoaXN9ZXhwYW5kQnlTY2FsYXIodCl7cmV0dXJuIHRoaXMubWluLmFkZFNjYWxhcigtdCksdGhpcy5tYXguYWRkU2NhbGFyKHQpLHRoaXN9Y29udGFpbnNQb2ludCh0KXtyZXR1cm4hKHQueDx0aGlzLm1pbi54fHx0Lng+dGhpcy5tYXgueHx8dC55PHRoaXMubWluLnl8fHQueT50aGlzLm1heC55KX1jb250YWluc0JveCh0KXtyZXR1cm4gdGhpcy5taW4ueDw9dC5taW4ueCYmdC5tYXgueDw9dGhpcy5tYXgueCYmdGhpcy5taW4ueTw9dC5taW4ueSYmdC5tYXgueTw9dGhpcy5tYXgueX1nZXRQYXJhbWV0ZXIodCxlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGNvbnNvbGUud2FybihcIlRIUkVFLkJveDI6IC5nZXRQYXJhbWV0ZXIoKSB0YXJnZXQgaXMgbm93IHJlcXVpcmVkXCIpLGU9bmV3IHJuKSxlLnNldCgodC54LXRoaXMubWluLngpLyh0aGlzLm1heC54LXRoaXMubWluLngpLCh0LnktdGhpcy5taW4ueSkvKHRoaXMubWF4LnktdGhpcy5taW4ueSkpfWludGVyc2VjdHNCb3godCl7cmV0dXJuISh0Lm1heC54PHRoaXMubWluLnh8fHQubWluLng+dGhpcy5tYXgueHx8dC5tYXgueTx0aGlzLm1pbi55fHx0Lm1pbi55PnRoaXMubWF4LnkpfWNsYW1wUG9pbnQodCxlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGNvbnNvbGUud2FybihcIlRIUkVFLkJveDI6IC5jbGFtcFBvaW50KCkgdGFyZ2V0IGlzIG5vdyByZXF1aXJlZFwiKSxlPW5ldyBybiksZS5jb3B5KHQpLmNsYW1wKHRoaXMubWluLHRoaXMubWF4KX1kaXN0YW5jZVRvUG9pbnQodCl7cmV0dXJuIFV1LmNvcHkodCkuY2xhbXAodGhpcy5taW4sdGhpcy5tYXgpLnN1Yih0KS5sZW5ndGgoKX1pbnRlcnNlY3QodCl7cmV0dXJuIHRoaXMubWluLm1heCh0Lm1pbiksdGhpcy5tYXgubWluKHQubWF4KSx0aGlzfXVuaW9uKHQpe3JldHVybiB0aGlzLm1pbi5taW4odC5taW4pLHRoaXMubWF4Lm1heCh0Lm1heCksdGhpc310cmFuc2xhdGUodCl7cmV0dXJuIHRoaXMubWluLmFkZCh0KSx0aGlzLm1heC5hZGQodCksdGhpc31lcXVhbHModCl7cmV0dXJuIHQubWluLmVxdWFscyh0aGlzLm1pbikmJnQubWF4LmVxdWFscyh0aGlzLm1heCl9fS5wcm90b3R5cGUse2NlbnRlcjpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQm94MjogLmNlbnRlcigpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldENlbnRlcigpLlwiKSx0aGlzLmdldENlbnRlcih0KX0sZW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQm94MjogLmVtcHR5KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuaXNFbXB0eSgpLlwiKSx0aGlzLmlzRW1wdHkoKX0saXNJbnRlcnNlY3Rpb25Cb3g6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJveDI6IC5pc0ludGVyc2VjdGlvbkJveCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmludGVyc2VjdHNCb3goKS5cIiksdGhpcy5pbnRlcnNlY3RzQm94KHQpfSxzaXplOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gyOiAuc2l6ZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldFNpemUoKS5cIiksdGhpcy5nZXRTaXplKHQpfX0pLE9iamVjdC5hc3NpZ24oX24ucHJvdG90eXBlLHtjZW50ZXI6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJveDM6IC5jZW50ZXIoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRDZW50ZXIoKS5cIiksdGhpcy5nZXRDZW50ZXIodCl9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJveDM6IC5lbXB0eSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmlzRW1wdHkoKS5cIiksdGhpcy5pc0VtcHR5KCl9LGlzSW50ZXJzZWN0aW9uQm94OmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gzOiAuaXNJbnRlcnNlY3Rpb25Cb3goKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5pbnRlcnNlY3RzQm94KCkuXCIpLHRoaXMuaW50ZXJzZWN0c0JveCh0KX0saXNJbnRlcnNlY3Rpb25TcGhlcmU6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJveDM6IC5pc0ludGVyc2VjdGlvblNwaGVyZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmludGVyc2VjdHNTcGhlcmUoKS5cIiksdGhpcy5pbnRlcnNlY3RzU3BoZXJlKHQpfSxzaXplOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5Cb3gzOiAuc2l6ZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldFNpemUoKS5cIiksdGhpcy5nZXRTaXplKHQpfX0pLE9iamVjdC5hc3NpZ24oT24ucHJvdG90eXBlLHtlbXB0eTpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5TcGhlcmU6IC5lbXB0eSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmlzRW1wdHkoKS5cIiksdGhpcy5pc0VtcHR5KCl9fSksVXMucHJvdG90eXBlLnNldEZyb21NYXRyaXg9ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkZydXN0dW06IC5zZXRGcm9tTWF0cml4KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuc2V0RnJvbVByb2plY3Rpb25NYXRyaXgoKS5cIiksdGhpcy5zZXRGcm9tUHJvamVjdGlvbk1hdHJpeCh0KX0sT2JqZWN0LmFzc2lnbihubix7cmFuZG9tMTY6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuTWF0aDogLnJhbmRvbTE2KCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIE1hdGgucmFuZG9tKCkgaW5zdGVhZC5cIiksTWF0aC5yYW5kb20oKX0sbmVhcmVzdFBvd2VyT2ZUd286ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLk1hdGg6IC5uZWFyZXN0UG93ZXJPZlR3bygpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmZsb29yUG93ZXJPZlR3bygpLlwiKSxubi5mbG9vclBvd2VyT2ZUd28odCl9LG5leHRQb3dlck9mVHdvOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRoOiAubmV4dFBvd2VyT2ZUd28oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5jZWlsUG93ZXJPZlR3bygpLlwiKSxubi5jZWlsUG93ZXJPZlR3byh0KX19KSxPYmplY3QuYXNzaWduKHNuLnByb3RvdHlwZSx7ZmxhdHRlblRvQXJyYXlPZmZzZXQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuTWF0cml4MzogLmZsYXR0ZW5Ub0FycmF5T2Zmc2V0KCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC50b0FycmF5KCkgaW5zdGVhZC5cIiksdGhpcy50b0FycmF5KHQsZSl9LG11bHRpcGx5VmVjdG9yMzpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuTWF0cml4MzogLm11bHRpcGx5VmVjdG9yMygpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSB2ZWN0b3IuYXBwbHlNYXRyaXgzKCBtYXRyaXggKSBpbnN0ZWFkLlwiKSx0LmFwcGx5TWF0cml4Myh0aGlzKX0sbXVsdGlwbHlWZWN0b3IzQXJyYXk6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuTWF0cml4MzogLm11bHRpcGx5VmVjdG9yM0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LGFwcGx5VG9CdWZmZXJBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDM6IC5hcHBseVRvQnVmZmVyQXR0cmlidXRlKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIGF0dHJpYnV0ZS5hcHBseU1hdHJpeDMoIG1hdHJpeCApIGluc3RlYWQuXCIpLHQuYXBwbHlNYXRyaXgzKHRoaXMpfSxhcHBseVRvVmVjdG9yM0FycmF5OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDM6IC5hcHBseVRvVmVjdG9yM0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LGdldEludmVyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDM6IC5nZXRJbnZlcnNlKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG1hdHJpeEludi5jb3B5KCBtYXRyaXggKS5pbnZlcnQoKTsgaW5zdGVhZC5cIiksdGhpcy5jb3B5KHQpLmludmVydCgpfX0pLE9iamVjdC5hc3NpZ24oSG4ucHJvdG90eXBlLHtleHRyYWN0UG9zaXRpb246ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDQ6IC5leHRyYWN0UG9zaXRpb24oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5jb3B5UG9zaXRpb24oKS5cIiksdGhpcy5jb3B5UG9zaXRpb24odCl9LGZsYXR0ZW5Ub0FycmF5T2Zmc2V0OmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDQ6IC5mbGF0dGVuVG9BcnJheU9mZnNldCgpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAudG9BcnJheSgpIGluc3RlYWQuXCIpLHRoaXMudG9BcnJheSh0LGUpfSxnZXRQb3NpdGlvbjpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAuZ2V0UG9zaXRpb24oKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgVmVjdG9yMy5zZXRGcm9tTWF0cml4UG9zaXRpb24oIG1hdHJpeCApIGluc3RlYWQuXCIpLChuZXcgZm4pLnNldEZyb21NYXRyaXhDb2x1bW4odGhpcywzKX0sc2V0Um90YXRpb25Gcm9tUXVhdGVybmlvbjpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuTWF0cml4NDogLnNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYWtlUm90YXRpb25Gcm9tUXVhdGVybmlvbigpLlwiKSx0aGlzLm1ha2VSb3RhdGlvbkZyb21RdWF0ZXJuaW9uKHQpfSxtdWx0aXBseVRvQXJyYXk6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAubXVsdGlwbHlUb0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LG11bHRpcGx5VmVjdG9yMzpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuTWF0cml4NDogLm11bHRpcGx5VmVjdG9yMygpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSB2ZWN0b3IuYXBwbHlNYXRyaXg0KCBtYXRyaXggKSBpbnN0ZWFkLlwiKSx0LmFwcGx5TWF0cml4NCh0aGlzKX0sbXVsdGlwbHlWZWN0b3I0OmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAubXVsdGlwbHlWZWN0b3I0KCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHZlY3Rvci5hcHBseU1hdHJpeDQoIG1hdHJpeCApIGluc3RlYWQuXCIpLHQuYXBwbHlNYXRyaXg0KHRoaXMpfSxtdWx0aXBseVZlY3RvcjNBcnJheTpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5NYXRyaXg0OiAubXVsdGlwbHlWZWN0b3IzQXJyYXkoKSBoYXMgYmVlbiByZW1vdmVkLlwiKX0scm90YXRlQXhpczpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAucm90YXRlQXhpcygpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBWZWN0b3IzLnRyYW5zZm9ybURpcmVjdGlvbiggbWF0cml4ICkgaW5zdGVhZC5cIiksdC50cmFuc2Zvcm1EaXJlY3Rpb24odGhpcyl9LGNyb3NzVmVjdG9yOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAuY3Jvc3NWZWN0b3IoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgdmVjdG9yLmFwcGx5TWF0cml4NCggbWF0cml4ICkgaW5zdGVhZC5cIiksdC5hcHBseU1hdHJpeDQodGhpcyl9LHRyYW5zbGF0ZTpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5NYXRyaXg0OiAudHJhbnNsYXRlKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHJvdGF0ZVg6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuTWF0cml4NDogLnJvdGF0ZVgoKSBoYXMgYmVlbiByZW1vdmVkLlwiKX0scm90YXRlWTpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5NYXRyaXg0OiAucm90YXRlWSgpIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxyb3RhdGVaOmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDQ6IC5yb3RhdGVaKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHJvdGF0ZUJ5QXhpczpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5NYXRyaXg0OiAucm90YXRlQnlBeGlzKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LGFwcGx5VG9CdWZmZXJBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLk1hdHJpeDQ6IC5hcHBseVRvQnVmZmVyQXR0cmlidXRlKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIGF0dHJpYnV0ZS5hcHBseU1hdHJpeDQoIG1hdHJpeCApIGluc3RlYWQuXCIpLHQuYXBwbHlNYXRyaXg0KHRoaXMpfSxhcHBseVRvVmVjdG9yM0FycmF5OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLk1hdHJpeDQ6IC5hcHBseVRvVmVjdG9yM0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LG1ha2VGcnVzdHVtOmZ1bmN0aW9uKHQsZSxpLG4scixzKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuTWF0cml4NDogLm1ha2VGcnVzdHVtKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIC5tYWtlUGVyc3BlY3RpdmUoIGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSwgbmVhciwgZmFyICkgaW5zdGVhZC5cIiksdGhpcy5tYWtlUGVyc3BlY3RpdmUodCxlLG4saSxyLHMpfSxnZXRJbnZlcnNlOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRyaXg0OiAuZ2V0SW52ZXJzZSgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBtYXRyaXhJbnYuY29weSggbWF0cml4ICkuaW52ZXJ0KCk7IGluc3RlYWQuXCIpLHRoaXMuY29weSh0KS5pbnZlcnQoKX19KSxfci5wcm90b3R5cGUuaXNJbnRlcnNlY3Rpb25MaW5lPWZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5QbGFuZTogLmlzSW50ZXJzZWN0aW9uTGluZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmludGVyc2VjdHNMaW5lKCkuXCIpLHRoaXMuaW50ZXJzZWN0c0xpbmUodCl9LE9iamVjdC5hc3NpZ24ocG4ucHJvdG90eXBlLHttdWx0aXBseVZlY3RvcjM6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlF1YXRlcm5pb246IC5tdWx0aXBseVZlY3RvcjMoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgaXMgbm93IHZlY3Rvci5hcHBseVF1YXRlcm5pb24oIHF1YXRlcm5pb24gKSBpbnN0ZWFkLlwiKSx0LmFwcGx5UXVhdGVybmlvbih0aGlzKX0saW52ZXJzZTpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5RdWF0ZXJuaW9uOiAuaW52ZXJzZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gaW52ZXJ0KCkuXCIpLHRoaXMuaW52ZXJ0KCl9fSksT2JqZWN0LmFzc2lnbihqbi5wcm90b3R5cGUse2lzSW50ZXJzZWN0aW9uQm94OmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5SYXk6IC5pc0ludGVyc2VjdGlvbkJveCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmludGVyc2VjdHNCb3goKS5cIiksdGhpcy5pbnRlcnNlY3RzQm94KHQpfSxpc0ludGVyc2VjdGlvblBsYW5lOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5SYXk6IC5pc0ludGVyc2VjdGlvblBsYW5lKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuaW50ZXJzZWN0c1BsYW5lKCkuXCIpLHRoaXMuaW50ZXJzZWN0c1BsYW5lKHQpfSxpc0ludGVyc2VjdGlvblNwaGVyZTpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuUmF5OiAuaXNJbnRlcnNlY3Rpb25TcGhlcmUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5pbnRlcnNlY3RzU3BoZXJlKCkuXCIpLHRoaXMuaW50ZXJzZWN0c1NwaGVyZSh0KX19KSxPYmplY3QuYXNzaWduKElyLnByb3RvdHlwZSx7YXJlYTpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5UcmlhbmdsZTogLmFyZWEoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRBcmVhKCkuXCIpLHRoaXMuZ2V0QXJlYSgpfSxiYXJ5Y29vcmRGcm9tUG9pbnQ6ZnVuY3Rpb24odCxlKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVHJpYW5nbGU6IC5iYXJ5Y29vcmRGcm9tUG9pbnQoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRCYXJ5Y29vcmQoKS5cIiksdGhpcy5nZXRCYXJ5Y29vcmQodCxlKX0sbWlkcG9pbnQ6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlRyaWFuZ2xlOiAubWlkcG9pbnQoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5nZXRNaWRwb2ludCgpLlwiKSx0aGlzLmdldE1pZHBvaW50KHQpfSxub3JtYWw6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlRyaWFuZ2xlOiAubm9ybWFsKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZ2V0Tm9ybWFsKCkuXCIpLHRoaXMuZ2V0Tm9ybWFsKHQpfSxwbGFuZTpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVHJpYW5nbGU6IC5wbGFuZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldFBsYW5lKCkuXCIpLHRoaXMuZ2V0UGxhbmUodCl9fSksT2JqZWN0LmFzc2lnbihJcix7YmFyeWNvb3JkRnJvbVBvaW50OmZ1bmN0aW9uKHQsZSxpLG4scil7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlRyaWFuZ2xlOiAuYmFyeWNvb3JkRnJvbVBvaW50KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZ2V0QmFyeWNvb3JkKCkuXCIpLElyLmdldEJhcnljb29yZCh0LGUsaSxuLHIpfSxub3JtYWw6ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlRyaWFuZ2xlOiAubm9ybWFsKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZ2V0Tm9ybWFsKCkuXCIpLElyLmdldE5vcm1hbCh0LGUsaSxuKX19KSxPYmplY3QuYXNzaWduKFZsLnByb3RvdHlwZSx7ZXh0cmFjdEFsbFBvaW50czpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuU2hhcGU6IC5leHRyYWN0QWxsUG9pbnRzKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIC5leHRyYWN0UG9pbnRzKCkgaW5zdGVhZC5cIiksdGhpcy5leHRyYWN0UG9pbnRzKHQpfSxleHRydWRlOmZ1bmN0aW9uKHQpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5TaGFwZTogLmV4dHJ1ZGUoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgRXh0cnVkZUdlb21ldHJ5KCkgaW5zdGVhZC5cIiksbmV3IE5oKHRoaXMsdCl9LG1ha2VHZW9tZXRyeTpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuU2hhcGU6IC5tYWtlR2VvbWV0cnkoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgU2hhcGVHZW9tZXRyeSgpIGluc3RlYWQuXCIpLG5ldyBraCh0aGlzLHQpfX0pLE9iamVjdC5hc3NpZ24ocm4ucHJvdG90eXBlLHtmcm9tQXR0cmlidXRlOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMjogLmZyb21BdHRyaWJ1dGUoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5mcm9tQnVmZmVyQXR0cmlidXRlKCkuXCIpLHRoaXMuZnJvbUJ1ZmZlckF0dHJpYnV0ZSh0LGUsaSl9LGRpc3RhbmNlVG9NYW5oYXR0YW46ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjI6IC5kaXN0YW5jZVRvTWFuaGF0dGFuKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAubWFuaGF0dGFuRGlzdGFuY2VUbygpLlwiKSx0aGlzLm1hbmhhdHRhbkRpc3RhbmNlVG8odCl9LGxlbmd0aE1hbmhhdHRhbjpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3IyOiAubGVuZ3RoTWFuaGF0dGFuKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAubWFuaGF0dGFuTGVuZ3RoKCkuXCIpLHRoaXMubWFuaGF0dGFuTGVuZ3RoKCl9fSksT2JqZWN0LmFzc2lnbihmbi5wcm90b3R5cGUse3NldEV1bGVyRnJvbVJvdGF0aW9uTWF0cml4OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLlZlY3RvcjM6IC5zZXRFdWxlckZyb21Sb3RhdGlvbk1hdHJpeCgpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBFdWxlci5zZXRGcm9tUm90YXRpb25NYXRyaXgoKSBpbnN0ZWFkLlwiKX0sc2V0RXVsZXJGcm9tUXVhdGVybmlvbjpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5WZWN0b3IzOiAuc2V0RXVsZXJGcm9tUXVhdGVybmlvbigpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBFdWxlci5zZXRGcm9tUXVhdGVybmlvbigpIGluc3RlYWQuXCIpfSxnZXRQb3NpdGlvbkZyb21NYXRyaXg6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjM6IC5nZXRQb3NpdGlvbkZyb21NYXRyaXgoKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5zZXRGcm9tTWF0cml4UG9zaXRpb24oKS5cIiksdGhpcy5zZXRGcm9tTWF0cml4UG9zaXRpb24odCl9LGdldFNjYWxlRnJvbU1hdHJpeDpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogLmdldFNjYWxlRnJvbU1hdHJpeCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnNldEZyb21NYXRyaXhTY2FsZSgpLlwiKSx0aGlzLnNldEZyb21NYXRyaXhTY2FsZSh0KX0sZ2V0Q29sdW1uRnJvbU1hdHJpeDpmdW5jdGlvbih0LGUpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3IzOiAuZ2V0Q29sdW1uRnJvbU1hdHJpeCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnNldEZyb21NYXRyaXhDb2x1bW4oKS5cIiksdGhpcy5zZXRGcm9tTWF0cml4Q29sdW1uKGUsdCl9LGFwcGx5UHJvamVjdGlvbjpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogLmFwcGx5UHJvamVjdGlvbigpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAuYXBwbHlNYXRyaXg0KCBtICkgaW5zdGVhZC5cIiksdGhpcy5hcHBseU1hdHJpeDQodCl9LGZyb21BdHRyaWJ1dGU6ZnVuY3Rpb24odCxlLGkpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5WZWN0b3IzOiAuZnJvbUF0dHJpYnV0ZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmZyb21CdWZmZXJBdHRyaWJ1dGUoKS5cIiksdGhpcy5mcm9tQnVmZmVyQXR0cmlidXRlKHQsZSxpKX0sZGlzdGFuY2VUb01hbmhhdHRhbjpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yMzogLmRpc3RhbmNlVG9NYW5oYXR0YW4oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYW5oYXR0YW5EaXN0YW5jZVRvKCkuXCIpLHRoaXMubWFuaGF0dGFuRGlzdGFuY2VUbyh0KX0sbGVuZ3RoTWFuaGF0dGFuOmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjM6IC5sZW5ndGhNYW5oYXR0YW4oKSBoYXMgYmVlbiByZW5hbWVkIHRvIC5tYW5oYXR0YW5MZW5ndGgoKS5cIiksdGhpcy5tYW5oYXR0YW5MZW5ndGgoKX19KSxPYmplY3QuYXNzaWduKHVuLnByb3RvdHlwZSx7ZnJvbUF0dHJpYnV0ZTpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLlZlY3RvcjQ6IC5mcm9tQXR0cmlidXRlKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZnJvbUJ1ZmZlckF0dHJpYnV0ZSgpLlwiKSx0aGlzLmZyb21CdWZmZXJBdHRyaWJ1dGUodCxlLGkpfSxsZW5ndGhNYW5oYXR0YW46ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVmVjdG9yNDogLmxlbmd0aE1hbmhhdHRhbigpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLm1hbmhhdHRhbkxlbmd0aCgpLlwiKSx0aGlzLm1hbmhhdHRhbkxlbmd0aCgpfX0pLE9iamVjdC5hc3NpZ24ocHIucHJvdG90eXBlLHtnZXRDaGlsZEJ5TmFtZTpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuT2JqZWN0M0Q6IC5nZXRDaGlsZEJ5TmFtZSgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmdldE9iamVjdEJ5TmFtZSgpLlwiKSx0aGlzLmdldE9iamVjdEJ5TmFtZSh0KX0scmVuZGVyRGVwdGg6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5PYmplY3QzRDogLnJlbmRlckRlcHRoIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAucmVuZGVyT3JkZXIsIGluc3RlYWQuXCIpfSx0cmFuc2xhdGU6ZnVuY3Rpb24odCxlKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuT2JqZWN0M0Q6IC50cmFuc2xhdGUoKSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLnRyYW5zbGF0ZU9uQXhpcyggYXhpcywgZGlzdGFuY2UgKSBpbnN0ZWFkLlwiKSx0aGlzLnRyYW5zbGF0ZU9uQXhpcyhlLHQpfSxnZXRXb3JsZFJvdGF0aW9uOmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLk9iamVjdDNEOiAuZ2V0V29ybGRSb3RhdGlvbigpIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBUSFJFRS5PYmplY3QzRC5nZXRXb3JsZFF1YXRlcm5pb24oIHRhcmdldCApIGluc3RlYWQuXCIpfSxhcHBseU1hdHJpeDpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuT2JqZWN0M0Q6IC5hcHBseU1hdHJpeCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmFwcGx5TWF0cml4NCgpLlwiKSx0aGlzLmFwcGx5TWF0cml4NCh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhwci5wcm90b3R5cGUse2V1bGVyT3JkZXI6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5PYmplY3QzRDogLmV1bGVyT3JkZXIgaXMgbm93IC5yb3RhdGlvbi5vcmRlci5cIiksdGhpcy5yb3RhdGlvbi5vcmRlcn0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLk9iamVjdDNEOiAuZXVsZXJPcmRlciBpcyBub3cgLnJvdGF0aW9uLm9yZGVyLlwiKSx0aGlzLnJvdGF0aW9uLm9yZGVyPXR9fSx1c2VRdWF0ZXJuaW9uOntnZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5PYmplY3QzRDogLnVzZVF1YXRlcm5pb24gaGFzIGJlZW4gcmVtb3ZlZC4gVGhlIGxpYnJhcnkgbm93IHVzZXMgcXVhdGVybmlvbnMgYnkgZGVmYXVsdC5cIil9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLk9iamVjdDNEOiAudXNlUXVhdGVybmlvbiBoYXMgYmVlbiByZW1vdmVkLiBUaGUgbGlicmFyeSBub3cgdXNlcyBxdWF0ZXJuaW9ucyBieSBkZWZhdWx0LlwiKX19fSksT2JqZWN0LmFzc2lnbihFcy5wcm90b3R5cGUse3NldERyYXdNb2RlOmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLk1lc2g6IC5zZXREcmF3TW9kZSgpIGhhcyBiZWVuIHJlbW92ZWQuIFRoZSByZW5kZXJlciBub3cgYWx3YXlzIGFzc3VtZXMgVEhSRUUuVHJpYW5nbGVzRHJhd01vZGUuIFRyYW5zZm9ybSB5b3VyIGdlb21ldHJ5IHZpYSBCdWZmZXJHZW9tZXRyeVV0aWxzLnRvVHJpYW5nbGVzRHJhd01vZGUoKSBpZiBuZWNlc3NhcnkuXCIpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEVzLnByb3RvdHlwZSx7ZHJhd01vZGU6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLmVycm9yKFwiVEhSRUUuTWVzaDogLmRyYXdNb2RlIGhhcyBiZWVuIHJlbW92ZWQuIFRoZSByZW5kZXJlciBub3cgYWx3YXlzIGFzc3VtZXMgVEhSRUUuVHJpYW5nbGVzRHJhd01vZGUuXCIpLDB9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5NZXNoOiAuZHJhd01vZGUgaGFzIGJlZW4gcmVtb3ZlZC4gVGhlIHJlbmRlcmVyIG5vdyBhbHdheXMgYXNzdW1lcyBUSFJFRS5UcmlhbmdsZXNEcmF3TW9kZS4gVHJhbnNmb3JtIHlvdXIgZ2VvbWV0cnkgdmlhIEJ1ZmZlckdlb21ldHJ5VXRpbHMudG9UcmlhbmdsZXNEcmF3TW9kZSgpIGlmIG5lY2Vzc2FyeS5cIil9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHhjLnByb3RvdHlwZSx7b2JqZWN0czp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkxPRDogLm9iamVjdHMgaGFzIGJlZW4gcmVuYW1lZCB0byAubGV2ZWxzLlwiKSx0aGlzLmxldmVsc319fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KFJjLnByb3RvdHlwZSxcInVzZVZlcnRleFRleHR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuU2tlbGV0b246IHVzZVZlcnRleFRleHR1cmUgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLlNrZWxldG9uOiB1c2VWZXJ0ZXhUZXh0dXJlIGhhcyBiZWVuIHJlbW92ZWQuXCIpfX0pLEVjLnByb3RvdHlwZS5pbml0Qm9uZXM9ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuU2tpbm5lZE1lc2g6IGluaXRCb25lcygpIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkod2wucHJvdG90eXBlLFwiX19hcmNMZW5ndGhEaXZpc2lvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkN1cnZlOiAuX19hcmNMZW5ndGhEaXZpc2lvbnMgaXMgbm93IC5hcmNMZW5ndGhEaXZpc2lvbnMuXCIpLHRoaXMuYXJjTGVuZ3RoRGl2aXNpb25zfSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuQ3VydmU6IC5fX2FyY0xlbmd0aERpdmlzaW9ucyBpcyBub3cgLmFyY0xlbmd0aERpdmlzaW9ucy5cIiksdGhpcy5hcmNMZW5ndGhEaXZpc2lvbnM9dH19KSxEcy5wcm90b3R5cGUuc2V0TGVucz1mdW5jdGlvbih0LGUpe2NvbnNvbGUud2FybihcIlRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhLnNldExlbnMgaXMgZGVwcmVjYXRlZC4gVXNlIC5zZXRGb2NhbExlbmd0aCBhbmQgLmZpbG1HYXVnZSBmb3IgYSBwaG90b2dyYXBoaWMgc2V0dXAuXCIpLHZvaWQgMCE9PWUmJih0aGlzLmZpbG1HYXVnZT1lKSx0aGlzLnNldEZvY2FsTGVuZ3RoKHQpfSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhHbC5wcm90b3R5cGUse29ubHlTaGFkb3c6e3NldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAub25seVNoYWRvdyBoYXMgYmVlbiByZW1vdmVkLlwiKX19LHNoYWRvd0NhbWVyYUZvdjp7c2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhRm92IGlzIG5vdyAuc2hhZG93LmNhbWVyYS5mb3YuXCIpLHRoaXMuc2hhZG93LmNhbWVyYS5mb3Y9dH19LHNoYWRvd0NhbWVyYUxlZnQ6e3NldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYUxlZnQgaXMgbm93IC5zaGFkb3cuY2FtZXJhLmxlZnQuXCIpLHRoaXMuc2hhZG93LmNhbWVyYS5sZWZ0PXR9fSxzaGFkb3dDYW1lcmFSaWdodDp7c2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhUmlnaHQgaXMgbm93IC5zaGFkb3cuY2FtZXJhLnJpZ2h0LlwiKSx0aGlzLnNoYWRvdy5jYW1lcmEucmlnaHQ9dH19LHNoYWRvd0NhbWVyYVRvcDp7c2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhVG9wIGlzIG5vdyAuc2hhZG93LmNhbWVyYS50b3AuXCIpLHRoaXMuc2hhZG93LmNhbWVyYS50b3A9dH19LHNoYWRvd0NhbWVyYUJvdHRvbTp7c2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAuc2hhZG93Q2FtZXJhQm90dG9tIGlzIG5vdyAuc2hhZG93LmNhbWVyYS5ib3R0b20uXCIpLHRoaXMuc2hhZG93LmNhbWVyYS5ib3R0b209dH19LHNoYWRvd0NhbWVyYU5lYXI6e3NldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYU5lYXIgaXMgbm93IC5zaGFkb3cuY2FtZXJhLm5lYXIuXCIpLHRoaXMuc2hhZG93LmNhbWVyYS5uZWFyPXR9fSxzaGFkb3dDYW1lcmFGYXI6e3NldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYUZhciBpcyBub3cgLnNoYWRvdy5jYW1lcmEuZmFyLlwiKSx0aGlzLnNoYWRvdy5jYW1lcmEuZmFyPXR9fSxzaGFkb3dDYW1lcmFWaXNpYmxlOntzZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5MaWdodDogLnNoYWRvd0NhbWVyYVZpc2libGUgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG5ldyBUSFJFRS5DYW1lcmFIZWxwZXIoIGxpZ2h0LnNoYWRvdy5jYW1lcmEgKSBpbnN0ZWFkLlwiKX19LHNoYWRvd0JpYXM6e3NldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5MaWdodDogLnNoYWRvd0JpYXMgaXMgbm93IC5zaGFkb3cuYmlhcy5cIiksdGhpcy5zaGFkb3cuYmlhcz10fX0sc2hhZG93RGFya25lc3M6e3NldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAuc2hhZG93RGFya25lc3MgaGFzIGJlZW4gcmVtb3ZlZC5cIil9fSxzaGFkb3dNYXBXaWR0aDp7c2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLkxpZ2h0OiAuc2hhZG93TWFwV2lkdGggaXMgbm93IC5zaGFkb3cubWFwU2l6ZS53aWR0aC5cIiksdGhpcy5zaGFkb3cubWFwU2l6ZS53aWR0aD10fX0sc2hhZG93TWFwSGVpZ2h0OntzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuTGlnaHQ6IC5zaGFkb3dNYXBIZWlnaHQgaXMgbm93IC5zaGFkb3cubWFwU2l6ZS5oZWlnaHQuXCIpLHRoaXMuc2hhZG93Lm1hcFNpemUuaGVpZ2h0PXR9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEhyLnByb3RvdHlwZSx7bGVuZ3RoOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAubGVuZ3RoIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuY291bnQgaW5zdGVhZC5cIiksdGhpcy5hcnJheS5sZW5ndGh9fSxkeW5hbWljOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAuZHluYW1pYyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnVzYWdlIGluc3RlYWQuXCIpLHRoaXMudXNhZ2U9PT1KaX0sc2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAuZHluYW1pYyBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnVzYWdlIGluc3RlYWQuXCIpLHRoaXMuc2V0VXNhZ2UoSmkpfX19KSxPYmplY3QuYXNzaWduKEhyLnByb3RvdHlwZSx7c2V0RHluYW1pYzpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyQXR0cmlidXRlOiAuc2V0RHluYW1pYygpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuc2V0VXNhZ2UoKSBpbnN0ZWFkLlwiKSx0aGlzLnNldFVzYWdlKCEwPT09dD9KaTpaaSksdGhpc30sY29weUluZGljZXNBcnJheTpmdW5jdGlvbigpe2NvbnNvbGUuZXJyb3IoXCJUSFJFRS5CdWZmZXJBdHRyaWJ1dGU6IC5jb3B5SW5kaWNlc0FycmF5KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHNldEFycmF5OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLkJ1ZmZlckF0dHJpYnV0ZTogLnNldEFycmF5IGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBCdWZmZXJHZW9tZXRyeSAuc2V0QXR0cmlidXRlIHRvIHJlcGxhY2UvcmVzaXplIGF0dHJpYnV0ZSBidWZmZXJzXCIpfX0pLE9iamVjdC5hc3NpZ24oaHMucHJvdG90eXBlLHthZGRJbmRleDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmFkZEluZGV4KCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuc2V0SW5kZXgoKS5cIiksdGhpcy5zZXRJbmRleCh0KX0sYWRkQXR0cmlidXRlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuYWRkQXR0cmlidXRlKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuc2V0QXR0cmlidXRlKCkuXCIpLGUmJmUuaXNCdWZmZXJBdHRyaWJ1dGV8fGUmJmUuaXNJbnRlcmxlYXZlZEJ1ZmZlckF0dHJpYnV0ZT9cImluZGV4XCI9PT10Pyhjb25zb2xlLndhcm4oXCJUSFJFRS5CdWZmZXJHZW9tZXRyeS5hZGRBdHRyaWJ1dGU6IFVzZSAuc2V0SW5kZXgoKSBmb3IgaW5kZXggYXR0cmlidXRlLlwiKSx0aGlzLnNldEluZGV4KGUpLHRoaXMpOnRoaXMuc2V0QXR0cmlidXRlKHQsZSk6KGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuYWRkQXR0cmlidXRlKCkgbm93IGV4cGVjdHMgKCBuYW1lLCBhdHRyaWJ1dGUgKS5cIiksdGhpcy5zZXRBdHRyaWJ1dGUodCxuZXcgSHIoYXJndW1lbnRzWzFdLGFyZ3VtZW50c1syXSkpKX0sYWRkRHJhd0NhbGw6ZnVuY3Rpb24odCxlLGkpe3ZvaWQgMCE9PWkmJmNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuYWRkRHJhd0NhbGwoKSBubyBsb25nZXIgc3VwcG9ydHMgaW5kZXhPZmZzZXQuXCIpLGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAuYWRkRHJhd0NhbGwoKSBpcyBub3cgLmFkZEdyb3VwKCkuXCIpLHRoaXMuYWRkR3JvdXAodCxlKX0sY2xlYXJEcmF3Q2FsbHM6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmNsZWFyRHJhd0NhbGxzKCkgaXMgbm93IC5jbGVhckdyb3VwcygpLlwiKSx0aGlzLmNsZWFyR3JvdXBzKCl9LGNvbXB1dGVPZmZzZXRzOmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyR2VvbWV0cnk6IC5jb21wdXRlT2Zmc2V0cygpIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxyZW1vdmVBdHRyaWJ1dGU6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAucmVtb3ZlQXR0cmlidXRlKCkgaGFzIGJlZW4gcmVuYW1lZCB0byAuZGVsZXRlQXR0cmlidXRlKCkuXCIpLHRoaXMuZGVsZXRlQXR0cmlidXRlKHQpfSxhcHBseU1hdHJpeDpmdW5jdGlvbih0KXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQnVmZmVyR2VvbWV0cnk6IC5hcHBseU1hdHJpeCgpIGhhcyBiZWVuIHJlbmFtZWQgdG8gLmFwcGx5TWF0cml4NCgpLlwiKSx0aGlzLmFwcGx5TWF0cml4NCh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhocy5wcm90b3R5cGUse2RyYXdjYWxsczp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUuZXJyb3IoXCJUSFJFRS5CdWZmZXJHZW9tZXRyeTogLmRyYXdjYWxscyBoYXMgYmVlbiByZW5hbWVkIHRvIC5ncm91cHMuXCIpLHRoaXMuZ3JvdXBzfX0sb2Zmc2V0czp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkJ1ZmZlckdlb21ldHJ5OiAub2Zmc2V0cyBoYXMgYmVlbiByZW5hbWVkIHRvIC5ncm91cHMuXCIpLHRoaXMuZ3JvdXBzfX19KSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhhdS5wcm90b3R5cGUse21heEluc3RhbmNlZENvdW50OntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuSW5zdGFuY2VkQnVmZmVyR2VvbWV0cnk6IC5tYXhJbnN0YW5jZWRDb3VudCBoYXMgYmVlbiByZW5hbWVkIHRvIC5pbnN0YW5jZUNvdW50LlwiKSx0aGlzLmluc3RhbmNlQ291bnR9LHNldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5JbnN0YW5jZWRCdWZmZXJHZW9tZXRyeTogLm1heEluc3RhbmNlZENvdW50IGhhcyBiZWVuIHJlbmFtZWQgdG8gLmluc3RhbmNlQ291bnQuXCIpLHRoaXMuaW5zdGFuY2VDb3VudD10fX19KSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhCdS5wcm90b3R5cGUse2xpbmVQcmVjaXNpb246e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5SYXljYXN0ZXI6IC5saW5lUHJlY2lzaW9uIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAucGFyYW1zLkxpbmUudGhyZXNob2xkIGluc3RlYWQuXCIpLHRoaXMucGFyYW1zLkxpbmUudGhyZXNob2xkfSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuUmF5Y2FzdGVyOiAubGluZVByZWNpc2lvbiBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnBhcmFtcy5MaW5lLnRocmVzaG9sZCBpbnN0ZWFkLlwiKSx0aGlzLnBhcmFtcy5MaW5lLnRocmVzaG9sZD10fX19KSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0Yy5wcm90b3R5cGUse2R5bmFtaWM6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5JbnRlcmxlYXZlZEJ1ZmZlcjogLmxlbmd0aCBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgLnVzYWdlIGluc3RlYWQuXCIpLHRoaXMudXNhZ2U9PT1KaX0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLkludGVybGVhdmVkQnVmZmVyOiAubGVuZ3RoIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAudXNhZ2UgaW5zdGVhZC5cIiksdGhpcy5zZXRVc2FnZSh0KX19fSksT2JqZWN0LmFzc2lnbih0Yy5wcm90b3R5cGUse3NldER5bmFtaWM6ZnVuY3Rpb24odCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLkludGVybGVhdmVkQnVmZmVyOiAuc2V0RHluYW1pYygpIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSAuc2V0VXNhZ2UoKSBpbnN0ZWFkLlwiKSx0aGlzLnNldFVzYWdlKCEwPT09dD9KaTpaaSksdGhpc30sc2V0QXJyYXk6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuSW50ZXJsZWF2ZWRCdWZmZXI6IC5zZXRBcnJheSBoYXMgYmVlbiByZW1vdmVkLiBVc2UgQnVmZmVyR2VvbWV0cnkgLnNldEF0dHJpYnV0ZSB0byByZXBsYWNlL3Jlc2l6ZSBhdHRyaWJ1dGUgYnVmZmVyc1wiKX19KSxPYmplY3QuYXNzaWduKE5oLnByb3RvdHlwZSx7Z2V0QXJyYXlzOmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLkV4dHJ1ZGVHZW9tZXRyeTogLmdldEFycmF5cygpIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxhZGRTaGFwZUxpc3Q6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuRXh0cnVkZUdlb21ldHJ5OiAuYWRkU2hhcGVMaXN0KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LGFkZFNoYXBlOmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLkV4dHJ1ZGVHZW9tZXRyeTogLmFkZFNoYXBlKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9fSksT2JqZWN0LmFzc2lnbihRYS5wcm90b3R5cGUse2Rpc3Bvc2U6ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuU2NlbmU6IC5kaXNwb3NlKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9fSksT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoa3UucHJvdG90eXBlLHtkeW5hbWljOntzZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5Vbmlmb3JtOiAuZHluYW1pYyBoYXMgYmVlbiByZW1vdmVkLiBVc2Ugb2JqZWN0Lm9uQmVmb3JlUmVuZGVyKCkgaW5zdGVhZC5cIil9fSxvblVwZGF0ZTp7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuVW5pZm9ybTogLm9uVXBkYXRlKCkgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIG9iamVjdC5vbkJlZm9yZVJlbmRlcigpIGluc3RlYWQuXCIpLHRoaXN9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHpyLnByb3RvdHlwZSx7d3JhcEFyb3VuZDp7Z2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuTWF0ZXJpYWw6IC53cmFwQXJvdW5kIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxzZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRlcmlhbDogLndyYXBBcm91bmQgaGFzIGJlZW4gcmVtb3ZlZC5cIil9fSxvdmVyZHJhdzp7Z2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuTWF0ZXJpYWw6IC5vdmVyZHJhdyBoYXMgYmVlbiByZW1vdmVkLlwiKX0sc2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuTWF0ZXJpYWw6IC5vdmVyZHJhdyBoYXMgYmVlbiByZW1vdmVkLlwiKX19LHdyYXBSR0I6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NYXRlcmlhbDogLndyYXBSR0IgaGFzIGJlZW4gcmVtb3ZlZC5cIiksbmV3IERyfX0sc2hhZGluZzp7Z2V0OmZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLlwiK3RoaXMudHlwZStcIjogLnNoYWRpbmcgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHRoZSBib29sZWFuIC5mbGF0U2hhZGluZyBpbnN0ZWFkLlwiKX0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLlwiK3RoaXMudHlwZStcIjogLnNoYWRpbmcgaGFzIGJlZW4gcmVtb3ZlZC4gVXNlIHRoZSBib29sZWFuIC5mbGF0U2hhZGluZyBpbnN0ZWFkLlwiKSx0aGlzLmZsYXRTaGFkaW5nPTE9PT10fX0sc3RlbmNpbE1hc2s6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5cIit0aGlzLnR5cGUrXCI6IC5zdGVuY2lsTWFzayBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLnN0ZW5jaWxGdW5jTWFzayBpbnN0ZWFkLlwiKSx0aGlzLnN0ZW5jaWxGdW5jTWFza30sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLlwiK3RoaXMudHlwZStcIjogLnN0ZW5jaWxNYXNrIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSAuc3RlbmNpbEZ1bmNNYXNrIGluc3RlYWQuXCIpLHRoaXMuc3RlbmNpbEZ1bmNNYXNrPXR9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFVoLnByb3RvdHlwZSx7bWV0YWw6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbDogLm1ldGFsIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCBpbnN0ZWFkLlwiKSwhMX0sc2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuTWVzaFBob25nTWF0ZXJpYWw6IC5tZXRhbCBoYXMgYmVlbiByZW1vdmVkLiBVc2UgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwgaW5zdGVhZFwiKX19fSksT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoSGgucHJvdG90eXBlLHt0cmFuc3BhcmVuY3k6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5NZXNoUGh5c2ljYWxNYXRlcmlhbDogLnRyYW5zcGFyZW5jeSBoYXMgYmVlbiByZW5hbWVkIHRvIC50cmFuc21pc3Npb24uXCIpLHRoaXMudHJhbnNtaXNzaW9ufSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuTWVzaFBoeXNpY2FsTWF0ZXJpYWw6IC50cmFuc3BhcmVuY3kgaGFzIGJlZW4gcmVuYW1lZCB0byAudHJhbnNtaXNzaW9uLlwiKSx0aGlzLnRyYW5zbWlzc2lvbj10fX19KSxPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPcy5wcm90b3R5cGUse2Rlcml2YXRpdmVzOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuU2hhZGVyTWF0ZXJpYWw6IC5kZXJpdmF0aXZlcyBoYXMgYmVlbiBtb3ZlZCB0byAuZXh0ZW5zaW9ucy5kZXJpdmF0aXZlcy5cIiksdGhpcy5leHRlbnNpb25zLmRlcml2YXRpdmVzfSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuIFNoYWRlck1hdGVyaWFsOiAuZGVyaXZhdGl2ZXMgaGFzIGJlZW4gbW92ZWQgdG8gLmV4dGVuc2lvbnMuZGVyaXZhdGl2ZXMuXCIpLHRoaXMuZXh0ZW5zaW9ucy5kZXJpdmF0aXZlcz10fX19KSxPYmplY3QuYXNzaWduKEphLnByb3RvdHlwZSx7Y2xlYXJUYXJnZXQ6ZnVuY3Rpb24odCxlLGksbil7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmNsZWFyVGFyZ2V0KCkgaGFzIGJlZW4gZGVwcmVjYXRlZC4gVXNlIC5zZXRSZW5kZXJUYXJnZXQoKSBhbmQgLmNsZWFyKCkgaW5zdGVhZC5cIiksdGhpcy5zZXRSZW5kZXJUYXJnZXQodCksdGhpcy5jbGVhcihlLGksbil9LGFuaW1hdGU6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmFuaW1hdGUoKSBpcyBub3cgLnNldEFuaW1hdGlvbkxvb3AoKS5cIiksdGhpcy5zZXRBbmltYXRpb25Mb29wKHQpfSxnZXRDdXJyZW50UmVuZGVyVGFyZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5nZXRDdXJyZW50UmVuZGVyVGFyZ2V0KCkgaXMgbm93IC5nZXRSZW5kZXJUYXJnZXQoKS5cIiksdGhpcy5nZXRSZW5kZXJUYXJnZXQoKX0sZ2V0TWF4QW5pc290cm9weTpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuZ2V0TWF4QW5pc290cm9weSgpIGlzIG5vdyAuY2FwYWJpbGl0aWVzLmdldE1heEFuaXNvdHJvcHkoKS5cIiksdGhpcy5jYXBhYmlsaXRpZXMuZ2V0TWF4QW5pc290cm9weSgpfSxnZXRQcmVjaXNpb246ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdldFByZWNpc2lvbigpIGlzIG5vdyAuY2FwYWJpbGl0aWVzLnByZWNpc2lvbi5cIiksdGhpcy5jYXBhYmlsaXRpZXMucHJlY2lzaW9ufSxyZXNldEdMU3RhdGU6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnJlc2V0R0xTdGF0ZSgpIGlzIG5vdyAuc3RhdGUucmVzZXQoKS5cIiksdGhpcy5zdGF0ZS5yZXNldCgpfSxzdXBwb3J0c0Zsb2F0VGV4dHVyZXM6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzRmxvYXRUZXh0dXJlcygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdPRVNfdGV4dHVyZV9mbG9hdCcgKS5cIiksdGhpcy5leHRlbnNpb25zLmdldChcIk9FU190ZXh0dXJlX2Zsb2F0XCIpfSxzdXBwb3J0c0hhbGZGbG9hdFRleHR1cmVzOmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zdXBwb3J0c0hhbGZGbG9hdFRleHR1cmVzKCkgaXMgbm93IC5leHRlbnNpb25zLmdldCggJ09FU190ZXh0dXJlX2hhbGZfZmxvYXQnICkuXCIpLHRoaXMuZXh0ZW5zaW9ucy5nZXQoXCJPRVNfdGV4dHVyZV9oYWxmX2Zsb2F0XCIpfSxzdXBwb3J0c1N0YW5kYXJkRGVyaXZhdGl2ZXM6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzU3RhbmRhcmREZXJpdmF0aXZlcygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMnICkuXCIpLHRoaXMuZXh0ZW5zaW9ucy5nZXQoXCJPRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXNcIil9LHN1cHBvcnRzQ29tcHJlc3NlZFRleHR1cmVTM1RDOmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zdXBwb3J0c0NvbXByZXNzZWRUZXh0dXJlUzNUQygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfczN0YycgKS5cIiksdGhpcy5leHRlbnNpb25zLmdldChcIldFQkdMX2NvbXByZXNzZWRfdGV4dHVyZV9zM3RjXCIpfSxzdXBwb3J0c0NvbXByZXNzZWRUZXh0dXJlUFZSVEM6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzQ29tcHJlc3NlZFRleHR1cmVQVlJUQygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGMnICkuXCIpLHRoaXMuZXh0ZW5zaW9ucy5nZXQoXCJXRUJHTF9jb21wcmVzc2VkX3RleHR1cmVfcHZydGNcIil9LHN1cHBvcnRzQmxlbmRNaW5NYXg6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzQmxlbmRNaW5NYXgoKSBpcyBub3cgLmV4dGVuc2lvbnMuZ2V0KCAnRVhUX2JsZW5kX21pbm1heCcgKS5cIiksdGhpcy5leHRlbnNpb25zLmdldChcIkVYVF9ibGVuZF9taW5tYXhcIil9LHN1cHBvcnRzVmVydGV4VGV4dHVyZXM6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnN1cHBvcnRzVmVydGV4VGV4dHVyZXMoKSBpcyBub3cgLmNhcGFiaWxpdGllcy52ZXJ0ZXhUZXh0dXJlcy5cIiksdGhpcy5jYXBhYmlsaXRpZXMudmVydGV4VGV4dHVyZXN9LHN1cHBvcnRzSW5zdGFuY2VkQXJyYXlzOmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zdXBwb3J0c0luc3RhbmNlZEFycmF5cygpIGlzIG5vdyAuZXh0ZW5zaW9ucy5nZXQoICdBTkdMRV9pbnN0YW5jZWRfYXJyYXlzJyApLlwiKSx0aGlzLmV4dGVuc2lvbnMuZ2V0KFwiQU5HTEVfaW5zdGFuY2VkX2FycmF5c1wiKX0sZW5hYmxlU2Npc3NvclRlc3Q6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmVuYWJsZVNjaXNzb3JUZXN0KCkgaXMgbm93IC5zZXRTY2lzc29yVGVzdCgpLlwiKSx0aGlzLnNldFNjaXNzb3JUZXN0KHQpfSxpbml0TWF0ZXJpYWw6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuaW5pdE1hdGVyaWFsKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LGFkZFByZVBsdWdpbjpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5hZGRQcmVQbHVnaW4oKSBoYXMgYmVlbiByZW1vdmVkLlwiKX0sYWRkUG9zdFBsdWdpbjpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5hZGRQb3N0UGx1Z2luKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHVwZGF0ZVNoYWRvd01hcDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC51cGRhdGVTaGFkb3dNYXAoKSBoYXMgYmVlbiByZW1vdmVkLlwiKX0sc2V0RmFjZUN1bGxpbmc6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2V0RmFjZUN1bGxpbmcoKSBoYXMgYmVlbiByZW1vdmVkLlwiKX0sYWxsb2NUZXh0dXJlVW5pdDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5hbGxvY1RleHR1cmVVbml0KCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHNldFRleHR1cmU6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2V0VGV4dHVyZSgpIGhhcyBiZWVuIHJlbW92ZWQuXCIpfSxzZXRUZXh0dXJlMkQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2V0VGV4dHVyZTJEKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LHNldFRleHR1cmVDdWJlOmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNldFRleHR1cmVDdWJlKCkgaGFzIGJlZW4gcmVtb3ZlZC5cIil9LGdldEFjdGl2ZU1pcE1hcExldmVsOmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5nZXRBY3RpdmVNaXBNYXBMZXZlbCgpIGlzIG5vdyAuZ2V0QWN0aXZlTWlwbWFwTGV2ZWwoKS5cIiksdGhpcy5nZXRBY3RpdmVNaXBtYXBMZXZlbCgpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEphLnByb3RvdHlwZSx7c2hhZG93TWFwRW5hYmxlZDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2hhZG93TWFwLmVuYWJsZWR9LHNldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2hhZG93TWFwRW5hYmxlZCBpcyBub3cgLnNoYWRvd01hcC5lbmFibGVkLlwiKSx0aGlzLnNoYWRvd01hcC5lbmFibGVkPXR9fSxzaGFkb3dNYXBUeXBlOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaGFkb3dNYXAudHlwZX0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXBUeXBlIGlzIG5vdyAuc2hhZG93TWFwLnR5cGUuXCIpLHRoaXMuc2hhZG93TWFwLnR5cGU9dH19LHNoYWRvd01hcEN1bGxGYWNlOntnZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuc2hhZG93TWFwQ3VsbEZhY2UgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IE1hdGVyaWFsLnNoYWRvd1NpZGUgaW5zdGVhZC5cIil9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXBDdWxsRmFjZSBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLlwiKX19LGNvbnRleHQ6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuY29udGV4dCBoYXMgYmVlbiByZW1vdmVkLiBVc2UgLmdldENvbnRleHQoKSBpbnN0ZWFkLlwiKSx0aGlzLmdldENvbnRleHQoKX19LHZyOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnZyIGhhcyBiZWVuIHJlbmFtZWQgdG8gLnhyXCIpLHRoaXMueHJ9fSxnYW1tYUlucHV0OntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLmdhbW1hSW5wdXQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IHRoZSBlbmNvZGluZyBmb3IgdGV4dHVyZXMgdmlhIFRleHR1cmUuZW5jb2RpbmcgaW5zdGVhZC5cIiksITF9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5nYW1tYUlucHV0IGhhcyBiZWVuIHJlbW92ZWQuIFNldCB0aGUgZW5jb2RpbmcgZm9yIHRleHR1cmVzIHZpYSBUZXh0dXJlLmVuY29kaW5nIGluc3RlYWQuXCIpfX0sZ2FtbWFPdXRwdXQ6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuZ2FtbWFPdXRwdXQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IFdlYkdMUmVuZGVyZXIub3V0cHV0RW5jb2RpbmcgaW5zdGVhZC5cIiksITF9LHNldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlcmVyOiAuZ2FtbWFPdXRwdXQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IFdlYkdMUmVuZGVyZXIub3V0cHV0RW5jb2RpbmcgaW5zdGVhZC5cIiksdGhpcy5vdXRwdXRFbmNvZGluZz0hMD09PXQ/MzAwMTpYaX19LHRvbmVNYXBwaW5nV2hpdGVQb2ludDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC50b25lTWFwcGluZ1doaXRlUG9pbnQgaGFzIGJlZW4gcmVtb3ZlZC5cIiksMX0sc2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnRvbmVNYXBwaW5nV2hpdGVQb2ludCBoYXMgYmVlbiByZW1vdmVkLlwiKX19fSksT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoSGEucHJvdG90eXBlLHtjdWxsRmFjZTp7Z2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5jdWxsRmFjZSBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLlwiKX0sc2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5jdWxsRmFjZSBoYXMgYmVlbiByZW1vdmVkLiBTZXQgTWF0ZXJpYWwuc2hhZG93U2lkZSBpbnN0ZWFkLlwiKX19LHJlbmRlclJldmVyc2VTaWRlZDp7Z2V0OmZ1bmN0aW9uKCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJlcjogLnNoYWRvd01hcC5yZW5kZXJSZXZlcnNlU2lkZWQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IE1hdGVyaWFsLnNoYWRvd1NpZGUgaW5zdGVhZC5cIil9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXAucmVuZGVyUmV2ZXJzZVNpZGVkIGhhcyBiZWVuIHJlbW92ZWQuIFNldCBNYXRlcmlhbC5zaGFkb3dTaWRlIGluc3RlYWQuXCIpfX0scmVuZGVyU2luZ2xlU2lkZWQ6e2dldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXAucmVuZGVyU2luZ2xlU2lkZWQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IE1hdGVyaWFsLnNoYWRvd1NpZGUgaW5zdGVhZC5cIil9LHNldDpmdW5jdGlvbigpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyZXI6IC5zaGFkb3dNYXAucmVuZGVyU2luZ2xlU2lkZWQgaGFzIGJlZW4gcmVtb3ZlZC4gU2V0IE1hdGVyaWFsLnNoYWRvd1NpZGUgaW5zdGVhZC5cIil9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGRuLnByb3RvdHlwZSx7d3JhcFM6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLndyYXBTIGlzIG5vdyAudGV4dHVyZS53cmFwUy5cIiksdGhpcy50ZXh0dXJlLndyYXBTfSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC53cmFwUyBpcyBub3cgLnRleHR1cmUud3JhcFMuXCIpLHRoaXMudGV4dHVyZS53cmFwUz10fX0sd3JhcFQ6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLndyYXBUIGlzIG5vdyAudGV4dHVyZS53cmFwVC5cIiksdGhpcy50ZXh0dXJlLndyYXBUfSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC53cmFwVCBpcyBub3cgLnRleHR1cmUud3JhcFQuXCIpLHRoaXMudGV4dHVyZS53cmFwVD10fX0sbWFnRmlsdGVyOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5tYWdGaWx0ZXIgaXMgbm93IC50ZXh0dXJlLm1hZ0ZpbHRlci5cIiksdGhpcy50ZXh0dXJlLm1hZ0ZpbHRlcn0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAubWFnRmlsdGVyIGlzIG5vdyAudGV4dHVyZS5tYWdGaWx0ZXIuXCIpLHRoaXMudGV4dHVyZS5tYWdGaWx0ZXI9dH19LG1pbkZpbHRlcjp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAubWluRmlsdGVyIGlzIG5vdyAudGV4dHVyZS5taW5GaWx0ZXIuXCIpLHRoaXMudGV4dHVyZS5taW5GaWx0ZXJ9LHNldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLm1pbkZpbHRlciBpcyBub3cgLnRleHR1cmUubWluRmlsdGVyLlwiKSx0aGlzLnRleHR1cmUubWluRmlsdGVyPXR9fSxhbmlzb3Ryb3B5OntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5hbmlzb3Ryb3B5IGlzIG5vdyAudGV4dHVyZS5hbmlzb3Ryb3B5LlwiKSx0aGlzLnRleHR1cmUuYW5pc290cm9weX0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAuYW5pc290cm9weSBpcyBub3cgLnRleHR1cmUuYW5pc290cm9weS5cIiksdGhpcy50ZXh0dXJlLmFuaXNvdHJvcHk9dH19LG9mZnNldDp7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIGNvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAub2Zmc2V0IGlzIG5vdyAudGV4dHVyZS5vZmZzZXQuXCIpLHRoaXMudGV4dHVyZS5vZmZzZXR9LHNldDpmdW5jdGlvbih0KXtjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLm9mZnNldCBpcyBub3cgLnRleHR1cmUub2Zmc2V0LlwiKSx0aGlzLnRleHR1cmUub2Zmc2V0PXR9fSxyZXBlYXQ6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLnJlcGVhdCBpcyBub3cgLnRleHR1cmUucmVwZWF0LlwiKSx0aGlzLnRleHR1cmUucmVwZWF0fSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5yZXBlYXQgaXMgbm93IC50ZXh0dXJlLnJlcGVhdC5cIiksdGhpcy50ZXh0dXJlLnJlcGVhdD10fX0sZm9ybWF0OntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5mb3JtYXQgaXMgbm93IC50ZXh0dXJlLmZvcm1hdC5cIiksdGhpcy50ZXh0dXJlLmZvcm1hdH0sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAuZm9ybWF0IGlzIG5vdyAudGV4dHVyZS5mb3JtYXQuXCIpLHRoaXMudGV4dHVyZS5mb3JtYXQ9dH19LHR5cGU6e2dldDpmdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5XZWJHTFJlbmRlclRhcmdldDogLnR5cGUgaXMgbm93IC50ZXh0dXJlLnR5cGUuXCIpLHRoaXMudGV4dHVyZS50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC50eXBlIGlzIG5vdyAudGV4dHVyZS50eXBlLlwiKSx0aGlzLnRleHR1cmUudHlwZT10fX0sZ2VuZXJhdGVNaXBtYXBzOntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQ6IC5nZW5lcmF0ZU1pcG1hcHMgaXMgbm93IC50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwcy5cIiksdGhpcy50ZXh0dXJlLmdlbmVyYXRlTWlwbWFwc30sc2V0OmZ1bmN0aW9uKHQpe2NvbnNvbGUud2FybihcIlRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0OiAuZ2VuZXJhdGVNaXBtYXBzIGlzIG5vdyAudGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHMuXCIpLHRoaXMudGV4dHVyZS5nZW5lcmF0ZU1pcG1hcHM9dH19fSksT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoY2xhc3MgZXh0ZW5kcyBwcntjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLHRoaXMudHlwZT1cIkF1ZGlvXCIsdGhpcy5saXN0ZW5lcj10LHRoaXMuY29udGV4dD10LmNvbnRleHQsdGhpcy5nYWluPXRoaXMuY29udGV4dC5jcmVhdGVHYWluKCksdGhpcy5nYWluLmNvbm5lY3QodC5nZXRJbnB1dCgpKSx0aGlzLmF1dG9wbGF5PSExLHRoaXMuYnVmZmVyPW51bGwsdGhpcy5kZXR1bmU9MCx0aGlzLmxvb3A9ITEsdGhpcy5sb29wU3RhcnQ9MCx0aGlzLmxvb3BFbmQ9MCx0aGlzLm9mZnNldD0wLHRoaXMuZHVyYXRpb249dm9pZCAwLHRoaXMucGxheWJhY2tSYXRlPTEsdGhpcy5pc1BsYXlpbmc9ITEsdGhpcy5oYXNQbGF5YmFja0NvbnRyb2w9ITAsdGhpcy5zb3VyY2U9bnVsbCx0aGlzLnNvdXJjZVR5cGU9XCJlbXB0eVwiLHRoaXMuX3N0YXJ0ZWRBdD0wLHRoaXMuX3Byb2dyZXNzPTAsdGhpcy5fY29ubmVjdGVkPSExLHRoaXMuZmlsdGVycz1bXX1nZXRPdXRwdXQoKXtyZXR1cm4gdGhpcy5nYWlufXNldE5vZGVTb3VyY2UodCl7cmV0dXJuIHRoaXMuaGFzUGxheWJhY2tDb250cm9sPSExLHRoaXMuc291cmNlVHlwZT1cImF1ZGlvTm9kZVwiLHRoaXMuc291cmNlPXQsdGhpcy5jb25uZWN0KCksdGhpc31zZXRNZWRpYUVsZW1lbnRTb3VyY2UodCl7cmV0dXJuIHRoaXMuaGFzUGxheWJhY2tDb250cm9sPSExLHRoaXMuc291cmNlVHlwZT1cIm1lZGlhTm9kZVwiLHRoaXMuc291cmNlPXRoaXMuY29udGV4dC5jcmVhdGVNZWRpYUVsZW1lbnRTb3VyY2UodCksdGhpcy5jb25uZWN0KCksdGhpc31zZXRNZWRpYVN0cmVhbVNvdXJjZSh0KXtyZXR1cm4gdGhpcy5oYXNQbGF5YmFja0NvbnRyb2w9ITEsdGhpcy5zb3VyY2VUeXBlPVwibWVkaWFTdHJlYW1Ob2RlXCIsdGhpcy5zb3VyY2U9dGhpcy5jb250ZXh0LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHQpLHRoaXMuY29ubmVjdCgpLHRoaXN9c2V0QnVmZmVyKHQpe3JldHVybiB0aGlzLmJ1ZmZlcj10LHRoaXMuc291cmNlVHlwZT1cImJ1ZmZlclwiLHRoaXMuYXV0b3BsYXkmJnRoaXMucGxheSgpLHRoaXN9cGxheSh0PTApe2lmKCEwPT09dGhpcy5pc1BsYXlpbmcpcmV0dXJuIHZvaWQgY29uc29sZS53YXJuKFwiVEhSRUUuQXVkaW86IEF1ZGlvIGlzIGFscmVhZHkgcGxheWluZy5cIik7aWYoITE9PT10aGlzLmhhc1BsYXliYWNrQ29udHJvbClyZXR1cm4gdm9pZCBjb25zb2xlLndhcm4oXCJUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC5cIik7dGhpcy5fc3RhcnRlZEF0PXRoaXMuY29udGV4dC5jdXJyZW50VGltZSt0O2NvbnN0IGU9dGhpcy5jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO3JldHVybiBlLmJ1ZmZlcj10aGlzLmJ1ZmZlcixlLmxvb3A9dGhpcy5sb29wLGUubG9vcFN0YXJ0PXRoaXMubG9vcFN0YXJ0LGUubG9vcEVuZD10aGlzLmxvb3BFbmQsZS5vbmVuZGVkPXRoaXMub25FbmRlZC5iaW5kKHRoaXMpLGUuc3RhcnQodGhpcy5fc3RhcnRlZEF0LHRoaXMuX3Byb2dyZXNzK3RoaXMub2Zmc2V0LHRoaXMuZHVyYXRpb24pLHRoaXMuaXNQbGF5aW5nPSEwLHRoaXMuc291cmNlPWUsdGhpcy5zZXREZXR1bmUodGhpcy5kZXR1bmUpLHRoaXMuc2V0UGxheWJhY2tSYXRlKHRoaXMucGxheWJhY2tSYXRlKSx0aGlzLmNvbm5lY3QoKX1wYXVzZSgpe2lmKCExIT09dGhpcy5oYXNQbGF5YmFja0NvbnRyb2wpcmV0dXJuITA9PT10aGlzLmlzUGxheWluZyYmKHRoaXMuX3Byb2dyZXNzKz1NYXRoLm1heCh0aGlzLmNvbnRleHQuY3VycmVudFRpbWUtdGhpcy5fc3RhcnRlZEF0LDApKnRoaXMucGxheWJhY2tSYXRlLCEwPT09dGhpcy5sb29wJiYodGhpcy5fcHJvZ3Jlc3M9dGhpcy5fcHJvZ3Jlc3MlKHRoaXMuZHVyYXRpb258fHRoaXMuYnVmZmVyLmR1cmF0aW9uKSksdGhpcy5zb3VyY2Uuc3RvcCgpLHRoaXMuc291cmNlLm9uZW5kZWQ9bnVsbCx0aGlzLmlzUGxheWluZz0hMSksdGhpcztjb25zb2xlLndhcm4oXCJUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC5cIil9c3RvcCgpe2lmKCExIT09dGhpcy5oYXNQbGF5YmFja0NvbnRyb2wpcmV0dXJuIHRoaXMuX3Byb2dyZXNzPTAsdGhpcy5zb3VyY2Uuc3RvcCgpLHRoaXMuc291cmNlLm9uZW5kZWQ9bnVsbCx0aGlzLmlzUGxheWluZz0hMSx0aGlzO2NvbnNvbGUud2FybihcIlRIUkVFLkF1ZGlvOiB0aGlzIEF1ZGlvIGhhcyBubyBwbGF5YmFjayBjb250cm9sLlwiKX1jb25uZWN0KCl7aWYodGhpcy5maWx0ZXJzLmxlbmd0aD4wKXt0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZmlsdGVyc1swXSk7Zm9yKGxldCB0PTEsZT10aGlzLmZpbHRlcnMubGVuZ3RoO3Q8ZTt0KyspdGhpcy5maWx0ZXJzW3QtMV0uY29ubmVjdCh0aGlzLmZpbHRlcnNbdF0pO3RoaXMuZmlsdGVyc1t0aGlzLmZpbHRlcnMubGVuZ3RoLTFdLmNvbm5lY3QodGhpcy5nZXRPdXRwdXQoKSl9ZWxzZSB0aGlzLnNvdXJjZS5jb25uZWN0KHRoaXMuZ2V0T3V0cHV0KCkpO3JldHVybiB0aGlzLl9jb25uZWN0ZWQ9ITAsdGhpc31kaXNjb25uZWN0KCl7aWYodGhpcy5maWx0ZXJzLmxlbmd0aD4wKXt0aGlzLnNvdXJjZS5kaXNjb25uZWN0KHRoaXMuZmlsdGVyc1swXSk7Zm9yKGxldCB0PTEsZT10aGlzLmZpbHRlcnMubGVuZ3RoO3Q8ZTt0KyspdGhpcy5maWx0ZXJzW3QtMV0uZGlzY29ubmVjdCh0aGlzLmZpbHRlcnNbdF0pO3RoaXMuZmlsdGVyc1t0aGlzLmZpbHRlcnMubGVuZ3RoLTFdLmRpc2Nvbm5lY3QodGhpcy5nZXRPdXRwdXQoKSl9ZWxzZSB0aGlzLnNvdXJjZS5kaXNjb25uZWN0KHRoaXMuZ2V0T3V0cHV0KCkpO3JldHVybiB0aGlzLl9jb25uZWN0ZWQ9ITEsdGhpc31nZXRGaWx0ZXJzKCl7cmV0dXJuIHRoaXMuZmlsdGVyc31zZXRGaWx0ZXJzKHQpe3JldHVybiB0fHwodD1bXSksITA9PT10aGlzLl9jb25uZWN0ZWQ/KHRoaXMuZGlzY29ubmVjdCgpLHRoaXMuZmlsdGVycz10LnNsaWNlKCksdGhpcy5jb25uZWN0KCkpOnRoaXMuZmlsdGVycz10LnNsaWNlKCksdGhpc31zZXREZXR1bmUodCl7aWYodGhpcy5kZXR1bmU9dCx2b2lkIDAhPT10aGlzLnNvdXJjZS5kZXR1bmUpcmV0dXJuITA9PT10aGlzLmlzUGxheWluZyYmdGhpcy5zb3VyY2UuZGV0dW5lLnNldFRhcmdldEF0VGltZSh0aGlzLmRldHVuZSx0aGlzLmNvbnRleHQuY3VycmVudFRpbWUsLjAxKSx0aGlzfWdldERldHVuZSgpe3JldHVybiB0aGlzLmRldHVuZX1nZXRGaWx0ZXIoKXtyZXR1cm4gdGhpcy5nZXRGaWx0ZXJzKClbMF19c2V0RmlsdGVyKHQpe3JldHVybiB0aGlzLnNldEZpbHRlcnModD9bdF06W10pfXNldFBsYXliYWNrUmF0ZSh0KXtpZighMSE9PXRoaXMuaGFzUGxheWJhY2tDb250cm9sKXJldHVybiB0aGlzLnBsYXliYWNrUmF0ZT10LCEwPT09dGhpcy5pc1BsYXlpbmcmJnRoaXMuc291cmNlLnBsYXliYWNrUmF0ZS5zZXRUYXJnZXRBdFRpbWUodGhpcy5wbGF5YmFja1JhdGUsdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lLC4wMSksdGhpcztjb25zb2xlLndhcm4oXCJUSFJFRS5BdWRpbzogdGhpcyBBdWRpbyBoYXMgbm8gcGxheWJhY2sgY29udHJvbC5cIil9Z2V0UGxheWJhY2tSYXRlKCl7cmV0dXJuIHRoaXMucGxheWJhY2tSYXRlfW9uRW5kZWQoKXt0aGlzLmlzUGxheWluZz0hMX1nZXRMb29wKCl7cmV0dXJuITE9PT10aGlzLmhhc1BsYXliYWNrQ29udHJvbD8oY29uc29sZS53YXJuKFwiVEhSRUUuQXVkaW86IHRoaXMgQXVkaW8gaGFzIG5vIHBsYXliYWNrIGNvbnRyb2wuXCIpLCExKTp0aGlzLmxvb3B9c2V0TG9vcCh0KXtpZighMSE9PXRoaXMuaGFzUGxheWJhY2tDb250cm9sKXJldHVybiB0aGlzLmxvb3A9dCwhMD09PXRoaXMuaXNQbGF5aW5nJiYodGhpcy5zb3VyY2UubG9vcD10aGlzLmxvb3ApLHRoaXM7Y29uc29sZS53YXJuKFwiVEhSRUUuQXVkaW86IHRoaXMgQXVkaW8gaGFzIG5vIHBsYXliYWNrIGNvbnRyb2wuXCIpfXNldExvb3BTdGFydCh0KXtyZXR1cm4gdGhpcy5sb29wU3RhcnQ9dCx0aGlzfXNldExvb3BFbmQodCl7cmV0dXJuIHRoaXMubG9vcEVuZD10LHRoaXN9Z2V0Vm9sdW1lKCl7cmV0dXJuIHRoaXMuZ2Fpbi5nYWluLnZhbHVlfXNldFZvbHVtZSh0KXtyZXR1cm4gdGhpcy5nYWluLmdhaW4uc2V0VGFyZ2V0QXRUaW1lKHQsdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lLC4wMSksdGhpc319LnByb3RvdHlwZSx7bG9hZDp7dmFsdWU6ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKFwiVEhSRUUuQXVkaW86IC5sb2FkIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSBUSFJFRS5BdWRpb0xvYWRlciBpbnN0ZWFkLlwiKTtjb25zdCBlPXRoaXM7cmV0dXJuKG5ldyBfdSkubG9hZCh0LChmdW5jdGlvbih0KXtlLnNldEJ1ZmZlcih0KX0pKSx0aGlzfX0sc3RhcnRUaW1lOntzZXQ6ZnVuY3Rpb24oKXtjb25zb2xlLndhcm4oXCJUSFJFRS5BdWRpbzogLnN0YXJ0VGltZSBpcyBub3cgLnBsYXkoIGRlbGF5ICkuXCIpfX19KSxrcy5wcm90b3R5cGUudXBkYXRlQ3ViZU1hcD1mdW5jdGlvbih0LGUpe3JldHVybiBjb25zb2xlLndhcm4oXCJUSFJFRS5DdWJlQ2FtZXJhOiAudXBkYXRlQ3ViZU1hcCgpIGlzIG5vdyAudXBkYXRlKCkuXCIpLHRoaXMudXBkYXRlKHQsZSl9LGtzLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gY29uc29sZS53YXJuKFwiVEhSRUUuQ3ViZUNhbWVyYTogLmNsZWFyKCkgaXMgbm93IC5yZW5kZXJUYXJnZXQuY2xlYXIoKS5cIiksdGhpcy5yZW5kZXJUYXJnZXQuY2xlYXIodCxlLGksbil9LGFuLmNyb3NzT3JpZ2luPXZvaWQgMCxhbi5sb2FkVGV4dHVyZT1mdW5jdGlvbih0LGUsaSxuKXtjb25zb2xlLndhcm4oXCJUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlIGhhcyBiZWVuIGRlcHJlY2F0ZWQuIFVzZSBUSFJFRS5UZXh0dXJlTG9hZGVyKCkgaW5zdGVhZC5cIik7Y29uc3Qgcj1uZXcgeGw7ci5zZXRDcm9zc09yaWdpbih0aGlzLmNyb3NzT3JpZ2luKTtjb25zdCBzPXIubG9hZCh0LGksdm9pZCAwLG4pO3JldHVybiBlJiYocy5tYXBwaW5nPWUpLHN9LGFuLmxvYWRUZXh0dXJlQ3ViZT1mdW5jdGlvbih0LGUsaSxuKXtjb25zb2xlLndhcm4oXCJUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlQ3ViZSBoYXMgYmVlbiBkZXByZWNhdGVkLiBVc2UgVEhSRUUuQ3ViZVRleHR1cmVMb2FkZXIoKSBpbnN0ZWFkLlwiKTtjb25zdCByPW5ldyB5bDtyLnNldENyb3NzT3JpZ2luKHRoaXMuY3Jvc3NPcmlnaW4pO2NvbnN0IHM9ci5sb2FkKHQsaSx2b2lkIDAsbik7cmV0dXJuIGUmJihzLm1hcHBpbmc9ZSksc30sYW4ubG9hZENvbXByZXNzZWRUZXh0dXJlPWZ1bmN0aW9uKCl7Y29uc29sZS5lcnJvcihcIlRIUkVFLkltYWdlVXRpbHMubG9hZENvbXByZXNzZWRUZXh0dXJlIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBUSFJFRS5ERFNMb2FkZXIgaW5zdGVhZC5cIil9LGFuLmxvYWRDb21wcmVzc2VkVGV4dHVyZUN1YmU9ZnVuY3Rpb24oKXtjb25zb2xlLmVycm9yKFwiVEhSRUUuSW1hZ2VVdGlscy5sb2FkQ29tcHJlc3NlZFRleHR1cmVDdWJlIGhhcyBiZWVuIHJlbW92ZWQuIFVzZSBUSFJFRS5ERFNMb2FkZXIgaW5zdGVhZC5cIil9LFwidW5kZWZpbmVkXCIhPXR5cGVvZiBfX1RIUkVFX0RFVlRPT0xTX18mJl9fVEhSRUVfREVWVE9PTFNfXy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcInJlZ2lzdGVyXCIse2RldGFpbDp7cmV2aXNpb246XCIxMjVcIn19KSksXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdyYmKHdpbmRvdy5fX1RIUkVFX18/Y29uc29sZS53YXJuKFwiV0FSTklORzogTXVsdGlwbGUgaW5zdGFuY2VzIG9mIFRocmVlLmpzIGJlaW5nIGltcG9ydGVkLlwiKTp3aW5kb3cuX19USFJFRV9fPVwiMTI1XCIpO2NvbnN0IFd1PU1hdGguUEkvMTgwLFh1PTE4MC9NYXRoLlBJLFl1PTYzNzgxMzcsWnU9NjM1Njc1Mi4zMTQyNDUxODtmdW5jdGlvbiBKdSh0LGUsaSxuLHIscyl7Y29uc3Qgbz1RdSh0LGUsaSk7cmV0dXJuIGZ1bmN0aW9uKHQsZSxpLG4scixzKXtjb25zdCBvPVF1KG4scixzKSxhPVt0LW9bMF0sZS1vWzFdLGktb1syXV07bio9V3Uscio9V3U7Y29uc3QgYz1NYXRoLmNvcyhuKSxoPU1hdGguc2luKG4pLGw9TWF0aC5jb3MociksdT1NYXRoLnNpbihyKSxkPS1oKmFbMF0rYyphWzFdLHA9LXUqYyphWzBdLXUqaCphWzFdK2wqYVsyXSxmPWwqYyphWzBdK2wqaCphWzFdK3UqYVsyXTtyZXR1cm5bZCxwLGZdfShvWzBdLG9bMV0sb1syXSxuLHIscyl9ZnVuY3Rpb24gS3UodCxlLGksbixyLHMpe2NvbnN0IG89ZnVuY3Rpb24odCxlLGksbixyLHMpe2NvbnN0IG89UXUobixyLHMpO24qPVd1LHIqPVd1O2NvbnN0IGE9TWF0aC5jb3MobiksYz1NYXRoLnNpbihuKSxoPU1hdGguY29zKHIpLGw9TWF0aC5zaW4ociksdT0tYyp0LWwqYSplK2gqYSppK29bMF0sZD1hKnQtbCpjKmUraCpjKmkrb1sxXSxwPWgqZStsKmkrb1syXTtyZXR1cm5bdSxkLHBdfSh0LGUsaSxuLHIscyk7cmV0dXJuIGZ1bmN0aW9uKHQsZSxpKXtjb25zdCBuPVl1LHI9WnUscz1uKm4sbz1yKnIsYT1zLW8sYz1NYXRoLnNxcnQoYS9zKSxoPU1hdGguc3FydChhL28pLGw9TWF0aC5zcXJ0KHQqdCtlKmUpLHU9TWF0aC5hdGFuMihpKm4sbCpyKSxkPU1hdGguc2luKHUpLHA9TWF0aC5jb3ModSksZj1NYXRoLmF0YW4yKGUsdCksbT1NYXRoLmF0YW4yKGkraCpoKnIqZCpkKmQsbC1jKmMqbipwKnAqcCksZz1NYXRoLnNpbihtKSxfPU1hdGguY29zKG0pLHY9bi9NYXRoLnNxcnQoMS1jKmMqZypnKTtyZXR1cm5bZipYdSxtKlh1LGwvXy12XX0ob1swXSxvWzFdLG9bMl0pfWZ1bmN0aW9uIFF1KHQsZSxpKXtjb25zdCBuPVl1LHI9WnU7dCo9V3UsZSo9V3U7Y29uc3Qgcz1NYXRoLmNvcyh0KSxvPU1hdGguc2luKHQpLGE9TWF0aC5jb3MoZSksYz1NYXRoLnNpbihlKSxoPW4qbixsPXIqcix1PTEvTWF0aC5zcXJ0KGgqYSphK2wqYypjKSxkPShoKnUraSkqYTtyZXR1cm5bZCpzLGQqbywobCp1K2kpKmNdfWNsYXNzIHRke2JvdW5kaW5nQm94Q29ybmVycyh0LGUpe2NvbnN0IGk9S3UoLWUsLWUsMCx0LmxuZyx0LmxhdCwwKSxuPUt1KGUsZSwwLHQubG5nLHQubGF0LDApO3JldHVyblt7bGF0OmlbMV0sbG5nOmlbMF19LHtsYXQ6blsxXSxsbmc6blswXX1dfXJvdGF0aW9uRnJvbUNvbXBhc3ModCxlKXtsZXQgaT0wLG49MCxyPTA7c3dpdGNoKGUpe2Nhc2UgMTppPU1hdGguUEkvMjticmVhaztjYXNlIDM6aT0tTWF0aC5QSS8yLHI9TWF0aC5QSTticmVhaztjYXNlIDY6bj0tTWF0aC5QSS8yLHI9LU1hdGguUEkvMjticmVhaztjYXNlIDg6bj1NYXRoLlBJLzIscj1NYXRoLlBJLzJ9Y29uc3Qgcz0obmV3IEhuKS5tYWtlUm90YXRpb25aKHIpLG89bmV3IFpuKGksbix0Kk1hdGguUEkvMTgwLFwiWFlaXCIpLGE9KG5ldyBIbikubWFrZVJvdGF0aW9uRnJvbUV1bGVyKG8pLGM9KG5ldyB1bikuc2V0QXhpc0FuZ2xlRnJvbVJvdGF0aW9uTWF0cml4KGEubXVsdGlwbHkocykpO3JldHVybiBjLm11bHRpcGx5U2NhbGFyKGMudykudG9BcnJheSgpLnNsaWNlKDAsMyl9fWNsYXNzIGVke2NvbnN0cnVjdG9yKHQpe2lmKCF0KXRocm93IG5ldyBFcnJvcihgSW5jb3JyZWN0IGNvcmUgaW1hZ2UgZGF0YSAke3R9YCk7dGhpcy5fY2FjaGU9bnVsbCx0aGlzLl9jb3JlPXQsdGhpcy5fc3BhdGlhbD1udWxsfWdldCBhc3NldHNDYWNoZWQoKXtyZXR1cm4gbnVsbCE9dGhpcy5fY29yZSYmbnVsbCE9dGhpcy5fc3BhdGlhbCYmbnVsbCE9dGhpcy5fY2FjaGUmJm51bGwhPXRoaXMuX2NhY2hlLmltYWdlJiZudWxsIT10aGlzLl9jYWNoZS5tZXNofWdldCBjYW1lcmFQYXJhbWV0ZXJzKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwuY2FtZXJhX3BhcmFtZXRlcnN9Z2V0IGNhbWVyYVR5cGUoKXtyZXR1cm4gdGhpcy5fc3BhdGlhbC5jYW1lcmFfdHlwZX1nZXQgY2FwdHVyZWRBdCgpe3JldHVybiB0aGlzLl9zcGF0aWFsLmNhcHR1cmVkX2F0fWdldCBjbHVzdGVySWQoKXtyZXR1cm4gdGhpcy5fc3BhdGlhbC5jbHVzdGVyP3RoaXMuX3NwYXRpYWwuY2x1c3Rlci5pZDpudWxsfWdldCBjbHVzdGVyVXJsKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwuY2x1c3Rlcj90aGlzLl9zcGF0aWFsLmNsdXN0ZXIudXJsOm51bGx9Z2V0IGNvbXBhc3NBbmdsZSgpe3JldHVybiBudWxsIT10aGlzLl9zcGF0aWFsLmNvbXB1dGVkX2NvbXBhc3NfYW5nbGU/dGhpcy5fc3BhdGlhbC5jb21wdXRlZF9jb21wYXNzX2FuZ2xlOnRoaXMuX3NwYXRpYWwuY29tcGFzc19hbmdsZX1nZXQgY29tcGxldGUoKXtyZXR1cm4gbnVsbCE9dGhpcy5fc3BhdGlhbH1nZXQgY29tcHV0ZWRBbHRpdHVkZSgpe3JldHVybiB0aGlzLl9zcGF0aWFsLmNvbXB1dGVkX2FsdGl0dWRlfWdldCBjb21wdXRlZENvbXBhc3NBbmdsZSgpe3JldHVybiB0aGlzLl9zcGF0aWFsLmNvbXB1dGVkX2NvbXBhc3NfYW5nbGV9Z2V0IGNvbXB1dGVkTG5nTGF0KCl7cmV0dXJuIHRoaXMuX2NvcmUuY29tcHV0ZWRfZ2VvbWV0cnl9Z2V0IGNyZWF0b3JJZCgpe3JldHVybiB0aGlzLl9zcGF0aWFsLmNyZWF0b3IuaWR9Z2V0IGNyZWF0b3JVc2VybmFtZSgpe3JldHVybiB0aGlzLl9zcGF0aWFsLmNyZWF0b3IudXNlcm5hbWV9Z2V0IGV4aWZPcmllbnRhdGlvbigpe3JldHVybiB0aGlzLl9zcGF0aWFsLmV4aWZfb3JpZW50YXRpb259Z2V0IGhlaWdodCgpe3JldHVybiB0aGlzLl9zcGF0aWFsLmhlaWdodH1nZXQgaW1hZ2UoKXtyZXR1cm4gdGhpcy5fY2FjaGUuaW1hZ2V9Z2V0IGltYWdlJCgpe3JldHVybiB0aGlzLl9jYWNoZS5pbWFnZSR9Z2V0IGlkKCl7cmV0dXJuIHRoaXMuX2NvcmUuaWR9Z2V0IGxuZ0xhdCgpe3JldHVybiBudWxsIT10aGlzLl9jb3JlLmNvbXB1dGVkX2dlb21ldHJ5P3RoaXMuX2NvcmUuY29tcHV0ZWRfZ2VvbWV0cnk6dGhpcy5fY29yZS5nZW9tZXRyeX1nZXQgbWVyZ2VkKCl7cmV0dXJuIG51bGwhPXRoaXMuX3NwYXRpYWwmJm51bGwhPXRoaXMuX3NwYXRpYWwubWVyZ2VfaWR9Z2V0IG1lcmdlSWQoKXtyZXR1cm4gdGhpcy5fc3BhdGlhbC5tZXJnZV9pZH1nZXQgbWVzaCgpe3JldHVybiB0aGlzLl9jYWNoZS5tZXNofWdldCBvcmlnaW5hbEFsdGl0dWRlKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwuYWx0aXR1ZGV9Z2V0IG9yaWdpbmFsQ29tcGFzc0FuZ2xlKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwuY29tcGFzc19hbmdsZX1nZXQgb3JpZ2luYWxMbmdMYXQoKXtyZXR1cm4gdGhpcy5fY29yZS5nZW9tZXRyeX1nZXQgb3duZXJJZCgpe3JldHVybiB0aGlzLl9zcGF0aWFsLm93bmVyP3RoaXMuX3NwYXRpYWwub3duZXIuaWQ6bnVsbH1nZXQgcHJpdmF0ZSgpe3JldHVybiB0aGlzLl9zcGF0aWFsLnByaXZhdGV9Z2V0IHF1YWxpdHlTY29yZSgpe3JldHVybiB0aGlzLl9zcGF0aWFsLnF1YWxpdHlfc2NvcmV9Z2V0IHJvdGF0aW9uKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwuY29tcHV0ZWRfcm90YXRpb259Z2V0IHNjYWxlKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwuYXRvbWljX3NjYWxlfWdldCBzZXF1ZW5jZUlkKCl7cmV0dXJuIHRoaXMuX2NvcmUuc2VxdWVuY2U/dGhpcy5fY29yZS5zZXF1ZW5jZS5pZDpudWxsfWdldCBzZXF1ZW5jZUVkZ2VzKCl7cmV0dXJuIHRoaXMuX2NhY2hlLnNlcXVlbmNlRWRnZXN9Z2V0IHNlcXVlbmNlRWRnZXMkKCl7cmV0dXJuIHRoaXMuX2NhY2hlLnNlcXVlbmNlRWRnZXMkfWdldCBzcGF0aWFsRWRnZXMoKXtyZXR1cm4gdGhpcy5fY2FjaGUuc3BhdGlhbEVkZ2VzfWdldCBzcGF0aWFsRWRnZXMkKCl7cmV0dXJuIHRoaXMuX2NhY2hlLnNwYXRpYWxFZGdlcyR9Z2V0IHdpZHRoKCl7cmV0dXJuIHRoaXMuX3NwYXRpYWwud2lkdGh9Y2FjaGVBc3NldHMkKCl7cmV0dXJuIHRoaXMuX2NhY2hlLmNhY2hlQXNzZXRzJCh0aGlzLl9zcGF0aWFsLHRoaXMubWVyZ2VkKS5waXBlKHJ0KCgoKT0+dGhpcykpKX1jYWNoZUltYWdlJCgpe3JldHVybiB0aGlzLl9jYWNoZS5jYWNoZUltYWdlJCh0aGlzLl9zcGF0aWFsKS5waXBlKHJ0KCgoKT0+dGhpcykpKX1jYWNoZVNlcXVlbmNlRWRnZXModCl7dGhpcy5fY2FjaGUuY2FjaGVTZXF1ZW5jZUVkZ2VzKHQpfWNhY2hlU3BhdGlhbEVkZ2VzKHQpe3RoaXMuX2NhY2hlLmNhY2hlU3BhdGlhbEVkZ2VzKHQpfWRpc3Bvc2UoKXtudWxsIT10aGlzLl9jYWNoZSYmKHRoaXMuX2NhY2hlLmRpc3Bvc2UoKSx0aGlzLl9jYWNoZT1udWxsKSx0aGlzLl9jb3JlPW51bGwsdGhpcy5fc3BhdGlhbD1udWxsfWluaXRpYWxpemVDYWNoZSh0KXtpZihudWxsIT10aGlzLl9jYWNoZSl0aHJvdyBuZXcgRXJyb3IoYEltYWdlIGNhY2hlIGFscmVhZHkgaW5pdGlhbGl6ZWQgKCR7dGhpcy5pZH0pLmApO3RoaXMuX2NhY2hlPXR9bWFrZUNvbXBsZXRlKHQpe2lmKG51bGw9PXQpdGhyb3cgbmV3IEVycm9yKFwiRmlsbCBjYW4gbm90IGJlIG51bGwuXCIpO3RoaXMuX3NwYXRpYWw9dH1yZXNldFNlcXVlbmNlRWRnZXMoKXt0aGlzLl9jYWNoZS5yZXNldFNlcXVlbmNlRWRnZXMoKX1yZXNldFNwYXRpYWxFZGdlcygpe3RoaXMuX2NhY2hlLnJlc2V0U3BhdGlhbEVkZ2VzKCl9dW5jYWNoZSgpe251bGwhPXRoaXMuX2NhY2hlJiYodGhpcy5fY2FjaGUuZGlzcG9zZSgpLHRoaXMuX2NhY2hlPW51bGwpfX1jbGFzcyBpZHtjb25zdHJ1Y3Rvcih0KXt0aGlzLl9kaXNwb3NlZD0hMSx0aGlzLl9wcm92aWRlcj10LHRoaXMuX2ltYWdlPW51bGwsdGhpcy5fbWVzaD1udWxsLHRoaXMuX3NlcXVlbmNlRWRnZXM9e2NhY2hlZDohMSxlZGdlczpbXX0sdGhpcy5fc3BhdGlhbEVkZ2VzPXtjYWNoZWQ6ITEsZWRnZXM6W119LHRoaXMuX2ltYWdlQ2hhbmdlZCQ9bmV3IFQsdGhpcy5faW1hZ2UkPXRoaXMuX2ltYWdlQ2hhbmdlZCQucGlwZShuaShudWxsKSxVZSgxKSxFKCkpLHRoaXMuX2lhbWdlU3Vic2NyaXB0aW9uPXRoaXMuX2ltYWdlJC5zdWJzY3JpYmUoKSx0aGlzLl9zZXF1ZW5jZUVkZ2VzQ2hhbmdlZCQ9bmV3IFQsdGhpcy5fc2VxdWVuY2VFZGdlcyQ9dGhpcy5fc2VxdWVuY2VFZGdlc0NoYW5nZWQkLnBpcGUobmkodGhpcy5fc2VxdWVuY2VFZGdlcyksVWUoMSksRSgpKSx0aGlzLl9zZXF1ZW5jZUVkZ2VzU3Vic2NyaXB0aW9uPXRoaXMuX3NlcXVlbmNlRWRnZXMkLnN1YnNjcmliZSgoKCk9Pnt9KSksdGhpcy5fc3BhdGlhbEVkZ2VzQ2hhbmdlZCQ9bmV3IFQsdGhpcy5fc3BhdGlhbEVkZ2VzJD10aGlzLl9zcGF0aWFsRWRnZXNDaGFuZ2VkJC5waXBlKG5pKHRoaXMuX3NwYXRpYWxFZGdlcyksVWUoMSksRSgpKSx0aGlzLl9zcGF0aWFsRWRnZXNTdWJzY3JpcHRpb249dGhpcy5fc3BhdGlhbEVkZ2VzJC5zdWJzY3JpYmUoKCgpPT57fSkpLHRoaXMuX2NhY2hpbmdBc3NldHMkPW51bGx9Z2V0IGltYWdlKCl7cmV0dXJuIHRoaXMuX2ltYWdlfWdldCBpbWFnZSQoKXtyZXR1cm4gdGhpcy5faW1hZ2UkfWdldCBtZXNoKCl7cmV0dXJuIHRoaXMuX21lc2h9Z2V0IHNlcXVlbmNlRWRnZXMoKXtyZXR1cm4gdGhpcy5fc2VxdWVuY2VFZGdlc31nZXQgc2VxdWVuY2VFZGdlcyQoKXtyZXR1cm4gdGhpcy5fc2VxdWVuY2VFZGdlcyR9Z2V0IHNwYXRpYWxFZGdlcygpe3JldHVybiB0aGlzLl9zcGF0aWFsRWRnZXN9Z2V0IHNwYXRpYWxFZGdlcyQoKXtyZXR1cm4gdGhpcy5fc3BhdGlhbEVkZ2VzJH1jYWNoZUFzc2V0cyQodCxlKXtyZXR1cm4gbnVsbCE9dGhpcy5fY2FjaGluZ0Fzc2V0cyR8fCh0aGlzLl9jYWNoaW5nQXNzZXRzJD1ndCh0aGlzLl9jYWNoZUltYWdlJCh0KSx0aGlzLl9jYWNoZU1lc2gkKHQsZSkpLnBpcGUocnQoKChbdCxlXSk9Pih0aGlzLl9pbWFnZT10LHRoaXMuX21lc2g9ZSx0aGlzKSkpLE1lKCgoKT0+e3RoaXMuX2NhY2hpbmdBc3NldHMkPW51bGx9KSksVWUoMSksRSgpKSx0aGlzLl9jYWNoaW5nQXNzZXRzJC5waXBlKEVlKCh0PT4hIXQuX2ltYWdlKSkpLnN1YnNjcmliZSgoKCk9Pnt0aGlzLl9pbWFnZUNoYW5nZWQkLm5leHQodGhpcy5faW1hZ2UpfSksKCgpPT57fSkpKSx0aGlzLl9jYWNoaW5nQXNzZXRzJH1jYWNoZUltYWdlJCh0KXtpZihudWxsIT10aGlzLl9pbWFnZSlyZXR1cm4gRyh0aGlzKTtjb25zdCBlPXRoaXMuX2NhY2hlSW1hZ2UkKHQpLnBpcGUoRWUoKHQ9PiEhdCkpLHBpKCh0PT57dGhpcy5fZGlzcG9zZUltYWdlKCksdGhpcy5faW1hZ2U9dH0pKSxydCgoKCk9PnRoaXMpKSxVZSgxKSxFKCkpO3JldHVybiBlLnN1YnNjcmliZSgoKCk9Pnt0aGlzLl9pbWFnZUNoYW5nZWQkLm5leHQodGhpcy5faW1hZ2UpfSksKCgpPT57fSkpLGV9Y2FjaGVTZXF1ZW5jZUVkZ2VzKHQpe3RoaXMuX3NlcXVlbmNlRWRnZXM9e2NhY2hlZDohMCxlZGdlczp0fSx0aGlzLl9zZXF1ZW5jZUVkZ2VzQ2hhbmdlZCQubmV4dCh0aGlzLl9zZXF1ZW5jZUVkZ2VzKX1jYWNoZVNwYXRpYWxFZGdlcyh0KXt0aGlzLl9zcGF0aWFsRWRnZXM9e2NhY2hlZDohMCxlZGdlczp0fSx0aGlzLl9zcGF0aWFsRWRnZXNDaGFuZ2VkJC5uZXh0KHRoaXMuX3NwYXRpYWxFZGdlcyl9ZGlzcG9zZSgpe3RoaXMuX2lhbWdlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fc2VxdWVuY2VFZGdlc1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3NwYXRpYWxFZGdlc1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX2Rpc3Bvc2VJbWFnZSgpLHRoaXMuX21lc2g9bnVsbCx0aGlzLl9zZXF1ZW5jZUVkZ2VzPXtjYWNoZWQ6ITEsZWRnZXM6W119LHRoaXMuX3NwYXRpYWxFZGdlcz17Y2FjaGVkOiExLGVkZ2VzOltdfSx0aGlzLl9pbWFnZUNoYW5nZWQkLm5leHQobnVsbCksdGhpcy5fc2VxdWVuY2VFZGdlc0NoYW5nZWQkLm5leHQodGhpcy5fc2VxdWVuY2VFZGdlcyksdGhpcy5fc3BhdGlhbEVkZ2VzQ2hhbmdlZCQubmV4dCh0aGlzLl9zcGF0aWFsRWRnZXMpLHRoaXMuX2Rpc3Bvc2VkPSEwLG51bGwhPXRoaXMuX2ltYWdlQWJvcnRlciYmKHRoaXMuX2ltYWdlQWJvcnRlcigpLHRoaXMuX2ltYWdlQWJvcnRlcj1udWxsKSxudWxsIT10aGlzLl9tZXNoQWJvcnRlciYmKHRoaXMuX21lc2hBYm9ydGVyKCksdGhpcy5fbWVzaEFib3J0ZXI9bnVsbCl9cmVzZXRTZXF1ZW5jZUVkZ2VzKCl7dGhpcy5fc2VxdWVuY2VFZGdlcz17Y2FjaGVkOiExLGVkZ2VzOltdfSx0aGlzLl9zZXF1ZW5jZUVkZ2VzQ2hhbmdlZCQubmV4dCh0aGlzLl9zZXF1ZW5jZUVkZ2VzKX1yZXNldFNwYXRpYWxFZGdlcygpe3RoaXMuX3NwYXRpYWxFZGdlcz17Y2FjaGVkOiExLGVkZ2VzOltdfSx0aGlzLl9zcGF0aWFsRWRnZXNDaGFuZ2VkJC5uZXh0KHRoaXMuX3NwYXRpYWxFZGdlcyl9X2NhY2hlSW1hZ2UkKHQpe3JldHVybiBiLmNyZWF0ZSgoZT0+e2NvbnN0IGk9bmV3IFByb21pc2UoKCh0LGUpPT57dGhpcy5faW1hZ2VBYm9ydGVyPWV9KSksbj10LnRodW1iLnVybDtpZihuKXRoaXMuX3Byb3ZpZGVyLmdldEltYWdlQnVmZmVyKG4saSkudGhlbigodD0+e3RoaXMuX2ltYWdlQWJvcnRlcj1udWxsO2NvbnN0IGk9bmV3IEltYWdlO2kuY3Jvc3NPcmlnaW49XCJBbm9ueW1vdXNcIixpLm9ubG9hZD0oKT0+e2lmKHRoaXMuX2Rpc3Bvc2VkKXt3aW5kb3cuVVJMLnJldm9rZU9iamVjdFVSTChpLnNyYyk7Y29uc3QgdD1gSW1hZ2UgbG9hZCB3YXMgYWJvcnRlZCAoJHtufSlgO2UuZXJyb3IobmV3IEVycm9yKHQpKX1lbHNlIGUubmV4dChpKSxlLmNvbXBsZXRlKCl9LGkub25lcnJvcj0oKT0+e3RoaXMuX2ltYWdlQWJvcnRlcj1udWxsLGUuZXJyb3IobmV3IEVycm9yKGBGYWlsZWQgdG8gbG9hZCBpbWFnZSAoJHtufSlgKSl9O2NvbnN0IHI9bmV3IEJsb2IoW3RdKTtpLnNyYz13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChyKX0pLCh0PT57dGhpcy5faW1hZ2VBYm9ydGVyPW51bGwsZS5lcnJvcih0KX0pKTtlbHNle2NvbnN0IGk9dC50aHVtYi5pZCxyPWBJbmNvcnJlY3QgdGh1bWIgVVJMIGZvciAke3QuaWR9ICgke2l9LCAke259KWA7ZS5lcnJvcihuZXcgRXJyb3IocikpfX0pKX1fY2FjaGVNZXNoJCh0LGUpe3JldHVybiBiLmNyZWF0ZSgoaT0+e2lmKCFlKXJldHVybiBpLm5leHQodGhpcy5fY3JlYXRlRW1wdHlNZXNoKCkpLHZvaWQgaS5jb21wbGV0ZSgpO2NvbnN0IG49dC5tZXNoLnVybDtpZighbil7Y29uc3QgZT10Lm1lc2guaWQscj1gSW5jb3JyZWN0IG1lc2ggVVJMIGZvciAke3QuaWR9ICgke2V9LCAke259KWA7cmV0dXJuIGNvbnNvbGUud2FybihyKSxpLm5leHQodGhpcy5fY3JlYXRlRW1wdHlNZXNoKCkpLHZvaWQgaS5jb21wbGV0ZSgpfWNvbnN0IHI9bmV3IFByb21pc2UoKCh0LGUpPT57dGhpcy5fbWVzaEFib3J0ZXI9ZX0pKTt0aGlzLl9wcm92aWRlci5nZXRNZXNoKG4scikudGhlbigodD0+e3RoaXMuX21lc2hBYm9ydGVyPW51bGwsdGhpcy5fZGlzcG9zZWR8fChpLm5leHQodCksaS5jb21wbGV0ZSgpKX0pLCh0PT57dGhpcy5fbWVzaEFib3J0ZXI9bnVsbCxjb25zb2xlLmVycm9yKHQpLGkubmV4dCh0aGlzLl9jcmVhdGVFbXB0eU1lc2goKSksaS5jb21wbGV0ZSgpfSkpfSkpfV9jcmVhdGVFbXB0eU1lc2goKXtyZXR1cm57ZmFjZXM6W10sdmVydGljZXM6W119fV9kaXNwb3NlSW1hZ2UoKXtudWxsIT10aGlzLl9pbWFnZSYmd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5faW1hZ2Uuc3JjKSx0aGlzLl9pbWFnZT1udWxsfX1jbGFzcyBuZHtjb25zdHJ1Y3Rvcih0KXt0aGlzLl9pZD10LmlkLHRoaXMuX2ltYWdlSWRzPXQuaW1hZ2VfaWRzfWdldCBpZCgpe3JldHVybiB0aGlzLl9pZH1nZXQgaW1hZ2VJZHMoKXtyZXR1cm4gdGhpcy5faW1hZ2VJZHN9ZGlzcG9zZSgpe3RoaXMuX2lkPW51bGwsdGhpcy5faW1hZ2VJZHM9bnVsbH1maW5kTmV4dCh0KXtsZXQgZT10aGlzLl9pbWFnZUlkcy5pbmRleE9mKHQpO3JldHVybiBlKzE+PXRoaXMuX2ltYWdlSWRzLmxlbmd0aHx8LTE9PT1lP251bGw6dGhpcy5faW1hZ2VJZHNbZSsxXX1maW5kUHJldih0KXtsZXQgZT10aGlzLl9pbWFnZUlkcy5pbmRleE9mKHQpO3JldHVybiAwPT09ZXx8LTE9PT1lP251bGw6dGhpcy5faW1hZ2VJZHNbZS0xXX19Y2xhc3MgcmR7Y29uc3RydWN0b3IoKXt0aGlzLnNwaGVyaWNhbFByZWZlcnJlZERpc3RhbmNlPTIsdGhpcy5zcGhlcmljYWxNb3Rpb249Mix0aGlzLnNwaGVyaWNhbFNlcXVlbmNlUGVuYWx0eT0xLHRoaXMuc3BoZXJpY2FsTWVyZ2VDQ1BlbmFsdHk9NCx0aGlzLnN0ZXBQcmVmZXJyZWREaXN0YW5jZT00LHRoaXMuc3RlcE1vdGlvbj0zLHRoaXMuc3RlcFJvdGF0aW9uPTQsdGhpcy5zdGVwU2VxdWVuY2VQZW5hbHR5PTIsdGhpcy5zdGVwTWVyZ2VDQ1BlbmFsdHk9Nix0aGlzLnNpbWlsYXJEaXN0YW5jZT0yLHRoaXMuc2ltaWxhclJvdGF0aW9uPTMsdGhpcy50dXJuRGlzdGFuY2U9NCx0aGlzLnR1cm5Nb3Rpb249Mix0aGlzLnR1cm5TZXF1ZW5jZVBlbmFsdHk9MSx0aGlzLnR1cm5NZXJnZUNDUGVuYWx0eT00fX12YXIgc2Q7dC5OYXZpZ2F0aW9uRGlyZWN0aW9uPXZvaWQgMCwoc2Q9dC5OYXZpZ2F0aW9uRGlyZWN0aW9ufHwodC5OYXZpZ2F0aW9uRGlyZWN0aW9uPXt9KSlbc2QuTmV4dD0wXT1cIk5leHRcIixzZFtzZC5QcmV2PTFdPVwiUHJldlwiLHNkW3NkLlN0ZXBMZWZ0PTJdPVwiU3RlcExlZnRcIixzZFtzZC5TdGVwUmlnaHQ9M109XCJTdGVwUmlnaHRcIixzZFtzZC5TdGVwRm9yd2FyZD00XT1cIlN0ZXBGb3J3YXJkXCIsc2Rbc2QuU3RlcEJhY2t3YXJkPTVdPVwiU3RlcEJhY2t3YXJkXCIsc2Rbc2QuVHVybkxlZnQ9Nl09XCJUdXJuTGVmdFwiLHNkW3NkLlR1cm5SaWdodD03XT1cIlR1cm5SaWdodFwiLHNkW3NkLlR1cm5VPThdPVwiVHVyblVcIixzZFtzZC5TcGhlcmljYWw9OV09XCJTcGhlcmljYWxcIixzZFtzZC5TaW1pbGFyPTEwXT1cIlNpbWlsYXJcIjtjbGFzcyBvZHtjb25zdHJ1Y3Rvcigpe3RoaXMuc3RlcHM9e30sdGhpcy50dXJucz17fSx0aGlzLnNwaGVyaWNhbD17fSx0aGlzLnN0ZXBzW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwRm9yd2FyZF09e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEZvcndhcmQsbW90aW9uQ2hhbmdlOjAsdXNlRmFsbGJhY2s6ITB9LHRoaXMuc3RlcHNbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBCYWNrd2FyZF09e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEJhY2t3YXJkLG1vdGlvbkNoYW5nZTpNYXRoLlBJLHVzZUZhbGxiYWNrOiEwfSx0aGlzLnN0ZXBzW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwTGVmdF09e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcExlZnQsbW90aW9uQ2hhbmdlOk1hdGguUEkvMix1c2VGYWxsYmFjazohMX0sdGhpcy5zdGVwc1t0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcFJpZ2h0XT17ZGlyZWN0aW9uOnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwUmlnaHQsbW90aW9uQ2hhbmdlOi1NYXRoLlBJLzIsdXNlRmFsbGJhY2s6ITF9LHRoaXMudHVybnNbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5MZWZ0XT17ZGlyZWN0aW9uOnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuTGVmdCxkaXJlY3Rpb25DaGFuZ2U6TWF0aC5QSS8yLG1vdGlvbkNoYW5nZTpNYXRoLlBJLzR9LHRoaXMudHVybnNbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5SaWdodF09e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uVHVyblJpZ2h0LGRpcmVjdGlvbkNoYW5nZTotTWF0aC5QSS8yLG1vdGlvbkNoYW5nZTotTWF0aC5QSS80fSx0aGlzLnR1cm5zW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuVV09e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uVHVyblUsZGlyZWN0aW9uQ2hhbmdlOk1hdGguUEksbW90aW9uQ2hhbmdlOm51bGx9LHRoaXMuc3BoZXJpY2FsW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwRm9yd2FyZF09e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEZvcndhcmQsZGlyZWN0aW9uQ2hhbmdlOjAsbmV4dDp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcExlZnQscHJldjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcFJpZ2h0fSx0aGlzLnNwaGVyaWNhbFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEJhY2t3YXJkXT17ZGlyZWN0aW9uOnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwQmFja3dhcmQsZGlyZWN0aW9uQ2hhbmdlOk1hdGguUEksbmV4dDp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcFJpZ2h0LHByZXY6dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBMZWZ0fSx0aGlzLnNwaGVyaWNhbFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcExlZnRdPXtkaXJlY3Rpb246dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBMZWZ0LGRpcmVjdGlvbkNoYW5nZTpNYXRoLlBJLzIsbmV4dDp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEJhY2t3YXJkLHByZXY6dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBGb3J3YXJkfSx0aGlzLnNwaGVyaWNhbFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcFJpZ2h0XT17ZGlyZWN0aW9uOnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwUmlnaHQsZGlyZWN0aW9uQ2hhbmdlOi1NYXRoLlBJLzIsbmV4dDp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEZvcndhcmQscHJldjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEJhY2t3YXJkfX19Y2xhc3MgYWR7Y29uc3RydWN0b3IoKXt0aGlzLnNwaGVyaWNhbE1pbkRpc3RhbmNlPS4xLHRoaXMuc3BoZXJpY2FsTWF4RGlzdGFuY2U9MjAsdGhpcy5zcGhlcmljYWxQcmVmZXJyZWREaXN0YW5jZT01LHRoaXMuc3BoZXJpY2FsTWF4SXRlbXM9NCx0aGlzLnNwaGVyaWNhbE1heFN0ZXBUdXJuQ2hhbmdlPU1hdGguUEkvOCx0aGlzLnJvdGF0aW9uTWF4RGlzdGFuY2U9dGhpcy50dXJuTWF4UmlnRGlzdGFuY2UsdGhpcy5yb3RhdGlvbk1heERpcmVjdGlvbkNoYW5nZT1NYXRoLlBJLzYsdGhpcy5yb3RhdGlvbk1heFZlcnRpY2FsRGlyZWN0aW9uQ2hhbmdlPU1hdGguUEkvOCx0aGlzLnNpbWlsYXJNYXhEaXJlY3Rpb25DaGFuZ2U9TWF0aC5QSS84LHRoaXMuc2ltaWxhck1heERpc3RhbmNlPTEyLHRoaXMuc2ltaWxhck1pblRpbWVEaWZmZXJlbmNlPTQzMmU1LHRoaXMuc3RlcE1heERpc3RhbmNlPTIwLHRoaXMuc3RlcE1heERpcmVjdGlvbkNoYW5nZT1NYXRoLlBJLzYsdGhpcy5zdGVwTWF4RHJpZnQ9TWF0aC5QSS82LHRoaXMuc3RlcFByZWZlcnJlZERpc3RhbmNlPTQsdGhpcy50dXJuTWF4RGlzdGFuY2U9MTUsdGhpcy50dXJuTWF4RGlyZWN0aW9uQ2hhbmdlPTIqTWF0aC5QSS85LHRoaXMudHVybk1heFJpZ0Rpc3RhbmNlPS42NSx0aGlzLnR1cm5NaW5SaWdEaXJlY3Rpb25DaGFuZ2U9TWF0aC5QSS82fWdldCBtYXhEaXN0YW5jZSgpe3JldHVybiBNYXRoLm1heCh0aGlzLnNwaGVyaWNhbE1heERpc3RhbmNlLHRoaXMuc2ltaWxhck1heERpc3RhbmNlLHRoaXMuc3RlcE1heERpc3RhbmNlLHRoaXMudHVybk1heERpc3RhbmNlKX19Y2xhc3MgY2QgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSxPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxjZC5wcm90b3R5cGUpLHRoaXMubmFtZT1cIk1hcGlsbGFyeUVycm9yXCJ9fWNsYXNzIGhkIGV4dGVuZHMgY2R7Y29uc3RydWN0b3IodCl7c3VwZXIobnVsbCE9dD90OlwiVGhlIGFyZ3VtZW50IGlzIG5vdCB2YWxpZC5cIiksT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsaGQucHJvdG90eXBlKSx0aGlzLm5hbWU9XCJBcmd1bWVudE1hcGlsbGFyeUVycm9yXCJ9fWNsYXNzIGxke2NvbnN0cnVjdG9yKCl7dGhpcy5fZXBzaWxvbj0xZS05fWF6aW11dGhhbFRvQmVhcmluZyh0KXtyZXR1cm4tdCtNYXRoLlBJLzJ9ZGVnVG9SYWQodCl7cmV0dXJuIE1hdGguUEkqdC8xODB9cmFkVG9EZWcodCl7cmV0dXJuIDE4MCp0L01hdGguUEl9cm90YXRpb25NYXRyaXgodCl7bGV0IGU9bmV3IGZuKHRbMF0sdFsxXSx0WzJdKSxpPWUubGVuZ3RoKCk7cmV0dXJuIGk+MCYmZS5ub3JtYWxpemUoKSwobmV3IEhuKS5tYWtlUm90YXRpb25BeGlzKGUsaSl9cm90YXRlKHQsZSl7bGV0IGk9bmV3IGZuKHRbMF0sdFsxXSx0WzJdKSxuPXRoaXMucm90YXRpb25NYXRyaXgoZSk7cmV0dXJuIGkuYXBwbHlNYXRyaXg0KG4pLGl9b3B0aWNhbENlbnRlcih0LGUpe2xldCBpPVstdFswXSwtdFsxXSwtdFsyXV0sbj1bLWVbMF0sLWVbMV0sLWVbMl1dO3JldHVybiB0aGlzLnJvdGF0ZShuLGkpfXZpZXdpbmdEaXJlY3Rpb24odCl7bGV0IGU9Wy10WzBdLC10WzFdLC10WzJdXTtyZXR1cm4gdGhpcy5yb3RhdGUoWzAsMCwxXSxlKX13cmFwKHQsZSxpKXtpZihpPGUpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhcmd1bWVudHM6IG1heCBtdXN0IGJlIGxhcmdlciB0aGFuIG1pbi5cIik7bGV0IG49aS1lO2Zvcig7dD5pfHx0PGU7KXQ+aT90LT1uOnQ8ZSYmKHQrPW4pO3JldHVybiB0fXdyYXBBbmdsZSh0KXtyZXR1cm4gdGhpcy53cmFwKHQsLU1hdGguUEksTWF0aC5QSSl9Y2xhbXAodCxlLGkpe3JldHVybiB0PGU/ZTp0Pmk/aTp0fWFuZ2xlQmV0d2VlblZlY3RvcjIodCxlLGksbil7bGV0IHI9TWF0aC5hdGFuMihuLGkpLU1hdGguYXRhbjIoZSx0KTtyZXR1cm4gdGhpcy53cmFwQW5nbGUocil9YW5nbGVEaWZmZXJlbmNlKHQsZSl7bGV0IGk9ZS10O3JldHVybiB0aGlzLndyYXBBbmdsZShpKX1yZWxhdGl2ZVJvdGF0aW9uQW5nbGUodCxlKXtsZXQgaT10aGlzLnJvdGF0aW9uTWF0cml4KFstdFswXSwtdFsxXSwtdFsyXV0pLG49dGhpcy5yb3RhdGlvbk1hdHJpeChlKSxyPWkubXVsdGlwbHkobikuZWxlbWVudHMscz1yWzBdK3JbNV0rclsxMF07cmV0dXJuIE1hdGguYWNvcyhNYXRoLm1heChNYXRoLm1pbigocy0xKS8yLDEpLC0xKSl9YW5nbGVUb1BsYW5lKHQsZSl7bGV0IGk9KG5ldyBmbikuZnJvbUFycmF5KHQpLG49aS5sZW5ndGgoKTtpZihuPHRoaXMuX2Vwc2lsb24pcmV0dXJuIDA7bGV0IHI9aS5kb3QoKG5ldyBmbikuZnJvbUFycmF5KGUpKTtyZXR1cm4gTWF0aC5hc2luKHIvbil9YXppbXV0aGFsKHQsZSl7Y29uc3QgaT0obmV3IGZuKS5mcm9tQXJyYXkodCksbj0obmV3IGZuKS5mcm9tQXJyYXkoZSkscj1pLmNsb25lKCkuZG90KG4pLHM9aS5jbG9uZSgpLnN1YihuLmNsb25lKCkubXVsdGlwbHlTY2FsYXIocikpO3JldHVybiBNYXRoLmF0YW4yKHMueSxzLngpfWRpc3RhbmNlRnJvbUxuZ0xhdCh0LGUsaSxuKXtsZXQgcj10aGlzLmRlZ1RvUmFkKG4tZSkscz10aGlzLmRlZ1RvUmFkKGktdCksbz1NYXRoLnNpbihyLzIpKk1hdGguc2luKHIvMikrTWF0aC5jb3ModGhpcy5kZWdUb1JhZChlKSkqTWF0aC5jb3ModGhpcy5kZWdUb1JhZChuKSkqTWF0aC5zaW4ocy8yKSpNYXRoLnNpbihzLzIpO3JldHVybiAxMjc0MmUzKk1hdGguYXRhbjIoTWF0aC5zcXJ0KG8pLE1hdGguc3FydCgxLW8pKX19Y29uc3QgdWQ9bmV3IGxkO2Z1bmN0aW9uIGRkKHQpe3JldHVyblwic3BoZXJpY2FsXCI9PT10fWZ1bmN0aW9uIHBkKHQpe3JldHVyblwiZmlzaGV5ZVwiPT09dH1mdW5jdGlvbiBmZCh0LGUsaSl7Y29uc3Qgbj1KdSh0LmxuZyx0LmxhdCx0LmFsdCxpLmxuZyxpLmxhdCxpLmFsdCkscj11ZC5yb3RhdGUobixlKTtyZXR1cm5bLXIueCwtci55LC1yLnpdfWZ1bmN0aW9uIG1kKHQsZSxpLG4scil7Y29uc3Qgcz1bXTtmb3IobGV0IHQ9MDt0PGUubGVuZ3RoOysrdCl7Y29uc3Qgcj1lW3RdLG89aVt0XTtmb3IobGV0IHQ9MDt0PD1uOysrdClzLnB1c2goW3JbMF0rb1swXSp0L24sclsxXStvWzFdKnQvbl0pfWNvbnN0IG89bmV3IE5zO28udXAuY29weSh0LnVwVmVjdG9yKCkpLG8ucG9zaXRpb24uY29weSgobmV3IGZuKS5mcm9tQXJyYXkodC51bnByb2plY3RTZk0oWzAsMF0sMCkpKSxvLmxvb2tBdCgobmV3IGZuKS5mcm9tQXJyYXkodC51bnByb2plY3RTZk0oWzAsMF0sMTApKSksby51cGRhdGVNYXRyaXgoKSxvLnVwZGF0ZU1hdHJpeFdvcmxkKCEwKTtyZXR1cm4gcy5tYXAoKGU9Pntjb25zdCBpPXQudW5wcm9qZWN0QmFzaWMoZSwxZTQpLG49ci53b3JsZFRvQ2FtZXJhKGksbyk7cmV0dXJuW01hdGguYWJzKG5bMF0vblsyXSksTWF0aC5hYnMoblsxXS9uWzJdKV19KSl9Y2xhc3MgZ2R7Y29uc3RydWN0b3IodCxlLGkpe3RoaXMuX3NwYXRpYWw9bmV3IGxkLHRoaXMuX3NldHRpbmdzPW51bGwhPXQ/dDpuZXcgYWQsdGhpcy5fZGlyZWN0aW9ucz1udWxsIT1lP2U6bmV3IG9kLHRoaXMuX2NvZWZmaWNpZW50cz1udWxsIT1pP2k6bmV3IHJkfWdldFBvdGVudGlhbEVkZ2VzKHQsZSxpKXtpZighdC5jb21wbGV0ZSl0aHJvdyBuZXcgaGQoXCJJbWFnZSBoYXMgdG8gYmUgZnVsbC5cIik7aWYoIXQubWVyZ2VkKXJldHVybltdO2xldCBuPXRoaXMuX3NwYXRpYWwudmlld2luZ0RpcmVjdGlvbih0LnJvdGF0aW9uKSxyPXRoaXMuX3NwYXRpYWwuYW5nbGVUb1BsYW5lKG4udG9BcnJheSgpLFswLDAsMV0pLHM9W107Zm9yKGxldCBvIG9mIGUpe2lmKCFvLm1lcmdlZHx8by5pZD09PXQuaWQpY29udGludWU7bGV0IGU9SnUoby5sbmdMYXQubG5nLG8ubG5nTGF0LmxhdCxvLmNvbXB1dGVkQWx0aXR1ZGUsdC5sbmdMYXQubG5nLHQubG5nTGF0LmxhdCx0LmNvbXB1dGVkQWx0aXR1ZGUpLGE9bmV3IGZuKGVbMF0sZVsxXSxlWzJdKSxjPWEubGVuZ3RoKCk7aWYoYz50aGlzLl9zZXR0aW5ncy5tYXhEaXN0YW5jZSYmaS5pbmRleE9mKG8uaWQpPDApY29udGludWU7bGV0IGg9dGhpcy5fc3BhdGlhbC5hbmdsZUJldHdlZW5WZWN0b3IyKG4ueCxuLnksYS54LGEueSksbD10aGlzLl9zcGF0aWFsLmFuZ2xlVG9QbGFuZShhLnRvQXJyYXkoKSxbMCwwLDFdKSx1PXRoaXMuX3NwYXRpYWwudmlld2luZ0RpcmVjdGlvbihvLnJvdGF0aW9uKSxkPXRoaXMuX3NwYXRpYWwuYW5nbGVCZXR3ZWVuVmVjdG9yMihuLngsbi55LHUueCx1LnkpLHA9dGhpcy5fc3BhdGlhbC5hbmdsZVRvUGxhbmUodS50b0FycmF5KCksWzAsMCwxXSktcixmPXRoaXMuX3NwYXRpYWwucmVsYXRpdmVSb3RhdGlvbkFuZ2xlKHQucm90YXRpb24sby5yb3RhdGlvbiksbT10aGlzLl9zcGF0aWFsLmFuZ2xlQmV0d2VlblZlY3RvcjIoMSwwLGEueCxhLnkpLGc9bnVsbCE9by5zZXF1ZW5jZUlkJiZudWxsIT10LnNlcXVlbmNlSWQmJm8uc2VxdWVuY2VJZD09PXQuc2VxdWVuY2VJZCxfPW8ubWVyZ2VJZD09PXQubWVyZ2VJZCx2PW8uY3JlYXRvcklkPT09dC5jcmVhdG9ySWQseT17Y2FwdHVyZWRBdDpvLmNhcHR1cmVkQXQsZGlyZWN0aW9uQ2hhbmdlOmQsZGlzdGFuY2U6YyxzcGhlcmljYWw6ZGQoby5jYW1lcmFUeXBlKSxpZDpvLmlkLG1vdGlvbkNoYW5nZTpoLHJvdGF0aW9uOmYsc2FtZU1lcmdlQ0M6XyxzYW1lU2VxdWVuY2U6ZyxzYW1lVXNlcjp2LHNlcXVlbmNlSWQ6by5zZXF1ZW5jZUlkLHZlcnRpY2FsRGlyZWN0aW9uQ2hhbmdlOnAsdmVydGljYWxNb3Rpb246bCx3b3JsZE1vdGlvbkF6aW11dGg6bX07cy5wdXNoKHkpfXJldHVybiBzfWNvbXB1dGVTZXF1ZW5jZUVkZ2VzKGUsaSl7aWYoIWUuY29tcGxldGUpdGhyb3cgbmV3IGhkKFwiSW1hZ2UgaGFzIHRvIGJlIGZ1bGwuXCIpO2lmKGUuc2VxdWVuY2VJZCE9PWkuaWQpdGhyb3cgbmV3IGhkKFwiSW1hZ2UgYW5kIHNlcXVlbmNlIGRvZXMgbm90IGNvcnJlc3BvbmQuXCIpO2xldCBuPVtdLHI9aS5maW5kTmV4dChlLmlkKTtudWxsIT1yJiZuLnB1c2goe2RhdGE6e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCx3b3JsZE1vdGlvbkF6aW11dGg6TnVtYmVyLk5hTn0sc291cmNlOmUuaWQsdGFyZ2V0OnJ9KTtsZXQgcz1pLmZpbmRQcmV2KGUuaWQpO3JldHVybiBudWxsIT1zJiZuLnB1c2goe2RhdGE6e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldix3b3JsZE1vdGlvbkF6aW11dGg6TnVtYmVyLk5hTn0sc291cmNlOmUuaWQsdGFyZ2V0OnN9KSxufWNvbXB1dGVTaW1pbGFyRWRnZXMoZSxpKXtpZighZS5jb21wbGV0ZSl0aHJvdyBuZXcgaGQoXCJJbWFnZSBoYXMgdG8gYmUgZnVsbC5cIik7bGV0IG49ZGQoZS5jYW1lcmFUeXBlKSxyPXt9O2ZvcihsZXQgdCBvZiBpKWlmKG51bGwhPXQuc2VxdWVuY2VJZCYmIXQuc2FtZVNlcXVlbmNlKXtpZihuKXtpZighdC5zcGhlcmljYWwpY29udGludWV9ZWxzZSBpZighdC5zcGhlcmljYWwmJk1hdGguYWJzKHQuZGlyZWN0aW9uQ2hhbmdlKT50aGlzLl9zZXR0aW5ncy5zaW1pbGFyTWF4RGlyZWN0aW9uQ2hhbmdlKWNvbnRpbnVlO3QuZGlzdGFuY2U+dGhpcy5fc2V0dGluZ3Muc2ltaWxhck1heERpc3RhbmNlfHx0LnNhbWVVc2VyJiZNYXRoLmFicyh0LmNhcHR1cmVkQXQtZS5jYXB0dXJlZEF0KTx0aGlzLl9zZXR0aW5ncy5zaW1pbGFyTWluVGltZURpZmZlcmVuY2V8fChudWxsPT1yW3Quc2VxdWVuY2VJZF0mJihyW3Quc2VxdWVuY2VJZF09W10pLHJbdC5zZXF1ZW5jZUlkXS5wdXNoKHQpKX1sZXQgcz1bXSxvPWRkKGUuY2FtZXJhVHlwZSk/dD0+dC5kaXN0YW5jZTp0PT50aGlzLl9jb2VmZmljaWVudHMuc2ltaWxhckRpc3RhbmNlKnQuZGlzdGFuY2UrdGhpcy5fY29lZmZpY2llbnRzLnNpbWlsYXJSb3RhdGlvbip0LnJvdGF0aW9uO2ZvcihsZXQgdCBpbiByKXtpZighci5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtsZXQgZT1OdW1iZXIuTUFYX1ZBTFVFLGk9bnVsbDtmb3IobGV0IG4gb2Ygclt0XSl7bGV0IHQ9byhuKTt0PGUmJihlPXQsaT1uKX1udWxsIT1pJiZzLnB1c2goaSl9cmV0dXJuIHMubWFwKChpPT4oe2RhdGE6e2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU2ltaWxhcix3b3JsZE1vdGlvbkF6aW11dGg6aS53b3JsZE1vdGlvbkF6aW11dGh9LHNvdXJjZTplLmlkLHRhcmdldDppLmlkfSkpKX1jb21wdXRlU3RlcEVkZ2VzKHQsZSxpLG4pe2lmKCF0LmNvbXBsZXRlKXRocm93IG5ldyBoZChcIkltYWdlIGhhcyB0byBiZSBmdWxsLlwiKTtsZXQgcj1bXTtpZihkZCh0LmNhbWVyYVR5cGUpKXJldHVybiByO2ZvcihsZXQgcyBpbiB0aGlzLl9kaXJlY3Rpb25zLnN0ZXBzKXtpZighdGhpcy5fZGlyZWN0aW9ucy5zdGVwcy5oYXNPd25Qcm9wZXJ0eShzKSljb250aW51ZTtsZXQgbz10aGlzLl9kaXJlY3Rpb25zLnN0ZXBzW3NdLGE9TnVtYmVyLk1BWF9WQUxVRSxjPW51bGwsaD1udWxsO2ZvcihsZXQgdCBvZiBlKXtpZih0LnNwaGVyaWNhbCljb250aW51ZTtpZihNYXRoLmFicyh0LmRpcmVjdGlvbkNoYW5nZSk+dGhpcy5fc2V0dGluZ3Muc3RlcE1heERpcmVjdGlvbkNoYW5nZSljb250aW51ZTtsZXQgZT10aGlzLl9zcGF0aWFsLmFuZ2xlRGlmZmVyZW5jZShvLm1vdGlvbkNoYW5nZSx0Lm1vdGlvbkNoYW5nZSkscj10aGlzLl9zcGF0aWFsLmFuZ2xlRGlmZmVyZW5jZSh0LmRpcmVjdGlvbkNoYW5nZSxlKSxzPU1hdGgubWF4KE1hdGguYWJzKGUpLE1hdGguYWJzKHIpKTtpZihNYXRoLmFicyhzKT50aGlzLl9zZXR0aW5ncy5zdGVwTWF4RHJpZnQpY29udGludWU7bGV0IGw9dC5pZDtpZighby51c2VGYWxsYmFja3x8bCE9PWkmJmwhPT1ufHwoaD10KSx0LmRpc3RhbmNlPnRoaXMuX3NldHRpbmdzLnN0ZXBNYXhEaXN0YW5jZSljb250aW51ZTtlPU1hdGguc3FydChlKmUrdC52ZXJ0aWNhbE1vdGlvbip0LnZlcnRpY2FsTW90aW9uKTtsZXQgdT10aGlzLl9jb2VmZmljaWVudHMuc3RlcFByZWZlcnJlZERpc3RhbmNlKk1hdGguYWJzKHQuZGlzdGFuY2UtdGhpcy5fc2V0dGluZ3Muc3RlcFByZWZlcnJlZERpc3RhbmNlKS90aGlzLl9zZXR0aW5ncy5zdGVwTWF4RGlzdGFuY2UrdGhpcy5fY29lZmZpY2llbnRzLnN0ZXBNb3Rpb24qZS90aGlzLl9zZXR0aW5ncy5zdGVwTWF4RHJpZnQrdGhpcy5fY29lZmZpY2llbnRzLnN0ZXBSb3RhdGlvbip0LnJvdGF0aW9uL3RoaXMuX3NldHRpbmdzLnN0ZXBNYXhEaXJlY3Rpb25DaGFuZ2UrdGhpcy5fY29lZmZpY2llbnRzLnN0ZXBTZXF1ZW5jZVBlbmFsdHkqKHQuc2FtZVNlcXVlbmNlPzA6MSkrdGhpcy5fY29lZmZpY2llbnRzLnN0ZXBNZXJnZUNDUGVuYWx0eSoodC5zYW1lTWVyZ2VDQz8wOjEpO3U8YSYmKGE9dSxjPXQpfWM9bnVsbD09Yz9oOmMsbnVsbCE9YyYmci5wdXNoKHtkYXRhOntkaXJlY3Rpb246by5kaXJlY3Rpb24sd29ybGRNb3Rpb25BemltdXRoOmMud29ybGRNb3Rpb25BemltdXRofSxzb3VyY2U6dC5pZCx0YXJnZXQ6Yy5pZH0pfXJldHVybiByfWNvbXB1dGVUdXJuRWRnZXMoZSxpKXtpZighZS5jb21wbGV0ZSl0aHJvdyBuZXcgaGQoXCJJbWFnZSBoYXMgdG8gYmUgZnVsbC5cIik7bGV0IG49W107aWYoZGQoZS5jYW1lcmFUeXBlKSlyZXR1cm4gbjtmb3IobGV0IHIgaW4gdGhpcy5fZGlyZWN0aW9ucy50dXJucyl7aWYoIXRoaXMuX2RpcmVjdGlvbnMudHVybnMuaGFzT3duUHJvcGVydHkocikpY29udGludWU7bGV0IHM9dGhpcy5fZGlyZWN0aW9ucy50dXJuc1tyXSxvPU51bWJlci5NQVhfVkFMVUUsYT1udWxsO2ZvcihsZXQgZSBvZiBpKXtpZihlLnNwaGVyaWNhbCljb250aW51ZTtpZihlLmRpc3RhbmNlPnRoaXMuX3NldHRpbmdzLnR1cm5NYXhEaXN0YW5jZSljb250aW51ZTtsZXQgaSxuPXMuZGlyZWN0aW9uIT09dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5VJiZlLmRpc3RhbmNlPHRoaXMuX3NldHRpbmdzLnR1cm5NYXhSaWdEaXN0YW5jZSYmTWF0aC5hYnMoZS5kaXJlY3Rpb25DaGFuZ2UpPnRoaXMuX3NldHRpbmdzLnR1cm5NaW5SaWdEaXJlY3Rpb25DaGFuZ2Uscj10aGlzLl9zcGF0aWFsLmFuZ2xlRGlmZmVyZW5jZShzLmRpcmVjdGlvbkNoYW5nZSxlLmRpcmVjdGlvbkNoYW5nZSk7aWYobiYmZS5kaXJlY3Rpb25DaGFuZ2Uqcy5kaXJlY3Rpb25DaGFuZ2U+MCYmTWF0aC5hYnMoZS5kaXJlY3Rpb25DaGFuZ2UpPE1hdGguYWJzKHMuZGlyZWN0aW9uQ2hhbmdlKSlpPS1NYXRoLlBJLzIrTWF0aC5hYnMoZS5kaXJlY3Rpb25DaGFuZ2UpO2Vsc2V7aWYoTWF0aC5hYnMocik+dGhpcy5fc2V0dGluZ3MudHVybk1heERpcmVjdGlvbkNoYW5nZSljb250aW51ZTtsZXQgdD1zLm1vdGlvbkNoYW5nZT90aGlzLl9zcGF0aWFsLmFuZ2xlRGlmZmVyZW5jZShzLm1vdGlvbkNoYW5nZSxlLm1vdGlvbkNoYW5nZSk6MDt0PU1hdGguc3FydCh0KnQrZS52ZXJ0aWNhbE1vdGlvbiplLnZlcnRpY2FsTW90aW9uKSxpPXRoaXMuX2NvZWZmaWNpZW50cy50dXJuRGlzdGFuY2UqZS5kaXN0YW5jZS90aGlzLl9zZXR0aW5ncy50dXJuTWF4RGlzdGFuY2UrdGhpcy5fY29lZmZpY2llbnRzLnR1cm5Nb3Rpb24qdC9NYXRoLlBJK3RoaXMuX2NvZWZmaWNpZW50cy50dXJuU2VxdWVuY2VQZW5hbHR5KihlLnNhbWVTZXF1ZW5jZT8wOjEpK3RoaXMuX2NvZWZmaWNpZW50cy50dXJuTWVyZ2VDQ1BlbmFsdHkqKGUuc2FtZU1lcmdlQ0M/MDoxKX1pPG8mJihvPWksYT1lKX1udWxsIT1hJiZuLnB1c2goe2RhdGE6e2RpcmVjdGlvbjpzLmRpcmVjdGlvbix3b3JsZE1vdGlvbkF6aW11dGg6YS53b3JsZE1vdGlvbkF6aW11dGh9LHNvdXJjZTplLmlkLHRhcmdldDphLmlkfSl9cmV0dXJuIG59Y29tcHV0ZVBlcnNwZWN0aXZlVG9TcGhlcmljYWxFZGdlcyhlLGkpe2lmKCFlLmNvbXBsZXRlKXRocm93IG5ldyBoZChcIkltYWdlIGhhcyB0byBiZSBmdWxsLlwiKTtpZihkZChlLmNhbWVyYVR5cGUpKXJldHVybltdO2xldCBuPU51bWJlci5NQVhfVkFMVUUscj1udWxsO2ZvcihsZXQgdCBvZiBpKXtpZighdC5zcGhlcmljYWwpY29udGludWU7bGV0IGU9dGhpcy5fY29lZmZpY2llbnRzLnNwaGVyaWNhbFByZWZlcnJlZERpc3RhbmNlKk1hdGguYWJzKHQuZGlzdGFuY2UtdGhpcy5fc2V0dGluZ3Muc3BoZXJpY2FsUHJlZmVycmVkRGlzdGFuY2UpL3RoaXMuX3NldHRpbmdzLnNwaGVyaWNhbE1heERpc3RhbmNlK3RoaXMuX2NvZWZmaWNpZW50cy5zcGhlcmljYWxNb3Rpb24qTWF0aC5hYnModC5tb3Rpb25DaGFuZ2UpL01hdGguUEkrdGhpcy5fY29lZmZpY2llbnRzLnNwaGVyaWNhbE1lcmdlQ0NQZW5hbHR5Kih0LnNhbWVNZXJnZUNDPzA6MSk7ZTxuJiYobj1lLHI9dCl9cmV0dXJuIG51bGw9PXI/W106W3tkYXRhOntkaXJlY3Rpb246dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlNwaGVyaWNhbCx3b3JsZE1vdGlvbkF6aW11dGg6ci53b3JsZE1vdGlvbkF6aW11dGh9LHNvdXJjZTplLmlkLHRhcmdldDpyLmlkfV19Y29tcHV0ZVNwaGVyaWNhbEVkZ2VzKGUsaSl7aWYoIWUuY29tcGxldGUpdGhyb3cgbmV3IGhkKFwiSW1hZ2UgaGFzIHRvIGJlIGZ1bGwuXCIpO2lmKCFkZChlLmNhbWVyYVR5cGUpKXJldHVybltdO2xldCBuPVtdLHI9W10scz1bXTtmb3IobGV0IHQgb2YgaSlpZighKHQuZGlzdGFuY2U+dGhpcy5fc2V0dGluZ3Muc3BoZXJpY2FsTWF4RGlzdGFuY2UpKWlmKHQuc3BoZXJpY2FsKXtpZih0LmRpc3RhbmNlPHRoaXMuX3NldHRpbmdzLnNwaGVyaWNhbE1pbkRpc3RhbmNlKWNvbnRpbnVlO3IucHVzaCh0KX1lbHNlIGZvcihsZXQgZSBpbiB0aGlzLl9kaXJlY3Rpb25zLnNwaGVyaWNhbCl7aWYoIXRoaXMuX2RpcmVjdGlvbnMuc3BoZXJpY2FsLmhhc093blByb3BlcnR5KGUpKWNvbnRpbnVlO2xldCBpPXRoaXMuX2RpcmVjdGlvbnMuc3BoZXJpY2FsW2VdLG49dGhpcy5fc3BhdGlhbC5hbmdsZURpZmZlcmVuY2UodC5kaXJlY3Rpb25DaGFuZ2UsdC5tb3Rpb25DaGFuZ2UpLHI9dGhpcy5fc3BhdGlhbC5hbmdsZURpZmZlcmVuY2UoaS5kaXJlY3Rpb25DaGFuZ2Usbik7aWYoIShNYXRoLmFicyhyKT50aGlzLl9zZXR0aW5ncy5zcGhlcmljYWxNYXhTdGVwVHVybkNoYW5nZSkpe3MucHVzaChbaS5kaXJlY3Rpb24sdF0pO2JyZWFrfX1sZXQgbz1NYXRoLlBJL3RoaXMuX3NldHRpbmdzLnNwaGVyaWNhbE1heEl0ZW1zLGE9W10sYz1bXTtmb3IobGV0IGk9MDtpPHRoaXMuX3NldHRpbmdzLnNwaGVyaWNhbE1heEl0ZW1zO2krKyl7bGV0IHM9aS90aGlzLl9zZXR0aW5ncy5zcGhlcmljYWxNYXhJdGVtcyoyKk1hdGguUEksaD1OdW1iZXIuTUFYX1ZBTFVFLGw9bnVsbDtmb3IobGV0IHQgb2Ygcil7bGV0IGU9dGhpcy5fc3BhdGlhbC5hbmdsZURpZmZlcmVuY2Uocyx0Lm1vdGlvbkNoYW5nZSk7aWYoTWF0aC5hYnMoZSk+byljb250aW51ZTtsZXQgaT1OdW1iZXIuTUFYX1ZBTFVFO2ZvcihsZXQgZSBvZiBhKXtsZXQgbj1NYXRoLmFicyh0aGlzLl9zcGF0aWFsLmFuZ2xlRGlmZmVyZW5jZShlLHQubW90aW9uQ2hhbmdlKSk7bjxpJiYoaT1uKX1pZihpPD1vKWNvbnRpbnVlO2xldCBuPXRoaXMuX2NvZWZmaWNpZW50cy5zcGhlcmljYWxQcmVmZXJyZWREaXN0YW5jZSpNYXRoLmFicyh0LmRpc3RhbmNlLXRoaXMuX3NldHRpbmdzLnNwaGVyaWNhbFByZWZlcnJlZERpc3RhbmNlKS90aGlzLl9zZXR0aW5ncy5zcGhlcmljYWxNYXhEaXN0YW5jZSt0aGlzLl9jb2VmZmljaWVudHMuc3BoZXJpY2FsTW90aW9uKk1hdGguYWJzKGUpL28rdGhpcy5fY29lZmZpY2llbnRzLnNwaGVyaWNhbFNlcXVlbmNlUGVuYWx0eSoodC5zYW1lU2VxdWVuY2U/MDoxKSt0aGlzLl9jb2VmZmljaWVudHMuc3BoZXJpY2FsTWVyZ2VDQ1BlbmFsdHkqKHQuc2FtZU1lcmdlQ0M/MDoxKTtuPGgmJihoPW4sbD10KX1udWxsIT1sPyhhLnB1c2gobC5tb3Rpb25DaGFuZ2UpLG4ucHVzaCh7ZGF0YTp7ZGlyZWN0aW9uOnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TcGhlcmljYWwsd29ybGRNb3Rpb25BemltdXRoOmwud29ybGRNb3Rpb25BemltdXRofSxzb3VyY2U6ZS5pZCx0YXJnZXQ6bC5pZH0pKTpjLnB1c2gocyl9bGV0IGg9e307aFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3BoZXJpY2FsXT1hLGhbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBGb3J3YXJkXT1bXSxoW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwTGVmdF09W10saFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEJhY2t3YXJkXT1bXSxoW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwUmlnaHRdPVtdO2ZvcihsZXQgaSBvZiBjKXtsZXQgcj1bXTtmb3IobGV0IGEgaW4gdGhpcy5fZGlyZWN0aW9ucy5zcGhlcmljYWwpe2lmKCF0aGlzLl9kaXJlY3Rpb25zLnNwaGVyaWNhbC5oYXNPd25Qcm9wZXJ0eShhKSljb250aW51ZTtsZXQgYz10aGlzLl9kaXJlY3Rpb25zLnNwaGVyaWNhbFthXSxsPWhbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlNwaGVyaWNhbF0uY29uY2F0KGhbYy5kaXJlY3Rpb25dKS5jb25jYXQoaFtjLnByZXZdKS5jb25jYXQoaFtjLm5leHRdKSx1PU51bWJlci5NQVhfVkFMVUUsZD1udWxsO2ZvcihsZXQgdCBvZiBzKXtpZih0WzBdIT09Yy5kaXJlY3Rpb24pY29udGludWU7bGV0IGU9dGhpcy5fc3BhdGlhbC5hbmdsZURpZmZlcmVuY2UoaSx0WzFdLm1vdGlvbkNoYW5nZSk7aWYoTWF0aC5hYnMoZSk+byljb250aW51ZTtsZXQgbj1OdW1iZXIuTUFYX1ZBTFVFO2ZvcihsZXQgZSBvZiBsKXtsZXQgaT1NYXRoLmFicyh0aGlzLl9zcGF0aWFsLmFuZ2xlRGlmZmVyZW5jZShlLHRbMV0ubW90aW9uQ2hhbmdlKSk7aTxuJiYobj1pKX1pZihuPD1vKWNvbnRpbnVlO2xldCByPXRoaXMuX2NvZWZmaWNpZW50cy5zcGhlcmljYWxQcmVmZXJyZWREaXN0YW5jZSpNYXRoLmFicyh0WzFdLmRpc3RhbmNlLXRoaXMuX3NldHRpbmdzLnNwaGVyaWNhbFByZWZlcnJlZERpc3RhbmNlKS90aGlzLl9zZXR0aW5ncy5zcGhlcmljYWxNYXhEaXN0YW5jZSt0aGlzLl9jb2VmZmljaWVudHMuc3BoZXJpY2FsTW90aW9uKk1hdGguYWJzKGUpL28rdGhpcy5fY29lZmZpY2llbnRzLnNwaGVyaWNhbE1lcmdlQ0NQZW5hbHR5Kih0WzFdLnNhbWVNZXJnZUNDPzA6MSk7cjx1JiYodT1yLGQ9dCl9bnVsbCE9ZCYmKHIucHVzaChkKSxuLnB1c2goe2RhdGE6e2RpcmVjdGlvbjpkWzBdLHdvcmxkTW90aW9uQXppbXV0aDpkWzFdLndvcmxkTW90aW9uQXppbXV0aH0sc291cmNlOmUuaWQsdGFyZ2V0OmRbMV0uaWR9KSl9Zm9yKGxldCB0IG9mIHIpaFt0WzBdXS5wdXNoKHRbMV0ubW90aW9uQ2hhbmdlKX1yZXR1cm4gbn19Y2xhc3MgX2QgZXh0ZW5kcyBjZHtjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KSxPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxfZC5wcm90b3R5cGUpLHRoaXMubmFtZT1cIkdyYXBoTWFwaWxsYXJ5RXJyb3JcIn19Y2xhc3MgdmR7Y29uc3RydWN0b3IodCxlLGksbixyLHMpe3RoaXMuX2FwaT10LHRoaXMuX2NhY2hlZE5vZGVzPXt9LHRoaXMuX2NhY2hlZE5vZGVUaWxlcz17fSx0aGlzLl9jYWNoZWRTZXF1ZW5jZU5vZGVzPXt9LHRoaXMuX2NhY2hlZFNwYXRpYWxFZGdlcz17fSx0aGlzLl9jYWNoZWRUaWxlcz17fSx0aGlzLl9jYWNoaW5nRmlsbCQ9e30sdGhpcy5fY2FjaGluZ0Z1bGwkPXt9LHRoaXMuX2NhY2hpbmdTZXF1ZW5jZU5vZGVzJD17fSx0aGlzLl9jYWNoaW5nU2VxdWVuY2VzJD17fSx0aGlzLl9jYWNoaW5nU3BhdGlhbEFyZWEkPXt9LHRoaXMuX2NhY2hpbmdUaWxlcyQ9e30sdGhpcy5fY2hhbmdlZCQ9bmV3IFQsdGhpcy5fZmlsdGVyQ3JlYXRvcj1udWxsIT1yP3I6bmV3IFNpLHRoaXMuX2ZpbHRlcj10aGlzLl9maWx0ZXJDcmVhdG9yLmNyZWF0ZUZpbHRlcih2b2lkIDApLHRoaXMuX2ZpbHRlclN1YmplY3QkPW5ldyBULHRoaXMuX2ZpbHRlciQ9QXQoRyh0aGlzLl9maWx0ZXIpLHRoaXMuX2ZpbHRlclN1YmplY3QkKS5waXBlKFVlKDEpLEUoKSksdGhpcy5fZmlsdGVyU3Vic2NyaXB0aW9uPXRoaXMuX2ZpbHRlciQuc3Vic2NyaWJlKCgoKT0+e30pKSx0aGlzLl9kZWZhdWx0QWx0PTIsdGhpcy5fZWRnZUNhbGN1bGF0b3I9bnVsbCE9bj9uOm5ldyBnZCx0aGlzLl9ncmFwaENhbGN1bGF0b3I9bnVsbCE9aT9pOm5ldyB0ZCx0aGlzLl9jb25maWd1cmF0aW9uPW51bGwhPXM/czp7bWF4U2VxdWVuY2VzOjUwLG1heFVudXNlZEltYWdlczoxMDAsbWF4VW51c2VkUHJlU3RvcmVkSW1hZ2VzOjMwLG1heFVudXNlZFRpbGVzOjIwfSx0aGlzLl9ub2Rlcz17fSx0aGlzLl9ub2RlSW5kZXg9bnVsbCE9ZT9lOm5ldyB2ZC5fc3BhdGlhbEluZGV4KDE2KSx0aGlzLl9ub2RlSW5kZXhUaWxlcz17fSx0aGlzLl9ub2RlVG9UaWxlPXt9LHRoaXMuX3ByZVN0b3JlZD17fSx0aGlzLl9yZXF1aXJlZE5vZGVUaWxlcz17fSx0aGlzLl9yZXF1aXJlZFNwYXRpYWxBcmVhPXt9LHRoaXMuX3NlcXVlbmNlcz17fSx0aGlzLl90aWxlVGhyZXNob2xkPTIwfXN0YXRpYyByZWdpc3Rlcih0KXt2ZC5fc3BhdGlhbEluZGV4PXR9Z2V0IGFwaSgpe3JldHVybiB0aGlzLl9hcGl9Z2V0IGNoYW5nZWQkKCl7cmV0dXJuIHRoaXMuX2NoYW5nZWQkfWdldCBmaWx0ZXIkKCl7cmV0dXJuIHRoaXMuX2ZpbHRlciR9Y2FjaGVCb3VuZGluZ0JveCQodCxlKXtjb25zdCBpPXRoaXMuX2FwaS5kYXRhLmdlb21ldHJ5LmJib3hUb0NlbGxJZHModCxlKS5maWx0ZXIoKHQ9PiEodCBpbiB0aGlzLl9jYWNoZWRUaWxlcykpKS5tYXAoKHQ9PnQgaW4gdGhpcy5fY2FjaGluZ1RpbGVzJD90aGlzLl9jYWNoaW5nVGlsZXMkW3RdOnRoaXMuX2NhY2hlVGlsZSQodCkpKTtyZXR1cm4gMD09PWkubGVuZ3RoJiZpLnB1c2goRyh0aGlzKSksYnQoaSkucGlwZShFdCgpLFJlKCksTXQoKCgpPT57Y29uc3QgaT10aGlzLl9ub2RlSW5kZXguc2VhcmNoKHttYXhYOmUubG5nLG1heFk6ZS5sYXQsbWluWDp0LmxuZyxtaW5ZOnQubGF0fSkubWFwKCh0PT50Lm5vZGUpKSxuPVtdLHI9W107Zm9yKGNvbnN0IHQgb2YgaSl0LmNvbXBsZXRlP24ucHVzaCh0KTpyLnB1c2godC5pZCk7Y29uc3Qgcz1bXTtmb3IoO3IubGVuZ3RoPjA7KXMucHVzaChyLnNwbGljZSgwLDIwMCkpO3JldHVybiBPdChHKG4pLGJ0KHMubWFwKCh0PT50aGlzLl9hcGkuZ2V0U3BhdGlhbEltYWdlcyQodCkucGlwZShydCgodD0+e2NvbnN0IGU9W107Zm9yKGNvbnN0IGkgb2YgdCl7aWYoIXRoaXMuaGFzTm9kZShpLm5vZGVfaWQpKWNvbnRpbnVlO2NvbnN0IHQ9dGhpcy5nZXROb2RlKGkubm9kZV9pZCk7dC5jb21wbGV0ZXx8dGhpcy5fbWFrZUZ1bGwodCxpLm5vZGUpLGUucHVzaCh0KX1yZXR1cm4gZX0pKSkpKSkucGlwZShFdCgpKSl9KSksRGUoKCh0LGUpPT50LmNvbmNhdChlKSkpKX1jYWNoZUNlbGwkKHQpe3JldHVybih0IGluIHRoaXMuX2NhY2hlZFRpbGVzP0codGhpcyk6dCBpbiB0aGlzLl9jYWNoaW5nVGlsZXMkP3RoaXMuX2NhY2hpbmdUaWxlcyRbdF06dGhpcy5fY2FjaGVUaWxlJCh0KSkucGlwZShNdCgoKCk9Pntjb25zdCBlPXRoaXMuX2NhY2hlZFRpbGVzW3RdO2UuYWNjZXNzZWQ9KG5ldyBEYXRlKS5nZXRUaW1lKCk7Y29uc3QgaT1lLm5vZGVzLG49W10scj1bXTtmb3IoY29uc3QgdCBvZiBpKXQuY29tcGxldGU/bi5wdXNoKHQpOnIucHVzaCh0LmlkKTtjb25zdCBzPVtdO2Zvcig7ci5sZW5ndGg+MDspcy5wdXNoKHIuc3BsaWNlKDAsMjAwKSk7cmV0dXJuIE90KEcobiksYnQocy5tYXAoKHQ9PnRoaXMuX2FwaS5nZXRTcGF0aWFsSW1hZ2VzJCh0KS5waXBlKHJ0KCh0PT57Y29uc3QgZT1bXTtmb3IoY29uc3QgaSBvZiB0KXtpZighaS5ub2RlKXtjb25zb2xlLndhcm4oYEltYWdlIGlzIGVtcHR5ICgke2kubm9kZX0pYCk7Y29udGludWV9Y29uc3QgdD1pLm5vZGVfaWQ7aWYoIXRoaXMuaGFzTm9kZSh0KSljb250aW51ZTtjb25zdCBuPXRoaXMuZ2V0Tm9kZSh0KTtuLmNvbXBsZXRlfHx0aGlzLl9tYWtlRnVsbChuLGkubm9kZSksZS5wdXNoKG4pfXJldHVybiBlfSkpKSkpKS5waXBlKEV0KCkpKX0pKSxEZSgoKHQsZSk9PnQuY29uY2F0KGUpKSkpfWNhY2hlRmlsbCQodCl7aWYodCBpbiB0aGlzLl9jYWNoaW5nRnVsbCQpdGhyb3cgbmV3IF9kKGBDYW5ub3QgZmlsbCBub2RlIHdoaWxlIGNhY2hpbmcgZnVsbCAoJHt0fSkuYCk7aWYoIXRoaXMuaGFzTm9kZSh0KSl0aHJvdyBuZXcgX2QoYENhbm5vdCBmaWxsIG5vZGUgdGhhdCBkb2VzIG5vdCBleGlzdCBpbiBncmFwaCAoJHt0fSkuYCk7aWYodCBpbiB0aGlzLl9jYWNoaW5nRmlsbCQpcmV0dXJuIHRoaXMuX2NhY2hpbmdGaWxsJFt0XTtjb25zdCBlPXRoaXMuZ2V0Tm9kZSh0KTtpZihlLmNvbXBsZXRlKXRocm93IG5ldyBfZChgQ2Fubm90IGZpbGwgbm9kZSB0aGF0IGlzIGFscmVhZHkgZnVsbCAoJHt0fSkuYCk7cmV0dXJuIHRoaXMuX2NhY2hpbmdGaWxsJFt0XT10aGlzLl9hcGkuZ2V0U3BhdGlhbEltYWdlcyQoW3RdKS5waXBlKHBpKCh0PT57Zm9yKGNvbnN0IGkgb2YgdClpLm5vZGV8fGNvbnNvbGUud2FybihgSW1hZ2UgaXMgZW1wdHkgJHtpLm5vZGVfaWR9YCksZS5jb21wbGV0ZXx8dGhpcy5fbWFrZUZ1bGwoZSxpLm5vZGUpLGRlbGV0ZSB0aGlzLl9jYWNoaW5nRmlsbCRbaS5ub2RlX2lkXX0pKSxydCgoKCk9PnRoaXMpKSxNZSgoKCk9Pnt0IGluIHRoaXMuX2NhY2hpbmdGaWxsJCYmZGVsZXRlIHRoaXMuX2NhY2hpbmdGaWxsJFt0XSx0aGlzLl9jaGFuZ2VkJC5uZXh0KHRoaXMpfSkpLEhlKCksRSgpKSx0aGlzLl9jYWNoaW5nRmlsbCRbdF19Y2FjaGVGdWxsJCh0KXtpZih0IGluIHRoaXMuX2NhY2hpbmdGdWxsJClyZXR1cm4gdGhpcy5fY2FjaGluZ0Z1bGwkW3RdO2lmKHRoaXMuaGFzTm9kZSh0KSl0aHJvdyBuZXcgX2QoYENhbm5vdCBjYWNoZSBmdWxsIG5vZGUgdGhhdCBhbHJlYWR5IGV4aXN0IGluIGdyYXBoICgke3R9KS5gKTtyZXR1cm4gdGhpcy5fY2FjaGluZ0Z1bGwkW3RdPXRoaXMuX2FwaS5nZXRJbWFnZXMkKFt0XSkucGlwZShwaSgoZT0+e2Zvcihjb25zdCBpIG9mIGUpe2lmKCFpLm5vZGUpdGhyb3cgbmV3IF9kKGBJbWFnZSBkb2VzIG5vdCBleGlzdCAoJHt0fSwgJHtpLm5vZGV9KS5gKTtjb25zdCBlPWkubm9kZV9pZDtpZih0aGlzLmhhc05vZGUoZSkpe2NvbnN0IGU9dGhpcy5nZXROb2RlKHQpO2UuY29tcGxldGV8fHRoaXMuX21ha2VGdWxsKGUsaS5ub2RlKX1lbHNle2lmKG51bGw9PWkubm9kZS5zZXF1ZW5jZS5pZCl0aHJvdyBuZXcgX2QoYEltYWdlIGhhcyBubyBzZXF1ZW5jZSBrZXkgKCR7dH0pLmApO2NvbnN0IG49bmV3IGVkKGkubm9kZSk7dGhpcy5fbWFrZUZ1bGwobixpLm5vZGUpO2NvbnN0IHI9dGhpcy5fYXBpLmRhdGEuZ2VvbWV0cnkubG5nTGF0VG9DZWxsSWQobi5vcmlnaW5hbExuZ0xhdCk7dGhpcy5fcHJlU3RvcmUocixuKSx0aGlzLl9zZXROb2RlKG4pLGRlbGV0ZSB0aGlzLl9jYWNoaW5nRnVsbCRbZV19fX0pKSxydCgoKCk9PnRoaXMpKSxNZSgoKCk9Pnt0IGluIHRoaXMuX2NhY2hpbmdGdWxsJCYmZGVsZXRlIHRoaXMuX2NhY2hpbmdGdWxsJFt0XSx0aGlzLl9jaGFuZ2VkJC5uZXh0KHRoaXMpfSkpLEhlKCksRSgpKSx0aGlzLl9jYWNoaW5nRnVsbCRbdF19Y2FjaGVOb2RlU2VxdWVuY2UkKHQpe2lmKCF0aGlzLmhhc05vZGUodCkpdGhyb3cgbmV3IF9kKGBDYW5ub3QgY2FjaGUgc2VxdWVuY2UgZWRnZXMgb2Ygbm9kZSB0aGF0IGRvZXMgbm90IGV4aXN0IGluIGdyYXBoICgke3R9KS5gKTtsZXQgZT10aGlzLmdldE5vZGUodCk7aWYoZS5zZXF1ZW5jZUlkIGluIHRoaXMuX3NlcXVlbmNlcyl0aHJvdyBuZXcgX2QoYFNlcXVlbmNlIGFscmVhZHkgY2FjaGVkICgke3R9KSwgKCR7ZS5zZXF1ZW5jZUlkfSkuYCk7cmV0dXJuIHRoaXMuX2NhY2hlU2VxdWVuY2UkKGUuc2VxdWVuY2VJZCl9Y2FjaGVTZXF1ZW5jZSQodCl7aWYodCBpbiB0aGlzLl9zZXF1ZW5jZXMpdGhyb3cgbmV3IF9kKGBTZXF1ZW5jZSBhbHJlYWR5IGNhY2hlZCAoJHt0fSlgKTtyZXR1cm4gdGhpcy5fY2FjaGVTZXF1ZW5jZSQodCl9Y2FjaGVTZXF1ZW5jZUVkZ2VzKHQpe2xldCBlPXRoaXMuZ2V0Tm9kZSh0KTtpZighKGUuc2VxdWVuY2VJZCBpbiB0aGlzLl9zZXF1ZW5jZXMpKXRocm93IG5ldyBfZChgU2VxdWVuY2UgaXMgbm90IGNhY2hlZCAoJHt0fSksICgke2Uuc2VxdWVuY2VJZH0pYCk7bGV0IGk9dGhpcy5fc2VxdWVuY2VzW2Uuc2VxdWVuY2VJZF0uc2VxdWVuY2Usbj10aGlzLl9lZGdlQ2FsY3VsYXRvci5jb21wdXRlU2VxdWVuY2VFZGdlcyhlLGkpO2UuY2FjaGVTZXF1ZW5jZUVkZ2VzKG4pfWNhY2hlU2VxdWVuY2VOb2RlcyQodCxlKXtpZighdGhpcy5oYXNTZXF1ZW5jZSh0KSl0aHJvdyBuZXcgX2QoYENhbm5vdCBjYWNoZSBzZXF1ZW5jZSBub2RlcyBvZiBzZXF1ZW5jZSB0aGF0IGRvZXMgbm90IGV4aXN0IGluIGdyYXBoICgke3R9KS5gKTtpZih0aGlzLmhhc1NlcXVlbmNlTm9kZXModCkpdGhyb3cgbmV3IF9kKGBTZXF1ZW5jZSBub2RlcyBhbHJlYWR5IGNhY2hlZCAoJHt0fSkuYCk7Y29uc3QgaT10aGlzLmdldFNlcXVlbmNlKHQpO2lmKGkuaWQgaW4gdGhpcy5fY2FjaGluZ1NlcXVlbmNlTm9kZXMkKXJldHVybiB0aGlzLl9jYWNoaW5nU2VxdWVuY2VOb2RlcyRbaS5pZF07Y29uc3Qgbj1bXSxyPWkuaW1hZ2VJZHMuc2xpY2UoKTtpZihlJiZyLmxlbmd0aD41MCl7Y29uc3QgdD1yLmluZGV4T2YoZSksaT1NYXRoLm1heCgwLE1hdGgubWluKHQtMjUsci5sZW5ndGgtNTApKTtuLnB1c2goci5zcGxpY2UoaSw1MCkpfWZvcig7ci5sZW5ndGg+MDspbi5wdXNoKHIuc3BsaWNlKDAsMjAwKSk7bGV0IHM9bi5sZW5ndGg7Y29uc3Qgbz1idChuKS5waXBlKE10KCh0PT50aGlzLl9hcGkuZ2V0SW1hZ2VzJCh0KS5waXBlKHBpKCh0PT57Zm9yKGNvbnN0IGUgb2YgdCl7aWYoIWUubm9kZSl7Y29uc29sZS53YXJuKGBJbWFnZSBlbXB0eSAoJHtlLm5vZGVfaWR9KWApO2NvbnRpbnVlfWNvbnN0IHQ9ZS5ub2RlX2lkO2lmKHRoaXMuaGFzTm9kZSh0KSl7Y29uc3QgaT10aGlzLmdldE5vZGUodCk7aS5jb21wbGV0ZXx8dGhpcy5fbWFrZUZ1bGwoaSxlLm5vZGUpfWVsc2V7bnVsbD09ZS5ub2RlLnNlcXVlbmNlLmlkJiZjb25zb2xlLndhcm4oYFNlcXVlbmNlIG1pc3NpbmcsIGRpc2NhcmRpbmcgbm9kZSAoJHtlLm5vZGVfaWR9KWApO2NvbnN0IHQ9bmV3IGVkKGUubm9kZSk7dGhpcy5fbWFrZUZ1bGwodCxlLm5vZGUpO2NvbnN0IGk9dGhpcy5fYXBpLmRhdGEuZ2VvbWV0cnkubG5nTGF0VG9DZWxsSWQodC5vcmlnaW5hbExuZ0xhdCk7dGhpcy5fcHJlU3RvcmUoaSx0KSx0aGlzLl9zZXROb2RlKHQpfX1zLS19KSkscnQoKCgpPT50aGlzKSkpKSw2KSxSZSgpLE1lKCgoKT0+e2RlbGV0ZSB0aGlzLl9jYWNoaW5nU2VxdWVuY2VOb2RlcyRbaS5pZF0sMD09PXMmJih0aGlzLl9jYWNoZWRTZXF1ZW5jZU5vZGVzW2kuaWRdPSEwKX0pKSxIZSgpLEUoKSk7cmV0dXJuIHRoaXMuX2NhY2hpbmdTZXF1ZW5jZU5vZGVzJFtpLmlkXT1vLG99Y2FjaGVTcGF0aWFsQXJlYSQodCl7aWYoIXRoaXMuaGFzTm9kZSh0KSl0aHJvdyBuZXcgX2QoYENhbm5vdCBjYWNoZSBzcGF0aWFsIGFyZWEgb2Ygbm9kZSB0aGF0IGRvZXMgbm90IGV4aXN0IGluIGdyYXBoICgke3R9KS5gKTtpZih0IGluIHRoaXMuX2NhY2hlZFNwYXRpYWxFZGdlcyl0aHJvdyBuZXcgX2QoYEltYWdlIGFscmVhZHkgc3BhdGlhbGx5IGNhY2hlZCAoJHt0fSkuYCk7aWYoISh0IGluIHRoaXMuX3JlcXVpcmVkU3BhdGlhbEFyZWEpKXRocm93IG5ldyBfZChgU3BhdGlhbCBhcmVhIG5vdCBkZXRlcm1pbmVkICgke3R9KS5gKTtsZXQgZT10aGlzLl9yZXF1aXJlZFNwYXRpYWxBcmVhW3RdO2lmKDA9PT1PYmplY3Qua2V5cyhlLmNhY2hlTm9kZXMpLmxlbmd0aCl0aHJvdyBuZXcgX2QoYFNwYXRpYWwgbm9kZXMgYWxyZWFkeSBjYWNoZWQgKCR7dH0pLmApO2lmKHQgaW4gdGhpcy5fY2FjaGluZ1NwYXRpYWxBcmVhJClyZXR1cm4gdGhpcy5fY2FjaGluZ1NwYXRpYWxBcmVhJFt0XTtsZXQgaT1bXTtmb3IoO2UuY2FjaGVLZXlzLmxlbmd0aD4wOylpLnB1c2goZS5jYWNoZUtleXMuc3BsaWNlKDAsMjAwKSk7bGV0IG49aS5sZW5ndGgscj1bXTtmb3IobGV0IHMgb2YgaSl7bGV0IGk9dGhpcy5fYXBpLmdldFNwYXRpYWxJbWFnZXMkKHMpLnBpcGUocGkoKGk9Pntmb3IoY29uc3QgdCBvZiBpKXtpZighdC5ub2RlKXtjb25zb2xlLndhcm4oYEltYWdlIGlzIGVtcHR5ICgke3Qubm9kZV9pZH0pYCk7Y29udGludWV9Y29uc3QgaT10Lm5vZGVfaWQsbj1lLmNhY2hlTm9kZXNbaV07bi5jb21wbGV0ZT9kZWxldGUgZS5jYWNoZU5vZGVzW2ldOih0aGlzLl9tYWtlRnVsbChuLHQubm9kZSksZGVsZXRlIGUuY2FjaGVOb2Rlc1tpXSl9MD09LS1uJiZkZWxldGUgdGhpcy5fY2FjaGluZ1NwYXRpYWxBcmVhJFt0XX0pKSxydCgoKCk9PnRoaXMpKSx0ZSgoaT0+e2ZvcihsZXQgdCBvZiBzKXQgaW4gZS5hbGwmJmRlbGV0ZSBlLmFsbFt0XSx0IGluIGUuY2FjaGVOb2RlcyYmZGVsZXRlIGUuY2FjaGVOb2Rlc1t0XTt0aHJvdyAwPT0tLW4mJmRlbGV0ZSB0aGlzLl9jYWNoaW5nU3BhdGlhbEFyZWEkW3RdLGl9KSksTWUoKCgpPT57MD09PU9iamVjdC5rZXlzKGUuY2FjaGVOb2RlcykubGVuZ3RoJiZ0aGlzLl9jaGFuZ2VkJC5uZXh0KHRoaXMpfSkpLEhlKCksRSgpKTtyLnB1c2goaSl9cmV0dXJuIHRoaXMuX2NhY2hpbmdTcGF0aWFsQXJlYSRbdF09cixyfWNhY2hlU3BhdGlhbEVkZ2VzKHQpe2lmKHQgaW4gdGhpcy5fY2FjaGVkU3BhdGlhbEVkZ2VzKXRocm93IG5ldyBfZChgU3BhdGlhbCBlZGdlcyBhbHJlYWR5IGNhY2hlZCAoJHt0fSkuYCk7bGV0IGU9dGhpcy5nZXROb2RlKHQpLGk9dGhpcy5fc2VxdWVuY2VzW2Uuc2VxdWVuY2VJZF0uc2VxdWVuY2Usbj1bXSxyPWkuZmluZFByZXYoZS5pZCk7bnVsbCE9ciYmbi5wdXNoKHIpO2xldCBzPWkuZmluZE5leHQoZS5pZCk7bnVsbCE9cyYmbi5wdXNoKHMpO2xldCBvPXRoaXMuX3JlcXVpcmVkU3BhdGlhbEFyZWFbdF0uYWxsLGE9W10sYz10aGlzLl9maWx0ZXI7Zm9yKGxldCB0IGluIG8pe2lmKCFvLmhhc093blByb3BlcnR5KHQpKWNvbnRpbnVlO2xldCBlPW9bdF07YyhlKSYmYS5wdXNoKGUpfWxldCBoPXRoaXMuX2VkZ2VDYWxjdWxhdG9yLmdldFBvdGVudGlhbEVkZ2VzKGUsYSxuKSxsPXRoaXMuX2VkZ2VDYWxjdWxhdG9yLmNvbXB1dGVTdGVwRWRnZXMoZSxoLHIscyk7bD1sLmNvbmNhdCh0aGlzLl9lZGdlQ2FsY3VsYXRvci5jb21wdXRlVHVybkVkZ2VzKGUsaCkpLGw9bC5jb25jYXQodGhpcy5fZWRnZUNhbGN1bGF0b3IuY29tcHV0ZVNwaGVyaWNhbEVkZ2VzKGUsaCkpLGw9bC5jb25jYXQodGhpcy5fZWRnZUNhbGN1bGF0b3IuY29tcHV0ZVBlcnNwZWN0aXZlVG9TcGhlcmljYWxFZGdlcyhlLGgpKSxsPWwuY29uY2F0KHRoaXMuX2VkZ2VDYWxjdWxhdG9yLmNvbXB1dGVTaW1pbGFyRWRnZXMoZSxoKSksZS5jYWNoZVNwYXRpYWxFZGdlcyhsKSx0aGlzLl9jYWNoZWRTcGF0aWFsRWRnZXNbdF09ZSxkZWxldGUgdGhpcy5fcmVxdWlyZWRTcGF0aWFsQXJlYVt0XSxkZWxldGUgdGhpcy5fY2FjaGVkTm9kZVRpbGVzW3RdfWNhY2hlVGlsZXMkKHQpe2lmKHQgaW4gdGhpcy5fY2FjaGVkTm9kZVRpbGVzKXRocm93IG5ldyBfZChgVGlsZXMgYWxyZWFkeSBjYWNoZWQgKCR7dH0pLmApO2lmKHQgaW4gdGhpcy5fY2FjaGVkU3BhdGlhbEVkZ2VzKXRocm93IG5ldyBfZChgU3BhdGlhbCBlZGdlcyBhbHJlYWR5IGNhY2hlZCBzbyB0aWxlcyBjb25zaWRlcmVkIGNhY2hlZCAoJHt0fSkuYCk7aWYoISh0IGluIHRoaXMuX3JlcXVpcmVkTm9kZVRpbGVzKSl0aHJvdyBuZXcgX2QoYFRpbGVzIGhhdmUgbm90IGJlZW4gZGV0ZXJtaW5lZCAoJHt0fSkuYCk7bGV0IGU9dGhpcy5fcmVxdWlyZWROb2RlVGlsZXNbdF07aWYoMD09PWUuY2FjaGUubGVuZ3RoJiYwPT09ZS5jYWNoaW5nLmxlbmd0aCl0aHJvdyBuZXcgX2QoYFRpbGVzIGFscmVhZHkgY2FjaGVkICgke3R9KS5gKTtpZighdGhpcy5oYXNOb2RlKHQpKXRocm93IG5ldyBfZChgQ2Fubm90IGNhY2hlIHRpbGVzIG9mIG5vZGUgdGhhdCBkb2VzIG5vdCBleGlzdCBpbiBncmFwaCAoJHt0fSkuYCk7bGV0IGk9ZS5jYWNoZS5zbGljZSgpO2UuY2FjaGluZz10aGlzLl9yZXF1aXJlZE5vZGVUaWxlc1t0XS5jYWNoaW5nLmNvbmNhdChpKSxlLmNhY2hlPVtdO2xldCBuPVtdO2ZvcihsZXQgaSBvZiBlLmNhY2hpbmcpe2NvbnN0IHI9aSBpbiB0aGlzLl9jYWNoaW5nVGlsZXMkP3RoaXMuX2NhY2hpbmdUaWxlcyRbaV06dGhpcy5fY2FjaGVUaWxlJChpKTtuLnB1c2goci5waXBlKHBpKChuPT57bGV0IHI9ZS5jYWNoaW5nLmluZGV4T2YoaSk7cj4tMSYmZS5jYWNoaW5nLnNwbGljZShyLDEpLDA9PT1lLmNhY2hpbmcubGVuZ3RoJiYwPT09ZS5jYWNoZS5sZW5ndGgmJihkZWxldGUgdGhpcy5fcmVxdWlyZWROb2RlVGlsZXNbdF0sdGhpcy5fY2FjaGVkTm9kZVRpbGVzW3RdPSEwKX0pKSx0ZSgobj0+e2xldCByPWUuY2FjaGluZy5pbmRleE9mKGkpO3Rocm93IHI+LTEmJmUuY2FjaGluZy5zcGxpY2UociwxKSwwPT09ZS5jYWNoaW5nLmxlbmd0aCYmMD09PWUuY2FjaGUubGVuZ3RoJiYoZGVsZXRlIHRoaXMuX3JlcXVpcmVkTm9kZVRpbGVzW3RdLHRoaXMuX2NhY2hlZE5vZGVUaWxlc1t0XT0hMCksbn0pKSxNZSgoKCk9Pnt0aGlzLl9jaGFuZ2VkJC5uZXh0KHRoaXMpfSkpLEhlKCksRSgpKSl9cmV0dXJuIG59aW5pdGlhbGl6ZUNhY2hlKHQpe2lmKHQgaW4gdGhpcy5fY2FjaGVkTm9kZXMpdGhyb3cgbmV3IF9kKGBJbWFnZSBhbHJlYWR5IGluIGNhY2hlICgke3R9KS5gKTtjb25zdCBlPXRoaXMuZ2V0Tm9kZSh0KSxpPXRoaXMuX2FwaS5kYXRhO2UuaW5pdGlhbGl6ZUNhY2hlKG5ldyBpZChpKSk7Y29uc3Qgbj0obmV3IERhdGUpLmdldFRpbWUoKTt0aGlzLl9jYWNoZWROb2Rlc1t0XT17YWNjZXNzZWQ6bixub2RlOmV9LHRoaXMuX3VwZGF0ZUNhY2hlZFRpbGVBY2Nlc3ModCxuKX1pc0NhY2hpbmdGaWxsKHQpe3JldHVybiB0IGluIHRoaXMuX2NhY2hpbmdGaWxsJH1pc0NhY2hpbmdGdWxsKHQpe3JldHVybiB0IGluIHRoaXMuX2NhY2hpbmdGdWxsJH1pc0NhY2hpbmdOb2RlU2VxdWVuY2UodCl7cmV0dXJuIHRoaXMuZ2V0Tm9kZSh0KS5zZXF1ZW5jZUlkIGluIHRoaXMuX2NhY2hpbmdTZXF1ZW5jZXMkfWlzQ2FjaGluZ1NlcXVlbmNlKHQpe3JldHVybiB0IGluIHRoaXMuX2NhY2hpbmdTZXF1ZW5jZXMkfWlzQ2FjaGluZ1NlcXVlbmNlTm9kZXModCl7cmV0dXJuIHQgaW4gdGhpcy5fY2FjaGluZ1NlcXVlbmNlTm9kZXMkfWlzQ2FjaGluZ1RpbGVzKHQpe3JldHVybiB0IGluIHRoaXMuX3JlcXVpcmVkTm9kZVRpbGVzJiYwPT09dGhpcy5fcmVxdWlyZWROb2RlVGlsZXNbdF0uY2FjaGUubGVuZ3RoJiZ0aGlzLl9yZXF1aXJlZE5vZGVUaWxlc1t0XS5jYWNoaW5nLmxlbmd0aD4wfWhhc0luaXRpYWxpemVkQ2FjaGUodCl7cmV0dXJuIHQgaW4gdGhpcy5fY2FjaGVkTm9kZXN9aGFzTm9kZSh0KXtsZXQgZT0obmV3IERhdGUpLmdldFRpbWUoKTtyZXR1cm4gdGhpcy5fdXBkYXRlQ2FjaGVkTm9kZUFjY2Vzcyh0LGUpLHRoaXMuX3VwZGF0ZUNhY2hlZFRpbGVBY2Nlc3ModCxlKSx0IGluIHRoaXMuX25vZGVzfWhhc05vZGVTZXF1ZW5jZSh0KXtsZXQgZT10aGlzLmdldE5vZGUodCkuc2VxdWVuY2VJZCxpPWUgaW4gdGhpcy5fc2VxdWVuY2VzO3JldHVybiBpJiYodGhpcy5fc2VxdWVuY2VzW2VdLmFjY2Vzc2VkPShuZXcgRGF0ZSkuZ2V0VGltZSgpKSxpfWhhc1NlcXVlbmNlKHQpe2xldCBlPXQgaW4gdGhpcy5fc2VxdWVuY2VzO3JldHVybiBlJiYodGhpcy5fc2VxdWVuY2VzW3RdLmFjY2Vzc2VkPShuZXcgRGF0ZSkuZ2V0VGltZSgpKSxlfWhhc1NlcXVlbmNlTm9kZXModCl7cmV0dXJuIHQgaW4gdGhpcy5fY2FjaGVkU2VxdWVuY2VOb2Rlc31oYXNTcGF0aWFsQXJlYSh0KXtpZighdGhpcy5oYXNOb2RlKHQpKXRocm93IG5ldyBfZChgU3BhdGlhbCBhcmVhIG5vZGVzIGNhbm5vdCBiZSBkZXRlcm1pbmVkIGlmIG5vZGUgbm90IGluIGdyYXBoICgke3R9KS5gKTtpZih0IGluIHRoaXMuX2NhY2hlZFNwYXRpYWxFZGdlcylyZXR1cm4hMDtpZih0IGluIHRoaXMuX3JlcXVpcmVkU3BhdGlhbEFyZWEpcmV0dXJuIDA9PT1PYmplY3Qua2V5cyh0aGlzLl9yZXF1aXJlZFNwYXRpYWxBcmVhW3RdLmNhY2hlTm9kZXMpLmxlbmd0aDtsZXQgZT10aGlzLmdldE5vZGUodCksaT10aGlzLl9ncmFwaENhbGN1bGF0b3IuYm91bmRpbmdCb3hDb3JuZXJzKGUubG5nTGF0LHRoaXMuX3RpbGVUaHJlc2hvbGQpLG49dGhpcy5fbm9kZUluZGV4LnNlYXJjaCh7bWF4WDppWzFdLmxuZyxtYXhZOmlbMV0ubGF0LG1pblg6aVswXS5sbmcsbWluWTppWzBdLmxhdH0pLHI9e2FsbDp7fSxjYWNoZUtleXM6W10sY2FjaGVOb2Rlczp7fX07Zm9yKGxldCB0IG9mIG4pci5hbGxbdC5ub2RlLmlkXT10Lm5vZGUsdC5ub2RlLmNvbXBsZXRlfHwoci5jYWNoZUtleXMucHVzaCh0Lm5vZGUuaWQpLHIuY2FjaGVOb2Rlc1t0Lm5vZGUuaWRdPXQubm9kZSk7cmV0dXJuIHRoaXMuX3JlcXVpcmVkU3BhdGlhbEFyZWFbdF09ciwwPT09ci5jYWNoZUtleXMubGVuZ3RofWhhc1RpbGVzKHQpe2lmKHQgaW4gdGhpcy5fY2FjaGVkTm9kZVRpbGVzKXJldHVybiEwO2lmKHQgaW4gdGhpcy5fY2FjaGVkU3BhdGlhbEVkZ2VzKXJldHVybiEwO2lmKCF0aGlzLmhhc05vZGUodCkpdGhyb3cgbmV3IF9kKGBJbWFnZSBkb2VzIG5vdCBleGlzdCBpbiBncmFwaCAoJHt0fSkuYCk7bGV0IGU9e2NhY2hlOltdLGNhY2hpbmc6W119O2lmKHQgaW4gdGhpcy5fcmVxdWlyZWROb2RlVGlsZXMpZT10aGlzLl9yZXF1aXJlZE5vZGVUaWxlc1t0XTtlbHNle2NvbnN0IGk9dGhpcy5nZXROb2RlKHQpLFtuLHJdPXRoaXMuX2dyYXBoQ2FsY3VsYXRvci5ib3VuZGluZ0JveENvcm5lcnMoaS5sbmdMYXQsdGhpcy5fdGlsZVRocmVzaG9sZCk7ZS5jYWNoZT10aGlzLl9hcGkuZGF0YS5nZW9tZXRyeS5iYm94VG9DZWxsSWRzKG4scikuZmlsdGVyKCh0PT4hKHQgaW4gdGhpcy5fY2FjaGVkVGlsZXMpKSksZS5jYWNoZS5sZW5ndGg+MCYmKHRoaXMuX3JlcXVpcmVkTm9kZVRpbGVzW3RdPWUpfXJldHVybiAwPT09ZS5jYWNoZS5sZW5ndGgmJjA9PT1lLmNhY2hpbmcubGVuZ3RofWdldE5vZGUodCl7bGV0IGU9KG5ldyBEYXRlKS5nZXRUaW1lKCk7cmV0dXJuIHRoaXMuX3VwZGF0ZUNhY2hlZE5vZGVBY2Nlc3ModCxlKSx0aGlzLl91cGRhdGVDYWNoZWRUaWxlQWNjZXNzKHQsZSksdGhpcy5fbm9kZXNbdF19Z2V0U2VxdWVuY2UodCl7bGV0IGU9dGhpcy5fc2VxdWVuY2VzW3RdO3JldHVybiBlLmFjY2Vzc2VkPShuZXcgRGF0ZSkuZ2V0VGltZSgpLGUuc2VxdWVuY2V9cmVzZXRTcGF0aWFsRWRnZXMoKXtsZXQgdD1PYmplY3Qua2V5cyh0aGlzLl9jYWNoZWRTcGF0aWFsRWRnZXMpO2ZvcihsZXQgZSBvZiB0KXt0aGlzLl9jYWNoZWRTcGF0aWFsRWRnZXNbZV0ucmVzZXRTcGF0aWFsRWRnZXMoKSxkZWxldGUgdGhpcy5fY2FjaGVkU3BhdGlhbEVkZ2VzW2VdfX1yZXNldCh0KXtjb25zdCBlPVtdO2Zvcihjb25zdCBpIG9mIHQpe2lmKCF0aGlzLmhhc05vZGUoaSkpdGhyb3cgbmV3IEVycm9yKGBJbWFnZSBkb2VzIG5vdCBleGlzdCAke2l9YCk7Y29uc3QgdD10aGlzLmdldE5vZGUoaSk7dC5yZXNldFNlcXVlbmNlRWRnZXMoKSx0LnJlc2V0U3BhdGlhbEVkZ2VzKCksZS5wdXNoKHQpfWZvcihsZXQgZSBvZiBPYmplY3Qua2V5cyh0aGlzLl9jYWNoZWROb2RlcykpLTE9PT10LmluZGV4T2YoZSkmJih0aGlzLl9jYWNoZWROb2Rlc1tlXS5ub2RlLmRpc3Bvc2UoKSxkZWxldGUgdGhpcy5fY2FjaGVkTm9kZXNbZV0pO3RoaXMuX2NhY2hlZE5vZGVUaWxlcz17fSx0aGlzLl9jYWNoZWRTcGF0aWFsRWRnZXM9e30sdGhpcy5fY2FjaGVkVGlsZXM9e30sdGhpcy5fY2FjaGluZ0ZpbGwkPXt9LHRoaXMuX2NhY2hpbmdGdWxsJD17fSx0aGlzLl9jYWNoaW5nU2VxdWVuY2VzJD17fSx0aGlzLl9jYWNoaW5nU3BhdGlhbEFyZWEkPXt9LHRoaXMuX2NhY2hpbmdUaWxlcyQ9e30sdGhpcy5fbm9kZXM9e30sdGhpcy5fbm9kZVRvVGlsZT17fSx0aGlzLl9wcmVTdG9yZWQ9e307Zm9yKGNvbnN0IHQgb2YgZSl7dGhpcy5fbm9kZXNbdC5pZF09dDtjb25zdCBlPXRoaXMuX2FwaS5kYXRhLmdlb21ldHJ5LmxuZ0xhdFRvQ2VsbElkKHQub3JpZ2luYWxMbmdMYXQpO3RoaXMuX3ByZVN0b3JlKGUsdCl9dGhpcy5fcmVxdWlyZWROb2RlVGlsZXM9e30sdGhpcy5fcmVxdWlyZWRTcGF0aWFsQXJlYT17fSx0aGlzLl9zZXF1ZW5jZXM9e30sdGhpcy5fbm9kZUluZGV4VGlsZXM9e30sdGhpcy5fbm9kZUluZGV4LmNsZWFyKCl9c2V0RmlsdGVyKHQpe3RoaXMuX2ZpbHRlcj10aGlzLl9maWx0ZXJDcmVhdG9yLmNyZWF0ZUZpbHRlcih0KSx0aGlzLl9maWx0ZXJTdWJqZWN0JC5uZXh0KHRoaXMuX2ZpbHRlcil9dW5jYWNoZSh0LGUsaSl7Y29uc3Qgbj17fTt0aGlzLl9hZGROZXdLZXlzKG4sdGhpcy5fY2FjaGluZ0Z1bGwkKSx0aGlzLl9hZGROZXdLZXlzKG4sdGhpcy5fY2FjaGluZ0ZpbGwkKSx0aGlzLl9hZGROZXdLZXlzKG4sdGhpcy5fY2FjaGluZ1NwYXRpYWxBcmVhJCksdGhpcy5fYWRkTmV3S2V5cyhuLHRoaXMuX3JlcXVpcmVkTm9kZVRpbGVzKSx0aGlzLl9hZGROZXdLZXlzKG4sdGhpcy5fcmVxdWlyZWRTcGF0aWFsQXJlYSk7Zm9yKGNvbnN0IGUgb2YgdCllIGluIG58fChuW2VdPSEwKTtjb25zdCByPXRoaXMuX3RpbGVUaHJlc2hvbGQscz10aGlzLl9ncmFwaENhbGN1bGF0b3Isbz10aGlzLl9hcGkuZGF0YS5nZW9tZXRyeSxhPW5ldyBTZXQoZSk7Zm9yKGxldCB0IGluIG4pe2lmKCFuLmhhc093blByb3BlcnR5KHQpKWNvbnRpbnVlO2NvbnN0IGU9dGhpcy5fbm9kZXNbdF0sW2ksY109cy5ib3VuZGluZ0JveENvcm5lcnMoZS5sbmdMYXQsciksaD1vLmJib3hUb0NlbGxJZHMoaSxjKTtmb3IoY29uc3QgdCBvZiBoKWEuaGFzKHQpfHxhLmFkZCh0KX1jb25zdCBjPVtdO2ZvcihsZXQgdCBpbiB0aGlzLl9jYWNoZWRUaWxlcyl0aGlzLl9jYWNoZWRUaWxlcy5oYXNPd25Qcm9wZXJ0eSh0KSYmIWEuaGFzKHQpJiZjLnB1c2goW3QsdGhpcy5fY2FjaGVkVGlsZXNbdF1dKTtjb25zdCBoPWMuc29ydCgoKHQsZSk9PmVbMV0uYWNjZXNzZWQtdFsxXS5hY2Nlc3NlZCkpLnNsaWNlKHRoaXMuX2NvbmZpZ3VyYXRpb24ubWF4VW51c2VkVGlsZXMpLm1hcCgodD0+dFswXSkpO2ZvcihsZXQgdCBvZiBoKXRoaXMuX3VuY2FjaGVUaWxlKHQsaSk7Y29uc3QgbD1bXSx1PVtdO2ZvcihsZXQgdCBpbiB0aGlzLl9wcmVTdG9yZWQpe2lmKCF0aGlzLl9wcmVTdG9yZWQuaGFzT3duUHJvcGVydHkodCl8fHQgaW4gdGhpcy5fY2FjaGluZ1RpbGVzJCljb250aW51ZTtjb25zdCBlPXRoaXMuX3ByZVN0b3JlZFt0XTtmb3IobGV0IHIgaW4gZSllLmhhc093blByb3BlcnR5KHIpJiYhKHIgaW4gbikmJmVbcl0uc2VxdWVuY2VJZCE9PWkmJihyIGluIHRoaXMuX2NhY2hlZE5vZGVzP2wucHVzaChbdGhpcy5fY2FjaGVkTm9kZXNbcl0sdF0pOnUucHVzaChbcix0XSkpfWNvbnN0IGQ9bC5zb3J0KCgoW3RdLFtlXSk9PmUuYWNjZXNzZWQtdC5hY2Nlc3NlZCkpLnNsaWNlKHRoaXMuX2NvbmZpZ3VyYXRpb24ubWF4VW51c2VkUHJlU3RvcmVkSW1hZ2VzKS5tYXAoKChbdCxlXSk9Plt0Lm5vZGUuaWQsZV0pKTt0aGlzLl91bmNhY2hlUHJlU3RvcmVkKHUpLHRoaXMuX3VuY2FjaGVQcmVTdG9yZWQoZCk7Y29uc3QgcD1bXTtmb3IobGV0IHQgaW4gdGhpcy5fY2FjaGVkTm9kZXMpdGhpcy5fY2FjaGVkTm9kZXMuaGFzT3duUHJvcGVydHkodCkmJiEodCBpbiBuKSYmcC5wdXNoKHRoaXMuX2NhY2hlZE5vZGVzW3RdKTtjb25zdCBmPXAuc29ydCgoKHQsZSk9PmUuYWNjZXNzZWQtdC5hY2Nlc3NlZCkpLnNsaWNlKHRoaXMuX2NvbmZpZ3VyYXRpb24ubWF4VW51c2VkSW1hZ2VzKTtmb3IoY29uc3QgdCBvZiBmKXt0Lm5vZGUudW5jYWNoZSgpO2NvbnN0IGU9dC5ub2RlLmlkO2RlbGV0ZSB0aGlzLl9jYWNoZWROb2Rlc1tlXSxlIGluIHRoaXMuX2NhY2hlZE5vZGVUaWxlcyYmZGVsZXRlIHRoaXMuX2NhY2hlZE5vZGVUaWxlc1tlXSxlIGluIHRoaXMuX2NhY2hlZFNwYXRpYWxFZGdlcyYmZGVsZXRlIHRoaXMuX2NhY2hlZFNwYXRpYWxFZGdlc1tlXX1jb25zdCBtPVtdO2ZvcihsZXQgdCBpbiB0aGlzLl9zZXF1ZW5jZXMpdGhpcy5fc2VxdWVuY2VzLmhhc093blByb3BlcnR5KHQpJiYhKHQgaW4gdGhpcy5fY2FjaGluZ1NlcXVlbmNlcyQpJiZ0IT09aSYmbS5wdXNoKHRoaXMuX3NlcXVlbmNlc1t0XSk7Y29uc3QgZz1tLnNvcnQoKCh0LGUpPT5lLmFjY2Vzc2VkLXQuYWNjZXNzZWQpKS5zbGljZSh0aGlzLl9jb25maWd1cmF0aW9uLm1heFNlcXVlbmNlcyk7Zm9yKGNvbnN0IHQgb2YgZyl7Y29uc3QgZT10LnNlcXVlbmNlLmlkO2RlbGV0ZSB0aGlzLl9zZXF1ZW5jZXNbZV0sZSBpbiB0aGlzLl9jYWNoZWRTZXF1ZW5jZU5vZGVzJiZkZWxldGUgdGhpcy5fY2FjaGVkU2VxdWVuY2VOb2Rlc1tlXSx0LnNlcXVlbmNlLmRpc3Bvc2UoKX19dXBkYXRlQ2VsbHMkKHQpe2NvbnN0IGU9dGhpcy5fY2FjaGVkVGlsZXMsaT10aGlzLl9jYWNoaW5nVGlsZXMkO3JldHVybiBidCh0KS5waXBlKE10KCh0PT50IGluIGU/dGhpcy5fdXBkYXRlQ2VsbCQodCk6dCBpbiBpP2lbdF0ucGlwZSh0ZSgoKCk9PkcodGhpcykpKSxNdCgoKCk9PnRoaXMuX3VwZGF0ZUNlbGwkKHQpKSkpOkIoKSkpKX11bnN1YnNjcmliZSgpe3RoaXMuX2ZpbHRlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfV9hZGROZXdLZXlzKHQsZSl7Zm9yKGxldCBpIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShpKSYmdGhpcy5oYXNOb2RlKGkpJiYoaSBpbiB0fHwodFtpXT0hMCkpfV9jYWNoZVNlcXVlbmNlJCh0KXtyZXR1cm4gdCBpbiB0aGlzLl9jYWNoaW5nU2VxdWVuY2VzJHx8KHRoaXMuX2NhY2hpbmdTZXF1ZW5jZXMkW3RdPXRoaXMuX2FwaS5nZXRTZXF1ZW5jZSQodCkucGlwZShwaSgoZT0+e2U/KGUuaWQgaW4gdGhpcy5fc2VxdWVuY2VzfHwodGhpcy5fc2VxdWVuY2VzW2UuaWRdPXthY2Nlc3NlZDoobmV3IERhdGUpLmdldFRpbWUoKSxzZXF1ZW5jZTpuZXcgbmQoZSl9KSxkZWxldGUgdGhpcy5fY2FjaGluZ1NlcXVlbmNlcyRbdF0pOmNvbnNvbGUud2FybihgU2VxdWVuY2UgZG9lcyBub3QgZXhpc3QgKCR7dH0pYCl9KSkscnQoKCgpPT50aGlzKSksTWUoKCgpPT57dCBpbiB0aGlzLl9jYWNoaW5nU2VxdWVuY2VzJCYmZGVsZXRlIHRoaXMuX2NhY2hpbmdTZXF1ZW5jZXMkW3RdLHRoaXMuX2NoYW5nZWQkLm5leHQodGhpcyl9KSksSGUoKSxFKCkpKSx0aGlzLl9jYWNoaW5nU2VxdWVuY2VzJFt0XX1fY2FjaGVUaWxlJCh0KXtyZXR1cm4gdGhpcy5fY2FjaGluZ1RpbGVzJFt0XT10aGlzLl9hcGkuZ2V0Q29yZUltYWdlcyQodCkucGlwZShwaSgoZT0+e2lmKHQgaW4gdGhpcy5fY2FjaGVkVGlsZXMpcmV0dXJuO2NvbnN0IGk9ZS5pbWFnZXM7dGhpcy5fbm9kZUluZGV4VGlsZXNbdF09W10sdGhpcy5fY2FjaGVkVGlsZXNbdF09e2FjY2Vzc2VkOihuZXcgRGF0ZSkuZ2V0VGltZSgpLG5vZGVzOltdfTtjb25zdCBuPXRoaXMuX2NhY2hlZFRpbGVzW3RdLm5vZGVzLHI9dGhpcy5fcmVtb3ZlRnJvbVByZVN0b3JlKHQpO2Zvcihjb25zdCBlIG9mIGkpe2lmKCFlKWJyZWFrO2lmKG51bGw9PWUuc2VxdWVuY2UuaWQpe2NvbnNvbGUud2FybihgU2VxdWVuY2UgbWlzc2luZywgZGlzY2FyZGluZyBub2RlICgke2UuaWR9KWApO2NvbnRpbnVlfWlmKG51bGwhPXImJmUuaWQgaW4gcil7Y29uc3QgaT1yW2UuaWRdO2RlbGV0ZSByW2UuaWRdLG4ucHVzaChpKTtjb25zdCBzPXtsYXQ6aS5sbmdMYXQubGF0LGxuZzppLmxuZ0xhdC5sbmcsbm9kZTppfTt0aGlzLl9ub2RlSW5kZXguaW5zZXJ0KHMpLHRoaXMuX25vZGVJbmRleFRpbGVzW3RdLnB1c2gocyksdGhpcy5fbm9kZVRvVGlsZVtpLmlkXT10O2NvbnRpbnVlfWNvbnN0IGk9bmV3IGVkKGUpO24ucHVzaChpKTtjb25zdCBzPXtsYXQ6aS5sbmdMYXQubGF0LGxuZzppLmxuZ0xhdC5sbmcsbm9kZTppfTt0aGlzLl9ub2RlSW5kZXguaW5zZXJ0KHMpLHRoaXMuX25vZGVJbmRleFRpbGVzW3RdLnB1c2gocyksdGhpcy5fbm9kZVRvVGlsZVtpLmlkXT10LHRoaXMuX3NldE5vZGUoaSl9ZGVsZXRlIHRoaXMuX2NhY2hpbmdUaWxlcyRbdF19KSkscnQoKCgpPT50aGlzKSksdGUoKGU9Pnt0aHJvdyBkZWxldGUgdGhpcy5fY2FjaGluZ1RpbGVzJFt0XSxlfSkpLEhlKCksRSgpKSx0aGlzLl9jYWNoaW5nVGlsZXMkW3RdfV9tYWtlRnVsbCh0LGUpe251bGw9PWUuY29tcHV0ZWRfYWx0aXR1ZGUmJihlLmNvbXB1dGVkX2FsdGl0dWRlPXRoaXMuX2RlZmF1bHRBbHQpLG51bGw9PWUuY29tcHV0ZWRfcm90YXRpb24mJihlLmNvbXB1dGVkX3JvdGF0aW9uPXRoaXMuX2dyYXBoQ2FsY3VsYXRvci5yb3RhdGlvbkZyb21Db21wYXNzKGUuY29tcGFzc19hbmdsZSxlLmV4aWZfb3JpZW50YXRpb24pKSx0Lm1ha2VDb21wbGV0ZShlKX1fcHJlU3RvcmUodCxlKXt0IGluIHRoaXMuX3ByZVN0b3JlZHx8KHRoaXMuX3ByZVN0b3JlZFt0XT17fSksdGhpcy5fcHJlU3RvcmVkW3RdW2UuaWRdPWV9X3JlbW92ZUZyb21QcmVTdG9yZSh0KXtsZXQgZT1udWxsO3JldHVybiB0IGluIHRoaXMuX3ByZVN0b3JlZCYmKGU9dGhpcy5fcHJlU3RvcmVkW3RdLGRlbGV0ZSB0aGlzLl9wcmVTdG9yZWRbdF0pLGV9X3NldE5vZGUodCl7bGV0IGU9dC5pZDtpZih0aGlzLmhhc05vZGUoZSkpdGhyb3cgbmV3IF9kKGBJbWFnZSBhbHJlYWR5IGV4aXN0ICgke2V9KS5gKTt0aGlzLl9ub2Rlc1tlXT10fV91bmNhY2hlVGlsZSh0LGUpe2ZvcihsZXQgaSBvZiB0aGlzLl9jYWNoZWRUaWxlc1t0XS5ub2Rlcyl7bGV0IG49aS5pZDtkZWxldGUgdGhpcy5fbm9kZVRvVGlsZVtuXSxuIGluIHRoaXMuX2NhY2hlZE5vZGVzJiZkZWxldGUgdGhpcy5fY2FjaGVkTm9kZXNbbl0sbiBpbiB0aGlzLl9jYWNoZWROb2RlVGlsZXMmJmRlbGV0ZSB0aGlzLl9jYWNoZWROb2RlVGlsZXNbbl0sbiBpbiB0aGlzLl9jYWNoZWRTcGF0aWFsRWRnZXMmJmRlbGV0ZSB0aGlzLl9jYWNoZWRTcGF0aWFsRWRnZXNbbl0saS5zZXF1ZW5jZUlkPT09ZT8odGhpcy5fcHJlU3RvcmUodCxpKSxpLnVuY2FjaGUoKSk6KGRlbGV0ZSB0aGlzLl9ub2Rlc1tuXSxpLnNlcXVlbmNlSWQgaW4gdGhpcy5fY2FjaGVkU2VxdWVuY2VOb2RlcyYmZGVsZXRlIHRoaXMuX2NhY2hlZFNlcXVlbmNlTm9kZXNbaS5zZXF1ZW5jZUlkXSxpLmRpc3Bvc2UoKSl9Zm9yKGxldCBlIG9mIHRoaXMuX25vZGVJbmRleFRpbGVzW3RdKXRoaXMuX25vZGVJbmRleC5yZW1vdmUoZSk7ZGVsZXRlIHRoaXMuX25vZGVJbmRleFRpbGVzW3RdLGRlbGV0ZSB0aGlzLl9jYWNoZWRUaWxlc1t0XX1fdW5jYWNoZVByZVN0b3JlZCh0KXtsZXQgZT17fTtmb3IobGV0W2ksbl1vZiB0KXtpIGluIHRoaXMuX25vZGVzJiZkZWxldGUgdGhpcy5fbm9kZXNbaV0saSBpbiB0aGlzLl9jYWNoZWROb2RlcyYmZGVsZXRlIHRoaXMuX2NhY2hlZE5vZGVzW2ldO2xldCB0PXRoaXMuX3ByZVN0b3JlZFtuXVtpXTt0LnNlcXVlbmNlSWQgaW4gdGhpcy5fY2FjaGVkU2VxdWVuY2VOb2RlcyYmZGVsZXRlIHRoaXMuX2NhY2hlZFNlcXVlbmNlTm9kZXNbdC5zZXF1ZW5jZUlkXSxkZWxldGUgdGhpcy5fcHJlU3RvcmVkW25dW2ldLHQuZGlzcG9zZSgpLGVbbl09ITB9Zm9yKGxldCB0IGluIGUpZS5oYXNPd25Qcm9wZXJ0eSh0KSYmMD09PU9iamVjdC5rZXlzKHRoaXMuX3ByZVN0b3JlZFt0XSkubGVuZ3RoJiZkZWxldGUgdGhpcy5fcHJlU3RvcmVkW3RdfV91cGRhdGVDYWNoZWRUaWxlQWNjZXNzKHQsZSl7dCBpbiB0aGlzLl9ub2RlVG9UaWxlJiYodGhpcy5fY2FjaGVkVGlsZXNbdGhpcy5fbm9kZVRvVGlsZVt0XV0uYWNjZXNzZWQ9ZSl9X3VwZGF0ZUNhY2hlZE5vZGVBY2Nlc3ModCxlKXt0IGluIHRoaXMuX2NhY2hlZE5vZGVzJiYodGhpcy5fY2FjaGVkTm9kZXNbdF0uYWNjZXNzZWQ9ZSl9X3VwZGF0ZUNlbGwkKHQpe3JldHVybiB0aGlzLl9hcGkuZ2V0Q29yZUltYWdlcyQodCkucGlwZShNdCgoZT0+e2lmKCEodCBpbiB0aGlzLl9jYWNoZWRUaWxlcykpcmV0dXJuIEIoKTtjb25zdCBpPXRoaXMuX25vZGVJbmRleCxuPXRoaXMuX25vZGVJbmRleFRpbGVzW3RdLHI9dGhpcy5fbm9kZVRvVGlsZSxzPXRoaXMuX2NhY2hlZFRpbGVzW3RdO3MuYWNjZXNzZWQ9KG5ldyBEYXRlKS5nZXRUaW1lKCk7Y29uc3Qgbz1zLm5vZGVzLGE9ZS5pbWFnZXM7Zm9yKGNvbnN0IGUgb2YgYSl7aWYobnVsbD09ZSlicmVhaztpZih0aGlzLmhhc05vZGUoZS5pZCkpY29udGludWU7aWYobnVsbD09ZS5zZXF1ZW5jZS5pZCl7Y29uc29sZS53YXJuKGBTZXF1ZW5jZSBtaXNzaW5nLCBkaXNjYXJkaW5nIG5vZGUgKCR7ZS5pZH0pYCk7Y29udGludWV9Y29uc3Qgcz1uZXcgZWQoZSk7by5wdXNoKHMpO2NvbnN0IGE9e2xhdDpzLmxuZ0xhdC5sYXQsbG5nOnMubG5nTGF0LmxuZyxub2RlOnN9O2kuaW5zZXJ0KGEpLG4ucHVzaChhKSxyW3MuaWRdPXQsdGhpcy5fc2V0Tm9kZShzKX1yZXR1cm4gRyh0KX0pKSx0ZSgodD0+KGNvbnNvbGUuZXJyb3IodCksQigpKSkpKX19Y2xhc3MgeWR7Y29uc3RydWN0b3IoKXt0aGlzLl9oYXNoPXt9LHRoaXMuX2luZGV4PW5ldyB5ZC5fc3BhdGlhbEluZGV4KDE2KSx0aGlzLl9pbmRleENoYW5nZWQkPW5ldyBULHRoaXMuX3VwZGF0ZWQkPW5ldyBUfXN0YXRpYyByZWdpc3Rlcih0KXt5ZC5fc3BhdGlhbEluZGV4PXR9Z2V0IGNoYW5nZWQkKCl7cmV0dXJuIHRoaXMuX2luZGV4Q2hhbmdlZCR9Z2V0IHVwZGF0ZWQkKCl7cmV0dXJuIHRoaXMuX3VwZGF0ZWQkfWFkZCh0KXtjb25zdCBlPVtdLGk9dGhpcy5faGFzaCxuPXRoaXMuX2luZGV4O2Zvcihjb25zdCByIG9mIHQpe2NvbnN0IHQ9ci5pZDt0IGluIGkmJihuLnJlbW92ZShpW3RdKSxlLnB1c2gocikpO2NvbnN0IHM9e2xhdDpyLmxuZ0xhdC5sYXQsbG5nOnIubG5nTGF0LmxuZyxtYXJrZXI6cn07aVt0XT1zLG4uaW5zZXJ0KHMpfWUubGVuZ3RoPjAmJnRoaXMuX3VwZGF0ZWQkLm5leHQoZSksdC5sZW5ndGg+ZS5sZW5ndGgmJnRoaXMuX2luZGV4Q2hhbmdlZCQubmV4dCh0aGlzKX1oYXModCl7cmV0dXJuIHQgaW4gdGhpcy5faGFzaH1nZXQodCl7cmV0dXJuIHRoaXMuaGFzKHQpP3RoaXMuX2hhc2hbdF0ubWFya2VyOnZvaWQgMH1nZXRBbGwoKXtyZXR1cm4gdGhpcy5faW5kZXguYWxsKCkubWFwKCh0PT50Lm1hcmtlcikpfXJlbW92ZSh0KXtjb25zdCBlPXRoaXMuX2hhc2gsaT10aGlzLl9pbmRleDtsZXQgbj0hMTtmb3IoY29uc3QgciBvZiB0KXtpZighKHIgaW4gZSkpY29udGludWU7Y29uc3QgdD1lW3JdO2kucmVtb3ZlKHQpLGRlbGV0ZSBlW3JdLG49ITB9biYmdGhpcy5faW5kZXhDaGFuZ2VkJC5uZXh0KHRoaXMpfXJlbW92ZUFsbCgpe3RoaXMuX2hhc2g9e30sdGhpcy5faW5kZXguY2xlYXIoKSx0aGlzLl9pbmRleENoYW5nZWQkLm5leHQodGhpcyl9c2VhcmNoKFt0LGVdKXtyZXR1cm4gdGhpcy5faW5kZXguc2VhcmNoKHttYXhYOmUubG5nLG1heFk6ZS5sYXQsbWluWDp0LmxuZyxtaW5ZOnQubGF0fSkubWFwKCh0PT50Lm1hcmtlcikpfXVwZGF0ZSh0KXtjb25zdCBlPXRoaXMuX2hhc2gsaT10aGlzLl9pbmRleCxuPXQuaWQ7aWYoIShuIGluIGUpKXJldHVybjtpLnJlbW92ZShlW25dKTtjb25zdCByPXtsYXQ6dC5sbmdMYXQubGF0LGxuZzp0LmxuZ0xhdC5sbmcsbWFya2VyOnR9O2Vbbl09cixpLmluc2VydChyKX19ZnVuY3Rpb24gYmQodCxlLGksbixyKXt4ZCh0LGUsaXx8MCxufHx0Lmxlbmd0aC0xLHJ8fFNkKX1mdW5jdGlvbiB4ZCh0LGUsaSxuLHIpe2Zvcig7bj5pOyl7aWYobi1pPjYwMCl7dmFyIHM9bi1pKzEsbz1lLWkrMSxhPU1hdGgubG9nKHMpLGM9LjUqTWF0aC5leHAoMiphLzMpLGg9LjUqTWF0aC5zcXJ0KGEqYyoocy1jKS9zKSooby1zLzI8MD8tMToxKTt4ZCh0LGUsTWF0aC5tYXgoaSxNYXRoLmZsb29yKGUtbypjL3MraCkpLE1hdGgubWluKG4sTWF0aC5mbG9vcihlKyhzLW8pKmMvcytoKSkscil9dmFyIGw9dFtlXSx1PWksZD1uO2Zvcih3ZCh0LGksZSkscih0W25dLGwpPjAmJndkKHQsaSxuKTt1PGQ7KXtmb3Iod2QodCx1LGQpLHUrKyxkLS07cih0W3VdLGwpPDA7KXUrKztmb3IoO3IodFtkXSxsKT4wOylkLS19MD09PXIodFtpXSxsKT93ZCh0LGksZCk6d2QodCwrK2QsbiksZDw9ZSYmKGk9ZCsxKSxlPD1kJiYobj1kLTEpfX1mdW5jdGlvbiB3ZCh0LGUsaSl7dmFyIG49dFtlXTt0W2VdPXRbaV0sdFtpXT1ufWZ1bmN0aW9uIFNkKHQsZSl7cmV0dXJuIHQ8ZT8tMTp0PmU/MTowfWZ1bmN0aW9uIE1kKHQsZSxpKXtpZighaSlyZXR1cm4gZS5pbmRleE9mKHQpO2ZvcihsZXQgbj0wO248ZS5sZW5ndGg7bisrKWlmKGkodCxlW25dKSlyZXR1cm4gbjtyZXR1cm4tMX1mdW5jdGlvbiBUZCh0LGUpe0NkKHQsMCx0LmNoaWxkcmVuLmxlbmd0aCxlLHQpfWZ1bmN0aW9uIENkKHQsZSxpLG4scil7cnx8KHI9RGQobnVsbCkpLHIubWluWD0xLzAsci5taW5ZPTEvMCxyLm1heFg9LTEvMCxyLm1heFk9LTEvMDtmb3IobGV0IHM9ZTtzPGk7cysrKXtjb25zdCBlPXQuY2hpbGRyZW5bc107RWQocix0LmxlYWY/bihlKTplKX1yZXR1cm4gcn1mdW5jdGlvbiBFZCh0LGUpe3JldHVybiB0Lm1pblg9TWF0aC5taW4odC5taW5YLGUubWluWCksdC5taW5ZPU1hdGgubWluKHQubWluWSxlLm1pblkpLHQubWF4WD1NYXRoLm1heCh0Lm1heFgsZS5tYXhYKSx0Lm1heFk9TWF0aC5tYXgodC5tYXhZLGUubWF4WSksdH1mdW5jdGlvbiBJZCh0LGUpe3JldHVybiB0Lm1pblgtZS5taW5YfWZ1bmN0aW9uIEFkKHQsZSl7cmV0dXJuIHQubWluWS1lLm1pbll9ZnVuY3Rpb24gUGQodCl7cmV0dXJuKHQubWF4WC10Lm1pblgpKih0Lm1heFktdC5taW5ZKX1mdW5jdGlvbiBSZCh0KXtyZXR1cm4gdC5tYXhYLXQubWluWCsodC5tYXhZLXQubWluWSl9ZnVuY3Rpb24gTGQodCxlKXtjb25zdCBpPU1hdGgubWF4KHQubWluWCxlLm1pblgpLG49TWF0aC5tYXgodC5taW5ZLGUubWluWSkscj1NYXRoLm1pbih0Lm1heFgsZS5tYXhYKSxzPU1hdGgubWluKHQubWF4WSxlLm1heFkpO3JldHVybiBNYXRoLm1heCgwLHItaSkqTWF0aC5tYXgoMCxzLW4pfWZ1bmN0aW9uIE9kKHQsZSl7cmV0dXJuIHQubWluWDw9ZS5taW5YJiZ0Lm1pblk8PWUubWluWSYmZS5tYXhYPD10Lm1heFgmJmUubWF4WTw9dC5tYXhZfWZ1bmN0aW9uIE5kKHQsZSl7cmV0dXJuIGUubWluWDw9dC5tYXhYJiZlLm1pblk8PXQubWF4WSYmZS5tYXhYPj10Lm1pblgmJmUubWF4WT49dC5taW5ZfWZ1bmN0aW9uIERkKHQpe3JldHVybntjaGlsZHJlbjp0LGhlaWdodDoxLGxlYWY6ITAsbWluWDoxLzAsbWluWToxLzAsbWF4WDotMS8wLG1heFk6LTEvMH19ZnVuY3Rpb24gJGQodCxlLGksbixyKXtjb25zdCBzPVtlLGldO2Zvcig7cy5sZW5ndGg7KXtpZigoaT1zLnBvcCgpKS0oZT1zLnBvcCgpKTw9biljb250aW51ZTtjb25zdCBvPWUrTWF0aC5jZWlsKChpLWUpL24vMikqbjtiZCh0LG8sZSxpLHIpLHMucHVzaChlLG8sbyxpKX19Y2xhc3Mga2QgZXh0ZW5kcyBjbGFzc3tjb25zdHJ1Y3Rvcih0PTkpe3RoaXMuX21heEVudHJpZXM9TWF0aC5tYXgoNCx0KSx0aGlzLl9taW5FbnRyaWVzPU1hdGgubWF4KDIsTWF0aC5jZWlsKC40KnRoaXMuX21heEVudHJpZXMpKSx0aGlzLmNsZWFyKCl9YWxsKCl7cmV0dXJuIHRoaXMuX2FsbCh0aGlzLmRhdGEsW10pfXNlYXJjaCh0KXtsZXQgZT10aGlzLmRhdGE7Y29uc3QgaT1bXTtpZighTmQodCxlKSlyZXR1cm4gaTtjb25zdCBuPXRoaXMudG9CQm94LHI9W107Zm9yKDtlOyl7Zm9yKGxldCBzPTA7czxlLmNoaWxkcmVuLmxlbmd0aDtzKyspe2NvbnN0IG89ZS5jaGlsZHJlbltzXSxhPWUubGVhZj9uKG8pOm87TmQodCxhKSYmKGUubGVhZj9pLnB1c2gobyk6T2QodCxhKT90aGlzLl9hbGwobyxpKTpyLnB1c2gobykpfWU9ci5wb3AoKX1yZXR1cm4gaX1jb2xsaWRlcyh0KXtsZXQgZT10aGlzLmRhdGE7aWYoIU5kKHQsZSkpcmV0dXJuITE7Y29uc3QgaT1bXTtmb3IoO2U7KXtmb3IobGV0IG49MDtuPGUuY2hpbGRyZW4ubGVuZ3RoO24rKyl7Y29uc3Qgcj1lLmNoaWxkcmVuW25dLHM9ZS5sZWFmP3RoaXMudG9CQm94KHIpOnI7aWYoTmQodCxzKSl7aWYoZS5sZWFmfHxPZCh0LHMpKXJldHVybiEwO2kucHVzaChyKX19ZT1pLnBvcCgpfXJldHVybiExfWxvYWQodCl7aWYoIXR8fCF0Lmxlbmd0aClyZXR1cm4gdGhpcztpZih0Lmxlbmd0aDx0aGlzLl9taW5FbnRyaWVzKXtmb3IobGV0IGU9MDtlPHQubGVuZ3RoO2UrKyl0aGlzLmluc2VydCh0W2VdKTtyZXR1cm4gdGhpc31sZXQgZT10aGlzLl9idWlsZCh0LnNsaWNlKCksMCx0Lmxlbmd0aC0xLDApO2lmKHRoaXMuZGF0YS5jaGlsZHJlbi5sZW5ndGgpaWYodGhpcy5kYXRhLmhlaWdodD09PWUuaGVpZ2h0KXRoaXMuX3NwbGl0Um9vdCh0aGlzLmRhdGEsZSk7ZWxzZXtpZih0aGlzLmRhdGEuaGVpZ2h0PGUuaGVpZ2h0KXtjb25zdCB0PXRoaXMuZGF0YTt0aGlzLmRhdGE9ZSxlPXR9dGhpcy5faW5zZXJ0KGUsdGhpcy5kYXRhLmhlaWdodC1lLmhlaWdodC0xLCEwKX1lbHNlIHRoaXMuZGF0YT1lO3JldHVybiB0aGlzfWluc2VydCh0KXtyZXR1cm4gdCYmdGhpcy5faW5zZXJ0KHQsdGhpcy5kYXRhLmhlaWdodC0xKSx0aGlzfWNsZWFyKCl7cmV0dXJuIHRoaXMuZGF0YT1EZChbXSksdGhpc31yZW1vdmUodCxlKXtpZighdClyZXR1cm4gdGhpcztsZXQgaT10aGlzLmRhdGE7Y29uc3Qgbj10aGlzLnRvQkJveCh0KSxyPVtdLHM9W107bGV0IG8sYSxjO2Zvcig7aXx8ci5sZW5ndGg7KXtpZihpfHwoaT1yLnBvcCgpLGE9cltyLmxlbmd0aC0xXSxvPXMucG9wKCksYz0hMCksaS5sZWFmKXtjb25zdCBuPU1kKHQsaS5jaGlsZHJlbixlKTtpZigtMSE9PW4pcmV0dXJuIGkuY2hpbGRyZW4uc3BsaWNlKG4sMSksci5wdXNoKGkpLHRoaXMuX2NvbmRlbnNlKHIpLHRoaXN9Y3x8aS5sZWFmfHwhT2QoaSxuKT9hPyhvKyssaT1hLmNoaWxkcmVuW29dLGM9ITEpOmk9bnVsbDooci5wdXNoKGkpLHMucHVzaChvKSxvPTAsYT1pLGk9aS5jaGlsZHJlblswXSl9cmV0dXJuIHRoaXN9dG9CQm94KHQpe3JldHVybiB0fWNvbXBhcmVNaW5YKHQsZSl7cmV0dXJuIHQubWluWC1lLm1pblh9Y29tcGFyZU1pblkodCxlKXtyZXR1cm4gdC5taW5ZLWUubWluWX10b0pTT04oKXtyZXR1cm4gdGhpcy5kYXRhfWZyb21KU09OKHQpe3JldHVybiB0aGlzLmRhdGE9dCx0aGlzfV9hbGwodCxlKXtjb25zdCBpPVtdO2Zvcig7dDspdC5sZWFmP2UucHVzaCguLi50LmNoaWxkcmVuKTppLnB1c2goLi4udC5jaGlsZHJlbiksdD1pLnBvcCgpO3JldHVybiBlfV9idWlsZCh0LGUsaSxuKXtjb25zdCByPWktZSsxO2xldCBzLG89dGhpcy5fbWF4RW50cmllcztpZihyPD1vKXJldHVybiBzPURkKHQuc2xpY2UoZSxpKzEpKSxUZChzLHRoaXMudG9CQm94KSxzO258fChuPU1hdGguY2VpbChNYXRoLmxvZyhyKS9NYXRoLmxvZyhvKSksbz1NYXRoLmNlaWwoci9NYXRoLnBvdyhvLG4tMSkpKSxzPURkKFtdKSxzLmxlYWY9ITEscy5oZWlnaHQ9bjtjb25zdCBhPU1hdGguY2VpbChyL28pLGM9YSpNYXRoLmNlaWwoTWF0aC5zcXJ0KG8pKTskZCh0LGUsaSxjLHRoaXMuY29tcGFyZU1pblgpO2ZvcihsZXQgcj1lO3I8PWk7cis9Yyl7Y29uc3QgZT1NYXRoLm1pbihyK2MtMSxpKTskZCh0LHIsZSxhLHRoaXMuY29tcGFyZU1pblkpO2ZvcihsZXQgaT1yO2k8PWU7aSs9YSl7Y29uc3Qgcj1NYXRoLm1pbihpK2EtMSxlKTtzLmNoaWxkcmVuLnB1c2godGhpcy5fYnVpbGQodCxpLHIsbi0xKSl9fXJldHVybiBUZChzLHRoaXMudG9CQm94KSxzfV9jaG9vc2VTdWJ0cmVlKHQsZSxpLG4pe2Zvcig7bi5wdXNoKGUpLCFlLmxlYWYmJm4ubGVuZ3RoLTEhPT1pOyl7bGV0IGksbj0xLzAsbz0xLzA7Zm9yKGxldCBhPTA7YTxlLmNoaWxkcmVuLmxlbmd0aDthKyspe2NvbnN0IGM9ZS5jaGlsZHJlblthXSxoPVBkKGMpLGw9KHI9dCxzPWMsKE1hdGgubWF4KHMubWF4WCxyLm1heFgpLU1hdGgubWluKHMubWluWCxyLm1pblgpKSooTWF0aC5tYXgocy5tYXhZLHIubWF4WSktTWF0aC5taW4ocy5taW5ZLHIubWluWSkpLWgpO2w8bz8obz1sLG49aDxuP2g6bixpPWMpOmw9PT1vJiZoPG4mJihuPWgsaT1jKX1lPWl8fGUuY2hpbGRyZW5bMF19dmFyIHIscztyZXR1cm4gZX1faW5zZXJ0KHQsZSxpKXtjb25zdCBuPWk/dDp0aGlzLnRvQkJveCh0KSxyPVtdLHM9dGhpcy5fY2hvb3NlU3VidHJlZShuLHRoaXMuZGF0YSxlLHIpO2ZvcihzLmNoaWxkcmVuLnB1c2godCksRWQocyxuKTtlPj0wJiZyW2VdLmNoaWxkcmVuLmxlbmd0aD50aGlzLl9tYXhFbnRyaWVzOyl0aGlzLl9zcGxpdChyLGUpLGUtLTt0aGlzLl9hZGp1c3RQYXJlbnRCQm94ZXMobixyLGUpfV9zcGxpdCh0LGUpe2NvbnN0IGk9dFtlXSxuPWkuY2hpbGRyZW4ubGVuZ3RoLHI9dGhpcy5fbWluRW50cmllczt0aGlzLl9jaG9vc2VTcGxpdEF4aXMoaSxyLG4pO2NvbnN0IHM9dGhpcy5fY2hvb3NlU3BsaXRJbmRleChpLHIsbiksbz1EZChpLmNoaWxkcmVuLnNwbGljZShzLGkuY2hpbGRyZW4ubGVuZ3RoLXMpKTtvLmhlaWdodD1pLmhlaWdodCxvLmxlYWY9aS5sZWFmLFRkKGksdGhpcy50b0JCb3gpLFRkKG8sdGhpcy50b0JCb3gpLGU/dFtlLTFdLmNoaWxkcmVuLnB1c2gobyk6dGhpcy5fc3BsaXRSb290KGksbyl9X3NwbGl0Um9vdCh0LGUpe3RoaXMuZGF0YT1EZChbdCxlXSksdGhpcy5kYXRhLmhlaWdodD10LmhlaWdodCsxLHRoaXMuZGF0YS5sZWFmPSExLFRkKHRoaXMuZGF0YSx0aGlzLnRvQkJveCl9X2Nob29zZVNwbGl0SW5kZXgodCxlLGkpe2xldCBuLHI9MS8wLHM9MS8wO2ZvcihsZXQgbz1lO288PWktZTtvKyspe2NvbnN0IGU9Q2QodCwwLG8sdGhpcy50b0JCb3gpLGE9Q2QodCxvLGksdGhpcy50b0JCb3gpLGM9TGQoZSxhKSxoPVBkKGUpK1BkKGEpO2M8cj8ocj1jLG49byxzPWg8cz9oOnMpOmM9PT1yJiZoPHMmJihzPWgsbj1vKX1yZXR1cm4gbnx8aS1lfV9jaG9vc2VTcGxpdEF4aXModCxlLGkpe2NvbnN0IG49dC5sZWFmP3RoaXMuY29tcGFyZU1pblg6SWQscj10LmxlYWY/dGhpcy5jb21wYXJlTWluWTpBZDt0aGlzLl9hbGxEaXN0TWFyZ2luKHQsZSxpLG4pPHRoaXMuX2FsbERpc3RNYXJnaW4odCxlLGkscikmJnQuY2hpbGRyZW4uc29ydChuKX1fYWxsRGlzdE1hcmdpbih0LGUsaSxuKXt0LmNoaWxkcmVuLnNvcnQobik7Y29uc3Qgcj10aGlzLnRvQkJveCxzPUNkKHQsMCxlLHIpLG89Q2QodCxpLWUsaSxyKTtsZXQgYT1SZChzKStSZChvKTtmb3IobGV0IG49ZTtuPGktZTtuKyspe2NvbnN0IGU9dC5jaGlsZHJlbltuXTtFZChzLHQubGVhZj9yKGUpOmUpLGErPVJkKHMpfWZvcihsZXQgbj1pLWUtMTtuPj1lO24tLSl7Y29uc3QgZT10LmNoaWxkcmVuW25dO0VkKG8sdC5sZWFmP3IoZSk6ZSksYSs9UmQobyl9cmV0dXJuIGF9X2FkanVzdFBhcmVudEJCb3hlcyh0LGUsaSl7Zm9yKGxldCBuPWk7bj49MDtuLS0pRWQoZVtuXSx0KX1fY29uZGVuc2UodCl7Zm9yKGxldCBlLGk9dC5sZW5ndGgtMTtpPj0wO2ktLSkwPT09dFtpXS5jaGlsZHJlbi5sZW5ndGg/aT4wPyhlPXRbaS0xXS5jaGlsZHJlbixlLnNwbGljZShlLmluZGV4T2YodFtpXSksMSkpOnRoaXMuY2xlYXIoKTpUZCh0W2ldLHRoaXMudG9CQm94KX19e2NvbXBhcmVNaW5YKHQsZSl7cmV0dXJuIHQubG5nLWUubG5nfWNvbXBhcmVNaW5ZKHQsZSl7cmV0dXJuIHQubGF0LWUubGF0fXRvQkJveCh0KXtyZXR1cm57bWluWDp0LmxuZyxtaW5ZOnQubGF0LG1heFg6dC5sbmcsbWF4WTp0LmxhdH19fXZhciB6ZCxGZD1CZDtmdW5jdGlvbiBCZCh0LGUsaSxuKXt0aGlzLmN4PTMqdCx0aGlzLmJ4PTMqKGktdCktdGhpcy5jeCx0aGlzLmF4PTEtdGhpcy5jeC10aGlzLmJ4LHRoaXMuY3k9MyplLHRoaXMuYnk9Myoobi1lKS10aGlzLmN5LHRoaXMuYXk9MS10aGlzLmN5LXRoaXMuYnksdGhpcy5wMXg9dCx0aGlzLnAxeT1uLHRoaXMucDJ4PWksdGhpcy5wMnk9bn1CZC5wcm90b3R5cGUuc2FtcGxlQ3VydmVYPWZ1bmN0aW9uKHQpe3JldHVybigodGhpcy5heCp0K3RoaXMuYngpKnQrdGhpcy5jeCkqdH0sQmQucHJvdG90eXBlLnNhbXBsZUN1cnZlWT1mdW5jdGlvbih0KXtyZXR1cm4oKHRoaXMuYXkqdCt0aGlzLmJ5KSp0K3RoaXMuY3kpKnR9LEJkLnByb3RvdHlwZS5zYW1wbGVDdXJ2ZURlcml2YXRpdmVYPWZ1bmN0aW9uKHQpe3JldHVybigzKnRoaXMuYXgqdCsyKnRoaXMuYngpKnQrdGhpcy5jeH0sQmQucHJvdG90eXBlLnNvbHZlQ3VydmVYPWZ1bmN0aW9uKHQsZSl7dmFyIGksbixyLHMsbztmb3Iodm9pZCAwPT09ZSYmKGU9MWUtNikscj10LG89MDtvPDg7bysrKXtpZihzPXRoaXMuc2FtcGxlQ3VydmVYKHIpLXQsTWF0aC5hYnMocyk8ZSlyZXR1cm4gcjt2YXIgYT10aGlzLnNhbXBsZUN1cnZlRGVyaXZhdGl2ZVgocik7aWYoTWF0aC5hYnMoYSk8MWUtNilicmVhaztyLT1zL2F9aWYoKHI9dCk8KGk9MCkpcmV0dXJuIGk7aWYocj4obj0xKSlyZXR1cm4gbjtmb3IoO2k8bjspe2lmKHM9dGhpcy5zYW1wbGVDdXJ2ZVgociksTWF0aC5hYnMocy10KTxlKXJldHVybiByO3Q+cz9pPXI6bj1yLHI9LjUqKG4taSkraX1yZXR1cm4gcn0sQmQucHJvdG90eXBlLnNvbHZlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuc2FtcGxlQ3VydmVZKHRoaXMuc29sdmVDdXJ2ZVgodCxlKSl9LHQuVHJhbnNpdGlvbk1vZGU9dm9pZCAwLCh6ZD10LlRyYW5zaXRpb25Nb2RlfHwodC5UcmFuc2l0aW9uTW9kZT17fSkpW3pkLkRlZmF1bHQ9MF09XCJEZWZhdWx0XCIsemRbemQuSW5zdGFudGFuZW91cz0xXT1cIkluc3RhbnRhbmVvdXNcIjtjbGFzcyBqZHtjb25zdHJ1Y3Rvcih0KXtudWxsIT10Pyh0aGlzLl9wb3NpdGlvbj0obmV3IGZuKS5mcm9tQXJyYXkodC51bnByb2plY3RTZk0oWzAsMF0sMCkpLHRoaXMuX2xvb2thdD0obmV3IGZuKS5mcm9tQXJyYXkodC51bnByb2plY3RTZk0oWzAsMF0sMTApKSx0aGlzLl91cD10LnVwVmVjdG9yKCksdGhpcy5fZm9jYWw9dGhpcy5fZ2V0Rm9jYWwodCkpOih0aGlzLl9wb3NpdGlvbj1uZXcgZm4oMCwwLDApLHRoaXMuX2xvb2thdD1uZXcgZm4oMSwwLDApLHRoaXMuX3VwPW5ldyBmbigwLDAsMSksdGhpcy5fZm9jYWw9MSl9Z2V0IHBvc2l0aW9uKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9ufWdldCBsb29rYXQoKXtyZXR1cm4gdGhpcy5fbG9va2F0fWdldCB1cCgpe3JldHVybiB0aGlzLl91cH1nZXQgZm9jYWwoKXtyZXR1cm4gdGhpcy5fZm9jYWx9c2V0IGZvY2FsKHQpe3RoaXMuX2ZvY2FsPXR9bGVycENhbWVyYXModCxlLGkpe3RoaXMuX3Bvc2l0aW9uLnN1YlZlY3RvcnMoZS5wb3NpdGlvbix0LnBvc2l0aW9uKS5tdWx0aXBseVNjYWxhcihpKS5hZGQodC5wb3NpdGlvbiksdGhpcy5fbG9va2F0LnN1YlZlY3RvcnMoZS5sb29rYXQsdC5sb29rYXQpLm11bHRpcGx5U2NhbGFyKGkpLmFkZCh0Lmxvb2thdCksdGhpcy5fdXAuc3ViVmVjdG9ycyhlLnVwLHQudXApLm11bHRpcGx5U2NhbGFyKGkpLmFkZCh0LnVwKSx0aGlzLl9mb2NhbD0oMS1pKSp0LmZvY2FsK2kqZS5mb2NhbH1jb3B5KHQpe3RoaXMuX3Bvc2l0aW9uLmNvcHkodC5wb3NpdGlvbiksdGhpcy5fbG9va2F0LmNvcHkodC5sb29rYXQpLHRoaXMuX3VwLmNvcHkodC51cCksdGhpcy5fZm9jYWw9dC5mb2NhbH1jbG9uZSgpe2xldCB0PW5ldyBqZDtyZXR1cm4gdC5wb3NpdGlvbi5jb3B5KHRoaXMuX3Bvc2l0aW9uKSx0Lmxvb2thdC5jb3B5KHRoaXMuX2xvb2thdCksdC51cC5jb3B5KHRoaXMuX3VwKSx0LmZvY2FsPXRoaXMuX2ZvY2FsLHR9ZGlmZih0KXtsZXQgZT10aGlzLl9wb3NpdGlvbi5kaXN0YW5jZVRvU3F1YXJlZCh0LnBvc2l0aW9uKSxpPXRoaXMuX2xvb2thdC5kaXN0YW5jZVRvU3F1YXJlZCh0Lmxvb2thdCksbj10aGlzLl91cC5kaXN0YW5jZVRvU3F1YXJlZCh0LnVwKSxyPTEwMCpNYXRoLmFicyh0aGlzLl9mb2NhbC10LmZvY2FsKTtyZXR1cm4gTWF0aC5tYXgoZSxpLG4scil9X2dldEZvY2FsKHQpe3JldHVybiBkZCh0LmNhbWVyYVR5cGUpPy41L01hdGgudGFuKE1hdGguUEkvMik6dC5mb2NhbH19Y2xhc3MgSGR7Y29uc3RydWN0b3IodCxlLGksbixyLHMsbyxhLGMsaCl7dGhpcy5fb3JpZW50YXRpb249dGhpcy5fZ2V0VmFsdWUodCwxKTtsZXQgbD1udWxsIT1vP28ud2lkdGg6NCx1PW51bGwhPW8/by5oZWlnaHQ6MyxkPXRoaXMuX29yaWVudGF0aW9uPDU7dGhpcy5fd2lkdGg9dGhpcy5fZ2V0VmFsdWUoZSxkP2w6dSksdGhpcy5faGVpZ2h0PXRoaXMuX2dldFZhbHVlKGksZD91OmwpLHRoaXMuX2Jhc2ljQXNwZWN0PWQ/dGhpcy5fd2lkdGgvdGhpcy5faGVpZ2h0OnRoaXMuX2hlaWdodC90aGlzLl93aWR0aCx0aGlzLl9iYXNpY1dpZHRoPWQ/ZTppLHRoaXMuX2Jhc2ljSGVpZ2h0PWQ/aTplO2NvbnN0IHA9dGhpcy5fZ2V0Q2FtZXJhUGFyYW1ldGVycyhjLGgpLGY9cFswXSxtPXBbMV0sZz1wWzJdO3RoaXMuX2ZvY2FsPXRoaXMuX2dldFZhbHVlKGYsMSksdGhpcy5fc2NhbGU9dGhpcy5fZ2V0VmFsdWUobiwwKSx0aGlzLl93b3JsZFRvQ2FtZXJhPXRoaXMuY3JlYXRlV29ybGRUb0NhbWVyYShyLHMpLHRoaXMuX3dvcmxkVG9DYW1lcmFJbnZlcnNlPShuZXcgSG4pLmNvcHkodGhpcy5fd29ybGRUb0NhbWVyYSkuaW52ZXJ0KCksdGhpcy5fc2NhbGVkV29ybGRUb0NhbWVyYT10aGlzLl9jcmVhdGVTY2FsZWRXb3JsZFRvQ2FtZXJhKHRoaXMuX3dvcmxkVG9DYW1lcmEsdGhpcy5fc2NhbGUpLHRoaXMuX3NjYWxlZFdvcmxkVG9DYW1lcmFJbnZlcnNlPShuZXcgSG4pLmNvcHkodGhpcy5fc2NhbGVkV29ybGRUb0NhbWVyYSkuaW52ZXJ0KCksdGhpcy5fYmFzaWNXb3JsZFRvQ2FtZXJhPXRoaXMuX2NyZWF0ZUJhc2ljV29ybGRUb0NhbWVyYSh0aGlzLl93b3JsZFRvQ2FtZXJhLHQpLHRoaXMuX3RleHR1cmVTY2FsZT1hfHxbMSwxXSx0aGlzLl9jazE9bXx8MCx0aGlzLl9jazI9Z3x8MCx0aGlzLl9jYW1lcmFUeXBlPWh8fFwicGVyc3BlY3RpdmVcIix0aGlzLl9yYWRpYWxQZWFrPXRoaXMuX2dldFJhZGlhbFBlYWsodGhpcy5fY2sxLHRoaXMuX2NrMil9Z2V0IGNrMSgpe3JldHVybiB0aGlzLl9jazF9Z2V0IGNrMigpe3JldHVybiB0aGlzLl9jazJ9Z2V0IGNhbWVyYVR5cGUoKXtyZXR1cm4gdGhpcy5fY2FtZXJhVHlwZX1nZXQgYmFzaWNBc3BlY3QoKXtyZXR1cm4gdGhpcy5fYmFzaWNBc3BlY3R9Z2V0IGJhc2ljSGVpZ2h0KCl7cmV0dXJuIHRoaXMuX2Jhc2ljSGVpZ2h0fWdldCBiYXNpY1J0KCl7cmV0dXJuIHRoaXMuX2Jhc2ljV29ybGRUb0NhbWVyYX1nZXQgYmFzaWNXaWR0aCgpe3JldHVybiB0aGlzLl9iYXNpY1dpZHRofWdldCBmb2NhbCgpe3JldHVybiB0aGlzLl9mb2NhbH1nZXQgaGVpZ2h0KCl7cmV0dXJuIHRoaXMuX2hlaWdodH1nZXQgb3JpZW50YXRpb24oKXtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb259Z2V0IHJ0KCl7cmV0dXJuIHRoaXMuX3dvcmxkVG9DYW1lcmF9Z2V0IHNydCgpe3JldHVybiB0aGlzLl9zY2FsZWRXb3JsZFRvQ2FtZXJhfWdldCBzcnRJbnZlcnNlKCl7cmV0dXJuIHRoaXMuX3NjYWxlZFdvcmxkVG9DYW1lcmFJbnZlcnNlfWdldCBzY2FsZSgpe3JldHVybiB0aGlzLl9zY2FsZX1nZXQgaGFzVmFsaWRTY2FsZSgpe3JldHVybiB0aGlzLl9zY2FsZT4uMDEmJnRoaXMuX3NjYWxlPDUwfWdldCByYWRpYWxQZWFrKCl7cmV0dXJuIHRoaXMuX3JhZGlhbFBlYWt9Z2V0IHdpZHRoKCl7cmV0dXJuIHRoaXMuX3dpZHRofXVwVmVjdG9yKCl7bGV0IHQ9dGhpcy5fd29ybGRUb0NhbWVyYS5lbGVtZW50cztzd2l0Y2godGhpcy5fb3JpZW50YXRpb24pe2Nhc2UgMTpyZXR1cm4gbmV3IGZuKC10WzFdLC10WzVdLC10WzldKTtjYXNlIDM6cmV0dXJuIG5ldyBmbih0WzFdLHRbNV0sdFs5XSk7Y2FzZSA2OnJldHVybiBuZXcgZm4oLXRbMF0sLXRbNF0sLXRbOF0pO2Nhc2UgODpyZXR1cm4gbmV3IGZuKHRbMF0sdFs0XSx0WzhdKTtkZWZhdWx0OnJldHVybiBuZXcgZm4oLXRbMV0sLXRbNV0sLXRbOV0pfX1wcm9qZWN0b3JNYXRyaXgoKXtsZXQgdD10aGlzLl9ub3JtYWxpemVkVG9UZXh0dXJlTWF0cml4KCksZT10aGlzLl9mb2NhbCxpPShuZXcgSG4pLnNldChlLDAsMCwwLDAsZSwwLDAsMCwwLDAsMCwwLDAsMSwwKTtyZXR1cm4gdC5tdWx0aXBseShpKSx0Lm11bHRpcGx5KHRoaXMuX3dvcmxkVG9DYW1lcmEpLHR9cHJvamVjdEJhc2ljKHQpe2xldCBlPXRoaXMucHJvamVjdFNmTSh0KTtyZXR1cm4gdGhpcy5fc2ZtVG9CYXNpYyhlKX11bnByb2plY3RCYXNpYyh0LGUsaSl7bGV0IG49dGhpcy5fYmFzaWNUb1NmbSh0KTtyZXR1cm4gdGhpcy51bnByb2plY3RTZk0obixlLGkpfXByb2plY3RTZk0odCl7bGV0IGU9bmV3IHVuKHRbMF0sdFsxXSx0WzJdLDEpO3JldHVybiBlLmFwcGx5TWF0cml4NCh0aGlzLl93b3JsZFRvQ2FtZXJhKSx0aGlzLl9iZWFyaW5nVG9TZm0oW2UueCxlLnksZS56XSl9dW5wcm9qZWN0U2ZNKHQsZSxpKXtjb25zdCBuPXRoaXMuX3NmbVRvQmVhcmluZyh0KSxyPShpJiYhZGQodGhpcy5fY2FtZXJhVHlwZSk/bmV3IHVuKGUqblswXS9uWzJdLGUqblsxXS9uWzJdLGUsMSk6bmV3IHVuKGUqblswXSxlKm5bMV0sZSpuWzJdLDEpKS5hcHBseU1hdHJpeDQodGhpcy5fd29ybGRUb0NhbWVyYUludmVyc2UpO3JldHVybltyLngvci53LHIueS9yLncsci56L3Iud119X3NmbVRvQmVhcmluZyh0KXtpZihkZCh0aGlzLl9jYW1lcmFUeXBlKSl7bGV0IGU9Mip0WzBdKk1hdGguUEksaT0yKi10WzFdKk1hdGguUEk7cmV0dXJuW01hdGguY29zKGkpKk1hdGguc2luKGUpLC1NYXRoLnNpbihpKSxNYXRoLmNvcyhpKSpNYXRoLmNvcyhlKV19aWYocGQodGhpcy5fY2FtZXJhVHlwZSkpe2xldFtlLGldPVt0WzBdL3RoaXMuX2ZvY2FsLHRbMV0vdGhpcy5fZm9jYWxdO2NvbnN0IG49TWF0aC5zcXJ0KGUqZStpKmkpO2xldCByPW4vdGhpcy5fZGlzdG9ydGlvbkZyb21EaXN0b3J0ZWRSYWRpdXMobix0aGlzLl9jazEsdGhpcy5fY2syLHRoaXMuX3JhZGlhbFBlYWspLHM9TWF0aC5jb3Mociksbz1NYXRoLnNpbihyKTtjb25zdCBhPW4+MWUtOD8xL246MTtyZXR1cm5bbyplKmEsbyppKmEsc119e2xldFtlLGldPVt0WzBdL3RoaXMuX2ZvY2FsLHRbMV0vdGhpcy5fZm9jYWxdO2NvbnN0IG49TWF0aC5zcXJ0KGUqZStpKmkpO2xldCByPXRoaXMuX2Rpc3RvcnRpb25Gcm9tRGlzdG9ydGVkUmFkaXVzKG4sdGhpcy5fY2sxLHRoaXMuX2NrMix0aGlzLl9yYWRpYWxQZWFrKTtsZXQgcz1uZXcgZm4oZS9yLGkvciwxKTtyZXR1cm4gcy5ub3JtYWxpemUoKSxbcy54LHMueSxzLnpdfX1fZGlzdG9ydGlvbkZyb21EaXN0b3J0ZWRSYWRpdXModCxlLGksbil7bGV0IHI9MTtmb3IobGV0IHM9MDtzPDEwO3MrKyl7bGV0IHM9dC9yO3M+biYmKHM9bikscj0xK2UqTWF0aC5wb3cocywyKStpKk1hdGgucG93KHMsNCl9cmV0dXJuIHJ9X2JlYXJpbmdUb1NmbSh0KXtpZihkZCh0aGlzLl9jYW1lcmFUeXBlKSl7bGV0IGU9dFswXSxpPXRbMV0sbj10WzJdLHI9TWF0aC5hdGFuMihlLG4pLHM9TWF0aC5hdGFuMigtaSxNYXRoLnNxcnQoZSplK24qbikpO3JldHVybltyLygyKk1hdGguUEkpLC1zLygyKk1hdGguUEkpXX1pZihwZCh0aGlzLl9jYW1lcmFUeXBlKSl7aWYodFsyXT4wKXtjb25zdFtlLGksbl09dCxyPU1hdGguc3FydChlKmUraSppKTtsZXQgcz1NYXRoLmF0YW4yKHIsbik7cz50aGlzLl9yYWRpYWxQZWFrJiYocz10aGlzLl9yYWRpYWxQZWFrKTtjb25zdCBvPTErTWF0aC5wb3cocywyKSoodGhpcy5fY2sxK01hdGgucG93KHMsMikqdGhpcy5fY2syKSxhPXRoaXMuX2ZvY2FsKm8qcy9yO3JldHVyblthKmUsYSppXX1yZXR1cm5bdFswXTwwP051bWJlci5ORUdBVElWRV9JTkZJTklUWTpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksdFsxXTwwP051bWJlci5ORUdBVElWRV9JTkZJTklUWTpOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFldfWlmKHRbMl0+MCl7bGV0W2UsaV09W3RbMF0vdFsyXSx0WzFdL3RbMl1dLG49ZSplK2kqaTtjb25zdCByPU1hdGgucG93KHRoaXMuX3JhZGlhbFBlYWssMik7bj5yJiYobj1yKTtjb25zdCBzPTErdGhpcy5fY2sxKm4rdGhpcy5fY2syKk1hdGgucG93KG4sMik7cmV0dXJuW3RoaXMuX2ZvY2FsKnMqZSx0aGlzLl9mb2NhbCpzKmldfXJldHVyblt0WzBdPDA/TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZOk51bWJlci5QT1NJVElWRV9JTkZJTklUWSx0WzFdPDA/TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZOk51bWJlci5QT1NJVElWRV9JTkZJTklUWV19X2Jhc2ljVG9TZm0odCl7bGV0IGUsaTtzd2l0Y2godGhpcy5fb3JpZW50YXRpb24pe2Nhc2UgMTplPXRbMF0saT10WzFdO2JyZWFrO2Nhc2UgMzplPTEtdFswXSxpPTEtdFsxXTticmVhaztjYXNlIDY6ZT10WzFdLGk9MS10WzBdO2JyZWFrO2Nhc2UgODplPTEtdFsxXSxpPXRbMF07YnJlYWs7ZGVmYXVsdDplPXRbMF0saT10WzFdfWxldCBuPXRoaXMuX3dpZHRoLHI9dGhpcy5faGVpZ2h0LHM9TWF0aC5tYXgobixyKTtyZXR1cm5bZSpuL3Mtbi9zLzIsaSpyL3Mtci9zLzJdfV9zZm1Ub0Jhc2ljKHQpe2xldCBlLGksbj10aGlzLl93aWR0aCxyPXRoaXMuX2hlaWdodCxzPU1hdGgubWF4KG4sciksbz0odFswXStuL3MvMikvbipzLGE9KHRbMV0rci9zLzIpL3Iqcztzd2l0Y2godGhpcy5fb3JpZW50YXRpb24pe2Nhc2UgMTplPW8saT1hO2JyZWFrO2Nhc2UgMzplPTEtbyxpPTEtYTticmVhaztjYXNlIDY6ZT0xLWEsaT1vO2JyZWFrO2Nhc2UgODplPWEsaT0xLW87YnJlYWs7ZGVmYXVsdDplPW8saT1hfXJldHVybltlLGldfV9nZXRWYWx1ZSh0LGUpe3JldHVybiBudWxsIT10JiZ0PjA/dDplfV9nZXRDYW1lcmFQYXJhbWV0ZXJzKHQsZSl7aWYoZGQoZSkpcmV0dXJuW107aWYoIXR8fDA9PT10Lmxlbmd0aClyZXR1cm5bMSwwLDBdO2NvbnN0IGk9My10Lmxlbmd0aDtyZXR1cm4gaTw9MD90OnQuY29uY2F0KG5ldyBBcnJheShpKS5maWxsKDApKX1jcmVhdGVXb3JsZFRvQ2FtZXJhKHQsZSl7Y29uc3QgaT1uZXcgZm4odFswXSx0WzFdLHRbMl0pLG49aS5sZW5ndGgoKTtuPjAmJmkubm9ybWFsaXplKCk7Y29uc3Qgcj1uZXcgSG47cmV0dXJuIHIubWFrZVJvdGF0aW9uQXhpcyhpLG4pLHIuc2V0UG9zaXRpb24obmV3IGZuKGVbMF0sZVsxXSxlWzJdKSkscn1fY3JlYXRlU2NhbGVkV29ybGRUb0NhbWVyYSh0LGUpe2NvbnN0IGk9dC5jbG9uZSgpLG49aS5lbGVtZW50cztyZXR1cm4gblsxMl09ZSpuWzEyXSxuWzEzXT1lKm5bMTNdLG5bMTRdPWUqblsxNF0saS5zY2FsZShuZXcgZm4oZSxlLGUpKSxpfV9jcmVhdGVCYXNpY1dvcmxkVG9DYW1lcmEodCxlKXtjb25zdCBpPW5ldyBmbigwLDAsMSk7bGV0IG49MDtzd2l0Y2goZSl7Y2FzZSAzOm49TWF0aC5QSTticmVhaztjYXNlIDY6bj1NYXRoLlBJLzI7YnJlYWs7Y2FzZSA4Om49MypNYXRoLlBJLzJ9cmV0dXJuKG5ldyBIbikubWFrZVJvdGF0aW9uQXhpcyhpLG4pLm11bHRpcGx5KHQpfV9nZXRSYWRpYWxQZWFrKHQsZSl7Y29uc3QgaT01KmUsbj0zKnQscj1NYXRoLnBvdyhuLDIpLTQqaSoxO2lmKHI8MClyZXR1cm47Y29uc3Qgcz0oLW4tTWF0aC5zcXJ0KHIpKS8yL2ksbz0oLW4rTWF0aC5zcXJ0KHIpKS8yL2ksYT1NYXRoLm1pbihzLG8pLGM9TWF0aC5tYXgocyxvKTtyZXR1cm4gYT4wP01hdGguc3FydChhKTpjPjA/TWF0aC5zcXJ0KGMpOnZvaWQgMH1fbm9ybWFsaXplZFRvVGV4dHVyZU1hdHJpeCgpe2NvbnN0IHQ9TWF0aC5tYXgodGhpcy5fd2lkdGgsdGhpcy5faGVpZ2h0KSxlPXRoaXMuX29yaWVudGF0aW9uPDU/dGhpcy5fdGV4dHVyZVNjYWxlWzBdOnRoaXMuX3RleHR1cmVTY2FsZVsxXSxpPXRoaXMuX29yaWVudGF0aW9uPDU/dGhpcy5fdGV4dHVyZVNjYWxlWzFdOnRoaXMuX3RleHR1cmVTY2FsZVswXSxuPXQvdGhpcy5fd2lkdGgqZSxyPXQvdGhpcy5faGVpZ2h0Kmk7c3dpdGNoKHRoaXMuX29yaWVudGF0aW9uKXtjYXNlIDE6cmV0dXJuKG5ldyBIbikuc2V0KG4sMCwwLC41LDAsLXIsMCwuNSwwLDAsMSwwLDAsMCwwLDEpO2Nhc2UgMzpyZXR1cm4obmV3IEhuKS5zZXQoLW4sMCwwLC41LDAsciwwLC41LDAsMCwxLDAsMCwwLDAsMSk7Y2FzZSA2OnJldHVybihuZXcgSG4pLnNldCgwLC1yLDAsLjUsLW4sMCwwLC41LDAsMCwxLDAsMCwwLDAsMSk7Y2FzZSA4OnJldHVybihuZXcgSG4pLnNldCgwLHIsMCwuNSxuLDAsMCwuNSwwLDAsMSwwLDAsMCwwLDEpO2RlZmF1bHQ6cmV0dXJuKG5ldyBIbikuc2V0KG4sMCwwLC41LDAsLXIsMCwuNSwwLDAsMSwwLDAsMCwwLDEpfX19Y2xhc3MgVWR7Y29uc3RydWN0b3IodCl7dGhpcy5fc3BhdGlhbD1uZXcgbGQsdGhpcy5fcmVmZXJlbmNlVGhyZXNob2xkPS4wMSx0aGlzLl90cmFuc2l0aW9uTW9kZT10LnRyYW5zaXRpb25Nb2RlLHRoaXMuX3JlZmVyZW5jZT10LnJlZmVyZW5jZSx0aGlzLl9hbHBoYT10LmFscGhhLHRoaXMuX2NhbWVyYT10LmNhbWVyYS5jbG9uZSgpLHRoaXMuX3pvb209dC56b29tLHRoaXMuX2N1cnJlbnRJbmRleD10LmN1cnJlbnRJbmRleCx0aGlzLl90cmFqZWN0b3J5PXQudHJhamVjdG9yeS5zbGljZSgpLHRoaXMuX3RyYWplY3RvcnlUcmFuc2Zvcm1zPVtdLHRoaXMuX3RyYWplY3RvcnlDYW1lcmFzPVtdO2ZvcihsZXQgdCBvZiB0aGlzLl90cmFqZWN0b3J5KXtsZXQgZT10aGlzLl9pbWFnZVRvVHJhbnNsYXRpb24odCx0aGlzLl9yZWZlcmVuY2UpLGk9bmV3IEhkKHQuZXhpZk9yaWVudGF0aW9uLHQud2lkdGgsdC5oZWlnaHQsdC5zY2FsZSx0LnJvdGF0aW9uLGUsdC5pbWFnZSx2b2lkIDAsdC5jYW1lcmFQYXJhbWV0ZXJzLHQuY2FtZXJhVHlwZSk7dGhpcy5fdHJhamVjdG9yeVRyYW5zZm9ybXMucHVzaChpKSx0aGlzLl90cmFqZWN0b3J5Q2FtZXJhcy5wdXNoKG5ldyBqZChpKSl9dGhpcy5fY3VycmVudEltYWdlPXRoaXMuX3RyYWplY3RvcnkubGVuZ3RoPjA/dGhpcy5fdHJhamVjdG9yeVt0aGlzLl9jdXJyZW50SW5kZXhdOm51bGwsdGhpcy5fcHJldmlvdXNJbWFnZT10aGlzLl90cmFqZWN0b3J5Lmxlbmd0aD4xJiZ0aGlzLmN1cnJlbnRJbmRleD4wP3RoaXMuX3RyYWplY3RvcnlbdGhpcy5fY3VycmVudEluZGV4LTFdOm51bGwsdGhpcy5fY3VycmVudENhbWVyYT10aGlzLl90cmFqZWN0b3J5Q2FtZXJhcy5sZW5ndGg+MD90aGlzLl90cmFqZWN0b3J5Q2FtZXJhc1t0aGlzLl9jdXJyZW50SW5kZXhdLmNsb25lKCk6bmV3IGpkLHRoaXMuX3ByZXZpb3VzQ2FtZXJhPXRoaXMuX3RyYWplY3RvcnlDYW1lcmFzLmxlbmd0aD4xJiZ0aGlzLmN1cnJlbnRJbmRleD4wP3RoaXMuX3RyYWplY3RvcnlDYW1lcmFzW3RoaXMuX2N1cnJlbnRJbmRleC0xXS5jbG9uZSgpOnRoaXMuX2N1cnJlbnRDYW1lcmEuY2xvbmUoKX1nZXQgcmVmZXJlbmNlKCl7cmV0dXJuIHRoaXMuX3JlZmVyZW5jZX1nZXQgYWxwaGEoKXtyZXR1cm4gdGhpcy5fZ2V0QWxwaGEoKX1nZXQgY2FtZXJhKCl7cmV0dXJuIHRoaXMuX2NhbWVyYX1nZXQgem9vbSgpe3JldHVybiB0aGlzLl96b29tfWdldCB0cmFqZWN0b3J5KCl7cmV0dXJuIHRoaXMuX3RyYWplY3Rvcnl9Z2V0IGN1cnJlbnRJbmRleCgpe3JldHVybiB0aGlzLl9jdXJyZW50SW5kZXh9Z2V0IGN1cnJlbnRJbWFnZSgpe3JldHVybiB0aGlzLl9jdXJyZW50SW1hZ2V9Z2V0IHByZXZpb3VzSW1hZ2UoKXtyZXR1cm4gdGhpcy5fcHJldmlvdXNJbWFnZX1nZXQgY3VycmVudENhbWVyYSgpe3JldHVybiB0aGlzLl9jdXJyZW50Q2FtZXJhfWdldCBjdXJyZW50VHJhbnNmb3JtKCl7cmV0dXJuIHRoaXMuX3RyYWplY3RvcnlUcmFuc2Zvcm1zLmxlbmd0aD4wP3RoaXMuX3RyYWplY3RvcnlUcmFuc2Zvcm1zW3RoaXMuY3VycmVudEluZGV4XTpudWxsfWdldCBwcmV2aW91c1RyYW5zZm9ybSgpe3JldHVybiB0aGlzLl90cmFqZWN0b3J5VHJhbnNmb3Jtcy5sZW5ndGg+MSYmdGhpcy5jdXJyZW50SW5kZXg+MD90aGlzLl90cmFqZWN0b3J5VHJhbnNmb3Jtc1t0aGlzLmN1cnJlbnRJbmRleC0xXTpudWxsfWdldCBtb3Rpb25sZXNzKCl7cmV0dXJuIHRoaXMuX21vdGlvbmxlc3N9Z2V0IHRyYW5zaXRpb25Nb2RlKCl7cmV0dXJuIHRoaXMuX3RyYW5zaXRpb25Nb2RlfW1vdmUodCl7fW1vdmVUbyh0KXt9cm90YXRlKHQpe31yb3RhdGVVbmJvdW5kZWQodCl7fXJvdGF0ZVdpdGhvdXRJbmVydGlhKHQpe31yb3RhdGVCYXNpYyh0KXt9cm90YXRlQmFzaWNVbmJvdW5kZWQodCl7fXJvdGF0ZUJhc2ljV2l0aG91dEluZXJ0aWEodCl7fXJvdGF0ZVRvQmFzaWModCl7fXNldFNwZWVkKHQpe316b29tSW4odCxlKXt9dXBkYXRlKHQpe31zZXRDZW50ZXIodCl7fXNldFpvb20odCl7fWRvbGx5KHQpe31vcmJpdCh0KXt9c2V0Vmlld01hdHJpeCh0KXt9dHJ1Y2sodCl7fWFwcGVuZCh0KXtpZih0Lmxlbmd0aDwxKXRocm93IEVycm9yKFwiVHJhamVjdG9yeSBjYW4gbm90IGJlIGVtcHR5XCIpO3RoaXMuX2N1cnJlbnRJbmRleDwwP3RoaXMuc2V0KHQpOih0aGlzLl90cmFqZWN0b3J5PXRoaXMuX3RyYWplY3RvcnkuY29uY2F0KHQpLHRoaXMuX2FwcGVuZFRvVHJhamVjdG9yaWVzKHQpKX1wcmVwZW5kKHQpe2lmKHQubGVuZ3RoPDEpdGhyb3cgRXJyb3IoXCJUcmFqZWN0b3J5IGNhbiBub3QgYmUgZW1wdHlcIik7dGhpcy5fdHJhamVjdG9yeT10LnNsaWNlKCkuY29uY2F0KHRoaXMuX3RyYWplY3RvcnkpLHRoaXMuX2N1cnJlbnRJbmRleCs9dC5sZW5ndGgsdGhpcy5fc2V0Q3VycmVudEltYWdlKCksdGhpcy5fc2V0UmVmZXJlbmNlKHRoaXMuX2N1cnJlbnRJbWFnZSk/dGhpcy5fc2V0VHJhamVjdG9yaWVzKCk6dGhpcy5fcHJlcGVuZFRvVHJhamVjdG9yaWVzKHQpLHRoaXMuX3NldEN1cnJlbnRDYW1lcmEoKX1yZW1vdmUodCl7aWYodDwwKXRocm93IEVycm9yKFwibiBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlclwiKTtpZih0aGlzLl9jdXJyZW50SW5kZXgtMTx0KXRocm93IEVycm9yKFwiQ3VycmVudCBhbmQgcHJldmlvdXMgaW1hZ2VzIGNhbiBub3QgYmUgcmVtb3ZlZFwiKTtmb3IobGV0IGU9MDtlPHQ7ZSsrKXRoaXMuX3RyYWplY3Rvcnkuc2hpZnQoKSx0aGlzLl90cmFqZWN0b3J5VHJhbnNmb3Jtcy5zaGlmdCgpLHRoaXMuX3RyYWplY3RvcnlDYW1lcmFzLnNoaWZ0KCksdGhpcy5fY3VycmVudEluZGV4LS07dGhpcy5fc2V0Q3VycmVudEltYWdlKCl9Y2xlYXJQcmlvcigpe3RoaXMuX2N1cnJlbnRJbmRleD4wJiZ0aGlzLnJlbW92ZSh0aGlzLl9jdXJyZW50SW5kZXgtMSl9Y2xlYXIoKXt0aGlzLmN1dCgpLHRoaXMuX2N1cnJlbnRJbmRleD4wJiZ0aGlzLnJlbW92ZSh0aGlzLl9jdXJyZW50SW5kZXgtMSl9Y3V0KCl7Zm9yKDt0aGlzLl90cmFqZWN0b3J5Lmxlbmd0aC0xPnRoaXMuX2N1cnJlbnRJbmRleDspdGhpcy5fdHJhamVjdG9yeS5wb3AoKSx0aGlzLl90cmFqZWN0b3J5VHJhbnNmb3Jtcy5wb3AoKSx0aGlzLl90cmFqZWN0b3J5Q2FtZXJhcy5wb3AoKX1zZXQodCl7dGhpcy5fc2V0VHJhamVjdG9yeSh0KSx0aGlzLl9zZXRDdXJyZW50SW1hZ2UoKSx0aGlzLl9zZXRSZWZlcmVuY2UodGhpcy5fY3VycmVudEltYWdlKSx0aGlzLl9zZXRUcmFqZWN0b3JpZXMoKSx0aGlzLl9zZXRDdXJyZW50Q2FtZXJhKCl9Z2V0Q2VudGVyKCl7cmV0dXJuIG51bGwhPXRoaXMuX2N1cnJlbnRJbWFnZT90aGlzLmN1cnJlbnRUcmFuc2Zvcm0ucHJvamVjdEJhc2ljKHRoaXMuX2NhbWVyYS5sb29rYXQudG9BcnJheSgpKTpbLjUsLjVdfXNldFRyYW5zaXRpb25Nb2RlKHQpe3RoaXMuX3RyYW5zaXRpb25Nb2RlPXR9X2dldEFscGhhKCl7cmV0dXJuIDF9X3NldEN1cnJlbnQoKXt0aGlzLl9zZXRDdXJyZW50SW1hZ2UoKSx0aGlzLl9zZXRSZWZlcmVuY2UodGhpcy5fY3VycmVudEltYWdlKSYmdGhpcy5fc2V0VHJhamVjdG9yaWVzKCksdGhpcy5fc2V0Q3VycmVudENhbWVyYSgpfV9zZXRDdXJyZW50Q2FtZXJhKCl7dGhpcy5fY3VycmVudENhbWVyYT10aGlzLl90cmFqZWN0b3J5Q2FtZXJhc1t0aGlzLl9jdXJyZW50SW5kZXhdLmNsb25lKCksdGhpcy5fcHJldmlvdXNDYW1lcmE9dGhpcy5fY3VycmVudEluZGV4PjA/dGhpcy5fdHJhamVjdG9yeUNhbWVyYXNbdGhpcy5fY3VycmVudEluZGV4LTFdLmNsb25lKCk6dGhpcy5fY3VycmVudENhbWVyYS5jbG9uZSgpfV9tb3Rpb25sZXNzVHJhbnNpdGlvbigpe3JldHVybiBudWxsIT10aGlzLl9jdXJyZW50SW1hZ2UmJm51bGwhPXRoaXMuX3ByZXZpb3VzSW1hZ2UmJih0aGlzLl90cmFuc2l0aW9uTW9kZT09PXQuVHJhbnNpdGlvbk1vZGUuSW5zdGFudGFuZW91c3x8ISh0aGlzLl9jdXJyZW50SW1hZ2UubWVyZ2VkJiZ0aGlzLl9wcmV2aW91c0ltYWdlLm1lcmdlZCYmdGhpcy5fd2l0aGluT3JpZ2luYWxEaXN0YW5jZSgpJiZ0aGlzLl9zYW1lQ29ubmVjdGVkQ29tcG9uZW50KCkpKX1fc2V0UmVmZXJlbmNlKHQpe3JldHVybiEoTWF0aC5hYnModC5sbmdMYXQubGF0LXRoaXMucmVmZXJlbmNlLmxhdCk8dGhpcy5fcmVmZXJlbmNlVGhyZXNob2xkJiZNYXRoLmFicyh0LmxuZ0xhdC5sbmctdGhpcy5yZWZlcmVuY2UubG5nKTx0aGlzLl9yZWZlcmVuY2VUaHJlc2hvbGQpJiYoIShudWxsIT10aGlzLl9wcmV2aW91c0ltYWdlJiYhdGhpcy5fbW90aW9ubGVzc1RyYW5zaXRpb24oKSkmJih0aGlzLl9yZWZlcmVuY2UubGF0PXQubG5nTGF0LmxhdCx0aGlzLl9yZWZlcmVuY2UubG5nPXQubG5nTGF0LmxuZyx0aGlzLl9yZWZlcmVuY2UuYWx0PXQuY29tcHV0ZWRBbHRpdHVkZSwhMCkpfV9zZXRDdXJyZW50SW1hZ2UoKXt0aGlzLl9jdXJyZW50SW1hZ2U9dGhpcy5fdHJhamVjdG9yeS5sZW5ndGg+MD90aGlzLl90cmFqZWN0b3J5W3RoaXMuX2N1cnJlbnRJbmRleF06bnVsbCx0aGlzLl9wcmV2aW91c0ltYWdlPXRoaXMuX2N1cnJlbnRJbmRleD4wP3RoaXMuX3RyYWplY3RvcnlbdGhpcy5fY3VycmVudEluZGV4LTFdOm51bGx9X3NldFRyYWplY3RvcnkodCl7aWYodC5sZW5ndGg8MSl0aHJvdyBuZXcgaGQoXCJUcmFqZWN0b3J5IGNhbiBub3QgYmUgZW1wdHlcIik7bnVsbCE9dGhpcy5fY3VycmVudEltYWdlPyh0aGlzLl90cmFqZWN0b3J5PVt0aGlzLl9jdXJyZW50SW1hZ2VdLmNvbmNhdCh0KSx0aGlzLl9jdXJyZW50SW5kZXg9MSk6KHRoaXMuX3RyYWplY3Rvcnk9dC5zbGljZSgpLHRoaXMuX2N1cnJlbnRJbmRleD0wKX1fc2V0VHJhamVjdG9yaWVzKCl7dGhpcy5fdHJhamVjdG9yeVRyYW5zZm9ybXMubGVuZ3RoPTAsdGhpcy5fdHJhamVjdG9yeUNhbWVyYXMubGVuZ3RoPTAsdGhpcy5fYXBwZW5kVG9UcmFqZWN0b3JpZXModGhpcy5fdHJhamVjdG9yeSl9X2FwcGVuZFRvVHJhamVjdG9yaWVzKHQpe2ZvcihsZXQgZSBvZiB0KXtpZighZS5hc3NldHNDYWNoZWQpdGhyb3cgbmV3IGhkKFwiQXNzZXRzIG11c3QgYmUgY2FjaGVkIHdoZW4gaW1hZ2UgaXMgYWRkZWQgdG8gdHJhamVjdG9yeVwiKTtsZXQgdD10aGlzLl9pbWFnZVRvVHJhbnNsYXRpb24oZSx0aGlzLnJlZmVyZW5jZSksaT1uZXcgSGQoZS5leGlmT3JpZW50YXRpb24sZS53aWR0aCxlLmhlaWdodCxlLnNjYWxlLGUucm90YXRpb24sdCxlLmltYWdlLHZvaWQgMCxlLmNhbWVyYVBhcmFtZXRlcnMsZS5jYW1lcmFUeXBlKTt0aGlzLl90cmFqZWN0b3J5VHJhbnNmb3Jtcy5wdXNoKGkpLHRoaXMuX3RyYWplY3RvcnlDYW1lcmFzLnB1c2gobmV3IGpkKGkpKX19X3ByZXBlbmRUb1RyYWplY3Rvcmllcyh0KXtmb3IobGV0IGUgb2YgdC5yZXZlcnNlKCkpe2lmKCFlLmFzc2V0c0NhY2hlZCl0aHJvdyBuZXcgaGQoXCJBc3NldHMgbXVzdCBiZSBjYWNoZWQgd2hlbiBhZGRlZCB0byB0cmFqZWN0b3J5XCIpO2xldCB0PXRoaXMuX2ltYWdlVG9UcmFuc2xhdGlvbihlLHRoaXMucmVmZXJlbmNlKSxpPW5ldyBIZChlLmV4aWZPcmllbnRhdGlvbixlLndpZHRoLGUuaGVpZ2h0LGUuc2NhbGUsZS5yb3RhdGlvbix0LGUuaW1hZ2Usdm9pZCAwLGUuY2FtZXJhUGFyYW1ldGVycyxlLmNhbWVyYVR5cGUpO3RoaXMuX3RyYWplY3RvcnlUcmFuc2Zvcm1zLnVuc2hpZnQoaSksdGhpcy5fdHJhamVjdG9yeUNhbWVyYXMudW5zaGlmdChuZXcgamQoaSkpfX1faW1hZ2VUb1RyYW5zbGF0aW9uKHQsZSl7cmV0dXJuIGZkKHthbHQ6dC5jb21wdXRlZEFsdGl0dWRlLGxhdDp0LmxuZ0xhdC5sYXQsbG5nOnQubG5nTGF0LmxuZ30sdC5yb3RhdGlvbixlKX1fc2FtZUNvbm5lY3RlZENvbXBvbmVudCgpe2xldCB0PXRoaXMuX2N1cnJlbnRJbWFnZSxlPXRoaXMuX3ByZXZpb3VzSW1hZ2U7cmV0dXJuISF0JiYhIWUmJnQubWVyZ2VJZD09PWUubWVyZ2VJZH1fd2l0aGluT3JpZ2luYWxEaXN0YW5jZSgpe2xldCB0PXRoaXMuX2N1cnJlbnRJbWFnZSxlPXRoaXMuX3ByZXZpb3VzSW1hZ2U7cmV0dXJuIXR8fCFlfHx0aGlzLl9zcGF0aWFsLmRpc3RhbmNlRnJvbUxuZ0xhdCh0Lm9yaWdpbmFsTG5nTGF0LmxuZyx0Lm9yaWdpbmFsTG5nTGF0LmxhdCxlLm9yaWdpbmFsTG5nTGF0LmxuZyxlLm9yaWdpbmFsTG5nTGF0LmxhdCk8MjV9fWNsYXNzIFZke2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5fcGhpPXQsdGhpcy5fdGhldGE9ZX1nZXQgcGhpKCl7cmV0dXJuIHRoaXMuX3BoaX1zZXQgcGhpKHQpe3RoaXMuX3BoaT10fWdldCB0aGV0YSgpe3JldHVybiB0aGlzLl90aGV0YX1zZXQgdGhldGEodCl7dGhpcy5fdGhldGE9dH1nZXQgaXNaZXJvKCl7cmV0dXJuIDA9PT10aGlzLl9waGkmJjA9PT10aGlzLl90aGV0YX1jb3B5KHQpe3RoaXMuX3BoaT10LnBoaSx0aGlzLl90aGV0YT10LnRoZXRhfWxlcnAodCxlKXt0aGlzLl9waGk9KDEtZSkqdGhpcy5fcGhpK2UqdC5waGksdGhpcy5fdGhldGE9KDEtZSkqdGhpcy5fdGhldGErZSp0LnRoZXRhfW11bHRpcGx5KHQpe3RoaXMuX3BoaSo9dCx0aGlzLl90aGV0YSo9dH10aHJlc2hvbGQodCl7dGhpcy5fcGhpPU1hdGguYWJzKHRoaXMuX3BoaSk+dD90aGlzLl9waGk6MCx0aGlzLl90aGV0YT1NYXRoLmFicyh0aGlzLl90aGV0YSk+dD90aGlzLl90aGV0YTowfWxlbmd0aFNxdWFyZWQoKXtyZXR1cm4gdGhpcy5fcGhpKnRoaXMuX3BoaSt0aGlzLl90aGV0YSp0aGlzLl90aGV0YX1yZXNldCgpe3RoaXMuX3BoaT0wLHRoaXMuX3RoZXRhPTB9fWNsYXNzIEdkIGV4dGVuZHMgVWR7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fYW5pbWF0aW9uU3BlZWQ9MS80MCx0aGlzLl9yb3RhdGlvbkRlbHRhPW5ldyBWZCgwLDApLHRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGE9bnVsbCx0aGlzLl9iYXNpY1JvdGF0aW9uPVswLDBdLHRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb249bnVsbCx0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uVW5ib3VuZGVkPW51bGwsdGhpcy5fcm90YXRpb25BY2NlbGVyYXRpb249Ljg2LHRoaXMuX3JvdGF0aW9uSW5jcmVhc2VBbHBoYT0uOTcsdGhpcy5fcm90YXRpb25EZWNyZWFzZUFscGhhPS45LHRoaXMuX3JvdGF0aW9uVGhyZXNob2xkPS4wMDEsdGhpcy5fdW5ib3VuZGVkUm90YXRpb25BbHBoYT0uOCx0aGlzLl9kZXNpcmVkWm9vbT10Lnpvb20sdGhpcy5fbWluWm9vbT0wLHRoaXMuX21heFpvb209Myx0aGlzLl9sb29rYXREZXB0aD0xMCx0aGlzLl9kZXNpcmVkTG9va2F0PW51bGwsdGhpcy5fZGVzaXJlZENlbnRlcj1udWxsfXJvdGF0ZSh0KXtudWxsIT10aGlzLl9jdXJyZW50SW1hZ2UmJigwPT09dC5waGkmJjA9PT10LnRoZXRhfHwodGhpcy5fZGVzaXJlZFpvb209dGhpcy5fem9vbSx0aGlzLl9kZXNpcmVkTG9va2F0PW51bGwsdGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvbj1udWxsLG51bGwhPXRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGE/KHRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGEucGhpPXRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGEucGhpK3QucGhpLHRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGEudGhldGE9dGhpcy5fcmVxdWVzdGVkUm90YXRpb25EZWx0YS50aGV0YSt0LnRoZXRhKTp0aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhPW5ldyBWZCh0LnBoaSx0LnRoZXRhKSkpfXJvdGF0ZVVuYm91bmRlZCh0KXtpZihudWxsPT10aGlzLl9jdXJyZW50SW1hZ2UpcmV0dXJuO2lmKHRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb249bnVsbCx0aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhPW51bGwsdGhpcy5fYXBwbHlSb3RhdGlvbih0LHRoaXMuX2N1cnJlbnRDYW1lcmEpLHRoaXMuX2FwcGx5Um90YXRpb24odCx0aGlzLl9wcmV2aW91c0NhbWVyYSksIXRoaXMuX2Rlc2lyZWRMb29rYXQpcmV0dXJuO2NvbnN0IGU9KG5ldyBwbikuc2V0RnJvbVVuaXRWZWN0b3JzKHRoaXMuX2N1cnJlbnRDYW1lcmEudXAsbmV3IGZuKDAsMCwxKSksaT1lLmNsb25lKCkuaW52ZXJ0KCksbj0obmV3IGZuKS5jb3B5KHRoaXMuX2Rlc2lyZWRMb29rYXQpLnN1Yih0aGlzLl9jYW1lcmEucG9zaXRpb24pLmFwcGx5UXVhdGVybmlvbihlKSxyPW4ubGVuZ3RoKCk7bGV0IHM9TWF0aC5hdGFuMihuLnksbi54KTtzKz10LnBoaTtsZXQgbz1NYXRoLmF0YW4yKE1hdGguc3FydChuLngqbi54K24ueSpuLnkpLG4ueik7bys9dC50aGV0YSxvPU1hdGgubWF4KC4xLE1hdGgubWluKE1hdGguUEktLjEsbykpLG4ueD1NYXRoLnNpbihvKSpNYXRoLmNvcyhzKSxuLnk9TWF0aC5zaW4obykqTWF0aC5zaW4ocyksbi56PU1hdGguY29zKG8pLG4uYXBwbHlRdWF0ZXJuaW9uKGkpLHRoaXMuX2Rlc2lyZWRMb29rYXQuY29weSh0aGlzLl9jYW1lcmEucG9zaXRpb24pLmFkZChuLm11bHRpcGx5U2NhbGFyKHIpKX1yb3RhdGVXaXRob3V0SW5lcnRpYSh0KXtpZihudWxsPT10aGlzLl9jdXJyZW50SW1hZ2UpcmV0dXJuO3RoaXMuX2Rlc2lyZWRab29tPXRoaXMuX3pvb20sdGhpcy5fZGVzaXJlZExvb2thdD1udWxsLHRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb249bnVsbCx0aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhPW51bGw7Y29uc3QgZT1NYXRoLlBJLygxMCpNYXRoLnBvdygyLHRoaXMuX3pvb20pKSxpPXtwaGk6dGhpcy5fc3BhdGlhbC5jbGFtcCh0LnBoaSwtZSxlKSx0aGV0YTp0aGlzLl9zcGF0aWFsLmNsYW1wKHQudGhldGEsLWUsZSl9O3RoaXMuX2FwcGx5Um90YXRpb24oaSx0aGlzLl9jdXJyZW50Q2FtZXJhKSx0aGlzLl9hcHBseVJvdGF0aW9uKGksdGhpcy5fcHJldmlvdXNDYW1lcmEpfXJvdGF0ZUJhc2ljKHQpe2lmKG51bGwhPXRoaXMuX2N1cnJlbnRJbWFnZSlpZih0aGlzLl9kZXNpcmVkWm9vbT10aGlzLl96b29tLHRoaXMuX2Rlc2lyZWRMb29rYXQ9bnVsbCx0aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhPW51bGwsbnVsbCE9dGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvbil7dGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvblswXSs9dFswXSx0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uWzFdKz10WzFdO2xldCBlPS4wNS9NYXRoLnBvdygyLHRoaXMuX3pvb20pO3RoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb25bMF09dGhpcy5fc3BhdGlhbC5jbGFtcCh0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uWzBdLC1lLGUpLHRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb25bMV09dGhpcy5fc3BhdGlhbC5jbGFtcCh0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uWzFdLC1lLGUpfWVsc2UgdGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvbj10LnNsaWNlKCl9cm90YXRlQmFzaWNVbmJvdW5kZWQodCl7bnVsbCE9dGhpcy5fY3VycmVudEltYWdlJiYobnVsbCE9dGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvblVuYm91bmRlZD8odGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvblVuYm91bmRlZFswXSs9dFswXSx0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uVW5ib3VuZGVkWzFdKz10WzFdKTp0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uVW5ib3VuZGVkPXQuc2xpY2UoKSl9cm90YXRlQmFzaWNXaXRob3V0SW5lcnRpYSh0KXtpZihudWxsPT10aGlzLl9jdXJyZW50SW1hZ2UpcmV0dXJuO3RoaXMuX2Rlc2lyZWRab29tPXRoaXMuX3pvb20sdGhpcy5fZGVzaXJlZExvb2thdD1udWxsLHRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGE9bnVsbCx0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uPW51bGw7Y29uc3QgZT0uMDUvTWF0aC5wb3coMix0aGlzLl96b29tKSxpPXQuc2xpY2UoKTtpWzBdPXRoaXMuX3NwYXRpYWwuY2xhbXAoaVswXSwtZSxlKSxpWzFdPXRoaXMuX3NwYXRpYWwuY2xhbXAoaVsxXSwtZSxlKSx0aGlzLl9hcHBseVJvdGF0aW9uQmFzaWMoaSl9cm90YXRlVG9CYXNpYyh0KXtpZihudWxsPT10aGlzLl9jdXJyZW50SW1hZ2UpcmV0dXJuO3RoaXMuX2Rlc2lyZWRab29tPXRoaXMuX3pvb20sdGhpcy5fZGVzaXJlZExvb2thdD1udWxsLHRbMF09dGhpcy5fc3BhdGlhbC5jbGFtcCh0WzBdLDAsMSksdFsxXT10aGlzLl9zcGF0aWFsLmNsYW1wKHRbMV0sMCwxKTtsZXQgZT10aGlzLmN1cnJlbnRUcmFuc2Zvcm0udW5wcm9qZWN0QmFzaWModCx0aGlzLl9sb29rYXREZXB0aCk7dGhpcy5fY3VycmVudENhbWVyYS5sb29rYXQuZnJvbUFycmF5KGUpfXpvb21Jbih0LGUpe2lmKG51bGw9PXRoaXMuX2N1cnJlbnRJbWFnZSlyZXR1cm47dGhpcy5fZGVzaXJlZFpvb209TWF0aC5tYXgodGhpcy5fbWluWm9vbSxNYXRoLm1pbih0aGlzLl9tYXhab29tLHRoaXMuX2Rlc2lyZWRab29tK3QpKTtsZXQgaT10aGlzLmN1cnJlbnRUcmFuc2Zvcm0ucHJvamVjdEJhc2ljKHRoaXMuX2N1cnJlbnRDYW1lcmEubG9va2F0LnRvQXJyYXkoKSksbj1pWzBdLHI9aVsxXSxzPU1hdGgucG93KDIsdGhpcy5fem9vbSksbz1NYXRoLnBvdygyLHRoaXMuX2Rlc2lyZWRab29tKSxhPWVbMF0sYz1lWzFdO2RkKHRoaXMuY3VycmVudFRyYW5zZm9ybS5jYW1lcmFUeXBlKSYmKGEtbj4uNT9hLT0xOm4tYT4uNSYmKGE9MSthKSk7bGV0IGg9YS1zL28qKGEtbiksbD1jLXMvbyooYy1yKTtkZCh0aGlzLl9jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSk/KGg9dGhpcy5fc3BhdGlhbC53cmFwKGgrdGhpcy5fYmFzaWNSb3RhdGlvblswXSwwLDEpLGw9dGhpcy5fc3BhdGlhbC5jbGFtcChsK3RoaXMuX2Jhc2ljUm90YXRpb25bMV0sLjA1LC45NSkpOihoPXRoaXMuX3NwYXRpYWwuY2xhbXAoaCwwLDEpLGw9dGhpcy5fc3BhdGlhbC5jbGFtcChsLDAsMSkpLHRoaXMuX2Rlc2lyZWRMb29rYXQ9KG5ldyBmbikuZnJvbUFycmF5KHRoaXMuY3VycmVudFRyYW5zZm9ybS51bnByb2plY3RCYXNpYyhbaCxsXSx0aGlzLl9sb29rYXREZXB0aCkpfXNldENlbnRlcih0KXt0aGlzLl9kZXNpcmVkTG9va2F0PW51bGwsdGhpcy5fcmVxdWVzdGVkUm90YXRpb25EZWx0YT1udWxsLHRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb249bnVsbCx0aGlzLl9kZXNpcmVkWm9vbT10aGlzLl96b29tO2xldCBlPVt0aGlzLl9zcGF0aWFsLmNsYW1wKHRbMF0sMCwxKSx0aGlzLl9zcGF0aWFsLmNsYW1wKHRbMV0sMCwxKV07aWYobnVsbD09dGhpcy5fY3VycmVudEltYWdlKXJldHVybiB2b2lkKHRoaXMuX2Rlc2lyZWRDZW50ZXI9ZSk7dGhpcy5fZGVzaXJlZENlbnRlcj1udWxsO2xldCBpPShuZXcgZm4pLmZyb21BcnJheSh0aGlzLmN1cnJlbnRUcmFuc2Zvcm0udW5wcm9qZWN0QmFzaWMoZSx0aGlzLl9sb29rYXREZXB0aCkpLG49bnVsbCE9dGhpcy5wcmV2aW91c1RyYW5zZm9ybT90aGlzLnByZXZpb3VzVHJhbnNmb3JtOnRoaXMuY3VycmVudFRyYW5zZm9ybSxyPShuZXcgZm4pLmZyb21BcnJheShuLnVucHJvamVjdEJhc2ljKGUsdGhpcy5fbG9va2F0RGVwdGgpKTt0aGlzLl9jdXJyZW50Q2FtZXJhLmxvb2thdC5jb3B5KGkpLHRoaXMuX3ByZXZpb3VzQ2FtZXJhLmxvb2thdC5jb3B5KHIpfXNldFpvb20odCl7dGhpcy5fZGVzaXJlZExvb2thdD1udWxsLHRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGE9bnVsbCx0aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uPW51bGwsdGhpcy5fem9vbT10aGlzLl9zcGF0aWFsLmNsYW1wKHQsdGhpcy5fbWluWm9vbSx0aGlzLl9tYXhab29tKSx0aGlzLl9kZXNpcmVkWm9vbT10aGlzLl96b29tfV9hcHBseVJvdGF0aW9uKHQsZSl7aWYobnVsbD09ZSlyZXR1cm47bGV0IGk9KG5ldyBwbikuc2V0RnJvbVVuaXRWZWN0b3JzKGUudXAsbmV3IGZuKDAsMCwxKSksbj1pLmNsb25lKCkuaW52ZXJ0KCkscj1uZXcgZm47ci5jb3B5KGUubG9va2F0KS5zdWIoZS5wb3NpdGlvbiksci5hcHBseVF1YXRlcm5pb24oaSk7bGV0IHM9ci5sZW5ndGgoKSxvPU1hdGguYXRhbjIoci55LHIueCk7bys9dC5waGk7bGV0IGE9TWF0aC5hdGFuMihNYXRoLnNxcnQoci54KnIueCtyLnkqci55KSxyLnopO2ErPXQudGhldGEsYT1NYXRoLm1heCguMSxNYXRoLm1pbihNYXRoLlBJLS4xLGEpKSxyLng9TWF0aC5zaW4oYSkqTWF0aC5jb3Mobyksci55PU1hdGguc2luKGEpKk1hdGguc2luKG8pLHIuej1NYXRoLmNvcyhhKSxyLmFwcGx5UXVhdGVybmlvbihuKSxlLmxvb2thdC5jb3B5KGUucG9zaXRpb24pLmFkZChyLm11bHRpcGx5U2NhbGFyKHMpKX1fYXBwbHlSb3RhdGlvbkJhc2ljKHQpe2xldCBlPXRoaXMuX2N1cnJlbnRJbWFnZSxpPW51bGwhPXRoaXMuX3ByZXZpb3VzSW1hZ2U/dGhpcy5wcmV2aW91c0ltYWdlOnRoaXMuY3VycmVudEltYWdlLG49dGhpcy5fY3VycmVudENhbWVyYSxyPXRoaXMuX3ByZXZpb3VzQ2FtZXJhLHM9dGhpcy5jdXJyZW50VHJhbnNmb3JtLG89bnVsbCE9dGhpcy5wcmV2aW91c1RyYW5zZm9ybT90aGlzLnByZXZpb3VzVHJhbnNmb3JtOnRoaXMuY3VycmVudFRyYW5zZm9ybSxhPXMucHJvamVjdEJhc2ljKG4ubG9va2F0LnRvQXJyYXkoKSksYz1vLnByb2plY3RCYXNpYyhyLmxvb2thdC50b0FycmF5KCkpO2RkKGUuY2FtZXJhVHlwZSk/KGFbMF09dGhpcy5fc3BhdGlhbC53cmFwKGFbMF0rdFswXSwwLDEpLGFbMV09dGhpcy5fc3BhdGlhbC5jbGFtcChhWzFdK3RbMV0sLjA1LC45NSkpOihhWzBdPXRoaXMuX3NwYXRpYWwuY2xhbXAoYVswXSt0WzBdLDAsMSksYVsxXT10aGlzLl9zcGF0aWFsLmNsYW1wKGFbMV0rdFsxXSwwLDEpKSxkZChpLmNhbWVyYVR5cGUpPyhjWzBdPXRoaXMuX3NwYXRpYWwud3JhcChjWzBdK3RbMF0sMCwxKSxjWzFdPXRoaXMuX3NwYXRpYWwuY2xhbXAoY1sxXSt0WzFdLC4wNSwuOTUpKTooY1swXT10aGlzLl9zcGF0aWFsLmNsYW1wKGNbMF0rdFswXSwwLDEpLGNbMV09dGhpcy5fc3BhdGlhbC5jbGFtcChhWzFdK3RbMV0sMCwxKSk7bGV0IGg9cy51bnByb2plY3RCYXNpYyhhLHRoaXMuX2xvb2thdERlcHRoKTtuLmxvb2thdC5mcm9tQXJyYXkoaCk7bGV0IGw9by51bnByb2plY3RCYXNpYyhjLHRoaXMuX2xvb2thdERlcHRoKTtyLmxvb2thdC5mcm9tQXJyYXkobCl9X3VwZGF0ZVpvb20odCl7bGV0IGU9dGhpcy5fZGVzaXJlZFpvb20tdGhpcy5fem9vbSxpPWU+MD8xOmU8MD8tMTowOzAhPT1lJiYoTWF0aC5hYnMoZSk8LjAwMj8odGhpcy5fem9vbT10aGlzLl9kZXNpcmVkWm9vbSxudWxsIT10aGlzLl9kZXNpcmVkTG9va2F0JiYodGhpcy5fZGVzaXJlZExvb2thdD1udWxsKSk6dGhpcy5fem9vbSs9aSpNYXRoLm1heChNYXRoLmFicyg1KnQqZSksLjAwMikpfV91cGRhdGVMb29rYXQodCl7aWYobnVsbD09PXRoaXMuX2Rlc2lyZWRMb29rYXQpcmV0dXJuO2xldCBlPXRoaXMuX2Rlc2lyZWRMb29rYXQuZGlzdGFuY2VUb1NxdWFyZWQodGhpcy5fY3VycmVudENhbWVyYS5sb29rYXQpO01hdGguYWJzKGUpPDFlLTY/KHRoaXMuX2N1cnJlbnRDYW1lcmEubG9va2F0LmNvcHkodGhpcy5fZGVzaXJlZExvb2thdCksdGhpcy5fZGVzaXJlZExvb2thdD1udWxsKTp0aGlzLl9jdXJyZW50Q2FtZXJhLmxvb2thdC5sZXJwKHRoaXMuX2Rlc2lyZWRMb29rYXQsNSp0KX1fdXBkYXRlUm90YXRpb24oKXtpZihudWxsIT10aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhKXtsZXQgdD10aGlzLl9yb3RhdGlvbkRlbHRhLmxlbmd0aFNxdWFyZWQoKTtyZXR1cm4gdGhpcy5fcmVxdWVzdGVkUm90YXRpb25EZWx0YS5sZW5ndGhTcXVhcmVkKCk+dD90aGlzLl9yb3RhdGlvbkRlbHRhLmxlcnAodGhpcy5fcmVxdWVzdGVkUm90YXRpb25EZWx0YSx0aGlzLl9yb3RhdGlvbkluY3JlYXNlQWxwaGEpOnRoaXMuX3JvdGF0aW9uRGVsdGEubGVycCh0aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhLHRoaXMuX3JvdGF0aW9uRGVjcmVhc2VBbHBoYSksdm9pZCh0aGlzLl9yZXF1ZXN0ZWRSb3RhdGlvbkRlbHRhPW51bGwpfWlmKHRoaXMuX3JvdGF0aW9uRGVsdGEuaXNaZXJvKXJldHVybjtjb25zdCB0PWRkKHRoaXMuY3VycmVudEltYWdlLmNhbWVyYVR5cGUpPzE6dGhpcy5fYWxwaGE7dGhpcy5fcm90YXRpb25EZWx0YS5tdWx0aXBseSh0aGlzLl9yb3RhdGlvbkFjY2VsZXJhdGlvbip0KSx0aGlzLl9yb3RhdGlvbkRlbHRhLnRocmVzaG9sZCh0aGlzLl9yb3RhdGlvblRocmVzaG9sZCl9X3VwZGF0ZVJvdGF0aW9uQmFzaWMoKXtpZihudWxsIT10aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uKXtsZXQgdD10aGlzLl9iYXNpY1JvdGF0aW9uWzBdLGU9dGhpcy5fYmFzaWNSb3RhdGlvblsxXSxpPXRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb25bMF0sbj10aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uWzFdO3JldHVybiBNYXRoLmFicyhpKT5NYXRoLmFicyh0KT90aGlzLl9iYXNpY1JvdGF0aW9uWzBdPSgxLXRoaXMuX3JvdGF0aW9uSW5jcmVhc2VBbHBoYSkqdCt0aGlzLl9yb3RhdGlvbkluY3JlYXNlQWxwaGEqaTp0aGlzLl9iYXNpY1JvdGF0aW9uWzBdPSgxLXRoaXMuX3JvdGF0aW9uRGVjcmVhc2VBbHBoYSkqdCt0aGlzLl9yb3RhdGlvbkRlY3JlYXNlQWxwaGEqaSxNYXRoLmFicyhuKT5NYXRoLmFicyhlKT90aGlzLl9iYXNpY1JvdGF0aW9uWzFdPSgxLXRoaXMuX3JvdGF0aW9uSW5jcmVhc2VBbHBoYSkqZSt0aGlzLl9yb3RhdGlvbkluY3JlYXNlQWxwaGEqbjp0aGlzLl9iYXNpY1JvdGF0aW9uWzFdPSgxLXRoaXMuX3JvdGF0aW9uRGVjcmVhc2VBbHBoYSkqZSt0aGlzLl9yb3RhdGlvbkRlY3JlYXNlQWxwaGEqbix2b2lkKHRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb249bnVsbCl9aWYobnVsbCE9dGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvblVuYm91bmRlZCl7bGV0IHQ9dGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvblVuYm91bmRlZFswXSxlPXRoaXMuX3JlcXVlc3RlZEJhc2ljUm90YXRpb25VbmJvdW5kZWRbMV07aWYoTWF0aC5hYnModCk+MCYmKHRoaXMuX2Jhc2ljUm90YXRpb25bMF09KDEtdGhpcy5fdW5ib3VuZGVkUm90YXRpb25BbHBoYSkqdGhpcy5fYmFzaWNSb3RhdGlvblswXSt0aGlzLl91bmJvdW5kZWRSb3RhdGlvbkFscGhhKnQpLE1hdGguYWJzKGUpPjAmJih0aGlzLl9iYXNpY1JvdGF0aW9uWzFdPSgxLXRoaXMuX3VuYm91bmRlZFJvdGF0aW9uQWxwaGEpKnRoaXMuX2Jhc2ljUm90YXRpb25bMV0rdGhpcy5fdW5ib3VuZGVkUm90YXRpb25BbHBoYSplKSxudWxsIT10aGlzLl9kZXNpcmVkTG9va2F0KXtsZXQgaT10aGlzLmN1cnJlbnRUcmFuc2Zvcm0ucHJvamVjdEJhc2ljKHRoaXMuX2Rlc2lyZWRMb29rYXQudG9BcnJheSgpKTtpWzBdKz10LGlbMV0rPWUsdGhpcy5fZGVzaXJlZExvb2thdD0obmV3IGZuKS5mcm9tQXJyYXkodGhpcy5jdXJyZW50VHJhbnNmb3JtLnVucHJvamVjdEJhc2ljKGksdGhpcy5fbG9va2F0RGVwdGgpKX10aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uVW5ib3VuZGVkPW51bGx9MD09PXRoaXMuX2Jhc2ljUm90YXRpb25bMF0mJjA9PT10aGlzLl9iYXNpY1JvdGF0aW9uWzFdfHwodGhpcy5fYmFzaWNSb3RhdGlvblswXT10aGlzLl9yb3RhdGlvbkFjY2VsZXJhdGlvbip0aGlzLl9iYXNpY1JvdGF0aW9uWzBdLHRoaXMuX2Jhc2ljUm90YXRpb25bMV09dGhpcy5fcm90YXRpb25BY2NlbGVyYXRpb24qdGhpcy5fYmFzaWNSb3RhdGlvblsxXSxNYXRoLmFicyh0aGlzLl9iYXNpY1JvdGF0aW9uWzBdKTx0aGlzLl9yb3RhdGlvblRocmVzaG9sZC9NYXRoLnBvdygyLHRoaXMuX3pvb20pJiZNYXRoLmFicyh0aGlzLl9iYXNpY1JvdGF0aW9uWzFdKTx0aGlzLl9yb3RhdGlvblRocmVzaG9sZC9NYXRoLnBvdygyLHRoaXMuX3pvb20pJiYodGhpcy5fYmFzaWNSb3RhdGlvbj1bMCwwXSkpfV9jbGVhclJvdGF0aW9uKCl7ZGQodGhpcy5fY3VycmVudEltYWdlLmNhbWVyYVR5cGUpfHwobnVsbCE9dGhpcy5fcmVxdWVzdGVkUm90YXRpb25EZWx0YSYmKHRoaXMuX3JlcXVlc3RlZFJvdGF0aW9uRGVsdGE9bnVsbCksdGhpcy5fcm90YXRpb25EZWx0YS5pc1plcm98fHRoaXMuX3JvdGF0aW9uRGVsdGEucmVzZXQoKSxudWxsIT10aGlzLl9yZXF1ZXN0ZWRCYXNpY1JvdGF0aW9uJiYodGhpcy5fcmVxdWVzdGVkQmFzaWNSb3RhdGlvbj1udWxsKSwodGhpcy5fYmFzaWNSb3RhdGlvblswXT4wfHx0aGlzLl9iYXNpY1JvdGF0aW9uWzFdPjApJiYodGhpcy5fYmFzaWNSb3RhdGlvbj1bMCwwXSkpfV9zZXREZXNpcmVkQ2VudGVyKCl7aWYobnVsbD09dGhpcy5fZGVzaXJlZENlbnRlcilyZXR1cm47bGV0IHQ9KG5ldyBmbikuZnJvbUFycmF5KHRoaXMuY3VycmVudFRyYW5zZm9ybS51bnByb2plY3RCYXNpYyh0aGlzLl9kZXNpcmVkQ2VudGVyLHRoaXMuX2xvb2thdERlcHRoKSkuc3ViKHRoaXMuX2N1cnJlbnRDYW1lcmEucG9zaXRpb24pO3RoaXMuX2N1cnJlbnRDYW1lcmEubG9va2F0LmNvcHkodGhpcy5fY3VycmVudENhbWVyYS5wb3NpdGlvbi5jbG9uZSgpLmFkZCh0KSksdGhpcy5fcHJldmlvdXNDYW1lcmEubG9va2F0LmNvcHkodGhpcy5fcHJldmlvdXNDYW1lcmEucG9zaXRpb24uY2xvbmUoKS5hZGQodCkpLHRoaXMuX2Rlc2lyZWRDZW50ZXI9bnVsbH1fc2V0RGVzaXJlZFpvb20oKXt0aGlzLl9kZXNpcmVkWm9vbT1kZCh0aGlzLl9jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSl8fG51bGw9PXRoaXMuX3ByZXZpb3VzSW1hZ2U/dGhpcy5fem9vbTowfX1jbGFzcyBxZCBleHRlbmRzIEdke2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuX2FkanVzdENhbWVyYXMoKSx0aGlzLl9tb3Rpb25sZXNzPXRoaXMuX21vdGlvbmxlc3NUcmFuc2l0aW9uKCksdGhpcy5fYmFzZUFscGhhPXRoaXMuX2FscGhhLHRoaXMuX3NwZWVkQ29lZmZpY2llbnQ9MSx0aGlzLl91bml0QmV6aWVyPW5ldyBxZC5faW50ZXJwb2xhdG9yKC43NCwuNjcsLjM4LC45NiksdGhpcy5fdXNlQmV6aWVyPSExfXN0YXRpYyByZWdpc3Rlcih0KXtxZC5faW50ZXJwb2xhdG9yPXR9YXBwZW5kKHQpe2xldCBlPTA9PT10aGlzLl90cmFqZWN0b3J5Lmxlbmd0aDtlJiZ0aGlzLl9yZXNldFRyYW5zaXRpb24oKSxzdXBlci5hcHBlbmQodCksZSYmKHRoaXMuX3NldERlc2lyZWRDZW50ZXIoKSx0aGlzLl9zZXREZXNpcmVkWm9vbSgpKX1wcmVwZW5kKHQpe2xldCBlPTA9PT10aGlzLl90cmFqZWN0b3J5Lmxlbmd0aDtlJiZ0aGlzLl9yZXNldFRyYW5zaXRpb24oKSxzdXBlci5wcmVwZW5kKHQpLGUmJih0aGlzLl9zZXREZXNpcmVkQ2VudGVyKCksdGhpcy5fc2V0RGVzaXJlZFpvb20oKSl9c2V0KHQpe3N1cGVyLnNldCh0KSx0aGlzLl9kZXNpcmVkTG9va2F0PW51bGwsdGhpcy5fcmVzZXRUcmFuc2l0aW9uKCksdGhpcy5fY2xlYXJSb3RhdGlvbigpLHRoaXMuX3NldERlc2lyZWRDZW50ZXIoKSx0aGlzLl9zZXREZXNpcmVkWm9vbSgpLHRoaXMuX3RyYWplY3RvcnkubGVuZ3RoPDMmJih0aGlzLl91c2VCZXppZXI9ITApfXNldFNwZWVkKHQpe3RoaXMuX3NwZWVkQ29lZmZpY2llbnQ9dGhpcy5fc3BhdGlhbC5jbGFtcCh0LDAsMTApfXVwZGF0ZSh0KXsxPT09dGhpcy5fYWxwaGEmJnRoaXMuX2N1cnJlbnRJbmRleCt0aGlzLl9hbHBoYTx0aGlzLl90cmFqZWN0b3J5Lmxlbmd0aCYmKHRoaXMuX2N1cnJlbnRJbmRleCs9MSx0aGlzLl91c2VCZXppZXI9dGhpcy5fdHJhamVjdG9yeS5sZW5ndGg8MyYmdGhpcy5fY3VycmVudEluZGV4KzE9PT10aGlzLl90cmFqZWN0b3J5Lmxlbmd0aCx0aGlzLl9zZXRDdXJyZW50KCksdGhpcy5fcmVzZXRUcmFuc2l0aW9uKCksdGhpcy5fY2xlYXJSb3RhdGlvbigpLHRoaXMuX2Rlc2lyZWRab29tPWRkKHRoaXMuX2N1cnJlbnRJbWFnZS5jYW1lcmFUeXBlKT90aGlzLl96b29tOjAsdGhpcy5fZGVzaXJlZExvb2thdD1udWxsKTtsZXQgZT10aGlzLl9hbmltYXRpb25TcGVlZCooNjAvdCk7dGhpcy5fYmFzZUFscGhhPU1hdGgubWluKDEsdGhpcy5fYmFzZUFscGhhK3RoaXMuX3NwZWVkQ29lZmZpY2llbnQqZSksdGhpcy5fdXNlQmV6aWVyP3RoaXMuX2FscGhhPXRoaXMuX3VuaXRCZXppZXIuc29sdmUodGhpcy5fYmFzZUFscGhhKTp0aGlzLl9hbHBoYT10aGlzLl9iYXNlQWxwaGEsdGhpcy5fdXBkYXRlUm90YXRpb24oKSx0aGlzLl9yb3RhdGlvbkRlbHRhLmlzWmVyb3x8KHRoaXMuX2FwcGx5Um90YXRpb24odGhpcy5fcm90YXRpb25EZWx0YSx0aGlzLl9wcmV2aW91c0NhbWVyYSksdGhpcy5fYXBwbHlSb3RhdGlvbih0aGlzLl9yb3RhdGlvbkRlbHRhLHRoaXMuX2N1cnJlbnRDYW1lcmEpKSx0aGlzLl91cGRhdGVSb3RhdGlvbkJhc2ljKCksMD09PXRoaXMuX2Jhc2ljUm90YXRpb25bMF0mJjA9PT10aGlzLl9iYXNpY1JvdGF0aW9uWzFdfHx0aGlzLl9hcHBseVJvdGF0aW9uQmFzaWModGhpcy5fYmFzaWNSb3RhdGlvbiksdGhpcy5fdXBkYXRlWm9vbShlKSx0aGlzLl91cGRhdGVMb29rYXQoZSksdGhpcy5fY2FtZXJhLmxlcnBDYW1lcmFzKHRoaXMuX3ByZXZpb3VzQ2FtZXJhLHRoaXMuX2N1cnJlbnRDYW1lcmEsdGhpcy5hbHBoYSl9X2dldEFscGhhKCl7cmV0dXJuIHRoaXMuX21vdGlvbmxlc3M/TWF0aC5jZWlsKHRoaXMuX2FscGhhKTp0aGlzLl9hbHBoYX1fc2V0Q3VycmVudENhbWVyYSgpe3N1cGVyLl9zZXRDdXJyZW50Q2FtZXJhKCksdGhpcy5fYWRqdXN0Q2FtZXJhcygpfV9hZGp1c3RDYW1lcmFzKCl7aWYobnVsbD09dGhpcy5fcHJldmlvdXNJbWFnZSlyZXR1cm47bGV0IHQ9dGhpcy5fY2FtZXJhLmxvb2thdC5jbG9uZSgpLnN1Yih0aGlzLl9jYW1lcmEucG9zaXRpb24pO3RoaXMuX3ByZXZpb3VzQ2FtZXJhLmxvb2thdC5jb3B5KHQuY2xvbmUoKS5hZGQodGhpcy5fcHJldmlvdXNDYW1lcmEucG9zaXRpb24pKSxkZCh0aGlzLl9jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSkmJnRoaXMuX2N1cnJlbnRDYW1lcmEubG9va2F0LmNvcHkodC5jbG9uZSgpLmFkZCh0aGlzLl9jdXJyZW50Q2FtZXJhLnBvc2l0aW9uKSl9X3Jlc2V0VHJhbnNpdGlvbigpe3RoaXMuX2FscGhhPTAsdGhpcy5fYmFzZUFscGhhPTAsdGhpcy5fbW90aW9ubGVzcz10aGlzLl9tb3Rpb25sZXNzVHJhbnNpdGlvbigpfX1jbGFzcyBXZHtjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX2NvbXBvbmVudHM9e307Zm9yKGNvbnN0IGkgaW4gV2QucmVnaXN0ZXJlZENvbXBvbmVudHMpe2lmKCFXZC5yZWdpc3RlcmVkQ29tcG9uZW50cy5oYXNPd25Qcm9wZXJ0eShpKSljb250aW51ZTtjb25zdCBuPVdkLnJlZ2lzdGVyZWRDb21wb25lbnRzW2ldO3RoaXMuX2NvbXBvbmVudHNbaV09e2FjdGl2ZTohMSxjb21wb25lbnQ6bmV3IG4oaSx0LGUpfX10aGlzLl9jb3ZlckNvbXBvbmVudD1uZXcgV2QucmVnaXN0ZXJlZENvdmVyQ29tcG9uZW50KFwiY292ZXJcIix0LGUpLHRoaXMuX2NvdmVyQ29tcG9uZW50LmFjdGl2YXRlKCksdGhpcy5fY292ZXJBY3RpdmF0ZWQ9ITB9c3RhdGljIHJlZ2lzdGVyKHQpe3ZvaWQgMD09PVdkLnJlZ2lzdGVyZWRDb21wb25lbnRzW3QuY29tcG9uZW50TmFtZV0mJihXZC5yZWdpc3RlcmVkQ29tcG9uZW50c1t0LmNvbXBvbmVudE5hbWVdPXQpfXN0YXRpYyByZWdpc3RlckNvdmVyKHQpe1dkLnJlZ2lzdGVyZWRDb3ZlckNvbXBvbmVudD10fWdldCBjb3ZlckFjdGl2YXRlZCgpe3JldHVybiB0aGlzLl9jb3ZlckFjdGl2YXRlZH1hY3RpdmF0ZUNvdmVyKCl7aWYoIXRoaXMuX2NvdmVyQWN0aXZhdGVkKXt0aGlzLl9jb3ZlckFjdGl2YXRlZD0hMDtmb3IoY29uc3QgdCBpbiB0aGlzLl9jb21wb25lbnRzKXtpZighdGhpcy5fY29tcG9uZW50cy5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtjb25zdCBlPXRoaXMuX2NvbXBvbmVudHNbdF07ZS5hY3RpdmUmJmUuY29tcG9uZW50LmRlYWN0aXZhdGUoKX19fWRlYWN0aXZhdGVDb3Zlcigpe2lmKHRoaXMuX2NvdmVyQWN0aXZhdGVkKXt0aGlzLl9jb3ZlckFjdGl2YXRlZD0hMTtmb3IoY29uc3QgdCBpbiB0aGlzLl9jb21wb25lbnRzKXtpZighdGhpcy5fY29tcG9uZW50cy5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtjb25zdCBlPXRoaXMuX2NvbXBvbmVudHNbdF07ZS5hY3RpdmUmJmUuY29tcG9uZW50LmFjdGl2YXRlKCl9fX1hY3RpdmF0ZSh0KXt0aGlzLl9jaGVja05hbWUodCksdGhpcy5fY29tcG9uZW50c1t0XS5hY3RpdmU9ITAsdGhpcy5fY292ZXJBY3RpdmF0ZWR8fHRoaXMuZ2V0KHQpLmFjdGl2YXRlKCl9Y29uZmlndXJlKHQsZSl7dGhpcy5fY2hlY2tOYW1lKHQpLHRoaXMuZ2V0KHQpLmNvbmZpZ3VyZShlKX1kZWFjdGl2YXRlKHQpe3RoaXMuX2NoZWNrTmFtZSh0KSx0aGlzLl9jb21wb25lbnRzW3RdLmFjdGl2ZT0hMSx0aGlzLl9jb3ZlckFjdGl2YXRlZHx8dGhpcy5nZXQodCkuZGVhY3RpdmF0ZSgpfWdldCh0KXtyZXR1cm4gdGhpcy5fY29tcG9uZW50c1t0XS5jb21wb25lbnR9Z2V0Q292ZXIoKXtyZXR1cm4gdGhpcy5fY292ZXJDb21wb25lbnR9cmVtb3ZlKCl7dGhpcy5fY292ZXJDb21wb25lbnQuZGVhY3RpdmF0ZSgpO2Zvcihjb25zdCB0IGluIHRoaXMuX2NvbXBvbmVudHMpdGhpcy5fY29tcG9uZW50cy5oYXNPd25Qcm9wZXJ0eSh0KSYmdGhpcy5fY29tcG9uZW50c1t0XS5jb21wb25lbnQuZGVhY3RpdmF0ZSgpfV9jaGVja05hbWUodCl7aWYoISh0IGluIHRoaXMuX2NvbXBvbmVudHMpKXRocm93IG5ldyBoZChgQ29tcG9uZW50IGRvZXMgbm90IGV4aXN0OiAke3R9YCl9fVdkLnJlZ2lzdGVyZWRDb21wb25lbnRzPXt9O3ZhciBYZD1BcnJheS5pc0FycmF5LFlkPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsWmQ9WGR8fGZ1bmN0aW9uKHQpe3JldHVyblwiW29iamVjdCBBcnJheV1cIj09PVlkLmNhbGwodCl9O3ZhciBKZD1cIjJcIjtRZC5OT05FPTAsUWQuVlRFWFQ9MSxRZC5WTk9ERT0yLFFkLldJREdFVD0zLFFkLlBST1BTPTQsUWQuT1JERVI9NSxRZC5JTlNFUlQ9NixRZC5SRU1PVkU9NyxRZC5USFVOSz04O3ZhciBLZD1RZDtmdW5jdGlvbiBRZCh0LGUsaSl7dGhpcy50eXBlPU51bWJlcih0KSx0aGlzLnZOb2RlPWUsdGhpcy5wYXRjaD1pfVFkLnByb3RvdHlwZS52ZXJzaW9uPUpkLFFkLnByb3RvdHlwZS50eXBlPVwiVmlydHVhbFBhdGNoXCI7dmFyIHRwPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZcIlZpcnR1YWxOb2RlXCI9PT10LnR5cGUmJnQudmVyc2lvbj09PUpkfTt2YXIgZXA9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiVmlydHVhbFRleHRcIj09PXQudHlwZSYmdC52ZXJzaW9uPT09SmR9O3ZhciBpcD1mdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJXaWRnZXRcIj09PXQudHlwZX07dmFyIG5wPWZ1bmN0aW9uKHQpe3JldHVybiB0JiZcIlRodW5rXCI9PT10LnR5cGV9O3ZhciBycD1mdW5jdGlvbih0LGUpe3ZhciBpPXQsbj1lO25wKGUpJiYobj1zcChlLHQpKTtucCh0KSYmKGk9c3AodCxudWxsKSk7cmV0dXJue2E6aSxiOm59fTtmdW5jdGlvbiBzcCh0LGUpe3ZhciBpPXQudm5vZGU7aWYoaXx8KGk9dC52bm9kZT10LnJlbmRlcihlKSksISh0cChpKXx8ZXAoaSl8fGlwKGkpKSl0aHJvdyBuZXcgRXJyb3IoXCJ0aHVuayBkaWQgbm90IHJldHVybiBhIHZhbGlkIG5vZGVcIik7cmV0dXJuIGl9dmFyIG9wPWZ1bmN0aW9uKHQpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB0JiZudWxsIT09dH0sYXA9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJihcImZ1bmN0aW9uXCI9PXR5cGVvZiB0Lmhvb2smJiF0Lmhhc093blByb3BlcnR5KFwiaG9va1wiKXx8XCJmdW5jdGlvblwiPT10eXBlb2YgdC51bmhvb2smJiF0Lmhhc093blByb3BlcnR5KFwidW5ob29rXCIpKX07dmFyIGNwPWZ1bmN0aW9uIHQoZSxpKXt2YXIgbjtmb3IodmFyIHIgaW4gZSl7ciBpbiBpfHwoKG49bnx8e30pW3JdPXZvaWQgMCk7dmFyIHM9ZVtyXSxvPWlbcl07aWYocyE9PW8paWYob3AocykmJm9wKG8pKWlmKGhwKG8pIT09aHAocykpKG49bnx8e30pW3JdPW87ZWxzZSBpZihhcChvKSkobj1ufHx7fSlbcl09bztlbHNle3ZhciBhPXQocyxvKTthJiYoKG49bnx8e30pW3JdPWEpfWVsc2Uobj1ufHx7fSlbcl09b31mb3IodmFyIGMgaW4gaSljIGluIGV8fCgobj1ufHx7fSlbY109aVtjXSk7cmV0dXJuIG59O2Z1bmN0aW9uIGhwKHQpe3JldHVybiBPYmplY3QuZ2V0UHJvdG90eXBlT2Y/T2JqZWN0LmdldFByb3RvdHlwZU9mKHQpOnQuX19wcm90b19fP3QuX19wcm90b19fOnQuY29uc3RydWN0b3I/dC5jb25zdHJ1Y3Rvci5wcm90b3R5cGU6dm9pZCAwfWZ1bmN0aW9uIGxwKHQsZSl7dmFyIGk9e2E6dH07cmV0dXJuIHVwKHQsZSxpLDApLGl9ZnVuY3Rpb24gdXAodCxlLGksbil7aWYodCE9PWUpe3ZhciByPWlbbl0scz0hMTtpZihucCh0KXx8bnAoZSkpZnAodCxlLGksbik7ZWxzZSBpZihudWxsPT1lKWlwKHQpfHwoZHAodCxpLG4pLHI9aVtuXSkscj12cChyLG5ldyBLZChLZC5SRU1PVkUsdCxlKSk7ZWxzZSBpZih0cChlKSlpZih0cCh0KSlpZih0LnRhZ05hbWU9PT1lLnRhZ05hbWUmJnQubmFtZXNwYWNlPT09ZS5uYW1lc3BhY2UmJnQua2V5PT09ZS5rZXkpe3ZhciBvPWNwKHQucHJvcGVydGllcyxlLnByb3BlcnRpZXMpO28mJihyPXZwKHIsbmV3IEtkKEtkLlBST1BTLHQsbykpKSxyPWZ1bmN0aW9uKHQsZSxpLG4scil7Zm9yKHZhciBzPXQuY2hpbGRyZW4sbz1mdW5jdGlvbih0LGUpe3ZhciBpPV9wKGUpLG49aS5rZXlzLHI9aS5mcmVlO2lmKHIubGVuZ3RoPT09ZS5sZW5ndGgpcmV0dXJue2NoaWxkcmVuOmUsbW92ZXM6bnVsbH07dmFyIHM9X3AodCksbz1zLmtleXM7aWYocy5mcmVlLmxlbmd0aD09PXQubGVuZ3RoKXJldHVybntjaGlsZHJlbjplLG1vdmVzOm51bGx9O2Zvcih2YXIgYT1bXSxjPTAsaD1yLmxlbmd0aCxsPTAsdT0wO3U8dC5sZW5ndGg7dSsrKXt2YXIgZCxwPXRbdV07cC5rZXk/bi5oYXNPd25Qcm9wZXJ0eShwLmtleSk/KGQ9bltwLmtleV0sYS5wdXNoKGVbZF0pKTooZD11LWwrKyxhLnB1c2gobnVsbCkpOmM8aD8oZD1yW2MrK10sYS5wdXNoKGVbZF0pKTooZD11LWwrKyxhLnB1c2gobnVsbCkpfWZvcih2YXIgZj1jPj1yLmxlbmd0aD9lLmxlbmd0aDpyW2NdLG09MDttPGUubGVuZ3RoO20rKyl7dmFyIGc9ZVttXTtnLmtleT9vLmhhc093blByb3BlcnR5KGcua2V5KXx8YS5wdXNoKGcpOm0+PWYmJmEucHVzaChnKX1mb3IodmFyIF8sdj1hLnNsaWNlKCkseT0wLGI9W10seD1bXSx3PTA7dzxlLmxlbmd0aDspe3ZhciBTPWVbd107Zm9yKF89dlt5XTtudWxsPT09XyYmdi5sZW5ndGg7KWIucHVzaChncCh2LHksbnVsbCkpLF89dlt5XTtfJiZfLmtleT09PVMua2V5Pyh5KyssdysrKTpTLmtleT8oXyYmXy5rZXkmJm5bXy5rZXldIT09dysxPyhiLnB1c2goZ3Aodix5LF8ua2V5KSksKF89dlt5XSkmJl8ua2V5PT09Uy5rZXk/eSsrOngucHVzaCh7a2V5OlMua2V5LHRvOnd9KSk6eC5wdXNoKHtrZXk6Uy5rZXksdG86d30pLHcrKyk6XyYmXy5rZXkmJmIucHVzaChncCh2LHksXy5rZXkpKX1mb3IoO3k8di5sZW5ndGg7KV89dlt5XSxiLnB1c2goZ3Aodix5LF8mJl8ua2V5KSk7aWYoYi5sZW5ndGg9PT1sJiYheC5sZW5ndGgpcmV0dXJue2NoaWxkcmVuOmEsbW92ZXM6bnVsbH07cmV0dXJue2NoaWxkcmVuOmEsbW92ZXM6e3JlbW92ZXM6YixpbnNlcnRzOnh9fX0ocyxlLmNoaWxkcmVuKSxhPW8uY2hpbGRyZW4sYz1zLmxlbmd0aCxoPWEubGVuZ3RoLGw9Yz5oP2M6aCx1PTA7dTxsO3UrKyl7dmFyIGQ9c1t1XSxwPWFbdV07cis9MSxkP3VwKGQscCxpLHIpOnAmJihuPXZwKG4sbmV3IEtkKEtkLklOU0VSVCxudWxsLHApKSksdHAoZCkmJmQuY291bnQmJihyKz1kLmNvdW50KX1vLm1vdmVzJiYobj12cChuLG5ldyBLZChLZC5PUkRFUix0LG8ubW92ZXMpKSk7cmV0dXJuIG59KHQsZSxpLHIsbil9ZWxzZSByPXZwKHIsbmV3IEtkKEtkLlZOT0RFLHQsZSkpLHM9ITA7ZWxzZSByPXZwKHIsbmV3IEtkKEtkLlZOT0RFLHQsZSkpLHM9ITA7ZWxzZSBlcChlKT9lcCh0KT90LnRleHQhPT1lLnRleHQmJihyPXZwKHIsbmV3IEtkKEtkLlZURVhULHQsZSkpKToocj12cChyLG5ldyBLZChLZC5WVEVYVCx0LGUpKSxzPSEwKTppcChlKSYmKGlwKHQpfHwocz0hMCkscj12cChyLG5ldyBLZChLZC5XSURHRVQsdCxlKSkpO3ImJihpW25dPXIpLHMmJmRwKHQsaSxuKX19ZnVuY3Rpb24gZHAodCxlLGkpe21wKHQsZSxpKSxwcCh0LGUsaSl9ZnVuY3Rpb24gcHAodCxlLGkpe2lmKGlwKHQpKVwiZnVuY3Rpb25cIj09dHlwZW9mIHQuZGVzdHJveSYmKGVbaV09dnAoZVtpXSxuZXcgS2QoS2QuUkVNT1ZFLHQsbnVsbCkpKTtlbHNlIGlmKHRwKHQpJiYodC5oYXNXaWRnZXRzfHx0Lmhhc1RodW5rcykpZm9yKHZhciBuPXQuY2hpbGRyZW4scj1uLmxlbmd0aCxzPTA7czxyO3MrKyl7dmFyIG89bltzXTtwcChvLGUsaSs9MSksdHAobykmJm8uY291bnQmJihpKz1vLmNvdW50KX1lbHNlIG5wKHQpJiZmcCh0LG51bGwsZSxpKX1mdW5jdGlvbiBmcCh0LGUsaSxuKXt2YXIgcj1ycCh0LGUpLHM9bHAoci5hLHIuYik7KGZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KWlmKFwiYVwiIT09ZSlyZXR1cm4hMDtyZXR1cm4hMX0pKHMpJiYoaVtuXT1uZXcgS2QoS2QuVEhVTkssbnVsbCxzKSl9ZnVuY3Rpb24gbXAodCxlLGkpe2lmKHRwKHQpKXtpZih0Lmhvb2tzJiYoZVtpXT12cChlW2ldLG5ldyBLZChLZC5QUk9QUyx0LGZ1bmN0aW9uKHQpe3ZhciBlPXt9O2Zvcih2YXIgaSBpbiB0KWVbaV09dm9pZCAwO3JldHVybiBlfSh0Lmhvb2tzKSkpKSx0LmRlc2NlbmRhbnRIb29rc3x8dC5oYXNUaHVua3MpZm9yKHZhciBuPXQuY2hpbGRyZW4scj1uLmxlbmd0aCxzPTA7czxyO3MrKyl7dmFyIG89bltzXTttcChvLGUsaSs9MSksdHAobykmJm8uY291bnQmJihpKz1vLmNvdW50KX19ZWxzZSBucCh0KSYmZnAodCxudWxsLGUsaSl9ZnVuY3Rpb24gZ3AodCxlLGkpe3JldHVybiB0LnNwbGljZShlLDEpLHtmcm9tOmUsa2V5Oml9fWZ1bmN0aW9uIF9wKHQpe2Zvcih2YXIgZT17fSxpPVtdLG49dC5sZW5ndGgscj0wO3I8bjtyKyspe3ZhciBzPXRbcl07cy5rZXk/ZVtzLmtleV09cjppLnB1c2gocil9cmV0dXJue2tleXM6ZSxmcmVlOml9fWZ1bmN0aW9uIHZwKHQsZSl7cmV0dXJuIHQ/KFpkKHQpP3QucHVzaChlKTp0PVt0LGVdLHQpOmV9dmFyIHlwPWxwLGJwPVwidW5kZWZpbmVkXCIhPXR5cGVvZiBnbG9iYWxUaGlzP2dsb2JhbFRoaXM6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGY/c2VsZjp7fTtmdW5jdGlvbiB4cCh0KXtpZih0Ll9fZXNNb2R1bGUpcmV0dXJuIHQ7dmFyIGU9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3JldHVybiBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKChmdW5jdGlvbihpKXt2YXIgbj1PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsaSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsaSxuLmdldD9uOntlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiB0W2ldfX0pfSkpLGV9ZnVuY3Rpb24gd3AodCl7dmFyIGU9e2V4cG9ydHM6e319O3JldHVybiB0KGUsZS5leHBvcnRzKSxlLmV4cG9ydHN9dmFyIFNwPUFycmF5LnByb3RvdHlwZS5zbGljZSxNcD1mdW5jdGlvbih0LGUpe1wibGVuZ3RoXCJpbiB0fHwodD1bdF0pO3Q9U3AuY2FsbCh0KTtmb3IoO3QubGVuZ3RoOyl7dmFyIGk9dC5zaGlmdCgpLG49ZShpKTtpZihuKXJldHVybiBuO2kuY2hpbGROb2RlcyYmaS5jaGlsZE5vZGVzLmxlbmd0aCYmKHQ9U3AuY2FsbChpLmNoaWxkTm9kZXMpLmNvbmNhdCh0KSl9fTt2YXIgVHA9Q3A7ZnVuY3Rpb24gQ3AodCxlKXtpZighKHRoaXMgaW5zdGFuY2VvZiBDcCkpcmV0dXJuIG5ldyBDcCh0LGUpO3RoaXMuZGF0YT10LHRoaXMubm9kZVZhbHVlPXQsdGhpcy5sZW5ndGg9dC5sZW5ndGgsdGhpcy5vd25lckRvY3VtZW50PWV8fG51bGx9Q3AucHJvdG90eXBlLm5vZGVUeXBlPTgsQ3AucHJvdG90eXBlLm5vZGVOYW1lPVwiI2NvbW1lbnRcIixDcC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIltvYmplY3QgQ29tbWVudF1cIn07dmFyIEVwPUlwO2Z1bmN0aW9uIElwKHQsZSl7aWYoISh0aGlzIGluc3RhbmNlb2YgSXApKXJldHVybiBuZXcgSXAodCk7dGhpcy5kYXRhPXR8fFwiXCIsdGhpcy5sZW5ndGg9dGhpcy5kYXRhLmxlbmd0aCx0aGlzLm93bmVyRG9jdW1lbnQ9ZXx8bnVsbH1JcC5wcm90b3R5cGUudHlwZT1cIkRPTVRleHROb2RlXCIsSXAucHJvdG90eXBlLm5vZGVUeXBlPTMsSXAucHJvdG90eXBlLm5vZGVOYW1lPVwiI3RleHRcIixJcC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhfSxJcC5wcm90b3R5cGUucmVwbGFjZURhdGE9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuZGF0YSxyPW4uc3Vic3RyaW5nKDAsdCkscz1uLnN1YnN0cmluZyh0K2Usbi5sZW5ndGgpO3RoaXMuZGF0YT1yK2krcyx0aGlzLmxlbmd0aD10aGlzLmRhdGEubGVuZ3RofTt2YXIgQXA9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcyxpPXQudHlwZTt0LnRhcmdldHx8KHQudGFyZ2V0PWUpO2UubGlzdGVuZXJzfHwoZS5saXN0ZW5lcnM9e30pO3ZhciBuPWUubGlzdGVuZXJzW2ldO2lmKG4pcmV0dXJuIG4uZm9yRWFjaCgoZnVuY3Rpb24oaSl7dC5jdXJyZW50VGFyZ2V0PWUsXCJmdW5jdGlvblwiPT10eXBlb2YgaT9pKHQpOmkuaGFuZGxlRXZlbnQodCl9KSk7ZS5wYXJlbnROb2RlJiZlLnBhcmVudE5vZGUuZGlzcGF0Y2hFdmVudCh0KX07dmFyIFBwPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcztpLmxpc3RlbmVyc3x8KGkubGlzdGVuZXJzPXt9KTtpLmxpc3RlbmVyc1t0XXx8KGkubGlzdGVuZXJzW3RdPVtdKTstMT09PWkubGlzdGVuZXJzW3RdLmluZGV4T2YoZSkmJmkubGlzdGVuZXJzW3RdLnB1c2goZSl9O3ZhciBScD1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXM7aWYoIWkubGlzdGVuZXJzKXJldHVybjtpZighaS5saXN0ZW5lcnNbdF0pcmV0dXJuO3ZhciBuPWkubGlzdGVuZXJzW3RdLHI9bi5pbmRleE9mKGUpOy0xIT09ciYmbi5zcGxpY2UociwxKX07dmFyIExwPU5wLE9wPVtcImFyZWFcIixcImJhc2VcIixcImJyXCIsXCJjb2xcIixcImVtYmVkXCIsXCJoclwiLFwiaW1nXCIsXCJpbnB1dFwiLFwia2V5Z2VuXCIsXCJsaW5rXCIsXCJtZW51aXRlbVwiLFwibWV0YVwiLFwicGFyYW1cIixcInNvdXJjZVwiLFwidHJhY2tcIixcIndiclwiXTtmdW5jdGlvbiBOcCh0KXtzd2l0Y2godC5ub2RlVHlwZSl7Y2FzZSAzOnJldHVybiBrcCh0LmRhdGEpO2Nhc2UgODpyZXR1cm5cIlxceDNjIS0tXCIrdC5kYXRhK1wiLS1cXHgzZVwiO2RlZmF1bHQ6cmV0dXJuIGZ1bmN0aW9uKHQpe3ZhciBlPVtdLGk9dC50YWdOYW1lO1wiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiPT09dC5uYW1lc3BhY2VVUkkmJihpPWkudG9Mb3dlckNhc2UoKSk7ZS5wdXNoKFwiPFwiK2krZnVuY3Rpb24odCl7dmFyIGU9W107Zm9yKHZhciBpIGluIHQpRHAodCxpKSYmZS5wdXNoKHtuYW1lOmksdmFsdWU6dFtpXX0pO2Zvcih2YXIgbiBpbiB0Ll9hdHRyaWJ1dGVzKWZvcih2YXIgciBpbiB0Ll9hdHRyaWJ1dGVzW25dKXt2YXIgcz10Ll9hdHRyaWJ1dGVzW25dW3JdLG89KHMucHJlZml4P3MucHJlZml4K1wiOlwiOlwiXCIpK3I7ZS5wdXNoKHtuYW1lOm8sdmFsdWU6cy52YWx1ZX0pfXQuY2xhc3NOYW1lJiZlLnB1c2goe25hbWU6XCJjbGFzc1wiLHZhbHVlOnQuY2xhc3NOYW1lfSk7cmV0dXJuIGUubGVuZ3RoPyRwKGUpOlwiXCJ9KHQpK2Z1bmN0aW9uKHQpe3ZhciBlPXQuZGF0YXNldCxpPVtdO2Zvcih2YXIgbiBpbiBlKWkucHVzaCh7bmFtZTpcImRhdGEtXCIrbix2YWx1ZTplW25dfSk7cmV0dXJuIGkubGVuZ3RoPyRwKGkpOlwiXCJ9KHQpKSxPcC5pbmRleE9mKGkpPi0xP2UucHVzaChcIiAvPlwiKTooZS5wdXNoKFwiPlwiKSx0LmNoaWxkTm9kZXMubGVuZ3RoP2UucHVzaC5hcHBseShlLHQuY2hpbGROb2Rlcy5tYXAoTnApKTp0LnRleHRDb250ZW50fHx0LmlubmVyVGV4dD9lLnB1c2goa3AodC50ZXh0Q29udGVudHx8dC5pbm5lclRleHQpKTp0LmlubmVySFRNTCYmZS5wdXNoKHQuaW5uZXJIVE1MKSxlLnB1c2goXCI8L1wiK2krXCI+XCIpKTtyZXR1cm4gZS5qb2luKFwiXCIpfSh0KX19ZnVuY3Rpb24gRHAodCxlKXt2YXIgaT10eXBlb2YgdFtlXTtyZXR1cm5cInN0eWxlXCI9PT1lJiZPYmplY3Qua2V5cyh0LnN0eWxlKS5sZW5ndGg+MHx8dC5oYXNPd25Qcm9wZXJ0eShlKSYmKFwic3RyaW5nXCI9PT1pfHxcImJvb2xlYW5cIj09PWl8fFwibnVtYmVyXCI9PT1pKSYmXCJub2RlTmFtZVwiIT09ZSYmXCJjbGFzc05hbWVcIiE9PWUmJlwidGFnTmFtZVwiIT09ZSYmXCJ0ZXh0Q29udGVudFwiIT09ZSYmXCJpbm5lclRleHRcIiE9PWUmJlwibmFtZXNwYWNlVVJJXCIhPT1lJiZcImlubmVySFRNTFwiIT09ZX1mdW5jdGlvbiAkcCh0KXt2YXIgZT1bXTtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgaT10Lm5hbWUsbj10LnZhbHVlO1wic3R5bGVcIj09PWkmJihuPWZ1bmN0aW9uKHQpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0KXJldHVybiB0O3ZhciBlPVwiXCI7cmV0dXJuIE9iamVjdC5rZXlzKHQpLmZvckVhY2goKGZ1bmN0aW9uKGkpe3ZhciBuPXRbaV07aT1pLnJlcGxhY2UoL1tBLVpdL2csKGZ1bmN0aW9uKHQpe3JldHVyblwiLVwiK3QudG9Mb3dlckNhc2UoKX0pKSxlKz1pK1wiOlwiK24rXCI7XCJ9KSksZX0obikpLGUucHVzaChpKyc9XCInKyhrcChuKS5yZXBsYWNlKC9cIi9nLFwiJnF1b3Q7XCIpKydcIicpKX0pKSxlLmxlbmd0aD9cIiBcIitlLmpvaW4oXCIgXCIpOlwiXCJ9ZnVuY3Rpb24ga3AodCl7dmFyIGU9XCJcIjtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdD9lPXQ6dCYmKGU9dC50b1N0cmluZygpKSxlLnJlcGxhY2UoLyYvZyxcIiZhbXA7XCIpLnJlcGxhY2UoLzwvZyxcIiZsdDtcIikucmVwbGFjZSgvPi9nLFwiJmd0O1wiKX12YXIgenA9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIsRnA9QnA7ZnVuY3Rpb24gQnAodCxlLGkpe2lmKCEodGhpcyBpbnN0YW5jZW9mIEJwKSlyZXR1cm4gbmV3IEJwKHQpO3ZhciBuPXZvaWQgMD09PWk/enA6aXx8bnVsbDt0aGlzLnRhZ05hbWU9bj09PXpwP1N0cmluZyh0KS50b1VwcGVyQ2FzZSgpOnQsdGhpcy5ub2RlTmFtZT10aGlzLnRhZ05hbWUsdGhpcy5jbGFzc05hbWU9XCJcIix0aGlzLmRhdGFzZXQ9e30sdGhpcy5jaGlsZE5vZGVzPVtdLHRoaXMucGFyZW50Tm9kZT1udWxsLHRoaXMuc3R5bGU9e30sdGhpcy5vd25lckRvY3VtZW50PWV8fG51bGwsdGhpcy5uYW1lc3BhY2VVUkk9bix0aGlzLl9hdHRyaWJ1dGVzPXt9LFwiSU5QVVRcIj09PXRoaXMudGFnTmFtZSYmKHRoaXMudHlwZT1cInRleHRcIil9QnAucHJvdG90eXBlLnR5cGU9XCJET01FbGVtZW50XCIsQnAucHJvdG90eXBlLm5vZGVUeXBlPTEsQnAucHJvdG90eXBlLmFwcGVuZENoaWxkPWZ1bmN0aW9uKHQpe3JldHVybiB0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSx0aGlzLmNoaWxkTm9kZXMucHVzaCh0KSx0LnBhcmVudE5vZGU9dGhpcyx0fSxCcC5wcm90b3R5cGUucmVwbGFjZUNoaWxkPWZ1bmN0aW9uKHQsZSl7dC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCk7dmFyIGk9dGhpcy5jaGlsZE5vZGVzLmluZGV4T2YoZSk7cmV0dXJuIGUucGFyZW50Tm9kZT1udWxsLHRoaXMuY2hpbGROb2Rlc1tpXT10LHQucGFyZW50Tm9kZT10aGlzLGV9LEJwLnByb3RvdHlwZS5yZW1vdmVDaGlsZD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmNoaWxkTm9kZXMuaW5kZXhPZih0KTtyZXR1cm4gdGhpcy5jaGlsZE5vZGVzLnNwbGljZShlLDEpLHQucGFyZW50Tm9kZT1udWxsLHR9LEJwLnByb3RvdHlwZS5pbnNlcnRCZWZvcmU9ZnVuY3Rpb24odCxlKXt0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KTt2YXIgaT1udWxsPT1lPy0xOnRoaXMuY2hpbGROb2Rlcy5pbmRleE9mKGUpO3JldHVybiBpPi0xP3RoaXMuY2hpbGROb2Rlcy5zcGxpY2UoaSwwLHQpOnRoaXMuY2hpbGROb2Rlcy5wdXNoKHQpLHQucGFyZW50Tm9kZT10aGlzLHR9LEJwLnByb3RvdHlwZS5zZXRBdHRyaWJ1dGVOUz1mdW5jdGlvbih0LGUsaSl7dmFyIG49bnVsbCxyPWUscz1lLmluZGV4T2YoXCI6XCIpOyhzPi0xJiYobj1lLnN1YnN0cigwLHMpLHI9ZS5zdWJzdHIocysxKSksXCJJTlBVVFwiPT09dGhpcy50YWdOYW1lJiZcInR5cGVcIj09PWUpP3RoaXMudHlwZT1pOih0aGlzLl9hdHRyaWJ1dGVzW3RdfHwodGhpcy5fYXR0cmlidXRlc1t0XT17fSkpW3JdPXt2YWx1ZTppLHByZWZpeDpufX0sQnAucHJvdG90eXBlLmdldEF0dHJpYnV0ZU5TPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fYXR0cmlidXRlc1t0XSxuPWkmJmlbZV0mJmlbZV0udmFsdWU7cmV0dXJuXCJJTlBVVFwiPT09dGhpcy50YWdOYW1lJiZcInR5cGVcIj09PWU/dGhpcy50eXBlOlwic3RyaW5nXCIhPXR5cGVvZiBuP251bGw6bn0sQnAucHJvdG90eXBlLnJlbW92ZUF0dHJpYnV0ZU5TPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fYXR0cmlidXRlc1t0XTtpJiZkZWxldGUgaVtlXX0sQnAucHJvdG90eXBlLmhhc0F0dHJpYnV0ZU5TPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fYXR0cmlidXRlc1t0XTtyZXR1cm4hIWkmJmUgaW4gaX0sQnAucHJvdG90eXBlLnNldEF0dHJpYnV0ZT1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnNldEF0dHJpYnV0ZU5TKG51bGwsdCxlKX0sQnAucHJvdG90eXBlLmdldEF0dHJpYnV0ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGVOUyhudWxsLHQpfSxCcC5wcm90b3R5cGUucmVtb3ZlQXR0cmlidXRlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnJlbW92ZUF0dHJpYnV0ZU5TKG51bGwsdCl9LEJwLnByb3RvdHlwZS5oYXNBdHRyaWJ1dGU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuaGFzQXR0cmlidXRlTlMobnVsbCx0KX0sQnAucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXI9UnAsQnAucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI9UHAsQnAucHJvdG90eXBlLmRpc3BhdGNoRXZlbnQ9QXAsQnAucHJvdG90eXBlLmZvY3VzPWZ1bmN0aW9uKCl7fSxCcC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gTHAodGhpcyl9LEJwLnByb3RvdHlwZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPWZ1bmN0aW9uKHQpe3ZhciBlPXQuc3BsaXQoXCIgXCIpLGk9W107cmV0dXJuIE1wKHRoaXMsKGZ1bmN0aW9uKHQpe2lmKDE9PT10Lm5vZGVUeXBlKXt2YXIgbj0odC5jbGFzc05hbWV8fFwiXCIpLnNwbGl0KFwiIFwiKTtlLmV2ZXJ5KChmdW5jdGlvbih0KXtyZXR1cm4tMSE9PW4uaW5kZXhPZih0KX0pKSYmaS5wdXNoKHQpfX0pKSxpfSxCcC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeVRhZ05hbWU9ZnVuY3Rpb24odCl7dD10LnRvTG93ZXJDYXNlKCk7dmFyIGU9W107cmV0dXJuIE1wKHRoaXMuY2hpbGROb2RlcywoZnVuY3Rpb24oaSl7MSE9PWkubm9kZVR5cGV8fFwiKlwiIT09dCYmaS50YWdOYW1lLnRvTG93ZXJDYXNlKCkhPT10fHxlLnB1c2goaSl9KSksZX0sQnAucHJvdG90eXBlLmNvbnRhaW5zPWZ1bmN0aW9uKHQpe3JldHVybiBNcCh0aGlzLChmdW5jdGlvbihlKXtyZXR1cm4gdD09PWV9KSl8fCExfTt2YXIganA9SHA7ZnVuY3Rpb24gSHAodCl7aWYoISh0aGlzIGluc3RhbmNlb2YgSHApKXJldHVybiBuZXcgSHA7dGhpcy5jaGlsZE5vZGVzPVtdLHRoaXMucGFyZW50Tm9kZT1udWxsLHRoaXMub3duZXJEb2N1bWVudD10fHxudWxsfUhwLnByb3RvdHlwZS50eXBlPVwiRG9jdW1lbnRGcmFnbWVudFwiLEhwLnByb3RvdHlwZS5ub2RlVHlwZT0xMSxIcC5wcm90b3R5cGUubm9kZU5hbWU9XCIjZG9jdW1lbnQtZnJhZ21lbnRcIixIcC5wcm90b3R5cGUuYXBwZW5kQ2hpbGQ9RnAucHJvdG90eXBlLmFwcGVuZENoaWxkLEhwLnByb3RvdHlwZS5yZXBsYWNlQ2hpbGQ9RnAucHJvdG90eXBlLnJlcGxhY2VDaGlsZCxIcC5wcm90b3R5cGUucmVtb3ZlQ2hpbGQ9RnAucHJvdG90eXBlLnJlbW92ZUNoaWxkLEhwLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNoaWxkTm9kZXMubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gU3RyaW5nKHQpfSkpLmpvaW4oXCJcIil9O3ZhciBVcD1WcDtmdW5jdGlvbiBWcCh0KXt9VnAucHJvdG90eXBlLmluaXRFdmVudD1mdW5jdGlvbih0LGUsaSl7dGhpcy50eXBlPXQsdGhpcy5idWJibGVzPWUsdGhpcy5jYW5jZWxhYmxlPWl9LFZwLnByb3RvdHlwZS5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe307dmFyIEdwPXFwO2Z1bmN0aW9uIHFwKCl7aWYoISh0aGlzIGluc3RhbmNlb2YgcXApKXJldHVybiBuZXcgcXA7dGhpcy5oZWFkPXRoaXMuY3JlYXRlRWxlbWVudChcImhlYWRcIiksdGhpcy5ib2R5PXRoaXMuY3JlYXRlRWxlbWVudChcImJvZHlcIiksdGhpcy5kb2N1bWVudEVsZW1lbnQ9dGhpcy5jcmVhdGVFbGVtZW50KFwiaHRtbFwiKSx0aGlzLmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmhlYWQpLHRoaXMuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuYm9keSksdGhpcy5jaGlsZE5vZGVzPVt0aGlzLmRvY3VtZW50RWxlbWVudF0sdGhpcy5ub2RlVHlwZT05fXZhciBXcD1xcC5wcm90b3R5cGU7V3AuY3JlYXRlVGV4dE5vZGU9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBFcCh0LHRoaXMpfSxXcC5jcmVhdGVFbGVtZW50TlM9ZnVuY3Rpb24odCxlKXt2YXIgaT1udWxsPT09dD9udWxsOlN0cmluZyh0KTtyZXR1cm4gbmV3IEZwKGUsdGhpcyxpKX0sV3AuY3JlYXRlRWxlbWVudD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IEZwKHQsdGhpcyl9LFdwLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGpwKHRoaXMpfSxXcC5jcmVhdGVFdmVudD1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IFVwKHQpfSxXcC5jcmVhdGVDb21tZW50PWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgVHAodCx0aGlzKX0sV3AuZ2V0RWxlbWVudEJ5SWQ9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9U3RyaW5nKHQpLE1wKHRoaXMuY2hpbGROb2RlcywoZnVuY3Rpb24oZSl7aWYoU3RyaW5nKGUuaWQpPT09dClyZXR1cm4gZX0pKXx8bnVsbH0sV3AuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZT1GcC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSxXcC5nZXRFbGVtZW50c0J5VGFnTmFtZT1GcC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUsV3AuY29udGFpbnM9RnAucHJvdG90eXBlLmNvbnRhaW5zLFdwLnJlbW92ZUV2ZW50TGlzdGVuZXI9UnAsV3AuYWRkRXZlbnRMaXN0ZW5lcj1QcCxXcC5kaXNwYXRjaEV2ZW50PUFwO3ZhciBYcCxZcD1uZXcgR3AsWnA9dm9pZCAwIT09YnA/YnA6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6e307XCJ1bmRlZmluZWRcIiE9dHlwZW9mIGRvY3VtZW50P1hwPWRvY3VtZW50OihYcD1acFtcIl9fR0xPQkFMX0RPQ1VNRU5UX0NBQ0hFQDRcIl0pfHwoWHA9WnBbXCJfX0dMT0JBTF9ET0NVTUVOVF9DQUNIRUA0XCJdPVlwKTt2YXIgSnA9WHAsS3A9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgbiBpbiBlKXt2YXIgcj1lW25dO3ZvaWQgMD09PXI/UXAodCxuLHIsaSk6YXAocik/KFFwKHQsbixyLGkpLHIuaG9vayYmci5ob29rKHQsbixpP2lbbl06dm9pZCAwKSk6b3Aocik/dGYodCxlLGksbixyKTp0W25dPXJ9fTtmdW5jdGlvbiBRcCh0LGUsaSxuKXtpZihuKXt2YXIgcj1uW2VdO2lmKGFwKHIpKXIudW5ob29rJiZyLnVuaG9vayh0LGUsaSk7ZWxzZSBpZihcImF0dHJpYnV0ZXNcIj09PWUpZm9yKHZhciBzIGluIHIpdC5yZW1vdmVBdHRyaWJ1dGUocyk7ZWxzZSBpZihcInN0eWxlXCI9PT1lKWZvcih2YXIgbyBpbiByKXQuc3R5bGVbb109XCJcIjtlbHNlIHRbZV09XCJzdHJpbmdcIj09dHlwZW9mIHI/XCJcIjpudWxsfX1mdW5jdGlvbiB0Zih0LGUsaSxuLHIpe3ZhciBzPWk/aVtuXTp2b2lkIDA7aWYoXCJhdHRyaWJ1dGVzXCIhPT1uKWlmKHMmJm9wKHMpJiZlZihzKSE9PWVmKHIpKXRbbl09cjtlbHNle29wKHRbbl0pfHwodFtuXT17fSk7dmFyIG89XCJzdHlsZVwiPT09bj9cIlwiOnZvaWQgMDtmb3IodmFyIGEgaW4gcil7dmFyIGM9clthXTt0W25dW2FdPXZvaWQgMD09PWM/bzpjfX1lbHNlIGZvcih2YXIgaCBpbiByKXt2YXIgbD1yW2hdO3ZvaWQgMD09PWw/dC5yZW1vdmVBdHRyaWJ1dGUoaCk6dC5zZXRBdHRyaWJ1dGUoaCxsKX19ZnVuY3Rpb24gZWYodCl7cmV0dXJuIE9iamVjdC5nZXRQcm90b3R5cGVPZj9PYmplY3QuZ2V0UHJvdG90eXBlT2YodCk6dC5fX3Byb3RvX18/dC5fX3Byb3RvX186dC5jb25zdHJ1Y3Rvcj90LmNvbnN0cnVjdG9yLnByb3RvdHlwZTp2b2lkIDB9dmFyIG5mPWZ1bmN0aW9uIHQoZSxpKXt2YXIgbj1pJiZpLmRvY3VtZW50fHxKcCxyPWk/aS53YXJuOm51bGw7aWYoZT1ycChlKS5hLGlwKGUpKXJldHVybiBlLmluaXQoKTtpZihlcChlKSlyZXR1cm4gbi5jcmVhdGVUZXh0Tm9kZShlLnRleHQpO2lmKCF0cChlKSlyZXR1cm4gciYmcihcIkl0ZW0gaXMgbm90IGEgdmFsaWQgdmlydHVhbCBkb20gbm9kZVwiLGUpLG51bGw7dmFyIHM9bnVsbD09PWUubmFtZXNwYWNlP24uY3JlYXRlRWxlbWVudChlLnRhZ05hbWUpOm4uY3JlYXRlRWxlbWVudE5TKGUubmFtZXNwYWNlLGUudGFnTmFtZSksbz1lLnByb3BlcnRpZXM7S3AocyxvKTtmb3IodmFyIGE9ZS5jaGlsZHJlbixjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBoPXQoYVtjXSxpKTtoJiZzLmFwcGVuZENoaWxkKGgpfXJldHVybiBzfTt2YXIgcmY9e30sc2Y9ZnVuY3Rpb24odCxlLGksbil7cmV0dXJuIGkmJjAhPT1pLmxlbmd0aD8oaS5zb3J0KGNmKSxvZih0LGUsaSxuLDApKTp7fX07ZnVuY3Rpb24gb2YodCxlLGksbixyKXtpZihuPW58fHt9LHQpe2FmKGkscixyKSYmKG5bcl09dCk7dmFyIHM9ZS5jaGlsZHJlbjtpZihzKWZvcih2YXIgbz10LmNoaWxkTm9kZXMsYT0wO2E8ZS5jaGlsZHJlbi5sZW5ndGg7YSsrKXtyKz0xO3ZhciBjPXNbYV18fHJmLGg9cisoYy5jb3VudHx8MCk7YWYoaSxyLGgpJiZvZihvW2FdLGMsaSxuLHIpLHI9aH19cmV0dXJuIG59ZnVuY3Rpb24gYWYodCxlLGkpe2lmKDA9PT10Lmxlbmd0aClyZXR1cm4hMTtmb3IodmFyIG4scixzPTAsbz10Lmxlbmd0aC0xO3M8PW87KXtpZihyPXRbbj0obytzKS8yPj4wXSxzPT09bylyZXR1cm4gcj49ZSYmcjw9aTtpZihyPGUpcz1uKzE7ZWxzZXtpZighKHI+aSkpcmV0dXJuITA7bz1uLTF9fXJldHVybiExfWZ1bmN0aW9uIGNmKHQsZSl7cmV0dXJuIHQ+ZT8xOi0xfXZhciBoZj1mdW5jdGlvbih0LGUpe2lmKGlwKHQpJiZpcChlKSlyZXR1cm5cIm5hbWVcImluIHQmJlwibmFtZVwiaW4gZT90LmlkPT09ZS5pZDp0LmluaXQ9PT1lLmluaXQ7cmV0dXJuITF9O3ZhciBsZj1mdW5jdGlvbih0LGUsaSl7dmFyIG49dC50eXBlLHI9dC52Tm9kZSxzPXQucGF0Y2g7c3dpdGNoKG4pe2Nhc2UgS2QuUkVNT1ZFOnJldHVybiBmdW5jdGlvbih0LGUpe3ZhciBpPXQucGFyZW50Tm9kZTtpJiZpLnJlbW92ZUNoaWxkKHQpO3JldHVybiB1Zih0LGUpLG51bGx9KGUscik7Y2FzZSBLZC5JTlNFUlQ6cmV0dXJuIGZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1pLnJlbmRlcihlLGkpO3QmJnQuYXBwZW5kQ2hpbGQobik7cmV0dXJuIHR9KGUscyxpKTtjYXNlIEtkLlZURVhUOnJldHVybiBmdW5jdGlvbih0LGUsaSxuKXt2YXIgcjtpZigzPT09dC5ub2RlVHlwZSl0LnJlcGxhY2VEYXRhKDAsdC5sZW5ndGgsaS50ZXh0KSxyPXQ7ZWxzZXt2YXIgcz10LnBhcmVudE5vZGU7cj1uLnJlbmRlcihpLG4pLHMmJnIhPT10JiZzLnJlcGxhY2VDaGlsZChyLHQpfXJldHVybiByfShlLDAscyxpKTtjYXNlIEtkLldJREdFVDpyZXR1cm4gZnVuY3Rpb24odCxlLGksbil7dmFyIHIscz1oZihlLGkpO3I9cz9pLnVwZGF0ZShlLHQpfHx0Om4ucmVuZGVyKGksbik7dmFyIG89dC5wYXJlbnROb2RlO28mJnIhPT10JiZvLnJlcGxhY2VDaGlsZChyLHQpO3N8fHVmKHQsZSk7cmV0dXJuIHJ9KGUscixzLGkpO2Nhc2UgS2QuVk5PREU6cmV0dXJuIGZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXQucGFyZW50Tm9kZSxzPW4ucmVuZGVyKGksbik7ciYmcyE9PXQmJnIucmVwbGFjZUNoaWxkKHMsdCk7cmV0dXJuIHN9KGUsMCxzLGkpO2Nhc2UgS2QuT1JERVI6cmV0dXJuIGZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpLG4scixzPXQuY2hpbGROb2RlcyxvPXt9LGE9MDthPGUucmVtb3Zlcy5sZW5ndGg7YSsrKWk9c1sobj1lLnJlbW92ZXNbYV0pLmZyb21dLG4ua2V5JiYob1tuLmtleV09aSksdC5yZW1vdmVDaGlsZChpKTtmb3IodmFyIGM9cy5sZW5ndGgsaD0wO2g8ZS5pbnNlcnRzLmxlbmd0aDtoKyspaT1vWyhyPWUuaW5zZXJ0c1toXSkua2V5XSx0Lmluc2VydEJlZm9yZShpLHIudG8+PWMrKz9udWxsOnNbci50b10pfShlLHMpLGU7Y2FzZSBLZC5QUk9QUzpyZXR1cm4gS3AoZSxzLHIucHJvcGVydGllcyksZTtjYXNlIEtkLlRIVU5LOnJldHVybiBmdW5jdGlvbih0LGUpe3QmJmUmJnQhPT1lJiZ0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZSx0KTtyZXR1cm4gZX0oZSxpLnBhdGNoKGUscyxpKSk7ZGVmYXVsdDpyZXR1cm4gZX19O2Z1bmN0aW9uIHVmKHQsZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgZS5kZXN0cm95JiZpcChlKSYmZS5kZXN0cm95KHQpfWZ1bmN0aW9uIGRmKHQsZSxpKXt2YXIgbj1mdW5jdGlvbih0KXt2YXIgZT1bXTtmb3IodmFyIGkgaW4gdClcImFcIiE9PWkmJmUucHVzaChOdW1iZXIoaSkpO3JldHVybiBlfShlKTtpZigwPT09bi5sZW5ndGgpcmV0dXJuIHQ7dmFyIHI9c2YodCxlLmEsbikscz10Lm93bmVyRG9jdW1lbnQ7aS5kb2N1bWVudHx8cz09PUpwfHwoaS5kb2N1bWVudD1zKTtmb3IodmFyIG89MDtvPG4ubGVuZ3RoO28rKyl7dmFyIGE9bltvXTt0PXBmKHQsclthXSxlW2FdLGkpfXJldHVybiB0fWZ1bmN0aW9uIHBmKHQsZSxpLG4pe2lmKCFlKXJldHVybiB0O3ZhciByO2lmKFpkKGkpKWZvcih2YXIgcz0wO3M8aS5sZW5ndGg7cysrKXI9bGYoaVtzXSxlLG4pLGU9PT10JiYodD1yKTtlbHNlIHI9bGYoaSxlLG4pLGU9PT10JiYodD1yKTtyZXR1cm4gdH12YXIgZmY9ZnVuY3Rpb24gdChlLGksbil7cmV0dXJuKG49bnx8e30pLnBhdGNoPW4ucGF0Y2gmJm4ucGF0Y2ghPT10P24ucGF0Y2g6ZGYsbi5yZW5kZXI9bi5yZW5kZXJ8fG5mLG4ucGF0Y2goZSxpLG4pfSxtZj12ZixnZj17fSxfZj1bXTtmdW5jdGlvbiB2Zih0LGUsaSxuLHIpe3RoaXMudGFnTmFtZT10LHRoaXMucHJvcGVydGllcz1lfHxnZix0aGlzLmNoaWxkcmVuPWl8fF9mLHRoaXMua2V5PW51bGwhPW4/U3RyaW5nKG4pOnZvaWQgMCx0aGlzLm5hbWVzcGFjZT1cInN0cmluZ1wiPT10eXBlb2Ygcj9yOm51bGw7dmFyIHMsbz1pJiZpLmxlbmd0aHx8MCxhPTAsYz0hMSxoPSExLGw9ITE7Zm9yKHZhciB1IGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eSh1KSl7dmFyIGQ9ZVt1XTthcChkKSYmZC51bmhvb2smJihzfHwocz17fSksc1t1XT1kKX1mb3IodmFyIHA9MDtwPG87cCsrKXt2YXIgZj1pW3BdO3RwKGYpPyhhKz1mLmNvdW50fHwwLCFjJiZmLmhhc1dpZGdldHMmJihjPSEwKSwhaCYmZi5oYXNUaHVua3MmJihoPSEwKSxsfHwhZi5ob29rcyYmIWYuZGVzY2VuZGFudEhvb2tzfHwobD0hMCkpOiFjJiZpcChmKT9cImZ1bmN0aW9uXCI9PXR5cGVvZiBmLmRlc3Ryb3kmJihjPSEwKTohaCYmbnAoZikmJihoPSEwKX10aGlzLmNvdW50PW8rYSx0aGlzLmhhc1dpZGdldHM9Yyx0aGlzLmhhc1RodW5rcz1oLHRoaXMuaG9va3M9cyx0aGlzLmRlc2NlbmRhbnRIb29rcz1sfXZmLnByb3RvdHlwZS52ZXJzaW9uPUpkLHZmLnByb3RvdHlwZS50eXBlPVwiVmlydHVhbE5vZGVcIjt2YXIgeWY9YmY7ZnVuY3Rpb24gYmYodCl7dGhpcy50ZXh0PVN0cmluZyh0KX1iZi5wcm90b3R5cGUudmVyc2lvbj1KZCxiZi5wcm90b3R5cGUudHlwZT1cIlZpcnR1YWxUZXh0XCI7XG4vKiFcbiAgICAgKiBDcm9zcy1Ccm93c2VyIFNwbGl0IDEuMS4xXG4gICAgICogQ29weXJpZ2h0IDIwMDctMjAxMiBTdGV2ZW4gTGV2aXRoYW4gPHN0ZXZlbmxldml0aGFuLmNvbT5cbiAgICAgKiBBdmFpbGFibGUgdW5kZXIgdGhlIE1JVCBMaWNlbnNlXG4gICAgICogRUNNQVNjcmlwdCBjb21wbGlhbnQsIHVuaWZvcm0gY3Jvc3MtYnJvd3NlciBzcGxpdCBtZXRob2RcbiAgICAgKi9cbnZhciB4Zix3ZixTZixNZj0od2Y9U3RyaW5nLnByb3RvdHlwZS5zcGxpdCxTZj0vKCk/Py8uZXhlYyhcIlwiKVsxXT09PXhmLGZ1bmN0aW9uKHQsZSxpKXtpZihcIltvYmplY3QgUmVnRXhwXVwiIT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpKXJldHVybiB3Zi5jYWxsKHQsZSxpKTt2YXIgbixyLHMsbyxhPVtdLGM9KGUuaWdub3JlQ2FzZT9cImlcIjpcIlwiKSsoZS5tdWx0aWxpbmU/XCJtXCI6XCJcIikrKGUuZXh0ZW5kZWQ/XCJ4XCI6XCJcIikrKGUuc3RpY2t5P1wieVwiOlwiXCIpLGg9MDtmb3IoZT1uZXcgUmVnRXhwKGUuc291cmNlLGMrXCJnXCIpLHQrPVwiXCIsU2Z8fChuPW5ldyBSZWdFeHAoXCJeXCIrZS5zb3VyY2UrXCIkKD8hXFxcXHMpXCIsYykpLGk9aT09PXhmPy0xPj4+MDppPj4+MDsocj1lLmV4ZWModCkpJiYhKChzPXIuaW5kZXgrclswXS5sZW5ndGgpPmgmJihhLnB1c2godC5zbGljZShoLHIuaW5kZXgpKSwhU2YmJnIubGVuZ3RoPjEmJnJbMF0ucmVwbGFjZShuLChmdW5jdGlvbigpe2Zvcih2YXIgdD0xO3Q8YXJndW1lbnRzLmxlbmd0aC0yO3QrKylhcmd1bWVudHNbdF09PT14ZiYmKHJbdF09eGYpfSkpLHIubGVuZ3RoPjEmJnIuaW5kZXg8dC5sZW5ndGgmJkFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGEsci5zbGljZSgxKSksbz1yWzBdLmxlbmd0aCxoPXMsYS5sZW5ndGg+PWkpKTspZS5sYXN0SW5kZXg9PT1yLmluZGV4JiZlLmxhc3RJbmRleCsrO3JldHVybiBoPT09dC5sZW5ndGg/IW8mJmUudGVzdChcIlwiKXx8YS5wdXNoKFwiXCIpOmEucHVzaCh0LnNsaWNlKGgpKSxhLmxlbmd0aD5pP2Euc2xpY2UoMCxpKTphfSksVGY9LyhbXFwuI10/W2EtekEtWjAtOVxcdTAwN0YtXFx1RkZGRl86LV0rKS8sQ2Y9L15cXC58Iy8sRWY9ZnVuY3Rpb24odCxlKXtpZighdClyZXR1cm5cIkRJVlwiO3ZhciBpLG4scixzLG89IWUuaGFzT3duUHJvcGVydHkoXCJpZFwiKSxhPU1mKHQsVGYpLGM9bnVsbDtDZi50ZXN0KGFbMV0pJiYoYz1cIkRJVlwiKTtmb3Iocz0wO3M8YS5sZW5ndGg7cysrKShuPWFbc10pJiYocj1uLmNoYXJBdCgwKSxjP1wiLlwiPT09cj8oaT1pfHxbXSkucHVzaChuLnN1YnN0cmluZygxLG4ubGVuZ3RoKSk6XCIjXCI9PT1yJiZvJiYoZS5pZD1uLnN1YnN0cmluZygxLG4ubGVuZ3RoKSk6Yz1uKTtpJiYoZS5jbGFzc05hbWUmJmkucHVzaChlLmNsYXNzTmFtZSksZS5jbGFzc05hbWU9aS5qb2luKFwiIFwiKSk7cmV0dXJuIGUubmFtZXNwYWNlP2M6Yy50b1VwcGVyQ2FzZSgpfTt2YXIgSWY9QWY7ZnVuY3Rpb24gQWYodCl7aWYoISh0aGlzIGluc3RhbmNlb2YgQWYpKXJldHVybiBuZXcgQWYodCk7dGhpcy52YWx1ZT10fUFmLnByb3RvdHlwZS5ob29rPWZ1bmN0aW9uKHQsZSl7dFtlXSE9PXRoaXMudmFsdWUmJih0W2VdPXRoaXMudmFsdWUpfTt2YXIgUGY9XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dm9pZCAwIT09YnA/YnA6e30sUmY9ZnVuY3Rpb24odCxlKXtpZih0IGluIFBmKXJldHVybiBQZlt0XTtyZXR1cm4gUGZbdF09ZSxlfTsoZnVuY3Rpb24odCxlLGkpe3ZhciBuPVwiX19JTkRJVklEVUFMX09ORV9WRVJTSU9OX1wiK3Qscj1SZihuK1wiX0VORk9SQ0VfU0lOR0xFVE9OXCIsZSk7aWYociE9PWUpdGhyb3cgbmV3IEVycm9yKFwiQ2FuIG9ubHkgaGF2ZSBvbmUgY29weSBvZiBcIit0K1wiLlxcbllvdSBhbHJlYWR5IGhhdmUgdmVyc2lvbiBcIityK1wiIGluc3RhbGxlZC5cXG5UaGlzIG1lYW5zIHlvdSBjYW5ub3QgaW5zdGFsbCB2ZXJzaW9uIFwiK2UpO1JmKG4saSl9KShcImV2LXN0b3JlXCIsXCI3XCIpO3ZhciBMZj1cIl9fRVZfU1RPUkVfS0VZQDdcIixPZj1mdW5jdGlvbih0KXt2YXIgZT10W0xmXTtlfHwoZT10W0xmXT17fSk7cmV0dXJuIGV9O3ZhciBOZj1EZjtmdW5jdGlvbiBEZih0KXtpZighKHRoaXMgaW5zdGFuY2VvZiBEZikpcmV0dXJuIG5ldyBEZih0KTt0aGlzLnZhbHVlPXR9ZnVuY3Rpb24gJGYodCxlLGksbil7aWYoXCJzdHJpbmdcIj09dHlwZW9mIHQpZS5wdXNoKG5ldyB5Zih0KSk7ZWxzZSBpZihcIm51bWJlclwiPT10eXBlb2YgdCllLnB1c2gobmV3IHlmKFN0cmluZyh0KSkpO2Vsc2UgaWYoa2YodCkpZS5wdXNoKHQpO2Vsc2V7aWYoIVpkKHQpKXtpZihudWxsPT10KXJldHVybjt0aHJvdyBmdW5jdGlvbih0KXt2YXIgZT1uZXcgRXJyb3I7cmV0dXJuIGUudHlwZT1cInZpcnR1YWwtaHlwZXJzY3JpcHQudW5leHBlY3RlZC52aXJ0dWFsLWVsZW1lbnRcIixlLm1lc3NhZ2U9XCJVbmV4cGVjdGVkIHZpcnR1YWwgY2hpbGQgcGFzc2VkIHRvIGgoKS5cXG5FeHBlY3RlZCBhIFZOb2RlIC8gVnRodW5rIC8gVldpZGdldCAvIHN0cmluZyBidXQ6XFxuZ290OlxcblwiK3pmKHQuZm9yZWlnbk9iamVjdCkrXCIuXFxuVGhlIHBhcmVudCB2bm9kZSBpczpcXG5cIit6Zih0LnBhcmVudFZub2RlKSxlLmZvcmVpZ25PYmplY3Q9dC5mb3JlaWduT2JqZWN0LGUucGFyZW50Vm5vZGU9dC5wYXJlbnRWbm9kZSxlfSh7Zm9yZWlnbk9iamVjdDp0LHBhcmVudFZub2RlOnt0YWdOYW1lOmkscHJvcGVydGllczpufX0pfWZvcih2YXIgcj0wO3I8dC5sZW5ndGg7cisrKSRmKHRbcl0sZSxpLG4pfX1mdW5jdGlvbiBrZih0KXtyZXR1cm4gdHAodCl8fGVwKHQpfHxpcCh0KXx8bnAodCl9ZnVuY3Rpb24gemYodCl7dHJ5e3JldHVybiBKU09OLnN0cmluZ2lmeSh0LG51bGwsXCIgICAgXCIpfWNhdGNoKGUpe3JldHVybiBTdHJpbmcodCl9fURmLnByb3RvdHlwZS5ob29rPWZ1bmN0aW9uKHQsZSl7T2YodClbZS5zdWJzdHIoMyldPXRoaXMudmFsdWV9LERmLnByb3RvdHlwZS51bmhvb2s9ZnVuY3Rpb24odCxlKXtPZih0KVtlLnN1YnN0cigzKV09dm9pZCAwfTt2YXIgRmYsQmYsamY9e2RpZmY6eXAscGF0Y2g6ZmYsaDpmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzLG8sYT1bXTshaSYmKGM9ZSxcInN0cmluZ1wiPT10eXBlb2YgY3x8WmQoYyl8fGtmKGMpKSYmKGk9ZSxyPXt9KTt2YXIgYztuPUVmKHQscj1yfHxlfHx7fSksci5oYXNPd25Qcm9wZXJ0eShcImtleVwiKSYmKHM9ci5rZXksci5rZXk9dm9pZCAwKTtyLmhhc093blByb3BlcnR5KFwibmFtZXNwYWNlXCIpJiYobz1yLm5hbWVzcGFjZSxyLm5hbWVzcGFjZT12b2lkIDApO1wiSU5QVVRcIiE9PW58fG98fCFyLmhhc093blByb3BlcnR5KFwidmFsdWVcIil8fHZvaWQgMD09PXIudmFsdWV8fGFwKHIudmFsdWUpfHwoci52YWx1ZT1JZihyLnZhbHVlKSk7KGZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkoZSkpe3ZhciBpPXRbZV07aWYoYXAoaSkpY29udGludWU7XCJldi1cIj09PWUuc3Vic3RyKDAsMykmJih0W2VdPU5mKGkpKX19KShyKSxudWxsIT1pJiYkZihpLGEsbixyKTtyZXR1cm4gbmV3IG1mKG4scixhLHMsbyl9LGNyZWF0ZTpuZixWTm9kZTptZixWVGV4dDp5Zn07Y2xhc3MgSGZ7Y29uc3RydWN0b3IoKXt0aGlzLl9ldmVudHM9e319b24odCxlKXt0aGlzLl9ldmVudHNbdF09dGhpcy5fZXZlbnRzW3RdfHxbXSx0aGlzLl9ldmVudHNbdF0ucHVzaChlKX1vZmYodCxlKXtpZih0KXtpZih0aGlzLl9saXN0ZW5zKHQpKXtjb25zdCBpPXRoaXMuX2V2ZW50c1t0XS5pbmRleE9mKGUpO2k+PTAmJnRoaXMuX2V2ZW50c1t0XS5zcGxpY2UoaSwxKSx0aGlzLl9ldmVudHNbdF0ubGVuZ3RofHxkZWxldGUgdGhpcy5fZXZlbnRzW3RdfX1lbHNlIHRoaXMuX2V2ZW50cz17fX1maXJlKHQsZSl7aWYodGhpcy5fbGlzdGVucyh0KSlmb3IoY29uc3QgaSBvZiB0aGlzLl9ldmVudHNbdF0paShlKX1fbGlzdGVucyh0KXtyZXR1cm4gdCBpbiB0aGlzLl9ldmVudHN9fWNsYXNzIFVme2NvbnN0cnVjdG9yKCl7dGhpcy5fc3Vic2NyaXB0aW9ucz1bXX1wdXNoKHQpe3RoaXMuX3N1YnNjcmlwdGlvbnMucHVzaCh0KX11bnN1YnNjcmliZSgpe2Zvcihjb25zdCB0IG9mIHRoaXMuX3N1YnNjcmlwdGlvbnMpdC51bnN1YnNjcmliZSgpO3RoaXMuX3N1YnNjcmlwdGlvbnM9W119fWNsYXNzIFZmIGV4dGVuZHMgSGZ7Y29uc3RydWN0b3IodCxlLGkpe3N1cGVyKCksdGhpcy5fYWN0aXZhdGVkJD1uZXcgTyghMSksdGhpcy5fY29uZmlndXJhdGlvblN1YmplY3QkPW5ldyBULHRoaXMuX2FjdGl2YXRlZD0hMSx0aGlzLl9jb250YWluZXI9ZSx0aGlzLl9uYW1lPXQsdGhpcy5fbmF2aWdhdG9yPWksdGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fY29uZmlndXJhdGlvbiQ9dGhpcy5fY29uZmlndXJhdGlvblN1YmplY3QkLnBpcGUobmkodGhpcy5kZWZhdWx0Q29uZmlndXJhdGlvbiksTGUoKCh0LGUpPT57Zm9yKGxldCBpIGluIGUpZS5oYXNPd25Qcm9wZXJ0eShpKSYmKHRbaV09ZVtpXSk7cmV0dXJuIHR9KSksVWUoMSksRSgpKSx0aGlzLl9jb25maWd1cmF0aW9uJC5zdWJzY3JpYmUoKCgpPT57fSkpfWdldCBhY3RpdmF0ZWQoKXtyZXR1cm4gdGhpcy5fYWN0aXZhdGVkfWdldCBhY3RpdmF0ZWQkKCl7cmV0dXJuIHRoaXMuX2FjdGl2YXRlZCR9Z2V0IGRlZmF1bHRDb25maWd1cmF0aW9uKCl7cmV0dXJuIHRoaXMuX2dldERlZmF1bHRDb25maWd1cmF0aW9uKCl9Z2V0IGNvbmZpZ3VyYXRpb24kKCl7cmV0dXJuIHRoaXMuX2NvbmZpZ3VyYXRpb24kfWdldCBuYW1lKCl7cmV0dXJuIHRoaXMuX25hbWV9YWN0aXZhdGUodCl7dGhpcy5fYWN0aXZhdGVkfHwodm9pZCAwIT09dCYmdGhpcy5fY29uZmlndXJhdGlvblN1YmplY3QkLm5leHQodCksdGhpcy5fYWN0aXZhdGVkPSEwLHRoaXMuX2FjdGl2YXRlKCksdGhpcy5fYWN0aXZhdGVkJC5uZXh0KCEwKSl9Y29uZmlndXJlKHQpe3RoaXMuX2NvbmZpZ3VyYXRpb25TdWJqZWN0JC5uZXh0KHQpfWRlYWN0aXZhdGUoKXt0aGlzLl9hY3RpdmF0ZWQmJih0aGlzLl9hY3RpdmF0ZWQ9ITEsdGhpcy5fZGVhY3RpdmF0ZSgpLHRoaXMuX2NvbnRhaW5lci5kb21SZW5kZXJlci5jbGVhcih0aGlzLl9uYW1lKSx0aGlzLl9jb250YWluZXIuZ2xSZW5kZXJlci5jbGVhcih0aGlzLl9uYW1lKSx0aGlzLl9hY3RpdmF0ZWQkLm5leHQoITEpKX1maXJlKHQsZSl7c3VwZXIuZmlyZSh0LGUpfW9mZih0LGUpe3N1cGVyLm9mZih0LGUpfW9uKHQsZSl7c3VwZXIub24odCxlKX1yZXNpemUoKXt9fSFmdW5jdGlvbih0KXt0W3QuSGlkZGVuPTBdPVwiSGlkZGVuXCIsdFt0LkxvYWRpbmc9MV09XCJMb2FkaW5nXCIsdFt0LlZpc2libGU9Ml09XCJWaXNpYmxlXCJ9KEZmfHwoRmY9e30pKTtjbGFzcyBHZiBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUsaSl9X2FjdGl2YXRlKCl7Y29uc3QgdD10aGlzLmNvbmZpZ3VyYXRpb24kLnBpcGUoRWUoKHQ9PiEhdC5pZCkpLE50KCh0PT4hdC5zcmMpKSxyaSgodD0+dGhpcy5fZ2V0SW1hZ2VTcmMkKHQuaWQpLnBpcGUodGUoKHQ9Pihjb25zb2xlLmVycm9yKHQpLEIoKSkpKSkpKSxVZSgxKSxFKCkpLGU9dGhpcy5fc3Vic2NyaXB0aW9ucztlLnB1c2godC5waXBlKHJ0KCh0PT4oe3NyYzp0fSkpKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fY29uZmlndXJhdGlvblN1YmplY3QkLm5leHQodCl9KSkpLGUucHVzaChndCh0aGlzLmNvbmZpZ3VyYXRpb24kLHQpLnBpcGUoTnQoKChbdCxlXSk9PiEhdC5zcmMmJnQuc3JjIT09ZSkpLEVlKCkpLnN1YnNjcmliZSgoKFssdF0pPT57d2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodCl9KSkpLGUucHVzaCh0aGlzLl9jb25maWd1cmF0aW9uJC5waXBlKHVlKHZvaWQgMCwodD0+dC5zdGF0ZSkpLHJpKCh0PT5ndChHKHQuc3RhdGUpLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJCkpKSxyaSgoKFt0LGVdKT0+e2NvbnN0IGk9Z3QoRyhlLmlkKSxlLmltYWdlJC5waXBlKE50KCh0PT4hIXQpKSxydCgodD0+dC5zcmMpKSkpO3JldHVybiB0PT09RmYuVmlzaWJsZT9pLnBpcGUoRWUoKSk6aX0pKSx1ZSgoKFt0LGVdLFtpLG5dKT0+dD09PWkmJmU9PT1uKSkscnQoKChbdCxlXSk9Pih7aWQ6dCxzcmM6ZX0pKSkpLnN1YnNjcmliZSh0aGlzLl9jb25maWd1cmF0aW9uU3ViamVjdCQpKSxlLnB1c2goZ3QodGhpcy5fY29uZmlndXJhdGlvbiQsdGhpcy5fY29udGFpbmVyLmNvbmZpZ3VyYXRpb25TZXJ2aWNlLmV4cGxvcmVVcmwkLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnNpemUkKS5waXBlKHJ0KCgoW3QsZSxpXSk9PntpZighdC5zcmMpcmV0dXJue25hbWU6dGhpcy5fbmFtZSx2Tm9kZTpqZi5oKFwiZGl2XCIsW10pfTtjb25zdCBuPWkud2lkdGg8PTY0MHx8aS5oZWlnaHQ8PTQ4MD9cIi5tYXBpbGxhcnktY292ZXItY29tcGFjdFwiOlwiXCI7aWYodC5zdGF0ZT09PUZmLkhpZGRlbil7Y29uc3QgZT1qZi5oKFwiZGl2Lm1hcGlsbGFyeS1jb3Zlci1jb250YWluZXIubWFwaWxsYXJ5LWNvdmVyLWRvbmVcIituLFt0aGlzLl9nZXRDb3ZlckJhY2tncm91bmRWTm9kZSh0KV0pO3JldHVybntuYW1lOnRoaXMuX25hbWUsdk5vZGU6ZX19Y29uc3Qgcj1qZi5oKFwiZGl2Lm1hcGlsbGFyeS1jb3Zlci1jb250YWluZXJcIituLFt0aGlzLl9nZXRDb3ZlckJ1dHRvblZOb2RlKHQsZSldKTtyZXR1cm57bmFtZTp0aGlzLl9uYW1lLHZOb2RlOnJ9fSkpKS5zdWJzY3JpYmUodGhpcy5fY29udGFpbmVyLmRvbVJlbmRlcmVyLnJlbmRlciQpKX1fZGVhY3RpdmF0ZSgpe3RoaXMuX3N1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKX1fZ2V0RGVmYXVsdENvbmZpZ3VyYXRpb24oKXtyZXR1cm57c3RhdGU6RmYuVmlzaWJsZX19X2dldENvdmVyQnV0dG9uVk5vZGUodCxlKXtjb25zdCBpPXQuc3RhdGU9PT1GZi5Mb2FkaW5nP1wiZGl2Lm1hcGlsbGFyeS1jb3Zlci5tYXBpbGxhcnktY292ZXItbG9hZGluZ1wiOlwiZGl2Lm1hcGlsbGFyeS1jb3ZlclwiLG49amYuaChcImRpdi5tYXBpbGxhcnktY292ZXItYnV0dG9uXCIsW2pmLmgoXCJkaXYubWFwaWxsYXJ5LWNvdmVyLWJ1dHRvbi1pY29uXCIsW10pXSkscj1qZi5oKFwiYS5tYXBpbGxhcnktY292ZXItbG9nb1wiLHtocmVmOmUsdGFyZ2V0OlwiX2JsYW5rXCJ9LFtdKSxzPWpmLmgoXCJkaXYubWFwaWxsYXJ5LWNvdmVyLWluZGljYXRvclwiLHtvbmNsaWNrOigpPT57dGhpcy5jb25maWd1cmUoe3N0YXRlOkZmLkxvYWRpbmd9KX19LFtdKTtyZXR1cm4gamYuaChpLFt0aGlzLl9nZXRDb3ZlckJhY2tncm91bmRWTm9kZSh0KSxzLG4scl0pfV9nZXRDb3ZlckJhY2tncm91bmRWTm9kZSh0KXtjb25zdCBlPXtzdHlsZTp7YmFja2dyb3VuZEltYWdlOmB1cmwoJHt0LnNyY30pYH19LGk9W107cmV0dXJuIHQuc3RhdGU9PT1GZi5Mb2FkaW5nJiZpLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktY292ZXItc3Bpbm5lclwiLHt9LFtdKSksamYuaChcImRpdi5tYXBpbGxhcnktY292ZXItYmFja2dyb3VuZFwiLGUsaSl9X2dldEltYWdlU3JjJCh0KXtyZXR1cm4gYi5jcmVhdGUoKGU9Pnt0aGlzLl9uYXZpZ2F0b3IuYXBpLmdldEltYWdlcyQoW3RdKS5zdWJzY3JpYmUoKGk9Pntmb3IoY29uc3QgbiBvZiBpKWlmKG4ubm9kZV9pZD09PXQpcmV0dXJuIHZvaWQgdGhpcy5fbmF2aWdhdG9yLmFwaS5kYXRhLmdldEltYWdlQnVmZmVyKG4ubm9kZS50aHVtYi51cmwpLnRoZW4oKGk9Pntjb25zdCBuPW5ldyBJbWFnZTtuLmNyb3NzT3JpZ2luPVwiQW5vbnltb3VzXCIsbi5vbmxvYWQ9KCk9PntlLm5leHQobi5zcmMpLGUuY29tcGxldGUoKX0sbi5vbmVycm9yPSgpPT57ZS5lcnJvcihuZXcgRXJyb3IoYEZhaWxlZCB0byBsb2FkIGNvdmVyIGltYWdlICgke3R9KWApKX07Y29uc3Qgcj1uZXcgQmxvYihbaV0pO24uc3JjPXdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHIpfSksKHQ9PntlLmVycm9yKHQpfSkpO2UuZXJyb3IobmV3IGNkKGBOb24gZXhpc3RlbnQgY292ZXIga2V5OiAke3R9YCkpfSksKHQ9PntlLmVycm9yKHQpfSkpfSkpfX1HZi5jb21wb25lbnROYW1lPVwiY292ZXJcIjtjbGFzcyBxZiBleHRlbmRzIFZme19hY3RpdmF0ZSgpe3RoaXMuX3N1YnNjcmlwdGlvbnMucHVzaChndCh0aGlzLl9jb250YWluZXIuY29uZmlndXJhdGlvblNlcnZpY2UuZXhwbG9yZVVybCQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnNpemUkKS5waXBlKHJ0KCgoW3QsZSxpXSk9Pntjb25zdCBuPXRoaXMuX21ha2VBdHRyaWJ1dGlvbihlLmNyZWF0b3JVc2VybmFtZSx0LGUuaWQsZS5jYXB0dXJlZEF0LGkud2lkdGgpO3JldHVybntuYW1lOnRoaXMuX25hbWUsdk5vZGU6bn19KSkpLnN1YnNjcmliZSh0aGlzLl9jb250YWluZXIuZG9tUmVuZGVyZXIucmVuZGVyJCkpfV9kZWFjdGl2YXRlKCl7dGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfV9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpe3JldHVybnt9fW1ha2VJbWFnZVVybCh0LGUpe3JldHVybmAke3R9L2FwcC8/cEtleT0ke2V9JmZvY3VzPXBob3RvYH1fbWFrZUF0dHJpYnV0aW9uKHQsZSxpLG4scil7Y29uc3Qgcz1yPD02NDAsbz10aGlzLl9tYWtlRGF0ZShuLHMpLGE9dGhpcy5fbWFrZUJ5KHQsZSxpLHMpLGM9cz9cIi5tYXBpbGxhcnktYXR0cmlidXRpb24tY29tcGFjdFwiOlwiXCI7cmV0dXJuIGpmLmgoXCJkaXYubWFwaWxsYXJ5LWF0dHJpYnV0aW9uLWNvbnRhaW5lclwiK2Mse30sWy4uLmEsb10pfV9tYWtlQnkodCxlLGksbil7Y29uc3Qgcj1qZi5oKFwiZGl2Lm1hcGlsbGFyeS1hdHRyaWJ1dGlvbi1sb2dvXCIsW10pO3JldHVybiB0P3RoaXMuX21ha2VDcmVhdG9yQnkocix0LGUsaSxuKTp0aGlzLl9tYWtlR2VuZXJhbEJ5KHIsZSxpLG4pfV9tYWtlQ3JlYXRvckJ5KHQsZSxpLG4scil7Y29uc3Qgcz1qZi5oKFwiYS5tYXBpbGxhcnktYXR0cmlidXRpb24taWNvbi1jb250YWluZXJcIix7aHJlZjppLHJlbDpcIm5vcmVmZXJyZXJcIix0YXJnZXQ6XCJfYmxhbmtcIn0sW3RdKSxvPXI/YCR7ZX1gOmBpbWFnZSBieSAke2V9YCxhPWpmLmgoXCJkaXYubWFwaWxsYXJ5LWF0dHJpYnV0aW9uLXVzZXJuYW1lXCIse3RleHRDb250ZW50Om99LFtdKTtyZXR1cm5bcyxqZi5oKFwiYS5tYXBpbGxhcnktYXR0cmlidXRpb24taW1hZ2UtY29udGFpbmVyXCIse2hyZWY6dGhpcy5tYWtlSW1hZ2VVcmwoaSxuKSxyZWw6XCJub3JlZmVycmVyXCIsdGFyZ2V0OlwiX2JsYW5rXCJ9LFthXSldfV9tYWtlR2VuZXJhbEJ5KHQsZSxpLG4pe2NvbnN0IHI9amYuaChcImRpdi5tYXBpbGxhcnktYXR0cmlidXRpb24tdXNlcm5hbWVcIix7dGV4dENvbnRlbnQ6XCJpbWFnZXMgYnlcIn0sW10pLHM9W2pmLmgoXCJkaXYubWFwaWxsYXJ5LWF0dHJpYnV0aW9uLWljb24tY29udGFpbmVyXCIse30sW3RdKSxqZi5oKFwiZGl2Lm1hcGlsbGFyeS1hdHRyaWJ1dGlvbi11c2VybmFtZVwiLHt0ZXh0Q29udGVudDpcImNvbnRyaWJ1dG9yc1wifSxbXSldO258fHMudW5zaGlmdChyKTtyZXR1cm5bamYuaChcImEubWFwaWxsYXJ5LWF0dHJpYnV0aW9uLWltYWdlLWNvbnRhaW5lclwiLHtocmVmOnRoaXMubWFrZUltYWdlVXJsKGUsaSkscmVsOlwibm9yZWZlcnJlclwiLHRhcmdldDpcIl9ibGFua1wifSxzKV19X21ha2VEYXRlKHQsZSl7Y29uc3QgaT1uZXcgRGF0ZSh0KS50b0RhdGVTdHJpbmcoKS5zcGxpdChcIiBcIiksbj0oaS5sZW5ndGg+Mz9lP1tpWzNdXTpbaVsxXSxpWzJdK1wiLFwiLGlbM11dOmkpLmpvaW4oXCIgXCIpO3JldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1hdHRyaWJ1dGlvbi1kYXRlXCIse3RleHRDb250ZW50Om59LFtdKX19cWYuY29tcG9uZW50TmFtZT1cImF0dHJpYnV0aW9uXCI7Y2xhc3MgV2Z7Y29uc3RydWN0b3IoKXt0aGlzLl91bnByb2plY3REZXB0aD0yMDB9YmFzaWNUb0NhbnZhcyh0LGUsaSxuLHIpe2NvbnN0IHM9bi51bnByb2plY3RCYXNpYyhbdCxlXSx0aGlzLl91bnByb2plY3REZXB0aCk7cmV0dXJuIHRoaXMucHJvamVjdFRvQ2FudmFzKHMsaSxyKX1iYXNpY1RvQ2FudmFzU2FmZSh0LGUsaSxuLHIpe2NvbnN0IHM9dGhpcy5iYXNpY1RvVmlld3BvcnRTYWZlKHQsZSxuLHIpO2lmKG51bGw9PT1zKXJldHVybiBudWxsO3JldHVybiB0aGlzLnZpZXdwb3J0VG9DYW52YXMoc1swXSxzWzFdLGkpfWJhc2ljVG9WaWV3cG9ydCh0LGUsaSxuKXtjb25zdCByPWkudW5wcm9qZWN0QmFzaWMoW3QsZV0sdGhpcy5fdW5wcm9qZWN0RGVwdGgpO3JldHVybiB0aGlzLnByb2plY3RUb1ZpZXdwb3J0KHIsbil9YmFzaWNUb1ZpZXdwb3J0U2FmZSh0LGUsaSxuKXtjb25zdCByPWkudW5wcm9qZWN0QmFzaWMoW3QsZV0sdGhpcy5fdW5wcm9qZWN0RGVwdGgpO2lmKHRoaXMud29ybGRUb0NhbWVyYShyLG4pWzJdPjApcmV0dXJuIG51bGw7cmV0dXJuIHRoaXMucHJvamVjdFRvVmlld3BvcnQocixuKX1jYW1lcmFUb1ZpZXdwb3J0KHQsZSl7Y29uc3QgaT0obmV3IGZuKS5mcm9tQXJyYXkodCkuYXBwbHlNYXRyaXg0KGUucHJvamVjdGlvbk1hdHJpeCk7cmV0dXJuW2kueCxpLnldfWNhbnZhc1Bvc2l0aW9uKHQsZSl7Y29uc3QgaT1lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO3JldHVyblt0LmNsaWVudFgtaS5sZWZ0LWUuY2xpZW50TGVmdCx0LmNsaWVudFktaS50b3AtZS5jbGllbnRUb3BdfWNhbnZhc1RvQmFzaWModCxlLGksbixyKXtjb25zdCBzPXRoaXMudW5wcm9qZWN0RnJvbUNhbnZhcyh0LGUsaSxyKS50b0FycmF5KCk7cmV0dXJuIG4ucHJvamVjdEJhc2ljKHMpfWNhbnZhc1RvVmlld3BvcnQodCxlLGkpe2NvbnN0W24scl09dGhpcy5jb250YWluZXJUb0NhbnZhcyhpKTtyZXR1cm5bMip0L24tMSwxLTIqZS9yXX1jb250YWluZXJUb0NhbnZhcyh0KXtyZXR1cm5bdC5vZmZzZXRXaWR0aCx0Lm9mZnNldEhlaWdodF19Z2V0QmFzaWNEaXN0YW5jZXModCxlKXtjb25zdCBpPXRoaXMudmlld3BvcnRUb0Jhc2ljKC0xLDEsdCxlKSxuPXRoaXMudmlld3BvcnRUb0Jhc2ljKDEsMSx0LGUpLHI9dGhpcy52aWV3cG9ydFRvQmFzaWMoMSwtMSx0LGUpLHM9dGhpcy52aWV3cG9ydFRvQmFzaWMoLTEsLTEsdCxlKTtsZXQgbz0wLGE9MCxjPTAsaD0wO3JldHVybiBpWzFdPDAmJm5bMV08MCYmKG89aVsxXT5uWzFdPy1pWzFdOi1uWzFdKSxuWzBdPjEmJnJbMF0+MSYmKGE9blswXTxyWzBdP25bMF0tMTpyWzBdLTEpLHJbMV0+MSYmc1sxXT4xJiYoYz1yWzFdPHNbMV0/clsxXS0xOnNbMV0tMSksc1swXTwwJiZpWzBdPDAmJihoPXNbMF0+aVswXT8tc1swXTotaVswXSksW28sYSxjLGhdfWdldFBpeGVsRGlzdGFuY2VzKHQsZSxpKXtjb25zdCBuPXRoaXMudmlld3BvcnRUb0Jhc2ljKC0xLDEsZSxpKSxyPXRoaXMudmlld3BvcnRUb0Jhc2ljKDEsMSxlLGkpLHM9dGhpcy52aWV3cG9ydFRvQmFzaWMoMSwtMSxlLGkpLG89dGhpcy52aWV3cG9ydFRvQmFzaWMoLTEsLTEsZSxpKTtsZXQgYT0wLGM9MCxoPTAsbD0wO2NvbnN0W3UsZF09dGhpcy5jb250YWluZXJUb0NhbnZhcyh0KTtpZihuWzFdPDAmJnJbMV08MCl7Y29uc3Qgcz1uWzFdPnJbMV0/blswXTpyWzBdLG89dGhpcy5iYXNpY1RvQ2FudmFzKHMsMCx0LGUsaSk7YT1vWzFdPjA/b1sxXTowfWlmKHJbMF0+MSYmc1swXT4xKXtjb25zdCBuPXJbMF08c1swXT9yWzFdOnNbMV0sbz10aGlzLmJhc2ljVG9DYW52YXMoMSxuLHQsZSxpKTtjPW9bMF08dT91LW9bMF06MH1pZihzWzFdPjEmJm9bMV0+MSl7Y29uc3Qgbj1zWzFdPG9bMV0/c1swXTpvWzBdLHI9dGhpcy5iYXNpY1RvQ2FudmFzKG4sMSx0LGUsaSk7aD1yWzFdPGQ/ZC1yWzFdOjB9aWYob1swXTwwJiZuWzBdPDApe2NvbnN0IHI9b1swXT5uWzBdP29bMV06blsxXSxzPXRoaXMuYmFzaWNUb0NhbnZhcygwLHIsdCxlLGkpO2w9c1swXT4wP3NbMF06MH1yZXR1cm5bYSxjLGgsbF19aW5zaWRlRWxlbWVudCh0LGUpe2NvbnN0IGk9ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxuPWkubGVmdCtlLmNsaWVudExlZnQscj1uK2UuY2xpZW50V2lkdGgscz1pLnRvcCtlLmNsaWVudFRvcCxvPXMrZS5jbGllbnRIZWlnaHQ7cmV0dXJuIHQuY2xpZW50WD5uJiZ0LmNsaWVudFg8ciYmdC5jbGllbnRZPnMmJnQuY2xpZW50WTxvfXByb2plY3RUb0NhbnZhcyh0LGUsaSl7Y29uc3Qgbj10aGlzLnByb2plY3RUb1ZpZXdwb3J0KHQsaSk7cmV0dXJuIHRoaXMudmlld3BvcnRUb0NhbnZhcyhuWzBdLG5bMV0sZSl9cHJvamVjdFRvQ2FudmFzU2FmZSh0LGUsaSl7aWYodGhpcy53b3JsZFRvQ2FtZXJhKHQsaSlbMl0+MClyZXR1cm4gbnVsbDtjb25zdCBuPXRoaXMucHJvamVjdFRvVmlld3BvcnQodCxpKTtyZXR1cm4gdGhpcy52aWV3cG9ydFRvQ2FudmFzKG5bMF0sblsxXSxlKX1wcm9qZWN0VG9WaWV3cG9ydCh0LGUpe2NvbnN0IGk9bmV3IGZuKHRbMF0sdFsxXSx0WzJdKS5wcm9qZWN0KGUpO3JldHVybltpLngsaS55XX11bnByb2plY3RGcm9tQ2FudmFzKHQsZSxpLG4pe2NvbnN0IHI9dGhpcy5jYW52YXNUb1ZpZXdwb3J0KHQsZSxpKTtyZXR1cm4gdGhpcy51bnByb2plY3RGcm9tVmlld3BvcnQoclswXSxyWzFdLG4pfXVucHJvamVjdEZyb21WaWV3cG9ydCh0LGUsaSl7cmV0dXJuIG5ldyBmbih0LGUsMSkudW5wcm9qZWN0KGkpfXZpZXdwb3J0VG9CYXNpYyh0LGUsaSxuKXtjb25zdCByPW5ldyBmbih0LGUsMSkudW5wcm9qZWN0KG4pLnRvQXJyYXkoKTtyZXR1cm4gaS5wcm9qZWN0QmFzaWMocil9dmlld3BvcnRUb0NhbnZhcyh0LGUsaSl7Y29uc3RbbixyXT10aGlzLmNvbnRhaW5lclRvQ2FudmFzKGkpO3JldHVybltuKih0KzEpLzIsLXIqKGUtMSkvMl19d29ybGRUb0NhbWVyYSh0LGUpe3JldHVybiBuZXcgZm4odFswXSx0WzFdLHRbMl0pLmFwcGx5TWF0cml4NChlLm1hdHJpeFdvcmxkSW52ZXJzZSkudG9BcnJheSgpfX10LkNvbXBvbmVudFNpemU9dm9pZCAwLChCZj10LkNvbXBvbmVudFNpemV8fCh0LkNvbXBvbmVudFNpemU9e30pKVtCZi5BdXRvbWF0aWM9MF09XCJBdXRvbWF0aWNcIixCZltCZi5MYXJnZT0xXT1cIkxhcmdlXCIsQmZbQmYuU21hbGw9Ml09XCJTbWFsbFwiO2NsYXNzIFhmIGV4dGVuZHMgVmZ7Y29uc3RydWN0b3IodCxlLGkpe3N1cGVyKHQsZSxpKSx0aGlzLl9zcGF0aWFsPW5ldyBsZCx0aGlzLl92aWV3cG9ydENvb3Jkcz1uZXcgV2YsdGhpcy5fc3ZnTmFtZXNwYWNlPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIix0aGlzLl9kaXN0aW5jdFRocmVzaG9sZD1NYXRoLlBJLzM2MCx0aGlzLl9hbmltYXRpb25TcGVlZD0uMDc1LHRoaXMuX3VuaXRCZXppZXI9bmV3IEZkKC43NCwuNjcsLjM4LC45Nil9X2FjdGl2YXRlKCl7Y29uc3QgZT10aGlzLl9zdWJzY3JpcHRpb25zLGk9dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJC5waXBlKHJ0KCh0PT57bGV0IGU9dGhpcy5fc3BhdGlhbC5kZWdUb1JhZCh0LnBlcnNwZWN0aXZlLmZvdiksaT10LnBlcnNwZWN0aXZlLmFzcGVjdD09PU51bWJlci5QT1NJVElWRV9JTkZJTklUWT9NYXRoLlBJOjIqTWF0aC5hdGFuKHQucGVyc3BlY3RpdmUuYXNwZWN0Kk1hdGgudGFuKC41KmUpKTtyZXR1cm5bdGhpcy5fc3BhdGlhbC5hemltdXRoYWxUb0JlYXJpbmcodC5yb3RhdGlvbi5waGkpLGldfSkpLHVlKCgodCxlKT0+TWF0aC5hYnMoZVswXS10WzBdKTx0aGlzLl9kaXN0aW5jdFRocmVzaG9sZCYmTWF0aC5hYnMoZVsxXS10WzFdKTx0aGlzLl9kaXN0aW5jdFRocmVzaG9sZCkpKSxuPWd0KHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHVlKHZvaWQgMCwodD0+dC5zdGF0ZS5jdXJyZW50SW1hZ2UuaWQpKSksdGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2UucGFuSW1hZ2VzJCkucGlwZShydCgoKFt0LGVdKT0+e2NvbnN0IGk9dC5zdGF0ZS5jdXJyZW50SW1hZ2Usbj10LnN0YXRlLmN1cnJlbnRUcmFuc2Zvcm07aWYoZGQoaS5jYW1lcmFUeXBlKSlyZXR1cm5bTWF0aC5QSSxNYXRoLlBJXTtjb25zdCByPXRoaXMuX2NvbXB1dGVQcm9qZWN0ZWRQb2ludHMobikscz10aGlzLl9zcGF0aWFsLmRlZ1RvUmFkKHRoaXMuX2NvbXB1dGVIb3Jpem9udGFsRm92KHIpKTtsZXQgbz1zLzIsYT1zLzI7Zm9yKGNvbnN0W3QsLG5db2YgZSl7Y29uc3QgZT10aGlzLl9zcGF0aWFsLndyYXAodC5jb21wYXNzQW5nbGUtaS5jb21wYXNzQW5nbGUsLTE4MCwxODApO2U8MD9vPXRoaXMuX3NwYXRpYWwuZGVnVG9SYWQoTWF0aC5hYnMoZSkpK24vMjphPXRoaXMuX3NwYXRpYWwuZGVnVG9SYWQoTWF0aC5hYnMoZSkpK24vMn1yZXR1cm5bbyxhXX0pKSx1ZSgoKFt0LGVdLFtpLG5dKT0+TWF0aC5hYnMoaS10KTx0aGlzLl9kaXN0aW5jdFRocmVzaG9sZCYmTWF0aC5hYnMobi1lKTx0aGlzLl9kaXN0aW5jdFRocmVzaG9sZCkpKSxyPWd0KHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHVlKHZvaWQgMCwodD0+dC5zdGF0ZS5jdXJyZW50SW1hZ2UuaWQpKSksdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UuYmVhcmluZyQpLnBpcGUocnQoKChbdCxlXSk9PnRoaXMuX3NwYXRpYWwuZGVnVG9SYWQodC5zdGF0ZS5jdXJyZW50SW1hZ2UuY29tcGFzc0FuZ2xlLWUpKSkpLHM9bmV3IFQsbz1zLnBpcGUoTGUoKCh0LGUpPT5lKHQpKSx7YWxwaGE6MCxjdXJyOlswLDAsMF0scHJldjpbMCwwLDBdfSkscnQoKHQ9Pntjb25zdCBlPXRoaXMuX3VuaXRCZXppZXIuc29sdmUodC5hbHBoYSksaT10LmN1cnIsbj10LnByZXY7cmV0dXJuW3RoaXMuX2ludGVycG9sYXRlKG5bMF0saVswXSxlKSx0aGlzLl9pbnRlcnBvbGF0ZShuWzFdLGlbMV0sZSldfSkpKTtlLnB1c2gobi5waXBlKHJ0KCh0PT5lPT57Y29uc3QgaT10aGlzLl91bml0QmV6aWVyLnNvbHZlKGUuYWxwaGEpLG49ZS5jdXJyLHI9ZS5wcmV2LHM9W3RoaXMuX2ludGVycG9sYXRlKHJbMF0sblswXSxpKSx0aGlzLl9pbnRlcnBvbGF0ZShyWzFdLG5bMV0saSldO3JldHVybnthbHBoYTowLGN1cnI6dC5zbGljZSgpLHByZXY6c319KSkpLnN1YnNjcmliZShzKSksZS5wdXNoKG4ucGlwZShyaSgoKCk9PnRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYUZyYW1lJC5waXBlKEplKDEpLExlKCh0PT50K3RoaXMuX2FuaW1hdGlvblNwZWVkKSwwKSxsaSgodD0+dDw9MSt0aGlzLl9hbmltYXRpb25TcGVlZCkpLHJ0KCh0PT5NYXRoLm1pbih0LDEpKSkpKSkscnQoKHQ9PmU9Pih7YWxwaGE6dCxjdXJyOmUuY3Vyci5zbGljZSgpLHByZXY6ZS5wcmV2LnNsaWNlKCl9KSkpKS5zdWJzY3JpYmUocykpO2NvbnN0IGE9Z3QocixvKS5waXBlKHJ0KCgoW3QsZV0pPT5bdCxlWzBdLGVbMV1dKSkpO2UucHVzaChndChpLGEsdGhpcy5fY29uZmlndXJhdGlvbiQsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQpLnBpcGUocnQoKChbW2UsaV0sW24scixzXSxvLGFdKT0+e2NvbnN0IGM9dGhpcy5fY3JlYXRlQmFja2dyb3VuZChlKSxoPXRoaXMuX2NyZWF0ZUZvdkluZGljYXRvcihyLHMsbiksbD10aGlzLl9jcmVhdGVOb3J0aChlKSx1PXRoaXMuX2NyZWF0ZUNpcmNsZVNlY3RvckNvbXBhc3ModGhpcy5fY3JlYXRlQ2lyY2xlU2VjdG9yKE1hdGgubWF4KE1hdGguUEkvMjAsaSksXCIjRkZGXCIpKSxkPW8uc2l6ZT09PXQuQ29tcG9uZW50U2l6ZS5TbWFsbHx8by5zaXplPT09dC5Db21wb25lbnRTaXplLkF1dG9tYXRpYyYmYS53aWR0aDw2NDA/XCIubWFwaWxsYXJ5LWJlYXJpbmctY29tcGFjdFwiOlwiXCI7cmV0dXJue25hbWU6dGhpcy5fbmFtZSx2Tm9kZTpqZi5oKFwiZGl2Lm1hcGlsbGFyeS1iZWFyaW5nLWluZGljYXRvci1jb250YWluZXJcIitkLHtvbmNvbnRleHRtZW51OnQ9Pnt0LnByZXZlbnREZWZhdWx0KCl9fSxbYyxoLGwsdV0pfX0pKSkuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lci5kb21SZW5kZXJlci5yZW5kZXIkKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9X2dldERlZmF1bHRDb25maWd1cmF0aW9uKCl7cmV0dXJue3NpemU6dC5Db21wb25lbnRTaXplLkF1dG9tYXRpY319X2NyZWF0ZUZvdkluZGljYXRvcih0LGUsaSl7Y29uc3Qgbj10aGlzLl9jcmVhdGVGb3ZBcmModCxlKSxyPWpmLmgoXCJnXCIse2F0dHJpYnV0ZXM6e3RyYW5zZm9ybTpcInRyYW5zbGF0ZSgxOCwxOClcIn0sbmFtZXNwYWNlOnRoaXMuX3N2Z05hbWVzcGFjZX0sW25dKTtyZXR1cm4gamYuaChcInN2Z1wiLHthdHRyaWJ1dGVzOnt2aWV3Qm94OlwiMCAwIDM2IDM2XCJ9LG5hbWVzcGFjZTp0aGlzLl9zdmdOYW1lc3BhY2Usc3R5bGU6e2hlaWdodDpcIjM2cHhcIixsZWZ0OlwiMnB4XCIscG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIjJweFwiLHRyYW5zZm9ybTpgcm90YXRlWigke3RoaXMuX3NwYXRpYWwucmFkVG9EZWcoaSl9ZGVnKWAsd2lkdGg6XCIzNnB4XCJ9fSxbcl0pfV9jcmVhdGVGb3ZBcmModCxlKXtjb25zdCBpPTE2Ljc1LG49dCtlO2lmKG4+MipNYXRoLlBJLU1hdGguUEkvOTApcmV0dXJuIGpmLmgoXCJjaXJjbGVcIix7YXR0cmlidXRlczp7Y3g6XCIwXCIsY3k6XCIwXCIsXCJmaWxsLW9wYWNpdHlcIjpcIjBcIixyOlwiMTYuNzVcIixzdHJva2U6XCIjRkZGXCIsXCJzdHJva2Utd2lkdGhcIjpcIjIuNVwifSxuYW1lc3BhY2U6dGhpcy5fc3ZnTmFtZXNwYWNlfSxbXSk7bGV0IHI9LU1hdGguUEkvMi10LHM9cituLG89aSpNYXRoLmNvcyhyKSxhPWkqTWF0aC5zaW4ociksYz1pKk1hdGguY29zKHMpLGg9aSpNYXRoLnNpbihzKSxsPWBNICR7b30gJHthfSBBIDE2Ljc1IDE2Ljc1IDAgJHtuPj1NYXRoLlBJPzE6MH0gMSAke2N9ICR7aH1gO3JldHVybiBqZi5oKFwicGF0aFwiLHthdHRyaWJ1dGVzOntkOmwsXCJmaWxsLW9wYWNpdHlcIjpcIjBcIixzdHJva2U6XCIjRkZGXCIsXCJzdHJva2Utd2lkdGhcIjpcIjIuNVwifSxuYW1lc3BhY2U6dGhpcy5fc3ZnTmFtZXNwYWNlfSxbXSl9X2NyZWF0ZUNpcmNsZVNlY3RvckNvbXBhc3ModCl7bGV0IGU9amYuaChcImdcIix7YXR0cmlidXRlczp7dHJhbnNmb3JtOlwidHJhbnNsYXRlKDEsMSlcIn0sbmFtZXNwYWNlOnRoaXMuX3N2Z05hbWVzcGFjZX0sW3RdKTtyZXR1cm4gamYuaChcInN2Z1wiLHthdHRyaWJ1dGVzOnt2aWV3Qm94OlwiMCAwIDIgMlwifSxuYW1lc3BhY2U6dGhpcy5fc3ZnTmFtZXNwYWNlLHN0eWxlOntoZWlnaHQ6XCIyNnB4XCIsbGVmdDpcIjdweFwiLHBvc2l0aW9uOlwiYWJzb2x1dGVcIix0b3A6XCI3cHhcIix3aWR0aDpcIjI2cHhcIn19LFtlXSl9X2NyZWF0ZUNpcmNsZVNlY3Rvcih0LGUpe2lmKHQ+MipNYXRoLlBJLU1hdGguUEkvOTApcmV0dXJuIGpmLmgoXCJjaXJjbGVcIix7YXR0cmlidXRlczp7Y3g6XCIwXCIsY3k6XCIwXCIsZmlsbDplLHI6XCIxXCJ9LG5hbWVzcGFjZTp0aGlzLl9zdmdOYW1lc3BhY2V9LFtdKTtsZXQgaT0tTWF0aC5QSS8yLXQvMixuPWkrdCxyPU1hdGguY29zKGkpLHM9TWF0aC5zaW4oaSksbz1NYXRoLmNvcyhuKSxhPU1hdGguc2luKG4pLGM9YE0gMCAwICR7cn0gJHtzfSBBIDEgMSAwICR7dD49TWF0aC5QST8xOjB9IDEgJHtvfSAke2F9YDtyZXR1cm4gamYuaChcInBhdGhcIix7YXR0cmlidXRlczp7ZDpjLGZpbGw6ZX0sbmFtZXNwYWNlOnRoaXMuX3N2Z05hbWVzcGFjZX0sW10pfV9jcmVhdGVOb3J0aCh0KXtjb25zdCBlPWpmLmgoXCJkaXYubWFwaWxsYXJ5LWJlYXJpbmctbm9ydGhcIixbXSk7cmV0dXJuIGpmLmgoXCJkaXYubWFwaWxsYXJ5LWJlYXJpbmctbm9ydGgtY29udGFpbmVyXCIse3N0eWxlOnt0cmFuc2Zvcm06YHJvdGF0ZVooJHt0aGlzLl9zcGF0aWFsLnJhZFRvRGVnKC10KX1kZWcpYH19LFtlXSl9X2NyZWF0ZUJhY2tncm91bmQodCl7cmV0dXJuIGpmLmgoXCJkaXYubWFwaWxsYXJ5LWJlYXJpbmctaW5kaWNhdG9yLWJhY2tncm91bmRcIix7c3R5bGU6e3RyYW5zZm9ybTpgcm90YXRlWigke3RoaXMuX3NwYXRpYWwucmFkVG9EZWcoLXQpfWRlZylgfX0sW2pmLmgoXCJkaXYubWFwaWxsYXJ5LWJlYXJpbmctaW5kaWNhdG9yLWJhY2tncm91bmQtY2lyY2xlXCIsW10pLGpmLmgoXCJkaXYubWFwaWxsYXJ5LWJlYXJpbmctaW5kaWNhdG9yLWJhY2tncm91bmQtYXJyb3ctY29udGFpbmVyXCIsW2pmLmgoXCJkaXYubWFwaWxsYXJ5LWJlYXJpbmctaW5kaWNhdG9yLWJhY2tncm91bmQtYXJyb3dcIixbXSldKV0pfV9jb21wdXRlUHJvamVjdGVkUG9pbnRzKHQpe3JldHVybiBtZCh0LFtbMSwwXV0sW1swLC41XV0sMTIsdGhpcy5fdmlld3BvcnRDb29yZHMpfV9jb21wdXRlSG9yaXpvbnRhbEZvdih0KXtjb25zdCBlPXQubWFwKCh0PT50aGlzLl9jb29yZFRvRm92KHRbMF0pKSk7cmV0dXJuIE1hdGgubWluKC4uLmUpfV9jb29yZFRvRm92KHQpe3JldHVybiB0aGlzLl9zcGF0aWFsLnJhZFRvRGVnKDIqTWF0aC5hdGFuKHQpKX1faW50ZXJwb2xhdGUodCxlLGkpe3JldHVybigxLWkpKnQraSplfX1YZi5jb21wb25lbnROYW1lPVwiYmVhcmluZ1wiO2NsYXNzIFlmIGV4dGVuZHMgVmZ7Y29uc3RydWN0b3IodCxlLGkpe3N1cGVyKHQsZSxpKX1fYWN0aXZhdGUoKXtjb25zdCBlPXRoaXMuX3N1YnNjcmlwdGlvbnM7ZS5wdXNoKGd0KHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJC5waXBlKHJpKCh0PT50LnNlcXVlbmNlRWRnZXMkKSksTnQoKHQ9PnQuY2FjaGVkKSkpLHRoaXMuX2NvbmZpZ3VyYXRpb24kKS5waXBlKHJpKChlPT57bGV0IGk9ZVswXSxuPWVbMV0scj1NYXRoLm1heCgwLE1hdGgubWluKDQsbi5kZXB0aC5zZXF1ZW5jZSkpO3JldHVybiBPdCh0aGlzLl9jYWNoZSQoaS5lZGdlcyx0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCxyKSx0aGlzLl9jYWNoZSQoaS5lZGdlcyx0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldixyKSkucGlwZSh0ZSgodD0+KGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2FjaGUgc2VxdWVuY2UgZWRnZXMuXCIsdCksQigpKSkpKX0pKSkuc3Vic2NyaWJlKCgoKT0+e30pKSksZS5wdXNoKGd0KHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJC5waXBlKHJpKCh0PT5ndChHKHQpLHQuc3BhdGlhbEVkZ2VzJC5waXBlKE50KCh0PT50LmNhY2hlZCkpKSkpKSksdGhpcy5fY29uZmlndXJhdGlvbiQpLnBpcGUocmkoKChbW2UsaV0sbl0pPT57bGV0IHI9aS5lZGdlcyxzPW4uZGVwdGgsbz1NYXRoLm1heCgwLE1hdGgubWluKDIscy5zcGhlcmljYWwpKSxhPWRkKGUuY2FtZXJhVHlwZSk/MDpNYXRoLm1heCgwLE1hdGgubWluKDMscy5zdGVwKSksYz1kZChlLmNhbWVyYVR5cGUpPzA6TWF0aC5tYXgoMCxNYXRoLm1pbigxLHMudHVybikpLGg9dGhpcy5fY2FjaGUkKHIsdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlNwaGVyaWNhbCxvKTtyZXR1cm4gT3QodGhpcy5fY2FjaGUkKHIsdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBGb3J3YXJkLGEpLHRoaXMuX2NhY2hlJChyLHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwQmFja3dhcmQsYSksdGhpcy5fY2FjaGUkKHIsdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBMZWZ0LGEpLHRoaXMuX2NhY2hlJChyLHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwUmlnaHQsYSksaCx0aGlzLl9jYWNoZSQocix0Lk5hdmlnYXRpb25EaXJlY3Rpb24uVHVybkxlZnQsYyksdGhpcy5fY2FjaGUkKHIsdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5SaWdodCxjKSx0aGlzLl9jYWNoZSQocix0Lk5hdmlnYXRpb25EaXJlY3Rpb24uVHVyblUsYykpLnBpcGUodGUoKHQ9Pihjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNhY2hlIHNwYXRpYWwgZWRnZXMuXCIsdCksQigpKSkpKX0pKSkuc3Vic2NyaWJlKCgoKT0+e30pKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9X2dldERlZmF1bHRDb25maWd1cmF0aW9uKCl7cmV0dXJue2RlcHRoOntzcGhlcmljYWw6MSxzZXF1ZW5jZToyLHN0ZXA6MSx0dXJuOjB9fX1fY2FjaGUkKHQsZSxpKXtyZXR1cm4gRnQoRyh0KSxHKGkpKS5waXBlKHhlKCh0PT57bGV0IGk9dFswXSxuPXRbMV0scj1bXTtpZihuPjApZm9yKGxldCB0IG9mIGkpdC5kYXRhLmRpcmVjdGlvbj09PWUmJnIucHVzaChGdCh0aGlzLl9uYXZpZ2F0b3IuZ3JhcGhTZXJ2aWNlLmNhY2hlSW1hZ2UkKHQudGFyZ2V0KS5waXBlKE10KCh0PT50aGlzLl9pbWFnZVRvRWRnZXMkKHQsZSkpKSksRyhuLTEpKSk7cmV0dXJuIGJ0KHIpLnBpcGUoRXQoKSl9KSksSmUoMSkpfV9pbWFnZVRvRWRnZXMkKGUsaSl7cmV0dXJuKFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCx0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldl0uaW5kZXhPZihpKT4tMT9lLnNlcXVlbmNlRWRnZXMkOmUuc3BhdGlhbEVkZ2VzJCkucGlwZShFZSgodD0+dC5jYWNoZWQpKSxydCgodD0+dC5lZGdlcykpKX19WWYuY29tcG9uZW50TmFtZT1cImNhY2hlXCI7Y2xhc3MgWmYgZXh0ZW5kcyBjZHtjb25zdHJ1Y3Rvcih0KXtzdXBlcihudWxsIT10P3Q6XCJUaGUgcmVxdWVzdCB3YXMgY2FuY2VsbGVkLlwiKSxPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyxaZi5wcm90b3R5cGUpLHRoaXMubmFtZT1cIkNhbmNlbE1hcGlsbGFyeUVycm9yXCJ9fWNsYXNzIEpme2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5fc3BhdGlhbD1uZXcgbGQsdGhpcy5fbWluVGhyZXNob2xkV2lkdGg9MzIwLHRoaXMuX21heFRocmVzaG9sZFdpZHRoPTE0ODAsdGhpcy5fbWluVGhyZXNob2xkSGVpZ2h0PTI0MCx0aGlzLl9tYXhUaHJlc2hvbGRIZWlnaHQ9ODIwLHRoaXMuX2NvbmZpZ3VyZSh0KSx0aGlzLl9yZXNpemUoZSksdGhpcy5fcmVzZXQoKX1nZXQgbWluV2lkdGgoKXtyZXR1cm4gdGhpcy5fbWluV2lkdGh9Z2V0IG1heFdpZHRoKCl7cmV0dXJuIHRoaXMuX21heFdpZHRofWdldCBjb250YWluZXJXaWR0aCgpe3JldHVybiB0aGlzLl9jb250YWluZXJXaWR0aH1nZXQgY29udGFpbmVyV2lkdGhDc3MoKXtyZXR1cm4gdGhpcy5fY29udGFpbmVyV2lkdGhDc3N9Z2V0IGNvbnRhaW5lck1hcmdpbkNzcygpe3JldHVybiB0aGlzLl9jb250YWluZXJNYXJnaW5Dc3N9Z2V0IGNvbnRhaW5lckxlZnRDc3MoKXtyZXR1cm4gdGhpcy5fY29udGFpbmVyTGVmdENzc31nZXQgY29udGFpbmVySGVpZ2h0KCl7cmV0dXJuIHRoaXMuX2NvbnRhaW5lckhlaWdodH1nZXQgY29udGFpbmVySGVpZ2h0Q3NzKCl7cmV0dXJuIHRoaXMuX2NvbnRhaW5lckhlaWdodENzc31nZXQgY29udGFpbmVyQm90dG9tQ3NzKCl7cmV0dXJuIHRoaXMuX2NvbnRhaW5lckJvdHRvbUNzc31nZXQgc3RlcENpcmNsZVNpemUoKXtyZXR1cm4gdGhpcy5fc3RlcENpcmNsZVNpemV9Z2V0IHN0ZXBDaXJjbGVTaXplQ3NzKCl7cmV0dXJuIHRoaXMuX3N0ZXBDaXJjbGVTaXplQ3NzfWdldCBzdGVwQ2lyY2xlTWFyZ2luQ3NzKCl7cmV0dXJuIHRoaXMuX3N0ZXBDaXJjbGVNYXJnaW5Dc3N9Z2V0IHR1cm5DaXJjbGVTaXplKCl7cmV0dXJuIHRoaXMuX3R1cm5DaXJjbGVTaXplfWdldCB0dXJuQ2lyY2xlU2l6ZUNzcygpe3JldHVybiB0aGlzLl90dXJuQ2lyY2xlU2l6ZUNzc31nZXQgb3V0ZXJSYWRpdXMoKXtyZXR1cm4gdGhpcy5fb3V0ZXJSYWRpdXN9Z2V0IGlubmVyUmFkaXVzKCl7cmV0dXJuIHRoaXMuX2lubmVyUmFkaXVzfWdldCBzaGFkb3dPZmZzZXQoKXtyZXR1cm4gdGhpcy5fc2hhZG93T2Zmc2V0fWNvbmZpZ3VyZSh0KXt0aGlzLl9jb25maWd1cmUodCksdGhpcy5fcmVzZXQoKX1yZXNpemUodCl7dGhpcy5fcmVzaXplKHQpLHRoaXMuX3Jlc2V0KCl9YW5nbGVUb0Nvb3JkaW5hdGVzKHQpe3JldHVybltNYXRoLmNvcyh0KSxNYXRoLnNpbih0KV19cmVsYXRpdmVBbmdsZVRvQ29vcmRpYW50ZXModCxlKXtsZXQgaT10aGlzLl9zcGF0aWFsLndyYXBBbmdsZSh0LWUpO3JldHVybiB0aGlzLmFuZ2xlVG9Db29yZGluYXRlcyhpKX1fY29uZmlndXJlKHQpe3RoaXMuX21pbldpZHRoPXQubWluV2lkdGgsdGhpcy5fbWF4V2lkdGg9dGhpcy5fZ2V0TWF4V2lkdGgodC5taW5XaWR0aCx0Lm1heFdpZHRoKX1fcmVzaXplKHQpe3RoaXMuX2VsZW1lbnRXaWR0aD10LndpZHRoLHRoaXMuX2VsZW1lbnRIZWlnaHQ9dC5oZWlnaHR9X3Jlc2V0KCl7dGhpcy5fY29udGFpbmVyV2lkdGg9dGhpcy5fZ2V0Q29udGFpbmVyV2lkdGgodGhpcy5fZWxlbWVudFdpZHRoLHRoaXMuX2VsZW1lbnRIZWlnaHQpLHRoaXMuX2NvbnRhaW5lckhlaWdodD10aGlzLl9nZXRDb250YWluZXJIZWlnaHQodGhpcy5jb250YWluZXJXaWR0aCksdGhpcy5fc3RlcENpcmNsZVNpemU9dGhpcy5fZ2V0U3RlcENpcmNsZURpYW1ldGVyKHRoaXMuX2NvbnRhaW5lckhlaWdodCksdGhpcy5fdHVybkNpcmNsZVNpemU9dGhpcy5fZ2V0VHVybkNpcmNsZURpYW1ldGVyKHRoaXMuY29udGFpbmVySGVpZ2h0KSx0aGlzLl9vdXRlclJhZGl1cz10aGlzLl9nZXRPdXRlclJhZGl1cyh0aGlzLl9jb250YWluZXJIZWlnaHQpLHRoaXMuX2lubmVyUmFkaXVzPXRoaXMuX2dldElubmVyUmFkaXVzKHRoaXMuX2NvbnRhaW5lckhlaWdodCksdGhpcy5fc2hhZG93T2Zmc2V0PTMsdGhpcy5fY29udGFpbmVyV2lkdGhDc3M9dGhpcy5fbnVtYmVyVG9Dc3NQaXhlbHModGhpcy5fY29udGFpbmVyV2lkdGgpLHRoaXMuX2NvbnRhaW5lck1hcmdpbkNzcz10aGlzLl9udW1iZXJUb0Nzc1BpeGVscygtLjUqdGhpcy5fY29udGFpbmVyV2lkdGgpLHRoaXMuX2NvbnRhaW5lckxlZnRDc3M9dGhpcy5fbnVtYmVyVG9Dc3NQaXhlbHMoTWF0aC5mbG9vciguNSp0aGlzLl9lbGVtZW50V2lkdGgpKSx0aGlzLl9jb250YWluZXJIZWlnaHRDc3M9dGhpcy5fbnVtYmVyVG9Dc3NQaXhlbHModGhpcy5fY29udGFpbmVySGVpZ2h0KSx0aGlzLl9jb250YWluZXJCb3R0b21Dc3M9dGhpcy5fbnVtYmVyVG9Dc3NQaXhlbHMoTWF0aC5mbG9vcigtLjA4KnRoaXMuX2NvbnRhaW5lckhlaWdodCkpLHRoaXMuX3N0ZXBDaXJjbGVTaXplQ3NzPXRoaXMuX251bWJlclRvQ3NzUGl4ZWxzKHRoaXMuX3N0ZXBDaXJjbGVTaXplKSx0aGlzLl9zdGVwQ2lyY2xlTWFyZ2luQ3NzPXRoaXMuX251bWJlclRvQ3NzUGl4ZWxzKC0uNSp0aGlzLl9zdGVwQ2lyY2xlU2l6ZSksdGhpcy5fdHVybkNpcmNsZVNpemVDc3M9dGhpcy5fbnVtYmVyVG9Dc3NQaXhlbHModGhpcy5fdHVybkNpcmNsZVNpemUpfV9nZXRDb250YWluZXJXaWR0aCh0LGUpe2xldCBpPSh0LXRoaXMuX21pblRocmVzaG9sZFdpZHRoKS8odGhpcy5fbWF4VGhyZXNob2xkV2lkdGgtdGhpcy5fbWluVGhyZXNob2xkV2lkdGgpLG49KGUtdGhpcy5fbWluVGhyZXNob2xkSGVpZ2h0KS8odGhpcy5fbWF4VGhyZXNob2xkSGVpZ2h0LXRoaXMuX21pblRocmVzaG9sZEhlaWdodCkscj1NYXRoLm1heCgwLE1hdGgubWluKDEsTWF0aC5taW4oaSxuKSkpO3JldHVybiByPS4wNCpNYXRoLnJvdW5kKDI1KnIpLHRoaXMuX21pbldpZHRoK3IqKHRoaXMuX21heFdpZHRoLXRoaXMuX21pbldpZHRoKX1fZ2V0Q29udGFpbmVySGVpZ2h0KHQpe3JldHVybi43Nyp0fV9nZXRTdGVwQ2lyY2xlRGlhbWV0ZXIodCl7cmV0dXJuLjM0KnR9X2dldFR1cm5DaXJjbGVEaWFtZXRlcih0KXtyZXR1cm4uMyp0fV9nZXRPdXRlclJhZGl1cyh0KXtyZXR1cm4uMzEqdH1fZ2V0SW5uZXJSYWRpdXModCl7cmV0dXJuLjEyNSp0fV9udW1iZXJUb0Nzc1BpeGVscyh0KXtyZXR1cm4gdCtcInB4XCJ9X2dldE1heFdpZHRoKHQsZSl7cmV0dXJuIHQ+ZT90OmV9fWNsYXNzIEtme2NvbnN0cnVjdG9yKGUsaSl7dGhpcy5faXNFZGdlPSExLHRoaXMuX3NwYXRpYWw9bmV3IGxkLHRoaXMuX2NhbGN1bGF0b3I9bmV3IEpmKGUsaSksdGhpcy5faW1hZ2U9bnVsbCx0aGlzLl9yb3RhdGlvbj17cGhpOjAsdGhldGE6MH0sdGhpcy5fZXBzaWxvbj0uNSpNYXRoLlBJLzE4MCx0aGlzLl9oaWdobGlnaHRLZXk9bnVsbCx0aGlzLl9kaXN0aW5ndWlzaFNlcXVlbmNlPSExLHRoaXMuX25lZWRzUmVuZGVyPSExLHRoaXMuX3N0ZXBFZGdlcz1bXSx0aGlzLl90dXJuRWRnZXM9W10sdGhpcy5fc3BoZXJpY2FsRWRnZXM9W10sdGhpcy5fc2VxdWVuY2VFZGdlS2V5cz1bXSx0aGlzLl9zdGVwRGlyZWN0aW9ucz1bdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBGb3J3YXJkLHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwQmFja3dhcmQsdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBMZWZ0LHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwUmlnaHRdLHRoaXMuX3R1cm5EaXJlY3Rpb25zPVt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uVHVybkxlZnQsdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5SaWdodCx0Lk5hdmlnYXRpb25EaXJlY3Rpb24uVHVyblVdLHRoaXMuX3R1cm5OYW1lcz17fSx0aGlzLl90dXJuTmFtZXNbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5MZWZ0XT1cIm1hcGlsbGFyeS1kaXJlY3Rpb24tdHVybi1sZWZ0XCIsdGhpcy5fdHVybk5hbWVzW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuUmlnaHRdPVwibWFwaWxsYXJ5LWRpcmVjdGlvbi10dXJuLXJpZ2h0XCIsdGhpcy5fdHVybk5hbWVzW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuVV09XCJtYXBpbGxhcnktZGlyZWN0aW9uLXR1cm4tYXJvdW5kXCI7bGV0IG49ISFkb2N1bWVudC5kb2N1bWVudE1vZGU7dGhpcy5faXNFZGdlPSFuJiYhIXdpbmRvdy5TdHlsZU1lZGlhfWdldCBuZWVkc1JlbmRlcigpe3JldHVybiB0aGlzLl9uZWVkc1JlbmRlcn1yZW5kZXIodCl7dGhpcy5fbmVlZHNSZW5kZXI9ITE7bGV0IGU9dGhpcy5fcm90YXRpb24saT1bXSxuPVtdO3JldHVybiBkZCh0aGlzLl9pbWFnZS5jYW1lcmFUeXBlKT9pPWkuY29uY2F0KHRoaXMuX2NyZWF0ZVNwaGVyaWNhbEFycm93cyh0LGUpKTooaT1pLmNvbmNhdCh0aGlzLl9jcmVhdGVQZXJzcGVjdGl2ZVRvU3BoZXJpY2FsQXJyb3dzKHQsZSkpLGk9aS5jb25jYXQodGhpcy5fY3JlYXRlU3RlcEFycm93cyh0LGUpKSxuPW4uY29uY2F0KHRoaXMuX2NyZWF0ZVR1cm5BcnJvd3ModCkpKSx0aGlzLl9nZXRDb250YWluZXIoaSxuLGUpfXNldEVkZ2VzKHQsZSl7dGhpcy5fc2V0RWRnZXModCxlKSx0aGlzLl9zZXROZWVkc1JlbmRlcigpfXNldEltYWdlKHQpe3RoaXMuX2ltYWdlPXQsdGhpcy5fY2xlYXJFZGdlcygpLHRoaXMuX3NldE5lZWRzUmVuZGVyKCl9c2V0UmVuZGVyQ2FtZXJhKHQpe2xldCBlPXQucm90YXRpb247TWF0aC5hYnMoZS5waGktdGhpcy5fcm90YXRpb24ucGhpKTx0aGlzLl9lcHNpbG9ufHwodGhpcy5fcm90YXRpb249ZSx0aGlzLl9zZXROZWVkc1JlbmRlcigpKX1zZXRDb25maWd1cmF0aW9uKHQpe2xldCBlPSExO3RoaXMuX2hpZ2hsaWdodEtleT09PXQuaGlnaGxpZ2h0SWQmJnRoaXMuX2Rpc3Rpbmd1aXNoU2VxdWVuY2U9PT10LmRpc3Rpbmd1aXNoU2VxdWVuY2V8fCh0aGlzLl9oaWdobGlnaHRLZXk9dC5oaWdobGlnaHRJZCx0aGlzLl9kaXN0aW5ndWlzaFNlcXVlbmNlPXQuZGlzdGluZ3Vpc2hTZXF1ZW5jZSxlPSEwKSx0aGlzLl9jYWxjdWxhdG9yLm1pbldpZHRoPT09dC5taW5XaWR0aCYmdGhpcy5fY2FsY3VsYXRvci5tYXhXaWR0aD09PXQubWF4V2lkdGh8fCh0aGlzLl9jYWxjdWxhdG9yLmNvbmZpZ3VyZSh0KSxlPSEwKSxlJiZ0aGlzLl9zZXROZWVkc1JlbmRlcigpfXJlc2l6ZSh0KXt0aGlzLl9jYWxjdWxhdG9yLnJlc2l6ZSh0KSx0aGlzLl9zZXROZWVkc1JlbmRlcigpfV9zZXROZWVkc1JlbmRlcigpe251bGwhPXRoaXMuX2ltYWdlJiYodGhpcy5fbmVlZHNSZW5kZXI9ITApfV9jbGVhckVkZ2VzKCl7dGhpcy5fc3RlcEVkZ2VzPVtdLHRoaXMuX3R1cm5FZGdlcz1bXSx0aGlzLl9zcGhlcmljYWxFZGdlcz1bXSx0aGlzLl9zZXF1ZW5jZUVkZ2VLZXlzPVtdfV9zZXRFZGdlcyhlLGkpe3RoaXMuX3N0ZXBFZGdlcz1bXSx0aGlzLl90dXJuRWRnZXM9W10sdGhpcy5fc3BoZXJpY2FsRWRnZXM9W10sdGhpcy5fc2VxdWVuY2VFZGdlS2V5cz1bXTtmb3IobGV0IGkgb2YgZS5lZGdlcyl7bGV0IGU9aS5kYXRhLmRpcmVjdGlvbjt0aGlzLl9zdGVwRGlyZWN0aW9ucy5pbmRleE9mKGUpPi0xP3RoaXMuX3N0ZXBFZGdlcy5wdXNoKGkpOnRoaXMuX3R1cm5EaXJlY3Rpb25zLmluZGV4T2YoZSk+LTE/dGhpcy5fdHVybkVkZ2VzLnB1c2goaSk6aS5kYXRhLmRpcmVjdGlvbj09PXQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TcGhlcmljYWwmJnRoaXMuX3NwaGVyaWNhbEVkZ2VzLnB1c2goaSl9aWYodGhpcy5fZGlzdGluZ3Vpc2hTZXF1ZW5jZSYmbnVsbCE9aSl7bGV0IHQ9dGhpcy5fc3BoZXJpY2FsRWRnZXMuY29uY2F0KHRoaXMuX3N0ZXBFZGdlcykuY29uY2F0KHRoaXMuX3R1cm5FZGdlcyk7Zm9yKGxldCBlIG9mIHQpe2xldCB0PWUudGFyZ2V0O2ZvcihsZXQgZSBvZiBpLmltYWdlSWRzKWlmKGU9PT10KXt0aGlzLl9zZXF1ZW5jZUVkZ2VLZXlzLnB1c2godCk7YnJlYWt9fX19X2NyZWF0ZVNwaGVyaWNhbEFycm93cyh0LGUpe2xldCBpPVtdO2ZvcihsZXQgbiBvZiB0aGlzLl9zcGhlcmljYWxFZGdlcylpLnB1c2godGhpcy5fY3JlYXRlVk5vZGVCeUtleSh0LG4udGFyZ2V0LG4uZGF0YS53b3JsZE1vdGlvbkF6aW11dGgsZSx0aGlzLl9jYWxjdWxhdG9yLm91dGVyUmFkaXVzLFwibWFwaWxsYXJ5LWRpcmVjdGlvbi1hcnJvdy1zcGhlcmljYWxcIikpO2ZvcihsZXQgbiBvZiB0aGlzLl9zdGVwRWRnZXMpaS5wdXNoKHRoaXMuX2NyZWF0ZVNwaGVyaWNhbFRvUGVyc3BlY3RpdmVBcnJvdyh0LG4udGFyZ2V0LG4uZGF0YS53b3JsZE1vdGlvbkF6aW11dGgsZSxuLmRhdGEuZGlyZWN0aW9uKSk7cmV0dXJuIGl9X2NyZWF0ZVNwaGVyaWNhbFRvUGVyc3BlY3RpdmVBcnJvdyhlLGksbixyLHMpe2xldCBvPU1hdGguUEkvOCxhPXIucGhpO3N3aXRjaChzKXtjYXNlIHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwQmFja3dhcmQ6YT1yLnBoaS1NYXRoLlBJO2JyZWFrO2Nhc2UgdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBMZWZ0OmE9ci5waGkrTWF0aC5QSS8yO2JyZWFrO2Nhc2UgdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBSaWdodDphPXIucGhpLU1hdGguUEkvMn1yZXR1cm4gTWF0aC5hYnModGhpcy5fc3BhdGlhbC53cmFwQW5nbGUobi1hKSk8bz90aGlzLl9jcmVhdGVWTm9kZUJ5S2V5KGUsaSxuLHIsdGhpcy5fY2FsY3VsYXRvci5vdXRlclJhZGl1cyxcIm1hcGlsbGFyeS1kaXJlY3Rpb24tYXJyb3ctc3RlcFwiKTp0aGlzLl9jcmVhdGVWTm9kZUluYWN0aXZlKGksbixyKX1fY3JlYXRlUGVyc3BlY3RpdmVUb1NwaGVyaWNhbEFycm93cyh0LGUpe2xldCBpPVtdO2ZvcihsZXQgbiBvZiB0aGlzLl9zcGhlcmljYWxFZGdlcylpLnB1c2godGhpcy5fY3JlYXRlVk5vZGVCeUtleSh0LG4udGFyZ2V0LG4uZGF0YS53b3JsZE1vdGlvbkF6aW11dGgsZSx0aGlzLl9jYWxjdWxhdG9yLmlubmVyUmFkaXVzLFwibWFwaWxsYXJ5LWRpcmVjdGlvbi1hcnJvdy1zcGhlcmljYWxcIiwhMCkpO3JldHVybiBpfV9jcmVhdGVTdGVwQXJyb3dzKHQsZSl7bGV0IGk9W107Zm9yKGxldCBuIG9mIHRoaXMuX3N0ZXBFZGdlcylpLnB1c2godGhpcy5fY3JlYXRlVk5vZGVCeURpcmVjdGlvbih0LG4udGFyZ2V0LG4uZGF0YS53b3JsZE1vdGlvbkF6aW11dGgsZSxuLmRhdGEuZGlyZWN0aW9uKSk7cmV0dXJuIGl9X2NyZWF0ZVR1cm5BcnJvd3ModCl7bGV0IGU9W107Zm9yKGxldCBpIG9mIHRoaXMuX3R1cm5FZGdlcyl7bGV0IG49aS5kYXRhLmRpcmVjdGlvbixyPXRoaXMuX3R1cm5OYW1lc1tuXTtlLnB1c2godGhpcy5fY3JlYXRlVk5vZGVCeVR1cm4odCxpLnRhcmdldCxyLG4pKX1yZXR1cm4gZX1fY3JlYXRlVk5vZGVCeUtleSh0LGUsaSxuLHIscyxvKXtyZXR1cm4gdGhpcy5fY3JlYXRlVk5vZGUoZSxpLG4scixzLFwibWFwaWxsYXJ5LWRpcmVjdGlvbi1jaXJjbGVcIiwoaT0+e3QubW92ZVRvJChlKS5zdWJzY3JpYmUodm9pZCAwLCh0PT57dCBpbnN0YW5jZW9mIFpmfHxjb25zb2xlLmVycm9yKHQpfSkpfSksbyl9X2NyZWF0ZVZOb2RlQnlEaXJlY3Rpb24odCxlLGksbixyKXtyZXR1cm4gdGhpcy5fY3JlYXRlVk5vZGUoZSxpLG4sdGhpcy5fY2FsY3VsYXRvci5vdXRlclJhZGl1cyxcIm1hcGlsbGFyeS1kaXJlY3Rpb24tYXJyb3ctc3RlcFwiLFwibWFwaWxsYXJ5LWRpcmVjdGlvbi1jaXJjbGVcIiwoZT0+e3QubW92ZURpciQocikuc3Vic2NyaWJlKHZvaWQgMCwodD0+e3QgaW5zdGFuY2VvZiBaZnx8Y29uc29sZS5lcnJvcih0KX0pKX0pKX1fY3JlYXRlVk5vZGVCeVR1cm4oZSxpLG4scil7bGV0IHM9e2hlaWdodDp0aGlzLl9jYWxjdWxhdG9yLnR1cm5DaXJjbGVTaXplQ3NzLHRyYW5zZm9ybTpcInJvdGF0ZSgwKVwiLHdpZHRoOnRoaXMuX2NhbGN1bGF0b3IudHVybkNpcmNsZVNpemVDc3N9O3N3aXRjaChyKXtjYXNlIHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuTGVmdDpzLmxlZnQ9XCI1cHhcIixzLnRvcD1cIjVweFwiO2JyZWFrO2Nhc2UgdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5SaWdodDpzLnJpZ2h0PVwiNXB4XCIscy50b3A9XCI1cHhcIjticmVhaztjYXNlIHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuVTpzLmxlZnQ9XCI1cHhcIixzLmJvdHRvbT1cIjVweFwifWxldCBvPXthdHRyaWJ1dGVzOntcImRhdGEtaWRcIjppfSxvbmNsaWNrOnQ9PntlLm1vdmVEaXIkKHIpLnN1YnNjcmliZSh2b2lkIDAsKHQ9Pnt0IGluc3RhbmNlb2YgWmZ8fGNvbnNvbGUuZXJyb3IodCl9KSl9LHN0eWxlOnN9LGE9XCJtYXBpbGxhcnktZGlyZWN0aW9uLXR1cm4tY2lyY2xlXCI7dGhpcy5fc2VxdWVuY2VFZGdlS2V5cy5pbmRleE9mKGkpPi0xJiYoYSs9XCItc2VxdWVuY2VcIiksdGhpcy5faGlnaGxpZ2h0S2V5PT09aSYmKGErPVwiLWhpZ2hsaWdodFwiKTtsZXQgYz1qZi5oKGBkaXYuJHtufWAse30sW10pO3JldHVybiBqZi5oKFwiZGl2LlwiK2EsbyxbY10pfV9jcmVhdGVWTm9kZUluYWN0aXZlKHQsZSxpKXtyZXR1cm4gdGhpcy5fY3JlYXRlVk5vZGUodCxlLGksdGhpcy5fY2FsY3VsYXRvci5vdXRlclJhZGl1cyxcIm1hcGlsbGFyeS1kaXJlY3Rpb24tYXJyb3ctaW5hY3RpdmVcIixcIm1hcGlsbGFyeS1kaXJlY3Rpb24tY2lyY2xlLWluYWN0aXZlXCIpfV9jcmVhdGVWTm9kZSh0LGUsaSxuLHIscyxvLGEpe2xldCBjPXRoaXMuX2NhbGN1bGF0b3IuYW5nbGVUb0Nvb3JkaW5hdGVzKGUtaS5waGkpLGg9TWF0aC5yb3VuZCgtbipjWzFdKy41KnRoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVyV2lkdGgpLGw9TWF0aC5yb3VuZCgtbipjWzBdKy41KnRoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVySGVpZ2h0KSx1PXRoaXMuX2NhbGN1bGF0b3IucmVsYXRpdmVBbmdsZVRvQ29vcmRpYW50ZXMoZSxpLnBoaSksZD10aGlzLl9jYWxjdWxhdG9yLnNoYWRvd09mZnNldCxwPWBkcm9wLXNoYWRvdygkey1kKnVbMV19cHggJHtkKnVbMF19cHggMXB4IHJnYmEoMCwwLDAsMC44KSlgLGY9e3N0eWxlOntcIi13ZWJraXQtZmlsdGVyXCI6cCxmaWx0ZXI6cH19LG09amYuaChcImRpdi5cIityLGYsW10pLGc9LXRoaXMuX3NwYXRpYWwucmFkVG9EZWcoZS1pLnBoaSksXz1hP2B0cmFuc2xhdGUoJHtofXB4LCAke2x9cHgpIHJvdGF0ZSgke2d9ZGVnKSB0cmFuc2xhdGVaKC0wLjAxcHgpYDpgdHJhbnNsYXRlKCR7aH1weCwgJHtsfXB4KSByb3RhdGUoJHtnfWRlZylgLHY9e2F0dHJpYnV0ZXM6e1wiZGF0YS1pZFwiOnR9LG9uY2xpY2s6byxzdHlsZTp7aGVpZ2h0OnRoaXMuX2NhbGN1bGF0b3Iuc3RlcENpcmNsZVNpemVDc3MsbWFyZ2luTGVmdDp0aGlzLl9jYWxjdWxhdG9yLnN0ZXBDaXJjbGVNYXJnaW5Dc3MsbWFyZ2luVG9wOnRoaXMuX2NhbGN1bGF0b3Iuc3RlcENpcmNsZU1hcmdpbkNzcyx0cmFuc2Zvcm06Xyx3aWR0aDp0aGlzLl9jYWxjdWxhdG9yLnN0ZXBDaXJjbGVTaXplQ3NzfX07cmV0dXJuIHRoaXMuX3NlcXVlbmNlRWRnZUtleXMuaW5kZXhPZih0KT4tMSYmKHMrPVwiLXNlcXVlbmNlXCIpLHRoaXMuX2hpZ2hsaWdodEtleT09PXQmJihzKz1cIi1oaWdobGlnaHRcIiksamYuaChcImRpdi5cIitzLHYsW21dKX1fZ2V0Q29udGFpbmVyKHQsZSxpKXtsZXQgbj10aGlzLl9pc0VkZ2U/XCJyb3RhdGVYKDYwZGVnKVwiOmBwZXJzcGVjdGl2ZSgke3RoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVyV2lkdGhDc3N9KSByb3RhdGVYKDYwZGVnKWAscj17b25jb250ZXh0bWVudTp0PT57dC5wcmV2ZW50RGVmYXVsdCgpfSxzdHlsZTp7Ym90dG9tOnRoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVyQm90dG9tQ3NzLGhlaWdodDp0aGlzLl9jYWxjdWxhdG9yLmNvbnRhaW5lckhlaWdodENzcyxsZWZ0OnRoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVyTGVmdENzcyxtYXJnaW5MZWZ0OnRoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVyTWFyZ2luQ3NzLHRyYW5zZm9ybTpuLHdpZHRoOnRoaXMuX2NhbGN1bGF0b3IuY29udGFpbmVyV2lkdGhDc3N9fTtyZXR1cm4gamYuaChcImRpdi5tYXBpbGxhcnktZGlyZWN0aW9uLXBlcnNwZWN0aXZlXCIscixlLmNvbmNhdCh0KSl9fWNsYXNzIFFmIGV4dGVuZHMgVmZ7Y29uc3RydWN0b3IodCxlLGksbil7c3VwZXIodCxlLGkpLHRoaXMuX3JlbmRlcmVyPW58fG5ldyBLZih0aGlzLmRlZmF1bHRDb25maWd1cmF0aW9uLHtoZWlnaHQ6ZS5jb250YWluZXIub2Zmc2V0SGVpZ2h0LHdpZHRoOmUuY29udGFpbmVyLm9mZnNldFdpZHRofSksdGhpcy5faG92ZXJlZElkU3ViamVjdCQ9bmV3IFQsdGhpcy5faG92ZXJlZElkJD10aGlzLl9ob3ZlcmVkSWRTdWJqZWN0JC5waXBlKFplKCkpfWZpcmUodCxlKXtzdXBlci5maXJlKHQsZSl9b2ZmKHQsZSl7c3VwZXIub2ZmKHQsZSl9b24odCxlKXtzdXBlci5vbih0LGUpfV9hY3RpdmF0ZSgpe2NvbnN0IHQ9dGhpcy5fc3Vic2NyaXB0aW9uczt0LnB1c2godGhpcy5fY29uZmlndXJhdGlvbiQuc3Vic2NyaWJlKCh0PT57dGhpcy5fcmVuZGVyZXIuc2V0Q29uZmlndXJhdGlvbih0KX0pKSksdC5wdXNoKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnNpemUkLnN1YnNjcmliZSgodD0+e3RoaXMuX3JlbmRlcmVyLnJlc2l6ZSh0KX0pKSksdC5wdXNoKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJC5waXBlKHBpKCh0PT57dGhpcy5fY29udGFpbmVyLmRvbVJlbmRlcmVyLnJlbmRlciQubmV4dCh7bmFtZTp0aGlzLl9uYW1lLHZOb2RlOmpmLmgoXCJkaXZcIix7fSxbXSl9KSx0aGlzLl9yZW5kZXJlci5zZXRJbWFnZSh0KX0pKSxiaSh0aGlzLl9jb25maWd1cmF0aW9uJCkscmkoKChbdCxlXSk9Pmd0KHQuc3BhdGlhbEVkZ2VzJCxlLmRpc3Rpbmd1aXNoU2VxdWVuY2U/dGhpcy5fbmF2aWdhdG9yLmdyYXBoU2VydmljZS5jYWNoZVNlcXVlbmNlJCh0LnNlcXVlbmNlSWQpLnBpcGUodGUoKGU9Pihjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgc2VxdWVuY2UgKCR7dC5zZXF1ZW5jZUlkfSlgLGUpLEcobnVsbCkpKSkpOkcobnVsbCkpKSkpLnN1YnNjcmliZSgoKFt0LGVdKT0+e3RoaXMuX3JlbmRlcmVyLnNldEVkZ2VzKHQsZSl9KSkpLHQucHVzaCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmFGcmFtZSQucGlwZShwaSgodD0+e3RoaXMuX3JlbmRlcmVyLnNldFJlbmRlckNhbWVyYSh0KX0pKSxydCgoKCk9PnRoaXMuX3JlbmRlcmVyKSksTnQoKHQ9PnQubmVlZHNSZW5kZXIpKSxydCgodD0+KHtuYW1lOnRoaXMuX25hbWUsdk5vZGU6dC5yZW5kZXIodGhpcy5fbmF2aWdhdG9yKX0pKSkpLnN1YnNjcmliZSh0aGlzLl9jb250YWluZXIuZG9tUmVuZGVyZXIucmVuZGVyJCkpLHQucHVzaChndCh0aGlzLl9jb250YWluZXIuZG9tUmVuZGVyZXIuZWxlbWVudCQsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlTW92ZSQucGlwZShuaShudWxsKSksdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5tb3VzZVVwJC5waXBlKG5pKG51bGwpKSkucGlwZShydCgoKFt0XSk9PntsZXQgZT10LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJtYXBpbGxhcnktZGlyZWN0aW9uLXBlcnNwZWN0aXZlXCIpO2ZvcihsZXQgdD0wO3Q8ZS5sZW5ndGg7dCsrKXtsZXQgaT1lLml0ZW0odCkucXVlcnlTZWxlY3RvcihcIjpob3ZlclwiKTtpZihudWxsIT1pJiZpLmhhc0F0dHJpYnV0ZShcImRhdGEtaWRcIikpcmV0dXJuIGkuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKX1yZXR1cm4gbnVsbH0pKSx1ZSgpKS5zdWJzY3JpYmUodGhpcy5faG92ZXJlZElkU3ViamVjdCQpKSx0LnB1c2godGhpcy5faG92ZXJlZElkJC5zdWJzY3JpYmUoKHQ9Pntjb25zdCBlPVwiaG92ZXJcIixpPXtpZDp0LHRhcmdldDp0aGlzLHR5cGU6ZX07dGhpcy5maXJlKGUsaSl9KSkpfV9kZWFjdGl2YXRlKCl7dGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfV9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpe3JldHVybntkaXN0aW5ndWlzaFNlcXVlbmNlOiExLG1heFdpZHRoOjQ2MCxtaW5XaWR0aDoyNjB9fX1RZi5jb21wb25lbnROYW1lPVwiZGlyZWN0aW9uXCI7Y2xhc3MgdG17fXRtLmZpc2hleWU9e2ZyYWdtZW50OlwiXFxuI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbHNlXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgcHJvamVjdG9yVGV4O1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG51bmlmb3JtIGZsb2F0IGZvY2FsO1xcbnVuaWZvcm0gZmxvYXQgazE7XFxudW5pZm9ybSBmbG9hdCBrMjtcXG51bmlmb3JtIGZsb2F0IHNjYWxlX3g7XFxudW5pZm9ybSBmbG9hdCBzY2FsZV95O1xcbnVuaWZvcm0gZmxvYXQgcmFkaWFsX3BlYWs7XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICBmbG9hdCB4ID0gdlJzdHEueDtcXG4gICAgZmxvYXQgeSA9IHZSc3RxLnk7XFxuICAgIGZsb2F0IHogPSB2UnN0cS56O1xcblxcbiAgICBmbG9hdCByID0gc3FydCh4ICogeCArIHkgKiB5KTtcXG4gICAgZmxvYXQgdGhldGEgPSBhdGFuKHIsIHopO1xcblxcbiAgICBpZiAocmFkaWFsX3BlYWsgPiAwLiAmJiB0aGV0YSA+IHJhZGlhbF9wZWFrKSB7XFxuICAgICAgICB0aGV0YSA9IHJhZGlhbF9wZWFrO1xcbiAgICB9XFxuXFxuICAgIGZsb2F0IHRoZXRhMiA9IHRoZXRhICogdGhldGE7XFxuICAgIGZsb2F0IHRoZXRhX2QgPSB0aGV0YSAqICgxLjAgKyB0aGV0YTIgKiAoazEgKyB0aGV0YTIgKiBrMikpO1xcbiAgICBmbG9hdCBzID0gZm9jYWwgKiB0aGV0YV9kIC8gcjtcXG5cXG4gICAgZmxvYXQgdSA9IHNjYWxlX3ggKiBzICogeCArIDAuNTtcXG4gICAgZmxvYXQgdiA9IC1zY2FsZV95ICogcyAqIHkgKyAwLjU7XFxuXFxuICAgIHZlYzQgYmFzZUNvbG9yO1xcbiAgICBpZiAodSA+PSAwLiAmJiB1IDw9IDEuICYmIHYgPj0gMC4gJiYgdiA8PSAxLikge1xcbiAgICAgICAgYmFzZUNvbG9yID0gdGV4dHVyZTJEKHByb2plY3RvclRleCwgdmVjMih1LCB2KSk7XFxuICAgICAgICBiYXNlQ29sb3IuYSA9IG9wYWNpdHk7XFxuICAgIH0gZWxzZSB7XFxuICAgICAgICBiYXNlQ29sb3IgPSB2ZWM0KDAuMCwgMC4wLCAwLjAsIDAuMCk7XFxuICAgIH1cXG5cXG4gICAgZ2xfRnJhZ0NvbG9yID0gYmFzZUNvbG9yO1xcbn1cXG5cIix2ZXJ0ZXg6XCJcXG4jaWZkZWYgR0xfRVNcXG5wcmVjaXNpb24gaGlnaHAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudW5pZm9ybSBtYXQ0IHByb2plY3Rvck1hdDtcXG5cXG52YXJ5aW5nIHZlYzQgdlJzdHE7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICAgIHZSc3RxID0gcHJvamVjdG9yTWF0ICogdmVjNChwb3NpdGlvbiwgMS4wKTtcXG4gICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNChwb3NpdGlvbiwgMS4wKTtcXG59XFxuXCJ9LHRtLmZpc2hleWVDdXJ0YWluPXtmcmFnbWVudDpcIlxcbiNpZmRlZiBHTF9GUkFHTUVOVF9QUkVDSVNJT05fSElHSFxcbnByZWNpc2lvbiBoaWdocCBmbG9hdDtcXG4jZWxzZVxcbnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0O1xcbiNlbmRpZlxcblxcbnVuaWZvcm0gc2FtcGxlcjJEIHByb2plY3RvclRleDtcXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxudW5pZm9ybSBmbG9hdCBmb2NhbDtcXG51bmlmb3JtIGZsb2F0IGsxO1xcbnVuaWZvcm0gZmxvYXQgazI7XFxudW5pZm9ybSBmbG9hdCBzY2FsZV94O1xcbnVuaWZvcm0gZmxvYXQgc2NhbGVfeTtcXG51bmlmb3JtIGZsb2F0IHJhZGlhbF9wZWFrO1xcbnVuaWZvcm0gZmxvYXQgY3VydGFpbjtcXG5cXG52YXJ5aW5nIHZlYzQgdlJzdHE7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICAgIGZsb2F0IHggPSB2UnN0cS54O1xcbiAgICBmbG9hdCB5ID0gdlJzdHEueTtcXG4gICAgZmxvYXQgeiA9IHZSc3RxLno7XFxuXFxuICAgIGZsb2F0IHIyID0gc3FydCh4ICogeCArIHkgKiB5KTtcXG4gICAgZmxvYXQgdGhldGEgPSBhdGFuKHIyLCB6KTtcXG5cXG4gICAgaWYgKHJhZGlhbF9wZWFrID4gMC4gJiYgdGhldGEgPiByYWRpYWxfcGVhaykge1xcbiAgICAgICAgdGhldGEgPSByYWRpYWxfcGVhaztcXG4gICAgfVxcblxcbiAgICBmbG9hdCB0aGV0YTIgPSB0aGV0YSAqIHRoZXRhO1xcbiAgICBmbG9hdCB0aGV0YV9kID0gdGhldGEgKiAoMS4wICsgdGhldGEyICogKGsxICsgdGhldGEyICogazIpKTtcXG4gICAgZmxvYXQgcyA9IGZvY2FsICogdGhldGFfZCAvIHIyO1xcblxcbiAgICBmbG9hdCB1ID0gc2NhbGVfeCAqIHMgKiB4ICsgMC41O1xcbiAgICBmbG9hdCB2ID0gLXNjYWxlX3kgKiBzICogeSArIDAuNTtcXG5cXG4gICAgdmVjNCBiYXNlQ29sb3I7XFxuICAgIGlmICgodSA8IGN1cnRhaW4gfHwgY3VydGFpbiA+PSAxLjApICYmIHUgPj0gMC4gJiYgdSA8PSAxLiAmJiB2ID49IDAuICYmIHYgPD0gMS4pIHtcXG4gICAgICAgIGJhc2VDb2xvciA9IHRleHR1cmUyRChwcm9qZWN0b3JUZXgsIHZlYzIodSwgdikpO1xcbiAgICAgICAgYmFzZUNvbG9yLmEgPSBvcGFjaXR5O1xcbiAgICB9IGVsc2Uge1xcbiAgICAgICAgYmFzZUNvbG9yID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAwLjApO1xcbiAgICB9XFxuXFxuICAgIGdsX0ZyYWdDb2xvciA9IGJhc2VDb2xvcjtcXG59XFxuXCIsdmVydGV4OlwiXFxuI2lmZGVmIEdMX0VTXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbmRpZlxcblxcbnVuaWZvcm0gbWF0NCBwcm9qZWN0b3JNYXQ7XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICB2UnN0cSA9IHByb2plY3Rvck1hdCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxuICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxufVxcblwifSx0bS5wZXJzcGVjdGl2ZT17ZnJhZ21lbnQ6XCJcXG4jaWZkZWYgR0xfRlJBR01FTlRfUFJFQ0lTSU9OX0hJR0hcXG5wcmVjaXNpb24gaGlnaHAgZmxvYXQ7XFxuI2Vsc2VcXG5wcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcXG4jZW5kaWZcXG5cXG51bmlmb3JtIHNhbXBsZXIyRCBwcm9qZWN0b3JUZXg7XFxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xcbnVuaWZvcm0gZmxvYXQgZm9jYWw7XFxudW5pZm9ybSBmbG9hdCBrMTtcXG51bmlmb3JtIGZsb2F0IGsyO1xcbnVuaWZvcm0gZmxvYXQgc2NhbGVfeDtcXG51bmlmb3JtIGZsb2F0IHNjYWxlX3k7XFxudW5pZm9ybSBmbG9hdCByYWRpYWxfcGVhaztcXG5cXG52YXJ5aW5nIHZlYzQgdlJzdHE7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICAgIGZsb2F0IHggPSB2UnN0cS54IC8gdlJzdHEuejtcXG4gICAgZmxvYXQgeSA9IHZSc3RxLnkgLyB2UnN0cS56O1xcbiAgICBmbG9hdCByMiA9IHggKiB4ICsgeSAqIHk7XFxuXFxuICAgIGlmIChyYWRpYWxfcGVhayA+IDAuICYmIHIyID4gcmFkaWFsX3BlYWsgKiBzcXJ0KHIyKSkge1xcbiAgICAgICAgcjIgPSByYWRpYWxfcGVhayAqIHJhZGlhbF9wZWFrO1xcbiAgICB9XFxuXFxuICAgIGZsb2F0IGQgPSAxLjAgKyBrMSAqIHIyICsgazIgKiByMiAqIHIyO1xcbiAgICBmbG9hdCB1ID0gc2NhbGVfeCAqIGZvY2FsICogZCAqIHggKyAwLjU7XFxuICAgIGZsb2F0IHYgPSAtIHNjYWxlX3kgKiBmb2NhbCAqIGQgKiB5ICsgMC41O1xcblxcbiAgICB2ZWM0IGJhc2VDb2xvcjtcXG4gICAgaWYgKHUgPj0gMC4gJiYgdSA8PSAxLiAmJiB2ID49IDAuICYmIHYgPD0gMS4pIHtcXG4gICAgICAgIGJhc2VDb2xvciA9IHRleHR1cmUyRChwcm9qZWN0b3JUZXgsIHZlYzIodSwgdikpO1xcbiAgICAgICAgYmFzZUNvbG9yLmEgPSBvcGFjaXR5O1xcbiAgICB9IGVsc2Uge1xcbiAgICAgICAgYmFzZUNvbG9yID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAwLjApO1xcbiAgICB9XFxuXFxuICAgIGdsX0ZyYWdDb2xvciA9IGJhc2VDb2xvcjtcXG59XFxuXCIsdmVydGV4OlwiXFxuI2lmZGVmIEdMX0VTXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbmRpZlxcblxcbnVuaWZvcm0gbWF0NCBwcm9qZWN0b3JNYXQ7XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICB2UnN0cSA9IHByb2plY3Rvck1hdCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxuICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxufVxcblwifSx0bS5wZXJzcGVjdGl2ZUN1cnRhaW49e2ZyYWdtZW50OlwiXFxuI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbHNlXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgcHJvamVjdG9yVGV4O1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG51bmlmb3JtIGZsb2F0IGZvY2FsO1xcbnVuaWZvcm0gZmxvYXQgazE7XFxudW5pZm9ybSBmbG9hdCBrMjtcXG51bmlmb3JtIGZsb2F0IHNjYWxlX3g7XFxudW5pZm9ybSBmbG9hdCBzY2FsZV95O1xcbnVuaWZvcm0gZmxvYXQgcmFkaWFsX3BlYWs7XFxudW5pZm9ybSBmbG9hdCBjdXJ0YWluO1xcblxcbnZhcnlpbmcgdmVjNCB2UnN0cTtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gICAgZmxvYXQgeCA9IHZSc3RxLnggLyB2UnN0cS56O1xcbiAgICBmbG9hdCB5ID0gdlJzdHEueSAvIHZSc3RxLno7XFxuICAgIGZsb2F0IHIyID0geCAqIHggKyB5ICogeTtcXG5cXG4gICAgaWYgKHJhZGlhbF9wZWFrID4gMC4gJiYgcjIgPiByYWRpYWxfcGVhayAqIHNxcnQocjIpKSB7XFxuICAgICAgICByMiA9IHJhZGlhbF9wZWFrICogcmFkaWFsX3BlYWs7XFxuICAgIH1cXG5cXG4gICAgZmxvYXQgZCA9IDEuMCArIGsxICogcjIgKyBrMiAqIHIyICogcjI7XFxuICAgIGZsb2F0IHUgPSBzY2FsZV94ICogZm9jYWwgKiBkICogeCArIDAuNTtcXG4gICAgZmxvYXQgdiA9IC0gc2NhbGVfeSAqIGZvY2FsICogZCAqIHkgKyAwLjU7XFxuXFxuICAgIHZlYzQgYmFzZUNvbG9yO1xcbiAgICBpZiAoKHUgPCBjdXJ0YWluIHx8IGN1cnRhaW4gPj0gMS4wKSAmJiB1ID49IDAuICYmIHUgPD0gMS4gJiYgdiA+PSAwLiAmJiB2IDw9IDEuKSB7XFxuICAgICAgICBiYXNlQ29sb3IgPSB0ZXh0dXJlMkQocHJvamVjdG9yVGV4LCB2ZWMyKHUsIHYpKTtcXG4gICAgICAgIGJhc2VDb2xvci5hID0gb3BhY2l0eTtcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIGJhc2VDb2xvciA9IHZlYzQoMC4wLCAwLjAsIDAuMCwgMC4wKTtcXG4gICAgfVxcblxcbiAgICBnbF9GcmFnQ29sb3IgPSBiYXNlQ29sb3I7XFxufVxcblwiLHZlcnRleDpcIlxcbiNpZmRlZiBHTF9FU1xcbnByZWNpc2lvbiBoaWdocCBmbG9hdDtcXG4jZW5kaWZcXG5cXG51bmlmb3JtIG1hdDQgcHJvamVjdG9yTWF0O1xcblxcbnZhcnlpbmcgdmVjNCB2UnN0cTtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gICAgdlJzdHEgPSBwcm9qZWN0b3JNYXQgKiB2ZWM0KHBvc2l0aW9uLCAxLjApO1xcbiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KHBvc2l0aW9uLCAxLjApO1xcbn1cXG5cIn0sdG0ucGVyc3BlY3RpdmVEaXN0b3J0ZWQ9e2ZyYWdtZW50OlwiXFxuI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbHNlXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgcHJvamVjdG9yVGV4O1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG5cXG52YXJ5aW5nIHZlYzQgdlJzdHE7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICAgIGZsb2F0IHUgPSB2UnN0cS54IC8gdlJzdHEudztcXG4gICAgZmxvYXQgdiA9IHZSc3RxLnkgLyB2UnN0cS53O1xcblxcbiAgICB2ZWM0IGJhc2VDb2xvcjtcXG4gICAgaWYgKHUgPj0gMC4gJiYgdSA8PSAxLiAmJiB2ID49IDAuICYmIHYgPD0gMS4pIHtcXG4gICAgICAgIGJhc2VDb2xvciA9IHRleHR1cmUyRChwcm9qZWN0b3JUZXgsIHZlYzIodSwgdikpO1xcbiAgICAgICAgYmFzZUNvbG9yLmEgPSBvcGFjaXR5O1xcbiAgICB9IGVsc2Uge1xcbiAgICAgICAgYmFzZUNvbG9yID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAwLjApO1xcbiAgICB9XFxuXFxuICAgIGdsX0ZyYWdDb2xvciA9IGJhc2VDb2xvcjtcXG59XFxuXCIsdmVydGV4OlwiXFxuI2lmZGVmIEdMX0VTXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbmRpZlxcblxcbnVuaWZvcm0gbWF0NCBwcm9qZWN0b3JNYXQ7XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICB2UnN0cSA9IHByb2plY3Rvck1hdCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxuICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxufVxcblwifSx0bS5wZXJzcGVjdGl2ZURpc3RvcnRlZEN1cnRhaW49e2ZyYWdtZW50OlwiXFxuI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbHNlXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudW5pZm9ybSBzYW1wbGVyMkQgcHJvamVjdG9yVGV4O1xcbnVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcXG51bmlmb3JtIGZsb2F0IGN1cnRhaW47XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICBmbG9hdCB1ID0gdlJzdHEueCAvIHZSc3RxLnc7XFxuICAgIGZsb2F0IHYgPSB2UnN0cS55IC8gdlJzdHEudztcXG5cXG4gICAgdmVjNCBiYXNlQ29sb3I7XFxuICAgIGlmICgodSA8IGN1cnRhaW4gfHwgY3VydGFpbiA+PSAxLjApICYmIHUgPj0gMC4gJiYgdSA8PSAxLiAmJiB2ID49IDAuICYmIHYgPD0gMS4pIHtcXG4gICAgICAgIGJhc2VDb2xvciA9IHRleHR1cmUyRChwcm9qZWN0b3JUZXgsIHZlYzIodSwgdikpO1xcbiAgICAgICAgYmFzZUNvbG9yLmEgPSBvcGFjaXR5O1xcbiAgICB9IGVsc2Uge1xcbiAgICAgICAgYmFzZUNvbG9yID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAwLjApO1xcbiAgICB9XFxuXFxuICAgIGdsX0ZyYWdDb2xvciA9IGJhc2VDb2xvcjtcXG59XFxuXCIsdmVydGV4OlwiXFxuI2lmZGVmIEdMX0VTXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbmRpZlxcblxcbnVuaWZvcm0gbWF0NCBwcm9qZWN0b3JNYXQ7XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICB2UnN0cSA9IHByb2plY3Rvck1hdCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxuICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XFxufVxcblwifSx0bS5zcGhlcmljYWw9e2ZyYWdtZW50OlwiXFxuI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbHNlXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxuI2RlZmluZSB0YXUgNi4yODMxODUzMDcxOFxcblxcbnVuaWZvcm0gc2FtcGxlcjJEIHByb2plY3RvclRleDtcXG51bmlmb3JtIGZsb2F0IG9wYWNpdHk7XFxuXFxudmFyeWluZyB2ZWM0IHZSc3RxO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgICB2ZWMzIGIgPSBub3JtYWxpemUodlJzdHEueHl6KTtcXG4gICAgZmxvYXQgbGF0ID0gLWFzaW4oYi55KTtcXG4gICAgZmxvYXQgbG5nID0gYXRhbihiLngsIGIueik7XFxuICAgIGZsb2F0IHggPSBsbmcgLyB0YXUgKyAwLjU7XFxuICAgIGZsb2F0IHkgPSBsYXQgLyB0YXUgKiAyLjAgKyAwLjU7XFxuICAgIHZlYzQgYmFzZUNvbG9yID0gdGV4dHVyZTJEKHByb2plY3RvclRleCwgdmVjMih4LCB5KSk7XFxuICAgIGJhc2VDb2xvci5hID0gb3BhY2l0eTtcXG4gICAgZ2xfRnJhZ0NvbG9yID0gYmFzZUNvbG9yO1xcbn1cXG5cIix2ZXJ0ZXg6XCJcXG4jaWZkZWYgR0xfRVNcXG5wcmVjaXNpb24gaGlnaHAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxudW5pZm9ybSBtYXQ0IHByb2plY3Rvck1hdDtcXG5cXG52YXJ5aW5nIHZlYzQgdlJzdHE7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICAgIHZSc3RxID0gcHJvamVjdG9yTWF0ICogdmVjNChwb3NpdGlvbiwgMS4wKTtcXG4gICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNChwb3NpdGlvbiwgMS4wKTtcXG59XFxuXCJ9LHRtLnNwaGVyaWNhbEN1cnRhaW49e2ZyYWdtZW50OlwiXFxuI2lmZGVmIEdMX0ZSQUdNRU5UX1BSRUNJU0lPTl9ISUdIXFxucHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcbiNlbHNlXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuI2VuZGlmXFxuXFxuI2RlZmluZSB0YXUgNi4yODMxODUzMDcxOFxcblxcbnVuaWZvcm0gc2FtcGxlcjJEIHByb2plY3RvclRleDtcXG51bmlmb3JtIGZsb2F0IGN1cnRhaW47XFxudW5pZm9ybSBmbG9hdCBvcGFjaXR5O1xcblxcbnZhcnlpbmcgdmVjNCB2UnN0cTtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gICAgdmVjMyBiID0gbm9ybWFsaXplKHZSc3RxLnh5eik7XFxuICAgIGZsb2F0IGxhdCA9IC1hc2luKGIueSk7XFxuICAgIGZsb2F0IGxuZyA9IGF0YW4oYi54LCBiLnopO1xcbiAgICBmbG9hdCB4ID0gbG5nIC8gdGF1ICsgMC41O1xcbiAgICBmbG9hdCB5ID0gbGF0IC8gdGF1ICogMi4wICsgMC41O1xcblxcbiAgICBib29sIGludmVydGVkID0gY3VydGFpbiA8IDAuNTtcXG5cXG4gICAgZmxvYXQgY3VydGFpbk1pbiA9IGludmVydGVkID8gY3VydGFpbiArIDAuNSA6IGN1cnRhaW4gLSAwLjU7XFxuICAgIGZsb2F0IGN1cnRhaW5NYXggPSBjdXJ0YWluO1xcblxcbiAgICBib29sIGluc2lkZUN1cnRhaW4gPSBpbnZlcnRlZCA/XFxuICAgICAgICB4ID4gY3VydGFpbk1pbiB8fCB4IDwgY3VydGFpbk1heCA6XFxuICAgICAgICB4ID4gY3VydGFpbk1pbiAmJiB4IDwgY3VydGFpbk1heDtcXG5cXG4gICAgdmVjNCBiYXNlQ29sb3I7XFxuICAgIGlmIChpbnNpZGVDdXJ0YWluKSB7XFxuICAgICAgICBiYXNlQ29sb3IgPSB0ZXh0dXJlMkQocHJvamVjdG9yVGV4LCB2ZWMyKHgsIHkpKTtcXG4gICAgICAgIGJhc2VDb2xvci5hID0gb3BhY2l0eTtcXG4gICAgfSBlbHNlIHtcXG4gICAgICAgIGJhc2VDb2xvciA9IHZlYzQoMC4wLCAwLjAsIDAuMCwgMC4wKTtcXG4gICAgfVxcblxcbiAgICBnbF9GcmFnQ29sb3IgPSBiYXNlQ29sb3I7XFxufVxcblwiLHZlcnRleDpcIlxcbiNpZmRlZiBHTF9FU1xcbnByZWNpc2lvbiBoaWdocCBmbG9hdDtcXG4jZW5kaWZcXG5cXG51bmlmb3JtIG1hdDQgcHJvamVjdG9yTWF0O1xcblxcbnZhcnlpbmcgdmVjNCB2UnN0cTtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gICAgdlJzdHEgPSBwcm9qZWN0b3JNYXQgKiB2ZWM0KHBvc2l0aW9uLCAxLjApO1xcbiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KHBvc2l0aW9uLCAxLjApO1xcbn1cXG5cIn07Y2xhc3MgZW17Y29uc3RydWN0b3IodCxlKXt0aGlzLl9pbWFnZVBsYW5lRGVwdGg9bnVsbCE9dD90OjIwMCx0aGlzLl9pbWFnZVNwaGVyZVJhZGl1cz1udWxsIT1lP2U6MjAwfWNyZWF0ZU1lc2godCxlKXtyZXR1cm4gZGQoZS5jYW1lcmFUeXBlKT90aGlzLl9jcmVhdGVJbWFnZVNwaGVyZSh0LGUpOnBkKGUuY2FtZXJhVHlwZSk/dGhpcy5fY3JlYXRlSW1hZ2VQbGFuZUZpc2hleWUodCxlKTp0aGlzLl9jcmVhdGVJbWFnZVBsYW5lKHQsZSl9Y3JlYXRlRmxhdE1lc2godCxlLGksbixyLHMpe2xldCBvPXRoaXMuX2NyZWF0ZVRleHR1cmUodC5pbWFnZSksYT1uZXcgT3ModGhpcy5fY3JlYXRlRGlzdG9ydGVkUGxhbmVNYXRlcmlhbFBhcmFtZXRlcnMoZSxvKSk7cmV0dXJuIG5ldyBFcyh0aGlzLl9nZXRGbGF0SW1hZ2VQbGFuZUdlb0Zyb21CYXNpYyhlLGksbixyLHMpLGEpfWNyZWF0ZUN1cnRhaW5NZXNoKHQsZSl7cmV0dXJuIGRkKGUuY2FtZXJhVHlwZSk/dGhpcy5fY3JlYXRlU3BoZXJlQ3VydGFpbk1lc2godCxlKTpwZChlLmNhbWVyYVR5cGUpP3RoaXMuX2NyZWF0ZUN1cnRhaW5NZXNoRmlzaGV5ZSh0LGUpOnRoaXMuX2NyZWF0ZUN1cnRhaW5NZXNoKHQsZSl9Y3JlYXRlRGlzdG9ydGVkQ3VydGFpbk1lc2godCxlKXtyZXR1cm4gdGhpcy5fY3JlYXRlRGlzdG9ydGVkQ3VydGFpbk1lc2godCxlKX1fY3JlYXRlQ3VydGFpbk1lc2godCxlKXtsZXQgaT10aGlzLl9jcmVhdGVUZXh0dXJlKHQuaW1hZ2UpLG49bmV3IE9zKHRoaXMuX2NyZWF0ZUN1cnRhaW5QbGFuZU1hdGVyaWFsUGFyYW1ldGVycyhlLGkpKTtyZXR1cm4gbmV3IEVzKHRoaXMuX3VzZU1lc2goZSx0KT90aGlzLl9nZXRJbWFnZVBsYW5lR2VvKGUsdCk6dGhpcy5fZ2V0UmVndWxhckZsYXRJbWFnZVBsYW5lR2VvKGUpLG4pfV9jcmVhdGVDdXJ0YWluTWVzaEZpc2hleWUodCxlKXtsZXQgaT10aGlzLl9jcmVhdGVUZXh0dXJlKHQuaW1hZ2UpLG49bmV3IE9zKHRoaXMuX2NyZWF0ZUN1cnRhaW5QbGFuZU1hdGVyaWFsUGFyYW1ldGVyc0Zpc2hleWUoZSxpKSk7cmV0dXJuIG5ldyBFcyh0aGlzLl91c2VNZXNoKGUsdCk/dGhpcy5fZ2V0SW1hZ2VQbGFuZUdlb0Zpc2hleWUoZSx0KTp0aGlzLl9nZXRSZWd1bGFyRmxhdEltYWdlUGxhbmVHZW8oZSksbil9X2NyZWF0ZURpc3RvcnRlZEN1cnRhaW5NZXNoKHQsZSl7bGV0IGk9dGhpcy5fY3JlYXRlVGV4dHVyZSh0LmltYWdlKSxuPW5ldyBPcyh0aGlzLl9jcmVhdGVEaXN0b3J0ZWRDdXJ0YWluUGxhbmVNYXRlcmlhbFBhcmFtZXRlcnMoZSxpKSk7cmV0dXJuIG5ldyBFcyh0aGlzLl9nZXRSZWd1bGFyRmxhdEltYWdlUGxhbmVHZW8oZSksbil9X2NyZWF0ZVNwaGVyZUN1cnRhaW5NZXNoKHQsZSl7bGV0IGk9dGhpcy5fY3JlYXRlVGV4dHVyZSh0LmltYWdlKSxuPW5ldyBPcyh0aGlzLl9jcmVhdGVDdXJ0YWluU3BoZXJlTWF0ZXJpYWxQYXJhbWV0ZXJzKGUsaSkpO3JldHVybiB0aGlzLl91c2VNZXNoKGUsdCk/bmV3IEVzKHRoaXMuX2dldEltYWdlU3BoZXJlR2VvKGUsdCksbik6bmV3IEVzKHRoaXMuX2dldEZsYXRJbWFnZVNwaGVyZUdlbyhlKSxuKX1fY3JlYXRlSW1hZ2VTcGhlcmUodCxlKXtsZXQgaT10aGlzLl9jcmVhdGVUZXh0dXJlKHQuaW1hZ2UpLG49bmV3IE9zKHRoaXMuX2NyZWF0ZVNwaGVyZU1hdGVyaWFsUGFyYW1ldGVycyhlLGkpKTtyZXR1cm4gdGhpcy5fdXNlTWVzaChlLHQpP25ldyBFcyh0aGlzLl9nZXRJbWFnZVNwaGVyZUdlbyhlLHQpLG4pOm5ldyBFcyh0aGlzLl9nZXRGbGF0SW1hZ2VTcGhlcmVHZW8oZSksbil9X2NyZWF0ZUltYWdlUGxhbmUodCxlKXtsZXQgaT10aGlzLl9jcmVhdGVUZXh0dXJlKHQuaW1hZ2UpLG49bmV3IE9zKHRoaXMuX2NyZWF0ZVBsYW5lTWF0ZXJpYWxQYXJhbWV0ZXJzKGUsaSkpO3JldHVybiBuZXcgRXModGhpcy5fdXNlTWVzaChlLHQpP3RoaXMuX2dldEltYWdlUGxhbmVHZW8oZSx0KTp0aGlzLl9nZXRSZWd1bGFyRmxhdEltYWdlUGxhbmVHZW8oZSksbil9X2NyZWF0ZUltYWdlUGxhbmVGaXNoZXllKHQsZSl7bGV0IGk9dGhpcy5fY3JlYXRlVGV4dHVyZSh0LmltYWdlKSxuPW5ldyBPcyh0aGlzLl9jcmVhdGVQbGFuZU1hdGVyaWFsUGFyYW1ldGVyc0Zpc2hleWUoZSxpKSk7cmV0dXJuIG5ldyBFcyh0aGlzLl91c2VNZXNoKGUsdCk/dGhpcy5fZ2V0SW1hZ2VQbGFuZUdlb0Zpc2hleWUoZSx0KTp0aGlzLl9nZXRSZWd1bGFyRmxhdEltYWdlUGxhbmVHZW9GaXNoZXllKGUpLG4pfV9jcmVhdGVTcGhlcmVNYXRlcmlhbFBhcmFtZXRlcnModCxlKXtyZXR1cm57ZGVwdGhXcml0ZTohMSxmcmFnbWVudFNoYWRlcjp0bS5zcGhlcmljYWwuZnJhZ21lbnQsc2lkZToyLHRyYW5zcGFyZW50OiEwLHVuaWZvcm1zOntvcGFjaXR5Ont2YWx1ZToxfSxwcm9qZWN0b3JNYXQ6e3ZhbHVlOnQucnR9LHByb2plY3RvclRleDp7dmFsdWU6ZX19LHZlcnRleFNoYWRlcjp0bS5zcGhlcmljYWwudmVydGV4fX1fY3JlYXRlQ3VydGFpblNwaGVyZU1hdGVyaWFsUGFyYW1ldGVycyh0LGUpe3JldHVybntkZXB0aFdyaXRlOiExLGZyYWdtZW50U2hhZGVyOnRtLnNwaGVyaWNhbEN1cnRhaW4uZnJhZ21lbnQsc2lkZToyLHRyYW5zcGFyZW50OiEwLHVuaWZvcm1zOntjdXJ0YWluOnt2YWx1ZToxfSxvcGFjaXR5Ont2YWx1ZToxfSxwcm9qZWN0b3JNYXQ6e3ZhbHVlOnQucnR9LHByb2plY3RvclRleDp7dmFsdWU6ZX19LHZlcnRleFNoYWRlcjp0bS5zcGhlcmljYWxDdXJ0YWluLnZlcnRleH19X2NyZWF0ZVBsYW5lTWF0ZXJpYWxQYXJhbWV0ZXJzKHQsZSl7cmV0dXJue2RlcHRoV3JpdGU6ITEsZnJhZ21lbnRTaGFkZXI6dG0ucGVyc3BlY3RpdmUuZnJhZ21lbnQsc2lkZToyLHRyYW5zcGFyZW50OiEwLHVuaWZvcm1zOntmb2NhbDp7dmFsdWU6dC5mb2NhbH0sazE6e3ZhbHVlOnQuY2sxfSxrMjp7dmFsdWU6dC5jazJ9LG9wYWNpdHk6e3ZhbHVlOjF9LHByb2plY3Rvck1hdDp7dmFsdWU6dC5iYXNpY1J0fSxwcm9qZWN0b3JUZXg6e3ZhbHVlOmV9LHJhZGlhbF9wZWFrOnt2YWx1ZTp0LnJhZGlhbFBlYWs/dC5yYWRpYWxQZWFrOjB9LHNjYWxlX3g6e3ZhbHVlOk1hdGgubWF4KHQuYmFzaWNIZWlnaHQsdC5iYXNpY1dpZHRoKS90LmJhc2ljV2lkdGh9LHNjYWxlX3k6e3ZhbHVlOk1hdGgubWF4KHQuYmFzaWNXaWR0aCx0LmJhc2ljSGVpZ2h0KS90LmJhc2ljSGVpZ2h0fX0sdmVydGV4U2hhZGVyOnRtLnBlcnNwZWN0aXZlLnZlcnRleH19X2NyZWF0ZVBsYW5lTWF0ZXJpYWxQYXJhbWV0ZXJzRmlzaGV5ZSh0LGUpe3JldHVybntkZXB0aFdyaXRlOiExLGZyYWdtZW50U2hhZGVyOnRtLmZpc2hleWUuZnJhZ21lbnQsc2lkZToyLHRyYW5zcGFyZW50OiEwLHVuaWZvcm1zOntmb2NhbDp7dmFsdWU6dC5mb2NhbH0sazE6e3ZhbHVlOnQuY2sxfSxrMjp7dmFsdWU6dC5jazJ9LG9wYWNpdHk6e3ZhbHVlOjF9LHByb2plY3Rvck1hdDp7dmFsdWU6dC5iYXNpY1J0fSxwcm9qZWN0b3JUZXg6e3ZhbHVlOmV9LHJhZGlhbF9wZWFrOnt2YWx1ZTp0LnJhZGlhbFBlYWs/dC5yYWRpYWxQZWFrOjB9LHNjYWxlX3g6e3ZhbHVlOk1hdGgubWF4KHQuYmFzaWNIZWlnaHQsdC5iYXNpY1dpZHRoKS90LmJhc2ljV2lkdGh9LHNjYWxlX3k6e3ZhbHVlOk1hdGgubWF4KHQuYmFzaWNXaWR0aCx0LmJhc2ljSGVpZ2h0KS90LmJhc2ljSGVpZ2h0fX0sdmVydGV4U2hhZGVyOnRtLmZpc2hleWUudmVydGV4fX1fY3JlYXRlQ3VydGFpblBsYW5lTWF0ZXJpYWxQYXJhbWV0ZXJzRmlzaGV5ZSh0LGUpe3JldHVybntkZXB0aFdyaXRlOiExLGZyYWdtZW50U2hhZGVyOnRtLmZpc2hleWVDdXJ0YWluLmZyYWdtZW50LHNpZGU6Mix0cmFuc3BhcmVudDohMCx1bmlmb3Jtczp7Y3VydGFpbjp7dmFsdWU6MX0sZm9jYWw6e3ZhbHVlOnQuZm9jYWx9LGsxOnt2YWx1ZTp0LmNrMX0sazI6e3ZhbHVlOnQuY2syfSxvcGFjaXR5Ont2YWx1ZToxfSxwcm9qZWN0b3JNYXQ6e3ZhbHVlOnQuYmFzaWNSdH0scHJvamVjdG9yVGV4Ont2YWx1ZTplfSxyYWRpYWxfcGVhazp7dmFsdWU6dC5yYWRpYWxQZWFrP3QucmFkaWFsUGVhazowfSxzY2FsZV94Ont2YWx1ZTpNYXRoLm1heCh0LmJhc2ljSGVpZ2h0LHQuYmFzaWNXaWR0aCkvdC5iYXNpY1dpZHRofSxzY2FsZV95Ont2YWx1ZTpNYXRoLm1heCh0LmJhc2ljV2lkdGgsdC5iYXNpY0hlaWdodCkvdC5iYXNpY0hlaWdodH19LHZlcnRleFNoYWRlcjp0bS5maXNoZXllQ3VydGFpbi52ZXJ0ZXh9fV9jcmVhdGVDdXJ0YWluUGxhbmVNYXRlcmlhbFBhcmFtZXRlcnModCxlKXtyZXR1cm57ZGVwdGhXcml0ZTohMSxmcmFnbWVudFNoYWRlcjp0bS5wZXJzcGVjdGl2ZUN1cnRhaW4uZnJhZ21lbnQsc2lkZToyLHRyYW5zcGFyZW50OiEwLHVuaWZvcm1zOntjdXJ0YWluOnt2YWx1ZToxfSxmb2NhbDp7dmFsdWU6dC5mb2NhbH0sazE6e3ZhbHVlOnQuY2sxfSxrMjp7dmFsdWU6dC5jazJ9LG9wYWNpdHk6e3ZhbHVlOjF9LHByb2plY3Rvck1hdDp7dmFsdWU6dC5iYXNpY1J0fSxwcm9qZWN0b3JUZXg6e3ZhbHVlOmV9LHJhZGlhbF9wZWFrOnt2YWx1ZTp0LnJhZGlhbFBlYWs/dC5yYWRpYWxQZWFrOjB9LHNjYWxlX3g6e3ZhbHVlOk1hdGgubWF4KHQuYmFzaWNIZWlnaHQsdC5iYXNpY1dpZHRoKS90LmJhc2ljV2lkdGh9LHNjYWxlX3k6e3ZhbHVlOk1hdGgubWF4KHQuYmFzaWNXaWR0aCx0LmJhc2ljSGVpZ2h0KS90LmJhc2ljSGVpZ2h0fX0sdmVydGV4U2hhZGVyOnRtLnBlcnNwZWN0aXZlQ3VydGFpbi52ZXJ0ZXh9fV9jcmVhdGVEaXN0b3J0ZWRDdXJ0YWluUGxhbmVNYXRlcmlhbFBhcmFtZXRlcnModCxlKXtyZXR1cm57ZGVwdGhXcml0ZTohMSxmcmFnbWVudFNoYWRlcjp0bS5wZXJzcGVjdGl2ZURpc3RvcnRlZEN1cnRhaW4uZnJhZ21lbnQsc2lkZToyLHRyYW5zcGFyZW50OiEwLHVuaWZvcm1zOntjdXJ0YWluOnt2YWx1ZToxfSxvcGFjaXR5Ont2YWx1ZToxfSxwcm9qZWN0b3JNYXQ6e3ZhbHVlOnQucHJvamVjdG9yTWF0cml4KCl9LHByb2plY3RvclRleDp7dmFsdWU6ZX19LHZlcnRleFNoYWRlcjp0bS5wZXJzcGVjdGl2ZURpc3RvcnRlZEN1cnRhaW4udmVydGV4fX1fY3JlYXRlRGlzdG9ydGVkUGxhbmVNYXRlcmlhbFBhcmFtZXRlcnModCxlKXtyZXR1cm57ZGVwdGhXcml0ZTohMSxmcmFnbWVudFNoYWRlcjp0bS5wZXJzcGVjdGl2ZURpc3RvcnRlZC5mcmFnbWVudCxzaWRlOjIsdHJhbnNwYXJlbnQ6ITAsdW5pZm9ybXM6e29wYWNpdHk6e3ZhbHVlOjF9LHByb2plY3Rvck1hdDp7dmFsdWU6dC5wcm9qZWN0b3JNYXRyaXgoKX0scHJvamVjdG9yVGV4Ont2YWx1ZTplfX0sdmVydGV4U2hhZGVyOnRtLnBlcnNwZWN0aXZlRGlzdG9ydGVkLnZlcnRleH19X2NyZWF0ZVRleHR1cmUodCl7bGV0IGU9bmV3IGhuKHQpO3JldHVybiBlLm1pbkZpbHRlcj1BaSxlLm5lZWRzVXBkYXRlPSEwLGV9X3VzZU1lc2godCxlKXtyZXR1cm4gZS5tZXNoLnZlcnRpY2VzLmxlbmd0aCYmdC5oYXNWYWxpZFNjYWxlfV9nZXRJbWFnZVNwaGVyZUdlbyh0LGUpe2NvbnN0IGk9dC5zcnRJbnZlcnNlO2xldCBuPTUqdC5zY2FsZSxyPXRoaXMuX2ltYWdlU3BoZXJlUmFkaXVzKnQuc2NhbGUscz1lLm1lc2gudmVydGljZXMsbz1zLmxlbmd0aC8zLGE9bmV3IEZsb2F0MzJBcnJheShzLmxlbmd0aCk7Zm9yKGxldCB0PTA7dDxvOysrdCl7bGV0IGU9Myp0LG89c1tlKzBdLGM9c1tlKzFdLGg9c1tlKzJdLGw9TWF0aC5zcXJ0KG8qbytjKmMraCpoKSx1PU1hdGgubWF4KG4sTWF0aC5taW4obCxyKSkvbCxkPW5ldyBmbihvKnUsYyp1LGgqdSk7ZC5hcHBseU1hdHJpeDQoaSksYVtlKzBdPWQueCxhW2UrMV09ZC55LGFbZSsyXT1kLnp9bGV0IGM9ZS5tZXNoLmZhY2VzLGg9bmV3IFVpbnQxNkFycmF5KGMubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PGMubGVuZ3RoOysrdCloW3RdPWNbdF07bGV0IGw9bmV3IGhzO3JldHVybiBsLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEhyKGEsMykpLGwuc2V0SW5kZXgobmV3IEhyKGgsMSkpLGx9X2dldEltYWdlUGxhbmVHZW8odCxlKXtjb25zdCBpPXQuc3J0SW52ZXJzZTtsZXQgbj01KnQuc2NhbGUscj10aGlzLl9pbWFnZVBsYW5lRGVwdGgqdC5zY2FsZSxzPWUubWVzaC52ZXJ0aWNlcyxvPXMubGVuZ3RoLzMsYT1uZXcgRmxvYXQzMkFycmF5KHMubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PG87Kyt0KXtsZXQgZT0zKnQsbz1zW2UrMF0sYz1zW2UrMV0saD1zW2UrMl07dDw0JiYobyo9MyxjKj0zKTtsZXQgbD1NYXRoLm1heChuLE1hdGgubWluKGgscikpLHU9bC9oLGQ9bmV3IGZuKG8qdSxjKnUsbCk7ZC5hcHBseU1hdHJpeDQoaSksYVtlKzBdPWQueCxhW2UrMV09ZC55LGFbZSsyXT1kLnp9bGV0IGM9ZS5tZXNoLmZhY2VzLGg9bmV3IFVpbnQxNkFycmF5KGMubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PGMubGVuZ3RoOysrdCloW3RdPWNbdF07bGV0IGw9bmV3IGhzO3JldHVybiBsLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEhyKGEsMykpLGwuc2V0SW5kZXgobmV3IEhyKGgsMSkpLGx9X2dldEltYWdlUGxhbmVHZW9GaXNoZXllKHQsZSl7Y29uc3QgaT10LnNydEludmVyc2U7bGV0IG49NSp0LnNjYWxlLHI9dGhpcy5faW1hZ2VQbGFuZURlcHRoKnQuc2NhbGUscz1lLm1lc2gudmVydGljZXMsbz1zLmxlbmd0aC8zLGE9bmV3IEZsb2F0MzJBcnJheShzLmxlbmd0aCk7Zm9yKGxldCB0PTA7dDxvOysrdCl7bGV0IGU9Myp0LG89c1tlKzBdLGM9c1tlKzFdLGg9c1tlKzJdLGw9TWF0aC5zcXJ0KG8qbytjKmMraCpoKSx1PU1hdGgubWF4KG4sTWF0aC5taW4obCxyKSkvbCxkPW5ldyBmbihvKnUsYyp1LGgqdSk7ZC5hcHBseU1hdHJpeDQoaSksYVtlKzBdPWQueCxhW2UrMV09ZC55LGFbZSsyXT1kLnp9bGV0IGM9ZS5tZXNoLmZhY2VzLGg9bmV3IFVpbnQxNkFycmF5KGMubGVuZ3RoKTtmb3IobGV0IHQ9MDt0PGMubGVuZ3RoOysrdCloW3RdPWNbdF07bGV0IGw9bmV3IGhzO3JldHVybiBsLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEhyKGEsMykpLGwuc2V0SW5kZXgobmV3IEhyKGgsMSkpLGx9X2dldEZsYXRJbWFnZVNwaGVyZUdlbyh0KXtjb25zdCBlPW5ldyB6aCh0aGlzLl9pbWFnZVNwaGVyZVJhZGl1cywyMCw0MCksaT10LnJ0LmNsb25lKCkuaW52ZXJ0KCk7cmV0dXJuIGUuYXBwbHlNYXRyaXg0KGkpLGV9X2dldFJlZ3VsYXJGbGF0SW1hZ2VQbGFuZUdlbyh0KXtsZXQgZT10LndpZHRoLGk9dC5oZWlnaHQsbj1NYXRoLm1heChlLGkpLHI9ZS8yL24scz1pLzIvbjtyZXR1cm4gdGhpcy5fZ2V0RmxhdEltYWdlUGxhbmVHZW8odCxyLHMpfV9nZXRGbGF0SW1hZ2VQbGFuZUdlbyh0LGUsaSl7bGV0IG49W107cmV0dXJuIG4ucHVzaCh0LnVucHJvamVjdFNmTShbLWUsLWldLHRoaXMuX2ltYWdlUGxhbmVEZXB0aCkpLG4ucHVzaCh0LnVucHJvamVjdFNmTShbZSwtaV0sdGhpcy5faW1hZ2VQbGFuZURlcHRoKSksbi5wdXNoKHQudW5wcm9qZWN0U2ZNKFtlLGldLHRoaXMuX2ltYWdlUGxhbmVEZXB0aCkpLG4ucHVzaCh0LnVucHJvamVjdFNmTShbLWUsaV0sdGhpcy5faW1hZ2VQbGFuZURlcHRoKSksdGhpcy5fY3JlYXRlRmxhdEdlb21ldHJ5KG4pfV9nZXRSZWd1bGFyRmxhdEltYWdlUGxhbmVHZW9GaXNoZXllKHQpe2xldCBlPXQud2lkdGgsaT10LmhlaWdodCxuPU1hdGgubWF4KGUsaSkscj1lLzIvbixzPWkvMi9uO3JldHVybiB0aGlzLl9nZXRGbGF0SW1hZ2VQbGFuZUdlb0Zpc2hleWUodCxyLHMpfV9nZXRGbGF0SW1hZ2VQbGFuZUdlb0Zpc2hleWUodCxlLGkpe2xldCBuPVtdO3JldHVybiBuLnB1c2godC51bnByb2plY3RTZk0oWy1lLC1pXSx0aGlzLl9pbWFnZVBsYW5lRGVwdGgpKSxuLnB1c2godC51bnByb2plY3RTZk0oW2UsLWldLHRoaXMuX2ltYWdlUGxhbmVEZXB0aCkpLG4ucHVzaCh0LnVucHJvamVjdFNmTShbZSxpXSx0aGlzLl9pbWFnZVBsYW5lRGVwdGgpKSxuLnB1c2godC51bnByb2plY3RTZk0oWy1lLGldLHRoaXMuX2ltYWdlUGxhbmVEZXB0aCkpLHRoaXMuX2NyZWF0ZUZsYXRHZW9tZXRyeShuKX1fZ2V0RmxhdEltYWdlUGxhbmVHZW9Gcm9tQmFzaWModCxlLGksbixyKXtsZXQgcz1bXTtyZXR1cm4gcy5wdXNoKHQudW5wcm9qZWN0QmFzaWMoW2Usbl0sdGhpcy5faW1hZ2VQbGFuZURlcHRoKSkscy5wdXNoKHQudW5wcm9qZWN0QmFzaWMoW2ksbl0sdGhpcy5faW1hZ2VQbGFuZURlcHRoKSkscy5wdXNoKHQudW5wcm9qZWN0QmFzaWMoW2kscl0sdGhpcy5faW1hZ2VQbGFuZURlcHRoKSkscy5wdXNoKHQudW5wcm9qZWN0QmFzaWMoW2Uscl0sdGhpcy5faW1hZ2VQbGFuZURlcHRoKSksdGhpcy5fY3JlYXRlRmxhdEdlb21ldHJ5KHMpfV9jcmVhdGVGbGF0R2VvbWV0cnkodCl7bGV0IGU9bmV3IEZsb2F0MzJBcnJheSgxMik7Zm9yKGxldCBpPTA7aTx0Lmxlbmd0aDtpKyspe2xldCBuPTMqaTtlW24rMF09dFtpXVswXSxlW24rMV09dFtpXVsxXSxlW24rMl09dFtpXVsyXX1sZXQgaT1uZXcgVWludDE2QXJyYXkoNik7aVswXT0wLGlbMV09MSxpWzJdPTMsaVszXT0xLGlbNF09MixpWzVdPTM7bGV0IG49bmV3IGhzO3JldHVybiBuLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEhyKGUsMykpLG4uc2V0SW5kZXgobmV3IEhyKGksMSkpLG59fWNsYXNzIGlte2NvbnN0cnVjdG9yKCl7dGhpcy5fcGxhbmVzPXt9LHRoaXMuX3BsYW5lc09sZD17fSx0aGlzLl9wbGFuZXNQZXJpcGhlcnk9e30sdGhpcy5fc2NlbmU9bmV3IFFhLHRoaXMuX3NjZW5lT2xkPW5ldyBRYSx0aGlzLl9zY2VuZVBlcmlwaGVyeT1uZXcgUWF9Z2V0IHBsYW5lcygpe3JldHVybiB0aGlzLl9wbGFuZXN9Z2V0IHBsYW5lc09sZCgpe3JldHVybiB0aGlzLl9wbGFuZXNPbGR9Z2V0IHBsYW5lc1BlcmlwaGVyeSgpe3JldHVybiB0aGlzLl9wbGFuZXNQZXJpcGhlcnl9Z2V0IHNjZW5lKCl7cmV0dXJuIHRoaXMuX3NjZW5lfWdldCBzY2VuZU9sZCgpe3JldHVybiB0aGlzLl9zY2VuZU9sZH1nZXQgc2NlbmVQZXJpcGhlcnkoKXtyZXR1cm4gdGhpcy5fc2NlbmVQZXJpcGhlcnl9dXBkYXRlSW1hZ2VQbGFuZXModCl7dGhpcy5fZGlzcG9zZSh0aGlzLl9wbGFuZXNPbGQsdGhpcy5zY2VuZU9sZCk7Zm9yKGNvbnN0IHQgaW4gdGhpcy5fcGxhbmVzKXtpZighdGhpcy5fcGxhbmVzLmhhc093blByb3BlcnR5KHQpKWNvbnRpbnVlO2NvbnN0IGU9dGhpcy5fcGxhbmVzW3RdO3RoaXMuX3NjZW5lLnJlbW92ZShlKSx0aGlzLl9zY2VuZU9sZC5hZGQoZSl9Zm9yKGNvbnN0IGUgaW4gdCl0Lmhhc093blByb3BlcnR5KGUpJiZ0aGlzLl9zY2VuZS5hZGQodFtlXSk7dGhpcy5fcGxhbmVzT2xkPXRoaXMuX3BsYW5lcyx0aGlzLl9wbGFuZXM9dH1hZGRJbWFnZVBsYW5lcyh0KXtmb3IoY29uc3QgZSBpbiB0KXtpZighdC5oYXNPd25Qcm9wZXJ0eShlKSljb250aW51ZTtjb25zdCBpPXRbZV07dGhpcy5fc2NlbmUuYWRkKGkpLHRoaXMuX3BsYW5lc1tlXT1pfX1hZGRJbWFnZVBsYW5lc09sZCh0KXtmb3IoY29uc3QgZSBpbiB0KXtpZighdC5oYXNPd25Qcm9wZXJ0eShlKSljb250aW51ZTtjb25zdCBpPXRbZV07dGhpcy5fc2NlbmVPbGQuYWRkKGkpLHRoaXMuX3BsYW5lc09sZFtlXT1pfX1zZXRJbWFnZVBsYW5lcyh0KXt0aGlzLl9jbGVhcigpLHRoaXMuYWRkSW1hZ2VQbGFuZXModCl9YWRkUGVyaXBoZXJ5UGxhbmVzKHQpe2Zvcihjb25zdCBlIGluIHQpe2lmKCF0Lmhhc093blByb3BlcnR5KGUpKWNvbnRpbnVlO2NvbnN0IGk9dFtlXTt0aGlzLl9zY2VuZVBlcmlwaGVyeS5hZGQoaSksdGhpcy5fcGxhbmVzUGVyaXBoZXJ5W2VdPWl9fXNldFBlcmlwaGVyeVBsYW5lcyh0KXt0aGlzLl9jbGVhclBlcmlwaGVyeSgpLHRoaXMuYWRkUGVyaXBoZXJ5UGxhbmVzKHQpfXNldEltYWdlUGxhbmVzT2xkKHQpe3RoaXMuX2NsZWFyT2xkKCksdGhpcy5hZGRJbWFnZVBsYW5lc09sZCh0KX1jbGVhcigpe3RoaXMuX2NsZWFyKCksdGhpcy5fY2xlYXJPbGQoKX1fY2xlYXIoKXt0aGlzLl9kaXNwb3NlKHRoaXMuX3BsYW5lcyx0aGlzLl9zY2VuZSksdGhpcy5fcGxhbmVzPXt9fV9jbGVhck9sZCgpe3RoaXMuX2Rpc3Bvc2UodGhpcy5fcGxhbmVzT2xkLHRoaXMuX3NjZW5lT2xkKSx0aGlzLl9wbGFuZXNPbGQ9e319X2NsZWFyUGVyaXBoZXJ5KCl7dGhpcy5fZGlzcG9zZSh0aGlzLl9wbGFuZXNQZXJpcGhlcnksdGhpcy5fc2NlbmVQZXJpcGhlcnkpLHRoaXMuX3BsYW5lc1BlcmlwaGVyeT17fX1fZGlzcG9zZSh0LGUpe2Zvcihjb25zdCBpIGluIHQpe2lmKCF0Lmhhc093blByb3BlcnR5KGkpKWNvbnRpbnVlO2NvbnN0IG49dFtpXTtlLnJlbW92ZShuKSxuLmdlb21ldHJ5LmRpc3Bvc2UoKSxuLm1hdGVyaWFsLmRpc3Bvc2UoKTtsZXQgcj1uLm1hdGVyaWFsLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZTtudWxsIT1yJiZyLmRpc3Bvc2UoKX19fWNsYXNzIG5te2NvbnN0cnVjdG9yKCl7dGhpcy5fZmFjdG9yeT1uZXcgZW0sdGhpcy5fc2NlbmU9bmV3IGltLHRoaXMuX2FscGhhPTAsdGhpcy5fYWxwaGFPbGQ9MCx0aGlzLl9mYWRlT3V0U3BlZWQ9LjA1LHRoaXMuX2N1cnJlbnRLZXk9bnVsbCx0aGlzLl9wcmV2aW91c0tleT1udWxsLHRoaXMuX3Byb3ZpZGVyRGlzcG9zZXJzPXt9LHRoaXMuX2ZyYW1lSWQ9MCx0aGlzLl9uZWVkc1JlbmRlcj0hMX1nZXQgZnJhbWVJZCgpe3JldHVybiB0aGlzLl9mcmFtZUlkfWdldCBuZWVkc1JlbmRlcigpe3JldHVybiB0aGlzLl9uZWVkc1JlbmRlcn1pbmRpY2F0ZU5lZWRzUmVuZGVyKCl7dGhpcy5fbmVlZHNSZW5kZXI9ITB9YWRkUGVyaXBoZXJ5UGxhbmUodCxlKXtjb25zdCBpPXRoaXMuX2ZhY3RvcnkuY3JlYXRlTWVzaCh0LGUpLG49e307blt0LmlkXT1pLHRoaXMuX3NjZW5lLmFkZFBlcmlwaGVyeVBsYW5lcyhuKSx0aGlzLl9uZWVkc1JlbmRlcj0hMH1jbGVhclBlcmlwaGVyeVBsYW5lcygpe3RoaXMuX3NjZW5lLnNldFBlcmlwaGVyeVBsYW5lcyh7fSksdGhpcy5fbmVlZHNSZW5kZXI9ITB9dXBkYXRlRnJhbWUodCl7dGhpcy5fdXBkYXRlRnJhbWVJZCh0LmlkKSx0aGlzLl9uZWVkc1JlbmRlcj10aGlzLl91cGRhdGVBbHBoYSh0LnN0YXRlLmFscGhhKXx8dGhpcy5fbmVlZHNSZW5kZXIsdGhpcy5fbmVlZHNSZW5kZXI9dGhpcy5fdXBkYXRlQWxwaGFPbGQodC5zdGF0ZS5hbHBoYSl8fHRoaXMuX25lZWRzUmVuZGVyLHRoaXMuX25lZWRzUmVuZGVyPXRoaXMuX3VwZGF0ZUltYWdlUGxhbmVzKHQuc3RhdGUpfHx0aGlzLl9uZWVkc1JlbmRlcn1zZXRUZXh0dXJlUHJvdmlkZXIodCxlKXtpZih0IT09dGhpcy5fY3VycmVudEtleSlyZXR1cm47bGV0IGk9ZS50ZXh0dXJlQ3JlYXRlZCQuc3Vic2NyaWJlKCh0PT57dGhpcy5fdXBkYXRlVGV4dHVyZSh0KX0pKSxuPWUudGV4dHVyZVVwZGF0ZWQkLnN1YnNjcmliZSgodD0+e3RoaXMuX25lZWRzUmVuZGVyPSEwfSkpO2lmKHQgaW4gdGhpcy5fcHJvdmlkZXJEaXNwb3NlcnMpeygwLHRoaXMuX3Byb3ZpZGVyRGlzcG9zZXJzW3RdKSgpLGRlbGV0ZSB0aGlzLl9wcm92aWRlckRpc3Bvc2Vyc1t0XX10aGlzLl9wcm92aWRlckRpc3Bvc2Vyc1t0XT0oKT0+e2kudW5zdWJzY3JpYmUoKSxuLnVuc3Vic2NyaWJlKCksZS5kaXNwb3NlKCl9fXVwZGF0ZVRleHR1cmVJbWFnZSh0LGUpe3RoaXMuX25lZWRzUmVuZGVyPSEwO2NvbnN0IGk9dGhpcy5fZXh0ZW5kKHt9LHRoaXMuX3NjZW5lLnBsYW5lcyx0aGlzLl9zY2VuZS5wbGFuZXNPbGQsdGhpcy5fc2NlbmUucGxhbmVzUGVyaXBoZXJ5KTtmb3IoY29uc3QgbiBpbiBpKXtpZighaS5oYXNPd25Qcm9wZXJ0eShuKSljb250aW51ZTtpZihuIT09ZS5pZCljb250aW51ZTtsZXQgcj1pW25dLm1hdGVyaWFsLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZTtyLmltYWdlPXQsci5uZWVkc1VwZGF0ZT0hMH19cmVuZGVyKHQsZSl7Y29uc3QgaT10aGlzLl9zY2VuZS5wbGFuZXMsbj10aGlzLl9zY2VuZS5wbGFuZXNPbGQscj10aGlzLl9zY2VuZS5wbGFuZXNQZXJpcGhlcnkscz1PYmplY3Qua2V5cyhuKS5sZW5ndGg/MTp0aGlzLl9hbHBoYSxvPU9iamVjdC5rZXlzKG4pLmxlbmd0aD8xOk1hdGguZmxvb3IodGhpcy5fYWxwaGEpO2Zvcihjb25zdCB0IGluIGkpe2lmKCFpLmhhc093blByb3BlcnR5KHQpKWNvbnRpbnVlO2lbdF0ubWF0ZXJpYWwudW5pZm9ybXMub3BhY2l0eS52YWx1ZT1zfWZvcihjb25zdCB0IGluIG4pe2lmKCFuLmhhc093blByb3BlcnR5KHQpKWNvbnRpbnVlO25bdF0ubWF0ZXJpYWwudW5pZm9ybXMub3BhY2l0eS52YWx1ZT10aGlzLl9hbHBoYU9sZH1mb3IoY29uc3QgdCBpbiByKXtpZighci5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtyW3RdLm1hdGVyaWFsLnVuaWZvcm1zLm9wYWNpdHkudmFsdWU9b31lLnJlbmRlcih0aGlzLl9zY2VuZS5zY2VuZVBlcmlwaGVyeSx0KSxlLnJlbmRlcih0aGlzLl9zY2VuZS5zY2VuZSx0KSxlLnJlbmRlcih0aGlzLl9zY2VuZS5zY2VuZU9sZCx0KTtmb3IoY29uc3QgdCBpbiBpKXtpZighaS5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtpW3RdLm1hdGVyaWFsLnVuaWZvcm1zLm9wYWNpdHkudmFsdWU9dGhpcy5fYWxwaGF9ZS5yZW5kZXIodGhpcy5fc2NlbmUuc2NlbmUsdCl9Y2xlYXJOZWVkc1JlbmRlcigpe3RoaXMuX25lZWRzUmVuZGVyPSExfWRpc3Bvc2UoKXt0aGlzLl9zY2VuZS5jbGVhcigpfV91cGRhdGVGcmFtZUlkKHQpe3RoaXMuX2ZyYW1lSWQ9dH1fdXBkYXRlQWxwaGEodCl7cmV0dXJuIHQhPT10aGlzLl9hbHBoYSYmKHRoaXMuX2FscGhhPXQsITApfV91cGRhdGVBbHBoYU9sZCh0KXtyZXR1cm4hKHQ8MXx8MD09PXRoaXMuX2FscGhhT2xkKSYmKHRoaXMuX2FscGhhT2xkPU1hdGgubWF4KDAsdGhpcy5fYWxwaGFPbGQtdGhpcy5fZmFkZU91dFNwZWVkKSwhMCl9X3VwZGF0ZUltYWdlUGxhbmVzKHQpe2lmKG51bGw9PXQuY3VycmVudEltYWdlfHx0LmN1cnJlbnRJbWFnZS5pZD09PXRoaXMuX2N1cnJlbnRLZXkpcmV0dXJuITE7bGV0IGU9bnVsbCE9dC5wcmV2aW91c0ltYWdlP3QucHJldmlvdXNJbWFnZS5pZDpudWxsLGk9dC5jdXJyZW50SW1hZ2UuaWQ7aWYodGhpcy5fcHJldmlvdXNLZXkhPT1lJiZ0aGlzLl9wcmV2aW91c0tleSE9PWkmJnRoaXMuX3ByZXZpb3VzS2V5IGluIHRoaXMuX3Byb3ZpZGVyRGlzcG9zZXJzKXsoMCx0aGlzLl9wcm92aWRlckRpc3Bvc2Vyc1t0aGlzLl9wcmV2aW91c0tleV0pKCksZGVsZXRlIHRoaXMuX3Byb3ZpZGVyRGlzcG9zZXJzW3RoaXMuX3ByZXZpb3VzS2V5XX1pZihudWxsIT1lKXtpZihlIT09dGhpcy5fY3VycmVudEtleSYmZSE9PXRoaXMuX3ByZXZpb3VzS2V5KXtsZXQgaT10aGlzLl9mYWN0b3J5LmNyZWF0ZU1lc2godC5wcmV2aW91c0ltYWdlLHQucHJldmlvdXNUcmFuc2Zvcm0pO2NvbnN0IG49e307bltlXT1pLHRoaXMuX3NjZW5lLnVwZGF0ZUltYWdlUGxhbmVzKG4pfXRoaXMuX3ByZXZpb3VzS2V5PWV9dGhpcy5fY3VycmVudEtleT1pO2xldCBuPXRoaXMuX2ZhY3RvcnkuY3JlYXRlTWVzaCh0LmN1cnJlbnRJbWFnZSx0LmN1cnJlbnRUcmFuc2Zvcm0pO2NvbnN0IHI9e307cmV0dXJuIHJbaV09bix0aGlzLl9zY2VuZS51cGRhdGVJbWFnZVBsYW5lcyhyKSx0aGlzLl9hbHBoYU9sZD0xLCEwfV91cGRhdGVUZXh0dXJlKHQpe3RoaXMuX25lZWRzUmVuZGVyPSEwO2NvbnN0IGU9dGhpcy5fc2NlbmUucGxhbmVzO2Zvcihjb25zdCBpIGluIGUpe2lmKCFlLmhhc093blByb3BlcnR5KGkpKWNvbnRpbnVlO2xldCBuPWVbaV0ubWF0ZXJpYWwscj1uLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZTtuLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZT1udWxsLHIuZGlzcG9zZSgpLG4udW5pZm9ybXMucHJvamVjdG9yVGV4LnZhbHVlPXR9fV9leHRlbmQodCwuLi5lKXtmb3IoY29uc3QgaSBvZiBlKWZvcihjb25zdCBlIGluIGkpaS5oYXNPd25Qcm9wZXJ0eShlKSYmKHRbZV09aVtlXSk7cmV0dXJuIHR9fXZhciBybTshZnVuY3Rpb24odCl7dFt0LkJhY2tncm91bmQ9MF09XCJCYWNrZ3JvdW5kXCIsdFt0Lk9wYXF1ZT0xXT1cIk9wYXF1ZVwifShybXx8KHJtPXt9KSk7Y2xhc3Mgc217Y29uc3RydWN0b3IodCl7dGhpcy5fYXBpPXQsdGhpcy5fdXJscyQ9bmV3IE1hcH1nZXRJbWFnZSQodCl7bGV0IGU7Y29uc3QgaT1uZXcgUHJvbWlzZSgoKHQsaSk9PntlPWl9KSk7cmV0dXJuW2IuY3JlYXRlKChuPT57dGhpcy5fYXBpLmRhdGEuZ2V0SW1hZ2VCdWZmZXIodCxpKS50aGVuKCh0PT57ZT1udWxsO2NvbnN0IGk9bmV3IEltYWdlO2kuY3Jvc3NPcmlnaW49XCJBbm9ueW1vdXNcIixpLm9ubG9hZD0oKT0+e3dpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKGkuc3JjKSxuLm5leHQoaSksbi5jb21wbGV0ZSgpfSxpLm9uZXJyb3I9KCk9PntlPW51bGwsd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwoaS5zcmMpLG4uZXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGxvYWQgaW1hZ2UgdGlsZVwiKSl9O2NvbnN0IHI9bmV3IEJsb2IoW3RdKTtpLnNyYz13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChyKX0pLCh0PT57ZT1udWxsLG4uZXJyb3IodCl9KSl9KSksKCk9PntlJiZlKCl9XX1nZXRVUkxzJCh0LGUpe2NvbnN0IGk9dGhpcy5faW52ZW50SWQodCxlKTtpZih0aGlzLl91cmxzJC5oYXMoaSkpcmV0dXJuIHRoaXMuX3VybHMkLmdldChpKTtjb25zdCBuPXtpbWFnZUlkOnQsejplfSxyPXRoaXMuX2FwaS5nZXRJbWFnZVRpbGVzJChuKS5waXBlKHJ0KCh0PT50Lm5vZGUpKSxNZSgoKCk9Pnt0aGlzLl91cmxzJC5kZWxldGUoaSl9KSksSGUoKSxFKCkpO3JldHVybiB0aGlzLl91cmxzJC5zZXQoaSxyKSxyfV9pbnZlbnRJZCh0LGUpe3JldHVybmAke3R9LSR7ZX1gfX1jbGFzcyBvbXtjb25zdHJ1Y3Rvcigpe3RoaXMuX3RpbGVzPW5ldyBNYXAsdGhpcy5fdXJsTGV2ZWxzPW5ldyBTZXQsdGhpcy5fdXJscz1uZXcgTWFwfWFkZCh0LGUpe2lmKHRoaXMuX3RpbGVzLmhhcyh0KSl0aHJvdyBuZXcgRXJyb3IoYEltYWdlIHRpbGUgYWxyZWFkeSBzdG9yZWQgKCR7dH0pYCk7dGhpcy5fdGlsZXMuc2V0KHQsZSl9YWRkVVJMcyh0LGUpe2NvbnN0IGk9dGhpcy5fdXJscztmb3IoY29uc3QgdCBvZiBlKXtjb25zdCBlPXRoaXMuaW52ZW50SWQodCk7aWYodGhpcy5fdXJscy5oYXMoZSkpdGhyb3cgbmV3IEVycm9yKGBVUkwgYWxyZWFkeSBzdG9yZWQgKCR7ZX0pYCk7aS5zZXQoZSx0LnVybCl9dGhpcy5fdXJsTGV2ZWxzLmFkZCh0KX1kaXNwb3NlKCl7dGhpcy5fdGlsZXMuZm9yRWFjaCgodD0+d2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodC5zcmMpKSksdGhpcy5fdGlsZXMuY2xlYXIoKSx0aGlzLl91cmxzLmNsZWFyKCksdGhpcy5fdXJsTGV2ZWxzLmNsZWFyKCl9Z2V0KHQpe3JldHVybiB0aGlzLl90aWxlcy5nZXQodCl9Z2V0VVJMKHQpe3JldHVybiB0aGlzLl91cmxzLmdldCh0KX1oYXModCl7cmV0dXJuIHRoaXMuX3RpbGVzLmhhcyh0KX1oYXNVUkwodCl7cmV0dXJuIHRoaXMuX3VybHMuaGFzKHQpfWhhc1VSTExldmVsKHQpe3JldHVybiB0aGlzLl91cmxMZXZlbHMuaGFzKHQpfWludmVudElkKHQpe3JldHVybmAke3Quen0tJHt0Lnh9LSR7dC55fWB9fWNsYXNzIGFte2NvbnN0cnVjdG9yKCl7dGhpcy5fdmlld3BvcnRDb29yZHM9bmV3IFdmfWNvbXB1dGVSZWdpb25PZkludGVyZXN0KHQsZSxpKXtjb25zdCBuPXRoaXMuX3ZpZXdwb3J0Qm91bmRhcnlQb2ludHMoNCkscj10aGlzLl92aWV3cG9ydFBvaW50c0JvdW5kaW5nQm94KG4sdCxpKTt0aGlzLl9jbGlwQm91bmRpbmdCb3gocik7Y29uc3Qgcz0yL2Uud2lkdGgsbz0yL2UuaGVpZ2h0LGE9W1stLjUqcywuNSpvXSxbLjUqcywuNSpvXSxbLjUqcywtLjUqb10sWy0uNSpzLC0uNSpvXV0sYz10aGlzLl92aWV3cG9ydFBvaW50c0JvdW5kaW5nQm94KGEsdCxpKSxoPWMubWluWDxjLm1heFg7cmV0dXJue2Jib3g6cixwaXhlbEhlaWdodDpjLm1heFktYy5taW5ZLHBpeGVsV2lkdGg6Yy5tYXhYLWMubWluWCsoaD8wOjEpfX1fdmlld3BvcnRCb3VuZGFyeVBvaW50cyh0KXtjb25zdCBlPVtdLGk9W1stMSwxXSxbMSwxXSxbMSwtMV0sWy0xLC0xXV0sbj1bWzIsMF0sWzAsLTJdLFstMiwwXSxbMCwyXV07Zm9yKGxldCByPTA7cjw0Oysrcil7Y29uc3Qgcz1pW3JdLG89bltyXTtmb3IobGV0IGk9MDtpPHQ7KytpKWUucHVzaChbc1swXStvWzBdKmkvdCxzWzFdK29bMV0qaS90XSl9cmV0dXJuIGV9X3ZpZXdwb3J0UG9pbnRzQm91bmRpbmdCb3godCxlLGkpe2NvbnN0IG49dC5tYXAoKHQ9PnRoaXMuX3ZpZXdwb3J0Q29vcmRzLnZpZXdwb3J0VG9CYXNpYyh0WzBdLHRbMV0saSxlLnBlcnNwZWN0aXZlKSkpO3JldHVybiBkZChpLmNhbWVyYVR5cGUpP3RoaXMuX2JvdW5kaW5nQm94U3BoZXJpY2FsKG4pOnRoaXMuX2JvdW5kaW5nQm94KG4pfV9ib3VuZGluZ0JveCh0KXtjb25zdCBlPXttYXhYOk51bWJlci5ORUdBVElWRV9JTkZJTklUWSxtYXhZOk51bWJlci5ORUdBVElWRV9JTkZJTklUWSxtaW5YOk51bWJlci5QT1NJVElWRV9JTkZJTklUWSxtaW5ZOk51bWJlci5QT1NJVElWRV9JTkZJTklUWX07Zm9yKGxldCBpPTA7aTx0Lmxlbmd0aDsrK2kpZS5taW5YPU1hdGgubWluKGUubWluWCx0W2ldWzBdKSxlLm1heFg9TWF0aC5tYXgoZS5tYXhYLHRbaV1bMF0pLGUubWluWT1NYXRoLm1pbihlLm1pblksdFtpXVsxXSksZS5tYXhZPU1hdGgubWF4KGUubWF4WSx0W2ldWzFdKTtyZXR1cm4gZX1fYm91bmRpbmdCb3hTcGhlcmljYWwodCl7Y29uc3QgZT1bXSxpPVtdO2ZvcihsZXQgbj0wO248dC5sZW5ndGg7KytuKWUucHVzaCh0W25dWzBdKSxpLnB1c2godFtuXVsxXSk7ZS5zb3J0KCgodCxlKT0+dGhpcy5fc2lnbih0LWUpKSksaS5zb3J0KCgodCxlKT0+dGhpcy5fc2lnbih0LWUpKSk7Y29uc3Qgbj10aGlzLl9pbnRlcnZhbFNwaGVyaWNhbChlKTtyZXR1cm57bWF4WDpuWzFdLG1heFk6aVtpLmxlbmd0aC0xXSxtaW5YOm5bMF0sbWluWTppWzBdfX1faW50ZXJ2YWxTcGhlcmljYWwodCl7bGV0IGU9MCxpPS0xO2ZvcihsZXQgbj0wO248dC5sZW5ndGgtMTsrK24pe2NvbnN0IHI9dFtuKzFdLXRbbl07cj5lJiYoZT1yLGk9bil9cmV0dXJuIHRbMF0rMS10W3QubGVuZ3RoLTFdPmU/W3RbMF0sdFt0Lmxlbmd0aC0xXV06W3RbaSsxXSx0W2ldXX1fY2xpcEJvdW5kaW5nQm94KHQpe3QubWluWD1NYXRoLm1heCgwLE1hdGgubWluKDEsdC5taW5YKSksdC5tYXhYPU1hdGgubWF4KDAsTWF0aC5taW4oMSx0Lm1heFgpKSx0Lm1pblk9TWF0aC5tYXgoMCxNYXRoLm1pbigxLHQubWluWSkpLHQubWF4WT1NYXRoLm1heCgwLE1hdGgubWluKDEsdC5tYXhZKSl9X3NpZ24odCl7cmV0dXJuIHQ+MD8xOnQ8MD8tMTowfX1mdW5jdGlvbiBjbSh0LGUsaSl7cmV0dXJuIE1hdGgubWF4KGUsTWF0aC5taW4oaSx0KSl9ZnVuY3Rpb24gaG0odCl7cmV0dXJuIDEwMjQvbG0odCl9ZnVuY3Rpb24gbG0odCl7cmV0dXJuIE1hdGgucG93KDIsdC56LXQubWF4KX1mdW5jdGlvbiB1bSh0KXtyZXR1cm4gTWF0aC5jZWlsKGZ1bmN0aW9uKHQpe2NvbnN0IGU9TWF0aC5tYXgodC53LHQuaCk7cmV0dXJuIE1hdGgubG9nKGUpL01hdGgubG9nKDIpfSh0KSl9ZnVuY3Rpb24gZG0odCxlLGkpe2NvbnN0IG49aG0oaSkscj1lLncscz1lLmgsbz1NYXRoLmNlaWwoci9uKS0xLGE9TWF0aC5jZWlsKHMvbiktMTtyZXR1cm57eDpjbShNYXRoLmZsb29yKHIqdFswXS9uKSwwLG8pLHk6Y20oTWF0aC5mbG9vcihzKnRbMV0vbiksMCxhKX19ZnVuY3Rpb24gcG0odCxlLGkpe2NvbnN0IG49MTAyNCooMS9sbShpKSkscj1uKnQueCxzPW4qdC55LG89TWF0aC5taW4obixlLnctcik7cmV0dXJue2g6TWF0aC5taW4obixlLmgtcykseDpyLHk6cyx3Om99fWZ1bmN0aW9uIGZtKHQsZSxpKXtyZXR1cm4gaSp0PD1lJiZlPGkqKHQrMSl9ZnVuY3Rpb24gbW0odCxlKXtpZih0Lno9PT1lLnopcmV0dXJuIHQueD09PWUueCYmdC55PT09ZS55O2NvbnN0IGk9dC56PGUuej90OmUsbj10Lno8ZS56P2U6dCxyPTEvbG0oe21heDpuLnosejppLnp9KSxzPWZtKGkueCxuLngsciksbz1mbShpLnksbi55LHIpO3JldHVybiBzJiZvfWZ1bmN0aW9uIGdtKHQpe3JldHVybiB0Lnc+MCYmdC5oPjB9Y2xhc3MgX217Y29uc3RydWN0b3IodCxlLGksbixyLHMsbyl7Y29uc3QgYT17aDppLHc6ZX07Z20oYSl8fGNvbnNvbGUud2FybihgT3JpZ2luYWwgaW1hZ2Ugc2l6ZSAoJHtlfSwgJHtpfSkgaXMgaW52YWxpZCAoJHt0fSkuIFRpbGVzIHdpbGwgbm90IGJlIGxvYWRlZC5gKSx0aGlzLl9pbWFnZUlkPXQsdGhpcy5fc2l6ZT1hLHRoaXMuX2xldmVsPXttYXg6dW0odGhpcy5fc2l6ZSksejotMX0sdGhpcy5faG9sZGVyPW5ldyBVZix0aGlzLl91cGRhdGVkJD1uZXcgVCx0aGlzLl9jcmVhdGVkU3ViamVjdCQ9bmV3IFQsdGhpcy5fY3JlYXRlZCQ9dGhpcy5fY3JlYXRlZFN1YmplY3QkLnBpcGUoVWUoMSksRSgpKSx0aGlzLl9ob2xkZXIucHVzaCh0aGlzLl9jcmVhdGVkJC5zdWJzY3JpYmUoKCgpPT57fSkpKSx0aGlzLl9oYXNTdWJqZWN0JD1uZXcgVCx0aGlzLl9oYXMkPXRoaXMuX2hhc1N1YmplY3QkLnBpcGUobmkoITEpLFVlKDEpLEUoKSksdGhpcy5faG9sZGVyLnB1c2godGhpcy5faGFzJC5zdWJzY3JpYmUoKCgpPT57fSkpKSx0aGlzLl9yZW5kZXJlZExldmVsPW5ldyBTZXQsdGhpcy5fcmVuZGVyZWQ9bmV3IE1hcCx0aGlzLl9zdWJzY3JpcHRpb25zPW5ldyBNYXAsdGhpcy5fdXJsU3Vic2NyaXB0aW9ucz1uZXcgTWFwLHRoaXMuX2xvYWRlcj1yLHRoaXMuX3N0b3JlPXMsdGhpcy5fYmFja2dyb3VuZD1uLHRoaXMuX3JlbmRlcmVyPW8sdGhpcy5fYWJvcnRzPVtdLHRoaXMuX3JlbmRlcj1udWxsLHRoaXMuX2Rpc3Bvc2VkPSExfWdldCBkaXNwb3NlZCgpe3JldHVybiB0aGlzLl9kaXNwb3NlZH1nZXQgaGFzVGV4dHVyZSQoKXtyZXR1cm4gdGhpcy5faGFzJH1nZXQgaWQoKXtyZXR1cm4gdGhpcy5faW1hZ2VJZH1nZXQgdGV4dHVyZVVwZGF0ZWQkKCl7cmV0dXJuIHRoaXMuX3VwZGF0ZWQkfWdldCB0ZXh0dXJlQ3JlYXRlZCQoKXtyZXR1cm4gdGhpcy5fY3JlYXRlZCR9YWJvcnQoKXt0aGlzLl9zdWJzY3JpcHRpb25zLmZvckVhY2goKHQ9PnQudW5zdWJzY3JpYmUoKSkpLHRoaXMuX3N1YnNjcmlwdGlvbnMuY2xlYXIoKTtmb3IoY29uc3QgdCBvZiB0aGlzLl9hYm9ydHMpdCgpO3RoaXMuX2Fib3J0cz1bXX1kaXNwb3NlKCl7dGhpcy5fZGlzcG9zZWQ/Y29uc29sZS53YXJuKGBUZXh0dXJlIGFscmVhZHkgZGlzcG9zZWQgKCR7dGhpcy5faW1hZ2VJZH0pYCk6KHRoaXMuX3VybFN1YnNjcmlwdGlvbnMuZm9yRWFjaCgodD0+dC51bnN1YnNjcmliZSgpKSksdGhpcy5fdXJsU3Vic2NyaXB0aW9ucy5jbGVhcigpLHRoaXMuYWJvcnQoKSxudWxsIT10aGlzLl9yZW5kZXImJih0aGlzLl9yZW5kZXIudGFyZ2V0LmRpc3Bvc2UoKSx0aGlzLl9yZW5kZXIudGFyZ2V0PW51bGwsdGhpcy5fcmVuZGVyLmNhbWVyYT1udWxsLHRoaXMuX3JlbmRlcj1udWxsKSx0aGlzLl9zdG9yZS5kaXNwb3NlKCksdGhpcy5faG9sZGVyLnVuc3Vic2NyaWJlKCksdGhpcy5fcmVuZGVyZWRMZXZlbC5jbGVhcigpLHRoaXMuX2JhY2tncm91bmQ9bnVsbCx0aGlzLl9yZW5kZXJlcj1udWxsLHRoaXMuX2Rpc3Bvc2VkPSEwKX1zZXRSZWdpb25PZkludGVyZXN0KHQpe2lmKCFnbSh0aGlzLl9zaXplKSlyZXR1cm47Y29uc3QgZT0xL3QucGl4ZWxXaWR0aCxpPWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gTWF0aC5tYXgoZSxNYXRoLm1pbihpLHVtKHQpKSl9KHtoOjEvdC5waXhlbEhlaWdodCx3OmV9LDExLHRoaXMuX2xldmVsLm1heCk7aSE9PXRoaXMuX2xldmVsLnomJih0aGlzLmFib3J0KCksdGhpcy5fbGV2ZWwuej1pLHRoaXMuX3JlbmRlcmVkTGV2ZWwuY2xlYXIoKSx0aGlzLl9yZW5kZXJlZC5mb3JFYWNoKCgodCxlKT0+e3Quej09PWkmJnRoaXMuX3JlbmRlcmVkTGV2ZWwuYWRkKGUpfSkpKSxudWxsPT10aGlzLl9yZW5kZXImJnRoaXMuX2luaXRSZW5kZXIoKTtjb25zdCBuPWZ1bmN0aW9uKHQsZSxpLG4pe2NvbnN0IHI9W107aWYodC54PmUueCl7Y29uc3Qgcz1obShuKSxvPU1hdGguY2VpbChpLncvcyktMTtmb3IobGV0IGU9dC54O2U8PW87ZSsrKXIucHVzaChlKTtmb3IobGV0IHQ9MDt0PD1lLng7dCsrKXIucHVzaCh0KX1lbHNlIGZvcihsZXQgaT10Lng7aTw9ZS54O2krKylyLnB1c2goaSk7Y29uc3Qgcz1bXTtmb3IoY29uc3QgaSBvZiByKWZvcihsZXQgbj10Lnk7bjw9ZS55O24rKylzLnB1c2goe3g6aSx5Om59KTtyZXR1cm4gc30oZG0oW3QuYmJveC5taW5YLHQuYmJveC5taW5ZXSx0aGlzLl9zaXplLHRoaXMuX2xldmVsKSxkbShbdC5iYm94Lm1heFgsdC5iYm94Lm1heFldLHRoaXMuX3NpemUsdGhpcy5fbGV2ZWwpLHRoaXMuX3NpemUsdGhpcy5fbGV2ZWwpO3RoaXMuX2ZldGNoVGlsZXMoaSxuKX1fZmV0Y2hUaWxlKHQpe2NvbnN0IGU9dGhpcy5fbG9hZGVyLmdldEltYWdlJCh0LnVybCksaT1lWzBdLG49ZVsxXTt0aGlzLl9hYm9ydHMucHVzaChuKTtjb25zdCByPXRoaXMuX3N0b3JlLmludmVudElkKHQpLHM9aS5zdWJzY3JpYmUoKGU9Pntjb25zdCBpPXBtKHQsdGhpcy5fc2l6ZSx0aGlzLl9sZXZlbCk7dGhpcy5fcmVuZGVyVG9UYXJnZXQoaSxlKSx0aGlzLl9zdWJzY3JpcHRpb25zLmRlbGV0ZShyKSx0aGlzLl9yZW1vdmVGcm9tQXJyYXkobix0aGlzLl9hYm9ydHMpLHRoaXMuX21hcmtSZW5kZXJlZCh0KSx0aGlzLl9zdG9yZS5hZGQocixlKSx0aGlzLl91cGRhdGVkJC5uZXh0KCEwKX0pLCh0PT57dGhpcy5fc3Vic2NyaXB0aW9ucy5kZWxldGUociksdGhpcy5fcmVtb3ZlRnJvbUFycmF5KG4sdGhpcy5fYWJvcnRzKSxjb25zb2xlLmVycm9yKHQpfSkpO3MuY2xvc2VkfHx0aGlzLl9zdWJzY3JpcHRpb25zLnNldChyLHMpfV9mZXRjaFRpbGVzKHQsZSl7Y29uc3QgaT0odGhpcy5fc3RvcmUuaGFzVVJMTGV2ZWwodCk/Ryh2b2lkIDApOnRoaXMuX2xvYWRlci5nZXRVUkxzJCh0aGlzLl9pbWFnZUlkLHQpLnBpcGUocGkoKGU9Pnt0aGlzLl9zdG9yZS5oYXNVUkxMZXZlbCh0KXx8dGhpcy5fc3RvcmUuYWRkVVJMcyh0LGUpfSkpKSkuc3Vic2NyaWJlKCgoKT0+e2lmKHQ9PT10aGlzLl9sZXZlbC56KXtmb3IoY29uc3QgaSBvZiBlKXtjb25zdCBlPXt4OmkueCx5OmkueSx6OnQsdXJsOm51bGx9LG49dGhpcy5fc3RvcmUuaW52ZW50SWQoZSk7aWYoIXRoaXMuX3JlbmRlcmVkTGV2ZWwuaGFzKG4pJiYhdGhpcy5fc3Vic2NyaXB0aW9ucy5oYXMobikpaWYodGhpcy5fc3RvcmUuaGFzKG4pKXtjb25zdCB0PXBtKGksdGhpcy5fc2l6ZSx0aGlzLl9sZXZlbCk7dGhpcy5fcmVuZGVyVG9UYXJnZXQodCx0aGlzLl9zdG9yZS5nZXQobikpLHRoaXMuX21hcmtSZW5kZXJlZChlKSx0aGlzLl91cGRhdGVkJC5uZXh0KCEwKX1lbHNlIGUudXJsPXRoaXMuX3N0b3JlLmdldFVSTChuKSx0aGlzLl9mZXRjaFRpbGUoZSl9dGhpcy5fdXJsU3Vic2NyaXB0aW9ucy5kZWxldGUodCl9fSksKGU9Pnt0aGlzLl91cmxTdWJzY3JpcHRpb25zLmRlbGV0ZSh0KSxjb25zb2xlLmVycm9yKGUpfSkpO2kuY2xvc2VkfHx0aGlzLl91cmxTdWJzY3JpcHRpb25zLnNldCh0LGkpfV9pbml0UmVuZGVyKCl7Y29uc3QgdD10aGlzLl9zaXplLncvMixlPXRoaXMuX3NpemUuaC8yLGk9bmV3IEtsKC10LHQsZSwtZSwtMSwxKTtpLnBvc2l0aW9uLno9MTtjb25zdCBuPXRoaXMuX3JlbmRlcmVyLmdldENvbnRleHQoKSxyPW4uZ2V0UGFyYW1ldGVyKG4uTUFYX1RFWFRVUkVfU0laRSkscz1NYXRoLm1heCh0aGlzLl9zaXplLncsdGhpcy5fc2l6ZS5oKSxvPXI+cz8xOnIvcyxhPU1hdGguZmxvb3Iobyp0aGlzLl9zaXplLncpLGM9TWF0aC5mbG9vcihvKnRoaXMuX3NpemUuaCksaD1uZXcgZG4oYSxjLHtkZXB0aEJ1ZmZlcjohMSxmb3JtYXQ6a2ksbWFnRmlsdGVyOkFpLG1pbkZpbHRlcjpBaSxzdGVuY2lsQnVmZmVyOiExfSk7dGhpcy5fcmVuZGVyPXtjYW1lcmE6aSx0YXJnZXQ6aH07Y29uc3QgbD1wbSh7eDowLHk6MH0sdGhpcy5fc2l6ZSx7bWF4OnRoaXMuX2xldmVsLm1heCx6OjB9KTt0aGlzLl9yZW5kZXJUb1RhcmdldChsLHRoaXMuX2JhY2tncm91bmQpLHRoaXMuX2NyZWF0ZWRTdWJqZWN0JC5uZXh0KGgudGV4dHVyZSksdGhpcy5faGFzU3ViamVjdCQubmV4dCghMCl9X21hcmtSZW5kZXJlZCh0KXtjb25zdCBlPUFycmF5LmZyb20odGhpcy5fcmVuZGVyZWQuZW50cmllcygpKS5maWx0ZXIoKChbZSxpXSk9PmkueiE9PXQueikpO2Zvcihjb25zdFtpLG5db2YgZSltbSh0LG4pJiZ0aGlzLl9yZW5kZXJlZC5kZWxldGUoaSk7Y29uc3QgaT10aGlzLl9zdG9yZS5pbnZlbnRJZCh0KTt0aGlzLl9yZW5kZXJlZC5zZXQoaSx0KSx0aGlzLl9yZW5kZXJlZExldmVsLmFkZChpKX1fcmVtb3ZlRnJvbUFycmF5KHQsZSl7Y29uc3QgaT1lLmluZGV4T2YodCk7LTEhPT1pJiZlLnNwbGljZShpLDEpfV9yZW5kZXJUb1RhcmdldCh0LGUpe2NvbnN0IGk9bmV3IGhuKGUpO2kubWluRmlsdGVyPUFpLGkubmVlZHNVcGRhdGU9ITA7Y29uc3Qgbj1uZXcgcXModC53LHQuaCkscj1uZXcgRnIoe21hcDppLHNpZGU6MH0pLHM9bmV3IEVzKG4scik7cy5wb3NpdGlvbi54PS10aGlzLl9zaXplLncvMit0LngrdC53LzIscy5wb3NpdGlvbi55PXRoaXMuX3NpemUuaC8yLXQueS10LmgvMjtjb25zdCBvPW5ldyBRYTtvLmFkZChzKTtjb25zdCBhPXRoaXMuX3JlbmRlcmVyLmdldFJlbmRlclRhcmdldCgpO3RoaXMuX3JlbmRlcmVyLnJlc2V0U3RhdGUoKSx0aGlzLl9yZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQodGhpcy5fcmVuZGVyLnRhcmdldCksdGhpcy5fcmVuZGVyZXIucmVuZGVyKG8sdGhpcy5fcmVuZGVyLmNhbWVyYSksdGhpcy5fcmVuZGVyZXIuc2V0UmVuZGVyVGFyZ2V0KGEpLG8ucmVtb3ZlKHMpLG4uZGlzcG9zZSgpLHIuZGlzcG9zZSgpLGkuZGlzcG9zZSgpfX12YXIgdm0seW0sYm0seG0sd20sU207IWZ1bmN0aW9uKHQpe3RbdC5DdXN0b209MF09XCJDdXN0b21cIix0W3QuRWFydGg9MV09XCJFYXJ0aFwiLHRbdC5UcmF2ZXJzaW5nPTJdPVwiVHJhdmVyc2luZ1wiLHRbdC5XYWl0aW5nPTNdPVwiV2FpdGluZ1wiLHRbdC5XYWl0aW5nSW50ZXJhY3RpdmVseT00XT1cIldhaXRpbmdJbnRlcmFjdGl2ZWx5XCJ9KHZtfHwodm09e30pKTtjbGFzcyBNbSBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUsaSksdGhpcy5faW1hZ2VUaWxlTG9hZGVyPW5ldyBzbShpLmFwaSksdGhpcy5fcm9pQ2FsY3VsYXRvcj1uZXcgYW0sdGhpcy5fcmVuZGVyZXJPcGVyYXRpb24kPW5ldyBULHRoaXMuX3JlbmRlcmVyQ3JlYXRvciQ9bmV3IFQsdGhpcy5fcmVuZGVyZXJEaXNwb3NlciQ9bmV3IFQsdGhpcy5fcmVuZGVyZXIkPXRoaXMuX3JlbmRlcmVyT3BlcmF0aW9uJC5waXBlKExlKCgodCxlKT0+ZSh0KSksbnVsbCksTnQoKHQ9Pm51bGwhPXQpKSx1ZSh2b2lkIDAsKHQ9PnQuZnJhbWVJZCkpKSx0aGlzLl9yZW5kZXJlckNyZWF0b3IkLnBpcGUocnQoKCgpPT50PT57aWYobnVsbCE9dCl0aHJvdyBuZXcgRXJyb3IoXCJNdWx0aXBsZSBpbWFnZSBwbGFuZSBzdGF0ZXMgY2FuIG5vdCBiZSBjcmVhdGVkIGF0IHRoZSBzYW1lIHRpbWVcIik7cmV0dXJuIG5ldyBubX0pKSkuc3Vic2NyaWJlKHRoaXMuX3JlbmRlcmVyT3BlcmF0aW9uJCksdGhpcy5fcmVuZGVyZXJEaXNwb3NlciQucGlwZShydCgoKCk9PnQ9Pih0LmRpc3Bvc2UoKSxudWxsKSkpKS5zdWJzY3JpYmUodGhpcy5fcmVuZGVyZXJPcGVyYXRpb24kKX1fYWN0aXZhdGUoKXtjb25zdCB0PXRoaXMuX3N1YnNjcmlwdGlvbnM7dC5wdXNoKHRoaXMuX3JlbmRlcmVyJC5waXBlKHJ0KCh0PT57Y29uc3QgZT17bmFtZTp0aGlzLl9uYW1lLHJlbmRlcmVyOntmcmFtZUlkOnQuZnJhbWVJZCxuZWVkc1JlbmRlcjp0Lm5lZWRzUmVuZGVyLHJlbmRlcjp0LnJlbmRlci5iaW5kKHQpLHBhc3M6cm0uQmFja2dyb3VuZH19O3JldHVybiB0LmNsZWFyTmVlZHNSZW5kZXIoKSxlfSkpKS5zdWJzY3JpYmUodGhpcy5fY29udGFpbmVyLmdsUmVuZGVyZXIucmVuZGVyJCkpLHRoaXMuX3JlbmRlcmVyQ3JlYXRvciQubmV4dChudWxsKSx0LnB1c2godGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50U3RhdGUkLnBpcGUocnQoKHQ9PmU9PihlLnVwZGF0ZUZyYW1lKHQpLGUpKSkpLnN1YnNjcmliZSh0aGlzLl9yZW5kZXJlck9wZXJhdGlvbiQpKTtjb25zdCBlPXRoaXMuX2NvbnRhaW5lci5jb25maWd1cmF0aW9uU2VydmljZS5pbWFnZVRpbGluZyQucGlwZShyaSgodD0+dD90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQ6bmV3IFQpKSx1ZSh2b2lkIDAsKHQ9PnQuc3RhdGUuY3VycmVudEltYWdlLmlkKSksYmkodGhpcy5fY29udGFpbmVyLmdsUmVuZGVyZXIud2ViR0xSZW5kZXJlciQpLHJ0KCgoW3QsZV0pPT57Y29uc3QgaT10LnN0YXRlLG49aS5jdXJyZW50SW1hZ2Uscj1pLmN1cnJlbnRUcmFuc2Zvcm07cmV0dXJuIG5ldyBfbShuLmlkLHIuYmFzaWNXaWR0aCxyLmJhc2ljSGVpZ2h0LG4uaW1hZ2UsdGhpcy5faW1hZ2VUaWxlTG9hZGVyLG5ldyBvbSxlKX0pKSxVZSgxKSxFKCkpO3QucHVzaChlLnN1YnNjcmliZSgoKCk9Pnt9KSkpLHQucHVzaChlLnBpcGUocnQoKHQ9PmU9PihlLnNldFRleHR1cmVQcm92aWRlcih0LmlkLHQpLGUpKSkpLnN1YnNjcmliZSh0aGlzLl9yZW5kZXJlck9wZXJhdGlvbiQpKSx0LnB1c2goZS5waXBlKHplKCkpLnN1YnNjcmliZSgodD0+e3RbMF0uYWJvcnQoKX0pKSk7Y29uc3QgaT10aGlzLl9jb250YWluZXIuY29uZmlndXJhdGlvblNlcnZpY2UuaW1hZ2VUaWxpbmckLnBpcGUocmkoKHQ9PnQ/Z3QodGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zdGF0ZSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5pblRyYW5zbGF0aW9uJCk6bmV3IFQpKSxyaSgoKFt0LGVdKT0+KHQ9PT12bS5UcmF2ZXJzaW5nfHx0PT09dm0uV2FpdGluZ3x8dD09PXZtLldhaXRpbmdJbnRlcmFjdGl2ZWx5KSYmIWU/dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhRnJhbWUkOkIoKSkpLHJ0KCh0PT4oe2NhbWVyYTp0LGhlaWdodDp0LnNpemUuaGVpZ2h0LnZhbHVlT2YoKSxsb29rYXQ6dC5jYW1lcmEubG9va2F0LmNsb25lKCksd2lkdGg6dC5zaXplLndpZHRoLnZhbHVlT2YoKSx6b29tOnQuem9vbS52YWx1ZU9mKCl9KSkpLHplKCkscnQoKChbdCxlXSk9Pntjb25zdCBpPXQud2lkdGg9PT1lLndpZHRoJiZ0LmhlaWdodD09PWUuaGVpZ2h0JiZ0Lnpvb209PT1lLnpvb20mJnQubG9va2F0LmVxdWFscyhlLmxvb2thdCk7cmV0dXJue2NhbWVyYTplLmNhbWVyYSxzdGFsbGVkOml9fSkpLHVlKCgodCxlKT0+dC5zdGFsbGVkPT09ZS5zdGFsbGVkKSksTnQoKHQ9PnQuc3RhbGxlZCkpLGJpKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnNpemUkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQpKTt0LnB1c2goZS5waXBlKHJpKCh0PT5pLnBpcGUocnQoKChbZSxpLG5dKT0+e2NvbnN0IHI9ZS5jYW1lcmEscz0obmV3IFdmKS52aWV3cG9ydFRvQmFzaWMoMCwwLG4sci5wZXJzcGVjdGl2ZSk7aWYoIShzWzBdPDB8fHNbMV08MHx8c1swXT4xfHxzWzFdPjEpKXJldHVyblt0aGlzLl9yb2lDYWxjdWxhdG9yLmNvbXB1dGVSZWdpb25PZkludGVyZXN0KHIsaSxuKSx0XX0pKSxOdCgodD0+ISF0KSkpKSksTnQoKHQ9PiF0WzFdLmRpc3Bvc2VkKSkpLnN1YnNjcmliZSgoKFt0LGVdKT0+e2Uuc2V0UmVnaW9uT2ZJbnRlcmVzdCh0KX0pKSk7Y29uc3Qgbj1lLnBpcGUocmkoKHQ9PnQuaGFzVGV4dHVyZSQpKSxuaSghMSksVWUoMSksRSgpKTt0LnB1c2gobi5zdWJzY3JpYmUoKCgpPT57fSkpKSx0LnB1c2godGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2UucGFuSW1hZ2VzJC5waXBlKE50KCh0PT4wPT09dC5sZW5ndGgpKSxydCgoKCk9PnQ9Pih0LmNsZWFyUGVyaXBoZXJ5UGxhbmVzKCksdCkpKSkuc3Vic2NyaWJlKHRoaXMuX3JlbmRlcmVyT3BlcmF0aW9uJCkpO2NvbnN0IHI9dGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2UucGFuSW1hZ2VzJC5waXBlKHJpKCh0PT5idCh0KS5waXBlKE10KCgoW3QsZV0pPT5ndCh0aGlzLl9uYXZpZ2F0b3IuZ3JhcGhTZXJ2aWNlLmNhY2hlSW1hZ2UkKHQuaWQpLnBpcGUodGUoKGU9Pihjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgcGVyaXBoZXJ5IGltYWdlICgke3QuaWR9KWAsZSksQigpKSkpKSxHKGUpKSkpKSkpLFplKCkpO3QucHVzaChyLnBpcGUocnQoKChbdCxlXSk9Pmk9PihpLmFkZFBlcmlwaGVyeVBsYW5lKHQsZSksaSkpKSkuc3Vic2NyaWJlKHRoaXMuX3JlbmRlcmVyT3BlcmF0aW9uJCkpLHQucHVzaChyLnBpcGUoTXQoKChbdF0pPT50LmNhY2hlSW1hZ2UkKCkucGlwZSh0ZSgoKCk9PkIoKSkpKSkpLHJ0KCh0PT5lPT4oZS51cGRhdGVUZXh0dXJlSW1hZ2UodC5pbWFnZSx0KSxlKSkpKS5zdWJzY3JpYmUodGhpcy5fcmVuZGVyZXJPcGVyYXRpb24kKSk7Y29uc3Qgcz10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShydCgodD0+dC5zdGF0ZS5hbHBoYTwxKSksdWUoKSksbz1ndCh0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmFjdGl2ZSQsdGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS5hY3RpdmUkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuaW5Nb3Rpb24kLHMpLnBpcGUocnQoKChbdCxlLGksbl0pPT4hKHR8fGV8fGl8fG4pKSksTnQoKHQ9PnQpKSk7dC5wdXNoKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhdGUkLnBpcGUocmkoKHQ9PnQ9PT12bS5UcmF2ZXJzaW5nP3RoaXMuX25hdmlnYXRvci5wYW5TZXJ2aWNlLnBhbkltYWdlcyQ6QigpKSkscmkoKHQ9Pm8ucGlwZShiaSh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKSxNdCgoKFssZSxpLG5dKT0+RyhbZSxpLG4sdF0pKSkpKSkscmkoKChbdCxlLGksbl0pPT57Y29uc3Qgcj10LmNhbWVyYS5sb29rYXQuY2xvbmUoKS5zdWIodC5jYW1lcmEucG9zaXRpb24pLHM9WyhuZXcgbGQpLnZpZXdpbmdEaXJlY3Rpb24oZS5yb3RhdGlvbikuYW5nbGVUbyhyKSx2b2lkIDBdLG89KG5ldyBXZikudmlld3BvcnRUb0Jhc2ljKDAsMCxpLHQucGVyc3BlY3RpdmUpO29bMF0+PTAmJm9bMF08PTEmJm9bMV0+PTAmJm9bMV08PTEmJihzWzBdPU51bWJlci5ORUdBVElWRV9JTkZJTklUWSk7Zm9yKGNvbnN0W3Rdb2Ygbil7Y29uc3QgZT0obmV3IGxkKS52aWV3aW5nRGlyZWN0aW9uKHQucm90YXRpb24pLmFuZ2xlVG8ocik7ZTxzWzBdJiYoc1swXT1lLHNbMV09dC5pZCl9cmV0dXJuIHNbMV0/dGhpcy5fbmF2aWdhdG9yLm1vdmVUbyQoc1sxXSkucGlwZSh0ZSgoKCk9PkIoKSkpKTpCKCl9KSkpLnN1YnNjcmliZSgpKX1fZGVhY3RpdmF0ZSgpe3RoaXMuX3JlbmRlcmVyRGlzcG9zZXIkLm5leHQobnVsbCksdGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfV9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpe3JldHVybnt9fX1NbS5jb21wb25lbnROYW1lPVwiaW1hZ2VcIjtjbGFzcyBUbXtjb25zdHJ1Y3Rvcih0LGUsaSl7dGhpcy5fY29tcG9uZW50PXQsdGhpcy5fY29udGFpbmVyPWUsdGhpcy5fbmF2aWdhdG9yPWksdGhpcy5fZW5hYmxlZD0hMX1nZXQgaXNFbmFibGVkKCl7cmV0dXJuIHRoaXMuX2VuYWJsZWR9ZW5hYmxlKCl7IXRoaXMuX2VuYWJsZWQmJnRoaXMuX2NvbXBvbmVudC5hY3RpdmF0ZWQmJih0aGlzLl9lbmFibGUoKSx0aGlzLl9lbmFibGVkPSEwLHRoaXMuX2NvbXBvbmVudC5jb25maWd1cmUodGhpcy5fZ2V0Q29uZmlndXJhdGlvbighMCkpKX1kaXNhYmxlKCl7dGhpcy5fZW5hYmxlZCYmKHRoaXMuX2Rpc2FibGUoKSx0aGlzLl9lbmFibGVkPSExLHRoaXMuX2NvbXBvbmVudC5hY3RpdmF0ZWQmJnRoaXMuX2NvbXBvbmVudC5jb25maWd1cmUodGhpcy5fZ2V0Q29uZmlndXJhdGlvbighMSkpKX19Y2xhc3MgQ20gZXh0ZW5kcyBUbXtfZW5hYmxlKCl7Y29uc3QgZT10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQucGlwZShyaSgodD0+dC5zZXF1ZW5jZUVkZ2VzJCkpKTt0aGlzLl9rZXlEb3duU3Vic2NyaXB0aW9uPXRoaXMuX2NvbnRhaW5lci5rZXlib2FyZFNlcnZpY2Uua2V5RG93biQucGlwZShiaShlKSkuc3Vic2NyaWJlKCgoW2UsaV0pPT57bGV0IG49bnVsbDtzd2l0Y2goZS5rZXlDb2RlKXtjYXNlIDM4Om49dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLk5leHQ7YnJlYWs7Y2FzZSA0MDpuPXQuTmF2aWdhdGlvbkRpcmVjdGlvbi5QcmV2O2JyZWFrO2RlZmF1bHQ6cmV0dXJufWlmKGUucHJldmVudERlZmF1bHQoKSxlLmFsdEtleSYmIWUuc2hpZnRLZXkmJmkuY2FjaGVkKWZvcihjb25zdCB0IG9mIGkuZWRnZXMpaWYodC5kYXRhLmRpcmVjdGlvbj09PW4pcmV0dXJuIHZvaWQgdGhpcy5fbmF2aWdhdG9yLm1vdmVUbyQodC50YXJnZXQpLnN1YnNjcmliZSh2b2lkIDAsKHQ9Pnt0IGluc3RhbmNlb2YgWmZ8fGNvbnNvbGUuZXJyb3IodCl9KSl9KSl9X2Rpc2FibGUoKXt0aGlzLl9rZXlEb3duU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCl9X2dldENvbmZpZ3VyYXRpb24odCl7cmV0dXJue2tleVNlcXVlbmNlTmF2aWdhdGlvbjp0fX19Y2xhc3MgRW0gZXh0ZW5kcyBUbXtjb25zdHJ1Y3Rvcih0LGUsaSxuKXtzdXBlcih0LGUsaSksdGhpcy5fc3BhdGlhbD1ufV9lbmFibGUoKXtjb25zdCBlPXRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJC5waXBlKHJpKCh0PT50LnNwYXRpYWxFZGdlcyQpKSk7dGhpcy5fa2V5RG93blN1YnNjcmlwdGlvbj10aGlzLl9jb250YWluZXIua2V5Ym9hcmRTZXJ2aWNlLmtleURvd24kLnBpcGUoYmkoZSx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQpKS5zdWJzY3JpYmUoKChbZSxpLG5dKT0+e2xldCByPWRkKG4uc3RhdGUuY3VycmVudEltYWdlLmNhbWVyYVR5cGUpLHM9bnVsbDtzd2l0Y2goZS5rZXlDb2RlKXtjYXNlIDM3OnM9ZS5zaGlmdEtleSYmIXI/dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5MZWZ0OnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwTGVmdDticmVhaztjYXNlIDM4OnM9ZS5zaGlmdEtleSYmIXI/dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlNwaGVyaWNhbDp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEZvcndhcmQ7YnJlYWs7Y2FzZSAzOTpzPWUuc2hpZnRLZXkmJiFyP3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5UdXJuUmlnaHQ6dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBSaWdodDticmVhaztjYXNlIDQwOnM9ZS5zaGlmdEtleSYmIXI/dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5VOnQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwQmFja3dhcmQ7YnJlYWs7ZGVmYXVsdDpyZXR1cm59aWYoZS5wcmV2ZW50RGVmYXVsdCgpLCEoZS5hbHRLZXl8fCFpLmNhY2hlZHx8ZS5zaGlmdEtleSYmcikpaWYocil7Y29uc3QgZT17fTtlW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwQmFja3dhcmRdPU1hdGguUEksZVt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcEZvcndhcmRdPTAsZVt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcExlZnRdPU1hdGguUEkvMixlW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwUmlnaHRdPS1NYXRoLlBJLzI7Y29uc3Qgcj10aGlzLl9yb3RhdGlvbkZyb21DYW1lcmEobi5zdGF0ZS5jYW1lcmEpLnBoaSxvPXRoaXMuX3NwYXRpYWwud3JhcEFuZ2xlKHIrZVtzXSksYT1NYXRoLlBJLzQsYz1pLmVkZ2VzLmZpbHRlcigoZT0+ZS5kYXRhLmRpcmVjdGlvbj09PXQuTmF2aWdhdGlvbkRpcmVjdGlvbi5TcGhlcmljYWx8fGUuZGF0YS5kaXJlY3Rpb249PT1zKSk7bGV0IGg9TnVtYmVyLk1BWF9WQUxVRSxsPW51bGw7Zm9yKGNvbnN0IHQgb2YgYyl7Y29uc3QgZT1NYXRoLmFicyh0aGlzLl9zcGF0aWFsLndyYXBBbmdsZSh0LmRhdGEud29ybGRNb3Rpb25BemltdXRoLW8pKTtlPE1hdGgubWluKGgsYSkmJihoPWUsbD10LnRhcmdldCl9aWYobnVsbD09bClyZXR1cm47dGhpcy5fbW92ZVRvKGwpfWVsc2UgdGhpcy5fbW92ZURpcihzLGkpfSkpfV9kaXNhYmxlKCl7dGhpcy5fa2V5RG93blN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfV9nZXRDb25maWd1cmF0aW9uKHQpe3JldHVybntrZXlTcGF0aWFsTmF2aWdhdGlvbjp0fX1fbW92ZURpcih0LGUpe2Zvcihjb25zdCBpIG9mIGUuZWRnZXMpaWYoaS5kYXRhLmRpcmVjdGlvbj09PXQpcmV0dXJuIHZvaWQgdGhpcy5fbW92ZVRvKGkudGFyZ2V0KX1fbW92ZVRvKHQpe3RoaXMuX25hdmlnYXRvci5tb3ZlVG8kKHQpLnN1YnNjcmliZSh2b2lkIDAsKHQ9Pnt0IGluc3RhbmNlb2YgWmZ8fGNvbnNvbGUuZXJyb3IodCl9KSl9X3JvdGF0aW9uRnJvbUNhbWVyYSh0KXtsZXQgZT10Lmxvb2thdC5jbG9uZSgpLnN1Yih0LnBvc2l0aW9uKSxpPWUuY2xvbmUoKS5kb3QodC51cCksbj1lLmNsb25lKCkuc3ViKHQudXAuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihpKSk7cmV0dXJue3BoaTpNYXRoLmF0YW4yKG4ueSxuLngpLHRoZXRhOk1hdGguUEkvMi10aGlzLl9zcGF0aWFsLmFuZ2xlVG9QbGFuZShlLnRvQXJyYXkoKSxbMCwwLDFdKX19fWNsYXNzIEltIGV4dGVuZHMgVG17Y29uc3RydWN0b3IodCxlLGksbil7c3VwZXIodCxlLGkpLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPW59X2VuYWJsZSgpe3RoaXMuX2tleURvd25TdWJzY3JpcHRpb249dGhpcy5fY29udGFpbmVyLmtleWJvYXJkU2VydmljZS5rZXlEb3duJC5waXBlKGJpKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCkpLnN1YnNjcmliZSgoKFt0LGUsaV0pPT57aWYodC5hbHRLZXl8fHQuY3RybEtleXx8dC5tZXRhS2V5KXJldHVybjtsZXQgbj0wO3N3aXRjaCh0LmtleSl7Y2FzZVwiK1wiOm49MTticmVhaztjYXNlXCItXCI6bj0tMTticmVhaztkZWZhdWx0OnJldHVybn10LnByZXZlbnREZWZhdWx0KCk7Y29uc3Qgcj10aGlzLl92aWV3cG9ydENvb3Jkcy51bnByb2plY3RGcm9tVmlld3BvcnQoMCwwLGUucGVyc3BlY3RpdmUpLHM9aS5wcm9qZWN0QmFzaWMoci50b0FycmF5KCkpO3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuem9vbUluKG4scyl9KSl9X2Rpc2FibGUoKXt0aGlzLl9rZXlEb3duU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCl9X2dldENvbmZpZ3VyYXRpb24odCl7cmV0dXJue2tleVpvb206dH19fWNsYXNzIEFtIGV4dGVuZHMgVG17X2VuYWJsZSgpe3RoaXMuX2tleURvd25TdWJzY3JpcHRpb249dGhpcy5fY29udGFpbmVyLmtleWJvYXJkU2VydmljZS5rZXlEb3duJC5waXBlKGJpKHRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5wbGF5aW5nJCx0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2UuZGlyZWN0aW9uJCx0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc3BlZWQkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJC5waXBlKHJpKCh0PT50LnNlcXVlbmNlRWRnZXMkKSkpLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhdGUkLnBpcGUocnQoKHQ9PnQ9PT12bS5FYXJ0aCkpLHVlKCkpKSkuc3Vic2NyaWJlKCgoW2UsaSxuLHIscyxvXSk9PntpZighKGUuYWx0S2V5fHxlLmN0cmxLZXl8fGUubWV0YUtleSkpe3N3aXRjaChlLmtleSl7Y2FzZVwiRFwiOmlmKCFlLnNoaWZ0S2V5KXJldHVybjtjb25zdCBhPWk/bnVsbDpuPT09dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLk5leHQ/dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlByZXY6bj09PXQuTmF2aWdhdGlvbkRpcmVjdGlvbi5QcmV2P3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5OZXh0Om51bGw7bnVsbCE9YSYmdGhpcy5fbmF2aWdhdG9yLnBsYXlTZXJ2aWNlLnNldERpcmVjdGlvbihhKTticmVhaztjYXNlXCIgXCI6aWYoZS5zaGlmdEtleSlyZXR1cm47aWYoIW8paWYoaSl0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc3RvcCgpO2Vsc2UgZm9yKGxldCB0IG9mIHMuZWRnZXMpdC5kYXRhLmRpcmVjdGlvbj09PW4mJnRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5wbGF5KCk7YnJlYWs7Y2FzZVwiPFwiOnRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5zZXRTcGVlZChyLS4wNSk7YnJlYWs7Y2FzZVwiPlwiOnRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5zZXRTcGVlZChyKy4wNSk7YnJlYWs7ZGVmYXVsdDpyZXR1cm59ZS5wcmV2ZW50RGVmYXVsdCgpfX0pKX1fZGlzYWJsZSgpe3RoaXMuX2tleURvd25TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKX1fZ2V0Q29uZmlndXJhdGlvbih0KXtyZXR1cm57a2V5UGxheTp0fX19Y2xhc3MgUG0gZXh0ZW5kcyBWZntjb25zdHJ1Y3Rvcih0LGUsaSl7c3VwZXIodCxlLGkpLHRoaXMuX2tleVBsYXlIYW5kbGVyPW5ldyBBbSh0aGlzLGUsaSksdGhpcy5fa2V5U2VxdWVuY2VOYXZpZ2F0aW9uSGFuZGxlcj1uZXcgQ20odGhpcyxlLGkpLHRoaXMuX2tleVNwYXRpYWxOYXZpZ2F0aW9uSGFuZGxlcj1uZXcgRW0odGhpcyxlLGksbmV3IGxkKSx0aGlzLl9rZXlab29tSGFuZGxlcj1uZXcgSW0odGhpcyxlLGksbmV3IFdmKX1nZXQga2V5UGxheSgpe3JldHVybiB0aGlzLl9rZXlQbGF5SGFuZGxlcn1nZXQga2V5U2VxdWVuY2VOYXZpZ2F0aW9uKCl7cmV0dXJuIHRoaXMuX2tleVNlcXVlbmNlTmF2aWdhdGlvbkhhbmRsZXJ9Z2V0IGtleVNwYXRpYWxOYXZpZ2F0aW9uKCl7cmV0dXJuIHRoaXMuX2tleVNwYXRpYWxOYXZpZ2F0aW9uSGFuZGxlcn1nZXQga2V5Wm9vbSgpe3JldHVybiB0aGlzLl9rZXlab29tSGFuZGxlcn1fYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnB1c2godGhpcy5fY29uZmlndXJhdGlvbiQuc3Vic2NyaWJlKCh0PT57dC5rZXlQbGF5P3RoaXMuX2tleVBsYXlIYW5kbGVyLmVuYWJsZSgpOnRoaXMuX2tleVBsYXlIYW5kbGVyLmRpc2FibGUoKSx0LmtleVNlcXVlbmNlTmF2aWdhdGlvbj90aGlzLl9rZXlTZXF1ZW5jZU5hdmlnYXRpb25IYW5kbGVyLmVuYWJsZSgpOnRoaXMuX2tleVNlcXVlbmNlTmF2aWdhdGlvbkhhbmRsZXIuZGlzYWJsZSgpLHQua2V5U3BhdGlhbE5hdmlnYXRpb24/dGhpcy5fa2V5U3BhdGlhbE5hdmlnYXRpb25IYW5kbGVyLmVuYWJsZSgpOnRoaXMuX2tleVNwYXRpYWxOYXZpZ2F0aW9uSGFuZGxlci5kaXNhYmxlKCksdC5rZXlab29tP3RoaXMuX2tleVpvb21IYW5kbGVyLmVuYWJsZSgpOnRoaXMuX2tleVpvb21IYW5kbGVyLmRpc2FibGUoKX0pKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5fa2V5UGxheUhhbmRsZXIuZGlzYWJsZSgpLHRoaXMuX2tleVNlcXVlbmNlTmF2aWdhdGlvbkhhbmRsZXIuZGlzYWJsZSgpLHRoaXMuX2tleVNwYXRpYWxOYXZpZ2F0aW9uSGFuZGxlci5kaXNhYmxlKCksdGhpcy5fa2V5Wm9vbUhhbmRsZXIuZGlzYWJsZSgpfV9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpe3JldHVybntrZXlQbGF5OiEwLGtleVNlcXVlbmNlTmF2aWdhdGlvbjohMCxrZXlTcGF0aWFsTmF2aWdhdGlvbjohMCxrZXlab29tOiEwfX19UG0uY29tcG9uZW50TmFtZT1cImtleWJvYXJkXCI7Y2xhc3MgUm17Y29uc3RydWN0b3IodCxlKXt0aGlzLl9uZWVkc1JlbmRlcj0hMSx0aGlzLl9pbnRlcmFjdGl2ZU9iamVjdHM9W10sdGhpcy5fbWFya2Vycz17fSx0aGlzLl9vYmplY3RNYXJrZXJzPXt9LHRoaXMuX3JheWNhc3Rlcj1lfHxuZXcgQnUsdGhpcy5fc2NlbmU9dHx8bmV3IFFhfWdldCBtYXJrZXJzKCl7cmV0dXJuIHRoaXMuX21hcmtlcnN9Z2V0IG5lZWRzUmVuZGVyKCl7cmV0dXJuIHRoaXMuX25lZWRzUmVuZGVyfWFkZCh0LGUpe3QuaWQgaW4gdGhpcy5fbWFya2VycyYmdGhpcy5fZGlzcG9zZSh0LmlkKSx0LmNyZWF0ZUdlb21ldHJ5KGUpLHRoaXMuX3NjZW5lLmFkZCh0Lmdlb21ldHJ5KSx0aGlzLl9tYXJrZXJzW3QuaWRdPXQ7Zm9yKGxldCBlIG9mIHQuZ2V0SW50ZXJhY3RpdmVPYmplY3RzKCkpdGhpcy5faW50ZXJhY3RpdmVPYmplY3RzLnB1c2goZSksdGhpcy5fb2JqZWN0TWFya2Vyc1tlLnV1aWRdPXQuaWQ7dGhpcy5fbmVlZHNSZW5kZXI9ITB9Y2xlYXIoKXtmb3IoY29uc3QgdCBpbiB0aGlzLl9tYXJrZXJzKXRoaXMuX21hcmtlcnMuaGFzT3duUHJvcGVydHkmJnRoaXMuX2Rpc3Bvc2UodCk7dGhpcy5fbmVlZHNSZW5kZXI9ITB9Z2V0KHQpe3JldHVybiB0aGlzLl9tYXJrZXJzW3RdfWdldEFsbCgpe3JldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tYXJrZXJzKS5tYXAoKHQ9PnRoaXMuX21hcmtlcnNbdF0pKX1oYXModCl7cmV0dXJuIHQgaW4gdGhpcy5fbWFya2Vyc31pbnRlcnNlY3RPYmplY3RzKFt0LGVdLGkpe3RoaXMuX3JheWNhc3Rlci5zZXRGcm9tQ2FtZXJhKG5ldyBybih0LGUpLGkpO2NvbnN0IG49dGhpcy5fcmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHModGhpcy5faW50ZXJhY3RpdmVPYmplY3RzKTtmb3IoY29uc3QgdCBvZiBuKWlmKHQub2JqZWN0LnV1aWQgaW4gdGhpcy5fb2JqZWN0TWFya2VycylyZXR1cm4gdGhpcy5fb2JqZWN0TWFya2Vyc1t0Lm9iamVjdC51dWlkXTtyZXR1cm4gbnVsbH1sZXJwQWx0aXR1ZGUodCxlLGkpe3QgaW4gdGhpcy5fbWFya2VycyYmKHRoaXMuX21hcmtlcnNbdF0ubGVycEFsdGl0dWRlKGUsaSksdGhpcy5fbmVlZHNSZW5kZXI9ITApfXJlbW92ZSh0KXt0IGluIHRoaXMuX21hcmtlcnMmJih0aGlzLl9kaXNwb3NlKHQpLHRoaXMuX25lZWRzUmVuZGVyPSEwKX1yZW5kZXIodCxlKXtlLnJlbmRlcih0aGlzLl9zY2VuZSx0KSx0aGlzLl9uZWVkc1JlbmRlcj0hMX11cGRhdGUodCxlLGkpe2lmKCEodCBpbiB0aGlzLl9tYXJrZXJzKSlyZXR1cm47dGhpcy5fbWFya2Vyc1t0XS51cGRhdGVQb3NpdGlvbihlLGkpLHRoaXMuX25lZWRzUmVuZGVyPSEwfV9kaXNwb3NlKHQpe2NvbnN0IGU9dGhpcy5fbWFya2Vyc1t0XTt0aGlzLl9zY2VuZS5yZW1vdmUoZS5nZW9tZXRyeSk7Zm9yKGxldCBpIG9mIGUuZ2V0SW50ZXJhY3RpdmVPYmplY3RzKCkpe2NvbnN0IGU9dGhpcy5faW50ZXJhY3RpdmVPYmplY3RzLmluZGV4T2YoaSk7LTEhPT1lP3RoaXMuX2ludGVyYWN0aXZlT2JqZWN0cy5zcGxpY2UoZSwxKTpjb25zb2xlLndhcm4oYE9iamVjdCBkb2VzIG5vdCBleGlzdCAoJHtpLmlkfSkgZm9yICR7dH1gKSxkZWxldGUgdGhpcy5fb2JqZWN0TWFya2Vyc1tpLnV1aWRdfWUuZGlzcG9zZUdlb21ldHJ5KCksZGVsZXRlIHRoaXMuX21hcmtlcnNbdF19fWNsYXNzIExtIGV4dGVuZHMgVmZ7Y29uc3RydWN0b3IodCxlLGkpe3N1cGVyKHQsZSxpKSx0aGlzLl9ncmFwaENhbGN1bGF0b3I9bmV3IHRkLHRoaXMuX21hcmtlclNjZW5lPW5ldyBSbSx0aGlzLl9tYXJrZXJTZXQ9bmV3IHlkLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPW5ldyBXZix0aGlzLl9yZWxhdGl2ZUdyb3VuZEFsdGl0dWRlPS0yfWFkZCh0KXt0aGlzLl9tYXJrZXJTZXQuYWRkKHQpfWZpcmUodCxlKXtzdXBlci5maXJlKHQsZSl9Z2V0KHQpe3JldHVybiB0aGlzLl9tYXJrZXJTZXQuZ2V0KHQpfWdldEFsbCgpe3JldHVybiB0aGlzLl9tYXJrZXJTZXQuZ2V0QWxsKCl9Z2V0TWFya2VySWRBdCh0KXtyZXR1cm4gbmV3IFByb21pc2UoKChlLGkpPT57dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJC5waXBlKEVlKCkscnQoKGU9Pntjb25zdCBpPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1RvVmlld3BvcnQodFswXSx0WzFdLHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIpO3JldHVybiB0aGlzLl9tYXJrZXJTY2VuZS5pbnRlcnNlY3RPYmplY3RzKGksZS5wZXJzcGVjdGl2ZSl9KSkpLnN1YnNjcmliZSgodD0+e2UodCl9KSwodD0+e2kodCl9KSl9KSl9aGFzKHQpe3JldHVybiB0aGlzLl9tYXJrZXJTZXQuaGFzKHQpfW9mZih0LGUpe3N1cGVyLm9mZih0LGUpfW9uKHQsZSl7c3VwZXIub24odCxlKX1yZW1vdmUodCl7dGhpcy5fbWFya2VyU2V0LnJlbW92ZSh0KX1yZW1vdmVBbGwoKXt0aGlzLl9tYXJrZXJTZXQucmVtb3ZlQWxsKCl9X2FjdGl2YXRlKCl7Y29uc3QgdD10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShydCgodD0+dC5zdGF0ZS5jYW1lcmEucG9zaXRpb24ueit0aGlzLl9yZWxhdGl2ZUdyb3VuZEFsdGl0dWRlKSksdWUoKCh0LGUpPT5NYXRoLmFicyh0LWUpPC4wMSkpLFVlKDEpLEUoKSksZT1ndCh0LHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCkucGlwZShFZSgpLHJ0KCgoKT0+e30pKSxVZSgxKSxFKCkpLGk9dGhpcy5fY29uZmlndXJhdGlvbiQucGlwZShydCgodD0+KHt2aXNpYmxlQkJveFNpemU6TWF0aC5tYXgoMSxNYXRoLm1pbigyMDAsdC52aXNpYmxlQkJveFNpemUpKX0pKSkpLG49dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUocnQoKHQ9PnQubG5nTGF0KSksVWUoMSksRSgpKSxyPWd0KGksbikucGlwZShydCgoKFt0LGVdKT0+dGhpcy5fZ3JhcGhDYWxjdWxhdG9yLmJvdW5kaW5nQm94Q29ybmVycyhlLHQudmlzaWJsZUJCb3hTaXplLzIpKSksVWUoMSksRSgpKSxzPWd0KEF0KEcodGhpcy5fbWFya2VyU2V0KSx0aGlzLl9tYXJrZXJTZXQuY2hhbmdlZCQpLHIpLnBpcGUocnQoKChbdCxlXSk9PnQuc2VhcmNoKGUpKSkpLG89dGhpcy5fc3Vic2NyaXB0aW9ucztvLnB1c2goZS5waXBlKHJpKCgoKT0+cy5waXBlKGJpKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCx0KSkpKSkuc3Vic2NyaWJlKCgoW3QsZSxpXSk9Pntjb25zdCBuPXRoaXMuX21hcmtlclNjZW5lLHI9bi5tYXJrZXJzLHM9T2JqZWN0LmFzc2lnbih7fSxyKTtmb3IoY29uc3QgbyBvZiB0KWlmKG8uaWQgaW4gcilkZWxldGUgc1tvLmlkXTtlbHNle2NvbnN0IHQ9SnUoby5sbmdMYXQubG5nLG8ubG5nTGF0LmxhdCxlLmFsdCtpLGUubG5nLGUubGF0LGUuYWx0KTtuLmFkZChvLHQpfWZvcihjb25zdCB0IGluIHMpcy5oYXNPd25Qcm9wZXJ0eSh0KSYmbi5yZW1vdmUodCl9KSkpLG8ucHVzaChlLnBpcGUocmkoKCgpPT50aGlzLl9tYXJrZXJTZXQudXBkYXRlZCQucGlwZShiaShyLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCx0KSkpKSkuc3Vic2NyaWJlKCgoW3QsW2UsaV0sbixyXSk9Pntjb25zdCBzPXRoaXMuX21hcmtlclNjZW5lO2Zvcihjb25zdCBvIG9mIHQpe2NvbnN0IHQ9cy5oYXMoby5pZCksYT1vLmxuZ0xhdC5sYXQ+ZS5sYXQmJm8ubG5nTGF0LmxhdDxpLmxhdCYmby5sbmdMYXQubG5nPmUubG5nJiZvLmxuZ0xhdC5sbmc8aS5sbmc7aWYoYSl7Y29uc3QgdD1KdShvLmxuZ0xhdC5sbmcsby5sbmdMYXQubGF0LG4uYWx0K3Isbi5sbmcsbi5sYXQsbi5hbHQpO3MuYWRkKG8sdCl9ZWxzZSFhJiZ0JiZzLnJlbW92ZShvLmlkKX19KSkpLG8ucHVzaCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQucGlwZShKZSgxKSxiaSh0KSkuc3Vic2NyaWJlKCgoW3QsZV0pPT57Y29uc3QgaT10aGlzLl9tYXJrZXJTY2VuZTtmb3IoY29uc3QgbiBvZiBpLmdldEFsbCgpKXtjb25zdCByPUp1KG4ubG5nTGF0LmxuZyxuLmxuZ0xhdC5sYXQsdC5hbHQrZSx0LmxuZyx0LmxhdCx0LmFsdCk7aS51cGRhdGUobi5pZCxyKX19KSkpLG8ucHVzaCh0LnBpcGUoSmUoMSksYmkodGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5yZWZlcmVuY2UkLG4pKS5zdWJzY3JpYmUoKChbdCxlLGldKT0+e2NvbnN0IG49dGhpcy5fbWFya2VyU2NlbmUscj1KdShpLmxuZyxpLmxhdCxlLmFsdCt0LGUubG5nLGUubGF0LGUuYWx0KTtmb3IoY29uc3QgaSBvZiBuLmdldEFsbCgpKXtjb25zdCBzPUp1KGkubG5nTGF0LmxuZyxpLmxuZ0xhdC5sYXQsZS5hbHQrdCxlLmxuZyxlLmxhdCxlLmFsdCksbz1zWzBdLXJbMF0sYT1zWzFdLXJbMV0sYz1NYXRoLnNxcnQobypvK2EqYSk7Yz41MHx8bi5sZXJwQWx0aXR1ZGUoaS5pZCx0LE1hdGgubWluKDEsTWF0aC5tYXgoMCwxLjItMS4yKmMvNTApKSl9fSkpKSxvLnB1c2godGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50U3RhdGUkLnBpcGUocnQoKHQ9Pntjb25zdCBlPXRoaXMuX21hcmtlclNjZW5lO3JldHVybntuYW1lOnRoaXMuX25hbWUscmVuZGVyZXI6e2ZyYW1lSWQ6dC5pZCxuZWVkc1JlbmRlcjplLm5lZWRzUmVuZGVyLHJlbmRlcjplLnJlbmRlci5iaW5kKGUpLHBhc3M6cm0uT3BhcXVlfX19KSkpLnN1YnNjcmliZSh0aGlzLl9jb250YWluZXIuZ2xSZW5kZXJlci5yZW5kZXIkKSk7Y29uc3QgYT1ndCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VNb3ZlJCkucGlwZShydCgoKFt0LGVdKT0+e2NvbnN0IGk9dGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcixbbixyXT10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNQb3NpdGlvbihlLGkpLHM9dGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzVG9WaWV3cG9ydChuLHIsaSk7cmV0dXJuIHRoaXMuX21hcmtlclNjZW5lLmludGVyc2VjdE9iamVjdHMocyx0LnBlcnNwZWN0aXZlKX0pKSxVZSgxKSxFKCkpLGM9dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5maWx0ZXJlZCQodGhpcy5fbmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZ1N0YXJ0JCkucGlwZShydCgoKCk9PiEwKSkpLGg9dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5maWx0ZXJlZCQodGhpcy5fbmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZ0VuZCQpLnBpcGUocnQoKCgpPT4hMSkpKSxsPU90KGMsaCkucGlwZShuaSghMSkpO28ucHVzaChPdChjLnBpcGUoYmkoYSkpLGd0KGgsRyhudWxsKSkpLnBpcGUobmkoWyExLG51bGxdKSx6ZSgpKS5zdWJzY3JpYmUoKChbdCxlXSk9Pntjb25zdCBpPWVbMF0sbj1pP1wibWFya2VyZHJhZ3N0YXJ0XCI6XCJtYXJrZXJkcmFnZW5kXCIscj1pP2VbMV06dFsxXSxzPXttYXJrZXI6dGhpcy5fbWFya2VyU2NlbmUuZ2V0KHIpLHRhcmdldDp0aGlzLHR5cGU6bn07dGhpcy5maXJlKG4scyl9KSkpO2NvbnN0IHU9T3QodGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5tb3VzZURvd24kLnBpcGUocnQoKCgpPT4hMCkpKSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRvY3VtZW50TW91c2VVcCQucGlwZShydCgoKCk9PiExKSkpKS5waXBlKG5pKCExKSk7by5wdXNoKGd0KHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuYWN0aXZlJCxhLnBpcGUodWUoKSksdSxsKS5waXBlKHJ0KCgoW3QsZSxpLG5dKT0+IXQmJm51bGwhPWUmJml8fG4pKSx1ZSgpKS5zdWJzY3JpYmUoKHQ9Pnt0Pyh0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmNsYWltTW91c2UodGhpcy5fbmFtZSwxKSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmNsYWltV2hlZWwodGhpcy5fbmFtZSwxKSk6KHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UudW5jbGFpbU1vdXNlKHRoaXMuX25hbWUpLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UudW5jbGFpbVdoZWVsKHRoaXMuX25hbWUpKX0pKSk7Y29uc3QgZD10aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkJCh0aGlzLl9uYW1lLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VEcmFnU3RhcnQkKS5waXBlKGJpKGEsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCkscnQoKChbdCxlLGldKT0+e2NvbnN0IG49dGhpcy5fbWFya2VyU2NlbmUuZ2V0KGUpLHI9dGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcixbcyxvXT10aGlzLl92aWV3cG9ydENvb3Jkcy5wcm9qZWN0VG9DYW52YXMobi5nZW9tZXRyeS5wb3NpdGlvbi50b0FycmF5KCkscixpLnBlcnNwZWN0aXZlKSxbYSxjXT10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNQb3NpdGlvbih0LHIpO3JldHVybltuLFthLXMsYy1vXSxpXX0pKSxVZSgxKSxFKCkpO28ucHVzaCh0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkJCh0aGlzLl9uYW1lLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VEcmFnJCkucGlwZShiaShkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCxpKSkuc3Vic2NyaWJlKCgoW3QsW2UsaSxuXSxyLHNdKT0+e2lmKCF0aGlzLl9tYXJrZXJTY2VuZS5oYXMoZS5pZCkpcmV0dXJuO2NvbnN0IG89dGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcixbYSxjXT10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNQb3NpdGlvbih0LG8pLGg9YS1pWzBdLGw9Yy1pWzFdLFt1LGRdPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1RvVmlld3BvcnQoaCxsLG8pLHA9bmV3IGZuKHUsZCwxKS51bnByb2plY3Qobi5wZXJzcGVjdGl2ZSkuc3ViKG4ucGVyc3BlY3RpdmUucG9zaXRpb24pLm5vcm1hbGl6ZSgpLGY9TWF0aC5taW4odGhpcy5fcmVsYXRpdmVHcm91bmRBbHRpdHVkZS9wLnoscy52aXNpYmxlQkJveFNpemUvMi0uMSk7aWYoZjwwKXJldHVybjtjb25zdCBtPXAuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihmKS5hZGQobi5wZXJzcGVjdGl2ZS5wb3NpdGlvbik7bS56PW4ucGVyc3BlY3RpdmUucG9zaXRpb24ueit0aGlzLl9yZWxhdGl2ZUdyb3VuZEFsdGl0dWRlO2NvbnN0W2csX109S3UobS54LG0ueSxtLnosci5sbmcsci5sYXQsci5hbHQpO3RoaXMuX21hcmtlclNjZW5lLnVwZGF0ZShlLmlkLG0udG9BcnJheSgpLHtsYXQ6Xyxsbmc6Z30pLHRoaXMuX21hcmtlclNldC51cGRhdGUoZSk7Y29uc3Qgdj1cIm1hcmtlcnBvc2l0aW9uXCIseT17bWFya2VyOmUsdGFyZ2V0OnRoaXMsdHlwZTp2fTt0aGlzLmZpcmUodix5KX0pKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5fbWFya2VyU2NlbmUuY2xlYXIoKX1fZ2V0RGVmYXVsdENvbmZpZ3VyYXRpb24oKXtyZXR1cm57dmlzaWJsZUJCb3hTaXplOjEwMH19fWZ1bmN0aW9uIE9tKHQsZSl7cmV0dXJuIHQueDw9TWF0aC5tYXgoZS5wMS54LGUucDIueCkmJnQueD49TWF0aC5taW4oZS5wMS54LGUucDIueCkmJnQueT49TWF0aC5tYXgoZS5wMS55LGUucDIueSkmJnQueT49TWF0aC5taW4oZS5wMS55LGUucDIueSl9ZnVuY3Rpb24gTm0odCxlKXtjb25zdCBpPXQucDIueC10LnAxLngsbj10LnAyLnktdC5wMS55LHI9ZS5wMi54LWUucDEueCxzPWUucDIueS1lLnAxLnksbz1pKnMtbipyO3JldHVybiBvKm88MWUtMTAqKGkqaStuKm4pKihyKnIrcypzKX1mdW5jdGlvbiBEbSh0LGUsaSl7Y29uc3Qgbj0oZS55LXQueSkqKGkueC1lLngpLShpLnktZS55KSooZS54LXQueCk7cmV0dXJuKHI9bik+MD8xOnI8MD8tMTowO3ZhciByfWZ1bmN0aW9uICRtKHQsZSl7aWYoTm0odCxlKSlyZXR1cm4hMTtjb25zdCBpPURtKHQucDEsdC5wMixlLnAxKSxuPURtKHQucDEsdC5wMixlLnAyKSxyPURtKGUucDEsZS5wMix0LnAxKSxzPURtKGUucDEsZS5wMix0LnAyKTtyZXR1cm4gaSE9PW4mJnIhPT1zfHwoISgwIT09aXx8IU9tKGUucDEsdCkpfHwoISgwIT09bnx8IU9tKGUucDIsdCkpfHwoISgwIT09cnx8IU9tKHQucDEsZSkpfHwhKDAhPT1zfHwhT20odC5wMixlKSkpKSl9ZnVuY3Rpb24ga20odCxlKXtpZihObSh0LGUpKXJldHVybjtjb25zdCBpPXQucDEueCxuPXQucDIueCxyPXQucDEueSxzPXQucDIueSxvPWUucDEueCxhPWUucDIueCxjPWUucDEueSxoPWUucDIueSxsPShpLW4pKihjLWgpLShyLXMpKihvLWEpO3JldHVybnt4OigoaSpzLXIqbikqKG8tYSktKGktbikqKG8qaC1jKmEpKS9sLHk6KChpKnMtcipuKSooYy1oKS0oci1zKSoobypoLWMqYSkpL2x9fWZ1bmN0aW9uIHptKHQsZSl7cmV0dXJuIHQ+PS0xJiZ0PD0xJiZlPj0tMSYmZTw9MX1mdW5jdGlvbiBGbSh0LGUpe3JldHVybiB0Pj0wJiZ0PD0xJiZlPj0wJiZlPD0xfWZ1bmN0aW9uIEJtKHQsZSxpKXtjb25zdCBuPWZ1bmN0aW9uKHQpe2xldCBlPVtdLGk9W1swLDBdLFsxLDBdLFsxLDFdLFswLDFdXSxuPVtbMSwwXSxbMCwxXSxbLTEsMF0sWzAsLTFdXTtmb3IobGV0IHI9MDtyPDQ7KytyKXtsZXQgcz1pW3JdLG89bltyXTtmb3IobGV0IGk9MDtpPHQ7KytpKWUucHVzaChbc1swXStvWzBdKmkvdCxzWzFdK29bMV0qaS90XSl9cmV0dXJuIGV9KDEwMCkubWFwKChuPT5pLmJhc2ljVG9WaWV3cG9ydFNhZmUoblswXSxuWzFdLHQsZSkpKSxyPVtdLHM9W3t4Oi0xLHk6MX0se3g6MSx5OjF9LHt4OjEseTotMX0se3g6LTEseTotMX1dLG89WyExLCExLCExLCExXTtmb3IobGV0IHQ9MDt0PG4ubGVuZ3RoO3QrKyl7Y29uc3QgZT1uW3RdLGk9blsodCsxKSVuLmxlbmd0aF07aWYobnVsbD09PWUpY29udGludWU7aWYobnVsbD09PWkpe3ptKGVbMF0sZVsxXSkmJnIucHVzaChlKTtjb250aW51ZX1jb25zdFthLGNdPWUsW2gsbF09aTtpZih6bShhLGMpKWlmKHptKGgsbCkpci5wdXNoKGUpO2Vsc2UgZm9yKGxldCB0PTA7dDw0O3QrKyl7Y29uc3QgaT17cDE6e3g6YSx5OmN9LHAyOnt4OmgseTpsfX0sbj17cDE6c1t0XSxwMjpzWyh0KzEpJTRdfTtpZigkbShpLG4pKXtjb25zdCBzPWttKGksbik7ci5wdXNoKGUsW3MueCxzLnldKSxvW3RdPSEwfX19Y29uc3RbYSxjXT1pLnZpZXdwb3J0VG9CYXNpYygtMSwxLHQsZSksW2gsbF09aS52aWV3cG9ydFRvQmFzaWMoMSwxLHQsZSksW3UsZF09aS52aWV3cG9ydFRvQmFzaWMoMSwtMSx0LGUpLFtwLGZdPWkudmlld3BvcnRUb0Jhc2ljKC0xLC0xLHQsZSk7Rm0oYSxjKSYmKG9bM109b1swXT0hMCksRm0oaCxsKSYmKG9bMF09b1sxXT0hMCksRm0odSxkKSYmKG9bMV09b1syXT0hMCksRm0ocCxmKSYmKG9bMl09b1szXT0hMCk7Y29uc3QgbT1bLTEsLTEsMSwxXTtmb3IobGV0IHQgb2Ygcil7Y29uc3QgZT10WzBdLGk9dFsxXTtlPm1bMV0mJihtWzFdPWUpLGU8bVszXSYmKG1bM109ZSksaT5tWzBdJiYobVswXT1pKSxpPG1bMl0mJihtWzJdPWkpfWNvbnN0IGc9WzEsMSwtMSwtMV0sXz1bXTtmb3IobGV0IHQ9MDt0PDQ7dCsrKW9bdF0/Xy5wdXNoKDApOl8ucHVzaChNYXRoLmFicyhnW3RdLW1bdF0pKTtyZXR1cm4gX31MbS5jb21wb25lbnROYW1lPVwibWFya2VyXCI7Y2xhc3Mgam0gZXh0ZW5kcyBUbXtjb25zdHJ1Y3Rvcih0LGUsaSxuLHIpe3N1cGVyKHQsZSxpKSx0aGlzLl9zcGF0aWFsPXIsdGhpcy5fdmlld3BvcnRDb29yZHM9bn1fZW5hYmxlKCl7Y29uc3QgdD10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShydCgodD0+dC5zdGF0ZS5hbHBoYTwxKSksdWUoKSk7dGhpcy5fYm91bmNlU3Vic2NyaXB0aW9uPWd0KHQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5pblRyYW5zbGF0aW9uJCx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmFjdGl2ZSQsdGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS5hY3RpdmUkKS5waXBlKHJ0KCh0PT50WzBdfHx0WzFdfHx0WzJdfHx0WzNdKSksdWUoKSxyaSgodD0+dD9CKCk6Z3QodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kLnBpcGUoRWUoKSkpKSksYmkodGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2UucGFuSW1hZ2VzJCkpLnN1YnNjcmliZSgoKFtbdCxlXSxpXSk9PntpZighZS5oYXNWYWxpZFNjYWxlJiZ0LmNhbWVyYS5mb2NhbDwuMSlyZXR1cm47aWYoMD09PXQucGVyc3BlY3RpdmUuYXNwZWN0fHx0LnBlcnNwZWN0aXZlLmFzcGVjdD09PU51bWJlci5QT1NJVElWRV9JTkZJTklUWSlyZXR1cm47Y29uc3Qgbj1CbShlLHQucGVyc3BlY3RpdmUsdGhpcy5fdmlld3BvcnRDb29yZHMpLHI9dGhpcy5fdmlld3BvcnRDb29yZHMudmlld3BvcnRUb0Jhc2ljKDAsMCxlLHQucGVyc3BlY3RpdmUpOyhyWzBdPDB8fHJbMF0+MSkmJmkubGVuZ3RoPjAmJihuWzBdPW5bMl09MCk7Zm9yKGNvbnN0WyxlXW9mIGkpe2NvbnN0IGk9Qm0oZSx0LnBlcnNwZWN0aXZlLHRoaXMuX3ZpZXdwb3J0Q29vcmRzKTtmb3IobGV0IHQ9MTt0PG4ubGVuZ3RoO3QrPTIpaVt0XTxuW3RdJiYoblt0XT1pW3RdKX1pZihNYXRoLm1heCguLi5uKTwuMDEpcmV0dXJuO2NvbnN0IHM9blsxXS1uWzNdLG89blswXS1uWzJdLGE9dGhpcy5fdmlld3BvcnRDb29yZHMudW5wcm9qZWN0RnJvbVZpZXdwb3J0KDAsMCx0LnBlcnNwZWN0aXZlKS5zdWIodC5wZXJzcGVjdGl2ZS5wb3NpdGlvbiksYz10aGlzLl92aWV3cG9ydENvb3Jkcy51bnByb2plY3RGcm9tVmlld3BvcnQocywwLHQucGVyc3BlY3RpdmUpLnN1Yih0LnBlcnNwZWN0aXZlLnBvc2l0aW9uKSxoPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLnVucHJvamVjdEZyb21WaWV3cG9ydCgwLG8sdC5wZXJzcGVjdGl2ZSkuc3ViKHQucGVyc3BlY3RpdmUucG9zaXRpb24pO2xldCBsPShzPjA/MTotMSkqYy5hbmdsZVRvKGEpLHU9KG8+MD8xOi0xKSpoLmFuZ2xlVG8oYSk7Y29uc3QgZD1NYXRoLlBJLzYwO2w9dGhpcy5fc3BhdGlhbC5jbGFtcCguMSpsLC1kLGQpLHU9dGhpcy5fc3BhdGlhbC5jbGFtcCguMSp1LC1kLGQpLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uucm90YXRlVW5ib3VuZGVkKHtwaGk6bCx0aGV0YTp1fSl9KSl9X2Rpc2FibGUoKXt0aGlzLl9ib3VuY2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKX1fZ2V0Q29uZmlndXJhdGlvbigpe3JldHVybnt9fX1jbGFzcyBIbXtzdGF0aWMgZmlsdGVyZWRQYWlyd2lzZU1vdXNlRHJhZyQodCxlKXtyZXR1cm4gdGhpcy5fZmlsdGVyZWRQYWlyd2lzZU1vdXNlRHJhZyQodCxlLGUubW91c2VEcmFnU3RhcnQkLGUubW91c2VEcmFnJCxlLm1vdXNlRHJhZ0VuZCQpfXN0YXRpYyBmaWx0ZXJlZFBhaXJ3aXNlTW91c2VSaWdodERyYWckKHQsZSl7cmV0dXJuIHRoaXMuX2ZpbHRlcmVkUGFpcndpc2VNb3VzZURyYWckKHQsZSxlLm1vdXNlUmlnaHREcmFnU3RhcnQkLGUubW91c2VSaWdodERyYWckLGUubW91c2VSaWdodERyYWdFbmQkKX1zdGF0aWMgX2ZpbHRlcmVkUGFpcndpc2VNb3VzZURyYWckKHQsZSxpLG4scil7cmV0dXJuIGUuZmlsdGVyZWQkKHQsaSkucGlwZShyaSgoaT0+T3QoQXQoRyhpKSxlLmZpbHRlcmVkJCh0LG4pKSxlLmZpbHRlcmVkJCh0LHIpLnBpcGUocnQoKCgpPT5udWxsKSkpKS5waXBlKGxpKCh0PT4hIXQpKSxuaShudWxsKSkpKSx6ZSgpLE50KCh0PT5udWxsIT10WzBdJiZudWxsIT10WzFdKSkpfX1jbGFzcyBVbSBleHRlbmRzIFRte2NvbnN0cnVjdG9yKHQsZSxpLG4scil7c3VwZXIodCxlLGkpLHRoaXMuX3NwYXRpYWw9cix0aGlzLl92aWV3cG9ydENvb3Jkcz1ufV9lbmFibGUoKXtsZXQgdD10aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkJCh0aGlzLl9jb21wb25lbnQubmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZ1N0YXJ0JCkucGlwZShydCgoKCk9PiEwKSksWmUoKSksZT10aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkJCh0aGlzLl9jb21wb25lbnQubmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZ0VuZCQpLnBpcGUocnQoKCgpPT4hMSkpLFplKCkpO3RoaXMuX2FjdGl2ZU1vdXNlU3Vic2NyaXB0aW9uPU90KHQsZSkuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuYWN0aXZhdGUkKTtjb25zdCBpPU90KHQsZSkucGlwZShyaSgodD0+dD90aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRvY3VtZW50TW91c2VNb3ZlJDpCKCkpKSk7dGhpcy5fcHJldmVudERlZmF1bHRTdWJzY3JpcHRpb249T3QoaSx0aGlzLl9jb250YWluZXIudG91Y2hTZXJ2aWNlLnRvdWNoTW92ZSQpLnN1YnNjcmliZSgodD0+e3QucHJldmVudERlZmF1bHQoKX0pKTtsZXQgbj10aGlzLl9jb250YWluZXIudG91Y2hTZXJ2aWNlLnNpbmdsZVRvdWNoRHJhZ1N0YXJ0JC5waXBlKHJ0KCgoKT0+ITApKSkscj10aGlzLl9jb250YWluZXIudG91Y2hTZXJ2aWNlLnNpbmdsZVRvdWNoRHJhZ0VuZCQucGlwZShydCgoKCk9PiExKSkpO3RoaXMuX2FjdGl2ZVRvdWNoU3Vic2NyaXB0aW9uPU90KG4scikuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lci50b3VjaFNlcnZpY2UuYWN0aXZhdGUkKTtjb25zdCBzPXRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHJ0KCh0PT5kZCh0LnN0YXRlLmN1cnJlbnRJbWFnZS5jYW1lcmFUeXBlKXx8dC5zdGF0ZS5pbWFnZXNBaGVhZDwxKSksdWUoKSxyaSgodD0+e2lmKCF0KXJldHVybiBCKCk7Y29uc3QgZT1IbS5maWx0ZXJlZFBhaXJ3aXNlTW91c2VEcmFnJCh0aGlzLl9jb21wb25lbnQubmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlKSxpPU90KHRoaXMuX2NvbnRhaW5lci50b3VjaFNlcnZpY2Uuc2luZ2xlVG91Y2hEcmFnU3RhcnQkLHRoaXMuX2NvbnRhaW5lci50b3VjaFNlcnZpY2Uuc2luZ2xlVG91Y2hEcmFnJCx0aGlzLl9jb250YWluZXIudG91Y2hTZXJ2aWNlLnNpbmdsZVRvdWNoRHJhZ0VuZCQucGlwZShydCgoKCk9Pm51bGwpKSkpLnBpcGUocnQoKHQ9Pm51bGwhPXQmJnQudG91Y2hlcy5sZW5ndGg+MD90LnRvdWNoZXNbMF06bnVsbCkpLHplKCksTnQoKHQ9Pm51bGwhPXRbMF0mJm51bGwhPXRbMV0pKSk7cmV0dXJuIE90KGUsaSl9KSksYmkodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kLHRoaXMuX25hdmlnYXRvci5wYW5TZXJ2aWNlLnBhbkltYWdlcyQpLHJ0KCgoW3QsZSxpLG5dKT0+e2xldCByPXRbMF0scz10WzFdLG89cy5jbGllbnRYLXIuY2xpZW50WCxhPXMuY2xpZW50WS1yLmNsaWVudFksYz10aGlzLl9jb250YWluZXIuY29udGFpbmVyLFtoLGxdPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1Bvc2l0aW9uKHMsYyksdT10aGlzLl92aWV3cG9ydENvb3Jkcy51bnByb2plY3RGcm9tQ2FudmFzKGgsbCxjLGUucGVyc3BlY3RpdmUpLnN1YihlLnBlcnNwZWN0aXZlLnBvc2l0aW9uKSxkPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLnVucHJvamVjdEZyb21DYW52YXMoaC1vLGwsYyxlLnBlcnNwZWN0aXZlKS5zdWIoZS5wZXJzcGVjdGl2ZS5wb3NpdGlvbikscD10aGlzLl92aWV3cG9ydENvb3Jkcy51bnByb2plY3RGcm9tQ2FudmFzKGgsbC1hLGMsZS5wZXJzcGVjdGl2ZSkuc3ViKGUucGVyc3BlY3RpdmUucG9zaXRpb24pLGY9KG8+MD8xOi0xKSpkLmFuZ2xlVG8odSksbT0oYT4wPy0xOjEpKnAuYW5nbGVUbyh1KTtjb25zdCBnPUJtKGksZS5wZXJzcGVjdGl2ZSx0aGlzLl92aWV3cG9ydENvb3Jkcyk7Zm9yKGNvbnN0Wyx0XW9mIG4pe2NvbnN0IGk9Qm0odCxlLnBlcnNwZWN0aXZlLHRoaXMuX3ZpZXdwb3J0Q29vcmRzKTtmb3IobGV0IHQ9MDt0PGcubGVuZ3RoO3QrKylpW3RdPGdbdF0mJihnW3RdPWlbdF0pfXJldHVybiBnWzBdPjAmJm08MCYmKG0vPU1hdGgubWF4KDEsMjAwKmdbMF0pKSxnWzJdPjAmJm0+MCYmKG0vPU1hdGgubWF4KDEsMjAwKmdbMl0pKSxnWzFdPjAmJmY8MCYmKGYvPU1hdGgubWF4KDEsMjAwKmdbMV0pKSxnWzNdPjAmJmY+MCYmKGYvPU1hdGgubWF4KDEsMjAwKmdbM10pKSx7cGhpOmYsdGhldGE6bX19KSksWmUoKSk7dmFyIG87dGhpcy5fcm90YXRlV2l0aG91dEluZXJ0aWFTdWJzY3JpcHRpb249cy5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJvdGF0ZVdpdGhvdXRJbmVydGlhKHQpfSkpLHRoaXMuX3JvdGF0ZVN1YnNjcmlwdGlvbj1zLnBpcGUoTGUoKCh0LGUpPT4odGhpcy5fZHJhaW5CdWZmZXIodCksdC5wdXNoKFtEYXRlLm5vdygpLGVdKSx0KSksW10pLChvPU90KHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuZmlsdGVyZWQkKHRoaXMuX2NvbXBvbmVudC5uYW1lLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VEcmFnRW5kJCksdGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS5zaW5nbGVUb3VjaERyYWdFbmQkKSxmdW5jdGlvbih0KXtyZXR1cm4gdC5saWZ0KG5ldyBXZShvKSl9KSxydCgodD0+e2NvbnN0IGU9dGhpcy5fZHJhaW5CdWZmZXIodC5zbGljZSgpKSxpPXtwaGk6MCx0aGV0YTowfTtmb3IoY29uc3QgdCBvZiBlKWkucGhpKz10WzFdLnBoaSxpLnRoZXRhKz10WzFdLnRoZXRhO2NvbnN0IG49ZS5sZW5ndGg7bj4wJiYoaS5waGkvPW4saS50aGV0YS89bik7Y29uc3Qgcj1NYXRoLlBJLzE4O3JldHVybiBpLnBoaT10aGlzLl9zcGF0aWFsLmNsYW1wKGkucGhpLC1yLHIpLGkudGhldGE9dGhpcy5fc3BhdGlhbC5jbGFtcChpLnRoZXRhLC1yLHIpLGl9KSkpLnN1YnNjcmliZSgodD0+e3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uucm90YXRlKHQpfSkpfV9kaXNhYmxlKCl7dGhpcy5fYWN0aXZlTW91c2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9hY3RpdmVUb3VjaFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3ByZXZlbnREZWZhdWx0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fcm90YXRlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fcm90YXRlV2l0aG91dEluZXJ0aWFTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9hY3RpdmVNb3VzZVN1YnNjcmlwdGlvbj1udWxsLHRoaXMuX2FjdGl2ZVRvdWNoU3Vic2NyaXB0aW9uPW51bGwsdGhpcy5fcHJldmVudERlZmF1bHRTdWJzY3JpcHRpb249bnVsbCx0aGlzLl9yb3RhdGVTdWJzY3JpcHRpb249bnVsbH1fZ2V0Q29uZmlndXJhdGlvbih0KXtyZXR1cm57ZHJhZ1Bhbjp0fX1fZHJhaW5CdWZmZXIodCl7Y29uc3QgZT1EYXRlLm5vdygpO2Zvcig7dC5sZW5ndGg+MCYmZS10WzBdWzBdPjUwOyl0LnNoaWZ0KCk7cmV0dXJuIHR9fWNsYXNzIFZtIGV4dGVuZHMgVG17Y29uc3RydWN0b3IodCxlLGksbixyKXtzdXBlcih0LGUsaSksdGhpcy5fc3BhdGlhbD1yLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPW4sdGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWZ9X2VuYWJsZSgpe2NvbnN0IHQ9dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zdGF0ZSQucGlwZShydCgodD0+dD09PXZtLkVhcnRoKSksVWUoMSksRSgpKSxlPXRoaXMuX3N1YnNjcmlwdGlvbnM7ZS5wdXNoKHQucGlwZShyaSgodD0+dD90aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlV2hlZWwkOkIoKSkpKS5zdWJzY3JpYmUoKHQ9Pnt0LnByZXZlbnREZWZhdWx0KCl9KSkpLGUucHVzaCh0LnBpcGUocmkoKHQ9PnQ/SG0uZmlsdGVyZWRQYWlyd2lzZU1vdXNlRHJhZyQodGhpcy5fY29tcG9uZW50Lm5hbWUsdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZSkucGlwZShOdCgoKFt0LGVdKT0+ISh0LmN0cmxLZXkmJmUuY3RybEtleSkpKSk6QigpKSksYmkodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKSxydCgoKFtbdCxlXSxpLG5dKT0+e2NvbnN0IHI9WzAsMCwxXSxzPVswLDAsLTJdLG89dGhpcy5fcGxhbmVJbnRlcnNlY3Rpb24oZSxyLHMsaS5wZXJzcGVjdGl2ZSx0aGlzLl9jb250YWluZXIuY29udGFpbmVyKSxhPXRoaXMuX3BsYW5lSW50ZXJzZWN0aW9uKHQscixzLGkucGVyc3BlY3RpdmUsdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcik7aWYoIW98fCFhKXJldHVybiBudWxsO3JldHVybihuZXcgZm4pLnN1YlZlY3RvcnMobyxhKS5tdWx0aXBseVNjYWxhcigtMSkudG9BcnJheSgpfSkpLE50KCh0PT4hIXQpKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS50cnVjayh0KX0pKSksZS5wdXNoKHQucGlwZShyaSgodD0+dD9IbS5maWx0ZXJlZFBhaXJ3aXNlTW91c2VEcmFnJCh0aGlzLl9jb21wb25lbnQubmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlKS5waXBlKE50KCgoW3QsZV0pPT50LmN0cmxLZXkmJmUuY3RybEtleSkpKTpCKCkpKSxydCgoKFt0LGVdKT0+dGhpcy5fbW91c2VQYWlyVG9Sb3RhdGlvbih0LGUpKSkpLnN1YnNjcmliZSgodD0+e3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uub3JiaXQodCl9KSkpLGUucHVzaCh0LnBpcGUocmkoKHQ9PnQ/SG0uZmlsdGVyZWRQYWlyd2lzZU1vdXNlUmlnaHREcmFnJCh0aGlzLl9jb21wb25lbnQubmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlKS5waXBlKE50KCgoW3QsZV0pPT4hdC5jdHJsS2V5JiYhZS5jdHJsS2V5KSkpOkIoKSkpLHJ0KCgoW3QsZV0pPT50aGlzLl9tb3VzZVBhaXJUb1JvdGF0aW9uKHQsZSkpKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5vcmJpdCh0KX0pKSksZS5wdXNoKHQucGlwZShyaSgodD0+dD90aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkV2hlZWwkKHRoaXMuX2NvbXBvbmVudC5uYW1lLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VXaGVlbCQpOkIoKSkpLHJ0KCh0PT57bGV0IGU9dC5kZWx0YVk7MT09PXQuZGVsdGFNb2RlP2UqPTQwOjI9PT10LmRlbHRhTW9kZSYmKGUqPTgwMCk7cmV0dXJuLWUvdGhpcy5fdmlld3BvcnRDb29yZHMuY29udGFpbmVyVG9DYW52YXModGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcilbMV19KSkpLnN1YnNjcmliZSgodD0+e3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuZG9sbHkodCl9KSkpfV9kaXNhYmxlKCl7dGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfV9nZXRDb25maWd1cmF0aW9uKCl7cmV0dXJue319X2V2ZW50VG9WaWV3cG9ydCh0LGUpe2NvbnN0IGk9dGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzUG9zaXRpb24odCxlKTtyZXR1cm4gdGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzVG9WaWV3cG9ydChpWzBdLGlbMV0sZSl9X21vdXNlUGFpclRvUm90YXRpb24odCxlKXtjb25zdFtpLG5dPXRoaXMuX2V2ZW50VG9WaWV3cG9ydChlLHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIpLFtyLHNdPXRoaXMuX2V2ZW50VG9WaWV3cG9ydCh0LHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIpO3JldHVybntwaGk6KHItaSkqTWF0aC5QSSx0aGV0YToobi1zKSpNYXRoLlBJLzJ9fV9wbGFuZUludGVyc2VjdGlvbih0LGUsaSxuLHIpe2NvbnN0W3Msb109dGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzUG9zaXRpb24odCxyKSxhPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLnVucHJvamVjdEZyb21DYW52YXMocyxvLHIsbikuc3ViKG4ucG9zaXRpb24pLm5vcm1hbGl6ZSgpO2lmKE1hdGguYWJzKHRoaXMuX3NwYXRpYWwuYW5nbGVUb1BsYW5lKGEudG9BcnJheSgpLGUpKTxNYXRoLlBJLzkwKXJldHVybiBudWxsO2NvbnN0IGM9bi5wb3NpdGlvbi5jbG9uZSgpLGg9KG5ldyBmbikuZnJvbUFycmF5KGUpLGw9KG5ldyBmbikuZnJvbUFycmF5KGkpLHU9KG5ldyBmbikuc3ViVmVjdG9ycyhsLGMpLmRvdChoKS9hLmNsb25lKCkuZG90KGgpLGQ9KG5ldyBmbikuYWRkVmVjdG9ycyhjLGEubXVsdGlwbHlTY2FsYXIodSkpO3JldHVybiB0aGlzLl92aWV3cG9ydENvb3Jkcy53b3JsZFRvQ2FtZXJhKGQudG9BcnJheSgpLG4pWzJdPjA/bnVsbDpkfX1jbGFzcyBHbSBleHRlbmRzIFRte2NvbnN0cnVjdG9yKHQsZSxpLG4pe3N1cGVyKHQsZSxpKSx0aGlzLl92aWV3cG9ydENvb3Jkcz1ufV9lbmFibGUoKXt0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmNsYWltV2hlZWwodGhpcy5fY29tcG9uZW50Lm5hbWUsMCksdGhpcy5fcHJldmVudERlZmF1bHRTdWJzY3JpcHRpb249dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5tb3VzZVdoZWVsJC5zdWJzY3JpYmUoKHQ9Pnt0LnByZXZlbnREZWZhdWx0KCl9KSksdGhpcy5fem9vbVN1YnNjcmlwdGlvbj10aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkV2hlZWwkKHRoaXMuX2NvbXBvbmVudC5uYW1lLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VXaGVlbCQpLnBpcGUoYmkodGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50U3RhdGUkLCgodCxlKT0+W3QsZV0pKSxOdCgodD0+e2xldCBlPXRbMV0uc3RhdGU7cmV0dXJuIGRkKGUuY3VycmVudEltYWdlLmNhbWVyYVR5cGUpfHxlLmltYWdlc0FoZWFkPDF9KSkscnQoKHQ9PnRbMF0pKSxiaSh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQsKCh0LGUsaSk9Plt0LGUsaV0pKSkuc3Vic2NyaWJlKCh0PT57bGV0IGU9dFswXSxpPXRbMV0sbj10WzJdLHI9dGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcixbcyxvXT10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNQb3NpdGlvbihlLHIpLGE9dGhpcy5fdmlld3BvcnRDb29yZHMudW5wcm9qZWN0RnJvbUNhbnZhcyhzLG8scixpLnBlcnNwZWN0aXZlKSxjPW4ucHJvamVjdEJhc2ljKGEudG9BcnJheSgpKSxoPWUuZGVsdGFZOzE9PT1lLmRlbHRhTW9kZT9oKj00MDoyPT09ZS5kZWx0YU1vZGUmJihoKj04MDApO2xldCBsPS0zKmgvdGhpcy5fdmlld3BvcnRDb29yZHMuY29udGFpbmVyVG9DYW52YXMocilbMV07dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS56b29tSW4obCxjKX0pKX1fZGlzYWJsZSgpe3RoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UudW5jbGFpbVdoZWVsKHRoaXMuX2NvbXBvbmVudC5uYW1lKSx0aGlzLl9wcmV2ZW50RGVmYXVsdFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3pvb21TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9wcmV2ZW50RGVmYXVsdFN1YnNjcmlwdGlvbj1udWxsLHRoaXMuX3pvb21TdWJzY3JpcHRpb249bnVsbH1fZ2V0Q29uZmlndXJhdGlvbih0KXtyZXR1cm57c2Nyb2xsWm9vbTp0fX19Y2xhc3MgcW0gZXh0ZW5kcyBUbXtjb25zdHJ1Y3Rvcih0LGUsaSxuKXtzdXBlcih0LGUsaSksdGhpcy5fdmlld3BvcnRDb29yZHM9bn1fZW5hYmxlKCl7dGhpcy5fcHJldmVudERlZmF1bHRTdWJzY3JpcHRpb249dGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS5waW5jaCQuc3Vic2NyaWJlKCh0PT57dC5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCl9KSk7bGV0IHQ9dGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS5waW5jaFN0YXJ0JC5waXBlKHJ0KCh0PT4hMCkpKSxlPXRoaXMuX2NvbnRhaW5lci50b3VjaFNlcnZpY2UucGluY2hFbmQkLnBpcGUocnQoKHQ9PiExKSkpO3RoaXMuX2FjdGl2ZVN1YnNjcmlwdGlvbj1PdCh0LGUpLnN1YnNjcmliZSh0aGlzLl9jb250YWluZXIudG91Y2hTZXJ2aWNlLmFjdGl2YXRlJCksdGhpcy5fem9vbVN1YnNjcmlwdGlvbj10aGlzLl9jb250YWluZXIudG91Y2hTZXJ2aWNlLnBpbmNoJC5waXBlKGJpKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJCksTnQoKHQ9PntsZXQgZT10WzFdLnN0YXRlO3JldHVybiBkZChlLmN1cnJlbnRJbWFnZS5jYW1lcmFUeXBlKXx8ZS5pbWFnZXNBaGVhZDwxfSkpLHJ0KCh0PT50WzBdKSksYmkodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKSkuc3Vic2NyaWJlKCgoW3QsZSxpXSk9PntsZXQgbj10aGlzLl9jb250YWluZXIuY29udGFpbmVyLFtyLHNdPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1Bvc2l0aW9uKHQsbiksbz10aGlzLl92aWV3cG9ydENvb3Jkcy51bnByb2plY3RGcm9tQ2FudmFzKHIscyxuLGUucGVyc3BlY3RpdmUpLGE9aS5wcm9qZWN0QmFzaWMoby50b0FycmF5KCkpO2NvbnN0W2MsaF09dGhpcy5fdmlld3BvcnRDb29yZHMuY29udGFpbmVyVG9DYW52YXMobik7bGV0IGw9Myp0LmRpc3RhbmNlQ2hhbmdlL01hdGgubWluKGMsaCk7dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS56b29tSW4obCxhKX0pKX1fZGlzYWJsZSgpe3RoaXMuX2FjdGl2ZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3ByZXZlbnREZWZhdWx0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fem9vbVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3ByZXZlbnREZWZhdWx0U3Vic2NyaXB0aW9uPW51bGwsdGhpcy5fem9vbVN1YnNjcmlwdGlvbj1udWxsfV9nZXRDb25maWd1cmF0aW9uKHQpe3JldHVybnt0b3VjaFpvb206dH19fWNsYXNzIFdtIGV4dGVuZHMgVmZ7Y29uc3RydWN0b3IodCxlLGkpe3N1cGVyKHQsZSxpKTtjb25zdCBuPW5ldyBsZCxyPW5ldyBXZjt0aGlzLl9ib3VuY2VIYW5kbGVyPW5ldyBqbSh0aGlzLGUsaSxyLG4pLHRoaXMuX2RyYWdQYW5IYW5kbGVyPW5ldyBVbSh0aGlzLGUsaSxyLG4pLHRoaXMuX2VhcnRoQ29udHJvbEhhbmRsZXI9bmV3IFZtKHRoaXMsZSxpLHIsbiksdGhpcy5fc2Nyb2xsWm9vbUhhbmRsZXI9bmV3IEdtKHRoaXMsZSxpLHIpLHRoaXMuX3RvdWNoWm9vbUhhbmRsZXI9bmV3IHFtKHRoaXMsZSxpLHIpfWdldCBkcmFnUGFuKCl7cmV0dXJuIHRoaXMuX2RyYWdQYW5IYW5kbGVyfWdldCBlYXJ0aENvbnRyb2woKXtyZXR1cm4gdGhpcy5fZWFydGhDb250cm9sSGFuZGxlcn1nZXQgc2Nyb2xsWm9vbSgpe3JldHVybiB0aGlzLl9zY3JvbGxab29tSGFuZGxlcn1nZXQgdG91Y2hab29tKCl7cmV0dXJuIHRoaXMuX3RvdWNoWm9vbUhhbmRsZXJ9X2FjdGl2YXRlKCl7dGhpcy5fYm91bmNlSGFuZGxlci5lbmFibGUoKSx0aGlzLl9zdWJzY3JpcHRpb25zLnB1c2godGhpcy5fY29uZmlndXJhdGlvbiQuc3Vic2NyaWJlKCh0PT57dC5kcmFnUGFuP3RoaXMuX2RyYWdQYW5IYW5kbGVyLmVuYWJsZSgpOnRoaXMuX2RyYWdQYW5IYW5kbGVyLmRpc2FibGUoKSx0LmVhcnRoQ29udHJvbD90aGlzLl9lYXJ0aENvbnRyb2xIYW5kbGVyLmVuYWJsZSgpOnRoaXMuX2VhcnRoQ29udHJvbEhhbmRsZXIuZGlzYWJsZSgpLHQuc2Nyb2xsWm9vbT90aGlzLl9zY3JvbGxab29tSGFuZGxlci5lbmFibGUoKTp0aGlzLl9zY3JvbGxab29tSGFuZGxlci5kaXNhYmxlKCksdC50b3VjaFpvb20/dGhpcy5fdG91Y2hab29tSGFuZGxlci5lbmFibGUoKTp0aGlzLl90b3VjaFpvb21IYW5kbGVyLmRpc2FibGUoKX0pKSksdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5jbGFpbU1vdXNlKHRoaXMuX25hbWUsMCl9X2RlYWN0aXZhdGUoKXt0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLnVuY2xhaW1Nb3VzZSh0aGlzLl9uYW1lKSx0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5fYm91bmNlSGFuZGxlci5kaXNhYmxlKCksdGhpcy5fZHJhZ1BhbkhhbmRsZXIuZGlzYWJsZSgpLHRoaXMuX2VhcnRoQ29udHJvbEhhbmRsZXIuZGlzYWJsZSgpLHRoaXMuX3Njcm9sbFpvb21IYW5kbGVyLmRpc2FibGUoKSx0aGlzLl90b3VjaFpvb21IYW5kbGVyLmRpc2FibGUoKX1fZ2V0RGVmYXVsdENvbmZpZ3VyYXRpb24oKXtyZXR1cm57ZHJhZ1BhbjohMCxlYXJ0aENvbnRyb2w6ITAsc2Nyb2xsWm9vbTohMCx0b3VjaFpvb206ITB9fX1XbS5jb21wb25lbnROYW1lPVwicG9pbnRlclwiO2NsYXNzIFhte2NvbnN0cnVjdG9yKHQpe3RoaXMuX2RvY3VtZW50PXR8fGRvY3VtZW50fWdldCBkb2N1bWVudCgpe3JldHVybiB0aGlzLl9kb2N1bWVudH1jcmVhdGVFbGVtZW50KHQsZSxpKXtjb25zdCBuPXRoaXMuX2RvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCk7cmV0dXJuIGUmJihuLmNsYXNzTmFtZT1lKSxpJiZpLmFwcGVuZENoaWxkKG4pLG59fWNsYXNzIFltIGV4dGVuZHMgVmZ7Y29uc3RydWN0b3IodCxlLGksbil7c3VwZXIodCxlLGkpLHRoaXMuX2RvbT1ufHxuZXcgWG0sdGhpcy5fcG9wdXBzPVtdLHRoaXMuX2FkZGVkJD1uZXcgVCx0aGlzLl9wb3B1cHMkPW5ldyBUfWFkZCh0KXtmb3IoY29uc3QgZSBvZiB0KS0xPT09dGhpcy5fcG9wdXBzLmluZGV4T2YoZSkmJih0aGlzLl9wb3B1cHMucHVzaChlKSx0aGlzLl9hY3RpdmF0ZWQmJmUuc2V0UGFyZW50Q29udGFpbmVyKHRoaXMuX3BvcHVwQ29udGFpbmVyKSk7dGhpcy5fYWRkZWQkLm5leHQodCksdGhpcy5fcG9wdXBzJC5uZXh0KHRoaXMuX3BvcHVwcyl9Z2V0QWxsKCl7cmV0dXJuIHRoaXMuX3BvcHVwcy5zbGljZSgpfXJlbW92ZSh0KXtmb3IoY29uc3QgZSBvZiB0KXRoaXMuX3JlbW92ZShlKTt0aGlzLl9wb3B1cHMkLm5leHQodGhpcy5fcG9wdXBzKX1yZW1vdmVBbGwoKXtmb3IoY29uc3QgdCBvZiB0aGlzLl9wb3B1cHMuc2xpY2UoKSl0aGlzLl9yZW1vdmUodCk7dGhpcy5fcG9wdXBzJC5uZXh0KHRoaXMuX3BvcHVwcyl9X2FjdGl2YXRlKCl7dGhpcy5fcG9wdXBDb250YWluZXI9dGhpcy5fZG9tLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIixcIm1hcGlsbGFyeS1wb3B1cC1jb250YWluZXJcIix0aGlzLl9jb250YWluZXIuY29udGFpbmVyKTtmb3IoY29uc3QgdCBvZiB0aGlzLl9wb3B1cHMpdC5zZXRQYXJlbnRDb250YWluZXIodGhpcy5fcG9wdXBDb250YWluZXIpO2NvbnN0IHQ9dGhpcy5fc3Vic2NyaXB0aW9uczt0LnB1c2goZ3QodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5zaXplJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKS5zdWJzY3JpYmUoKChbdCxlLGldKT0+e2Zvcihjb25zdCBuIG9mIHRoaXMuX3BvcHVwcyluLnVwZGF0ZSh0LGUsaSl9KSkpO2NvbnN0IGU9dGhpcy5fcG9wdXBzJC5waXBlKG5pKHRoaXMuX3BvcHVwcykscmkoKHQ9PmJ0KHQpLnBpcGUoTXQoKHQ9PnQuY2hhbmdlZCQpKSkpKSxydCgodD0+W3RdKSkpO3QucHVzaChPdCh0aGlzLl9hZGRlZCQsZSkucGlwZShiaSh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnNpemUkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQpKS5zdWJzY3JpYmUoKChbdCxlLGksbl0pPT57Zm9yKGNvbnN0IHIgb2YgdClyLnVwZGF0ZShlLGksbil9KSkpfV9kZWFjdGl2YXRlKCl7dGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpO2Zvcihjb25zdCB0IG9mIHRoaXMuX3BvcHVwcyl0LnJlbW92ZSgpO3RoaXMuX2NvbnRhaW5lci5jb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5fcG9wdXBDb250YWluZXIpLGRlbGV0ZSB0aGlzLl9wb3B1cENvbnRhaW5lcn1fZ2V0RGVmYXVsdENvbmZpZ3VyYXRpb24oKXtyZXR1cm57fX1fcmVtb3ZlKHQpe2NvbnN0IGU9dGhpcy5fcG9wdXBzLmluZGV4T2YodCk7aWYoLTE9PT1lKXJldHVybjtjb25zdCBpPXRoaXMuX3BvcHVwcy5zcGxpY2UoZSwxKVswXTt0aGlzLl9hY3RpdmF0ZWQmJmkucmVtb3ZlKCl9fVltLmNvbXBvbmVudE5hbWU9XCJwb3B1cFwiLGZ1bmN0aW9uKHQpe3RbdC5TZXF1ZW5jZT0wXT1cIlNlcXVlbmNlXCIsdFt0LlNwYXRpYWw9MV09XCJTcGF0aWFsXCJ9KHltfHwoeW09e30pKSxmdW5jdGlvbih0KXt0W3QuRGVmYXVsdD0wXT1cIkRlZmF1bHRcIix0W3QuUGxheWJhY2s9MV09XCJQbGF5YmFja1wiLHRbdC5UaW1lbGluZT0yXT1cIlRpbWVsaW5lXCJ9KGJtfHwoYm09e30pKTtjbGFzcyBabXtjb25zdHJ1Y3Rvcih0KXt0aGlzLl9jb250YWluZXI9dCx0aGlzLl9taW5UaHJlc2hvbGRXaWR0aD0zMjAsdGhpcy5fbWF4VGhyZXNob2xkV2lkdGg9MTQ4MCx0aGlzLl9taW5UaHJlc2hvbGRIZWlnaHQ9MjQwLHRoaXMuX21heFRocmVzaG9sZEhlaWdodD04MjAsdGhpcy5fc3RlcHBlckRlZmF1bHRXaWR0aD0xMDgsdGhpcy5fY29udHJvbHNEZWZhdWx0V2lkdGg9ODgsdGhpcy5fZGVmYXVsdEhlaWdodD0zMCx0aGlzLl9leHBhbmRDb250cm9scz0hMSx0aGlzLl9tb2RlPWJtLkRlZmF1bHQsdGhpcy5fc3BlZWQ9LjUsdGhpcy5fY2hhbmdpbmdTcGVlZD0hMSx0aGlzLl9pbmRleD1udWxsLHRoaXMuX2NoYW5naW5nUG9zaXRpb249ITEsdGhpcy5fbW91c2VFbnRlckRpcmVjdGlvbiQ9bmV3IFQsdGhpcy5fbW91c2VMZWF2ZURpcmVjdGlvbiQ9bmV3IFQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQ9bmV3IFQsdGhpcy5fbm90aWZ5Q2hhbmdpbmdQb3NpdGlvbkNoYW5nZWQkPW5ldyBULHRoaXMuX25vdGlmeVNwZWVkQ2hhbmdlZCQ9bmV3IFQsdGhpcy5fbm90aWZ5SW5kZXhDaGFuZ2VkJD1uZXcgVH1nZXQgY2hhbmdlZCQoKXtyZXR1cm4gdGhpcy5fbm90aWZ5Q2hhbmdlZCR9Z2V0IGNoYW5naW5nUG9zaXRpb25DaGFuZ2VkJCgpe3JldHVybiB0aGlzLl9ub3RpZnlDaGFuZ2luZ1Bvc2l0aW9uQ2hhbmdlZCR9Z2V0IHNwZWVkJCgpe3JldHVybiB0aGlzLl9ub3RpZnlTcGVlZENoYW5nZWQkfWdldCBpbmRleCQoKXtyZXR1cm4gdGhpcy5fbm90aWZ5SW5kZXhDaGFuZ2VkJH1nZXQgbW91c2VFbnRlckRpcmVjdGlvbiQoKXtyZXR1cm4gdGhpcy5fbW91c2VFbnRlckRpcmVjdGlvbiR9Z2V0IG1vdXNlTGVhdmVEaXJlY3Rpb24kKCl7cmV0dXJuIHRoaXMuX21vdXNlTGVhdmVEaXJlY3Rpb24kfWFjdGl2YXRlKCl7dGhpcy5fY2hhbmdpbmdTdWJzY3JpcHRpb258fCh0aGlzLl9jaGFuZ2luZ1N1YnNjcmlwdGlvbj1PdCh0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRvY3VtZW50TW91c2VVcCQsdGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS50b3VjaEVuZCQucGlwZShOdCgodD0+MD09PXQudG91Y2hlcy5sZW5ndGgpKSkpLnN1YnNjcmliZSgoKCk9Pnt0aGlzLl9jaGFuZ2luZ1NwZWVkJiYodGhpcy5fY2hhbmdpbmdTcGVlZD0hMSksdGhpcy5fY2hhbmdpbmdQb3NpdGlvbiYmdGhpcy5fc2V0Q2hhbmdpbmdQb3NpdGlvbighMSl9KSkpfWRlYWN0aXZhdGUoKXt0aGlzLl9jaGFuZ2luZ1N1YnNjcmlwdGlvbiYmKHRoaXMuX2NoYW5naW5nU3BlZWQ9ITEsdGhpcy5fY2hhbmdpbmdQb3NpdGlvbj0hMSx0aGlzLl9leHBhbmRDb250cm9scz0hMSx0aGlzLl9tb2RlPWJtLkRlZmF1bHQsdGhpcy5fY2hhbmdpbmdTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9jaGFuZ2luZ1N1YnNjcmlwdGlvbj1udWxsKX1yZW5kZXIodCxlLGksbixyLHMsbyxhLGMpe2lmKCExPT09ZS52aXNpYmxlKXJldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS1jb250YWluZXJcIix7fSxbXSk7Y29uc3QgaD10aGlzLl9jcmVhdGVTdGVwcGVyKHQsZSxvLGksYSxjKSxsPXRoaXMuX2NyZWF0ZVNlcXVlbmNlQ29udHJvbHMoaSksdT10aGlzLl9jcmVhdGVQbGF5YmFja0NvbnRyb2xzKGksbixhLGUpLGQ9dGhpcy5fY3JlYXRlVGltZWxpbmVDb250cm9scyhpLHIscyk7cmV0dXJuIGpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLWNvbnRhaW5lclwiLFtoLGwsdSxkXSl9Z2V0Q29udGFpbmVyV2lkdGgodCxlKXtsZXQgaT1lLm1pbldpZHRoLG49ZS5tYXhXaWR0aDtuPGkmJihuPWkpO2xldCByPSh0LndpZHRoLXRoaXMuX21pblRocmVzaG9sZFdpZHRoKS8odGhpcy5fbWF4VGhyZXNob2xkV2lkdGgtdGhpcy5fbWluVGhyZXNob2xkV2lkdGgpLHM9KHQuaGVpZ2h0LXRoaXMuX21pblRocmVzaG9sZEhlaWdodCkvKHRoaXMuX21heFRocmVzaG9sZEhlaWdodC10aGlzLl9taW5UaHJlc2hvbGRIZWlnaHQpO3JldHVybiBpK01hdGgubWF4KDAsTWF0aC5taW4oMSxNYXRoLm1pbihyLHMpKSkqKG4taSl9X2NyZWF0ZVBvc2l0aW9uSW5wdXQodCxlKXt0aGlzLl9pbmRleD10O2NvbnN0IGk9dD0+e3RoaXMuX2luZGV4PU51bWJlcih0LnRhcmdldC52YWx1ZSksdGhpcy5fbm90aWZ5SW5kZXhDaGFuZ2VkJC5uZXh0KHRoaXMuX2luZGV4KX0sbj10aGlzLl9jb250YWluZXIuZG9tQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLHI9dD0+e3Quc3RvcFByb3BhZ2F0aW9uKCksdGhpcy5fc2V0Q2hhbmdpbmdQb3NpdGlvbighMCl9LHM9dD0+eyEwPT09dGhpcy5fY2hhbmdpbmdQb3NpdGlvbiYmdC5zdG9wUHJvcGFnYXRpb24oKX0sbz17bWF4Om51bGwhPWU/ZToxLG1pbjowLG9uY2hhbmdlOmksb25pbnB1dDppLG9ua2V5ZG93bjp0PT57XCJBcnJvd0Rvd25cIiE9PXQua2V5JiZcIkFycm93TGVmdFwiIT09dC5rZXkmJlwiQXJyb3dSaWdodFwiIT09dC5rZXkmJlwiQXJyb3dVcFwiIT09dC5rZXl8fHQucHJldmVudERlZmF1bHQoKX0sb25wb2ludGVyZG93bjpyLG9ucG9pbnRlcm1vdmU6cyxvbnRvdWNobW92ZTpzLG9udG91Y2hzdGFydDpyLHN0eWxlOnt3aWR0aDpgJHtNYXRoLm1heCgyNzYsTWF0aC5taW4oNDEwLDUrLjgqbi53aWR0aCkpLTY1fXB4YH0sdHlwZTpcInJhbmdlXCIsdmFsdWU6bnVsbCE9dD90OjB9LGE9bnVsbD09dHx8bnVsbD09ZXx8ZTw9MTthJiYoby5kaXNhYmxlZD1cInRydWVcIik7Y29uc3QgYz1qZi5oKFwiaW5wdXQubWFwaWxsYXJ5LXNlcXVlbmNlLXBvc2l0aW9uXCIsbyxbXSksaD1hP1wiLm1hcGlsbGFyeS1zZXF1ZW5jZS1wb3NpdGlvbi1jb250YWluZXItaW5hY3RpdmVcIjpcIi5tYXBpbGxhcnktc2VxdWVuY2UtcG9zaXRpb24tY29udGFpbmVyXCI7cmV0dXJuIGpmLmgoXCJkaXZcIitoLFtjXSl9X2NyZWF0ZVNwZWVkSW5wdXQodCl7dGhpcy5fc3BlZWQ9dDtjb25zdCBlPXQ9Pnt0aGlzLl9zcGVlZD1OdW1iZXIodC50YXJnZXQudmFsdWUpLzFlMyx0aGlzLl9ub3RpZnlTcGVlZENoYW5nZWQkLm5leHQodGhpcy5fc3BlZWQpfSxpPXRoaXMuX2NvbnRhaW5lci5kb21Db250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbj1NYXRoLm1heCgyNzYsTWF0aC5taW4oNDEwLDUrLjgqaS53aWR0aCkpLTE2MCxyPXQ9Pnt0aGlzLl9jaGFuZ2luZ1NwZWVkPSEwLHQuc3RvcFByb3BhZ2F0aW9uKCl9LHM9dD0+eyEwPT09dGhpcy5fY2hhbmdpbmdTcGVlZCYmdC5zdG9wUHJvcGFnYXRpb24oKX0sbz1qZi5oKFwiaW5wdXQubWFwaWxsYXJ5LXNlcXVlbmNlLXNwZWVkXCIse21heDoxZTMsbWluOjAsb25jaGFuZ2U6ZSxvbmlucHV0OmUsb25rZXlkb3duOnQ9PntcIkFycm93RG93blwiIT09dC5rZXkmJlwiQXJyb3dMZWZ0XCIhPT10LmtleSYmXCJBcnJvd1JpZ2h0XCIhPT10LmtleSYmXCJBcnJvd1VwXCIhPT10LmtleXx8dC5wcmV2ZW50RGVmYXVsdCgpfSxvbnBvaW50ZXJkb3duOnIsb25wb2ludGVybW92ZTpzLG9udG91Y2htb3ZlOnMsb250b3VjaHN0YXJ0OnIsc3R5bGU6e3dpZHRoOmAke259cHhgfSx0eXBlOlwicmFuZ2VcIix2YWx1ZToxZTMqdH0sW10pO3JldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS1zcGVlZC1jb250YWluZXJcIixbb10pfV9jcmVhdGVQbGF5YmFja0NvbnRyb2xzKGUsaSxuLHIpe2lmKHRoaXMuX21vZGUhPT1ibS5QbGF5YmFjaylyZXR1cm4gamYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtcGxheWJhY2tcIixbXSk7Y29uc3Qgcz1qZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS1zd2l0Y2gtaWNvbi5tYXBpbGxhcnktc2VxdWVuY2UtaWNvbi12aXNpYmxlXCIsW10pLG89ci5kaXJlY3Rpb249PT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dD90Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCxhPXIucGxheWluZyxjPXtvbmNsaWNrOigpPT57YXx8bi5jb25maWd1cmUoe2RpcmVjdGlvbjpvfSl9fSxoPXIucGxheWluZz9cIi5tYXBpbGxhcnktc2VxdWVuY2Utc3dpdGNoLWJ1dHRvbi1pbmFjdGl2ZVwiOlwiLm1hcGlsbGFyeS1zZXF1ZW5jZS1zd2l0Y2gtYnV0dG9uXCIsbD1qZi5oKFwiZGl2XCIraCxjLFtzXSksdT1qZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS1zbG93LWljb24ubWFwaWxsYXJ5LXNlcXVlbmNlLWljb24tdmlzaWJsZVwiLFtdKSxkPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLXNsb3ctY29udGFpbmVyXCIsW3VdKSxwPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLWZhc3QtaWNvbi5tYXBpbGxhcnktc2VxdWVuY2UtaWNvbi12aXNpYmxlXCIsW10pLGY9amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtZmFzdC1jb250YWluZXJcIixbcF0pLG09amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtY2xvc2UtaWNvbi5tYXBpbGxhcnktc2VxdWVuY2UtaWNvbi12aXNpYmxlXCIsW10pLGc9e29uY2xpY2s6KCk9Pnt0aGlzLl9tb2RlPWJtLkRlZmF1bHQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX19LF89amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtY2xvc2UtYnV0dG9uXCIsZyxbbV0pLHY9W2wsZCx0aGlzLl9jcmVhdGVTcGVlZElucHV0KGkpLGYsX10seT17c3R5bGU6e3RvcDpgJHtNYXRoLnJvdW5kKGUvdGhpcy5fc3RlcHBlckRlZmF1bHRXaWR0aCp0aGlzLl9kZWZhdWx0SGVpZ2h0KzEwKX1weGB9fTtyZXR1cm4gamYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtcGxheWJhY2tcIix5LHYpfV9jcmVhdGVQbGF5aW5nQnV0dG9uKGUsaSxuLHIscyl7bGV0IG89ci5kaXJlY3Rpb249PT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCYmbnVsbCE9ZXx8ci5kaXJlY3Rpb249PT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldiYmbnVsbCE9aTtvPW8mJm47bGV0IGE9e29uY2xpY2s6ci5wbGF5aW5nPygpPT57cy5zdG9wKCl9Om8/KCk9PntzLnBsYXkoKX06bnVsbH0sYz17fTtyLmRpcmVjdGlvbj09PXQuTmF2aWdhdGlvbkRpcmVjdGlvbi5QcmV2JiYoYy5zdHlsZT17dHJhbnNmb3JtOlwicm90YXRlKDE4MGRlZykgdHJhbnNsYXRlKDUwJSwgNTAlKVwifSk7bGV0IGg9amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtaWNvblwiLGMsW10pLGw9ci5wbGF5aW5nP1wibWFwaWxsYXJ5LXNlcXVlbmNlLXN0b3BcIjpvP1wibWFwaWxsYXJ5LXNlcXVlbmNlLXBsYXlcIjpcIm1hcGlsbGFyeS1zZXF1ZW5jZS1wbGF5LWluYWN0aXZlXCI7cmV0dXJuIGpmLmgoXCJkaXYuXCIrbCxhLFtoXSl9X2NyZWF0ZVNlcXVlbmNlQ29udHJvbHModCl7Y29uc3QgZT1NYXRoLnJvdW5kKDgvdGhpcy5fc3RlcHBlckRlZmF1bHRXaWR0aCp0KSxpPXtvbmNsaWNrOigpPT57dGhpcy5fZXhwYW5kQ29udHJvbHM9IXRoaXMuX2V4cGFuZENvbnRyb2xzLHRoaXMuX21vZGU9Ym0uRGVmYXVsdCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfSxzdHlsZTp7XCJib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1c1wiOmAke2V9cHhgLFwiYm9yZGVyLXRvcC1yaWdodC1yYWRpdXNcIjpgJHtlfXB4YH19LG49amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtZXhwYW5kZXItYmFyXCIsW10pLHI9amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtZXhwYW5kZXItYnV0dG9uXCIsaSxbbl0pLHM9dGhpcy5fbW9kZT09PWJtLlBsYXliYWNrP1wiLm1hcGlsbGFyeS1zZXF1ZW5jZS1mYXN0LWljb24tZ3JheS5tYXBpbGxhcnktc2VxdWVuY2UtaWNvbi12aXNpYmxlXCI6XCIubWFwaWxsYXJ5LXNlcXVlbmNlLWZhc3QtaWNvblwiLG89amYuaChcImRpdlwiK3MsW10pLGE9e29uY2xpY2s6KCk9Pnt0aGlzLl9tb2RlPXRoaXMuX21vZGU9PT1ibS5QbGF5YmFjaz9ibS5EZWZhdWx0OmJtLlBsYXliYWNrLHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9fSxjPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLXBsYXliYWNrLWJ1dHRvblwiLGEsW29dKSxoPXRoaXMuX21vZGU9PT1ibS5UaW1lbGluZT9cIi5tYXBpbGxhcnktc2VxdWVuY2UtdGltZWxpbmUtaWNvbi1ncmF5Lm1hcGlsbGFyeS1zZXF1ZW5jZS1pY29uLXZpc2libGVcIjpcIi5tYXBpbGxhcnktc2VxdWVuY2UtdGltZWxpbmUtaWNvblwiLGw9amYuaChcImRpdlwiK2gsW10pLHU9e29uY2xpY2s6KCk9Pnt0aGlzLl9tb2RlPXRoaXMuX21vZGU9PT1ibS5UaW1lbGluZT9ibS5EZWZhdWx0OmJtLlRpbWVsaW5lLHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9fSxkPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLXRpbWVsaW5lLWJ1dHRvblwiLHUsW2xdKSxwPXtzdHlsZTp7aGVpZ2h0OnRoaXMuX2RlZmF1bHRIZWlnaHQvdGhpcy5fc3RlcHBlckRlZmF1bHRXaWR0aCp0K1wicHhcIix0cmFuc2Zvcm06YHRyYW5zbGF0ZSgke3QvMisyfXB4LCAwKWAsd2lkdGg6dGhpcy5fY29udHJvbHNEZWZhdWx0V2lkdGgvdGhpcy5fc3RlcHBlckRlZmF1bHRXaWR0aCp0K1wicHhcIn19LGY9XCIubWFwaWxsYXJ5LXNlcXVlbmNlLWNvbnRyb2xzXCIrKHRoaXMuX2V4cGFuZENvbnRyb2xzP1wiLm1hcGlsbGFyeS1zZXF1ZW5jZS1jb250cm9scy1leHBhbmRlZFwiOlwiXCIpO3JldHVybiBqZi5oKFwiZGl2XCIrZixwLFtjLGQscl0pfV9jcmVhdGVTZXF1ZW5jZUFycm93cyhlLGksbixyLHMpe2xldCBvPXtvbmNsaWNrOm51bGwhPWU/KCk9PntzLm1vdmVEaXIkKHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5OZXh0KS5zdWJzY3JpYmUodm9pZCAwLCh0PT57dCBpbnN0YW5jZW9mIFpmfHxjb25zb2xlLmVycm9yKHQpfSkpfTpudWxsLG9ucG9pbnRlcmVudGVyOigpPT57dGhpcy5fbW91c2VFbnRlckRpcmVjdGlvbiQubmV4dCh0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCl9LG9ucG9pbnRlcmxlYXZlOigpPT57dGhpcy5fbW91c2VMZWF2ZURpcmVjdGlvbiQubmV4dCh0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCl9fTtjb25zdCBhPU1hdGgucm91bmQoOC90aGlzLl9zdGVwcGVyRGVmYXVsdFdpZHRoKm4pO2xldCBjPXtvbmNsaWNrOm51bGwhPWk/KCk9PntzLm1vdmVEaXIkKHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5QcmV2KS5zdWJzY3JpYmUodm9pZCAwLCh0PT57dCBpbnN0YW5jZW9mIFpmfHxjb25zb2xlLmVycm9yKHQpfSkpfTpudWxsLG9ucG9pbnRlcmVudGVyOigpPT57dGhpcy5fbW91c2VFbnRlckRpcmVjdGlvbiQubmV4dCh0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldil9LG9ucG9pbnRlcmxlYXZlOigpPT57dGhpcy5fbW91c2VMZWF2ZURpcmVjdGlvbiQubmV4dCh0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldil9LHN0eWxlOntcImJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXNcIjpgJHthfXB4YCxcImJvcmRlci10b3AtbGVmdC1yYWRpdXNcIjpgJHthfXB4YH19LGg9dGhpcy5fZ2V0U3RlcENsYXNzTmFtZSh0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCxlLHIuaGlnaGxpZ2h0SWQpLGw9dGhpcy5fZ2V0U3RlcENsYXNzTmFtZSh0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldixpLHIuaGlnaGxpZ2h0SWQpLHU9amYuaChcImRpdi5tYXBpbGxhcnktc2VxdWVuY2UtaWNvblwiLFtdKSxkPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLWljb25cIixbXSk7cmV0dXJuW2pmLmgoXCJkaXYuXCIrbCxjLFtkXSksamYuaChcImRpdi5cIitoLG8sW3VdKV19X2NyZWF0ZVN0ZXBwZXIoZSxpLG4scixzLG8pe2xldCBhPW51bGwsYz1udWxsO2ZvcihsZXQgaSBvZiBlLmVkZ2VzKWkuZGF0YS5kaXJlY3Rpb249PT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCYmKGE9aS50YXJnZXQpLGkuZGF0YS5kaXJlY3Rpb249PT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldiYmKGM9aS50YXJnZXQpO2NvbnN0IGg9dGhpcy5fY3JlYXRlUGxheWluZ0J1dHRvbihhLGMsbixpLHMpLGw9dGhpcy5fY3JlYXRlU2VxdWVuY2VBcnJvd3MoYSxjLHIsaSxvKTtsLnNwbGljZSgxLDAsaCk7Y29uc3QgdT17b25jb250ZXh0bWVudTp0PT57dC5wcmV2ZW50RGVmYXVsdCgpfSxzdHlsZTp7aGVpZ2h0OnRoaXMuX2RlZmF1bHRIZWlnaHQvdGhpcy5fc3RlcHBlckRlZmF1bHRXaWR0aCpyK1wicHhcIix3aWR0aDpyK1wicHhcIn19O3JldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS1zdGVwcGVyXCIsdSxsKX1fY3JlYXRlVGltZWxpbmVDb250cm9scyh0LGUsaSl7aWYodGhpcy5fbW9kZSE9PWJtLlRpbWVsaW5lKXJldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS10aW1lbGluZVwiLFtdKTtjb25zdCBuPXRoaXMuX2NyZWF0ZVBvc2l0aW9uSW5wdXQoZSxpKSxyPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLWNsb3NlLWljb24ubWFwaWxsYXJ5LXNlcXVlbmNlLWljb24tdmlzaWJsZVwiLFtdKSxzPXtvbmNsaWNrOigpPT57dGhpcy5fbW9kZT1ibS5EZWZhdWx0LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9fSxvPWpmLmgoXCJkaXYubWFwaWxsYXJ5LXNlcXVlbmNlLWNsb3NlLWJ1dHRvblwiLHMsW3JdKSxhPXtzdHlsZTp7dG9wOmAke01hdGgucm91bmQodC90aGlzLl9zdGVwcGVyRGVmYXVsdFdpZHRoKnRoaXMuX2RlZmF1bHRIZWlnaHQrMTApfXB4YH19O3JldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zZXF1ZW5jZS10aW1lbGluZVwiLGEsW24sb10pfV9nZXRTdGVwQ2xhc3NOYW1lKGUsaSxuKXtsZXQgcj1lPT09dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLk5leHQ/XCJtYXBpbGxhcnktc2VxdWVuY2Utc3RlcC1uZXh0XCI6XCJtYXBpbGxhcnktc2VxdWVuY2Utc3RlcC1wcmV2XCI7cmV0dXJuIG51bGw9PWk/cis9XCItaW5hY3RpdmVcIjpuPT09aSYmKHIrPVwiLWhpZ2hsaWdodFwiKSxyfV9zZXRDaGFuZ2luZ1Bvc2l0aW9uKHQpe3RoaXMuX2NoYW5naW5nUG9zaXRpb249dCx0aGlzLl9ub3RpZnlDaGFuZ2luZ1Bvc2l0aW9uQ2hhbmdlZCQubmV4dCh0KX19Y2xhc3MgSm0gZXh0ZW5kcyBWZntjb25zdHJ1Y3Rvcih0LGUsaSxuLHIpe3N1cGVyKHQsZSxpKSx0aGlzLl9zZXF1ZW5jZURPTVJlbmRlcmVyPW58fG5ldyBabShlKSx0aGlzLl9zY2hlZHVsZXI9cix0aGlzLl9jb250YWluZXJXaWR0aCQ9bmV3IFQsdGhpcy5faG92ZXJlZElkU3ViamVjdCQ9bmV3IFQsdGhpcy5faG92ZXJlZElkJD10aGlzLl9ob3ZlcmVkSWRTdWJqZWN0JC5waXBlKFplKCkpLHRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5wbGF5aW5nJC5waXBlKEplKDEpLGJpKHRoaXMuX2NvbmZpZ3VyYXRpb24kKSkuc3Vic2NyaWJlKCgoW3QsZV0pPT57Y29uc3QgaT1cInBsYXlpbmdcIixuPXtwbGF5aW5nOnQsdGFyZ2V0OnRoaXMsdHlwZTppfTt0aGlzLmZpcmUoaSxuKSx0IT09ZS5wbGF5aW5nJiYodD90aGlzLnBsYXkoKTp0aGlzLnN0b3AoKSl9KSksdGhpcy5fbmF2aWdhdG9yLnBsYXlTZXJ2aWNlLmRpcmVjdGlvbiQucGlwZShKZSgxKSxiaSh0aGlzLl9jb25maWd1cmF0aW9uJCkpLnN1YnNjcmliZSgoKFt0LGVdKT0+e3QhPT1lLmRpcmVjdGlvbiYmdGhpcy5jb25maWd1cmUoe2RpcmVjdGlvbjp0fSl9KSl9ZmlyZSh0LGUpe3N1cGVyLmZpcmUodCxlKX1vZmYodCxlKXtzdXBlci5vZmYodCxlKX1vbih0LGUpe3N1cGVyLm9uKHQsZSl9cGxheSgpe3RoaXMuY29uZmlndXJlKHtwbGF5aW5nOiEwfSl9c3RvcCgpe3RoaXMuY29uZmlndXJlKHtwbGF5aW5nOiExfSl9X2FjdGl2YXRlKCl7dGhpcy5fc2VxdWVuY2VET01SZW5kZXJlci5hY3RpdmF0ZSgpO2NvbnN0IHQ9dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUocmkoKHQ9PnQuc2VxdWVuY2VFZGdlcyQpKSxVZSgxKSxFKCkpLGU9dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUodWUodm9pZCAwLCh0PT50LnNlcXVlbmNlSWQpKSxyaSgodD0+QXQoRyhudWxsKSx0aGlzLl9uYXZpZ2F0b3IuZ3JhcGhTZXJ2aWNlLmNhY2hlU2VxdWVuY2UkKHQuc2VxdWVuY2VJZCkucGlwZShWZSgzKSx0ZSgodD0+KGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2FjaGUgc2VxdWVuY2VcIix0KSxHKG51bGwpKSkpKSkpKSxuaShudWxsKSxVZSgxKSxFKCkpLGk9dGhpcy5fc3Vic2NyaXB0aW9ucztpLnB1c2goZS5zdWJzY3JpYmUoKSk7Y29uc3Qgbj10aGlzLl9zZXF1ZW5jZURPTVJlbmRlcmVyLmluZGV4JC5waXBlKGJpKGUpLHJ0KCgoW3QsZV0pPT5udWxsIT1lP2UuaW1hZ2VJZHNbdF06bnVsbCkpLE50KCh0PT4hIXQpKSx1ZSgpLEhlKCksRSgpKTtpLnB1c2goT3Qobi5waXBlKHJlKDEwMCx0aGlzLl9zY2hlZHVsZXIpKSxuLnBpcGUoV3QoNDAwLHRoaXMuX3NjaGVkdWxlcikpKS5waXBlKHVlKCkscmkoKHQ9PnRoaXMuX25hdmlnYXRvci5tb3ZlVG8kKHQpLnBpcGUodGUoKCgpPT5CKCkpKSkpKSkuc3Vic2NyaWJlKCkpLGkucHVzaCh0aGlzLl9zZXF1ZW5jZURPTVJlbmRlcmVyLmNoYW5naW5nUG9zaXRpb25DaGFuZ2VkJC5waXBlKE50KCh0PT50KSkpLnN1YnNjcmliZSgoKCk9Pnt0aGlzLl9uYXZpZ2F0b3IuZ3JhcGhTZXJ2aWNlLnNldEdyYXBoTW9kZSh5bS5TZXF1ZW5jZSl9KSkpLGkucHVzaCh0aGlzLl9zZXF1ZW5jZURPTVJlbmRlcmVyLmNoYW5naW5nUG9zaXRpb25DaGFuZ2VkJC5waXBlKE50KCh0PT4hdCkpKS5zdWJzY3JpYmUoKCgpPT57dGhpcy5fbmF2aWdhdG9yLmdyYXBoU2VydmljZS5zZXRHcmFwaE1vZGUoeW0uU3BhdGlhbCl9KSkpLHRoaXMuX25hdmlnYXRvci5ncmFwaFNlcnZpY2UuZ3JhcGhNb2RlJC5waXBlKHJpKCh0PT50PT09eW0uU3BhdGlhbD90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQucGlwZSh2ZSgyKSk6QigpKSksTnQoKHQ9PiF0LnNwYXRpYWxFZGdlcy5jYWNoZWQpKSxyaSgodD0+dGhpcy5fbmF2aWdhdG9yLmdyYXBoU2VydmljZS5jYWNoZUltYWdlJCh0LmlkKS5waXBlKHRlKCgoKT0+QigpKSkpKSkpLnN1YnNjcmliZSgpLGkucHVzaCh0aGlzLl9zZXF1ZW5jZURPTVJlbmRlcmVyLmNoYW5naW5nUG9zaXRpb25DaGFuZ2VkJC5waXBlKE50KCh0PT50KSkpLnN1YnNjcmliZSgoKCk9Pnt0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc3RvcCgpfSkpKSxpLnB1c2goZ3QodGhpcy5fbmF2aWdhdG9yLmdyYXBoU2VydmljZS5ncmFwaE1vZGUkLHRoaXMuX3NlcXVlbmNlRE9NUmVuZGVyZXIuY2hhbmdpbmdQb3NpdGlvbkNoYW5nZWQkLnBpcGUobmkoITEpLHVlKCkpKS5waXBlKGJpKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJCkscmkoKChbW3QsZV0saV0pPT5lJiZ0PT09eW0uU2VxdWVuY2U/dGhpcy5fbmF2aWdhdG9yLmdyYXBoU2VydmljZS5jYWNoZVNlcXVlbmNlSW1hZ2VzJChpLnNlcXVlbmNlSWQsaS5pZCkucGlwZShWZSgzKSx0ZSgodD0+KGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gY2FjaGUgc2VxdWVuY2UgaW1hZ2VzLlwiLHQpLEIoKSkpKSk6QigpKSkpLnN1YnNjcmliZSgpKTtjb25zdCByPWUucGlwZShyaSgodD0+e2lmKCF0KXJldHVybiBHKHtpbmRleDpudWxsLG1heDpudWxsfSk7bGV0IGU9ITA7cmV0dXJuIHRoaXMuX3NlcXVlbmNlRE9NUmVuZGVyZXIuY2hhbmdpbmdQb3NpdGlvbkNoYW5nZWQkLnBpcGUobmkoITEpLHVlKCkscmkoKHQ9Pntjb25zdCBpPSF0JiZlPzA6MTtyZXR1cm4gZT0hMSx0P246dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUocnQoKHQ9PnQuaWQpKSx1ZSgpLEplKGkpKX0pKSxydCgoZT0+e2NvbnN0IGk9dC5pbWFnZUlkcy5pbmRleE9mKGUpO3JldHVybi0xPT09aT97aW5kZXg6bnVsbCxtYXg6bnVsbH06e2luZGV4OmksbWF4OnQuaW1hZ2VJZHMubGVuZ3RoLTF9fSkpKX0pKSkscz10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0YXRlJC5waXBlKHJ0KCh0PT50PT09dm0uRWFydGgpKSx1ZSgpKTtpLnB1c2goZ3QodCx0aGlzLl9jb25maWd1cmF0aW9uJCx0aGlzLl9jb250YWluZXJXaWR0aCQsdGhpcy5fc2VxdWVuY2VET01SZW5kZXJlci5jaGFuZ2VkJC5waXBlKG5pKHRoaXMuX3NlcXVlbmNlRE9NUmVuZGVyZXIpKSx0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc3BlZWQkLHIscykucGlwZShydCgoKFt0LGUsaSwsbixyLHNdKT0+e2NvbnN0IG89dGhpcy5fc2VxdWVuY2VET01SZW5kZXJlci5yZW5kZXIodCxlLGksbixyLmluZGV4LHIubWF4LCFzLHRoaXMsdGhpcy5fbmF2aWdhdG9yKTtyZXR1cm57bmFtZTp0aGlzLl9uYW1lLHZOb2RlOm99fSkpKS5zdWJzY3JpYmUodGhpcy5fY29udGFpbmVyLmRvbVJlbmRlcmVyLnJlbmRlciQpKSxpLnB1c2godGhpcy5fc2VxdWVuY2VET01SZW5kZXJlci5zcGVlZCQuc3Vic2NyaWJlKCh0PT57dGhpcy5fbmF2aWdhdG9yLnBsYXlTZXJ2aWNlLnNldFNwZWVkKHQpfSkpKSxpLnB1c2godGhpcy5fY29uZmlndXJhdGlvbiQucGlwZShydCgodD0+dC5kaXJlY3Rpb24pKSx1ZSgpKS5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc2V0RGlyZWN0aW9uKHQpfSkpKSxpLnB1c2goZ3QodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQsdGhpcy5fY29uZmlndXJhdGlvbiQucGlwZSh1ZSgoKHQsZSk9PnRbMF09PT1lWzBdJiZ0WzFdPT09ZVsxXSksKHQ9Plt0Lm1pbldpZHRoLHQubWF4V2lkdGhdKSkpKS5waXBlKHJ0KCgoW3QsZV0pPT50aGlzLl9zZXF1ZW5jZURPTVJlbmRlcmVyLmdldENvbnRhaW5lcldpZHRoKHQsZSkpKSkuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lcldpZHRoJCkpLGkucHVzaCh0aGlzLl9jb25maWd1cmF0aW9uJC5waXBlKHJ0KCh0PT50LnBsYXlpbmcpKSx1ZSgpKS5zdWJzY3JpYmUoKHQ9Pnt0P3RoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5wbGF5KCk6dGhpcy5fbmF2aWdhdG9yLnBsYXlTZXJ2aWNlLnN0b3AoKX0pKSksaS5wdXNoKHRoaXMuX3NlcXVlbmNlRE9NUmVuZGVyZXIubW91c2VFbnRlckRpcmVjdGlvbiQucGlwZShyaSgoZT0+QXQodC5waXBlKHJ0KCh0PT57Zm9yKGxldCBpIG9mIHQuZWRnZXMpaWYoaS5kYXRhLmRpcmVjdGlvbj09PWUpcmV0dXJuIGkudGFyZ2V0O3JldHVybiBudWxsfSkpLGFpKHRoaXMuX3NlcXVlbmNlRE9NUmVuZGVyZXIubW91c2VMZWF2ZURpcmVjdGlvbiQpKSxHKG51bGwpKSkpLHVlKCkpLnN1YnNjcmliZSh0aGlzLl9ob3ZlcmVkSWRTdWJqZWN0JCkpLGkucHVzaCh0aGlzLl9ob3ZlcmVkSWQkLnN1YnNjcmliZSgodD0+e2NvbnN0IGU9XCJob3ZlclwiLGk9e2lkOnQsdGFyZ2V0OnRoaXMsdHlwZTplfTt0aGlzLmZpcmUoZSxpKX0pKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5fc2VxdWVuY2VET01SZW5kZXJlci5kZWFjdGl2YXRlKCl9X2dldERlZmF1bHRDb25maWd1cmF0aW9uKCl7cmV0dXJue2RpcmVjdGlvbjp0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCxtYXhXaWR0aDoxMDgsbWluV2lkdGg6NzAscGxheWluZzohMSx2aXNpYmxlOiEwfX19Sm0uY29tcG9uZW50TmFtZT1cInNlcXVlbmNlXCIsdC5TbGlkZXJDb25maWd1cmF0aW9uTW9kZT12b2lkIDAsKHhtPXQuU2xpZGVyQ29uZmlndXJhdGlvbk1vZGV8fCh0LlNsaWRlckNvbmZpZ3VyYXRpb25Nb2RlPXt9KSlbeG0uTW90aW9uPTBdPVwiTW90aW9uXCIseG1beG0uU3RhdGlvbmFyeT0xXT1cIlN0YXRpb25hcnlcIjtjbGFzcyBLbXtjb25zdHJ1Y3Rvcigpe3RoaXMuX2ZhY3Rvcnk9bmV3IGVtLHRoaXMuX3NjZW5lPW5ldyBpbSx0aGlzLl9zcGF0aWFsPW5ldyBsZCx0aGlzLl9jdXJyZW50S2V5PW51bGwsdGhpcy5fcHJldmlvdXNLZXk9bnVsbCx0aGlzLl9kaXNhYmxlZD0hMSx0aGlzLl9jdXJ0YWluPTEsdGhpcy5fZnJhbWVJZD0wLHRoaXMuX25lZWRzUmVuZGVyPSExLHRoaXMuX21vZGU9bnVsbCx0aGlzLl9jdXJyZW50UHJvdmlkZXJEaXNwb3NlcnM9e30sdGhpcy5fcHJldmlvdXNQcm92aWRlckRpc3Bvc2Vycz17fX1nZXQgZGlzYWJsZWQoKXtyZXR1cm4gdGhpcy5fZGlzYWJsZWR9Z2V0IGZyYW1lSWQoKXtyZXR1cm4gdGhpcy5fZnJhbWVJZH1nZXQgbmVlZHNSZW5kZXIoKXtyZXR1cm4gdGhpcy5fbmVlZHNSZW5kZXJ9c2V0VGV4dHVyZVByb3ZpZGVyKHQsZSl7dGhpcy5fc2V0VGV4dHVyZVByb3ZpZGVyKHQsdGhpcy5fY3VycmVudEtleSxlLHRoaXMuX2N1cnJlbnRQcm92aWRlckRpc3Bvc2Vycyx0aGlzLl91cGRhdGVUZXh0dXJlLmJpbmQodGhpcykpfXNldFRleHR1cmVQcm92aWRlclByZXYodCxlKXt0aGlzLl9zZXRUZXh0dXJlUHJvdmlkZXIodCx0aGlzLl9wcmV2aW91c0tleSxlLHRoaXMuX3ByZXZpb3VzUHJvdmlkZXJEaXNwb3NlcnMsdGhpcy5fdXBkYXRlVGV4dHVyZVByZXYuYmluZCh0aGlzKSl9dXBkYXRlKHQsZSl7dGhpcy5fdXBkYXRlRnJhbWVJZCh0LmlkKSx0aGlzLl91cGRhdGVJbWFnZVBsYW5lcyh0LnN0YXRlLGUpfXVwZGF0ZUN1cnRhaW4odCl7dGhpcy5fY3VydGFpbiE9PXQmJih0aGlzLl9jdXJ0YWluPXQsdGhpcy5fdXBkYXRlQ3VydGFpbigpLHRoaXMuX25lZWRzUmVuZGVyPSEwKX11cGRhdGVUZXh0dXJlKHQsZSl7Y29uc3QgaT1lLmlkPT09dGhpcy5fY3VycmVudEtleT90aGlzLl9zY2VuZS5wbGFuZXM6ZS5pZD09PXRoaXMuX3ByZXZpb3VzS2V5P3RoaXMuX3NjZW5lLnBsYW5lc09sZDp7fTtpZigwIT09T2JqZWN0LmtleXMoaSkubGVuZ3RoKXt0aGlzLl9uZWVkc1JlbmRlcj0hMDtmb3IoY29uc3QgZSBpbiBpKXtpZighaS5oYXNPd25Qcm9wZXJ0eShlKSljb250aW51ZTtsZXQgbj1pW2VdLm1hdGVyaWFsLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZTtuLmltYWdlPXQsbi5uZWVkc1VwZGF0ZT0hMH19fXVwZGF0ZVRleHR1cmVJbWFnZSh0LGUpe2lmKHRoaXMuX2N1cnJlbnRLZXkhPT1lLmlkKXJldHVybjt0aGlzLl9uZWVkc1JlbmRlcj0hMDtjb25zdCBpPXRoaXMuX3NjZW5lLnBsYW5lcztmb3IoY29uc3QgZSBpbiBpKXtpZighaS5oYXNPd25Qcm9wZXJ0eShlKSljb250aW51ZTtsZXQgbj1pW2VdLm1hdGVyaWFsLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZTtuLmltYWdlPXQsbi5uZWVkc1VwZGF0ZT0hMH19cmVuZGVyKHQsZSl7dGhpcy5kaXNhYmxlZHx8ZS5yZW5kZXIodGhpcy5fc2NlbmUuc2NlbmVPbGQsdCksZS5yZW5kZXIodGhpcy5fc2NlbmUuc2NlbmUsdCksdGhpcy5fbmVlZHNSZW5kZXI9ITF9ZGlzcG9zZSgpe3RoaXMuX3NjZW5lLmNsZWFyKCk7Zm9yKGNvbnN0IHQgaW4gdGhpcy5fY3VycmVudFByb3ZpZGVyRGlzcG9zZXJzKXRoaXMuX2N1cnJlbnRQcm92aWRlckRpc3Bvc2Vycy5oYXNPd25Qcm9wZXJ0eSh0KSYmdGhpcy5fY3VycmVudFByb3ZpZGVyRGlzcG9zZXJzW3RdKCk7Zm9yKGNvbnN0IHQgaW4gdGhpcy5fcHJldmlvdXNQcm92aWRlckRpc3Bvc2Vycyl0aGlzLl9wcmV2aW91c1Byb3ZpZGVyRGlzcG9zZXJzLmhhc093blByb3BlcnR5KHQpJiZ0aGlzLl9wcmV2aW91c1Byb3ZpZGVyRGlzcG9zZXJzW3RdKCk7dGhpcy5fY3VycmVudFByb3ZpZGVyRGlzcG9zZXJzPXt9LHRoaXMuX3ByZXZpb3VzUHJvdmlkZXJEaXNwb3NlcnM9e319X2dldEJhc2ljQ29ybmVycyh0LGUpe2xldCBpLG47cmV0dXJuIHQ+ZT8oaT0uNSxuPS41KnQvZSk6KGk9LjUqZS90LG49LjUpLFtbLjUtaSwuNS1uXSxbLjUraSwuNStuXV19X3NldERpc2FibGVkKHQpe3RoaXMuX2Rpc2FibGVkPW51bGw9PXQuY3VycmVudEltYWdlfHxudWxsPT10LnByZXZpb3VzSW1hZ2V8fGRkKHQuY3VycmVudEltYWdlLmNhbWVyYVR5cGUpJiYhZGQodC5wcmV2aW91c0ltYWdlLmNhbWVyYVR5cGUpfV9zZXRUZXh0dXJlUHJvdmlkZXIodCxlLGksbixyKXtpZih0IT09ZSlyZXR1cm47bGV0IHM9aS50ZXh0dXJlQ3JlYXRlZCQuc3Vic2NyaWJlKHIpLG89aS50ZXh0dXJlVXBkYXRlZCQuc3Vic2NyaWJlKCh0PT57dGhpcy5fbmVlZHNSZW5kZXI9ITB9KSk7aWYodCBpbiBuKXsoMCxuW3RdKSgpLGRlbGV0ZSBuW3RdfW5bdF09KCk9PntzLnVuc3Vic2NyaWJlKCksby51bnN1YnNjcmliZSgpLGkuZGlzcG9zZSgpfX1fdXBkYXRlQ3VydGFpbigpe2NvbnN0IHQ9dGhpcy5fc2NlbmUucGxhbmVzO2Zvcihjb25zdCBlIGluIHQpe2lmKCF0Lmhhc093blByb3BlcnR5KGUpKWNvbnRpbnVlO2xldCBpPXRbZV0ubWF0ZXJpYWw7aS51bmlmb3Jtcy5jdXJ0YWluJiYoaS51bmlmb3Jtcy5jdXJ0YWluLnZhbHVlPXRoaXMuX2N1cnRhaW4pfX1fdXBkYXRlRnJhbWVJZCh0KXt0aGlzLl9mcmFtZUlkPXR9X3VwZGF0ZUltYWdlUGxhbmVzKGUsaSl7Y29uc3Qgbj1udWxsIT1lLmN1cnJlbnRJbWFnZSYmdGhpcy5fY3VycmVudEtleSE9PWUuY3VycmVudEltYWdlLmlkLHI9bnVsbCE9ZS5wcmV2aW91c0ltYWdlJiZ0aGlzLl9wcmV2aW91c0tleSE9PWUucHJldmlvdXNJbWFnZS5pZCxzPXRoaXMuX21vZGUhPT1pO2lmKCEobnx8cnx8cykpcmV0dXJuO3RoaXMuX3NldERpc2FibGVkKGUpLHRoaXMuX25lZWRzUmVuZGVyPSEwLHRoaXMuX21vZGU9aTtjb25zdCBvPWUubW90aW9ubGVzc3x8aT09PXQuU2xpZGVyQ29uZmlndXJhdGlvbk1vZGUuU3RhdGlvbmFyeXx8ZGQoZS5jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSk7aWYoKHRoaXMuZGlzYWJsZWR8fHIpJiZ0aGlzLl9wcmV2aW91c0tleSBpbiB0aGlzLl9wcmV2aW91c1Byb3ZpZGVyRGlzcG9zZXJzJiYodGhpcy5fcHJldmlvdXNQcm92aWRlckRpc3Bvc2Vyc1t0aGlzLl9wcmV2aW91c0tleV0oKSxkZWxldGUgdGhpcy5fcHJldmlvdXNQcm92aWRlckRpc3Bvc2Vyc1t0aGlzLl9wcmV2aW91c0tleV0pLHRoaXMuZGlzYWJsZWQpdGhpcy5fc2NlbmUuc2V0SW1hZ2VQbGFuZXNPbGQoe30pO2Vsc2UgaWYocnx8cyl7Y29uc3QgdD1lLnByZXZpb3VzSW1hZ2U7dGhpcy5fcHJldmlvdXNLZXk9dC5pZDtjb25zdCBpPWUuY3VycmVudFRyYW5zZm9ybS5ydC5lbGVtZW50cztsZXQgbj1baVsxMl0saVsxM10saVsxNF1dO2NvbnN0IHI9ZS5jdXJyZW50VHJhbnNmb3JtLmJhc2ljQXNwZWN0LHM9ZS5wcmV2aW91c1RyYW5zZm9ybS5iYXNpY0FzcGVjdCxhPXI+cz9bMSxzL3JdOltyL3MsMV07bGV0IGM9ZS5jdXJyZW50SW1hZ2Uucm90YXRpb24saD1lLmN1cnJlbnRJbWFnZS53aWR0aCxsPWUuY3VycmVudEltYWdlLmhlaWdodDtkZCh0LmNhbWVyYVR5cGUpJiYoYz1lLnByZXZpb3VzSW1hZ2Uucm90YXRpb24sbj10aGlzLl9zcGF0aWFsLnJvdGF0ZSh0aGlzLl9zcGF0aWFsLm9wdGljYWxDZW50ZXIoZS5jdXJyZW50SW1hZ2Uucm90YXRpb24sbikudG9BcnJheSgpLGMpLm11bHRpcGx5U2NhbGFyKC0xKS50b0FycmF5KCksaD1lLnByZXZpb3VzSW1hZ2Uud2lkdGgsbD1lLnByZXZpb3VzSW1hZ2UuaGVpZ2h0KTtjb25zdCB1PW5ldyBIZChlLmN1cnJlbnRJbWFnZS5leGlmT3JpZW50YXRpb24saCxsLGUuY3VycmVudEltYWdlLnNjYWxlLGMsbix0LmltYWdlLGEsZS5jdXJyZW50SW1hZ2UuY2FtZXJhUGFyYW1ldGVycyxlLmN1cnJlbnRJbWFnZS5jYW1lcmFUeXBlKTtsZXQgZDtpZihkZCh0LmNhbWVyYVR5cGUpKWQ9dGhpcy5fZmFjdG9yeS5jcmVhdGVNZXNoKHQsb3x8ZGQoZS5jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSk/dTplLnByZXZpb3VzVHJhbnNmb3JtKTtlbHNlIGlmKG8pe2NvbnN0W1t0LGldLFtuLG9dXT10aGlzLl9nZXRCYXNpY0Nvcm5lcnMocixzKTtkPXRoaXMuX2ZhY3RvcnkuY3JlYXRlRmxhdE1lc2goZS5wcmV2aW91c0ltYWdlLHUsdCxuLGksbyl9ZWxzZSBkPXRoaXMuX2ZhY3RvcnkuY3JlYXRlTWVzaChlLnByZXZpb3VzSW1hZ2UsZS5wcmV2aW91c1RyYW5zZm9ybSk7Y29uc3QgcD17fTtwW3QuaWRdPWQsdGhpcy5fc2NlbmUuc2V0SW1hZ2VQbGFuZXNPbGQocCl9aWYobnx8cyl7dGhpcy5fY3VycmVudEtleSBpbiB0aGlzLl9jdXJyZW50UHJvdmlkZXJEaXNwb3NlcnMmJih0aGlzLl9jdXJyZW50UHJvdmlkZXJEaXNwb3NlcnNbdGhpcy5fY3VycmVudEtleV0oKSxkZWxldGUgdGhpcy5fY3VycmVudFByb3ZpZGVyRGlzcG9zZXJzW3RoaXMuX2N1cnJlbnRLZXldKSx0aGlzLl9jdXJyZW50S2V5PWUuY3VycmVudEltYWdlLmlkO2NvbnN0IHQ9e307ZGQoZS5jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSk/dFtlLmN1cnJlbnRJbWFnZS5pZF09dGhpcy5fZmFjdG9yeS5jcmVhdGVDdXJ0YWluTWVzaChlLmN1cnJlbnRJbWFnZSxlLmN1cnJlbnRUcmFuc2Zvcm0pOnRbZS5jdXJyZW50SW1hZ2UuaWRdPW8/dGhpcy5fZmFjdG9yeS5jcmVhdGVEaXN0b3J0ZWRDdXJ0YWluTWVzaChlLmN1cnJlbnRJbWFnZSxlLmN1cnJlbnRUcmFuc2Zvcm0pOnRoaXMuX2ZhY3RvcnkuY3JlYXRlQ3VydGFpbk1lc2goZS5jdXJyZW50SW1hZ2UsZS5jdXJyZW50VHJhbnNmb3JtKSx0aGlzLl9zY2VuZS5zZXRJbWFnZVBsYW5lcyh0KSx0aGlzLl91cGRhdGVDdXJ0YWluKCl9fV91cGRhdGVUZXh0dXJlKHQpe3RoaXMuX25lZWRzUmVuZGVyPSEwO2NvbnN0IGU9dGhpcy5fc2NlbmUucGxhbmVzO2Zvcihjb25zdCBpIGluIGUpe2lmKCFlLmhhc093blByb3BlcnR5KGkpKWNvbnRpbnVlO2xldCBuPWVbaV0ubWF0ZXJpYWwscj1uLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZTtuLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZT1udWxsLHIuZGlzcG9zZSgpLG4udW5pZm9ybXMucHJvamVjdG9yVGV4LnZhbHVlPXR9fV91cGRhdGVUZXh0dXJlUHJldih0KXt0aGlzLl9uZWVkc1JlbmRlcj0hMDtjb25zdCBlPXRoaXMuX3NjZW5lLnBsYW5lc09sZDtmb3IoY29uc3QgaSBpbiBlKXtpZighZS5oYXNPd25Qcm9wZXJ0eShpKSljb250aW51ZTtsZXQgbj1lW2ldLm1hdGVyaWFsLHI9bi51bmlmb3Jtcy5wcm9qZWN0b3JUZXgudmFsdWU7bi51bmlmb3Jtcy5wcm9qZWN0b3JUZXgudmFsdWU9bnVsbCxyLmRpc3Bvc2UoKSxuLnVuaWZvcm1zLnByb2plY3RvclRleC52YWx1ZT10fX19Y2xhc3MgUW17Y29uc3RydWN0b3IodCl7dGhpcy5fY29udGFpbmVyPXQsdGhpcy5faW50ZXJhY3Rpbmc9ITEsdGhpcy5fbm90aWZ5TW9kZUNoYW5nZWQkPW5ldyBULHRoaXMuX25vdGlmeVBvc2l0aW9uQ2hhbmdlZCQ9bmV3IFQsdGhpcy5fc3RvcEludGVyYWN0aW9uU3Vic2NyaXB0aW9uPW51bGx9Z2V0IG1vZGUkKCl7cmV0dXJuIHRoaXMuX25vdGlmeU1vZGVDaGFuZ2VkJH1nZXQgcG9zaXRpb24kKCl7cmV0dXJuIHRoaXMuX25vdGlmeVBvc2l0aW9uQ2hhbmdlZCR9YWN0aXZhdGUoKXt0aGlzLl9zdG9wSW50ZXJhY3Rpb25TdWJzY3JpcHRpb258fCh0aGlzLl9zdG9wSW50ZXJhY3Rpb25TdWJzY3JpcHRpb249T3QodGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5kb2N1bWVudE1vdXNlVXAkLHRoaXMuX2NvbnRhaW5lci50b3VjaFNlcnZpY2UudG91Y2hFbmQkLnBpcGUoTnQoKHQ9PjA9PT10LnRvdWNoZXMubGVuZ3RoKSkpKS5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9pbnRlcmFjdGluZyYmKHRoaXMuX2ludGVyYWN0aW5nPSExKX0pKSl9ZGVhY3RpdmF0ZSgpe3RoaXMuX3N0b3BJbnRlcmFjdGlvblN1YnNjcmlwdGlvbiYmKHRoaXMuX2ludGVyYWN0aW5nPSExLHRoaXMuX3N0b3BJbnRlcmFjdGlvblN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3N0b3BJbnRlcmFjdGlvblN1YnNjcmlwdGlvbj1udWxsKX1yZW5kZXIodCxlLGksbixyKXtjb25zdCBzPVtdO2lmKHIpe3MucHVzaChqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zbGlkZXItYm9yZGVyXCIsW10pKTtjb25zdCByPSEoaXx8bik7ciYmKHMucHVzaCh0aGlzLl9jcmVhdGVNb2RlQnV0dG9uKGUpKSxzLnB1c2godGhpcy5fY3JlYXRlTW9kZUJ1dHRvbjJkKGUpKSkscy5wdXNoKHRoaXMuX2NyZWF0ZVBvc2l0aW9uSW5wdXQodCxyKSl9Y29uc3Qgbz10aGlzLl9jb250YWluZXIuZG9tQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGE9TWF0aC5tYXgoMjE1LE1hdGgubWluKDQwMCxvLndpZHRoLTEwMCkpO3JldHVybiBqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zbGlkZXItY29udGFpbmVyXCIse3N0eWxlOnt3aWR0aDpgJHthfXB4YH19LHMpfV9jcmVhdGVNb2RlQnV0dG9uKGUpe2NvbnN0IGk9e29uY2xpY2s6KCk9PntlIT09dC5TbGlkZXJDb25maWd1cmF0aW9uTW9kZS5Nb3Rpb24mJnRoaXMuX25vdGlmeU1vZGVDaGFuZ2VkJC5uZXh0KHQuU2xpZGVyQ29uZmlndXJhdGlvbk1vZGUuTW90aW9uKX19LG49ZT09PXQuU2xpZGVyQ29uZmlndXJhdGlvbk1vZGUuU3RhdGlvbmFyeT9cIm1hcGlsbGFyeS1zbGlkZXItbW9kZS1idXR0b24taW5hY3RpdmVcIjpcIm1hcGlsbGFyeS1zbGlkZXItbW9kZS1idXR0b25cIjtyZXR1cm4gamYuaChcImRpdi5cIituLGksW2pmLmgoXCJkaXYubWFwaWxsYXJ5LXNsaWRlci1tb2RlLWljb25cIixbXSldKX1fY3JlYXRlTW9kZUJ1dHRvbjJkKGUpe2NvbnN0IGk9e29uY2xpY2s6KCk9PntlIT09dC5TbGlkZXJDb25maWd1cmF0aW9uTW9kZS5TdGF0aW9uYXJ5JiZ0aGlzLl9ub3RpZnlNb2RlQ2hhbmdlZCQubmV4dCh0LlNsaWRlckNvbmZpZ3VyYXRpb25Nb2RlLlN0YXRpb25hcnkpfX0sbj1lPT09dC5TbGlkZXJDb25maWd1cmF0aW9uTW9kZS5Nb3Rpb24/XCJtYXBpbGxhcnktc2xpZGVyLW1vZGUtYnV0dG9uLTJkLWluYWN0aXZlXCI6XCJtYXBpbGxhcnktc2xpZGVyLW1vZGUtYnV0dG9uLTJkXCI7cmV0dXJuIGpmLmgoXCJkaXYuXCIrbixpLFtqZi5oKFwiZGl2Lm1hcGlsbGFyeS1zbGlkZXItbW9kZS1pY29uLTJkXCIsW10pXSl9X2NyZWF0ZVBvc2l0aW9uSW5wdXQodCxlKXtjb25zdCBpPXQ9Pnt0aGlzLl9ub3RpZnlQb3NpdGlvbkNoYW5nZWQkLm5leHQoTnVtYmVyKHQudGFyZ2V0LnZhbHVlKS8xZTMpfSxuPXQ9Pnt0aGlzLl9pbnRlcmFjdGluZz0hMCx0LnN0b3BQcm9wYWdhdGlvbigpfSxyPXQ9Pnt0aGlzLl9pbnRlcmFjdGluZyYmdC5zdG9wUHJvcGFnYXRpb24oKX0scz10aGlzLl9jb250YWluZXIuZG9tQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLG89TWF0aC5tYXgoMjE1LE1hdGgubWluKDQwMCxzLndpZHRoLTEwNSkpLTg0KyhlPzA6NTIpLGE9amYuaChcImlucHV0Lm1hcGlsbGFyeS1zbGlkZXItcG9zaXRpb25cIix7bWF4OjFlMyxtaW46MCxvbmNoYW5nZTppLG9uaW5wdXQ6aSxvbmtleWRvd246dD0+e1wiQXJyb3dEb3duXCIhPT10LmtleSYmXCJBcnJvd0xlZnRcIiE9PXQua2V5JiZcIkFycm93UmlnaHRcIiE9PXQua2V5JiZcIkFycm93VXBcIiE9PXQua2V5fHx0LnByZXZlbnREZWZhdWx0KCl9LG9ucG9pbnRlcmRvd246bixvbnBvaW50ZXJtb3ZlOnIsb250b3VjaG1vdmU6cixvbnRvdWNoc3RhcnQ6bixzdHlsZTp7d2lkdGg6YCR7b31weGB9LHR5cGU6XCJyYW5nZVwiLHZhbHVlOjFlMyp0fSxbXSk7cmV0dXJuIGpmLmgoXCJkaXYubWFwaWxsYXJ5LXNsaWRlci1wb3NpdGlvbi1jb250YWluZXJcIixbYV0pfX1jbGFzcyB0ZyBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpLG4pe3N1cGVyKHQsZSxpKSx0aGlzLl92aWV3cG9ydENvb3Jkcz1ufHxuZXcgV2YsdGhpcy5fZG9tUmVuZGVyZXI9bmV3IFFtKGUpLHRoaXMuX2ltYWdlVGlsZUxvYWRlcj1uZXcgc20oaS5hcGkpLHRoaXMuX3JvaUNhbGN1bGF0b3I9bmV3IGFtLHRoaXMuX3NwYXRpYWw9bmV3IGxkLHRoaXMuX2dsUmVuZGVyZXJPcGVyYXRpb24kPW5ldyBULHRoaXMuX2dsUmVuZGVyZXJDcmVhdG9yJD1uZXcgVCx0aGlzLl9nbFJlbmRlcmVyRGlzcG9zZXIkPW5ldyBULHRoaXMuX2dsUmVuZGVyZXIkPXRoaXMuX2dsUmVuZGVyZXJPcGVyYXRpb24kLnBpcGUoTGUoKCh0LGUpPT5lKHQpKSxudWxsKSxOdCgodD0+bnVsbCE9dCkpLHVlKHZvaWQgMCwodD0+dC5mcmFtZUlkKSkpLHRoaXMuX2dsUmVuZGVyZXJDcmVhdG9yJC5waXBlKHJ0KCgoKT0+dD0+e2lmKG51bGwhPXQpdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgc2xpZGVyIHN0YXRlcyBjYW4gbm90IGJlIGNyZWF0ZWQgYXQgdGhlIHNhbWUgdGltZVwiKTtyZXR1cm4gbmV3IEttfSkpKS5zdWJzY3JpYmUodGhpcy5fZ2xSZW5kZXJlck9wZXJhdGlvbiQpLHRoaXMuX2dsUmVuZGVyZXJEaXNwb3NlciQucGlwZShydCgoKCk9PnQ9Pih0LmRpc3Bvc2UoKSxudWxsKSkpKS5zdWJzY3JpYmUodGhpcy5fZ2xSZW5kZXJlck9wZXJhdGlvbiQpfV9hY3RpdmF0ZSgpe2NvbnN0IGU9dGhpcy5fc3Vic2NyaXB0aW9ucztlLnB1c2godGhpcy5fZG9tUmVuZGVyZXIubW9kZSQuc3Vic2NyaWJlKCh0PT57dGhpcy5jb25maWd1cmUoe21vZGU6dH0pfSkpKSxlLnB1c2godGhpcy5fZ2xSZW5kZXJlciQucGlwZShydCgodD0+KHtuYW1lOnRoaXMuX25hbWUscmVuZGVyZXI6e2ZyYW1lSWQ6dC5mcmFtZUlkLG5lZWRzUmVuZGVyOnQubmVlZHNSZW5kZXIscmVuZGVyOnQucmVuZGVyLmJpbmQodCkscGFzczpybS5CYWNrZ3JvdW5kfX0pKSkpLnN1YnNjcmliZSh0aGlzLl9jb250YWluZXIuZ2xSZW5kZXJlci5yZW5kZXIkKSk7Y29uc3QgaT1BdCh0aGlzLmNvbmZpZ3VyYXRpb24kLnBpcGUocnQoKHQ9Pm51bGwhPXQuaW5pdGlhbFBvc2l0aW9uP3QuaW5pdGlhbFBvc2l0aW9uOjEpKSxFZSgpKSx0aGlzLl9kb21SZW5kZXJlci5wb3NpdGlvbiQpLG49dGhpcy5jb25maWd1cmF0aW9uJC5waXBlKHJ0KCh0PT50Lm1vZGUpKSx1ZSgpKSxyPXRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHJ0KCh0PT50LnN0YXRlLm1vdGlvbmxlc3MpKSx1ZSgpKSxzPXRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHJ0KCh0PT5kZCh0LnN0YXRlLmN1cnJlbnRJbWFnZS5jYW1lcmFUeXBlKSkpLHVlKCkpLG89Z3QodGhpcy5fY29uZmlndXJhdGlvbiQucGlwZShydCgodD0+dC5zbGlkZXJWaXNpYmxlKSkpLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHJ0KCh0PT4hKG51bGw9PXQuc3RhdGUuY3VycmVudEltYWdlfHxudWxsPT10LnN0YXRlLnByZXZpb3VzSW1hZ2V8fGRkKHQuc3RhdGUuY3VycmVudEltYWdlLmNhbWVyYVR5cGUpJiYhZGQodC5zdGF0ZS5wcmV2aW91c0ltYWdlLmNhbWVyYVR5cGUpKSkpLHVlKCkpKS5waXBlKHJ0KCgoW3QsZV0pPT50JiZlKSksdWUoKSk7dGhpcy5fd2FpdFN1YnNjcmlwdGlvbj1ndChuLHIscyxvKS5waXBlKGJpKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhdGUkKSkuc3Vic2NyaWJlKCgoW1tlLGksbixyXSxzXSk9Pntjb25zdCBvPXImJihpfHxlPT09dC5TbGlkZXJDb25maWd1cmF0aW9uTW9kZS5TdGF0aW9uYXJ5fHxuKTtvJiZzIT09dm0uV2FpdGluZ0ludGVyYWN0aXZlbHk/dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS53YWl0SW50ZXJhY3RpdmVseSgpOm98fHM9PT12bS5XYWl0aW5nfHx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLndhaXQoKX0pKSxlLnB1c2goZ3QoaSxuLHIscyxvKS5zdWJzY3JpYmUoKChbZSxpLG4scl0pPT57bnx8aT09PXQuU2xpZGVyQ29uZmlndXJhdGlvbk1vZGUuU3RhdGlvbmFyeXx8cj90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLm1vdmVUbygxKTp0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLm1vdmVUbyhlKX0pKSksZS5wdXNoKGd0KGksbixyLHMsbyx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5zaXplJCkucGlwZShydCgoKFt0LGUsaSxuLHJdKT0+KHtuYW1lOnRoaXMuX25hbWUsdk5vZGU6dGhpcy5fZG9tUmVuZGVyZXIucmVuZGVyKHQsZSxpLG4scil9KSkpKS5zdWJzY3JpYmUodGhpcy5fY29udGFpbmVyLmRvbVJlbmRlcmVyLnJlbmRlciQpKSx0aGlzLl9nbFJlbmRlcmVyQ3JlYXRvciQubmV4dChudWxsKSxlLnB1c2goZ3QoaSxzLG8sdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKS5waXBlKHJ0KCgoW3QsZSxpLG4scl0pPT57aWYoIWUpcmV0dXJuIGk/dDoxO2NvbnN0IHM9dGhpcy5fdmlld3BvcnRDb29yZHMudmlld3BvcnRUb0Jhc2ljKC0xLjE1LDAscixuLnBlcnNwZWN0aXZlKSxvPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLnZpZXdwb3J0VG9CYXNpYygxLjE1LDAscixuLnBlcnNwZWN0aXZlKSxhPW9bMF08c1swXT9vWzBdKzE6b1swXSxjPXNbMF0rdCooYS1zWzBdKTtyZXR1cm4gYz4xP2MtMTpjfSkpLHJ0KCh0PT5lPT4oZS51cGRhdGVDdXJ0YWluKHQpLGUpKSkpLnN1YnNjcmliZSh0aGlzLl9nbFJlbmRlcmVyT3BlcmF0aW9uJCkpLGUucHVzaChndCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQsbikucGlwZShydCgoKFt0LGVdKT0+aT0+KGkudXBkYXRlKHQsZSksaSkpKSkuc3Vic2NyaWJlKHRoaXMuX2dsUmVuZGVyZXJPcGVyYXRpb24kKSksZS5wdXNoKHRoaXMuX2NvbmZpZ3VyYXRpb24kLnBpcGUoTnQoKHQ9Pm51bGwhPXQuaWRzKSkscmkoKHQ9PkZ0KEZ0KHRoaXMuX2NhdGNoQ2FjaGVJbWFnZSQodC5pZHMuYmFja2dyb3VuZCksdGhpcy5fY2F0Y2hDYWNoZUltYWdlJCh0Lmlkcy5mb3JlZ3JvdW5kKSkucGlwZShydCgodD0+KHtiYWNrZ3JvdW5kOnRbMF0sZm9yZWdyb3VuZDp0WzFdfSkpKSksdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50U3RhdGUkLnBpcGUoRWUoKSkpLnBpcGUocnQoKHQ9Pih7aW1hZ2VzOnRbMF0sc3RhdGU6dFsxXS5zdGF0ZX0pKSkpKSkpLnN1YnNjcmliZSgodD0+e251bGwhPXQuc3RhdGUuY3VycmVudEltYWdlJiZudWxsIT10LnN0YXRlLnByZXZpb3VzSW1hZ2UmJnQuc3RhdGUuY3VycmVudEltYWdlLmlkPT09dC5pbWFnZXMuZm9yZWdyb3VuZC5pZCYmdC5zdGF0ZS5wcmV2aW91c0ltYWdlLmlkPT09dC5pbWFnZXMuYmFja2dyb3VuZC5pZHx8KHQuc3RhdGUuY3VycmVudEltYWdlLmlkIT09dC5pbWFnZXMuYmFja2dyb3VuZC5pZD90LnN0YXRlLmN1cnJlbnRJbWFnZS5pZCE9PXQuaW1hZ2VzLmZvcmVncm91bmQuaWR8fDEhPT10LnN0YXRlLnRyYWplY3RvcnkubGVuZ3RoPyh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnNldEltYWdlcyhbdC5pbWFnZXMuYmFja2dyb3VuZF0pLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc2V0SW1hZ2VzKFt0LmltYWdlcy5mb3JlZ3JvdW5kXSkpOnRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucHJlcGVuZEltYWdlcyhbdC5pbWFnZXMuYmFja2dyb3VuZF0pOnRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc2V0SW1hZ2VzKFt0LmltYWdlcy5mb3JlZ3JvdW5kXSkpfSksKHQ9Pntjb25zb2xlLmVycm9yKHQpfSkpKTtjb25zdCBhPXRoaXMuX2NvbnRhaW5lci5jb25maWd1cmF0aW9uU2VydmljZS5pbWFnZVRpbGluZyQucGlwZShyaSgodD0+dD90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQ6bmV3IFQpKSx1ZSh2b2lkIDAsKHQ9PnQuc3RhdGUuY3VycmVudEltYWdlLmlkKSksYmkodGhpcy5fY29udGFpbmVyLmdsUmVuZGVyZXIud2ViR0xSZW5kZXJlciQsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQpLHJ0KCgoW3QsZSxpXSk9Pntjb25zdCBuPXQuc3RhdGU7TWF0aC5tYXgoaS53aWR0aCxpLmhlaWdodCk7Y29uc3Qgcj1uLmN1cnJlbnRJbWFnZSxzPW4uY3VycmVudFRyYW5zZm9ybTtyZXR1cm4gbmV3IF9tKHIuaWQscy5iYXNpY1dpZHRoLHMuYmFzaWNIZWlnaHQsci5pbWFnZSx0aGlzLl9pbWFnZVRpbGVMb2FkZXIsbmV3IG9tLGUpfSkpLFVlKDEpLEUoKSk7ZS5wdXNoKGEuc3Vic2NyaWJlKCgoKT0+e30pKSksZS5wdXNoKGEucGlwZShydCgodD0+ZT0+KGUuc2V0VGV4dHVyZVByb3ZpZGVyKHQuaWQsdCksZSkpKSkuc3Vic2NyaWJlKHRoaXMuX2dsUmVuZGVyZXJPcGVyYXRpb24kKSksZS5wdXNoKGEucGlwZSh6ZSgpKS5zdWJzY3JpYmUoKHQ9Pnt0WzBdLmFib3J0KCl9KSkpO2NvbnN0IGM9dGhpcy5fY29udGFpbmVyLmNvbmZpZ3VyYXRpb25TZXJ2aWNlLmltYWdlVGlsaW5nJC5waXBlKHJpKCh0PT50P2d0KHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYUZyYW1lJCx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5zaXplJC5waXBlKHJlKDI1MCkpKTpuZXcgVCkpLHJ0KCgoW3QsZV0pPT5bdC5jYW1lcmEucG9zaXRpb24uY2xvbmUoKSx0LmNhbWVyYS5sb29rYXQuY2xvbmUoKSx0Lnpvb20udmFsdWVPZigpLGUuaGVpZ2h0LnZhbHVlT2YoKSxlLndpZHRoLnZhbHVlT2YoKV0pKSx6ZSgpLHRpKCh0PT50WzFdWzJdLXRbMF1bMl08MHx8MD09PXRbMV1bMl0pKSxydCgodD0+e2xldCBlPXRbMF1bMF0uZXF1YWxzKHRbMV1bMF0pLGk9dFswXVsxXS5lcXVhbHModFsxXVsxXSksbj10WzBdWzJdPT09dFsxXVsyXSxyPXRbMF1bM109PT10WzFdWzNdLHM9dFswXVs0XT09PXRbMV1bNF07cmV0dXJuIGUmJmkmJm4mJnImJnN9KSksdWUoKSxOdCgodD0+dCkpLHJpKCgoKT0+dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhRnJhbWUkLnBpcGUoRWUoKSkpKSxiaSh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5zaXplJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKSk7ZS5wdXNoKGEucGlwZShyaSgodD0+Yy5waXBlKHJ0KCgoW2UsaSxuXSk9Plt0aGlzLl9yb2lDYWxjdWxhdG9yLmNvbXB1dGVSZWdpb25PZkludGVyZXN0KGUsaSxuKSx0XSkpKSkpLE50KCh0PT4hdFsxXS5kaXNwb3NlZCkpKS5zdWJzY3JpYmUoKHQ9PntsZXQgZT10WzBdO3RbMV0uc2V0UmVnaW9uT2ZJbnRlcmVzdChlKX0pKSk7Y29uc3QgaD1hLnBpcGUocmkoKHQ9PnQuaGFzVGV4dHVyZSQpKSxuaSghMSksVWUoMSksRSgpKTtlLnB1c2goaC5zdWJzY3JpYmUoKCgpPT57fSkpKTtjb25zdCBsPXRoaXMuX2NvbnRhaW5lci5jb25maWd1cmF0aW9uU2VydmljZS5pbWFnZVRpbGluZyQucGlwZShyaSgodD0+dD90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQ6bmV3IFQpKSxOdCgodD0+ISF0LnN0YXRlLnByZXZpb3VzSW1hZ2UpKSx1ZSh2b2lkIDAsKHQ9PnQuc3RhdGUucHJldmlvdXNJbWFnZS5pZCkpLGJpKHRoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLndlYkdMUmVuZGVyZXIkLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnNpemUkKSxydCgoKFt0LGUsaV0pPT57Y29uc3Qgbj10LnN0YXRlLHI9bi5wcmV2aW91c0ltYWdlLHM9bi5wcmV2aW91c1RyYW5zZm9ybTtyZXR1cm4gbmV3IF9tKHIuaWQscy5iYXNpY1dpZHRoLHMuYmFzaWNIZWlnaHQsci5pbWFnZSx0aGlzLl9pbWFnZVRpbGVMb2FkZXIsbmV3IG9tLGUpfSkpLFVlKDEpLEUoKSk7ZS5wdXNoKGwuc3Vic2NyaWJlKCgoKT0+e30pKSksZS5wdXNoKGwucGlwZShydCgodD0+ZT0+KGUuc2V0VGV4dHVyZVByb3ZpZGVyUHJldih0LmlkLHQpLGUpKSkpLnN1YnNjcmliZSh0aGlzLl9nbFJlbmRlcmVyT3BlcmF0aW9uJCkpLGUucHVzaChsLnBpcGUoemUoKSkuc3Vic2NyaWJlKCh0PT57dFswXS5hYm9ydCgpfSkpKTtjb25zdCB1PXRoaXMuX2NvbnRhaW5lci5jb25maWd1cmF0aW9uU2VydmljZS5pbWFnZVRpbGluZyQucGlwZShyaSgodD0+dD9ndCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmFGcmFtZSQsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQucGlwZShyZSgyNTApKSk6bmV3IFQpKSxydCgoKFt0LGVdKT0+W3QuY2FtZXJhLnBvc2l0aW9uLmNsb25lKCksdC5jYW1lcmEubG9va2F0LmNsb25lKCksdC56b29tLnZhbHVlT2YoKSxlLmhlaWdodC52YWx1ZU9mKCksZS53aWR0aC52YWx1ZU9mKCldKSksemUoKSx0aSgodD0+dFsxXVsyXS10WzBdWzJdPDB8fDA9PT10WzFdWzJdKSkscnQoKHQ9PntsZXQgZT10WzBdWzBdLmVxdWFscyh0WzFdWzBdKSxpPXRbMF1bMV0uZXF1YWxzKHRbMV1bMV0pLG49dFswXVsyXT09PXRbMV1bMl0scj10WzBdWzNdPT09dFsxXVszXSxzPXRbMF1bNF09PT10WzFdWzRdO3JldHVybiBlJiZpJiZuJiZyJiZzfSkpLHVlKCksTnQoKHQ9PnQpKSxyaSgoKCk9PnRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYUZyYW1lJC5waXBlKEVlKCkpKSksYmkodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCkpO2UucHVzaChsLnBpcGUocmkoKHQ9PnUucGlwZShydCgoKFtlLGksbl0pPT5bdGhpcy5fcm9pQ2FsY3VsYXRvci5jb21wdXRlUmVnaW9uT2ZJbnRlcmVzdChlLGksbiksdF0pKSkpKSxOdCgodD0+IXRbMV0uZGlzcG9zZWQpKSxiaSh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQpKS5zdWJzY3JpYmUoKChbW3QsZV0saV0pPT57bGV0IG49bnVsbDtpZihkZChpLnN0YXRlLnByZXZpb3VzSW1hZ2UuY2FtZXJhVHlwZSkpaWYoZGQoaS5zdGF0ZS5jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSkpe2NvbnN0IGU9dGhpcy5fc3BhdGlhbC52aWV3aW5nRGlyZWN0aW9uKGkuc3RhdGUuY3VycmVudEltYWdlLnJvdGF0aW9uKSxyPXRoaXMuX3NwYXRpYWwudmlld2luZ0RpcmVjdGlvbihpLnN0YXRlLnByZXZpb3VzSW1hZ2Uucm90YXRpb24pLHM9dGhpcy5fc3BhdGlhbC5hbmdsZUJldHdlZW5WZWN0b3IyKGUueCxlLnksci54LHIueSkvKDIqTWF0aC5QSSk7bj17YmJveDp7bWF4WDp0aGlzLl9zcGF0aWFsLndyYXAodC5iYm94Lm1heFgrcywwLDEpLG1heFk6dC5iYm94Lm1heFksbWluWDp0aGlzLl9zcGF0aWFsLndyYXAodC5iYm94Lm1pblgrcywwLDEpLG1pblk6dC5iYm94Lm1pbll9LHBpeGVsSGVpZ2h0OnQucGl4ZWxIZWlnaHQscGl4ZWxXaWR0aDp0LnBpeGVsV2lkdGh9fWVsc2V7Y29uc3QgZT10aGlzLl9zcGF0aWFsLnZpZXdpbmdEaXJlY3Rpb24oaS5zdGF0ZS5jdXJyZW50SW1hZ2Uucm90YXRpb24pLHI9dGhpcy5fc3BhdGlhbC52aWV3aW5nRGlyZWN0aW9uKGkuc3RhdGUucHJldmlvdXNJbWFnZS5yb3RhdGlvbikscz10aGlzLl9zcGF0aWFsLmFuZ2xlQmV0d2VlblZlY3RvcjIoZS54LGUueSxyLngsci55KS8oMipNYXRoLlBJKSxvPXRoaXMuX3NwYXRpYWwuYW5nbGVUb1BsYW5lKGUudG9BcnJheSgpLFswLDAsMV0pLGE9KHRoaXMuX3NwYXRpYWwuYW5nbGVUb1BsYW5lKHIudG9BcnJheSgpLFswLDAsMV0pLW8pLygyKk1hdGguUEkpLGM9aS5zdGF0ZS5jdXJyZW50VHJhbnNmb3JtLGg9TWF0aC5tYXgoYy5iYXNpY1dpZHRoLGMuYmFzaWNIZWlnaHQpLGw9aD4wPzIqTWF0aC5hdGFuKC41KmMuYmFzaWNXaWR0aC8oaCpjLmZvY2FsKSk6TWF0aC5QSS8zLHU9aD4wPzIqTWF0aC5hdGFuKC41KmMuYmFzaWNIZWlnaHQvKGgqYy5mb2NhbCkpOk1hdGguUEkvMyxkPWwvKDIqTWF0aC5QSSkscD11L01hdGguUEksZj0odC5iYm94Lm1heFgtdC5iYm94Lm1pblgpKmQsbT0odC5iYm94Lm1heFktdC5iYm94Lm1pblkpKnAsZz10LnBpeGVsV2lkdGgqZCxfPXQucGl4ZWxIZWlnaHQqcCx2PSh0LmJib3gubWluWCt0LmJib3gubWF4WCkvMi0uNSx5PSh0LmJib3gubWluWSt0LmJib3gubWF4WSkvMi0uNSxiPS41K3MrZCp2LWYvMix4PS41K3MrZCp2K2YvMix3PS41K2ErcCp5LW0vMixTPS41K2ErcCp5K20vMjtuPXtiYm94OnttYXhYOnRoaXMuX3NwYXRpYWwud3JhcCh4LDAsMSksbWF4WTpTLG1pblg6dGhpcy5fc3BhdGlhbC53cmFwKGIsMCwxKSxtaW5ZOnd9LHBpeGVsSGVpZ2h0Ol8scGl4ZWxXaWR0aDpnfX1lbHNle2NvbnN0IGU9aS5zdGF0ZS5jdXJyZW50VHJhbnNmb3JtLmJhc2ljQXNwZWN0LHI9aS5zdGF0ZS5wcmV2aW91c1RyYW5zZm9ybS5iYXNpY0FzcGVjdCxbW3Msb10sW2EsY11dPXRoaXMuX2dldEJhc2ljQ29ybmVycyhlLHIpLGg9YS1zLGw9Yy1vLHU9dC5waXhlbFdpZHRoL2gsZD10LnBpeGVsSGVpZ2h0L2wscD0oaC0xKS8oMipoKSt0LmJib3gubWluWC9oLGY9KGgtMSkvKDIqaCkrdC5iYm94Lm1heFgvaCxtPShsLTEpLygyKmwpK3QuYmJveC5taW5ZL2wsZz17bWF4WDpmLG1heFk6KGwtMSkvKDIqbCkrdC5iYm94Lm1heFkvbCxtaW5YOnAsbWluWTptfTt0aGlzLl9jbGlwQm91bmRpbmdCb3goZyksbj17YmJveDpnLHBpeGVsSGVpZ2h0OmQscGl4ZWxXaWR0aDp1fX1lLnNldFJlZ2lvbk9mSW50ZXJlc3Qobil9KSkpO2NvbnN0IGQ9bC5waXBlKHJpKCh0PT50Lmhhc1RleHR1cmUkKSksbmkoITEpLFVlKDEpLEUoKSk7ZS5wdXNoKGQuc3Vic2NyaWJlKCgoKT0+e30pKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl93YWl0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zdGF0ZSQucGlwZShFZSgpKS5zdWJzY3JpYmUoKHQ9Pnt0IT09dm0uVHJhdmVyc2luZyYmdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS50cmF2ZXJzZSgpfSkpLHRoaXMuX2dsUmVuZGVyZXJEaXNwb3NlciQubmV4dChudWxsKSx0aGlzLl9kb21SZW5kZXJlci5kZWFjdGl2YXRlKCksdGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpLHRoaXMuY29uZmlndXJlKHtpZHM6bnVsbH0pfV9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpe3JldHVybntpbml0aWFsUG9zaXRpb246MSxtb2RlOnQuU2xpZGVyQ29uZmlndXJhdGlvbk1vZGUuTW90aW9uLHNsaWRlclZpc2libGU6ITB9fV9jYXRjaENhY2hlSW1hZ2UkKHQpe3JldHVybiB0aGlzLl9uYXZpZ2F0b3IuZ3JhcGhTZXJ2aWNlLmNhY2hlSW1hZ2UkKHQpLnBpcGUodGUoKGU9Pihjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgc2xpZGVyIGltYWdlICgke3R9KWAsZSksQigpKSkpKX1fZ2V0QmFzaWNDb3JuZXJzKHQsZSl7bGV0IGksbjtyZXR1cm4gdD5lPyhpPS41LG49LjUqdC9lKTooaT0uNSplL3Qsbj0uNSksW1suNS1pLC41LW5dLFsuNStpLC41K25dXX1fY2xpcEJvdW5kaW5nQm94KHQpe3QubWluWD1NYXRoLm1heCgwLE1hdGgubWluKDEsdC5taW5YKSksdC5tYXhYPU1hdGgubWF4KDAsTWF0aC5taW4oMSx0Lm1heFgpKSx0Lm1pblk9TWF0aC5tYXgoMCxNYXRoLm1pbigxLHQubWluWSkpLHQubWF4WT1NYXRoLm1heCgwLE1hdGgubWluKDEsdC5tYXhZKSl9fXRnLmNvbXBvbmVudE5hbWU9XCJzbGlkZXJcIjtjbGFzcyBlZ3tjb25zdHJ1Y3RvcihlLGkpe3RoaXMuX3N1YnNjcmlwdGlvbnM9bmV3IFVmLHRoaXMuX2dyYXBoU2VydmljZT1lLHRoaXMuX3N0YXRlU2VydmljZT1pO2NvbnN0IG49dGhpcy5fc3Vic2NyaXB0aW9uczt0aGlzLl9kaXJlY3Rpb25TdWJqZWN0JD1uZXcgVCx0aGlzLl9kaXJlY3Rpb24kPXRoaXMuX2RpcmVjdGlvblN1YmplY3QkLnBpcGUobmkodC5OYXZpZ2F0aW9uRGlyZWN0aW9uLk5leHQpLFVlKDEpLEUoKSksbi5wdXNoKHRoaXMuX2RpcmVjdGlvbiQuc3Vic2NyaWJlKCkpLHRoaXMuX3BsYXlpbmc9ITEsdGhpcy5fcGxheWluZ1N1YmplY3QkPW5ldyBULHRoaXMuX3BsYXlpbmckPXRoaXMuX3BsYXlpbmdTdWJqZWN0JC5waXBlKG5pKHRoaXMuX3BsYXlpbmcpLFVlKDEpLEUoKSksbi5wdXNoKHRoaXMuX3BsYXlpbmckLnN1YnNjcmliZSgpKSx0aGlzLl9zcGVlZD0uNSx0aGlzLl9zcGVlZFN1YmplY3QkPW5ldyBULHRoaXMuX3NwZWVkJD10aGlzLl9zcGVlZFN1YmplY3QkLnBpcGUobmkodGhpcy5fc3BlZWQpLFVlKDEpLEUoKSksbi5wdXNoKHRoaXMuX3NwZWVkJC5zdWJzY3JpYmUoKSksdGhpcy5faW1hZ2VzQWhlYWQ9dGhpcy5fbWFwSW1hZ2VzQWhlYWQodGhpcy5fbWFwU3BlZWQodGhpcy5fc3BlZWQpKSx0aGlzLl9icmlkZ2luZyQ9bnVsbH1nZXQgcGxheWluZygpe3JldHVybiB0aGlzLl9wbGF5aW5nfWdldCBkaXJlY3Rpb24kKCl7cmV0dXJuIHRoaXMuX2RpcmVjdGlvbiR9Z2V0IHBsYXlpbmckKCl7cmV0dXJuIHRoaXMuX3BsYXlpbmckfWdldCBzcGVlZCQoKXtyZXR1cm4gdGhpcy5fc3BlZWQkfXBsYXkoKXtpZih0aGlzLl9wbGF5aW5nKXJldHVybjt0aGlzLl9zdGF0ZVNlcnZpY2UuY3V0SW1hZ2VzKCk7Y29uc3QgZT10aGlzLl9zZXRTcGVlZCh0aGlzLl9zcGVlZCk7dGhpcy5fc3RhdGVTZXJ2aWNlLnNldFNwZWVkKGUpLHRoaXMuX2dyYXBoTW9kZVN1YnNjcmlwdGlvbj10aGlzLl9zcGVlZCQucGlwZShydCgodD0+dD5lZy5zZXF1ZW5jZVNwZWVkP3ltLlNlcXVlbmNlOnltLlNwYXRpYWwpKSx1ZSgpKS5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9ncmFwaFNlcnZpY2Uuc2V0R3JhcGhNb2RlKHQpfSkpLHRoaXMuX2NhY2hlU3Vic2NyaXB0aW9uPWd0KHRoaXMuX3N0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUocnQoKHQ9Plt0LnNlcXVlbmNlSWQsdC5pZF0pKSx1ZSh2b2lkIDAsKChbdF0pPT50KSkpLHRoaXMuX2dyYXBoU2VydmljZS5ncmFwaE1vZGUkLHRoaXMuX2RpcmVjdGlvbiQpLnBpcGUocmkoKChbW2UsaV0sbixyXSk9PntpZihyIT09dC5OYXZpZ2F0aW9uRGlyZWN0aW9uLk5leHQmJnIhPT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldilyZXR1cm4gRyhbdm9pZCAwLHJdKTtyZXR1cm4gZ3QoKG49PT15bS5TZXF1ZW5jZT90aGlzLl9ncmFwaFNlcnZpY2UuY2FjaGVTZXF1ZW5jZUltYWdlcyQoZSxpKTp0aGlzLl9ncmFwaFNlcnZpY2UuY2FjaGVTZXF1ZW5jZSQoZSkpLnBpcGUoVmUoMyksdGUoKHQ9Pihjb25zb2xlLmVycm9yKHQpLEcodm9pZCAwKSkpKSksRyhyKSl9KSkscmkoKChbZSxpXSk9PntpZih2b2lkIDA9PT1lKXJldHVybiBCKCk7Y29uc3Qgbj1lLmltYWdlSWRzLnNsaWNlKCk7cmV0dXJuIGk9PT10Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldiYmbi5yZXZlcnNlKCksdGhpcy5fc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShydCgodD0+W3Quc3RhdGUudHJhamVjdG9yeVt0LnN0YXRlLnRyYWplY3RvcnkubGVuZ3RoLTFdLmlkLHQuc3RhdGUuaW1hZ2VzQWhlYWRdKSksTGUoKChbdCxlXSxbaSxyXSk9Pnt2b2lkIDA9PT10JiYodD1pKTtjb25zdCBzPW4ubGVuZ3RoLTE7aWYocj49dGhpcy5faW1hZ2VzQWhlYWR8fG5bc109PT10KXJldHVyblt0LFtdXTtjb25zdCBvPW4uaW5kZXhPZihpKSxhPW4uaW5kZXhPZih0KSsxLGM9TWF0aC5taW4ocyxvK3RoaXMuX2ltYWdlc0FoZWFkLXIpKzE7cmV0dXJuIGM8PWE/W3QsW11dOltuW2MtMV0sbi5zbGljZShhLGMpXX0pLFt2b2lkIDAsW11dKSxNdCgoKFt0LGVdKT0+YnQoZSkpKSl9KSksTXQoKHQ9PnRoaXMuX2dyYXBoU2VydmljZS5jYWNoZUltYWdlJCh0KS5waXBlKHRlKCgoKT0+QigpKSkpKSw2KSkuc3Vic2NyaWJlKCksdGhpcy5fcGxheWluZ1N1YnNjcmlwdGlvbj10aGlzLl9zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKE50KCh0PT50LnN0YXRlLmltYWdlc0FoZWFkPHRoaXMuX2ltYWdlc0FoZWFkKSksdWUodm9pZCAwLCh0PT50LnN0YXRlLmxhc3RJbWFnZS5pZCkpLHJ0KCh0PT57Y29uc3QgZT10LnN0YXRlLmxhc3RJbWFnZSxpPXQuc3RhdGUudHJhamVjdG9yeTtsZXQgbjtmb3IobGV0IHQ9aS5sZW5ndGgtMjt0Pj0wO3QtLSl7Y29uc3Qgcj1pW3RdO2lmKHIuc2VxdWVuY2VJZCE9PWUuc2VxdWVuY2VJZClicmVhaztpZihyLmNhcHR1cmVkQXQhPT1lLmNhcHR1cmVkQXQpe249ci5jYXB0dXJlZEF0PGUuY2FwdHVyZWRBdDticmVha319cmV0dXJuW3Quc3RhdGUubGFzdEltYWdlLG5dfSkpLGJpKHRoaXMuX2RpcmVjdGlvbiQpLHJpKCgoW1tlLGldLG5dKT0+RnQoKFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCx0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldl0uaW5kZXhPZihuKT4tMT9lLnNlcXVlbmNlRWRnZXMkOmUuc3BhdGlhbEVkZ2VzJCkucGlwZShFZSgodD0+dC5jYWNoZWQpKSx5aSgxNWUzKSksRyhuKSkucGlwZShydCgoKFt0LGVdKT0+e2ZvcihsZXQgaSBvZiB0LmVkZ2VzKWlmKGkuZGF0YS5kaXJlY3Rpb249PT1lKXJldHVybiBpLnRhcmdldDtyZXR1cm4gbnVsbH0pKSxyaSgodD0+bnVsbCE9dD90aGlzLl9ncmFwaFNlcnZpY2UuY2FjaGVJbWFnZSQodCk6QigpKSkpKSkpLnN1YnNjcmliZSgodD0+e3RoaXMuX3N0YXRlU2VydmljZS5hcHBlbmRJbWFnZXNzKFt0XSl9KSwodD0+e2NvbnNvbGUuZXJyb3IodCksdGhpcy5zdG9wKCl9KSksdGhpcy5fY2xlYXJTdWJzY3JpcHRpb249dGhpcy5fc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQucGlwZShYdCgxLDEwKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fc3RhdGVTZXJ2aWNlLmNsZWFyUHJpb3JJbWFnZXMoKX0pKSx0aGlzLl9zZXRQbGF5aW5nKCEwKTtjb25zdCBpPXRoaXMuX3N0YXRlU2VydmljZS5jdXJyZW50U3RhdGUkLnBpcGUocnQoKHQ9PnQuc3RhdGUpKSx1ZSgoKFt0LGVdLFtpLG5dKT0+dD09PWkmJmU9PT1uKSwodD0+W3QuY3VycmVudEltYWdlLmlkLHQubGFzdEltYWdlLmlkXSkpLE50KCh0PT50LmN1cnJlbnRJbWFnZS5pZD09PXQubGFzdEltYWdlLmlkJiZ0LmN1cnJlbnRJbmRleD09PXQudHJhamVjdG9yeS5sZW5ndGgtMSkpLHJ0KCh0PT50LmN1cnJlbnRJbWFnZSkpKTt0aGlzLl9zdG9wU3Vic2NyaXB0aW9uPWd0KGksdGhpcy5fZGlyZWN0aW9uJCkucGlwZShyaSgoKFtlLGldKT0+e2NvbnN0IG49KFt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dCx0Lk5hdmlnYXRpb25EaXJlY3Rpb24uUHJldl0uaW5kZXhPZihpKT4tMT9lLnNlcXVlbmNlRWRnZXMkOmUuc3BhdGlhbEVkZ2VzJCkucGlwZShFZSgodD0+dC5jYWNoZWQpKSx5aSgxNWUzKSx0ZSgodD0+KGNvbnNvbGUuZXJyb3IodCksRyh7Y2FjaGVkOiExLGVkZ2VzOltdfSkpKSkpO3JldHVybiBndChHKGkpLG4pLnBpcGUocnQoKChbdCxlXSk9Pntmb3IoY29uc3QgaSBvZiBlLmVkZ2VzKWlmKGkuZGF0YS5kaXJlY3Rpb249PT10KXJldHVybiEwO3JldHVybiExfSkpKX0pKSxNdCgodD0+dHx8IXRoaXMuX2JyaWRnaW5nJD9HKHQpOnRoaXMuX2JyaWRnaW5nJC5waXBlKHJ0KCh0PT5udWxsIT10KSksdGUoKHQ9Pihjb25zb2xlLmVycm9yKHQpLEcoITEpKSkpKSkpLEVlKCh0PT4hdCkpKS5zdWJzY3JpYmUodm9pZCAwLHZvaWQgMCwoKCk9Pnt0aGlzLnN0b3AoKX0pKSx0aGlzLl9zdG9wU3Vic2NyaXB0aW9uLmNsb3NlZCYmKHRoaXMuX3N0b3BTdWJzY3JpcHRpb249bnVsbCksdGhpcy5fZWFydGhTdWJzY3JpcHRpb249dGhpcy5fc3RhdGVTZXJ2aWNlLnN0YXRlJC5waXBlKHJ0KCh0PT50PT09dm0uRWFydGgpKSx1ZSgpLEVlKCh0PT50KSkpLnN1YnNjcmliZSh2b2lkIDAsdm9pZCAwLCgoKT0+e3RoaXMuc3RvcCgpfSkpLHRoaXMuX2VhcnRoU3Vic2NyaXB0aW9uLmNsb3NlZCYmKHRoaXMuX2VhcnRoU3Vic2NyaXB0aW9uPW51bGwpfWRpc3Bvc2UoKXt0aGlzLnN0b3AoKSx0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9c2V0RGlyZWN0aW9uKHQpe3RoaXMuX2RpcmVjdGlvblN1YmplY3QkLm5leHQodCl9c2V0U3BlZWQodCl7aWYoKHQ9TWF0aC5tYXgoMCxNYXRoLm1pbigxLHQpKSk9PT10aGlzLl9zcGVlZClyZXR1cm47Y29uc3QgZT10aGlzLl9zZXRTcGVlZCh0KTt0aGlzLl9wbGF5aW5nJiZ0aGlzLl9zdGF0ZVNlcnZpY2Uuc2V0U3BlZWQoZSksdGhpcy5fc3BlZWRTdWJqZWN0JC5uZXh0KHRoaXMuX3NwZWVkKX1zdG9wKCl7dGhpcy5fcGxheWluZyYmKHRoaXMuX3N0b3BTdWJzY3JpcHRpb24mJih0aGlzLl9zdG9wU3Vic2NyaXB0aW9uLmNsb3NlZHx8dGhpcy5fc3RvcFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3N0b3BTdWJzY3JpcHRpb249bnVsbCksdGhpcy5fZWFydGhTdWJzY3JpcHRpb24mJih0aGlzLl9lYXJ0aFN1YnNjcmlwdGlvbi5jbG9zZWR8fHRoaXMuX2VhcnRoU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fZWFydGhTdWJzY3JpcHRpb249bnVsbCksdGhpcy5fZ3JhcGhNb2RlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fZ3JhcGhNb2RlU3Vic2NyaXB0aW9uPW51bGwsdGhpcy5fY2FjaGVTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9jYWNoZVN1YnNjcmlwdGlvbj1udWxsLHRoaXMuX3BsYXlpbmdTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9wbGF5aW5nU3Vic2NyaXB0aW9uPW51bGwsdGhpcy5fY2xlYXJTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl9jbGVhclN1YnNjcmlwdGlvbj1udWxsLHRoaXMuX3N0YXRlU2VydmljZS5zZXRTcGVlZCgxKSx0aGlzLl9zdGF0ZVNlcnZpY2UuY3V0SW1hZ2VzKCksdGhpcy5fZ3JhcGhTZXJ2aWNlLnNldEdyYXBoTW9kZSh5bS5TcGF0aWFsKSx0aGlzLl9zZXRQbGF5aW5nKCExKSl9X21hcFNwZWVkKHQpe2NvbnN0IGU9Mip0LTE7cmV0dXJuIE1hdGgucG93KDEwLGUpLS4yKmV9X21hcEltYWdlc0FoZWFkKHQpe3JldHVybiBNYXRoLnJvdW5kKE1hdGgubWF4KDEwLE1hdGgubWluKDUwLDgrNip0KSkpfV9zZXRQbGF5aW5nKHQpe3RoaXMuX3BsYXlpbmc9dCx0aGlzLl9wbGF5aW5nU3ViamVjdCQubmV4dCh0KX1fc2V0U3BlZWQodCl7dGhpcy5fc3BlZWQ9dDtjb25zdCBlPXRoaXMuX21hcFNwZWVkKHRoaXMuX3NwZWVkKTtyZXR1cm4gdGhpcy5faW1hZ2VzQWhlYWQ9dGhpcy5fbWFwSW1hZ2VzQWhlYWQoZSksZX19ZWcuc2VxdWVuY2VTcGVlZD0uNTQsdC5DYW1lcmFWaXN1YWxpemF0aW9uTW9kZT12b2lkIDAsKHdtPXQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGV8fCh0LkNhbWVyYVZpc3VhbGl6YXRpb25Nb2RlPXt9KSlbd20uSGlkZGVuPTBdPVwiSGlkZGVuXCIsd21bd20uSG9tb2dlbmVvdXM9MV09XCJIb21vZ2VuZW91c1wiLHdtW3dtLkNsdXN0ZXI9Ml09XCJDbHVzdGVyXCIsd21bd20uQ29ubmVjdGVkQ29tcG9uZW50PTNdPVwiQ29ubmVjdGVkQ29tcG9uZW50XCIsd21bd20uU2VxdWVuY2U9NF09XCJTZXF1ZW5jZVwiLHQuT3JpZ2luYWxQb3NpdGlvbk1vZGU9dm9pZCAwLChTbT10Lk9yaWdpbmFsUG9zaXRpb25Nb2RlfHwodC5PcmlnaW5hbFBvc2l0aW9uTW9kZT17fSkpW1NtLkhpZGRlbj0wXT1cIkhpZGRlblwiLFNtW1NtLkFsdGl0dWRlPTFdPVwiQWx0aXR1ZGVcIixTbVtTbS5GbGF0PTJdPVwiRmxhdFwiO2NsYXNzIGlnIGV4dGVuZHMgUWN7Y29uc3RydWN0b3IodCl7c3VwZXIoKSx0aGlzLl9vcmlnaW5hbFNpemU9dC5vcmlnaW5hbFNpemU7Y29uc3QgZT10LmNsdXN0ZXIsaT10LnNjYWxlLG49dC50cmFuc2xhdGlvbjt0aGlzLl9tYWtlQXR0cmlidXRlcyhlKSx0aGlzLm1hdGVyaWFsLnNpemU9aSp0aGlzLl9vcmlnaW5hbFNpemUsdGhpcy5tYXRlcmlhbC52ZXJ0ZXhDb2xvcnM9ITAsdGhpcy5tYXRlcmlhbC5uZWVkc1VwZGF0ZT0hMCx0aGlzLm1hdHJpeEF1dG9VcGRhdGU9ITEsdGhpcy5wb3NpdGlvbi5mcm9tQXJyYXkobiksdGhpcy51cGRhdGVNYXRyaXgoKSx0aGlzLnVwZGF0ZU1hdHJpeFdvcmxkKCExKX1kaXNwb3NlKCl7dGhpcy5nZW9tZXRyeS5kaXNwb3NlKCksdGhpcy5tYXRlcmlhbC5kaXNwb3NlKCl9cmVzaXplKHQpe3RoaXMubWF0ZXJpYWwuc2l6ZT10KnRoaXMuX29yaWdpbmFsU2l6ZSx0aGlzLm1hdGVyaWFsLm5lZWRzVXBkYXRlPSEwfV9tYWtlQXR0cmlidXRlcyh0KXtjb25zdCBlPVtdLGk9W10sbj10LnBvaW50cztmb3IoY29uc3QgdCBpbiBuKXtpZighbi5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtjb25zdCByPW5bdF07ZS5wdXNoKC4uLnIuY29vcmRpbmF0ZXMpO2NvbnN0IHM9ci5jb2xvcjtpLnB1c2goc1swXSksaS5wdXNoKHNbMV0pLGkucHVzaChzWzJdKX1jb25zdCByPXRoaXMuZ2VvbWV0cnk7ci5zZXRBdHRyaWJ1dGUoXCJwb3NpdGlvblwiLG5ldyBIcihuZXcgRmxvYXQzMkFycmF5KGUpLDMpKSxyLnNldEF0dHJpYnV0ZShcImNvbG9yXCIsbmV3IEhyKG5ldyBGbG9hdDMyQXJyYXkoaSksMykpfX1jbGFzcyBuZyBleHRlbmRzIFVje2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5fbWFrZUF0dHJpYnV0ZXModCksdGhpcy5tYXRyaXhBdXRvVXBkYXRlPSExLHRoaXMudXBkYXRlTWF0cml4KCksdGhpcy51cGRhdGVNYXRyaXhXb3JsZCghMSl9ZGlzcG9zZSgpe3RoaXMuZ2VvbWV0cnkuZGlzcG9zZSgpLHRoaXMubWF0ZXJpYWwuZGlzcG9zZSgpfV9tYWtlQXR0cmlidXRlcyh0KXtjb25zdCBlPXQuc2xpY2UoKTtlLnB1c2godFswXSk7bGV0IGk9MDtjb25zdCBuPW5ldyBGbG9hdDMyQXJyYXkoMyoodC5sZW5ndGgrMSkpO2Zvcihjb25zdCB0IG9mIGUpbltpKytdPXRbMF0sbltpKytdPXRbMV0sbltpKytdPXRbMl07dGhpcy5nZW9tZXRyeS5zZXRBdHRyaWJ1dGUoXCJwb3NpdGlvblwiLG5ldyBIcihuLDMpKX19ZnVuY3Rpb24gcmcodCxlKXtyZXR1cm4gdD09PWV9ZnVuY3Rpb24gc2codCl7Y29uc3QgZT1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5wb3coMix0KX0odCkvMjtyZXR1cm57bWluOlstZSwtZSwtZV0sbWF4OltlLGUsZV19fWNsYXNzIG9ne2NvbnN0cnVjdG9yKHQsZSxpLG4pe3RoaXMubGV2ZWw9dCx0aGlzLmxlYWZMZXZlbD1lLHRoaXMuYm91bmRpbmdCb3g9aSx0aGlzLnBhcmVudD1uLHRoaXMuY2hpbGRyZW49W10sdGhpcy5pdGVtcz1bXSxuJiZuLmNoaWxkcmVuLnB1c2godGhpcyl9Z2V0IGlzRW1wdHkoKXtyZXR1cm4hKHRoaXMuY2hpbGRyZW4ubGVuZ3RofHx0aGlzLml0ZW1zLmxlbmd0aCl9YWRkKHQpe2NvbnN0IGU9dGhpcztpZighZS5ib3VuZGluZ0JveC5jb250YWluc1BvaW50KHQucG9zaXRpb24pKXRocm93IG5ldyBFcnJvcihcIkl0ZW0gbm90IGNvbnRhaW5lZCBpbiBub2RlXCIpO2lmKHJnKGUubGV2ZWwsZS5sZWFmTGV2ZWwpKXJldHVybiBlLml0ZW1zLnB1c2godCksdGhpcztmb3IoY29uc3QgaSBvZiBlLmNoaWxkcmVuKWlmKGkuYm91bmRpbmdCb3guY29udGFpbnNQb2ludCh0LnBvc2l0aW9uKSlyZXR1cm4gaS5hZGQodCk7Zm9yKGNvbnN0IGkgb2YgZS5fZ2VuZXJhdGVCb3VuZGluZ0JveGVzKCkpaWYoaS5jb250YWluc1BvaW50KHQucG9zaXRpb24pKXtyZXR1cm4gbmV3IG9nKGUubGV2ZWwtMSxlLmxlYWZMZXZlbCxpLGUpLmFkZCh0KX10aHJvdyBuZXcgRXJyb3IoXCJJdGVtIG5vdCBjb250YWluZWQgaW4gY2hpbGRyZW5cIil9aW50ZXJzZWN0KHQsZSxpKXtpZih0LmludGVyc2VjdEJveCh0aGlzLmJvdW5kaW5nQm94LGUpKWlmKHJnKHRoaXMubGV2ZWwsdGhpcy5sZWFmTGV2ZWwpKWkucHVzaCh0aGlzKTtlbHNlIGZvcihjb25zdCBuIG9mIHRoaXMuY2hpbGRyZW4pbi5pbnRlcnNlY3QodCxlLGkpfXJlbW92ZSh0KXtjb25zdCBlPXRoaXMuaXRlbXMuaW5kZXhPZih0KTtpZihlPDApdGhyb3cgbmV3IEVycm9yKGBJdGVtIGRvZXMgbm90IGV4aXN0ICR7dC51dWlkfWApO3RoaXMuaXRlbXMuc3BsaWNlKGUsMSl9dHJhdmVyc2UoKXtjb25zdCB0PXRoaXM7aWYoIXQuaXNFbXB0eSlyZXR1cm47Y29uc3QgZT10LnBhcmVudDtpZighZSlyZXR1cm47Y29uc3QgaT1lLmNoaWxkcmVuLmluZGV4T2YodCk7aWYoaTwwKXRocm93IG5ldyBFcnJvcihcIkNvcnJ1cHQgb2N0cmVlXCIpO2UuY2hpbGRyZW4uc3BsaWNlKGksMSksdGhpcy5wYXJlbnQ9bnVsbCxlLnRyYXZlcnNlKCl9X2dlbmVyYXRlQm91bmRpbmdCb3hlcygpe2NvbnN0IHQ9dGhpcy5ib3VuZGluZ0JveC5taW4sZT0odGhpcy5ib3VuZGluZ0JveC5tYXgueC10LngpLzIsaT1bW3QueCx0LnkrZSx0LnorZV0sW3QueCtlLHQueStlLHQueitlXSxbdC54LHQueSx0LnorZV0sW3QueCtlLHQueSx0LnorZV0sW3QueCx0LnkrZSx0LnpdLFt0LngrZSx0LnkrZSx0LnpdLFt0LngsdC55LHQuel0sW3QueCtlLHQueSx0LnpdXSxuPVtdO2Zvcihjb25zdFt0LHIsc11vZiBpKW4ucHVzaChuZXcgX24obmV3IGZuKHQscixzKSxuZXcgZm4odCtlLHIrZSxzK2UpKSk7cmV0dXJuIG59fWNsYXNzIGFne2NvbnN0cnVjdG9yKHQsZSl7aWYodGhpcy5yb290TGV2ZWw9dCx0aGlzLmxlYWZMZXZlbD1lLGU+dCl0aHJvdyBuZXcgRXJyb3I7dGhpcy5faW5kZXg9bmV3IE1hcCx0aGlzLl9yb290PXRoaXMuX21ha2VSb290KCl9Z2V0IHJvb3QoKXtyZXR1cm4gdGhpcy5fcm9vdH1hZGQodCl7aWYoIXRoaXMucm9vdC5ib3VuZGluZ0JveC5jb250YWluc1BvaW50KHQucG9zaXRpb24pKXJldHVybiB2b2lkIGNvbnNvbGUud2FybihgT2JqZWN0IG91dHNpZGUgYm91bmRpbmcgYm94ICR7dC51dWlkfWApO2NvbnN0IGU9dGhpcy5fcm9vdC5hZGQodCk7dGhpcy5faW5kZXguc2V0KHQudXVpZCxlKX1oYXModCl7cmV0dXJuIHRoaXMuX2luZGV4Lmhhcyh0LnV1aWQpfWludGVyc2VjdCh0KXtjb25zdCBlPVtdLGk9bmV3IGZuO3JldHVybiB0aGlzLl9yb290LmludGVyc2VjdCh0LGksZSksZS5tYXAoKHQ9PnQuaXRlbXMpKS5yZWR1Y2UoKCh0LGUpPT4odC5wdXNoKC4uLmUpLHQpKSxbXSl9cmVzZXQoKXt0aGlzLl9yb290PXRoaXMuX21ha2VSb290KCksdGhpcy5faW5kZXguY2xlYXIoKX1yZW1vdmUodCl7aWYoIXRoaXMuaGFzKHQpKXRocm93IG5ldyBFcnJvcihgRnJhbWUgZG9lcyBub3QgZXhpc3QgJHt0LnV1aWR9YCk7Y29uc3QgZT10aGlzLl9pbmRleC5nZXQodC51dWlkKTtlLnJlbW92ZSh0KSxlLnRyYXZlcnNlKCksdGhpcy5faW5kZXguZGVsZXRlKHQudXVpZCl9X21ha2VSb290KCl7Y29uc3QgdD10aGlzLnJvb3RMZXZlbCxlPXNnKHQpLGk9bmV3IF9uKChuZXcgZm4pLmZyb21BcnJheShlLm1pbiksKG5ldyBmbikuZnJvbUFycmF5KGUubWF4KSk7cmV0dXJuIG5ldyBvZyh0LHRoaXMubGVhZkxldmVsLGkpfX1jbGFzcyBjZ3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX29iamVjdHM9W10sdGhpcy5fb2JqZWN0SW1hZ2VNYXA9bmV3IE1hcCx0aGlzLl9vY3RyZWU9bnVsbCE9dD90Om5ldyBhZygxNCw2KSx0aGlzLl9yYXljYXN0ZXI9bnVsbCE9ZT9lOm5ldyBCdSx0aGlzLl9pbnRlcmFjdGl2ZUxheWVyPTEsdGhpcy5fcmF5Y2FzdGVyPWV8fG5ldyBCdSh2b2lkIDAsdm9pZCAwLDEsMWU0KSx0aGlzLl9saW5lVGhyZXNob2xkPS4yLHRoaXMuX2xhcmdlTGluZVRocmVzaG9sZD0uNCx0aGlzLl9yYXljYXN0ZXIucGFyYW1zLkxpbmUudGhyZXNob2xkPXRoaXMuX2xpbmVUaHJlc2hvbGQsdGhpcy5fcmF5Y2FzdGVyLmxheWVycy5zZXQodGhpcy5faW50ZXJhY3RpdmVMYXllcil9Z2V0IGludGVyYWN0aXZlTGF5ZXIoKXtyZXR1cm4gdGhpcy5faW50ZXJhY3RpdmVMYXllcn1nZXQgb2N0cmVlKCl7cmV0dXJuIHRoaXMuX29jdHJlZX1nZXQgcmF5Y2FzdGVyKCl7cmV0dXJuIHRoaXMuX3JheWNhc3Rlcn1hZGQodCxlKXtjb25zdCBpPXQudXVpZDt0aGlzLl9vYmplY3RJbWFnZU1hcC5zZXQoaSxlKSx0aGlzLl9vYmplY3RzLnB1c2godCksdGhpcy5fb2N0cmVlLmFkZCh0KX1pbnRlcnNlY3RPYmplY3RzKHQsZSl7dGhpcy5fcmF5Y2FzdGVyLnNldEZyb21DYW1lcmEoKG5ldyBybikuZnJvbUFycmF5KHQpLGUpO2NvbnN0IGk9dGhpcy5fb2N0cmVlLmludGVyc2VjdCh0aGlzLnJheWNhc3Rlci5yYXkpLG49dGhpcy5fcmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHMoaSkscj10aGlzLl9vYmplY3RJbWFnZU1hcDtmb3IoY29uc3QgdCBvZiBuKXtjb25zdCBlPXQub2JqZWN0LnV1aWQ7aWYoci5oYXMoZSkpcmV0dXJuIHIuZ2V0KGUpfXJldHVybiBudWxsfXJlbW92ZSh0KXtjb25zdCBlPXRoaXMuX29iamVjdHMsaT1lLmluZGV4T2YodCk7aWYoLTEhPT1pKXtjb25zdCBuPWUuc3BsaWNlKGksMSk7Zm9yKGNvbnN0IHQgb2Ygbil0aGlzLl9vYmplY3RJbWFnZU1hcC5kZWxldGUodC51dWlkKTt0aGlzLl9vY3RyZWUucmVtb3ZlKHQpfWVsc2UgY29uc29sZS53YXJuKFwiT2JqZWN0IGRvZXMgbm90IGV4aXN0XCIpfXJlc2V0SW50ZXJzZWN0aW9uVGhyZXNob2xkKHQpe3RoaXMuX3JheWNhc3Rlci5wYXJhbXMuTGluZS50aHJlc2hvbGQ9dD90aGlzLl9sYXJnZUxpbmVUaHJlc2hvbGQ6dGhpcy5fbGluZVRocmVzaG9sZH19Y2xhc3MgaGcgZXh0ZW5kcyBVY3tjb25zdHJ1Y3Rvcih0KXtzdXBlcih0Lmdlb21ldHJ5LHQubWF0ZXJpYWwpO2NvbnN0IGU9dC5tb2RlLGk9dC5vcmlnaW5hbE9yaWdpbixuPXQudHJhbnNmb3JtLnVucHJvamVjdEJhc2ljKFswLDBdLDApO3RoaXMuX3JlbGF0aXZlQWx0aXR1ZGU9aVsyXS1uWzJdLHRoaXMuX21ha2VBdHRyaWJ1dGVzKG4saSxlKSx0aGlzLm1hdHJpeEF1dG9VcGRhdGU9ITEsdGhpcy5wb3NpdGlvbi5mcm9tQXJyYXkobiksdGhpcy51cGRhdGVNYXRyaXgoKSx0aGlzLnVwZGF0ZU1hdHJpeFdvcmxkKCExKX1kaXNwb3NlKCl7dGhpcy5nZW9tZXRyeS5kaXNwb3NlKCksdGhpcy5tYXRlcmlhbC5kaXNwb3NlKCl9c2V0TW9kZSh0KXtjb25zdCBlPXRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbjtlLmFycmF5WzVdPXRoaXMuX21vZGVUb0FsdGl0dWRlKHQpLGUubmVlZHNVcGRhdGU9ITAsdGhpcy5nZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKX1fbWFrZUF0dHJpYnV0ZXModCxlLGkpe2NvbnN0IG49bmV3IEZsb2F0MzJBcnJheSg2KTtuWzBdPTAsblsxXT0wLG5bMl09MCxuWzNdPWVbMF0tdFswXSxuWzRdPWVbMV0tdFsxXSxuWzVdPXRoaXMuX21vZGVUb0FsdGl0dWRlKGkpO2NvbnN0IHI9bmV3IEhyKG4sMyk7dGhpcy5nZW9tZXRyeS5zZXRBdHRyaWJ1dGUoXCJwb3NpdGlvblwiLHIpLHIubmVlZHNVcGRhdGU9ITAsdGhpcy5nZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKX1fbW9kZVRvQWx0aXR1ZGUoZSl7cmV0dXJuIGU9PT10Lk9yaWdpbmFsUG9zaXRpb25Nb2RlLkFsdGl0dWRlP3RoaXMuX3JlbGF0aXZlQWx0aXR1ZGU6MH19Y2xhc3MgbGcgZXh0ZW5kcyBxY3tjb25zdHJ1Y3Rvcih0KXtzdXBlcih0Lmdlb21ldHJ5LHQubWF0ZXJpYWwpO2NvbnN0IGU9dC5jb2xvcixpPXQuc2l6ZSxuPXQuc2NhbGUscj10LnRyYW5zZm9ybSxzPXIudW5wcm9qZWN0QmFzaWMoWzAsMF0sMCksbz10aGlzLl9tYWtlUG9zaXRpb25zKGkscixzKTt0aGlzLl9tYWtlQXR0cmlidXRlcyhvLGUpLHRoaXMuZ2VvbWV0cnkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCksdGhpcy5nZW9tZXRyeS5jb21wdXRlQm91bmRpbmdCb3goKSx0aGlzLm1hdHJpeEF1dG9VcGRhdGU9ITEsdGhpcy5wb3NpdGlvbi5mcm9tQXJyYXkocyksdGhpcy5zY2FsZS5zZXQobixuLG4pLHRoaXMudXBkYXRlTWF0cml4KCksdGhpcy51cGRhdGVNYXRyaXhXb3JsZCghMSl9ZGlzcG9zZSgpe3RoaXMuZ2VvbWV0cnkuZGlzcG9zZSgpLHRoaXMubWF0ZXJpYWwuZGlzcG9zZSgpfXNldENvbG9yKHQpe3JldHVybiB0aGlzLl91cGRhdGVDb2xvckF0dHJpYnV0ZSh0KSx0aGlzfXJlc2l6ZSh0KXtyZXR1cm4gdGhpcy5zY2FsZS5zZXQodCx0LHQpLHRoaXMudXBkYXRlTWF0cml4KCksdGhpcy51cGRhdGVNYXRyaXhXb3JsZCghMSksdGhpc31fbWFrZUF0dHJpYnV0ZXModCxlKXtjb25zdCBpPXRoaXMuZ2VvbWV0cnksbj1uZXcgSHIobmV3IEZsb2F0MzJBcnJheSh0KSwzKTtpLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbiksbi5uZWVkc1VwZGF0ZT0hMDtjb25zdCByPW5ldyBIcihuZXcgRmxvYXQzMkFycmF5KHQubGVuZ3RoKSwzKTtpLnNldEF0dHJpYnV0ZShcImNvbG9yXCIsciksdGhpcy5fdXBkYXRlQ29sb3JBdHRyaWJ1dGUoZSl9X3VwZGF0ZUNvbG9yQXR0cmlidXRlKHQpe2NvbnN0W2UsaSxuXT1uZXcgRHIodCkudG9BcnJheSgpLHI9dGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLmNvbG9yLHM9ci5hcnJheSxvPXMubGVuZ3RoO2xldCBhPTA7Zm9yKGxldCB0PTA7dDxvO3QrKylzW2ErK109ZSxzW2ErK109aSxzW2ErK109bjtyLm5lZWRzVXBkYXRlPSEwfX1jbGFzcyB1ZyBleHRlbmRzIGxne19tYWtlUG9zaXRpb25zKHQsZSxpKXtjb25zdCBuPVtdO24ucHVzaCguLi50aGlzLl9tYWtlQXhpcyh0LGUsaSkpLG4ucHVzaCguLi50aGlzLl9tYWtlTGF0KC41LDEwLHQsZSxpKSk7Zm9yKGNvbnN0IHIgb2ZbMCwuMjUsLjUsLjc1XSluLnB1c2goLi4udGhpcy5fbWFrZUxuZyhyLDEwLHQsZSxpKSk7cmV0dXJuIG59X21ha2VBeGlzKHQsZSxpKXtjb25zdCBuPWUudW5wcm9qZWN0QmFzaWMoWy41LDFdLC44KnQpLHI9ZS51bnByb2plY3RCYXNpYyhbLjUsMF0sMS4yKnQpO3JldHVybltuWzBdLWlbMF0sblsxXS1pWzFdLG5bMl0taVsyXSxyWzBdLWlbMF0sclsxXS1pWzFdLHJbMl0taVsyXV19X21ha2VMYXQodCxlLGksbixyKXtjb25zdCBzPS44KmksW28sYSxjXT1yLGg9W10sbD1uLnVucHJvamVjdEJhc2ljKFswLHRdLHMpO2xbMF0tPW8sbFsxXS09YSxsWzJdLT1jLGgucHVzaCguLi5sKTtmb3IobGV0IGk9MTtpPD1lO2krKyl7Y29uc3Qgcj1uLnVucHJvamVjdEJhc2ljKFtpL2UsdF0scyk7clswXS09byxyWzFdLT1hLHJbMl0tPWMsaC5wdXNoKC4uLnIsLi4ucil9cmV0dXJuIGgucHVzaCguLi5sKSxofV9tYWtlTG5nKHQsZSxpLG4scil7Y29uc3Qgcz0uOCppLFtvLGEsY109cixoPVtdLGw9bi51bnByb2plY3RCYXNpYyhbdCwwXSxzKTtsWzBdLT1vLGxbMV0tPWEsbFsyXS09YyxoLnB1c2goLi4ubCk7Zm9yKGxldCBpPTA7aTw9ZTtpKyspe2NvbnN0IHI9bi51bnByb2plY3RCYXNpYyhbdCxpL2VdLHMpO3JbMF0tPW8sclsxXS09YSxyWzJdLT1jLGgucHVzaCguLi5yLC4uLnIpfXJldHVybiBoLnB1c2goLi4ubCksaH19Y2xhc3MgZGcgZXh0ZW5kcyBsZ3tfbWFrZVBvc2l0aW9ucyh0LGUsaSl7Y29uc3Qgbj1bXTtyZXR1cm4gbi5wdXNoKC4uLnRoaXMuX21ha2VEaWFncyh0LGUsaSkpLG4ucHVzaCguLi50aGlzLl9tYWtlRnJhbWUodCw4LGUsaSkpLG59X21ha2VEaWFncyh0LGUsaSl7Y29uc3Qgbj10LFtyLHMsb109aSxhPVswLDAsMF0sYz1bXTtmb3IoY29uc3QgdCBvZltbMCwwXSxbMSwwXSxbMSwxXSxbMCwxXV0pe2NvbnN0IGk9ZS51bnByb2plY3RCYXNpYyh0LG4sITApO2lbMF0tPXIsaVsxXS09cyxpWzJdLT1vLGMucHVzaCguLi5hLC4uLmkpfXJldHVybiBjfV9tYWtlRnJhbWUodCxlLGksbil7Y29uc3Qgcj1bXTtyLnB1c2goLi4udGhpcy5fc3Vic2FtcGxlKFswLDFdLFswLDBdLGUpKSxyLnB1c2goLi4udGhpcy5fc3Vic2FtcGxlKFswLDBdLFsxLDBdLGUpKSxyLnB1c2goLi4udGhpcy5fc3Vic2FtcGxlKFsxLDBdLFsxLDFdLGUpKTtjb25zdCBzPXQsW28sYSxjXT1uLGg9W107Zm9yKGNvbnN0IHQgb2Ygcil7Y29uc3QgZT1pLnVucHJvamVjdEJhc2ljKHQscywhMCk7ZVswXS09byxlWzFdLT1hLGVbMl0tPWMsaC5wdXNoKC4uLmUpfXJldHVybiBofV9pbnRlcnBvbGF0ZSh0LGUsaSl7cmV0dXJuIHQraSooZS10KX1fc3Vic2FtcGxlKHQsZSxpKXtpZihpPDEpcmV0dXJuW3QsZV07Y29uc3Qgbj1bXTtuLnB1c2godCk7Zm9yKGxldCByPTA7cjw9aTtyKyspe2NvbnN0IHM9W107Zm9yKGxldCBuPTA7bjwzO24rKylzLnB1c2godGhpcy5faW50ZXJwb2xhdGUodFtuXSxlW25dLHIvKGkrMSkpKTtuLnB1c2gocyksbi5wdXNoKHMpfXJldHVybiBuLnB1c2goZSksbn19Y2xhc3MgcGd7Y29uc3RydWN0b3IodCxlLGkpe3RoaXMuaWQ9dCx0aGlzLl9zY2VuZT1lLHRoaXMuX2ludGVyc2VjdGlvbj1pLHRoaXMuY2FtZXJhcz1uZXcgcHIsdGhpcy5rZXlzPVtdLHRoaXMuX3Bvc2l0aW9uTGluZXM9e30sdGhpcy5fcG9zaXRpb25zPW5ldyBwcix0aGlzLl9jYW1lcmFGcmFtZXM9e30sdGhpcy5fY2x1c3RlcnM9bmV3IE1hcCx0aGlzLl9jb25uZWN0ZWRDb21wb25lbnRzPW5ldyBNYXAsdGhpcy5fc2VxdWVuY2VzPW5ldyBNYXAsdGhpcy5fcHJvcHM9e30sdGhpcy5jbHVzdGVyVmlzaWJsZXM9e30sdGhpcy5fZnJhbWVNYXRlcmlhbD1uZXcga2Moe2ZvZzohMSx2ZXJ0ZXhDb2xvcnM6ITB9KSx0aGlzLl9wb3NpdGlvbk1hdGVyaWFsPW5ldyBrYyh7Zm9nOiExLGNvbG9yOjE2NzExNjgwfSksdGhpcy5fc2NlbmUuYWRkKHRoaXMuY2FtZXJhcyx0aGlzLl9wb3NpdGlvbnMpfWFkZEltYWdlKHQpe2NvbnN0IGU9dC5pbWFnZSxpPWUuaWQ7aWYodGhpcy5oYXNJbWFnZShpKSl0aHJvdyBuZXcgRXJyb3IoYEltYWdlIGV4aXN0cyAke2l9YCk7Y29uc3Qgbj10LmlkTWFwLmNjSWQ7dGhpcy5fY29ubmVjdGVkQ29tcG9uZW50cy5oYXMobil8fHRoaXMuX2Nvbm5lY3RlZENvbXBvbmVudHMuc2V0KG4sW10pO2NvbnN0IHI9dC5pZE1hcC5jbHVzdGVySWQ7dGhpcy5fY2x1c3RlcnMuaGFzKHIpfHx0aGlzLl9jbHVzdGVycy5zZXQocixbXSk7Y29uc3Qgcz10LmlkTWFwLnNlcXVlbmNlSWQ7dGhpcy5fc2VxdWVuY2VzLmhhcyhzKXx8dGhpcy5fc2VxdWVuY2VzLnNldChzLFtdKSx0aGlzLl9wcm9wc1tpXT17aW1hZ2U6ZSxpZHM6e2NjSWQ6bixjbHVzdGVySWQ6cixzZXF1ZW5jZUlkOnN9fSx0aGlzLmtleXMucHVzaChpKX1hcHBseUNhbWVyYUNvbG9yKHQsZSl7dGhpcy5fY2FtZXJhRnJhbWVzW3RdLnNldENvbG9yKGUpfWFwcGx5Q2FtZXJhU2l6ZSh0KXtmb3IoY29uc3QgZSBvZiB0aGlzLmNhbWVyYXMuY2hpbGRyZW4pZS5yZXNpemUodCl9YXBwbHlGaWx0ZXIodCl7dmFyIGU7Y29uc3QgaT10aGlzLmNsdXN0ZXJWaXNpYmxlcztmb3IoY29uc3QgdCBpbiBpKWkuaGFzT3duUHJvcGVydHkodCkmJihpW3RdPSExKTtjb25zdCBuPXRoaXMuX2NhbWVyYUZyYW1lcyxyPXRoaXMuX3Bvc2l0aW9uTGluZXMscz10aGlzLl9pbnRlcnNlY3Rpb24uaW50ZXJhY3RpdmVMYXllcjtmb3IoY29uc3QgbyBvZiBPYmplY3QudmFsdWVzKHRoaXMuX3Byb3BzKSl7Y29uc3QgYT1vLmltYWdlLGM9dChhKSxoPWEuaWQ7cltoXS52aXNpYmxlPWM7Y29uc3QgbD1uW2hdO3RoaXMuX3NldENhbWVyYVZpc2liaWxpdHkobCxjLHMpLGlbZT1vLmlkcy5jbHVzdGVySWRdfHwoaVtlXT1jKX19YXBwbHlQb3NpdGlvbk1vZGUoZSl7dGhpcy5fcG9zaXRpb25zLnZpc2libGU9ZSE9PXQuT3JpZ2luYWxQb3NpdGlvbk1vZGUuSGlkZGVuO2Zvcihjb25zdCB0IG9mIHRoaXMuX3Bvc2l0aW9ucy5jaGlsZHJlbil0LnNldE1vZGUoZSl9ZGlzcG9zZSgpe3RoaXMuX2Rpc3Bvc2VDYW1lcmFzKCksdGhpcy5fZGlzcG9zZVBvc2l0aW9ucygpLHRoaXMuX3NjZW5lPW51bGwsdGhpcy5faW50ZXJzZWN0aW9uPW51bGx9Z2V0Q2FtZXJhc0J5TW9kZShlKXtpZihlPT09dC5DYW1lcmFWaXN1YWxpemF0aW9uTW9kZS5DbHVzdGVyKXJldHVybiB0aGlzLl9jbHVzdGVycztpZihlPT09dC5DYW1lcmFWaXN1YWxpemF0aW9uTW9kZS5Db25uZWN0ZWRDb21wb25lbnQpcmV0dXJuIHRoaXMuX2Nvbm5lY3RlZENvbXBvbmVudHM7aWYoZT09PXQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGUuU2VxdWVuY2UpcmV0dXJuIHRoaXMuX3NlcXVlbmNlcztjb25zdCBpPXQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGUsbj1pW2kuSG9tb2dlbmVvdXNdLHI9bmV3IE1hcDtyZXR1cm4gci5zZXQobix0aGlzLmNhbWVyYXMuY2hpbGRyZW4pLHJ9Z2V0Q29sb3JJZChlLGkpe2NvbnN0IG49dGhpcy5fcHJvcHNbZV0scj10LkNhbWVyYVZpc3VhbGl6YXRpb25Nb2RlO3N3aXRjaChpKXtjYXNlIHIuQ2x1c3RlcjpyZXR1cm4gbi5pZHMuY2x1c3RlcklkO2Nhc2Ugci5Db25uZWN0ZWRDb21wb25lbnQ6cmV0dXJuIG4uaWRzLmNjSWQ7Y2FzZSByLlNlcXVlbmNlOnJldHVybiBuLmlkcy5zZXF1ZW5jZUlkO2RlZmF1bHQ6cmV0dXJuIHJbci5Ib21vZ2VuZW91c119fWhhc0ltYWdlKHQpe3JldHVybi0xIT09dGhpcy5rZXlzLmluZGV4T2YodCl9dmlzdWFsaXplKHQpe3ZhciBlLGk7Y29uc3Qgbj10LmlkLHI9dC52aXNpYmxlLHM9dC50cmFuc2Zvcm0sbz17Y29sb3I6dC5jb2xvcixtYXRlcmlhbDp0aGlzLl9mcmFtZU1hdGVyaWFsLHNjYWxlOnQuc2NhbGUsc2l6ZTp0Lm1heFNpemUsdHJhbnNmb3JtOnN9LGE9ZGQocy5jYW1lcmFUeXBlKT9uZXcgdWcobyk6bmV3IGRnKG8pLGM9dGhpcy5faW50ZXJzZWN0aW9uLmludGVyYWN0aXZlTGF5ZXI7dGhpcy5fc2V0Q2FtZXJhVmlzaWJpbGl0eShhLHIsYyksdGhpcy5jYW1lcmFzLmFkZChhKSx0aGlzLl9jYW1lcmFGcmFtZXNbbl09YTt0aGlzLl9pbnRlcnNlY3Rpb24uYWRkKGEsbik7Y29uc3QgaD10aGlzLl9wcm9wc1tuXS5pZHM7KGU9dGhpcy5jbHVzdGVyVmlzaWJsZXMpW2k9aC5jbHVzdGVySWRdfHwoZVtpXT1yKSx0aGlzLl9jb25uZWN0ZWRDb21wb25lbnRzLmdldChoLmNjSWQpLnB1c2goYSksdGhpcy5fY2x1c3RlcnMuZ2V0KGguY2x1c3RlcklkKS5wdXNoKGEpLHRoaXMuX3NlcXVlbmNlcy5nZXQoaC5zZXF1ZW5jZUlkKS5wdXNoKGEpO2NvbnN0IGw9e21hdGVyaWFsOnRoaXMuX3Bvc2l0aW9uTWF0ZXJpYWwsbW9kZTp0LnBvc2l0aW9uTW9kZSxvcmlnaW5hbE9yaWdpbjp0Lm9yaWdpbmFsUG9zaXRpb24sdHJhbnNmb3JtOnN9LHU9bmV3IGhnKGwpO3UudmlzaWJsZT1yLHRoaXMuX3Bvc2l0aW9ucy5hZGQodSksdGhpcy5fcG9zaXRpb25MaW5lc1tuXT11fV9kaXNwb3NlQ2FtZXJhcygpe2NvbnN0IHQ9dGhpcy5faW50ZXJzZWN0aW9uLGU9dGhpcy5jYW1lcmFzO2Zvcihjb25zdCBpIG9mIGUuY2hpbGRyZW4uc2xpY2UoKSlpLmRpc3Bvc2UoKSx0LnJlbW92ZShpKSxlLnJlbW92ZShpKTt0aGlzLl9zY2VuZS5yZW1vdmUodGhpcy5jYW1lcmFzKX1fZGlzcG9zZVBvc2l0aW9ucygpe2NvbnN0IHQ9dGhpcy5fcG9zaXRpb25zO2Zvcihjb25zdCBlIG9mIHQuY2hpbGRyZW4uc2xpY2UoKSllLmRpc3Bvc2UoKSx0LnJlbW92ZShlKTt0aGlzLl9zY2VuZS5yZW1vdmUodGhpcy5fcG9zaXRpb25zKX1fc2V0Q2FtZXJhVmlzaWJpbGl0eSh0LGUsaSl7dC52aXNpYmxlPWUsZT90LmxheWVycy5lbmFibGUoaSk6dC5sYXllcnMuZGlzYWJsZShpKX19Y2xhc3MgZmd7Y29uc3RydWN0b3IoKXt0aGlzLl9jb2xvcnM9bmV3IE1hcDtjb25zdCBlPXQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGU7dGhpcy5fY29sb3JzLnNldChlW2UuSG9tb2dlbmVvdXNdLFwiI0ZGRkZGRlwiKX1nZXRDb2xvcih0KXtjb25zdCBlPXRoaXMuX2NvbG9ycztyZXR1cm4gZS5oYXModCl8fGUuc2V0KHQsdGhpcy5fcmFuZG9tQ29sb3IoKSksZS5nZXQodCl9X3JhbmRvbUNvbG9yKCl7cmV0dXJuYGhzbCgke01hdGguZmxvb3IoMzYwKk1hdGgucmFuZG9tKCkpfSwgMTAwJSwgNTAlKWB9fWZ1bmN0aW9uIG1nKGUpe3JldHVybiBlIT09dC5DYW1lcmFWaXN1YWxpemF0aW9uTW9kZS5IaWRkZW59Y2xhc3MgZ2d7Y29uc3RydWN0b3IoZSxpKXt0aGlzLl9yYXlOZWFyU2NhbGU9MS4xLHRoaXMuX29yaWdpbmFsUG9pbnRTaXplPTIsdGhpcy5fb3JpZ2luYWxDYW1lcmFTaXplPTIsdGhpcy5faW1hZ2VDZWxsTWFwPW5ldyBNYXAsdGhpcy5fc2NlbmU9aXx8bmV3IFFhLHRoaXMuX3NjZW5lLmF1dG9VcGRhdGU9ITEsdGhpcy5faW50ZXJzZWN0aW9uPW5ldyBjZyx0aGlzLl9hc3NldHM9bmV3IGZnLHRoaXMuX25lZWRzUmVuZGVyPSExLHRoaXMuX2ltYWdlcz17fSx0aGlzLl9jZWxscz17fSx0aGlzLl9jZWxsQ2x1c3RlcnM9e30sdGhpcy5fY2x1c3RlcnM9e30sdGhpcy5fY2FtZXJhVmlzdWFsaXphdGlvbk1vZGU9ZS5jYW1lcmFWaXN1YWxpemF0aW9uTW9kZT9lLmNhbWVyYVZpc3VhbGl6YXRpb25Nb2RlOnQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGUuSG9tb2dlbmVvdXMsdGhpcy5fY2FtZXJhU2l6ZT1lLmNhbWVyYVNpemUsdGhpcy5fcG9pbnRTaXplPWUucG9pbnRTaXplLHRoaXMuX3BvaW50c1Zpc2libGU9ZS5wb2ludHNWaXNpYmxlLHRoaXMuX3Bvc2l0aW9uTW9kZT1lLm9yaWdpbmFsUG9zaXRpb25Nb2RlLHRoaXMuX2NlbGxzVmlzaWJsZT1lLmNlbGxzVmlzaWJsZSx0aGlzLl9ob3ZlcmVkSWQ9bnVsbCx0aGlzLl9zZWxlY3RlZElkPW51bGwsdGhpcy5fY29sb3JzPXtob3ZlcjpcIiNGRjAwMDBcIixzZWxlY3Q6XCIjRkY4MDAwXCJ9LHRoaXMuX2ZpbHRlcj0oKT0+ITB9Z2V0IG5lZWRzUmVuZGVyKCl7cmV0dXJuIHRoaXMuX25lZWRzUmVuZGVyfWdldCBpbnRlcnNlY3Rpb24oKXtyZXR1cm4gdGhpcy5faW50ZXJzZWN0aW9ufWFkZENsdXN0ZXIodCxlLGkpe2lmKHRoaXMuaGFzQ2x1c3Rlcih0LmlkLGkpKXJldHVybjtjb25zdCBuPXQuaWQ7aWYoIShuIGluIHRoaXMuX2NsdXN0ZXJzKSl7dGhpcy5fY2x1c3RlcnNbbl09e3BvaW50czpuZXcgcHIsY2VsbElkczpbXX07Y29uc3QgaT10aGlzLl9nZXRDbHVzdGVyVmlzaWJsZShuKTt0aGlzLl9jbHVzdGVyc1tuXS5wb2ludHMudmlzaWJsZT1pLHRoaXMuX2NsdXN0ZXJzW25dLnBvaW50cy5hZGQobmV3IGlnKHtjbHVzdGVyOnQsb3JpZ2luYWxTaXplOnRoaXMuX29yaWdpbmFsUG9pbnRTaXplLHNjYWxlOnRoaXMuX3BvaW50U2l6ZSx0cmFuc2xhdGlvbjplfSkpLHRoaXMuX3NjZW5lLmFkZCh0aGlzLl9jbHVzdGVyc1tuXS5wb2ludHMpfS0xPT09dGhpcy5fY2x1c3RlcnNbbl0uY2VsbElkcy5pbmRleE9mKGkpJiZ0aGlzLl9jbHVzdGVyc1tuXS5jZWxsSWRzLnB1c2goaSksaSBpbiB0aGlzLl9jZWxsQ2x1c3RlcnN8fCh0aGlzLl9jZWxsQ2x1c3RlcnNbaV09e2tleXM6W119KSwtMT09PXRoaXMuX2NlbGxDbHVzdGVyc1tpXS5rZXlzLmluZGV4T2YobikmJnRoaXMuX2NlbGxDbHVzdGVyc1tpXS5rZXlzLnB1c2gobiksdGhpcy5fbmVlZHNSZW5kZXI9ITB9YWRkSW1hZ2UodCxlLGksbil7dmFyIHIscyxvO2NvbnN0IGE9dC5pZCxjPXtjbHVzdGVySWQ6bnVsbCE9PShyPXQuY2x1c3RlcklkKSYmdm9pZCAwIT09cj9yOlwiTk9fQ0xVU1RFUl9JRFwiLHNlcXVlbmNlSWQ6bnVsbCE9PShzPXQuc2VxdWVuY2VJZCkmJnZvaWQgMCE9PXM/czpcIk5PX1NFUVVFTkNFX0lEXCIsY2NJZDpudWxsIT09KG89dC5tZXJnZUlkKSYmdm9pZCAwIT09bz9vOlwiTk9fTUVSR0VfSURcIn07aWYoIShuIGluIHRoaXMuX2ltYWdlcykpe2NvbnN0IHQ9bmV3IHBnKG4sdGhpcy5fc2NlbmUsdGhpcy5faW50ZXJzZWN0aW9uKTt0LmNhbWVyYXMudmlzaWJsZT1tZyh0aGlzLl9jYW1lcmFWaXN1YWxpemF0aW9uTW9kZSksdC5hcHBseVBvc2l0aW9uTW9kZSh0aGlzLl9wb3NpdGlvbk1vZGUpLHRoaXMuX2ltYWdlc1tuXT10fWNvbnN0IGg9dGhpcy5faW1hZ2VzW25dO2lmKGguaGFzSW1hZ2UoYSkpcmV0dXJuO2guYWRkSW1hZ2Uoe2lkTWFwOmMsaW1hZ2U6dH0pO2NvbnN0IGw9aC5nZXRDb2xvcklkKGEsdGhpcy5fY2FtZXJhVmlzdWFsaXphdGlvbk1vZGUpLHU9dGhpcy5fYXNzZXRzLmdldENvbG9yKGwpLGQ9dGhpcy5fZmlsdGVyKHQpO2lmKGgudmlzdWFsaXplKHtpZDphLGNvbG9yOnUscG9zaXRpb25Nb2RlOnRoaXMuX3Bvc2l0aW9uTW9kZSxzY2FsZTp0aGlzLl9jYW1lcmFTaXplLHRyYW5zZm9ybTplLHZpc2libGU6ZCxtYXhTaXplOnRoaXMuX29yaWdpbmFsQ2FtZXJhU2l6ZSxvcmlnaW5hbFBvc2l0aW9uOml9KSx0aGlzLl9pbWFnZUNlbGxNYXAuc2V0KGEsbiksYT09PXRoaXMuX3NlbGVjdGVkSWQmJnRoaXMuX2hpZ2hsaWdodChhLHRoaXMuX2NvbG9ycy5zZWxlY3QsdGhpcy5fY2FtZXJhVmlzdWFsaXphdGlvbk1vZGUpLGMuY2x1c3RlcklkIGluIHRoaXMuX2NsdXN0ZXJzKXtjb25zdCB0PXRoaXMuX2dldENsdXN0ZXJWaXNpYmxlKGMuY2x1c3RlcklkKTt0aGlzLl9jbHVzdGVyc1tjLmNsdXN0ZXJJZF0ucG9pbnRzLnZpc2libGU9dH10aGlzLl9uZWVkc1JlbmRlcj0hMH1hZGRDZWxsKHQsZSl7aWYodGhpcy5oYXNDZWxsKGUpKXJldHVybjtjb25zdCBpPW5ldyBuZyh0KTt0aGlzLl9jZWxsc1tlXT1uZXcgcHIsdGhpcy5fY2VsbHNbZV0udmlzaWJsZT10aGlzLl9jZWxsc1Zpc2libGUsdGhpcy5fY2VsbHNbZV0uYWRkKGkpLHRoaXMuX3NjZW5lLmFkZCh0aGlzLl9jZWxsc1tlXSksdGhpcy5fbmVlZHNSZW5kZXI9ITB9ZGVhY3RpdmF0ZSgpe3RoaXMuX2ZpbHRlcj0oKT0+ITAsdGhpcy5fc2VsZWN0ZWRJZD1udWxsLHRoaXMuX2hvdmVyZWRJZD1udWxsLHRoaXMudW5jYWNoZSgpfWhhc0NsdXN0ZXIodCxlKXtyZXR1cm4gdCBpbiB0aGlzLl9jbHVzdGVycyYmLTEhPT10aGlzLl9jbHVzdGVyc1t0XS5jZWxsSWRzLmluZGV4T2YoZSl9aGFzQ2VsbCh0KXtyZXR1cm4gdCBpbiB0aGlzLl9jZWxsc31oYXNJbWFnZSh0LGUpe3JldHVybiBlIGluIHRoaXMuX2ltYWdlcyYmdGhpcy5faW1hZ2VzW2VdLmhhc0ltYWdlKHQpfXNldENhbWVyYVNpemUodCl7aWYoTWF0aC5hYnModC10aGlzLl9jYW1lcmFTaXplKTwuMDAxKXJldHVybjtjb25zdCBlPXRoaXMuX2ltYWdlcztmb3IoY29uc3QgaSBvZiBPYmplY3Qua2V5cyhlKSllW2ldLmFwcGx5Q2FtZXJhU2l6ZSh0KTt0aGlzLl9pbnRlcnNlY3Rpb24ucmF5Y2FzdGVyLm5lYXI9dGhpcy5fZ2V0TmVhcih0KSx0aGlzLl9jYW1lcmFTaXplPXQsdGhpcy5fbmVlZHNSZW5kZXI9ITB9c2V0RmlsdGVyKHQpe3RoaXMuX2ZpbHRlcj10O2NvbnN0IGU9e307Zm9yKGNvbnN0IGkgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLl9pbWFnZXMpKXtpLmFwcGx5RmlsdGVyKHQpO2NvbnN0IG49aS5jbHVzdGVyVmlzaWJsZXM7Zm9yKGNvbnN0IHQgaW4gbiluLmhhc093blByb3BlcnR5KHQpJiYodCBpbiBlfHwoZVt0XT0hMSksZVt0XXx8KGVbdF09blt0XSkpfWNvbnN0IGk9dGhpcy5fcG9pbnRzVmlzaWJsZTtmb3IoY29uc3QgdCBpbiBlKXtpZighZS5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtlW3RdJiYoZVt0XT1pKTtjb25zdCBuPWVbdF07dCBpbiB0aGlzLl9jbHVzdGVycyYmKHRoaXMuX2NsdXN0ZXJzW3RdLnBvaW50cy52aXNpYmxlPW4pfXRoaXMuX25lZWRzUmVuZGVyPSEwfXNldEhvdmVyZWRJbWFnZSh0KXtpZihudWxsIT10JiYhdGhpcy5faW1hZ2VDZWxsTWFwLmhhcyh0KSl0aHJvdyBuZXcgY2QoYEltYWdlIGRvZXMgbm90IGV4aXN0OiAke3R9YCk7dGhpcy5faG92ZXJlZElkIT09dCYmKHRoaXMuX25lZWRzUmVuZGVyPSEwLG51bGwhPXRoaXMuX2hvdmVyZWRJZCYmKHRoaXMuX2hvdmVyZWRJZD09PXRoaXMuX3NlbGVjdGVkSWQ/dGhpcy5faGlnaGxpZ2h0KHRoaXMuX2hvdmVyZWRJZCx0aGlzLl9jb2xvcnMuc2VsZWN0LHRoaXMuX2NhbWVyYVZpc3VhbGl6YXRpb25Nb2RlKTp0aGlzLl9yZXNldENhbWVyYUNvbG9yKHRoaXMuX2hvdmVyZWRJZCkpLHRoaXMuX2hpZ2hsaWdodCh0LHRoaXMuX2NvbG9ycy5ob3Zlcix0aGlzLl9jYW1lcmFWaXN1YWxpemF0aW9uTW9kZSksdGhpcy5faG92ZXJlZElkPXQpfXNldE5hdmlnYXRpb25TdGF0ZSh0KXt0aGlzLl9pbnRlcnNlY3Rpb24ucmVzZXRJbnRlcnNlY3Rpb25UaHJlc2hvbGQodCl9c2V0UG9pbnRTaXplKHQpe2lmKE1hdGguYWJzKHQtdGhpcy5fcG9pbnRTaXplKTwuMDAxKXJldHVybjtjb25zdCBlPXRoaXMuX2NsdXN0ZXJzO2Zvcihjb25zdCBpIGluIGUpaWYoZS5oYXNPd25Qcm9wZXJ0eShpKSlmb3IoY29uc3QgbiBvZiBlW2ldLnBvaW50cy5jaGlsZHJlbiluLnJlc2l6ZSh0KTt0aGlzLl9wb2ludFNpemU9dCx0aGlzLl9uZWVkc1JlbmRlcj0hMH1zZXRQb2ludFZpc2liaWxpdHkodCl7aWYodCE9PXRoaXMuX3BvaW50c1Zpc2libGUpe2Zvcihjb25zdCBlIGluIHRoaXMuX2NsdXN0ZXJzKXRoaXMuX2NsdXN0ZXJzLmhhc093blByb3BlcnR5KGUpJiYodGhpcy5fY2x1c3RlcnNbZV0ucG9pbnRzLnZpc2libGU9dCk7dGhpcy5fcG9pbnRzVmlzaWJsZT10LHRoaXMuX25lZWRzUmVuZGVyPSEwfX1zZXRQb3NpdGlvbk1vZGUodCl7aWYodCE9PXRoaXMuX3Bvc2l0aW9uTW9kZSl7Zm9yKGNvbnN0IGUgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLl9pbWFnZXMpKWUuYXBwbHlQb3NpdGlvbk1vZGUodCk7dGhpcy5fcG9zaXRpb25Nb2RlPXQsdGhpcy5fbmVlZHNSZW5kZXI9ITB9fXNldFNlbGVjdGVkSW1hZ2UodCl7dGhpcy5fc2VsZWN0ZWRJZCE9PXQmJih0aGlzLl9uZWVkc1JlbmRlcj0hMCxudWxsIT10aGlzLl9zZWxlY3RlZElkJiZ0aGlzLl9yZXNldENhbWVyYUNvbG9yKHRoaXMuX3NlbGVjdGVkSWQpLHRoaXMuX2hpZ2hsaWdodCh0LHRoaXMuX2NvbG9ycy5zZWxlY3QsdGhpcy5fY2FtZXJhVmlzdWFsaXphdGlvbk1vZGUpLHRoaXMuX3NlbGVjdGVkSWQ9dCl9c2V0Q2VsbFZpc2liaWxpdHkodCl7aWYodCE9PXRoaXMuX2NlbGxzVmlzaWJsZSl7Zm9yKGNvbnN0IGUgaW4gdGhpcy5fY2VsbHMpdGhpcy5fY2VsbHMuaGFzT3duUHJvcGVydHkoZSkmJih0aGlzLl9jZWxsc1tlXS52aXNpYmxlPXQpO3RoaXMuX2NlbGxzVmlzaWJsZT10LHRoaXMuX25lZWRzUmVuZGVyPSEwfX1zZXRDYW1lcmFWaXN1YWxpemF0aW9uTW9kZSh0KXtpZih0PT09dGhpcy5fY2FtZXJhVmlzdWFsaXphdGlvbk1vZGUpcmV0dXJuO2NvbnN0IGU9bWcodCksaT10aGlzLl9hc3NldHM7Zm9yKGNvbnN0IG4gb2YgT2JqZWN0LnZhbHVlcyh0aGlzLl9pbWFnZXMpKXtuLmNhbWVyYXMudmlzaWJsZT1lO24uZ2V0Q2FtZXJhc0J5TW9kZSh0KS5mb3JFYWNoKCgodCxlKT0+e2NvbnN0IG49aS5nZXRDb2xvcihlKTtmb3IoY29uc3QgZSBvZiB0KWUuc2V0Q29sb3Iobil9KSl9dGhpcy5faGlnaGxpZ2h0KHRoaXMuX2hvdmVyZWRJZCx0aGlzLl9jb2xvcnMuaG92ZXIsdCksdGhpcy5faGlnaGxpZ2h0KHRoaXMuX3NlbGVjdGVkSWQsdGhpcy5fY29sb3JzLnNlbGVjdCx0KSx0aGlzLl9jYW1lcmFWaXN1YWxpemF0aW9uTW9kZT10LHRoaXMuX25lZWRzUmVuZGVyPSEwfXJlbmRlcih0LGUpe2UucmVuZGVyKHRoaXMuX3NjZW5lLHQpLHRoaXMuX25lZWRzUmVuZGVyPSExfXVuY2FjaGUodCl7Zm9yKGNvbnN0IGUgb2YgT2JqZWN0LmtleXModGhpcy5fY2VsbENsdXN0ZXJzKSl0JiYtMSE9PXQuaW5kZXhPZihlKXx8dGhpcy5fZGlzcG9zZVJlY29uc3RydWN0aW9uKGUpO2Zvcihjb25zdCBlIG9mIE9iamVjdC5rZXlzKHRoaXMuX2ltYWdlcykpe2lmKHQmJi0xIT09dC5pbmRleE9mKGUpKWNvbnRpbnVlO2NvbnN0IGk9dGhpcy5faW1hZ2VDZWxsTWFwLG49dGhpcy5faW1hZ2VzW2VdLmtleXM7Zm9yKGNvbnN0IHQgb2YgbilpLmRlbGV0ZSh0KTt0aGlzLl9pbWFnZXNbZV0uZGlzcG9zZSgpLGRlbGV0ZSB0aGlzLl9pbWFnZXNbZV19Zm9yKGNvbnN0IGUgb2YgT2JqZWN0LmtleXModGhpcy5fY2VsbHMpKXQmJi0xIT09dC5pbmRleE9mKGUpfHx0aGlzLl9kaXNwb3NlQ2VsbChlKTt0aGlzLl9uZWVkc1JlbmRlcj0hMH1fZ2V0Q2x1c3RlclZpc2libGUodCl7aWYoIXRoaXMuX3BvaW50c1Zpc2libGUpcmV0dXJuITE7bGV0IGU9ITE7Zm9yKGNvbnN0IGkgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLl9pbWFnZXMpKXtjb25zdCBuPWkuY2x1c3RlclZpc2libGVzO3QgaW4gbiYmKGV8fChlPW5bdF0pKX1yZXR1cm4gZX1fZGlzcG9zZVBvaW50cyh0KXtmb3IoY29uc3QgZSBvZiB0aGlzLl9jZWxsQ2x1c3RlcnNbdF0ua2V5cyl7aWYoIShlIGluIHRoaXMuX2NsdXN0ZXJzKSljb250aW51ZTtjb25zdCBpPXRoaXMuX2NsdXN0ZXJzW2VdLmNlbGxJZHMuaW5kZXhPZih0KTtpZigtMSE9PWkmJih0aGlzLl9jbHVzdGVyc1tlXS5jZWxsSWRzLnNwbGljZShpLDEpLCEodGhpcy5fY2x1c3RlcnNbZV0uY2VsbElkcy5sZW5ndGg+MCkpKXtmb3IoY29uc3QgdCBvZiB0aGlzLl9jbHVzdGVyc1tlXS5wb2ludHMuY2hpbGRyZW4uc2xpY2UoKSl0LmRpc3Bvc2UoKTt0aGlzLl9zY2VuZS5yZW1vdmUodGhpcy5fY2x1c3RlcnNbZV0ucG9pbnRzKSxkZWxldGUgdGhpcy5fY2x1c3RlcnNbZV19fX1fZGlzcG9zZVJlY29uc3RydWN0aW9uKHQpe3RoaXMuX2Rpc3Bvc2VQb2ludHModCksZGVsZXRlIHRoaXMuX2NlbGxDbHVzdGVyc1t0XX1fZGlzcG9zZUNlbGwodCl7Y29uc3QgZT10aGlzLl9jZWxsc1t0XTtmb3IoY29uc3QgdCBvZiBlLmNoaWxkcmVuLnNsaWNlKCkpdC5kaXNwb3NlKCksZS5yZW1vdmUodCk7dGhpcy5fc2NlbmUucmVtb3ZlKGUpLGRlbGV0ZSB0aGlzLl9jZWxsc1t0XX1fZ2V0TmVhcih0KXtjb25zdCBlPXRoaXMuX3JheU5lYXJTY2FsZSp0aGlzLl9vcmlnaW5hbENhbWVyYVNpemUqdDtyZXR1cm4gTWF0aC5tYXgoMSxlKX1fcmVzZXRDYW1lcmFDb2xvcih0KXtjb25zdCBlPXRoaXMuX2ltYWdlQ2VsbE1hcDtpZihudWxsPT10fHwhZS5oYXModCkpcmV0dXJuO2NvbnN0IGk9ZS5nZXQodCksbj10aGlzLl9pbWFnZXNbaV0scj1uLmdldENvbG9ySWQodCx0aGlzLl9jYW1lcmFWaXN1YWxpemF0aW9uTW9kZSkscz10aGlzLl9hc3NldHMuZ2V0Q29sb3Iocik7bi5hcHBseUNhbWVyYUNvbG9yKHQscyl9X2hpZ2hsaWdodChlLGksbil7Y29uc3Qgcj10aGlzLl9pbWFnZUNlbGxNYXA7aWYobnVsbD09ZXx8IXIuaGFzKGUpKXJldHVybjtjb25zdCBzPXIuZ2V0KGUpO2k9bj09PXQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGUuSG9tb2dlbmVvdXM/aTpcIiNGRkZGRkZcIix0aGlzLl9pbWFnZXNbc10uYXBwbHlDYW1lcmFDb2xvcihlLGkpfX1jbGFzcyBfZ3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX2dyYXBoU2VydmljZT10LHRoaXMuX2RhdGE9ZSx0aGlzLl9jZWxscz17fSx0aGlzLl9jYWNoZVJlcXVlc3RzPXt9LHRoaXMuX2NsdXN0ZXJzPXt9LHRoaXMuX2NsdXN0ZXJDZWxscz17fSx0aGlzLl9jZWxsQ2x1c3RlcnM9e30sdGhpcy5fY2FjaGluZ0NlbGxzJD17fSx0aGlzLl9jYWNoaW5nQ2x1c3RlcnMkPXt9fWNhY2hlQ2x1c3RlcnMkKHQpe2lmKCF0aGlzLmhhc0NlbGwodCkpdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNhY2hlIHJlY29uc3RydWN0aW9ucyBvZiBhIG5vbi1leGlzdGluZyBjZWxsLlwiKTtpZih0aGlzLmhhc0NsdXN0ZXJzKHQpKXRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBjYWNoZSByZWNvbnN0cnVjdGlvbnMgdGhhdCBhbHJlYWR5IGV4aXN0cy5cIik7aWYodGhpcy5pc0NhY2hpbmdDbHVzdGVycyh0KSlyZXR1cm4gdGhpcy5fY2FjaGluZ0NsdXN0ZXJzJFt0XTtjb25zdCBlPXRoaXMuZ2V0Q2VsbCh0KS5maWx0ZXIoKHQ9PiEhdC5jbHVzdGVySWQmJiEhdC5jbHVzdGVyVXJsKSkubWFwKCh0PT4oe2tleTp0LmNsdXN0ZXJJZCx1cmw6dC5jbHVzdGVyVXJsfSkpKSxpPUFycmF5LmZyb20obmV3IE1hcChlLm1hcCgodD0+W3Qua2V5LHRdKSkpLnZhbHVlcygpKTtsZXQgbjt0aGlzLl9jZWxsQ2x1c3RlcnNbdF09aSx0aGlzLl9jYWNoZVJlcXVlc3RzW3RdPVtdO2NvbnN0IHI9bmV3IFByb21pc2UoKCh0LGUpPT57bj1lfSkpO3JldHVybiB0aGlzLl9jYWNoZVJlcXVlc3RzW3RdLnB1c2gobiksdGhpcy5fY2FjaGluZ0NsdXN0ZXJzJFt0XT10aGlzLl9jYWNoZUNsdXN0ZXJzJChpLHQscikucGlwZShNZSgoKCk9Pnt0IGluIHRoaXMuX2NhY2hpbmdDbHVzdGVycyQmJmRlbGV0ZSB0aGlzLl9jYWNoaW5nQ2x1c3RlcnMkW3RdLHQgaW4gdGhpcy5fY2FjaGVSZXF1ZXN0cyYmZGVsZXRlIHRoaXMuX2NhY2hlUmVxdWVzdHNbdF19KSksSGUoKSxFKCkpLHRoaXMuX2NhY2hpbmdDbHVzdGVycyRbdF19Y2FjaGVDZWxsJCh0KXtpZih0aGlzLmhhc0NlbGwodCkpdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNhY2hlIGNlbGwgdGhhdCBhbHJlYWR5IGV4aXN0cy5cIik7cmV0dXJuIHRoaXMuaXNDYWNoaW5nQ2VsbCh0KXx8KHRoaXMuX2NhY2hpbmdDZWxscyRbdF09dGhpcy5fZ3JhcGhTZXJ2aWNlLmNhY2hlQ2VsbCQodCkucGlwZSh0ZSgodD0+KGNvbnNvbGUuZXJyb3IodCksQigpKSkpLE50KCgoKT0+ISh0IGluIHRoaXMuX2NlbGxzKSkpLHBpKChlPT57dGhpcy5fY2VsbHNbdF09W10sdGhpcy5fY2VsbHNbdF0ucHVzaCguLi5lKSxkZWxldGUgdGhpcy5fY2FjaGluZ0NlbGxzJFt0XX0pKSxNZSgoKCk9Pnt0IGluIHRoaXMuX2NhY2hpbmdDZWxscyQmJmRlbGV0ZSB0aGlzLl9jYWNoaW5nQ2VsbHMkW3RdfSkpLEhlKCksRSgpKSksdGhpcy5fY2FjaGluZ0NlbGxzJFt0XX1pc0NhY2hpbmdDbHVzdGVycyh0KXtyZXR1cm4gdCBpbiB0aGlzLl9jYWNoaW5nQ2x1c3RlcnMkfWlzQ2FjaGluZ0NlbGwodCl7cmV0dXJuIHQgaW4gdGhpcy5fY2FjaGluZ0NlbGxzJH1oYXNDbHVzdGVycyh0KXtpZih0IGluIHRoaXMuX2NhY2hpbmdDbHVzdGVycyR8fCEodCBpbiB0aGlzLl9jZWxsQ2x1c3RlcnMpKXJldHVybiExO2Zvcihjb25zdCBlIG9mIHRoaXMuX2NlbGxDbHVzdGVyc1t0XSlpZighKGUua2V5IGluIHRoaXMuX2NsdXN0ZXJzKSlyZXR1cm4hMTtyZXR1cm4hMH1oYXNDZWxsKHQpe3JldHVybiEodCBpbiB0aGlzLl9jYWNoaW5nQ2VsbHMkKSYmdCBpbiB0aGlzLl9jZWxsc31nZXRDbHVzdGVycyh0KXtyZXR1cm4gdCBpbiB0aGlzLl9jZWxsQ2x1c3RlcnM/dGhpcy5fY2VsbENsdXN0ZXJzW3RdLm1hcCgodD0+dGhpcy5fY2x1c3RlcnNbdC5rZXldKSkuZmlsdGVyKCh0PT4hIXQpKTpbXX1nZXRDZWxsKHQpe3JldHVybiB0IGluIHRoaXMuX2NlbGxzP3RoaXMuX2NlbGxzW3RdOltdfXVuY2FjaGUodCl7Zm9yKGxldCBlIG9mIE9iamVjdC5rZXlzKHRoaXMuX2NhY2hlUmVxdWVzdHMpKWlmKCF0fHwtMT09PXQuaW5kZXhPZihlKSl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fY2FjaGVSZXF1ZXN0c1tlXSl0KCk7ZGVsZXRlIHRoaXMuX2NhY2hlUmVxdWVzdHNbZV19Zm9yKGxldCBlIG9mIE9iamVjdC5rZXlzKHRoaXMuX2NlbGxDbHVzdGVycykpaWYoIXR8fC0xPT09dC5pbmRleE9mKGUpKXtmb3IoY29uc3QgdCBvZiB0aGlzLl9jZWxsQ2x1c3RlcnNbZV0pe2lmKCEodC5rZXkgaW4gdGhpcy5fY2x1c3RlckNlbGxzKSljb250aW51ZTtjb25zdCBpPXRoaXMuX2NsdXN0ZXJDZWxsc1t0LmtleV0uaW5kZXhPZihlKTstMSE9PWkmJih0aGlzLl9jbHVzdGVyQ2VsbHNbdC5rZXldLnNwbGljZShpLDEpLHRoaXMuX2NsdXN0ZXJDZWxsc1t0LmtleV0ubGVuZ3RoPjB8fChkZWxldGUgdGhpcy5fY2x1c3RlckNlbGxzW3Qua2V5XSxkZWxldGUgdGhpcy5fY2x1c3RlcnNbdC5rZXldKSl9ZGVsZXRlIHRoaXMuX2NlbGxDbHVzdGVyc1tlXX1mb3IobGV0IGUgb2YgT2JqZWN0LmtleXModGhpcy5fY2VsbHMpKXQmJi0xIT09dC5pbmRleE9mKGUpfHxkZWxldGUgdGhpcy5fY2VsbHNbZV19dXBkYXRlQ2VsbCQodCl7aWYoIXRoaXMuaGFzQ2VsbCh0KSl0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgdXBkYXRlIGNlbGwgdGhhdCBkb2VzIG5vdCBleGlzdHMuXCIpO3JldHVybiB0aGlzLl9ncmFwaFNlcnZpY2UuY2FjaGVDZWxsJCh0KS5waXBlKHRlKCh0PT4oY29uc29sZS5lcnJvcih0KSxCKCkpKSksTnQoKCgpPT50IGluIHRoaXMuX2NlbGxzKSkscGkoKGU9Pnt0aGlzLl9jZWxsc1t0XT1bXSx0aGlzLl9jZWxsc1t0XS5wdXNoKC4uLmUpfSkpLEhlKCksRSgpKX11cGRhdGVDbHVzdGVycyQodCl7aWYoIXRoaXMuaGFzQ2VsbCh0KSl0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgdXBkYXRlIHJlY29uc3RydWN0aW9ucyBvZiBhIG5vbi1leGlzdGluZyBjZWxsLlwiKTtpZighdGhpcy5oYXNDbHVzdGVycyh0KSl0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgdXBkYXRlIHJlY29uc3RydWN0aW9ucyBmb3IgY2VsbCB0aGF0IGlzIG5vdCBjYWNoZWQuXCIpO2NvbnN0IGU9dGhpcy5nZXRDZWxsKHQpLmZpbHRlcigodD0+ISF0LmNsdXN0ZXJJZCYmISF0LmNsdXN0ZXJVcmwpKS5tYXAoKHQ9Pih7a2V5OnQuY2x1c3RlcklkLHVybDp0LmNsdXN0ZXJVcmx9KSkpLGk9QXJyYXkuZnJvbShuZXcgTWFwKGUubWFwKCh0PT5bdC5rZXksdF0pKSkudmFsdWVzKCkpLmZpbHRlcigodD0+ISh0LmtleSBpbiB0aGlzLl9jbHVzdGVycykpKTtyZXR1cm4gdGhpcy5fY2VsbENsdXN0ZXJzW3RdLnB1c2goLi4uaSksdGhpcy5fY2FjaGVDbHVzdGVycyQoaSx0LG51bGwpfV9jYWNoZUNsdXN0ZXJzJCh0LGUsaSl7cmV0dXJuIGJ0KHQpLnBpcGUoTXQoKHQ9PnRoaXMuX2hhc0NsdXN0ZXIodC5rZXkpP0codGhpcy5fZ2V0Q2x1c3Rlcih0LmtleSkpOnRoaXMuX2dldENsdXN0ZXIkKHQudXJsLHQua2V5LGkpLnBpcGUodGUoKHQ9Pih0IGluc3RhbmNlb2YgWmZ8fGNvbnNvbGUuZXJyb3IodCksQigpKSkpKSksNiksTnQoKCgpPT5lIGluIHRoaXMuX2NlbGxDbHVzdGVycykpLHBpKCh0PT57dGhpcy5faGFzQ2x1c3Rlcih0LmlkKXx8KHRoaXMuX2NsdXN0ZXJzW3QuaWRdPXQpLHQuaWQgaW4gdGhpcy5fY2x1c3RlckNlbGxzfHwodGhpcy5fY2x1c3RlckNlbGxzW3QuaWRdPVtdKSwtMT09PXRoaXMuX2NsdXN0ZXJDZWxsc1t0LmlkXS5pbmRleE9mKGUpJiZ0aGlzLl9jbHVzdGVyQ2VsbHNbdC5pZF0ucHVzaChlKX0pKSl9X2dldENsdXN0ZXIodCl7cmV0dXJuIHRoaXMuX2NsdXN0ZXJzW3RdfV9nZXRDbHVzdGVyJCh0LGUsaSl7cmV0dXJuIGIuY3JlYXRlKChuPT57dGhpcy5fZGF0YS5nZXRDbHVzdGVyKHQsaSkudGhlbigodD0+e3QuaWQ9ZSxuLm5leHQodCksbi5jb21wbGV0ZSgpfSksKHQ9PntuLmVycm9yKHQpfSkpfSkpfV9oYXNDbHVzdGVyKHQpe3JldHVybiB0IGluIHRoaXMuX2NsdXN0ZXJzfX1mdW5jdGlvbiB2Zyh0LGUsaSl7Y29uc3Qgbj1uZXcgU2V0O3JldHVybiBuLmFkZCh0KSx5ZyhuLFt0XSwwLGUsaSksQXJyYXkuZnJvbShuKX1mdW5jdGlvbiB5Zyh0LGUsaSxuLHIpe2lmKGk+PW4pcmV0dXJuO2NvbnN0IHM9W107Zm9yKGNvbnN0IHQgb2YgZSl7Y29uc3QgZT1yLmdldEFkamFjZW50KHQpO3MucHVzaCguLi5lKX1jb25zdCBvPVtdO2Zvcihjb25zdCBlIG9mIHMpdC5oYXMoZSl8fCh0LmFkZChlKSxvLnB1c2goZSkpO3lnKHQsbyxpKzEsbixyKX1jbGFzcyBiZyBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUsaSksdGhpcy5fY2FjaGU9bmV3IF9nKGkuZ3JhcGhTZXJ2aWNlLGkuYXBpLmRhdGEpLHRoaXMuX3NjZW5lPW5ldyBnZyh0aGlzLl9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpKSx0aGlzLl92aWV3cG9ydENvb3Jkcz1uZXcgV2YsdGhpcy5fc3BhdGlhbD1uZXcgbGR9Z2V0RnJhbWVJZEF0KHQpe3JldHVybiBuZXcgUHJvbWlzZSgoKGUsaSk9Pnt0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLnBpcGUoRWUoKSxydCgoZT0+e2NvbnN0IGk9dGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzVG9WaWV3cG9ydCh0WzBdLHRbMV0sdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcik7cmV0dXJuIHRoaXMuX3NjZW5lLmludGVyc2VjdGlvbi5pbnRlcnNlY3RPYmplY3RzKGksZS5wZXJzcGVjdGl2ZSl9KSkpLnN1YnNjcmliZSgodD0+e2UodCl9KSwodD0+e2kodCl9KSl9KSl9X2FjdGl2YXRlKCl7dGhpcy5fbmF2aWdhdG9yLmNhY2hlU2VydmljZS5jb25maWd1cmUoe2NlbGxEZXB0aDozfSk7Y29uc3QgdD10aGlzLl9zdWJzY3JpcHRpb25zO3QucHVzaCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQuc3Vic2NyaWJlKCgoKT0+e3RoaXMuX3NjZW5lLnVuY2FjaGUoKX0pKSksdC5wdXNoKHRoaXMuX25hdmlnYXRvci5ncmFwaFNlcnZpY2UuZmlsdGVyJC5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9zY2VuZS5zZXRGaWx0ZXIodCl9KSkpO2NvbnN0IGU9dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UuYmVhcmluZyQucGlwZShydCgodD0+NipNYXRoLmZsb29yKHQvNikpKSx1ZSgpLFVlKDEpLEUoKSksaT10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQucGlwZShydCgodD0+dGhpcy5fbmF2aWdhdG9yLmFwaS5kYXRhLmdlb21ldHJ5LmxuZ0xhdFRvQ2VsbElkKHQub3JpZ2luYWxMbmdMYXQpKSksdWUoKSxVZSgxKSxFKCkpLG49dGhpcy5fY29uZmlndXJhdGlvbiQucGlwZShydCgodD0+dGhpcy5fc3BhdGlhbC5jbGFtcCh0LmNlbGxHcmlkRGVwdGgsMSwzKSkpLHVlKCksVWUoMSksRSgpKSxyPWd0KHRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5wbGF5aW5nJCx0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc3BlZWQkKS5waXBlKHJ0KCgoW3QsZV0pPT50JiZlPmVnLnNlcXVlbmNlU3BlZWQpKSx1ZSgpLFVlKDEpLEUoKSkscz10aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0YXRlJC5waXBlKHJ0KCh0PT5mdW5jdGlvbih0KXtyZXR1cm4gdD09PXZtLkN1c3RvbXx8dD09PXZtLkVhcnRofSh0KSkpLHVlKCksVWUoMSksRSgpKTt0LnB1c2gocy5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9zY2VuZS5zZXROYXZpZ2F0aW9uU3RhdGUodCl9KSkpO2NvbnN0IG89Z3QocyxyLGUsbix0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQpLnBpcGUodWUoKChbdCxlLGksbixyXSxbcyxvLGEsYyxoXSk9PntpZih0IT09cylyZXR1cm4hMTtjb25zdCBsPXIuaWQ9PT1oLmlkJiZlPT09byYmbj09PWM7cmV0dXJuIHQ/bDpsJiZpPT09YX0pKSxuZSgoKFt0LGUsaSxuLHJdKT0+e2lmKHQpe2NvbnN0IHQ9dGhpcy5fbmF2aWdhdG9yLmFwaS5kYXRhLmdlb21ldHJ5LGk9dC5sbmdMYXRUb0NlbGxJZChyLm9yaWdpbmFsTG5nTGF0KTtyZXR1cm4gRyhlP1tpXTp2ZyhpLG4sdCkpfWNvbnN0IHM9ZT8zMDo5MDtyZXR1cm4gRyh0aGlzLl9jZWxsc0luRm92KHIsaSxzKSl9KSkscmkoKHQ9PmJ0KHQpLnBpcGUoTXQoKHQ9Pih0aGlzLl9jYWNoZS5oYXNDZWxsKHQpP0codGhpcy5fY2FjaGUuZ2V0Q2VsbCh0KSk6dGhpcy5fY2FjaGUuY2FjaGVDZWxsJCh0KSkucGlwZShydCgoZT0+KHtpZDp0LGltYWdlczplfSkpKSkpLDYpKSkpKTt0LnB1c2goby5waXBlKGJpKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCkpLnN1YnNjcmliZSgoKFt0LGVdKT0+e3RoaXMuX3NjZW5lLmhhc0NlbGwodC5pZCl8fHRoaXMuX3NjZW5lLmFkZENlbGwodGhpcy5fY2VsbFRvVG9wb2NlbnRyaWModC5pZCxlKSx0LmlkKX0pKSksdC5wdXNoKG8ucGlwZShiaSh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQpKS5zdWJzY3JpYmUoKChbdCxlXSk9Pnt0aGlzLl9hZGRTY2VuZUltYWdlcyh0LGUpfSkpKSx0LnB1c2goby5waXBlKG5lKCh0PT57Y29uc3QgZT10LmlkO2xldCBpO3JldHVybiBpPXRoaXMuX2NhY2hlLmhhc0NsdXN0ZXJzKGUpP2J0KHRoaXMuX2NhY2hlLmdldENsdXN0ZXJzKGUpKTp0aGlzLl9jYWNoZS5pc0NhY2hpbmdDbHVzdGVycyhlKT90aGlzLl9jYWNoZS5jYWNoZUNsdXN0ZXJzJChlKS5waXBlKFJlKG51bGwse30pLHJpKCgoKT0+YnQodGhpcy5fY2FjaGUuZ2V0Q2x1c3RlcnMoZSkpKSkpOnRoaXMuX2NhY2hlLmhhc0NlbGwoZSk/dGhpcy5fY2FjaGUuY2FjaGVDbHVzdGVycyQoZSk6QigpLGd0KEcoZSksaSl9KSksYmkodGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5yZWZlcmVuY2UkKSkuc3Vic2NyaWJlKCgoW1t0LGVdLGldKT0+e3RoaXMuX3NjZW5lLmhhc0NsdXN0ZXIoZS5pZCx0KXx8dGhpcy5fc2NlbmUuYWRkQ2x1c3RlcihlLHRoaXMuX2NvbXB1dGVUcmFuc2xhdGlvbihlLGkpLHQpfSkpKSx0LnB1c2godGhpcy5fY29uZmlndXJhdGlvbiQucGlwZShydCgodD0+KHQuY2FtZXJhU2l6ZT10aGlzLl9zcGF0aWFsLmNsYW1wKHQuY2FtZXJhU2l6ZSwuMDEsMSksdC5wb2ludFNpemU9dGhpcy5fc3BhdGlhbC5jbGFtcCh0LnBvaW50U2l6ZSwuMDEsMSkse2NhbWVyYVNpemU6dC5jYW1lcmFTaXplLGNhbWVyYVZpc3VhbGl6YXRpb25Nb2RlOnQuY2FtZXJhVmlzdWFsaXphdGlvbk1vZGUsY2VsbHNWaXNpYmxlOnQuY2VsbHNWaXNpYmxlLG9yaWdpbmFsUG9zaXRpb25Nb2RlOnQub3JpZ2luYWxQb3NpdGlvbk1vZGUscG9pbnRTaXplOnQucG9pbnRTaXplLHBvaW50c1Zpc2libGU6dC5wb2ludHNWaXNpYmxlfSkpKSx1ZSgoKHQsZSk9PnQuY2FtZXJhU2l6ZT09PWUuY2FtZXJhU2l6ZSYmdC5jYW1lcmFWaXN1YWxpemF0aW9uTW9kZT09PWUuY2FtZXJhVmlzdWFsaXphdGlvbk1vZGUmJnQuY2VsbHNWaXNpYmxlPT09ZS5jZWxsc1Zpc2libGUmJnQub3JpZ2luYWxQb3NpdGlvbk1vZGU9PT1lLm9yaWdpbmFsUG9zaXRpb25Nb2RlJiZ0LnBvaW50U2l6ZT09PWUucG9pbnRTaXplJiZ0LnBvaW50c1Zpc2libGU9PT1lLnBvaW50c1Zpc2libGUpKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fc2NlbmUuc2V0Q2FtZXJhU2l6ZSh0LmNhbWVyYVNpemUpLHRoaXMuX3NjZW5lLnNldFBvaW50U2l6ZSh0LnBvaW50U2l6ZSksdGhpcy5fc2NlbmUuc2V0UG9pbnRWaXNpYmlsaXR5KHQucG9pbnRzVmlzaWJsZSksdGhpcy5fc2NlbmUuc2V0Q2VsbFZpc2liaWxpdHkodC5jZWxsc1Zpc2libGUpO2NvbnN0IGU9dC5jYW1lcmFWaXN1YWxpemF0aW9uTW9kZTt0aGlzLl9zY2VuZS5zZXRDYW1lcmFWaXN1YWxpemF0aW9uTW9kZShlKTtjb25zdCBpPXQub3JpZ2luYWxQb3NpdGlvbk1vZGU7dGhpcy5fc2NlbmUuc2V0UG9zaXRpb25Nb2RlKGkpfSkpKSx0LnB1c2goZ3QoaSxuKS5zdWJzY3JpYmUoKChbdCxlXSk9Pntjb25zdCBpPXZnKHQsZSx0aGlzLl9uYXZpZ2F0b3IuYXBpLmRhdGEuZ2VvbWV0cnkpO3RoaXMuX3NjZW5lLnVuY2FjaGUoaSksdGhpcy5fY2FjaGUudW5jYWNoZShpKX0pKSksdC5wdXNoKHRoaXMuX25hdmlnYXRvci5wbGF5U2VydmljZS5wbGF5aW5nJC5waXBlKHJpKCh0PT50P0IoKTp0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRibENsaWNrJCkpLGJpKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQpLHJpKCgoW3QsZV0pPT57Y29uc3QgaT10aGlzLl9jb250YWluZXIuY29udGFpbmVyLFtuLHJdPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1Bvc2l0aW9uKHQsaSkscz10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNUb1ZpZXdwb3J0KG4scixpKSxvPXRoaXMuX3NjZW5lLmludGVyc2VjdGlvbi5pbnRlcnNlY3RPYmplY3RzKHMsZS5wZXJzcGVjdGl2ZSk7cmV0dXJuIG8/dGhpcy5fbmF2aWdhdG9yLm1vdmVUbyQobykucGlwZSh0ZSgoKCk9PkIoKSkpKTpCKCl9KSkpLnN1YnNjcmliZSgpKTtjb25zdCBhPWd0KHRoaXMuX2NvbmZpZ3VyYXRpb24kLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhdGUkKS5waXBlKHJ0KCgoW3QsZV0pPT4odC5jYW1lcmFTaXplPXRoaXMuX3NwYXRpYWwuY2xhbXAodC5jYW1lcmFTaXplLC4wMSwxKSx7c2l6ZTp0LmNhbWVyYVNpemUsdmlzaWJsZTptZyh0LmNhbWVyYVZpc3VhbGl6YXRpb25Nb2RlKSxzdGF0ZTplfSkpKSx1ZSgoKHQsZSk9PnQuc2l6ZT09PWUuc2l6ZSYmdC52aXNpYmxlPT09ZS52aXNpYmxlJiZ0LnN0YXRlPT09ZS5zdGF0ZSkpKSxjPXRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VNb3ZlJC5waXBlKFVlKDEpLEUoKSk7dC5wdXNoKGMuc3Vic2NyaWJlKCkpO2NvbnN0IGg9T3QodGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5tb3VzZUVudGVyJCx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlTGVhdmUkLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2Uud2luZG93Qmx1ciQpO3QucHVzaChndCh0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2UucGxheWluZyQsaCxzLHRoaXMuX25hdmlnYXRvci5ncmFwaFNlcnZpY2UuZmlsdGVyJCkucGlwZShyaSgoKFt0LGVdKT0+dHx8XCJwb2ludGVyZW50ZXJcIiE9PWUudHlwZT9ndChHKGUpLEcobnVsbCksRyhudWxsKSk6Z3QoQXQoYy5waXBlKHZlKDEpKSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlTW92ZSQpLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQsYSkpKSkuc3Vic2NyaWJlKCgoW3QsZV0pPT57aWYoXCJwb2ludGVybW92ZVwiIT09dC50eXBlKXJldHVybiB2b2lkIHRoaXMuX3NjZW5lLnNldEhvdmVyZWRJbWFnZShudWxsKTtjb25zdCBpPXRoaXMuX2NvbnRhaW5lci5jb250YWluZXIsW24scl09dGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzUG9zaXRpb24odCxpKSxzPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1RvVmlld3BvcnQobixyLGkpLG89dGhpcy5fc2NlbmUuaW50ZXJzZWN0aW9uLmludGVyc2VjdE9iamVjdHMocyxlLnBlcnNwZWN0aXZlKTt0aGlzLl9zY2VuZS5zZXRIb3ZlcmVkSW1hZ2Uobyl9KSkpLHQucHVzaCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJZCQuc3Vic2NyaWJlKCh0PT57dGhpcy5fc2NlbmUuc2V0U2VsZWN0ZWRJbWFnZSh0KX0pKSksdC5wdXNoKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHJ0KCh0PT57Y29uc3QgZT10aGlzLl9zY2VuZTtyZXR1cm57bmFtZTp0aGlzLl9uYW1lLHJlbmRlcmVyOntmcmFtZUlkOnQuaWQsbmVlZHNSZW5kZXI6ZS5uZWVkc1JlbmRlcixyZW5kZXI6ZS5yZW5kZXIuYmluZChlKSxwYXNzOnJtLk9wYXF1ZX19fSkpKS5zdWJzY3JpYmUodGhpcy5fY29udGFpbmVyLmdsUmVuZGVyZXIucmVuZGVyJCkpO2NvbnN0IGw9dGhpcy5fbmF2aWdhdG9yLmdyYXBoU2VydmljZS5kYXRhQWRkZWQkLnBpcGUoTnQoKHQ9PnRoaXMuX2NhY2hlLmhhc0NlbGwodCkpKSxNdCgodD0+dGhpcy5fY2FjaGUudXBkYXRlQ2VsbCQodCkucGlwZShydCgoZT0+KHtpZDp0LGltYWdlczplfSkpKSxiaSh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQpKSkpLEhlKCksRSgpKTt0LnB1c2gobC5zdWJzY3JpYmUoKChbdCxlXSk9Pnt0aGlzLl9hZGRTY2VuZUltYWdlcyh0LGUpfSkpKSx0LnB1c2gobC5waXBlKG5lKCgoW3RdKT0+e2NvbnN0IGU9dC5pZCxpPXRoaXMuX2NhY2hlO2xldCBuO3JldHVybiBuPWkuaGFzQ2x1c3RlcnMoZSk/aS51cGRhdGVDbHVzdGVycyQoZSk6aS5pc0NhY2hpbmdDbHVzdGVycyhlKT90aGlzLl9jYWNoZS5jYWNoZUNsdXN0ZXJzJChlKS5waXBlKFJlKG51bGwse30pLHJpKCgoKT0+YnQoaS51cGRhdGVDbHVzdGVycyQoZSkpKSkpOkIoKSxndChHKGUpLG4pfSkpLGJpKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCkpLnN1YnNjcmliZSgoKFtbdCxlXSxpXSk9Pnt0aGlzLl9zY2VuZS5oYXNDbHVzdGVyKGUuaWQsdCl8fHRoaXMuX3NjZW5lLmFkZENsdXN0ZXIoZSx0aGlzLl9jb21wdXRlVHJhbnNsYXRpb24oZSxpKSx0KX0pKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5fY2FjaGUudW5jYWNoZSgpLHRoaXMuX3NjZW5lLmRlYWN0aXZhdGUoKSx0aGlzLl9uYXZpZ2F0b3IuY2FjaGVTZXJ2aWNlLmNvbmZpZ3VyZSgpfV9nZXREZWZhdWx0Q29uZmlndXJhdGlvbigpe3JldHVybntjYW1lcmFTaXplOi4xLGNhbWVyYVZpc3VhbGl6YXRpb25Nb2RlOnQuQ2FtZXJhVmlzdWFsaXphdGlvbk1vZGUuSG9tb2dlbmVvdXMsY2VsbEdyaWREZXB0aDoxLG9yaWdpbmFsUG9zaXRpb25Nb2RlOnQuT3JpZ2luYWxQb3NpdGlvbk1vZGUuSGlkZGVuLHBvaW50U2l6ZTouMSxwb2ludHNWaXNpYmxlOiEwLGNlbGxzVmlzaWJsZTohMX19X2FkZFNjZW5lSW1hZ2VzKHQsZSl7Y29uc3QgaT10LmlkLG49dC5pbWFnZXM7Zm9yKGNvbnN0IHQgb2Ygbil0aGlzLl9zY2VuZS5oYXNJbWFnZSh0LmlkLGkpfHx0aGlzLl9zY2VuZS5hZGRJbWFnZSh0LHRoaXMuX2NyZWF0ZVRyYW5zZm9ybSh0LGUpLHRoaXMuX2NvbXB1dGVPcmlnaW5hbFBvc2l0aW9uKHQsZSksaSl9X2NlbGxzSW5Gb3YodCxlLGkpe2NvbnN0IG49dGhpcy5fc3BhdGlhbCxyPXRoaXMuX25hdmlnYXRvci5hcGkuZGF0YS5nZW9tZXRyeSxzPXIubG5nTGF0VG9DZWxsSWQodC5vcmlnaW5hbExuZ0xhdCksbz1bc10sYT1pLzIsYz1yLmdldEFkamFjZW50KHMpO2Zvcihjb25zdCBpIG9mIGMpe2NvbnN0IHM9ci5nZXRWZXJ0aWNlcyhpKTtmb3IoY29uc3QgciBvZiBzKXtjb25zdFtzLGNdPUp1KHIubG5nLHIubGF0LDAsdC5sbmdMYXQubG5nLHQubG5nTGF0LmxhdCwwKSxoPU1hdGguYXRhbjIoYyxzKSxsPW4ucmFkVG9EZWcobi5hemltdXRoYWxUb0JlYXJpbmcoaCkpO01hdGguYWJzKGwtZSk8YSYmby5wdXNoKGkpfX1yZXR1cm4gb31fY29tcHV0ZU9yaWdpbmFsUG9zaXRpb24odCxlKXtyZXR1cm4gSnUodC5vcmlnaW5hbExuZ0xhdC5sbmcsdC5vcmlnaW5hbExuZ0xhdC5sYXQsbnVsbCE9dC5vcmlnaW5hbEFsdGl0dWRlP3Qub3JpZ2luYWxBbHRpdHVkZTp0LmNvbXB1dGVkQWx0aXR1ZGUsZS5sbmcsZS5sYXQsZS5hbHQpfV9jZWxsVG9Ub3BvY2VudHJpYyh0LGUpe3JldHVybiB0aGlzLl9uYXZpZ2F0b3IuYXBpLmRhdGEuZ2VvbWV0cnkuZ2V0VmVydGljZXModCkubWFwKCh0PT5KdSh0LmxuZyx0LmxhdCwtMixlLmxuZyxlLmxhdCxlLmFsdCkpKX1fY29tcHV0ZVRyYW5zbGF0aW9uKHQsZSl7cmV0dXJuIEp1KHQucmVmZXJlbmNlLmxuZyx0LnJlZmVyZW5jZS5sYXQsdC5yZWZlcmVuY2UuYWx0LGUubG5nLGUubGF0LGUuYWx0KX1fY3JlYXRlVHJhbnNmb3JtKHQsZSl7Y29uc3QgaT1mZCh7YWx0OnQuY29tcHV0ZWRBbHRpdHVkZSxsYXQ6dC5sbmdMYXQubGF0LGxuZzp0LmxuZ0xhdC5sbmd9LHQucm90YXRpb24sZSk7cmV0dXJuIG5ldyBIZCh0LmV4aWZPcmllbnRhdGlvbix0LndpZHRoLHQuaGVpZ2h0LHQuc2NhbGUsdC5yb3RhdGlvbixpLHZvaWQgMCx2b2lkIDAsdC5jYW1lcmFQYXJhbWV0ZXJzLHQuY2FtZXJhVHlwZSl9fWJnLmNvbXBvbmVudE5hbWU9XCJzcGF0aWFsXCI7Y2xhc3MgeGd7Y29uc3RydWN0b3IoKXt0aGlzLl9ub3RpZnlDaGFuZ2VkJD1uZXcgVH1nZXQgY2hhbmdlZCQoKXtyZXR1cm4gdGhpcy5fbm90aWZ5Q2hhbmdlZCR9fWNsYXNzIHdnIGV4dGVuZHMgY2R7Y29uc3RydWN0b3IodCl7c3VwZXIobnVsbCE9dD90OlwiVGhlIHByb3ZpZGVkIGdlb21ldHJ5IHZhbHVlIGlzIGluY29ycmVjdFwiKSxPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyx3Zy5wcm90b3R5cGUpLHRoaXMubmFtZT1cIkdlb21ldHJ5VGFnRXJyb3JcIn19Y2xhc3MgU2cgZXh0ZW5kcyB4Z3tjb25zdHJ1Y3Rvcih0KXtzdXBlcigpO2lmKHQubGVuZ3RoPDIpdGhyb3cgbmV3IHdnKFwiQSBwb2ludHMgZ2VvbWV0cnkgbXVzdCBoYXZlIHR3byBvciBtb3JlIHBvc2l0aW9ucy5cIik7dGhpcy5fcG9pbnRzPVtdO2Zvcihjb25zdCBlIG9mIHQpe2lmKGVbMF08MHx8ZVswXT4xfHxlWzFdPDB8fGVbMV0+MSl0aHJvdyBuZXcgd2coXCJCYXNpYyBjb29yZGluYXRlcyBvZiBwb2ludHMgbXVzdCBiZSBvbiB0aGUgaW50ZXJ2YWwgWzAsIDFdLlwiKTt0aGlzLl9wb2ludHMucHVzaChlLnNsaWNlKCkpfX1nZXQgcG9pbnRzKCl7cmV0dXJuIHRoaXMuX3BvaW50c31hZGRQb2ludDJkKHQpe2NvbnN0IGU9W01hdGgubWF4KDAsTWF0aC5taW4oMSx0WzBdKSksTWF0aC5tYXgoMCxNYXRoLm1pbigxLHRbMV0pKV07dGhpcy5fcG9pbnRzLnB1c2goZSksdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXRQb2ludDJkKHQpe3JldHVybiB0aGlzLl9wb2ludHNbdF0uc2xpY2UoKX1yZW1vdmVQb2ludDJkKHQpe2lmKHQ8MHx8dD49dGhpcy5fcG9pbnRzLmxlbmd0aHx8dGhpcy5fcG9pbnRzLmxlbmd0aDwzKXRocm93IG5ldyB3ZyhcIkluZGV4IGZvciByZW1vdmVkIHBvaW50IG11c3QgYmUgdmFsaWQuXCIpO3RoaXMuX3BvaW50cy5zcGxpY2UodCwxKSx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfXNldFZlcnRleDJkKHQsZSxpKXt0aGlzLnNldFBvaW50MmQodCxlLGkpfXNldFBvaW50MmQodCxlLGkpe2NvbnN0IG49W01hdGgubWF4KDAsTWF0aC5taW4oMSxlWzBdKSksTWF0aC5tYXgoMCxNYXRoLm1pbigxLGVbMV0pKV07dGhpcy5fcG9pbnRzW3RdPW4sdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXRQb2ludHMzZCh0KXtyZXR1cm4gdGhpcy5fZ2V0UG9pbnRzM2QodGhpcy5fcG9pbnRzLHQpfWdldFBvaW50M2QodCxlKXtyZXR1cm4gZS51bnByb2plY3RCYXNpYyh0aGlzLl9wb2ludHNbdF0sMjAwKX1nZXRQb2ludHMyZCgpe3JldHVybiB0aGlzLl9wb2ludHMuc2xpY2UoKX1nZXRDZW50cm9pZDJkKHQpe2lmKCF0KXRocm93IG5ldyB3ZyhcIkdldCBjZW50cm9pZCBtdXN0IGJlIGNhbGxlZCB3aXRoIGEgdHJhbnNmb3JtIGZvciBwb2ludHMgZ2VvbWV0cmllcy5cIik7Y29uc3RbZSxpLG4scl09dGhpcy5nZXRSZWN0MmQodCk7cmV0dXJuW2U8bj8oZStuKS8yOihlK24rMSkvMiUxLChpK3IpLzJdfWdldENlbnRyb2lkM2QodCl7bGV0IGU9dGhpcy5nZXRDZW50cm9pZDJkKCk7cmV0dXJuIHQudW5wcm9qZWN0QmFzaWMoZSwyMDApfWdldFJlY3QyZCh0KXtsZXQgZT0xLGk9MCxuPTEscj0wO2NvbnN0IHM9dGhpcy5fcG9pbnRzO2Zvcihjb25zdCB0IG9mIHMpdFswXTxlJiYoZT10WzBdKSx0WzBdPmkmJihpPXRbMF0pLHRbMV08biYmKG49dFsxXSksdFsxXT5yJiYocj10WzFdKTtpZihkZCh0LmNhbWVyYVR5cGUpKXtjb25zdCB0PVtdO2ZvcihsZXQgZT0wO2U8cy5sZW5ndGg7ZSsrKXRbZV09ZTt0LnNvcnQoKCh0LGUpPT5zW3RdWzBdPHNbZV1bMF0/LTE6c1t0XVswXT5zW2VdWzBdPzE6dDxlPy0xOjEpKTtsZXQgbj1zW3RbMF1dWzBdKzEtc1t0W3QubGVuZ3RoLTFdXVswXSxyPTA7Zm9yKGxldCBlPTA7ZTx0Lmxlbmd0aC0xO2UrKyl7Y29uc3QgaT10W2VdLG89dFtlKzFdLGE9c1tvXVswXS1zW2ldWzBdO2E+biYmKG49YSxyPWUrMSl9cj4wJiYoZT1zW3Rbcl1dWzBdLGk9c1t0W3ItMV1dWzBdKX1yZXR1cm5bZSxuLGkscl19c2V0Q2VudHJvaWQyZCh0LGUpe3Rocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRlZFwiKX1fZ2V0UG9pbnRzM2QodCxlKXtyZXR1cm4gdC5tYXAoKHQ9PmUudW5wcm9qZWN0QmFzaWModCwyMDApKSl9fWNsYXNzIE1ne2NvbnN0cnVjdG9yKHQsZSxpKXt0aGlzLl9nZW9tZXRyeT10LHRoaXMuX3RyYW5zZm9ybT1lLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPWl8fG5ldyBXZix0aGlzLl9hYm9ydGVkJD1uZXcgVCx0aGlzLl9jcmVhdGVkJD1uZXcgVCx0aGlzLl9nbE9iamVjdHNDaGFuZ2VkJD1uZXcgVCx0aGlzLl9nZW9tZXRyeUNoYW5nZWRTdWJzY3JpcHRpb249dGhpcy5fZ2VvbWV0cnkuY2hhbmdlZCQuc3Vic2NyaWJlKCgoKT0+e3RoaXMuX29uR2VvbWV0cnlDaGFuZ2VkKCksdGhpcy5fZ2xPYmplY3RzQ2hhbmdlZCQubmV4dCh0aGlzKX0pKX1nZXQgZ2VvbWV0cnkoKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnl9Z2V0IGdsT2JqZWN0cygpe3JldHVybiB0aGlzLl9nbE9iamVjdHN9Z2V0IGFib3J0ZWQkKCl7cmV0dXJuIHRoaXMuX2Fib3J0ZWQkfWdldCBjcmVhdGVkJCgpe3JldHVybiB0aGlzLl9jcmVhdGVkJH1nZXQgZ2xPYmplY3RzQ2hhbmdlZCQoKXtyZXR1cm4gdGhpcy5fZ2xPYmplY3RzQ2hhbmdlZCR9Z2V0IGdlb21ldHJ5Q2hhbmdlZCQoKXtyZXR1cm4gdGhpcy5fZ2VvbWV0cnkuY2hhbmdlZCQucGlwZShydCgoKCk9PnRoaXMpKSl9ZGlzcG9zZSgpe3RoaXMuX2dlb21ldHJ5Q2hhbmdlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfV9jYW52YXNUb1RyYW5zZm9ybSh0KXtyZXR1cm5gdHJhbnNsYXRlKC01MCUsLTUwJSkgdHJhbnNsYXRlKCR7TWF0aC5yb3VuZCh0WzBdKX1weCwke01hdGgucm91bmQodFsxXSl9cHgpYH1fY29sb3JUb0JhY2tncm91bmQodCl7cmV0dXJuXCIjXCIrKFwiMDAwMDAwXCIrdC50b1N0cmluZygxNikpLnN1YnN0cigtNil9X2NyZWF0ZU91dGluZSh0LGUpe2NvbnN0IGk9dGhpcy5fZ2V0TGluZVBvc2l0aW9ucyh0KSxuPW5ldyBocztuLnNldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIsbmV3IEhyKGksMykpO3JldHVybiBuZXcgVWMobixuZXcga2Moe2NvbG9yOmUsbGluZXdpZHRoOjF9KSl9X2Rpc3Bvc2VMaW5lKHQpe251bGwhPXQmJih0Lmdlb21ldHJ5LmRpc3Bvc2UoKSx0Lm1hdGVyaWFsLmRpc3Bvc2UoKSl9X2dldExpbmVQb3NpdGlvbnModCl7Y29uc3QgZT10Lmxlbmd0aCxpPW5ldyBGbG9hdDMyQXJyYXkoMyplKTtmb3IobGV0IG49MDtuPGU7KytuKXtjb25zdCBlPTMqbixyPXRbbl07aVtlXT1yWzBdLGlbZSsxXT1yWzFdLGlbZSsyXT1yWzJdfXJldHVybiBpfX12YXIgVGc9RWcsQ2c9RWc7ZnVuY3Rpb24gRWcodCxlLGkpe2k9aXx8Mjt2YXIgbixyLHMsbyxhLGMsaCxsPWUmJmUubGVuZ3RoLHU9bD9lWzBdKmk6dC5sZW5ndGgsZD1JZyh0LDAsdSxpLCEwKSxwPVtdO2lmKCFkfHxkLm5leHQ9PT1kLnByZXYpcmV0dXJuIHA7aWYobCYmKGQ9ZnVuY3Rpb24odCxlLGksbil7dmFyIHIscyxvLGE9W107Zm9yKHI9MCxzPWUubGVuZ3RoO3I8cztyKyspKG89SWcodCxlW3JdKm4scjxzLTE/ZVtyKzFdKm46dC5sZW5ndGgsbiwhMSkpPT09by5uZXh0JiYoby5zdGVpbmVyPSEwKSxhLnB1c2goRmcobykpO2ZvcihhLnNvcnQoRGcpLHI9MDtyPGEubGVuZ3RoO3IrKykkZyhhW3JdLGkpLGk9QWcoaSxpLm5leHQpO3JldHVybiBpfSh0LGUsZCxpKSksdC5sZW5ndGg+ODAqaSl7bj1zPXRbMF0scj1vPXRbMV07Zm9yKHZhciBmPWk7Zjx1O2YrPWkpKGE9dFtmXSk8biYmKG49YSksKGM9dFtmKzFdKTxyJiYocj1jKSxhPnMmJihzPWEpLGM+byYmKG89Yyk7aD0wIT09KGg9TWF0aC5tYXgocy1uLG8tcikpPzEvaDowfXJldHVybiBQZyhkLHAsaSxuLHIsaCkscH1mdW5jdGlvbiBJZyh0LGUsaSxuLHIpe3ZhciBzLG87aWYocj09PUtnKHQsZSxpLG4pPjApZm9yKHM9ZTtzPGk7cys9bilvPVlnKHMsdFtzXSx0W3MrMV0sbyk7ZWxzZSBmb3Iocz1pLW47cz49ZTtzLT1uKW89WWcocyx0W3NdLHRbcysxXSxvKTtyZXR1cm4gbyYmVWcobyxvLm5leHQpJiYoWmcobyksbz1vLm5leHQpLG99ZnVuY3Rpb24gQWcodCxlKXtpZighdClyZXR1cm4gdDtlfHwoZT10KTt2YXIgaSxuPXQ7ZG97aWYoaT0hMSxuLnN0ZWluZXJ8fCFVZyhuLG4ubmV4dCkmJjAhPT1IZyhuLnByZXYsbixuLm5leHQpKW49bi5uZXh0O2Vsc2V7aWYoWmcobiksKG49ZT1uLnByZXYpPT09bi5uZXh0KWJyZWFrO2k9ITB9fXdoaWxlKGl8fG4hPT1lKTtyZXR1cm4gZX1mdW5jdGlvbiBQZyh0LGUsaSxuLHIscyxvKXtpZih0KXshbyYmcyYmZnVuY3Rpb24odCxlLGksbil7dmFyIHI9dDtkb3tudWxsPT09ci56JiYoci56PXpnKHIueCxyLnksZSxpLG4pKSxyLnByZXZaPXIucHJldixyLm5leHRaPXIubmV4dCxyPXIubmV4dH13aGlsZShyIT09dCk7ci5wcmV2Wi5uZXh0Wj1udWxsLHIucHJldlo9bnVsbCxmdW5jdGlvbih0KXt2YXIgZSxpLG4scixzLG8sYSxjLGg9MTtkb3tmb3IoaT10LHQ9bnVsbCxzPW51bGwsbz0wO2k7KXtmb3IobysrLG49aSxhPTAsZT0wO2U8aCYmKGErKyxuPW4ubmV4dFopO2UrKyk7Zm9yKGM9aDthPjB8fGM+MCYmbjspMCE9PWEmJigwPT09Y3x8IW58fGkuejw9bi56KT8ocj1pLGk9aS5uZXh0WixhLS0pOihyPW4sbj1uLm5leHRaLGMtLSkscz9zLm5leHRaPXI6dD1yLHIucHJldlo9cyxzPXI7aT1ufXMubmV4dFo9bnVsbCxoKj0yfXdoaWxlKG8+MSl9KHIpfSh0LG4scixzKTtmb3IodmFyIGEsYyxoPXQ7dC5wcmV2IT09dC5uZXh0OylpZihhPXQucHJldixjPXQubmV4dCxzP0xnKHQsbixyLHMpOlJnKHQpKWUucHVzaChhLmkvaSksZS5wdXNoKHQuaS9pKSxlLnB1c2goYy5pL2kpLFpnKHQpLHQ9Yy5uZXh0LGg9Yy5uZXh0O2Vsc2UgaWYoKHQ9Yyk9PT1oKXtvPzE9PT1vP1BnKHQ9T2coQWcodCksZSxpKSxlLGksbixyLHMsMik6Mj09PW8mJk5nKHQsZSxpLG4scixzKTpQZyhBZyh0KSxlLGksbixyLHMsMSk7YnJlYWt9fX1mdW5jdGlvbiBSZyh0KXt2YXIgZT10LnByZXYsaT10LG49dC5uZXh0O2lmKEhnKGUsaSxuKT49MClyZXR1cm4hMTtmb3IodmFyIHI9dC5uZXh0Lm5leHQ7ciE9PXQucHJldjspe2lmKEJnKGUueCxlLnksaS54LGkueSxuLngsbi55LHIueCxyLnkpJiZIZyhyLnByZXYscixyLm5leHQpPj0wKXJldHVybiExO3I9ci5uZXh0fXJldHVybiEwfWZ1bmN0aW9uIExnKHQsZSxpLG4pe3ZhciByPXQucHJldixzPXQsbz10Lm5leHQ7aWYoSGcocixzLG8pPj0wKXJldHVybiExO2Zvcih2YXIgYT1yLng8cy54P3IueDxvLng/ci54Om8ueDpzLng8by54P3MueDpvLngsYz1yLnk8cy55P3IueTxvLnk/ci55Om8ueTpzLnk8by55P3MueTpvLnksaD1yLng+cy54P3IueD5vLng/ci54Om8ueDpzLng+by54P3MueDpvLngsbD1yLnk+cy55P3IueT5vLnk/ci55Om8ueTpzLnk+by55P3MueTpvLnksdT16ZyhhLGMsZSxpLG4pLGQ9emcoaCxsLGUsaSxuKSxwPXQucHJldlosZj10Lm5leHRaO3AmJnAuej49dSYmZiYmZi56PD1kOyl7aWYocCE9PXQucHJldiYmcCE9PXQubmV4dCYmQmcoci54LHIueSxzLngscy55LG8ueCxvLnkscC54LHAueSkmJkhnKHAucHJldixwLHAubmV4dCk+PTApcmV0dXJuITE7aWYocD1wLnByZXZaLGYhPT10LnByZXYmJmYhPT10Lm5leHQmJkJnKHIueCxyLnkscy54LHMueSxvLngsby55LGYueCxmLnkpJiZIZyhmLnByZXYsZixmLm5leHQpPj0wKXJldHVybiExO2Y9Zi5uZXh0Wn1mb3IoO3AmJnAuej49dTspe2lmKHAhPT10LnByZXYmJnAhPT10Lm5leHQmJkJnKHIueCxyLnkscy54LHMueSxvLngsby55LHAueCxwLnkpJiZIZyhwLnByZXYscCxwLm5leHQpPj0wKXJldHVybiExO3A9cC5wcmV2Wn1mb3IoO2YmJmYuejw9ZDspe2lmKGYhPT10LnByZXYmJmYhPT10Lm5leHQmJkJnKHIueCxyLnkscy54LHMueSxvLngsby55LGYueCxmLnkpJiZIZyhmLnByZXYsZixmLm5leHQpPj0wKXJldHVybiExO2Y9Zi5uZXh0Wn1yZXR1cm4hMH1mdW5jdGlvbiBPZyh0LGUsaSl7dmFyIG49dDtkb3t2YXIgcj1uLnByZXYscz1uLm5leHQubmV4dDshVWcocixzKSYmVmcocixuLG4ubmV4dCxzKSYmV2cocixzKSYmV2cocyxyKSYmKGUucHVzaChyLmkvaSksZS5wdXNoKG4uaS9pKSxlLnB1c2gocy5pL2kpLFpnKG4pLFpnKG4ubmV4dCksbj10PXMpLG49bi5uZXh0fXdoaWxlKG4hPT10KTtyZXR1cm4gQWcobil9ZnVuY3Rpb24gTmcodCxlLGksbixyLHMpe3ZhciBvPXQ7ZG97Zm9yKHZhciBhPW8ubmV4dC5uZXh0O2EhPT1vLnByZXY7KXtpZihvLmkhPT1hLmkmJmpnKG8sYSkpe3ZhciBjPVhnKG8sYSk7cmV0dXJuIG89QWcobyxvLm5leHQpLGM9QWcoYyxjLm5leHQpLFBnKG8sZSxpLG4scixzKSx2b2lkIFBnKGMsZSxpLG4scixzKX1hPWEubmV4dH1vPW8ubmV4dH13aGlsZShvIT09dCl9ZnVuY3Rpb24gRGcodCxlKXtyZXR1cm4gdC54LWUueH1mdW5jdGlvbiAkZyh0LGUpe2lmKGU9ZnVuY3Rpb24odCxlKXt2YXIgaSxuPWUscj10Lngscz10Lnksbz0tMS8wO2Rve2lmKHM8PW4ueSYmcz49bi5uZXh0LnkmJm4ubmV4dC55IT09bi55KXt2YXIgYT1uLngrKHMtbi55KSoobi5uZXh0Lngtbi54KS8obi5uZXh0Lnktbi55KTtpZihhPD1yJiZhPm8pe2lmKG89YSxhPT09cil7aWYocz09PW4ueSlyZXR1cm4gbjtpZihzPT09bi5uZXh0LnkpcmV0dXJuIG4ubmV4dH1pPW4ueDxuLm5leHQueD9uOm4ubmV4dH19bj1uLm5leHR9d2hpbGUobiE9PWUpO2lmKCFpKXJldHVybiBudWxsO2lmKHI9PT1vKXJldHVybiBpO3ZhciBjLGg9aSxsPWkueCx1PWkueSxkPTEvMDtuPWk7ZG97cj49bi54JiZuLng+PWwmJnIhPT1uLngmJkJnKHM8dT9yOm8scyxsLHUsczx1P286cixzLG4ueCxuLnkpJiYoYz1NYXRoLmFicyhzLW4ueSkvKHItbi54KSxXZyhuLHQpJiYoYzxkfHxjPT09ZCYmKG4ueD5pLnh8fG4ueD09PWkueCYma2coaSxuKSkpJiYoaT1uLGQ9YykpLG49bi5uZXh0fXdoaWxlKG4hPT1oKTtyZXR1cm4gaX0odCxlKSl7dmFyIGk9WGcoZSx0KTtBZyhlLGUubmV4dCksQWcoaSxpLm5leHQpfX1mdW5jdGlvbiBrZyh0LGUpe3JldHVybiBIZyh0LnByZXYsdCxlLnByZXYpPDAmJkhnKGUubmV4dCx0LHQubmV4dCk8MH1mdW5jdGlvbiB6Zyh0LGUsaSxuLHIpe3JldHVybih0PTE0MzE2NTU3NjUmKCh0PTg1ODk5MzQ1OSYoKHQ9MjUyNjQ1MTM1JigodD0xNjcxMTkzNSYoKHQ9MzI3NjcqKHQtaSkqcil8dDw8OCkpfHQ8PDQpKXx0PDwyKSl8dDw8MSkpfChlPTE0MzE2NTU3NjUmKChlPTg1ODk5MzQ1OSYoKGU9MjUyNjQ1MTM1JigoZT0xNjcxMTkzNSYoKGU9MzI3NjcqKGUtbikqcil8ZTw8OCkpfGU8PDQpKXxlPDwyKSl8ZTw8MSkpPDwxfWZ1bmN0aW9uIEZnKHQpe3ZhciBlPXQsaT10O2RveyhlLng8aS54fHxlLng9PT1pLngmJmUueTxpLnkpJiYoaT1lKSxlPWUubmV4dH13aGlsZShlIT09dCk7cmV0dXJuIGl9ZnVuY3Rpb24gQmcodCxlLGksbixyLHMsbyxhKXtyZXR1cm4oci1vKSooZS1hKS0odC1vKSoocy1hKT49MCYmKHQtbykqKG4tYSktKGktbykqKGUtYSk+PTAmJihpLW8pKihzLWEpLShyLW8pKihuLWEpPj0wfWZ1bmN0aW9uIGpnKHQsZSl7cmV0dXJuIHQubmV4dC5pIT09ZS5pJiZ0LnByZXYuaSE9PWUuaSYmIWZ1bmN0aW9uKHQsZSl7dmFyIGk9dDtkb3tpZihpLmkhPT10LmkmJmkubmV4dC5pIT09dC5pJiZpLmkhPT1lLmkmJmkubmV4dC5pIT09ZS5pJiZWZyhpLGkubmV4dCx0LGUpKXJldHVybiEwO2k9aS5uZXh0fXdoaWxlKGkhPT10KTtyZXR1cm4hMX0odCxlKSYmKFdnKHQsZSkmJldnKGUsdCkmJmZ1bmN0aW9uKHQsZSl7dmFyIGk9dCxuPSExLHI9KHQueCtlLngpLzIscz0odC55K2UueSkvMjtkb3tpLnk+cyE9aS5uZXh0Lnk+cyYmaS5uZXh0LnkhPT1pLnkmJnI8KGkubmV4dC54LWkueCkqKHMtaS55KS8oaS5uZXh0LnktaS55KStpLngmJihuPSFuKSxpPWkubmV4dH13aGlsZShpIT09dCk7cmV0dXJuIG59KHQsZSkmJihIZyh0LnByZXYsdCxlLnByZXYpfHxIZyh0LGUucHJldixlKSl8fFVnKHQsZSkmJkhnKHQucHJldix0LHQubmV4dCk+MCYmSGcoZS5wcmV2LGUsZS5uZXh0KT4wKX1mdW5jdGlvbiBIZyh0LGUsaSl7cmV0dXJuKGUueS10LnkpKihpLngtZS54KS0oZS54LXQueCkqKGkueS1lLnkpfWZ1bmN0aW9uIFVnKHQsZSl7cmV0dXJuIHQueD09PWUueCYmdC55PT09ZS55fWZ1bmN0aW9uIFZnKHQsZSxpLG4pe3ZhciByPXFnKEhnKHQsZSxpKSkscz1xZyhIZyh0LGUsbikpLG89cWcoSGcoaSxuLHQpKSxhPXFnKEhnKGksbixlKSk7cmV0dXJuIHIhPT1zJiZvIT09YXx8KCEoMCE9PXJ8fCFHZyh0LGksZSkpfHwoISgwIT09c3x8IUdnKHQsbixlKSl8fCghKDAhPT1vfHwhR2coaSx0LG4pKXx8ISgwIT09YXx8IUdnKGksZSxuKSkpKSl9ZnVuY3Rpb24gR2codCxlLGkpe3JldHVybiBlLng8PU1hdGgubWF4KHQueCxpLngpJiZlLng+PU1hdGgubWluKHQueCxpLngpJiZlLnk8PU1hdGgubWF4KHQueSxpLnkpJiZlLnk+PU1hdGgubWluKHQueSxpLnkpfWZ1bmN0aW9uIHFnKHQpe3JldHVybiB0PjA/MTp0PDA/LTE6MH1mdW5jdGlvbiBXZyh0LGUpe3JldHVybiBIZyh0LnByZXYsdCx0Lm5leHQpPDA/SGcodCxlLHQubmV4dCk+PTAmJkhnKHQsdC5wcmV2LGUpPj0wOkhnKHQsZSx0LnByZXYpPDB8fEhnKHQsdC5uZXh0LGUpPDB9ZnVuY3Rpb24gWGcodCxlKXt2YXIgaT1uZXcgSmcodC5pLHQueCx0LnkpLG49bmV3IEpnKGUuaSxlLngsZS55KSxyPXQubmV4dCxzPWUucHJldjtyZXR1cm4gdC5uZXh0PWUsZS5wcmV2PXQsaS5uZXh0PXIsci5wcmV2PWksbi5uZXh0PWksaS5wcmV2PW4scy5uZXh0PW4sbi5wcmV2PXMsbn1mdW5jdGlvbiBZZyh0LGUsaSxuKXt2YXIgcj1uZXcgSmcodCxlLGkpO3JldHVybiBuPyhyLm5leHQ9bi5uZXh0LHIucHJldj1uLG4ubmV4dC5wcmV2PXIsbi5uZXh0PXIpOihyLnByZXY9cixyLm5leHQ9cikscn1mdW5jdGlvbiBaZyh0KXt0Lm5leHQucHJldj10LnByZXYsdC5wcmV2Lm5leHQ9dC5uZXh0LHQucHJldlomJih0LnByZXZaLm5leHRaPXQubmV4dFopLHQubmV4dFomJih0Lm5leHRaLnByZXZaPXQucHJldlopfWZ1bmN0aW9uIEpnKHQsZSxpKXt0aGlzLmk9dCx0aGlzLng9ZSx0aGlzLnk9aSx0aGlzLnByZXY9bnVsbCx0aGlzLm5leHQ9bnVsbCx0aGlzLno9bnVsbCx0aGlzLnByZXZaPW51bGwsdGhpcy5uZXh0Wj1udWxsLHRoaXMuc3RlaW5lcj0hMX1mdW5jdGlvbiBLZyh0LGUsaSxuKXtmb3IodmFyIHI9MCxzPWUsbz1pLW47czxpO3MrPW4pcis9KHRbb10tdFtzXSkqKHRbcysxXSt0W28rMV0pLG89cztyZXR1cm4gcn1FZy5kZXZpYXRpb249ZnVuY3Rpb24odCxlLGksbil7dmFyIHI9ZSYmZS5sZW5ndGgscz1yP2VbMF0qaTp0Lmxlbmd0aCxvPU1hdGguYWJzKEtnKHQsMCxzLGkpKTtpZihyKWZvcih2YXIgYT0wLGM9ZS5sZW5ndGg7YTxjO2ErKyl7dmFyIGg9ZVthXSppLGw9YTxjLTE/ZVthKzFdKmk6dC5sZW5ndGg7by09TWF0aC5hYnMoS2codCxoLGwsaSkpfXZhciB1PTA7Zm9yKGE9MDthPG4ubGVuZ3RoO2ErPTMpe3ZhciBkPW5bYV0qaSxwPW5bYSsxXSppLGY9blthKzJdKmk7dSs9TWF0aC5hYnMoKHRbZF0tdFtmXSkqKHRbcCsxXS10W2QrMV0pLSh0W2RdLXRbcF0pKih0W2YrMV0tdFtkKzFdKSl9cmV0dXJuIDA9PT1vJiYwPT09dT8wOk1hdGguYWJzKCh1LW8pL28pfSxFZy5mbGF0dGVuPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10WzBdWzBdLmxlbmd0aCxpPXt2ZXJ0aWNlczpbXSxob2xlczpbXSxkaW1lbnNpb25zOmV9LG49MCxyPTA7cjx0Lmxlbmd0aDtyKyspe2Zvcih2YXIgcz0wO3M8dFtyXS5sZW5ndGg7cysrKWZvcih2YXIgbz0wO288ZTtvKyspaS52ZXJ0aWNlcy5wdXNoKHRbcl1bc11bb10pO3I+MCYmKG4rPXRbci0xXS5sZW5ndGgsaS5ob2xlcy5wdXNoKG4pKX1yZXR1cm4gaX0sVGcuZGVmYXVsdD1DZztmdW5jdGlvbiBRZyh0LGUpe3JldHVybiB0PGU/LTE6dD5lPzE6MH12YXIgdF89eHAoT2JqZWN0LmZyZWV6ZSh7X19wcm90b19fOm51bGwsZGVmYXVsdDpjbGFzc3tjb25zdHJ1Y3Rvcih0PVtdLGU9UWcpe2lmKHRoaXMuZGF0YT10LHRoaXMubGVuZ3RoPXRoaXMuZGF0YS5sZW5ndGgsdGhpcy5jb21wYXJlPWUsdGhpcy5sZW5ndGg+MClmb3IobGV0IHQ9KHRoaXMubGVuZ3RoPj4xKS0xO3Q+PTA7dC0tKXRoaXMuX2Rvd24odCl9cHVzaCh0KXt0aGlzLmRhdGEucHVzaCh0KSx0aGlzLmxlbmd0aCsrLHRoaXMuX3VwKHRoaXMubGVuZ3RoLTEpfXBvcCgpe2lmKDA9PT10aGlzLmxlbmd0aClyZXR1cm47Y29uc3QgdD10aGlzLmRhdGFbMF0sZT10aGlzLmRhdGEucG9wKCk7cmV0dXJuIHRoaXMubGVuZ3RoLS0sdGhpcy5sZW5ndGg+MCYmKHRoaXMuZGF0YVswXT1lLHRoaXMuX2Rvd24oMCkpLHR9cGVlaygpe3JldHVybiB0aGlzLmRhdGFbMF19X3VwKHQpe2NvbnN0e2RhdGE6ZSxjb21wYXJlOml9PXRoaXMsbj1lW3RdO2Zvcig7dD4wOyl7Y29uc3Qgcj10LTE+PjEscz1lW3JdO2lmKGkobixzKT49MClicmVhaztlW3RdPXMsdD1yfWVbdF09bn1fZG93bih0KXtjb25zdHtkYXRhOmUsY29tcGFyZTppfT10aGlzLG49dGhpcy5sZW5ndGg+PjEscj1lW3RdO2Zvcig7dDxuOyl7bGV0IG49MSsodDw8MSkscz1lW25dO2NvbnN0IG89bisxO2lmKG88dGhpcy5sZW5ndGgmJmkoZVtvXSxzKTwwJiYobj1vLHM9ZVtvXSksaShzLHIpPj0wKWJyZWFrO2VbdF09cyx0PW59ZVt0XT1yfX19KSk7dF8uZGVmYXVsdCYmKHRfPXRfLmRlZmF1bHQpO3ZhciBlXz1uXyxpXz1uXztmdW5jdGlvbiBuXyh0LGUsaSl7dmFyIG4scixzLG87ZT1lfHwxO2Zvcih2YXIgYT0wO2E8dFswXS5sZW5ndGg7YSsrKXt2YXIgYz10WzBdW2FdOyghYXx8Y1swXTxuKSYmKG49Y1swXSksKCFhfHxjWzFdPHIpJiYocj1jWzFdKSwoIWF8fGNbMF0+cykmJihzPWNbMF0pLCghYXx8Y1sxXT5vKSYmKG89Y1sxXSl9dmFyIGg9cy1uLGw9by1yLHU9TWF0aC5taW4oaCxsKSxkPXUvMjtpZigwPT09dSl7dmFyIHA9W24scl07cmV0dXJuIHAuZGlzdGFuY2U9MCxwfWZvcih2YXIgZj1uZXcgdF8odm9pZCAwLHJfKSxtPW47bTxzO20rPXUpZm9yKHZhciBnPXI7ZzxvO2crPXUpZi5wdXNoKG5ldyBzXyhtK2QsZytkLGQsdCkpO3ZhciBfPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9MCxuPTAscj10WzBdLHM9MCxvPXIubGVuZ3RoLGE9by0xO3M8bzthPXMrKyl7dmFyIGM9cltzXSxoPXJbYV0sbD1jWzBdKmhbMV0taFswXSpjWzFdO2krPShjWzBdK2hbMF0pKmwsbis9KGNbMV0raFsxXSkqbCxlKz0zKmx9cmV0dXJuIDA9PT1lP25ldyBzXyhyWzBdWzBdLHJbMF1bMV0sMCx0KTpuZXcgc18oaS9lLG4vZSwwLHQpfSh0KSx2PW5ldyBzXyhuK2gvMixyK2wvMiwwLHQpO3YuZD5fLmQmJihfPXYpO2Zvcih2YXIgeT1mLmxlbmd0aDtmLmxlbmd0aDspe3ZhciBiPWYucG9wKCk7Yi5kPl8uZCYmKF89YixpJiZjb25zb2xlLmxvZyhcImZvdW5kIGJlc3QgJWQgYWZ0ZXIgJWQgcHJvYmVzXCIsTWF0aC5yb3VuZCgxZTQqYi5kKS8xZTQseSkpLGIubWF4LV8uZDw9ZXx8KGQ9Yi5oLzIsZi5wdXNoKG5ldyBzXyhiLngtZCxiLnktZCxkLHQpKSxmLnB1c2gobmV3IHNfKGIueCtkLGIueS1kLGQsdCkpLGYucHVzaChuZXcgc18oYi54LWQsYi55K2QsZCx0KSksZi5wdXNoKG5ldyBzXyhiLngrZCxiLnkrZCxkLHQpKSx5Kz00KX1pJiYoY29uc29sZS5sb2coXCJudW0gcHJvYmVzOiBcIit5KSxjb25zb2xlLmxvZyhcImJlc3QgZGlzdGFuY2U6IFwiK18uZCkpO3ZhciB4PVtfLngsXy55XTtyZXR1cm4geC5kaXN0YW5jZT1fLmQseH1mdW5jdGlvbiByXyh0LGUpe3JldHVybiBlLm1heC10Lm1heH1mdW5jdGlvbiBzXyh0LGUsaSxuKXt0aGlzLng9dCx0aGlzLnk9ZSx0aGlzLmg9aSx0aGlzLmQ9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgbj0hMSxyPTEvMCxzPTA7czxpLmxlbmd0aDtzKyspZm9yKHZhciBvPWlbc10sYT0wLGM9by5sZW5ndGgsaD1jLTE7YTxjO2g9YSsrKXt2YXIgbD1vW2FdLHU9b1toXTtsWzFdPmUhPXVbMV0+ZSYmdDwodVswXS1sWzBdKSooZS1sWzFdKS8odVsxXS1sWzFdKStsWzBdJiYobj0hbikscj1NYXRoLm1pbihyLG9fKHQsZSxsLHUpKX1yZXR1cm4gMD09PXI/MDoobj8xOi0xKSpNYXRoLnNxcnQocil9KHQsZSxuKSx0aGlzLm1heD10aGlzLmQrdGhpcy5oKk1hdGguU1FSVDJ9ZnVuY3Rpb24gb18odCxlLGksbil7dmFyIHI9aVswXSxzPWlbMV0sbz1uWzBdLXIsYT1uWzFdLXM7aWYoMCE9PW98fDAhPT1hKXt2YXIgYz0oKHQtcikqbysoZS1zKSphKS8obypvK2EqYSk7Yz4xPyhyPW5bMF0scz1uWzFdKTpjPjAmJihyKz1vKmMscys9YSpjKX1yZXR1cm4obz10LXIpKm8rKGE9ZS1zKSphfWZ1bmN0aW9uIGFfKHQsZSl7cmV0dXJuIHQ+ZT8xOnQ8ZT8tMTowfWVfLmRlZmF1bHQ9aV87Y2xhc3MgY197Y29uc3RydWN0b3IodD1hXyxlPSExKXt0aGlzLl9jb21wYXJlPXQsdGhpcy5fcm9vdD1udWxsLHRoaXMuX3NpemU9MCx0aGlzLl9ub0R1cGxpY2F0ZXM9ISFlfXJvdGF0ZUxlZnQodCl7dmFyIGU9dC5yaWdodDtlJiYodC5yaWdodD1lLmxlZnQsZS5sZWZ0JiYoZS5sZWZ0LnBhcmVudD10KSxlLnBhcmVudD10LnBhcmVudCksdC5wYXJlbnQ/dD09PXQucGFyZW50LmxlZnQ/dC5wYXJlbnQubGVmdD1lOnQucGFyZW50LnJpZ2h0PWU6dGhpcy5fcm9vdD1lLGUmJihlLmxlZnQ9dCksdC5wYXJlbnQ9ZX1yb3RhdGVSaWdodCh0KXt2YXIgZT10LmxlZnQ7ZSYmKHQubGVmdD1lLnJpZ2h0LGUucmlnaHQmJihlLnJpZ2h0LnBhcmVudD10KSxlLnBhcmVudD10LnBhcmVudCksdC5wYXJlbnQ/dD09PXQucGFyZW50LmxlZnQ/dC5wYXJlbnQubGVmdD1lOnQucGFyZW50LnJpZ2h0PWU6dGhpcy5fcm9vdD1lLGUmJihlLnJpZ2h0PXQpLHQucGFyZW50PWV9X3NwbGF5KHQpe2Zvcig7dC5wYXJlbnQ7KXt2YXIgZT10LnBhcmVudDtlLnBhcmVudD9lLmxlZnQ9PT10JiZlLnBhcmVudC5sZWZ0PT09ZT8odGhpcy5yb3RhdGVSaWdodChlLnBhcmVudCksdGhpcy5yb3RhdGVSaWdodChlKSk6ZS5yaWdodD09PXQmJmUucGFyZW50LnJpZ2h0PT09ZT8odGhpcy5yb3RhdGVMZWZ0KGUucGFyZW50KSx0aGlzLnJvdGF0ZUxlZnQoZSkpOmUubGVmdD09PXQmJmUucGFyZW50LnJpZ2h0PT09ZT8odGhpcy5yb3RhdGVSaWdodChlKSx0aGlzLnJvdGF0ZUxlZnQoZSkpOih0aGlzLnJvdGF0ZUxlZnQoZSksdGhpcy5yb3RhdGVSaWdodChlKSk6ZS5sZWZ0PT09dD90aGlzLnJvdGF0ZVJpZ2h0KGUpOnRoaXMucm90YXRlTGVmdChlKX19c3BsYXkodCl7Zm9yKHZhciBlLGksbixyLHM7dC5wYXJlbnQ7KShpPShlPXQucGFyZW50KS5wYXJlbnQpJiZpLnBhcmVudD8oKG49aS5wYXJlbnQpLmxlZnQ9PT1pP24ubGVmdD10Om4ucmlnaHQ9dCx0LnBhcmVudD1uKToodC5wYXJlbnQ9bnVsbCx0aGlzLl9yb290PXQpLHI9dC5sZWZ0LHM9dC5yaWdodCx0PT09ZS5sZWZ0PyhpJiYoaS5sZWZ0PT09ZT8oZS5yaWdodD8oaS5sZWZ0PWUucmlnaHQsaS5sZWZ0LnBhcmVudD1pKTppLmxlZnQ9bnVsbCxlLnJpZ2h0PWksaS5wYXJlbnQ9ZSk6KHI/KGkucmlnaHQ9cixyLnBhcmVudD1pKTppLnJpZ2h0PW51bGwsdC5sZWZ0PWksaS5wYXJlbnQ9dCkpLHM/KGUubGVmdD1zLHMucGFyZW50PWUpOmUubGVmdD1udWxsLHQucmlnaHQ9ZSxlLnBhcmVudD10KTooaSYmKGkucmlnaHQ9PT1lPyhlLmxlZnQ/KGkucmlnaHQ9ZS5sZWZ0LGkucmlnaHQucGFyZW50PWkpOmkucmlnaHQ9bnVsbCxlLmxlZnQ9aSxpLnBhcmVudD1lKToocz8oaS5sZWZ0PXMscy5wYXJlbnQ9aSk6aS5sZWZ0PW51bGwsdC5yaWdodD1pLGkucGFyZW50PXQpKSxyPyhlLnJpZ2h0PXIsci5wYXJlbnQ9ZSk6ZS5yaWdodD1udWxsLHQubGVmdD1lLGUucGFyZW50PXQpfXJlcGxhY2UodCxlKXt0LnBhcmVudD90PT09dC5wYXJlbnQubGVmdD90LnBhcmVudC5sZWZ0PWU6dC5wYXJlbnQucmlnaHQ9ZTp0aGlzLl9yb290PWUsZSYmKGUucGFyZW50PXQucGFyZW50KX1taW5Ob2RlKHQ9dGhpcy5fcm9vdCl7aWYodClmb3IoO3QubGVmdDspdD10LmxlZnQ7cmV0dXJuIHR9bWF4Tm9kZSh0PXRoaXMuX3Jvb3Qpe2lmKHQpZm9yKDt0LnJpZ2h0Oyl0PXQucmlnaHQ7cmV0dXJuIHR9aW5zZXJ0KHQsZSl7dmFyIGk9dGhpcy5fcm9vdCxuPW51bGwscj10aGlzLl9jb21wYXJlO2lmKHRoaXMuX25vRHVwbGljYXRlcylmb3IoO2k7KXtpZihuPWksMD09PXIoaS5rZXksdCkpcmV0dXJuO2k9cihpLmtleSx0KTwwP2kucmlnaHQ6aS5sZWZ0fWVsc2UgZm9yKDtpOyluPWksaT1yKGkua2V5LHQpPDA/aS5yaWdodDppLmxlZnQ7cmV0dXJuIGk9e2tleTp0LGRhdGE6ZSxsZWZ0Om51bGwscmlnaHQ6bnVsbCxwYXJlbnQ6bn0sbj9yKG4ua2V5LGkua2V5KTwwP24ucmlnaHQ9aTpuLmxlZnQ9aTp0aGlzLl9yb290PWksdGhpcy5zcGxheShpKSx0aGlzLl9zaXplKyssaX1maW5kKHQpe2Zvcih2YXIgZT10aGlzLl9yb290LGk9dGhpcy5fY29tcGFyZTtlOyl7dmFyIG49aShlLmtleSx0KTtpZihuPDApZT1lLnJpZ2h0O2Vsc2V7aWYoIShuPjApKXJldHVybiBlO2U9ZS5sZWZ0fX1yZXR1cm4gbnVsbH1jb250YWlucyh0KXtmb3IodmFyIGU9dGhpcy5fcm9vdCxpPXRoaXMuX2NvbXBhcmU7ZTspe3ZhciBuPWkodCxlLmtleSk7aWYoMD09PW4pcmV0dXJuITA7ZT1uPDA/ZS5sZWZ0OmUucmlnaHR9cmV0dXJuITF9cmVtb3ZlKHQpe3ZhciBlPXRoaXMuZmluZCh0KTtpZighZSlyZXR1cm4hMTtpZih0aGlzLnNwbGF5KGUpLGUubGVmdClpZihlLnJpZ2h0KXt2YXIgaT10aGlzLm1pbk5vZGUoZS5yaWdodCk7aS5wYXJlbnQhPT1lJiYodGhpcy5yZXBsYWNlKGksaS5yaWdodCksaS5yaWdodD1lLnJpZ2h0LGkucmlnaHQucGFyZW50PWkpLHRoaXMucmVwbGFjZShlLGkpLGkubGVmdD1lLmxlZnQsaS5sZWZ0LnBhcmVudD1pfWVsc2UgdGhpcy5yZXBsYWNlKGUsZS5sZWZ0KTtlbHNlIHRoaXMucmVwbGFjZShlLGUucmlnaHQpO3JldHVybiB0aGlzLl9zaXplLS0sITB9cmVtb3ZlTm9kZSh0KXtpZighdClyZXR1cm4hMTtpZih0aGlzLnNwbGF5KHQpLHQubGVmdClpZih0LnJpZ2h0KXt2YXIgZT10aGlzLm1pbk5vZGUodC5yaWdodCk7ZS5wYXJlbnQhPT10JiYodGhpcy5yZXBsYWNlKGUsZS5yaWdodCksZS5yaWdodD10LnJpZ2h0LGUucmlnaHQucGFyZW50PWUpLHRoaXMucmVwbGFjZSh0LGUpLGUubGVmdD10LmxlZnQsZS5sZWZ0LnBhcmVudD1lfWVsc2UgdGhpcy5yZXBsYWNlKHQsdC5sZWZ0KTtlbHNlIHRoaXMucmVwbGFjZSh0LHQucmlnaHQpO3JldHVybiB0aGlzLl9zaXplLS0sITB9ZXJhc2UodCl7dmFyIGU9dGhpcy5maW5kKHQpO2lmKGUpe3RoaXMuc3BsYXkoZSk7dmFyIGk9ZS5sZWZ0LG49ZS5yaWdodCxyPW51bGw7aSYmKGkucGFyZW50PW51bGwscj10aGlzLm1heE5vZGUoaSksdGhpcy5zcGxheShyKSx0aGlzLl9yb290PXIpLG4mJihpP3IucmlnaHQ9bjp0aGlzLl9yb290PW4sbi5wYXJlbnQ9ciksdGhpcy5fc2l6ZS0tfX1wb3AoKXt2YXIgdD10aGlzLl9yb290LGU9bnVsbDtpZih0KXtmb3IoO3QubGVmdDspdD10LmxlZnQ7ZT17a2V5OnQua2V5LGRhdGE6dC5kYXRhfSx0aGlzLnJlbW92ZSh0LmtleSl9cmV0dXJuIGV9bmV4dCh0KXt2YXIgZT10O2lmKGUpaWYoZS5yaWdodClmb3IoZT1lLnJpZ2h0O2UmJmUubGVmdDspZT1lLmxlZnQ7ZWxzZSBmb3IoZT10LnBhcmVudDtlJiZlLnJpZ2h0PT09dDspdD1lLGU9ZS5wYXJlbnQ7cmV0dXJuIGV9cHJldih0KXt2YXIgZT10O2lmKGUpaWYoZS5sZWZ0KWZvcihlPWUubGVmdDtlJiZlLnJpZ2h0OyllPWUucmlnaHQ7ZWxzZSBmb3IoZT10LnBhcmVudDtlJiZlLmxlZnQ9PT10Oyl0PWUsZT1lLnBhcmVudDtyZXR1cm4gZX1mb3JFYWNoKHQpe2Zvcih2YXIgZT10aGlzLl9yb290LGk9W10sbj0hMSxyPTA7IW47KWU/KGkucHVzaChlKSxlPWUubGVmdCk6aS5sZW5ndGg+MD8odChlPWkucG9wKCkscisrKSxlPWUucmlnaHQpOm49ITA7cmV0dXJuIHRoaXN9cmFuZ2UodCxlLGksbil7Y29uc3Qgcj1bXSxzPXRoaXMuX2NvbXBhcmU7bGV0IG8sYT10aGlzLl9yb290O2Zvcig7MCE9PXIubGVuZ3RofHxhOylpZihhKXIucHVzaChhKSxhPWEubGVmdDtlbHNle2lmKGE9ci5wb3AoKSxvPXMoYS5rZXksZSksbz4wKWJyZWFrO2lmKHMoYS5rZXksdCk+PTAmJmkuY2FsbChuLGEpKXJldHVybiB0aGlzO2E9YS5yaWdodH1yZXR1cm4gdGhpc31rZXlzKCl7Zm9yKHZhciB0PXRoaXMuX3Jvb3QsZT1bXSxpPVtdLG49ITE7IW47KXQ/KGUucHVzaCh0KSx0PXQubGVmdCk6ZS5sZW5ndGg+MD8odD1lLnBvcCgpLGkucHVzaCh0LmtleSksdD10LnJpZ2h0KTpuPSEwO3JldHVybiBpfXZhbHVlcygpe2Zvcih2YXIgdD10aGlzLl9yb290LGU9W10saT1bXSxuPSExOyFuOyl0PyhlLnB1c2godCksdD10LmxlZnQpOmUubGVuZ3RoPjA/KHQ9ZS5wb3AoKSxpLnB1c2godC5kYXRhKSx0PXQucmlnaHQpOm49ITA7cmV0dXJuIGl9YXQodCl7Zm9yKHZhciBlPXRoaXMuX3Jvb3QsaT1bXSxuPSExLHI9MDshbjspaWYoZSlpLnB1c2goZSksZT1lLmxlZnQ7ZWxzZSBpZihpLmxlbmd0aD4wKXtpZihlPWkucG9wKCkscj09PXQpcmV0dXJuIGU7cisrLGU9ZS5yaWdodH1lbHNlIG49ITA7cmV0dXJuIG51bGx9bG9hZCh0PVtdLGU9W10saT0hMSl7aWYoMCE9PXRoaXMuX3NpemUpdGhyb3cgbmV3IEVycm9yKFwiYnVsay1sb2FkOiB0cmVlIGlzIG5vdCBlbXB0eVwiKTtjb25zdCBuPXQubGVuZ3RoO3JldHVybiBpJiZsXyh0LGUsMCxuLTEsdGhpcy5fY29tcGFyZSksdGhpcy5fcm9vdD1oXyhudWxsLHQsZSwwLG4pLHRoaXMuX3NpemU9bix0aGlzfW1pbigpe3ZhciB0PXRoaXMubWluTm9kZSh0aGlzLl9yb290KTtyZXR1cm4gdD90LmtleTpudWxsfW1heCgpe3ZhciB0PXRoaXMubWF4Tm9kZSh0aGlzLl9yb290KTtyZXR1cm4gdD90LmtleTpudWxsfWlzRW1wdHkoKXtyZXR1cm4gbnVsbD09PXRoaXMuX3Jvb3R9Z2V0IHNpemUoKXtyZXR1cm4gdGhpcy5fc2l6ZX1zdGF0aWMgY3JlYXRlVHJlZSh0LGUsaSxuLHIpe3JldHVybiBuZXcgY18oaSxyKS5sb2FkKHQsZSxuKX19ZnVuY3Rpb24gaF8odCxlLGksbixyKXtjb25zdCBzPXItbjtpZihzPjApe2NvbnN0IG89bitNYXRoLmZsb29yKHMvMiksYT17a2V5OmVbb10sZGF0YTppW29dLHBhcmVudDp0fTtyZXR1cm4gYS5sZWZ0PWhfKGEsZSxpLG4sbyksYS5yaWdodD1oXyhhLGUsaSxvKzEsciksYX1yZXR1cm4gbnVsbH1mdW5jdGlvbiBsXyh0LGUsaSxuLHIpe2lmKGk+PW4pcmV0dXJuO2NvbnN0IHM9dFtpK24+PjFdO2xldCBvPWktMSxhPW4rMTtmb3IoOzspe2Rve28rK313aGlsZShyKHRbb10scyk8MCk7ZG97YS0tfXdoaWxlKHIodFthXSxzKT4wKTtpZihvPj1hKWJyZWFrO2xldCBpPXRbb107dFtvXT10W2FdLHRbYV09aSxpPWVbb10sZVtvXT1lW2FdLGVbYV09aX1sXyh0LGUsaSxhLHIpLGxfKHQsZSxhKzEsbixyKX1mdW5jdGlvbiB1Xyh0LGUsaSl7bnVsbD09PWU/KHQuaW5PdXQ9ITEsdC5vdGhlckluT3V0PSEwKToodC5pc1N1YmplY3Q9PT1lLmlzU3ViamVjdD8odC5pbk91dD0hZS5pbk91dCx0Lm90aGVySW5PdXQ9ZS5vdGhlckluT3V0KToodC5pbk91dD0hZS5vdGhlckluT3V0LHQub3RoZXJJbk91dD1lLmlzVmVydGljYWwoKT8hZS5pbk91dDplLmluT3V0KSxlJiYodC5wcmV2SW5SZXN1bHQ9IWRfKGUsaSl8fGUuaXNWZXJ0aWNhbCgpP2UucHJldkluUmVzdWx0OmUpKTtsZXQgbj1kXyh0LGkpO3QucmVzdWx0VHJhbnNpdGlvbj1uP2Z1bmN0aW9uKHQsZSl7bGV0IGksbj0hdC5pbk91dCxyPSF0Lm90aGVySW5PdXQ7c3dpdGNoKGUpe2Nhc2UgMDppPW4mJnI7YnJlYWs7Y2FzZSAxOmk9bnx8cjticmVhaztjYXNlIDM6aT1uXnI7YnJlYWs7Y2FzZSAyOmk9dC5pc1N1YmplY3Q/biYmIXI6ciYmIW59cmV0dXJuIGk/MTotMX0odCxpKTowfWZ1bmN0aW9uIGRfKHQsZSl7c3dpdGNoKHQudHlwZSl7Y2FzZSAwOnN3aXRjaChlKXtjYXNlIDA6cmV0dXJuIXQub3RoZXJJbk91dDtjYXNlIDE6cmV0dXJuIHQub3RoZXJJbk91dDtjYXNlIDI6cmV0dXJuIHQuaXNTdWJqZWN0JiZ0Lm90aGVySW5PdXR8fCF0LmlzU3ViamVjdCYmIXQub3RoZXJJbk91dDtjYXNlIDM6cmV0dXJuITB9YnJlYWs7Y2FzZSAyOnJldHVybiAwPT09ZXx8MT09PWU7Y2FzZSAzOnJldHVybiAyPT09ZTtjYXNlIDE6cmV0dXJuITF9cmV0dXJuITF9Y2xhc3MgcF97Y29uc3RydWN0b3IodCxlLGksbixyKXt0aGlzLmxlZnQ9ZSx0aGlzLnBvaW50PXQsdGhpcy5vdGhlckV2ZW50PWksdGhpcy5pc1N1YmplY3Q9bix0aGlzLnR5cGU9cnx8MCx0aGlzLmluT3V0PSExLHRoaXMub3RoZXJJbk91dD0hMSx0aGlzLnByZXZJblJlc3VsdD1udWxsLHRoaXMucmVzdWx0VHJhbnNpdGlvbj0wLHRoaXMub3RoZXJQb3M9LTEsdGhpcy5vdXRwdXRDb250b3VySWQ9LTEsdGhpcy5pc0V4dGVyaW9yUmluZz0hMH1pc0JlbG93KHQpe2NvbnN0IGU9dGhpcy5wb2ludCxpPXRoaXMub3RoZXJFdmVudC5wb2ludDtyZXR1cm4gdGhpcy5sZWZ0PyhlWzBdLXRbMF0pKihpWzFdLXRbMV0pLShpWzBdLXRbMF0pKihlWzFdLXRbMV0pPjA6KGlbMF0tdFswXSkqKGVbMV0tdFsxXSktKGVbMF0tdFswXSkqKGlbMV0tdFsxXSk+MH1pc0Fib3ZlKHQpe3JldHVybiF0aGlzLmlzQmVsb3codCl9aXNWZXJ0aWNhbCgpe3JldHVybiB0aGlzLnBvaW50WzBdPT09dGhpcy5vdGhlckV2ZW50LnBvaW50WzBdfWdldCBpblJlc3VsdCgpe3JldHVybiAwIT09dGhpcy5yZXN1bHRUcmFuc2l0aW9ufWNsb25lKCl7Y29uc3QgdD1uZXcgcF8odGhpcy5wb2ludCx0aGlzLmxlZnQsdGhpcy5vdGhlckV2ZW50LHRoaXMuaXNTdWJqZWN0LHRoaXMudHlwZSk7cmV0dXJuIHQuY29udG91cklkPXRoaXMuY29udG91cklkLHQucmVzdWx0VHJhbnNpdGlvbj10aGlzLnJlc3VsdFRyYW5zaXRpb24sdC5wcmV2SW5SZXN1bHQ9dGhpcy5wcmV2SW5SZXN1bHQsdC5pc0V4dGVyaW9yUmluZz10aGlzLmlzRXh0ZXJpb3JSaW5nLHQuaW5PdXQ9dGhpcy5pbk91dCx0Lm90aGVySW5PdXQ9dGhpcy5vdGhlckluT3V0LHR9fWZ1bmN0aW9uIGZfKHQsZSl7cmV0dXJuIHRbMF09PT1lWzBdJiZ0WzFdPT09ZVsxXX1jb25zdCBtXz0xMzQyMTc3Mjk7ZnVuY3Rpb24gZ18odCxlLGksbixyKXtsZXQgcyxvLGEsYyxoPWVbMF0sbD1uWzBdLHU9MCxkPTA7bD5oPT1sPi1oPyhzPWgsaD1lWysrdV0pOihzPWwsbD1uWysrZF0pO2xldCBwPTA7aWYodTx0JiZkPGkpZm9yKGw+aD09bD4taD8obz1oK3MsYT1zLShvLWgpLGg9ZVsrK3VdKToobz1sK3MsYT1zLShvLWwpLGw9blsrK2RdKSxzPW8sMCE9PWEmJihyW3ArK109YSk7dTx0JiZkPGk7KWw+aD09bD4taD8obz1zK2gsYz1vLXMsYT1zLShvLWMpKyhoLWMpLGg9ZVsrK3VdKToobz1zK2wsYz1vLXMsYT1zLShvLWMpKyhsLWMpLGw9blsrK2RdKSxzPW8sMCE9PWEmJihyW3ArK109YSk7Zm9yKDt1PHQ7KW89cytoLGM9by1zLGE9cy0oby1jKSsoaC1jKSxoPWVbKyt1XSxzPW8sMCE9PWEmJihyW3ArK109YSk7Zm9yKDtkPGk7KW89cytsLGM9by1zLGE9cy0oby1jKSsobC1jKSxsPW5bKytkXSxzPW8sMCE9PWEmJihyW3ArK109YSk7cmV0dXJuIDA9PT1zJiYwIT09cHx8KHJbcCsrXT1zKSxwfWZ1bmN0aW9uIF9fKHQpe3JldHVybiBuZXcgRmxvYXQ2NEFycmF5KHQpfWNvbnN0IHZfPV9fKDQpLHlfPV9fKDgpLGJfPV9fKDEyKSx4Xz1fXygxNiksd189X18oNCk7ZnVuY3Rpb24gU18odCxlLGksbixyLHMpe2NvbnN0IG89KGUtcykqKGktciksYT0odC1yKSoobi1zKSxjPW8tYTtpZigwPT09b3x8MD09PWF8fG8+MCE9YT4wKXJldHVybiBjO2NvbnN0IGg9TWF0aC5hYnMobythKTtyZXR1cm4gTWF0aC5hYnMoYyk+PTMzMzA2NjkwNzM4NzU0NzE2ZS0zMipoP2M6LWZ1bmN0aW9uKHQsZSxpLG4scixzLG8pe2xldCBhLGMsaCxsLHUsZCxwLGYsbSxnLF8sdix5LGIseCx3LFMsTTtjb25zdCBUPXQtcixDPWktcixFPWUtcyxJPW4tcztiPVQqSSxkPW1fKlQscD1kLShkLVQpLGY9VC1wLGQ9bV8qSSxtPWQtKGQtSSksZz1JLW0seD1mKmctKGItcCptLWYqbS1wKmcpLHc9RSpDLGQ9bV8qRSxwPWQtKGQtRSksZj1FLXAsZD1tXypDLG09ZC0oZC1DKSxnPUMtbSxTPWYqZy0ody1wKm0tZiptLXAqZyksXz14LVMsdT14LV8sdl9bMF09eC0oXyt1KSsodS1TKSx2PWIrXyx1PXYtYix5PWItKHYtdSkrKF8tdSksXz15LXcsdT15LV8sdl9bMV09eS0oXyt1KSsodS13KSxNPXYrXyx1PU0tdix2X1syXT12LShNLXUpKyhfLXUpLHZfWzNdPU07bGV0IEE9ZnVuY3Rpb24odCxlKXtsZXQgaT1lWzBdO2ZvcihsZXQgbj0xO248dDtuKyspaSs9ZVtuXTtyZXR1cm4gaX0oNCx2XyksUD0yMjIwNDQ2MDQ5MjUwMzE0NmUtMzIqbztpZihBPj1QfHwtQT49UClyZXR1cm4gQTtpZih1PXQtVCxhPXQtKFQrdSkrKHUtciksdT1pLUMsaD1pLShDK3UpKyh1LXIpLHU9ZS1FLGM9ZS0oRSt1KSsodS1zKSx1PW4tSSxsPW4tKEkrdSkrKHUtcyksMD09PWEmJjA9PT1jJiYwPT09aCYmMD09PWwpcmV0dXJuIEE7aWYoUD0xMTA5MzM1NjQ3OTY3MDQ4N2UtNDcqbyszMzMwNjY5MDczODc1NDcwNmUtMzIqTWF0aC5hYnMoQSksQSs9VCpsK0kqYS0oRSpoK0MqYyksQT49UHx8LUE+PVApcmV0dXJuIEE7Yj1hKkksZD1tXyphLHA9ZC0oZC1hKSxmPWEtcCxkPW1fKkksbT1kLShkLUkpLGc9SS1tLHg9ZipnLShiLXAqbS1mKm0tcCpnKSx3PWMqQyxkPW1fKmMscD1kLShkLWMpLGY9Yy1wLGQ9bV8qQyxtPWQtKGQtQyksZz1DLW0sUz1mKmctKHctcCptLWYqbS1wKmcpLF89eC1TLHU9eC1fLHdfWzBdPXgtKF8rdSkrKHUtUyksdj1iK18sdT12LWIseT1iLSh2LXUpKyhfLXUpLF89eS13LHU9eS1fLHdfWzFdPXktKF8rdSkrKHUtdyksTT12K18sdT1NLXYsd19bMl09di0oTS11KSsoXy11KSx3X1szXT1NO2NvbnN0IFI9Z18oNCx2Xyw0LHdfLHlfKTtiPVQqbCxkPW1fKlQscD1kLShkLVQpLGY9VC1wLGQ9bV8qbCxtPWQtKGQtbCksZz1sLW0seD1mKmctKGItcCptLWYqbS1wKmcpLHc9RSpoLGQ9bV8qRSxwPWQtKGQtRSksZj1FLXAsZD1tXypoLG09ZC0oZC1oKSxnPWgtbSxTPWYqZy0ody1wKm0tZiptLXAqZyksXz14LVMsdT14LV8sd19bMF09eC0oXyt1KSsodS1TKSx2PWIrXyx1PXYtYix5PWItKHYtdSkrKF8tdSksXz15LXcsdT15LV8sd19bMV09eS0oXyt1KSsodS13KSxNPXYrXyx1PU0tdix3X1syXT12LShNLXUpKyhfLXUpLHdfWzNdPU07Y29uc3QgTD1nXyhSLHlfLDQsd18sYl8pO2I9YSpsLGQ9bV8qYSxwPWQtKGQtYSksZj1hLXAsZD1tXypsLG09ZC0oZC1sKSxnPWwtbSx4PWYqZy0oYi1wKm0tZiptLXAqZyksdz1jKmgsZD1tXypjLHA9ZC0oZC1jKSxmPWMtcCxkPW1fKmgsbT1kLShkLWgpLGc9aC1tLFM9ZipnLSh3LXAqbS1mKm0tcCpnKSxfPXgtUyx1PXgtXyx3X1swXT14LShfK3UpKyh1LVMpLHY9YitfLHU9di1iLHk9Yi0odi11KSsoXy11KSxfPXktdyx1PXktXyx3X1sxXT15LShfK3UpKyh1LXcpLE09ditfLHU9TS12LHdfWzJdPXYtKE0tdSkrKF8tdSksd19bM109TTtjb25zdCBPPWdfKEwsYl8sNCx3Xyx4Xyk7cmV0dXJuIHhfW08tMV19KHQsZSxpLG4scixzLGgpfWZ1bmN0aW9uIE1fKHQsZSxpKXtjb25zdCBuPVNfKHRbMF0sdFsxXSxlWzBdLGVbMV0saVswXSxpWzFdKTtyZXR1cm4gbj4wPy0xOm48MD8xOjB9ZnVuY3Rpb24gVF8odCxlKXtjb25zdCBpPXQucG9pbnQsbj1lLnBvaW50O3JldHVybiBpWzBdPm5bMF0/MTppWzBdPG5bMF0/LTE6aVsxXSE9PW5bMV0/aVsxXT5uWzFdPzE6LTE6ZnVuY3Rpb24odCxlLGksbil7aWYodC5sZWZ0IT09ZS5sZWZ0KXJldHVybiB0LmxlZnQ/MTotMTtpZigwIT09TV8oaSx0Lm90aGVyRXZlbnQucG9pbnQsZS5vdGhlckV2ZW50LnBvaW50KSlyZXR1cm4gdC5pc0JlbG93KGUub3RoZXJFdmVudC5wb2ludCk/LTE6MTtyZXR1cm4hdC5pc1N1YmplY3QmJmUuaXNTdWJqZWN0PzE6LTF9KHQsZSxpKX1mdW5jdGlvbiBDXyh0LGUsaSl7Y29uc3Qgbj1uZXcgcF8oZSwhMSx0LHQuaXNTdWJqZWN0KSxyPW5ldyBwXyhlLCEwLHQub3RoZXJFdmVudCx0LmlzU3ViamVjdCk7cmV0dXJuIGZfKHQucG9pbnQsdC5vdGhlckV2ZW50LnBvaW50KSYmY29uc29sZS53YXJuKFwid2hhdCBpcyB0aGF0LCBhIGNvbGxhcHNlZCBzZWdtZW50P1wiLHQpLG4uY29udG91cklkPXIuY29udG91cklkPXQuY29udG91cklkLFRfKHIsdC5vdGhlckV2ZW50KT4wJiYodC5vdGhlckV2ZW50LmxlZnQ9ITAsci5sZWZ0PSExKSx0Lm90aGVyRXZlbnQub3RoZXJFdmVudD1yLHQub3RoZXJFdmVudD1uLGkucHVzaChyKSxpLnB1c2gobiksaX1mdW5jdGlvbiBFXyh0LGUpe3JldHVybiB0WzBdKmVbMV0tdFsxXSplWzBdfWZ1bmN0aW9uIElfKHQsZSl7cmV0dXJuIHRbMF0qZVswXSt0WzFdKmVbMV19ZnVuY3Rpb24gQV8odCxlLGkpe2NvbnN0IG49ZnVuY3Rpb24odCxlLGksbixyKXtjb25zdCBzPVtlWzBdLXRbMF0sZVsxXS10WzFdXSxvPVtuWzBdLWlbMF0sblsxXS1pWzFdXTtmdW5jdGlvbiBhKHQsZSxpKXtyZXR1cm5bdFswXStlKmlbMF0sdFsxXStlKmlbMV1dfWNvbnN0IGM9W2lbMF0tdFswXSxpWzFdLXRbMV1dO2xldCBoPUVfKHMsbyksbD1oKmg7Y29uc3QgdT1JXyhzLHMpO2lmKGw+MCl7Y29uc3QgZT1FXyhjLG8pL2g7aWYoZTwwfHxlPjEpcmV0dXJuIG51bGw7Y29uc3Qgbj1FXyhjLHMpL2g7cmV0dXJuIG48MHx8bj4xP251bGw6MD09PWV8fDE9PT1lP3I/bnVsbDpbYSh0LGUscyldOjA9PT1ufHwxPT09bj9yP251bGw6W2EoaSxuLG8pXTpbYSh0LGUscyldfWlmKGg9RV8oYyxzKSxsPWgqaCxsPjApcmV0dXJuIG51bGw7Y29uc3QgZD1JXyhzLGMpL3UscD1kK0lfKHMsbykvdSxmPU1hdGgubWluKGQscCksbT1NYXRoLm1heChkLHApO3JldHVybiBmPD0xJiZtPj0wPzE9PT1mP3I/bnVsbDpbYSh0LGY+MD9mOjAscyldOjA9PT1tP3I/bnVsbDpbYSh0LG08MT9tOjEscyldOnImJjA9PT1mJiYxPT09bT9udWxsOlthKHQsZj4wP2Y6MCxzKSxhKHQsbTwxP206MSxzKV06bnVsbH0odC5wb2ludCx0Lm90aGVyRXZlbnQucG9pbnQsZS5wb2ludCxlLm90aGVyRXZlbnQucG9pbnQpLHI9bj9uLmxlbmd0aDowO2lmKDA9PT1yKXJldHVybiAwO2lmKDE9PT1yJiYoZl8odC5wb2ludCxlLnBvaW50KXx8Zl8odC5vdGhlckV2ZW50LnBvaW50LGUub3RoZXJFdmVudC5wb2ludCkpKXJldHVybiAwO2lmKDI9PT1yJiZ0LmlzU3ViamVjdD09PWUuaXNTdWJqZWN0KXJldHVybiAwO2lmKDE9PT1yKXJldHVybiBmXyh0LnBvaW50LG5bMF0pfHxmXyh0Lm90aGVyRXZlbnQucG9pbnQsblswXSl8fENfKHQsblswXSxpKSxmXyhlLnBvaW50LG5bMF0pfHxmXyhlLm90aGVyRXZlbnQucG9pbnQsblswXSl8fENfKGUsblswXSxpKSwxO2NvbnN0IHM9W107bGV0IG89ITEsYT0hMTtyZXR1cm4gZl8odC5wb2ludCxlLnBvaW50KT9vPSEwOjE9PT1UXyh0LGUpP3MucHVzaChlLHQpOnMucHVzaCh0LGUpLGZfKHQub3RoZXJFdmVudC5wb2ludCxlLm90aGVyRXZlbnQucG9pbnQpP2E9ITA6MT09PVRfKHQub3RoZXJFdmVudCxlLm90aGVyRXZlbnQpP3MucHVzaChlLm90aGVyRXZlbnQsdC5vdGhlckV2ZW50KTpzLnB1c2godC5vdGhlckV2ZW50LGUub3RoZXJFdmVudCksbyYmYXx8bz8oZS50eXBlPTEsdC50eXBlPWUuaW5PdXQ9PT10LmluT3V0PzI6MyxvJiYhYSYmQ18oc1sxXS5vdGhlckV2ZW50LHNbMF0ucG9pbnQsaSksMik6YT8oQ18oc1swXSxzWzFdLnBvaW50LGkpLDMpOnNbMF0hPT1zWzNdLm90aGVyRXZlbnQ/KENfKHNbMF0sc1sxXS5wb2ludCxpKSxDXyhzWzFdLHNbMl0ucG9pbnQsaSksMyk6KENfKHNbMF0sc1sxXS5wb2ludCxpKSxDXyhzWzNdLm90aGVyRXZlbnQsc1syXS5wb2ludCxpKSwzKX1mdW5jdGlvbiBQXyh0LGUpe2lmKHQ9PT1lKXJldHVybiAwO2lmKDAhPT1NXyh0LnBvaW50LHQub3RoZXJFdmVudC5wb2ludCxlLnBvaW50KXx8MCE9PU1fKHQucG9pbnQsdC5vdGhlckV2ZW50LnBvaW50LGUub3RoZXJFdmVudC5wb2ludCkpcmV0dXJuIGZfKHQucG9pbnQsZS5wb2ludCk/dC5pc0JlbG93KGUub3RoZXJFdmVudC5wb2ludCk/LTE6MTp0LnBvaW50WzBdPT09ZS5wb2ludFswXT90LnBvaW50WzFdPGUucG9pbnRbMV0/LTE6MToxPT09VF8odCxlKT9lLmlzQWJvdmUodC5wb2ludCk/LTE6MTp0LmlzQmVsb3coZS5wb2ludCk/LTE6MTtpZih0LmlzU3ViamVjdCE9PWUuaXNTdWJqZWN0KXJldHVybiB0LmlzU3ViamVjdD8tMToxO3tsZXQgaT10LnBvaW50LG49ZS5wb2ludDtpZihpWzBdPT09blswXSYmaVsxXT09PW5bMV0pcmV0dXJuIGk9dC5vdGhlckV2ZW50LnBvaW50LG49ZS5vdGhlckV2ZW50LnBvaW50LGlbMF09PT1uWzBdJiZpWzFdPT09blsxXT8wOnQuY29udG91cklkPmUuY29udG91cklkPzE6LTF9cmV0dXJuIDE9PT1UXyh0LGUpPzE6LTF9Y2xhc3MgUl97Y29uc3RydWN0b3IoKXt0aGlzLnBvaW50cz1bXSx0aGlzLmhvbGVJZHM9W10sdGhpcy5ob2xlT2Y9bnVsbCx0aGlzLmRlcHRoPW51bGx9aXNFeHRlcmlvcigpe3JldHVybiBudWxsPT10aGlzLmhvbGVPZn19ZnVuY3Rpb24gTF8odCxlLGksbil7bGV0IHIscz10KzEsbz1lW3RdLnBvaW50O2NvbnN0IGE9ZS5sZW5ndGg7Zm9yKHM8YSYmKHI9ZVtzXS5wb2ludCk7czxhJiZyWzBdPT09b1swXSYmclsxXT09PW9bMV07KXtpZighaVtzXSlyZXR1cm4gcztzKysscj1lW3NdLnBvaW50fWZvcihzPXQtMTtpW3NdJiZzPm47KXMtLTtyZXR1cm4gc31mdW5jdGlvbiBPXyh0LGUsaSl7Y29uc3Qgbj1uZXcgUl87aWYobnVsbCE9dC5wcmV2SW5SZXN1bHQpe2NvbnN0IHI9dC5wcmV2SW5SZXN1bHQscz1yLm91dHB1dENvbnRvdXJJZDtpZihyLnJlc3VsdFRyYW5zaXRpb24+MCl7Y29uc3QgdD1lW3NdO2lmKG51bGwhPXQuaG9sZU9mKXtjb25zdCByPXQuaG9sZU9mO2Vbcl0uaG9sZUlkcy5wdXNoKGkpLG4uaG9sZU9mPXIsbi5kZXB0aD1lW3NdLmRlcHRofWVsc2UgZVtzXS5ob2xlSWRzLnB1c2goaSksbi5ob2xlT2Y9cyxuLmRlcHRoPWVbc10uZGVwdGgrMX1lbHNlIG4uaG9sZU9mPW51bGwsbi5kZXB0aD1lW3NdLmRlcHRofWVsc2Ugbi5ob2xlT2Y9bnVsbCxuLmRlcHRoPTA7cmV0dXJuIG59ZnVuY3Rpb24gTl8odCl7bGV0IGUsaTtjb25zdCBuPWZ1bmN0aW9uKHQpe2xldCBlLGksbixyO2NvbnN0IHM9W107Zm9yKGk9MCxuPXQubGVuZ3RoO2k8bjtpKyspZT10W2ldLChlLmxlZnQmJmUuaW5SZXN1bHR8fCFlLmxlZnQmJmUub3RoZXJFdmVudC5pblJlc3VsdCkmJnMucHVzaChlKTtsZXQgbz0hMTtmb3IoOyFvOylmb3Iobz0hMCxpPTAsbj1zLmxlbmd0aDtpPG47aSsrKWkrMTxuJiYxPT09VF8oc1tpXSxzW2krMV0pJiYocj1zW2ldLHNbaV09c1tpKzFdLHNbaSsxXT1yLG89ITEpO2ZvcihpPTAsbj1zLmxlbmd0aDtpPG47aSsrKWU9c1tpXSxlLm90aGVyUG9zPWk7Zm9yKGk9MCxuPXMubGVuZ3RoO2k8bjtpKyspZT1zW2ldLGUubGVmdHx8KHI9ZS5vdGhlclBvcyxlLm90aGVyUG9zPWUub3RoZXJFdmVudC5vdGhlclBvcyxlLm90aGVyRXZlbnQub3RoZXJQb3M9cik7cmV0dXJuIHN9KHQpLHI9e30scz1bXTtmb3IoZT0wLGk9bi5sZW5ndGg7ZTxpO2UrKyl7aWYocltlXSljb250aW51ZTtjb25zdCB0PXMubGVuZ3RoLGk9T18obltlXSxzLHQpLG89ZT0+e3JbZV09ITAsbltlXS5vdXRwdXRDb250b3VySWQ9dH07bGV0IGE9ZSxjPWU7Y29uc3QgaD1uW2VdLnBvaW50O2ZvcihpLnBvaW50cy5wdXNoKGgpO28oYSksYT1uW2FdLm90aGVyUG9zLG8oYSksaS5wb2ludHMucHVzaChuW2FdLnBvaW50KSxhPUxfKGEsbixyLGMpLGEhPWM7KTtzLnB1c2goaSl9cmV0dXJuIHN9dmFyIERfPWtfLCRfPWtfO2Z1bmN0aW9uIGtfKHQsZSl7aWYoISh0aGlzIGluc3RhbmNlb2Yga18pKXJldHVybiBuZXcga18odCxlKTtpZih0aGlzLmRhdGE9dHx8W10sdGhpcy5sZW5ndGg9dGhpcy5kYXRhLmxlbmd0aCx0aGlzLmNvbXBhcmU9ZXx8el8sdGhpcy5sZW5ndGg+MClmb3IodmFyIGk9KHRoaXMubGVuZ3RoPj4xKS0xO2k+PTA7aS0tKXRoaXMuX2Rvd24oaSl9ZnVuY3Rpb24gel8odCxlKXtyZXR1cm4gdDxlPy0xOnQ+ZT8xOjB9a18ucHJvdG90eXBlPXtwdXNoOmZ1bmN0aW9uKHQpe3RoaXMuZGF0YS5wdXNoKHQpLHRoaXMubGVuZ3RoKyssdGhpcy5fdXAodGhpcy5sZW5ndGgtMSl9LHBvcDpmdW5jdGlvbigpe2lmKDAhPT10aGlzLmxlbmd0aCl7dmFyIHQ9dGhpcy5kYXRhWzBdO3JldHVybiB0aGlzLmxlbmd0aC0tLHRoaXMubGVuZ3RoPjAmJih0aGlzLmRhdGFbMF09dGhpcy5kYXRhW3RoaXMubGVuZ3RoXSx0aGlzLl9kb3duKDApKSx0aGlzLmRhdGEucG9wKCksdH19LHBlZWs6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kYXRhWzBdfSxfdXA6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMuZGF0YSxpPXRoaXMuY29tcGFyZSxuPWVbdF07dD4wOyl7dmFyIHI9dC0xPj4xLHM9ZVtyXTtpZihpKG4scyk+PTApYnJlYWs7ZVt0XT1zLHQ9cn1lW3RdPW59LF9kb3duOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT10aGlzLmRhdGEsaT10aGlzLmNvbXBhcmUsbj10aGlzLmxlbmd0aD4+MSxyPWVbdF07dDxuOyl7dmFyIHM9MSsodDw8MSksbz1zKzEsYT1lW3NdO2lmKG88dGhpcy5sZW5ndGgmJmkoZVtvXSxhKTwwJiYocz1vLGE9ZVtvXSksaShhLHIpPj0wKWJyZWFrO2VbdF09YSx0PXN9ZVt0XT1yfX0sRF8uZGVmYXVsdD0kXztjb25zdCBGXz1NYXRoLm1heCxCXz1NYXRoLm1pbjtsZXQgal89MDtmdW5jdGlvbiBIXyh0LGUsaSxuLHIscyl7bGV0IG8sYSxjLGgsbCx1O2ZvcihvPTAsYT10Lmxlbmd0aC0xO288YTtvKyspe2lmKGM9dFtvXSxoPXRbbysxXSxsPW5ldyBwXyhjLCExLHZvaWQgMCxlKSx1PW5ldyBwXyhoLCExLGwsZSksbC5vdGhlckV2ZW50PXUsY1swXT09PWhbMF0mJmNbMV09PT1oWzFdKWNvbnRpbnVlO2wuY29udG91cklkPXUuY29udG91cklkPWksc3x8KGwuaXNFeHRlcmlvclJpbmc9ITEsdS5pc0V4dGVyaW9yUmluZz0hMSksVF8obCx1KT4wP3UubGVmdD0hMDpsLmxlZnQ9ITA7Y29uc3QgYT1jWzBdLGQ9Y1sxXTtyWzBdPUJfKHJbMF0sYSksclsxXT1CXyhyWzFdLGQpLHJbMl09Rl8oclsyXSxhKSxyWzNdPUZfKHJbM10sZCksbi5wdXNoKGwpLG4ucHVzaCh1KX19Y29uc3QgVV89W107ZnVuY3Rpb24gVl8odCxlLGkpe1wibnVtYmVyXCI9PXR5cGVvZiB0WzBdWzBdWzBdJiYodD1bdF0pLFwibnVtYmVyXCI9PXR5cGVvZiBlWzBdWzBdWzBdJiYoZT1bZV0pO2xldCBuPWZ1bmN0aW9uKHQsZSxpKXtsZXQgbj1udWxsO3JldHVybiB0Lmxlbmd0aCplLmxlbmd0aD09MCYmKDA9PT1pP249VV86Mj09PWk/bj10OjEhPT1pJiYzIT09aXx8KG49MD09PXQubGVuZ3RoP2U6dCkpLG59KHQsZSxpKTtpZihuKXJldHVybiBuPT09VV8/bnVsbDpuO2NvbnN0IHI9WzEvMCwxLzAsLTEvMCwtMS8wXSxzPVsxLzAsMS8wLC0xLzAsLTEvMF0sbz1mdW5jdGlvbih0LGUsaSxuLHIpe2NvbnN0IHM9bmV3IERfKG51bGwsVF8pO2xldCBvLGEsYyxoLGwsdTtmb3IoYz0wLGg9dC5sZW5ndGg7YzxoO2MrKylmb3Iobz10W2NdLGw9MCx1PW8ubGVuZ3RoO2w8dTtsKyspYT0wPT09bCxhJiZqXysrLEhfKG9bbF0sITAsal8scyxpLGEpO2ZvcihjPTAsaD1lLmxlbmd0aDtjPGg7YysrKWZvcihvPWVbY10sbD0wLHU9by5sZW5ndGg7bDx1O2wrKylhPTA9PT1sLDI9PT1yJiYoYT0hMSksYSYmal8rKyxIXyhvW2xdLCExLGpfLHMsbixhKTtyZXR1cm4gc30odCxlLHIscyxpKTtpZihuPWZ1bmN0aW9uKHQsZSxpLG4scil7bGV0IHM9bnVsbDtyZXR1cm4oaVswXT5uWzJdfHxuWzBdPmlbMl18fGlbMV0+blszXXx8blsxXT5pWzNdKSYmKDA9PT1yP3M9VV86Mj09PXI/cz10OjEhPT1yJiYzIT09cnx8KHM9dC5jb25jYXQoZSkpKSxzfSh0LGUscixzLGkpLG4pcmV0dXJuIG49PT1VXz9udWxsOm47Y29uc3QgYT1OXyhmdW5jdGlvbih0LGUsaSxuLHIscyl7Y29uc3Qgbz1uZXcgY18oUF8pLGE9W10sYz1NYXRoLm1pbihuWzJdLHJbMl0pO2xldCBoLGwsdTtmb3IoOzAhPT10Lmxlbmd0aDspe2xldCBlPXQucG9wKCk7aWYoYS5wdXNoKGUpLDA9PT1zJiZlLnBvaW50WzBdPmN8fDI9PT1zJiZlLnBvaW50WzBdPm5bMl0pYnJlYWs7aWYoZS5sZWZ0KXtsPWg9by5pbnNlcnQoZSksdT1vLm1pbk5vZGUoKSxoPWghPT11P28ucHJldihoKTpudWxsLGw9by5uZXh0KGwpO2NvbnN0IGk9aD9oLmtleTpudWxsO2xldCBuO2lmKHVfKGUsaSxzKSxsJiYyPT09QV8oZSxsLmtleSx0KSYmKHVfKGUsaSxzKSx1XyhlLGwua2V5LHMpKSxoJiYyPT09QV8oaC5rZXksZSx0KSl7bGV0IHQ9aDt0PXQhPT11P28ucHJldih0KTpudWxsLG49dD90LmtleTpudWxsLHVfKGksbixzKSx1XyhlLGkscyl9fWVsc2UgZT1lLm90aGVyRXZlbnQsbD1oPW8uZmluZChlKSxoJiZsJiYoaD1oIT09dT9vLnByZXYoaCk6bnVsbCxsPW8ubmV4dChsKSxvLnJlbW92ZShlKSxsJiZoJiZBXyhoLmtleSxsLmtleSx0KSl9cmV0dXJuIGF9KG8sMCwwLHIscyxpKSksYz1bXTtmb3IobGV0IHQ9MDt0PGEubGVuZ3RoO3QrKyl7bGV0IGU9YVt0XTtpZihlLmlzRXh0ZXJpb3IoKSl7bGV0IHQ9W2UucG9pbnRzXTtmb3IobGV0IGk9MDtpPGUuaG9sZUlkcy5sZW5ndGg7aSsrKXtsZXQgbj1lLmhvbGVJZHNbaV07dC5wdXNoKGFbbl0ucG9pbnRzKX1jLnB1c2godCl9fXJldHVybiBjfWNsYXNzIEdfIGV4dGVuZHMgeGd7Y29uc3RydWN0b3IoKXtzdXBlcigpLHRoaXMuX3N1YnNhbXBsZVRocmVzaG9sZD0uMDA1fV9nZXRQb2xlT2ZJbmFjY2Vzc2liaWxpdHkyZCh0KXtyZXR1cm4gZV8oW3RdLC4wMyl9X3Byb2plY3QodCxlKXtjb25zdCBpPXRoaXMuX2NyZWF0ZUNhbWVyYShlLnVwVmVjdG9yKCkudG9BcnJheSgpLGUudW5wcm9qZWN0U2ZNKFswLDBdLDApLGUudW5wcm9qZWN0U2ZNKFswLDBdLDEwKSk7cmV0dXJuIHRoaXMuX2RldW5wcm9qZWN0KHQsZSxpKX1fc3Vic2FtcGxlKHQsZT10aGlzLl9zdWJzYW1wbGVUaHJlc2hvbGQpe2NvbnN0IGk9W10sbj10Lmxlbmd0aDtmb3IobGV0IHI9MDtyPG47cisrKXtjb25zdCBzPXRbcl0sbz10WyhyKzEpJW5dO2kucHVzaChzKTtjb25zdCBhPU1hdGguc3FydChNYXRoLnBvdyhvWzBdLXNbMF0sMikrTWF0aC5wb3cob1sxXS1zWzFdLDIpKSxjPU1hdGguZmxvb3IoYS9lKSxoPTEvKGMrMSk7Zm9yKGxldCB0PTE7dDw9Yzt0Kyspe2NvbnN0IGU9dCpoLG49WygxLWUpKnNbMF0rZSpvWzBdLCgxLWUpKnNbMV0rZSpvWzFdXTtpLnB1c2gobil9fXJldHVybiBpfV90cmlhbmd1bGF0ZSh0LGUsaSxuKXtsZXQgcj1bdC5zbGljZSgwLC0xKV07Zm9yKGxldCB0IG9mIG51bGwhPWk/aTpbXSlyLnB1c2godC5zbGljZSgwLC0xKSk7bGV0IHM9ZS5zbGljZSgwLC0xKTtmb3IobGV0IHQgb2YgbnVsbCE9bj9uOltdKXM9cy5jb25jYXQodC5zbGljZSgwLC0xKSk7bGV0IG89VGcuZmxhdHRlbihyKSxhPVRnKG8udmVydGljZXMsby5ob2xlcyxvLmRpbWVuc2lvbnMpLGM9W107Zm9yKGxldCB0PTA7dDxhLmxlbmd0aDsrK3Qpe2xldCBlPXNbYVt0XV07Yy5wdXNoKGVbMF0pLGMucHVzaChlWzFdKSxjLnB1c2goZVsyXSl9cmV0dXJuIGN9X3RyaWFuZ3VsYXRlU3BoZXJpY2FsKHQsZSxpKXtjb25zdCBuPVtdLHI9MWUtOTtmb3IobGV0IHM9MDtzPDM7cysrKWZvcihsZXQgbz0wO288MztvKyspe2NvbnN0IGE9cy8zKygwPT09cz8tMWUtOTpyKSxjPW8vMysoMD09PW8/LTFlLTk6ciksaD0ocysxKS8zK3IsbD0obysxKS8zK3IsdT1bW2EsY10sW2EsbF0sW2gsbF0sW2gsY10sW2EsY11dLGQ9WygyKnMrMSkvNiwoMipvKzEpLzZdO24ucHVzaCguLi50aGlzLl90cmlhbmd1bGF0ZVN1YmFyZWEodCxlLHUsZCxpKSl9cmV0dXJuIG59X3VucHJvamVjdCh0LGUsaT0yMDApe3JldHVybiB0Lm1hcCgodD0+ZS51bnByb2plY3RCYXNpYyh0LGkpKSl9X2NyZWF0ZUNhbWVyYSh0LGUsaSl7Y29uc3Qgbj1uZXcgTnM7cmV0dXJuIG4udXAuY29weSgobmV3IGZuKS5mcm9tQXJyYXkodCkpLG4ucG9zaXRpb24uY29weSgobmV3IGZuKS5mcm9tQXJyYXkoZSkpLG4ubG9va0F0KChuZXcgZm4pLmZyb21BcnJheShpKSksbi51cGRhdGVNYXRyaXgoKSxuLnVwZGF0ZU1hdHJpeFdvcmxkKCEwKSxufV9kZXVucHJvamVjdCh0LGUsaSl7cmV0dXJuIHQubWFwKCh0PT57Y29uc3Qgbj1lLnVucHJvamVjdEJhc2ljKHQsMWU0KSxyPW5ldyBmbihuWzBdLG5bMV0sblsyXSkuYXBwbHlNYXRyaXg0KGkubWF0cml4V29ybGRJbnZlcnNlKTtyZXR1cm5bci54L3IueixyLnkvci56XX0pKX1fdHJpYW5ndWxhdGVTdWJhcmVhKHQsZSxpLG4scil7Y29uc3Qgcz1WXyhbdCwuLi5lXSxbaV0sMCk7aWYoIXMpcmV0dXJuW107Y29uc3Qgbz1bXSxhPXRoaXMuX3N1YnNhbXBsZVRocmVzaG9sZCxjPXRoaXMuX2NyZWF0ZUNhbWVyYShyLnVwVmVjdG9yKCkudG9BcnJheSgpLHIudW5wcm9qZWN0U2ZNKFswLDBdLDApLHIudW5wcm9qZWN0QmFzaWMobiwxMCkpO2Zvcihjb25zdCB0IG9mIHMpe2NvbnN0IGU9dGhpcy5fc3Vic2FtcGxlKHRbMF0sYSksaT10aGlzLl9kZXVucHJvamVjdChlLHIsYyksbj10aGlzLl91bnByb2plY3QoZSxyKSxzPVtdLGg9W107Zm9yKGxldCBlPTE7ZTx0Lmxlbmd0aDtlKyspe2xldCBpPXRoaXMuX3N1YnNhbXBsZSh0W2VdLGEpO2NvbnN0IG49dGhpcy5fZGV1bnByb2plY3QoaSxyLGMpLG89dGhpcy5fdW5wcm9qZWN0KGkscik7cy5wdXNoKG4pLGgucHVzaChvKX1vLnB1c2goLi4udGhpcy5fdHJpYW5ndWxhdGUoaSxuLHMsaCkpfXJldHVybiBvfX1jbGFzcyBxXyBleHRlbmRzIEdfe2NvbnN0cnVjdG9yKHQpe2lmKHN1cGVyKCksNCE9PXQubGVuZ3RoKXRocm93IG5ldyB3ZyhcIlJlY3RhbmdsZSBuZWVkcyB0byBoYXZlIGZvdXIgdmFsdWVzLlwiKTtpZih0WzFdPnRbM10pdGhyb3cgbmV3IHdnKFwiQmFzaWMgWSBjb29yZGluYXRlcyB2YWx1ZXMgY2FuIG5vdCBiZSBpbnZlcnRlZC5cIik7Zm9yKGxldCBlIG9mIHQpaWYoZTwwfHxlPjEpdGhyb3cgbmV3IHdnKFwiQmFzaWMgY29vcmRpbmF0ZXMgbXVzdCBiZSBvbiB0aGUgaW50ZXJ2YWwgWzAsIDFdLlwiKTt0aGlzLl9hbmNob3JJbmRleD12b2lkIDAsdGhpcy5fcmVjdD10LnNsaWNlKDAsNCksdGhpcy5faW52ZXJ0ZWQ9dGhpcy5fcmVjdFswXT50aGlzLl9yZWN0WzJdfWdldCBhbmNob3JJbmRleCgpe3JldHVybiB0aGlzLl9hbmNob3JJbmRleH1nZXQgaW52ZXJ0ZWQoKXtyZXR1cm4gdGhpcy5faW52ZXJ0ZWR9Z2V0IHJlY3QoKXtyZXR1cm4gdGhpcy5fcmVjdH1pbml0aWFsaXplQW5jaG9ySW5kZXhpbmcodCl7aWYodm9pZCAwIT09dGhpcy5fYW5jaG9ySW5kZXgpdGhyb3cgbmV3IHdnKFwiQW5jaG9yIGluZGV4aW5nIGlzIGFscmVhZHkgaW5pdGlhbGl6ZWQuXCIpO2lmKHQ8MHx8dD4zKXRocm93IG5ldyB3ZyhgSW52YWxpZCBhbmNob3IgaW5kZXg6ICR7dH0uYCk7dGhpcy5fYW5jaG9ySW5kZXg9dm9pZCAwPT09dD8wOnR9dGVybWluYXRlQW5jaG9ySW5kZXhpbmcoKXt0aGlzLl9hbmNob3JJbmRleD12b2lkIDB9c2V0T3Bwb3NpdGVWZXJ0ZXgyZCh0LGUpe2lmKHZvaWQgMD09PXRoaXMuX2FuY2hvckluZGV4KXRocm93IG5ldyB3ZyhcIkFuY2hvciBpbmRleGluZyBuZWVkcyB0byBiZSBpbml0aWFsaXplZC5cIik7Y29uc3QgaT1bTWF0aC5tYXgoMCxNYXRoLm1pbigxLHRbMF0pKSxNYXRoLm1heCgwLE1hdGgubWluKDEsdFsxXSkpXSxuPXRoaXMuX3JlY3Quc2xpY2UoKSxyPTA9PT10aGlzLl9hbmNob3JJbmRleD9bblswXSxuWzNdXToxPT09dGhpcy5fYW5jaG9ySW5kZXg/W25bMF0sblsxXV06Mj09PXRoaXMuX2FuY2hvckluZGV4P1tuWzJdLG5bMV1dOltuWzJdLG5bM11dO2lmKGRkKGUuY2FtZXJhVHlwZSkpe2NvbnN0IHQ9dGhpcy5fYW5jaG9ySW5kZXg8Mj9pWzBdLW5bMl06aVswXS1uWzBdOyF0aGlzLl9pbnZlcnRlZCYmdGhpcy5fYW5jaG9ySW5kZXg8MiYmaVswXTwuMjUmJm5bMl0+Ljc1JiZ0PC0uNXx8IXRoaXMuX2ludmVydGVkJiZ0aGlzLl9hbmNob3JJbmRleD49MiYmaVswXTwuMjUmJm5bMl0+Ljc1JiZ0PC0uNT8odGhpcy5faW52ZXJ0ZWQ9ITAsdGhpcy5fYW5jaG9ySW5kZXg9clsxXT5pWzFdPzA6MSk6dGhpcy5faW52ZXJ0ZWQmJnRoaXMuX2FuY2hvckluZGV4Pj0yJiZpWzBdPC4yNSYmblswXT4uNzUmJnQ8LS41Pyh0aGlzLl9pbnZlcnRlZD0hMSx0aGlzLl9hbmNob3JJbmRleD1yWzBdPmlbMF0/clsxXT5pWzFdPzM6MjpyWzFdPmlbMV0/MDoxKTohdGhpcy5faW52ZXJ0ZWQmJnRoaXMuX2FuY2hvckluZGV4Pj0yJiZpWzBdPi43NSYmblswXTwuMjUmJnQ+LjV8fCF0aGlzLl9pbnZlcnRlZCYmdGhpcy5fYW5jaG9ySW5kZXg8MiYmaVswXT4uNzUmJm5bMF08LjI1JiZ0Pi41Pyh0aGlzLl9pbnZlcnRlZD0hMCx0aGlzLl9hbmNob3JJbmRleD1yWzFdPmlbMV0/MzoyKTp0aGlzLl9pbnZlcnRlZCYmdGhpcy5fYW5jaG9ySW5kZXg8MiYmaVswXT4uNzUmJm5bMl08LjI1JiZ0Pi41Pyh0aGlzLl9pbnZlcnRlZD0hMSx0aGlzLl9hbmNob3JJbmRleD1yWzBdPmlbMF0/clsxXT5pWzFdPzM6MjpyWzFdPmlbMV0/MDoxKTp0aGlzLl9pbnZlcnRlZCYmdGhpcy5fYW5jaG9ySW5kZXg8MiYmaVswXT5uWzBdPyh0aGlzLl9pbnZlcnRlZD0hMSx0aGlzLl9hbmNob3JJbmRleD1yWzFdPmlbMV0/MDoxKTp0aGlzLl9pbnZlcnRlZCYmdGhpcy5fYW5jaG9ySW5kZXg+PTImJmlbMF08blsyXT8odGhpcy5faW52ZXJ0ZWQ9ITEsdGhpcy5fYW5jaG9ySW5kZXg9clsxXT5pWzFdPzM6Mik6dGhpcy5faW52ZXJ0ZWQ/dGhpcy5fYW5jaG9ySW5kZXg8Mj90aGlzLl9hbmNob3JJbmRleD1yWzFdPmlbMV0/MDoxOnRoaXMuX2FuY2hvckluZGV4PXJbMV0+aVsxXT8zOjI6dGhpcy5fYW5jaG9ySW5kZXg9clswXTw9aVswXSYmclsxXT5pWzFdPzA6clswXTw9aVswXSYmclsxXTw9aVsxXT8xOnJbMF0+aVswXSYmclsxXTw9aVsxXT8yOjM7Y29uc3QgZT1bXTswPT09dGhpcy5fYW5jaG9ySW5kZXg/KGVbMF09clswXSxlWzFdPWlbMV0sZVsyXT1pWzBdLGVbM109clsxXSk6MT09PXRoaXMuX2FuY2hvckluZGV4PyhlWzBdPXJbMF0sZVsxXT1yWzFdLGVbMl09aVswXSxlWzNdPWlbMV0pOjI9PT10aGlzLl9hbmNob3JJbmRleD8oZVswXT1pWzBdLGVbMV09clsxXSxlWzJdPXJbMF0sZVszXT1pWzFdKTooZVswXT1pWzBdLGVbMV09aVsxXSxlWzJdPXJbMF0sZVszXT1yWzFdKSwoIXRoaXMuX2ludmVydGVkJiZlWzBdPmVbMl18fHRoaXMuX2ludmVydGVkJiZlWzBdPGVbMl0pJiYoZVswXT1uWzBdLGVbMl09blsyXSksZVsxXT5lWzNdJiYoZVsxXT1uWzFdLGVbM109blszXSksdGhpcy5fcmVjdFswXT1lWzBdLHRoaXMuX3JlY3RbMV09ZVsxXSx0aGlzLl9yZWN0WzJdPWVbMl0sdGhpcy5fcmVjdFszXT1lWzNdfWVsc2V7dGhpcy5fYW5jaG9ySW5kZXg9clswXTw9aVswXSYmclsxXT5pWzFdPzA6clswXTw9aVswXSYmclsxXTw9aVsxXT8xOnJbMF0+aVswXSYmclsxXTw9aVsxXT8yOjM7Y29uc3QgdD1bXTswPT09dGhpcy5fYW5jaG9ySW5kZXg/KHRbMF09clswXSx0WzFdPWlbMV0sdFsyXT1pWzBdLHRbM109clsxXSk6MT09PXRoaXMuX2FuY2hvckluZGV4Pyh0WzBdPXJbMF0sdFsxXT1yWzFdLHRbMl09aVswXSx0WzNdPWlbMV0pOjI9PT10aGlzLl9hbmNob3JJbmRleD8odFswXT1pWzBdLHRbMV09clsxXSx0WzJdPXJbMF0sdFszXT1pWzFdKToodFswXT1pWzBdLHRbMV09aVsxXSx0WzJdPXJbMF0sdFszXT1yWzFdKSx0WzBdPnRbMl0mJih0WzBdPW5bMF0sdFsyXT1uWzJdKSx0WzFdPnRbM10mJih0WzFdPW5bMV0sdFszXT1uWzNdKSx0aGlzLl9yZWN0WzBdPXRbMF0sdGhpcy5fcmVjdFsxXT10WzFdLHRoaXMuX3JlY3RbMl09dFsyXSx0aGlzLl9yZWN0WzNdPXRbM119dGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1zZXRWZXJ0ZXgyZCh0LGUsaSl7bGV0IG49dGhpcy5fcmVjdC5zbGljZSgpLHI9W01hdGgubWF4KDAsTWF0aC5taW4oMSxlWzBdKSksTWF0aC5tYXgoMCxNYXRoLm1pbigxLGVbMV0pKV0scz1bXTtpZigwPT09dD8oc1swXT1yWzBdLHNbMV09blsxXSxzWzJdPW5bMl0sc1szXT1yWzFdKToxPT09dD8oc1swXT1yWzBdLHNbMV09clsxXSxzWzJdPW5bMl0sc1szXT1uWzNdKToyPT09dD8oc1swXT1uWzBdLHNbMV09clsxXSxzWzJdPXJbMF0sc1szXT1uWzNdKTozPT09dCYmKHNbMF09blswXSxzWzFdPW5bMV0sc1syXT1yWzBdLHNbM109clsxXSksZGQoaS5jYW1lcmFUeXBlKSl7bGV0IGU9dDwyJiZyWzBdPi43NSYmblswXTwuMjV8fHQ+PTImJnRoaXMuX2ludmVydGVkJiZyWzBdPi43NSYmblsyXTwuMjUsaT10PDImJnRoaXMuX2ludmVydGVkJiZyWzBdPC4yNSYmblswXT4uNzV8fHQ+PTImJnJbMF08LjI1JiZuWzJdPi43NTtlfHxpP3RoaXMuX2ludmVydGVkPSF0aGlzLl9pbnZlcnRlZDooc1swXS1uWzBdPC0uMjUmJihzWzBdPW5bMF0pLHNbMl0tblsyXT4uMjUmJihzWzJdPW5bMl0pKSwoIXRoaXMuX2ludmVydGVkJiZzWzBdPnNbMl18fHRoaXMuX2ludmVydGVkJiZzWzBdPHNbMl0pJiYoc1swXT1uWzBdLHNbMl09blsyXSl9ZWxzZSBzWzBdPnNbMl0mJihzWzBdPW5bMF0sc1syXT1uWzJdKTtzWzFdPnNbM10mJihzWzFdPW5bMV0sc1szXT1uWzNdKSx0aGlzLl9yZWN0WzBdPXNbMF0sdGhpcy5fcmVjdFsxXT1zWzFdLHRoaXMuX3JlY3RbMl09c1syXSx0aGlzLl9yZWN0WzNdPXNbM10sdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1zZXRDZW50cm9pZDJkKHQsZSl7bGV0IGk9dGhpcy5fcmVjdC5zbGljZSgpLG49aVswXSxyPXRoaXMuX2ludmVydGVkP2lbMl0rMTppWzJdLHM9aVsxXSxvPWlbM10sYT1uKyhyLW4pLzIsYz1zKyhvLXMpLzIsaD0wO2lmKGRkKGUuY2FtZXJhVHlwZSkpaD10aGlzLl9pbnZlcnRlZD90WzBdKzEtYTp0WzBdLWE7ZWxzZXtsZXQgZT0tbixpPTEtcjtoPU1hdGgubWF4KGUsTWF0aC5taW4oaSx0WzBdLWEpKX1sZXQgbD0tcyx1PTEtbyxkPU1hdGgubWF4KGwsTWF0aC5taW4odSx0WzFdLWMpKTt0aGlzLl9yZWN0WzBdPWlbMF0raCx0aGlzLl9yZWN0WzFdPWlbMV0rZCx0aGlzLl9yZWN0WzJdPWlbMl0raCx0aGlzLl9yZWN0WzNdPWlbM10rZCx0aGlzLl9yZWN0WzBdPDA/KHRoaXMuX3JlY3RbMF0rPTEsdGhpcy5faW52ZXJ0ZWQ9IXRoaXMuX2ludmVydGVkKTp0aGlzLl9yZWN0WzBdPjEmJih0aGlzLl9yZWN0WzBdLT0xLHRoaXMuX2ludmVydGVkPSF0aGlzLl9pbnZlcnRlZCksdGhpcy5fcmVjdFsyXTwwPyh0aGlzLl9yZWN0WzJdKz0xLHRoaXMuX2ludmVydGVkPSF0aGlzLl9pbnZlcnRlZCk6dGhpcy5fcmVjdFsyXT4xJiYodGhpcy5fcmVjdFsyXS09MSx0aGlzLl9pbnZlcnRlZD0hdGhpcy5faW52ZXJ0ZWQpLHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0UG9pbnRzM2QodCl7cmV0dXJuIHRoaXMuX2dldFBvaW50czJkKCkubWFwKChlPT50LnVucHJvamVjdEJhc2ljKGUsMjAwKSkpfWdldFZlcnRleDJkKHQpe3JldHVybiB0aGlzLl9yZWN0VG9WZXJ0aWNlczJkKHRoaXMuX3JlY3QpW3RdfWdldE5vbkFkanVzdGVkVmVydGV4MmQodCl7cmV0dXJuIHRoaXMuX3JlY3RUb05vbkFkanVzdGVkVmVydGljZXMyZCh0aGlzLl9yZWN0KVt0XX1nZXRWZXJ0ZXgzZCh0LGUpe3JldHVybiBlLnVucHJvamVjdEJhc2ljKHRoaXMuX3JlY3RUb1ZlcnRpY2VzMmQodGhpcy5fcmVjdClbdF0sMjAwKX1nZXRWZXJ0aWNlczJkKCl7cmV0dXJuIHRoaXMuX3JlY3RUb1ZlcnRpY2VzMmQodGhpcy5fcmVjdCl9Z2V0VmVydGljZXMzZCh0KXtyZXR1cm4gdGhpcy5fcmVjdFRvVmVydGljZXMyZCh0aGlzLl9yZWN0KS5tYXAoKGU9PnQudW5wcm9qZWN0QmFzaWMoZSwyMDApKSl9Z2V0Q2VudHJvaWQyZCgpe2NvbnN0IHQ9dGhpcy5fcmVjdDtyZXR1cm5bKHRbMF0rKHRoaXMuX2ludmVydGVkP3RbMl0rMTp0WzJdKSkvMiwodFsxXSt0WzNdKS8yXX1nZXRDZW50cm9pZDNkKHQpe2NvbnN0IGU9dGhpcy5nZXRDZW50cm9pZDJkKCk7cmV0dXJuIHQudW5wcm9qZWN0QmFzaWMoZSwyMDApfWdldFBvbGVPZkluYWNjZXNzaWJpbGl0eTJkKCl7cmV0dXJuIHRoaXMuX2dldFBvbGVPZkluYWNjZXNzaWJpbGl0eTJkKHRoaXMuX3JlY3RUb1ZlcnRpY2VzMmQodGhpcy5fcmVjdCkpfWdldFBvbGVPZkluYWNjZXNzaWJpbGl0eTNkKHQpe2xldCBlPXRoaXMuX2dldFBvbGVPZkluYWNjZXNzaWJpbGl0eTJkKHRoaXMuX3JlY3RUb1ZlcnRpY2VzMmQodGhpcy5fcmVjdCkpO3JldHVybiB0LnVucHJvamVjdEJhc2ljKGUsMjAwKX1nZXRUcmlhbmdsZXMzZCh0KXtyZXR1cm4gZGQodC5jYW1lcmFUeXBlKT9bXTp0aGlzLl90cmlhbmd1bGF0ZSh0aGlzLl9wcm9qZWN0KHRoaXMuX2dldFBvaW50czJkKCksdCksdGhpcy5nZXRQb2ludHMzZCh0KSl9dmFsaWRhdGUodCl7bGV0IGU9dGhpcy5fcmVjdDtyZXR1cm4hKCF0aGlzLl9pbnZlcnRlZCYmdFswXTxlWzBdfHx0WzBdLWVbMl0+LjI1fHx0WzFdPGVbMV0pfV9nZXRQb2ludHMyZCgpe2xldCB0PXRoaXMuX3JlY3RUb1ZlcnRpY2VzMmQodGhpcy5fcmVjdCksZT10Lmxlbmd0aC0xLGk9W107Zm9yKGxldCBuPTA7bjxlOysrbil7bGV0IGU9dFtuXVswXSxyPXRbbl1bMV0scz0odFtuKzFdWzBdLWUpLzksbz0odFtuKzFdWzFdLXIpLzk7Zm9yKGxldCB0PTA7dDwxMDsrK3Qpe2xldCBuPVtlK3QqcyxyK3Qqb107aS5wdXNoKG4pfX1yZXR1cm4gaX1fcmVjdFRvVmVydGljZXMyZCh0KXtyZXR1cm5bW3RbMF0sdFszXV0sW3RbMF0sdFsxXV0sW3RoaXMuX2ludmVydGVkP3RbMl0rMTp0WzJdLHRbMV1dLFt0aGlzLl9pbnZlcnRlZD90WzJdKzE6dFsyXSx0WzNdXSxbdFswXSx0WzNdXV19X3JlY3RUb05vbkFkanVzdGVkVmVydGljZXMyZCh0KXtyZXR1cm5bW3RbMF0sdFszXV0sW3RbMF0sdFsxXV0sW3RbMl0sdFsxXV0sW3RbMl0sdFszXV0sW3RbMF0sdFszXV1dfX1jbGFzcyBXXyBleHRlbmRzIE1ne2NvbnN0cnVjdG9yKHQsZSxpLG4pe3N1cGVyKHQsaSxuKSx0aGlzLl9vcHRpb25zPXtjb2xvcjpudWxsPT1lLmNvbG9yPzE2Nzc3MjE1OmUuY29sb3IsaW5kaWNhdGVDb21wbGV0ZXI6bnVsbD09ZS5pbmRpY2F0ZUNvbXBsZXRlcnx8ZS5pbmRpY2F0ZUNvbXBsZXRlcn0sdGhpcy5fcmVjdEdlb21ldHJ5PW5ldyBxXyh0aGlzLl9nZW9tZXRyeS5nZXRSZWN0MmQoaSkpLHRoaXMuX2NyZWF0ZUdsT2JqZWN0cygpfWNyZWF0ZSgpe3RoaXMuX2dlb21ldHJ5LnBvaW50cy5sZW5ndGg8M3x8KHRoaXMuX2dlb21ldHJ5LnJlbW92ZVBvaW50MmQodGhpcy5fZ2VvbWV0cnkucG9pbnRzLmxlbmd0aC0xKSx0aGlzLl9jcmVhdGVkJC5uZXh0KHRoaXMpKX1kaXNwb3NlKCl7c3VwZXIuZGlzcG9zZSgpLHRoaXMuX2Rpc3Bvc2VPYmplY3RzKCl9Z2V0RE9NT2JqZWN0cyh0LGUpe2NvbnN0IGk9e29mZnNldEhlaWdodDplLmhlaWdodCxvZmZzZXRXaWR0aDplLndpZHRofSxuPVtdLHI9dGhpcy5fZ2VvbWV0cnkuZ2V0UG9pbnRzMmQoKSxzPXIubGVuZ3RoO2ZvcihsZXQgZT0wO2U8cy0xO2UrKyl7Y29uc3Qgbz1lLFthLGNdPXJbZV0saD10aGlzLl92aWV3cG9ydENvb3Jkcy5iYXNpY1RvQ2FudmFzU2FmZShhLGMsaSx0aGlzLl90cmFuc2Zvcm0sdCk7aWYoIWgpY29udGludWU7Y29uc3QgbD10PT57dC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLl9hYm9ydGVkJC5uZXh0KHRoaXMpfSx1PXQ9Pnt0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMuX2dlb21ldHJ5LnJlbW92ZVBvaW50MmQobyl9LGQ9dGhpcy5fY2FudmFzVG9UcmFuc2Zvcm0oaCkscD17b25jbGljazowPT09ZSYmczwzP2w6dSxzdHlsZTp7dHJhbnNmb3JtOmR9fTtuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLWludGVyYWN0b3JcIixwLFtdKSk7Y29uc3QgZj17c3R5bGU6e2JhY2tncm91bmQ6dGhpcy5fY29sb3JUb0JhY2tncm91bmQodGhpcy5fb3B0aW9ucy5jb2xvciksdHJhbnNmb3JtOmR9fTtuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLXZlcnRleFwiLGYsW10pKX1pZihzPjImJiEwPT09dGhpcy5fb3B0aW9ucy5pbmRpY2F0ZUNvbXBsZXRlcil7Y29uc3RbZSxyXT10aGlzLl9nZW9tZXRyeS5nZXRDZW50cm9pZDJkKHRoaXMuX3RyYW5zZm9ybSkscz10aGlzLl92aWV3cG9ydENvb3Jkcy5iYXNpY1RvQ2FudmFzU2FmZShlLHIsaSx0aGlzLl90cmFuc2Zvcm0sdCk7aWYocyl7Y29uc3QgdD10PT57dC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLl9nZW9tZXRyeS5yZW1vdmVQb2ludDJkKHRoaXMuX2dlb21ldHJ5LnBvaW50cy5sZW5ndGgtMSksdGhpcy5fY3JlYXRlZCQubmV4dCh0aGlzKX0sZT10aGlzLl9jYW52YXNUb1RyYW5zZm9ybShzKSxpPXtvbmNsaWNrOnQsc3R5bGU6e3RyYW5zZm9ybTplfX07bi5wdXNoKGpmLmgoXCJkaXYubWFwaWxsYXJ5LXRhZy1jb21wbGV0ZXIubWFwaWxsYXJ5LXRhZy1sYXJnZXJcIixpLFtdKSk7Y29uc3Qgcj17c3R5bGU6e2JhY2tncm91bmQ6dGhpcy5fY29sb3JUb0JhY2tncm91bmQodGhpcy5fb3B0aW9ucy5jb2xvciksdHJhbnNmb3JtOmV9fTtuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLXZlcnRleC5tYXBpbGxhcnktdGFnLWxhcmdlclwiLHIsW10pKTtjb25zdCBvPXtzdHlsZTp7dHJhbnNmb3JtOmV9fTtuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLWRvdFwiLG8sW10pKX19cmV0dXJuIG59X29uR2VvbWV0cnlDaGFuZ2VkKCl7dGhpcy5fZGlzcG9zZU9iamVjdHMoKSx0aGlzLl9yZWN0R2VvbWV0cnk9bmV3IHFfKHRoaXMuX2dlb21ldHJ5LmdldFJlY3QyZCh0aGlzLl90cmFuc2Zvcm0pKSx0aGlzLl9jcmVhdGVHbE9iamVjdHMoKX1fY3JlYXRlR2xPYmplY3RzKCl7dGhpcy5fZ2xPYmplY3RzPVtdO2NvbnN0IHQ9dGhpcy5fcmVjdEdlb21ldHJ5LmdldFBvaW50czNkKHRoaXMuX3RyYW5zZm9ybSk7dGhpcy5fb3V0bGluZT10aGlzLl9jcmVhdGVPdXRpbmUodCx0aGlzLl9vcHRpb25zLmNvbG9yKSx0aGlzLl9nbE9iamVjdHMucHVzaCh0aGlzLl9vdXRsaW5lKX1fZGlzcG9zZU9iamVjdHMoKXt0aGlzLl9kaXNwb3NlTGluZSh0aGlzLl9vdXRsaW5lKSx0aGlzLl9vdXRsaW5lPW51bGwsdGhpcy5fZ2xPYmplY3RzPW51bGx9fWNsYXNzIFhfIGV4dGVuZHMgR197Y29uc3RydWN0b3IodCxlKXtzdXBlcigpO2xldCBpPXQubGVuZ3RoO2lmKGk8Myl0aHJvdyBuZXcgd2coXCJBIHBvbHlnb24gbXVzdCBoYXZlIHRocmVlIG9yIG1vcmUgcG9zaXRpb25zLlwiKTtpZih0WzBdWzBdIT09dFtpLTFdWzBdfHx0WzBdWzFdIT09dFtpLTFdWzFdKXRocm93IG5ldyB3ZyhcIkZpcnN0IGFuZCBsYXN0IHBvc2l0aW9ucyBtdXN0IGJlIGVxdWl2YWxlbnQuXCIpO3RoaXMuX3BvbHlnb249W107Zm9yKGxldCBlIG9mIHQpe2lmKGVbMF08MHx8ZVswXT4xfHxlWzFdPDB8fGVbMV0+MSl0aHJvdyBuZXcgd2coXCJCYXNpYyBjb29yZGluYXRlcyBvZiBwb2x5Z29uIG11c3QgYmUgb24gdGhlIGludGVydmFsIFswLCAxXS5cIik7dGhpcy5fcG9seWdvbi5wdXNoKGUuc2xpY2UoKSl9aWYodGhpcy5faG9sZXM9W10sbnVsbCE9ZSlmb3IobGV0IHQ9MDt0PGUubGVuZ3RoO3QrKyl7bGV0IGk9ZVt0XSxuPWkubGVuZ3RoO2lmKG48Myl0aHJvdyBuZXcgd2coXCJBIHBvbHlnb24gaG9sZSBtdXN0IGhhdmUgdGhyZWUgb3IgbW9yZSBwb3NpdGlvbnMuXCIpO2lmKGlbMF1bMF0hPT1pW24tMV1bMF18fGlbMF1bMV0hPT1pW24tMV1bMV0pdGhyb3cgbmV3IHdnKFwiRmlyc3QgYW5kIGxhc3QgcG9zaXRpb25zIG9mIGhvbGUgbXVzdCBiZSBlcXVpdmFsZW50LlwiKTt0aGlzLl9ob2xlcy5wdXNoKFtdKTtmb3IobGV0IGUgb2YgaSl7aWYoZVswXTwwfHxlWzBdPjF8fGVbMV08MHx8ZVsxXT4xKXRocm93IG5ldyB3ZyhcIkJhc2ljIGNvb3JkaW5hdGVzIG9mIGhvbGUgbXVzdCBiZSBvbiB0aGUgaW50ZXJ2YWwgWzAsIDFdLlwiKTt0aGlzLl9ob2xlc1t0XS5wdXNoKGUuc2xpY2UoKSl9fX1nZXQgcG9seWdvbigpe3JldHVybiB0aGlzLl9wb2x5Z29ufWdldCBob2xlcygpe3JldHVybiB0aGlzLl9ob2xlc31hZGRWZXJ0ZXgyZCh0KXtsZXQgZT1bTWF0aC5tYXgoMCxNYXRoLm1pbigxLHRbMF0pKSxNYXRoLm1heCgwLE1hdGgubWluKDEsdFsxXSkpXTt0aGlzLl9wb2x5Z29uLnNwbGljZSh0aGlzLl9wb2x5Z29uLmxlbmd0aC0xLDAsZSksdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXRWZXJ0ZXgyZCh0KXtyZXR1cm4gdGhpcy5fcG9seWdvblt0XS5zbGljZSgpfXJlbW92ZVZlcnRleDJkKHQpe2lmKHQ8MHx8dD49dGhpcy5fcG9seWdvbi5sZW5ndGh8fHRoaXMuX3BvbHlnb24ubGVuZ3RoPDQpdGhyb3cgbmV3IHdnKFwiSW5kZXggZm9yIHJlbW92ZWQgdmVydGV4IG11c3QgYmUgdmFsaWQuXCIpO2lmKHQ+MCYmdDx0aGlzLl9wb2x5Z29uLmxlbmd0aC0xKXRoaXMuX3BvbHlnb24uc3BsaWNlKHQsMSk7ZWxzZXt0aGlzLl9wb2x5Z29uLnNwbGljZSgwLDEpLHRoaXMuX3BvbHlnb24ucG9wKCk7bGV0IHQ9dGhpcy5fcG9seWdvblswXS5zbGljZSgpO3RoaXMuX3BvbHlnb24ucHVzaCh0KX10aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfXNldFZlcnRleDJkKHQsZSxpKXtsZXQgbj1bTWF0aC5tYXgoMCxNYXRoLm1pbigxLGVbMF0pKSxNYXRoLm1heCgwLE1hdGgubWluKDEsZVsxXSkpXTswPT09dHx8dD09PXRoaXMuX3BvbHlnb24ubGVuZ3RoLTE/KHRoaXMuX3BvbHlnb25bMF09bi5zbGljZSgpLHRoaXMuX3BvbHlnb25bdGhpcy5fcG9seWdvbi5sZW5ndGgtMV09bi5zbGljZSgpKTp0aGlzLl9wb2x5Z29uW3RdPW4uc2xpY2UoKSx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfXNldENlbnRyb2lkMmQodCxlKXtsZXQgaT10aGlzLl9wb2x5Z29uLm1hcCgodD0+dFswXSkpLG49dGhpcy5fcG9seWdvbi5tYXAoKHQ9PnRbMV0pKSxyPU1hdGgubWluLmFwcGx5KE1hdGgsaSkscz1NYXRoLm1heC5hcHBseShNYXRoLGkpLG89TWF0aC5taW4uYXBwbHkoTWF0aCxuKSxhPU1hdGgubWF4LmFwcGx5KE1hdGgsbiksYz10aGlzLmdldENlbnRyb2lkMmQoKSxoPS1yLGw9MS1zLHU9LW8sZD0xLWEscD1NYXRoLm1heChoLE1hdGgubWluKGwsdFswXS1jWzBdKSksZj1NYXRoLm1heCh1LE1hdGgubWluKGQsdFsxXS1jWzFdKSk7Zm9yKGxldCB0IG9mIHRoaXMuX3BvbHlnb24pdFswXSs9cCx0WzFdKz1mO3RoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0UG9pbnRzM2QodCl7cmV0dXJuIHRoaXMuX2dldFBvaW50czNkKHRoaXMuX3N1YnNhbXBsZSh0aGlzLl9wb2x5Z29uKSx0KX1nZXRWZXJ0ZXgzZCh0LGUpe3JldHVybiBlLnVucHJvamVjdEJhc2ljKHRoaXMuX3BvbHlnb25bdF0sMjAwKX1nZXRWZXJ0aWNlczJkKCl7cmV0dXJuIHRoaXMuX3BvbHlnb24uc2xpY2UoKX1nZXRWZXJ0aWNlczNkKHQpe3JldHVybiB0aGlzLl9nZXRQb2ludHMzZCh0aGlzLl9wb2x5Z29uLHQpfWdldEhvbGVQb2ludHMzZCh0KXtyZXR1cm4gdGhpcy5faG9sZXMubWFwKChlPT50aGlzLl9nZXRQb2ludHMzZCh0aGlzLl9zdWJzYW1wbGUoZSksdCkpKX1nZXRIb2xlVmVydGljZXMzZCh0KXtyZXR1cm4gdGhpcy5faG9sZXMubWFwKChlPT50aGlzLl9nZXRQb2ludHMzZChlLHQpKSl9Z2V0Q2VudHJvaWQyZCgpe2xldCB0PXRoaXMuX3BvbHlnb24sZT0wLGk9MCxuPTA7Zm9yKGxldCByPTA7cjx0Lmxlbmd0aC0xO3IrKyl7bGV0IHM9dFtyXVswXSxvPXRbcl1bMV0sYT10W3IrMV1bMF0sYz10W3IrMV1bMV0saD1zKmMtYSpvO2UrPWgsaSs9KHMrYSkqaCxuKz0obytjKSpofXJldHVybiBlLz0yLGkvPTYqZSxuLz02KmUsW2ksbl19Z2V0Q2VudHJvaWQzZCh0KXtsZXQgZT10aGlzLmdldENlbnRyb2lkMmQoKTtyZXR1cm4gdC51bnByb2plY3RCYXNpYyhlLDIwMCl9Z2V0M2REb21haW5UcmlhbmdsZXMzZCh0KXtyZXR1cm4gdGhpcy5fdHJpYW5ndWxhdGUodGhpcy5fcHJvamVjdCh0aGlzLl9wb2x5Z29uLHQpLHRoaXMuZ2V0VmVydGljZXMzZCh0KSx0aGlzLl9ob2xlcy5tYXAoKGU9PnRoaXMuX3Byb2plY3QoZSx0KSkpLHRoaXMuZ2V0SG9sZVZlcnRpY2VzM2QodCkpfWdldFRyaWFuZ2xlczNkKHQpe2lmKGRkKHQuY2FtZXJhVHlwZSkpcmV0dXJuIHRoaXMuX3RyaWFuZ3VsYXRlU3BoZXJpY2FsKHRoaXMuX3BvbHlnb24uc2xpY2UoKSx0aGlzLmhvbGVzLnNsaWNlKCksdCk7Y29uc3QgZT10aGlzLl9wcm9qZWN0KHRoaXMuX3N1YnNhbXBsZSh0aGlzLl9wb2x5Z29uKSx0KSxpPXRoaXMuZ2V0UG9pbnRzM2QodCksbj10aGlzLl9ob2xlcy5tYXAoKGU9PnRoaXMuX3Byb2plY3QodGhpcy5fc3Vic2FtcGxlKGUpLHQpKSkscj10aGlzLmdldEhvbGVQb2ludHMzZCh0KTtyZXR1cm4gdGhpcy5fdHJpYW5ndWxhdGUoZSxpLG4scil9Z2V0UG9sZU9mSW5hY2Nlc3NpYmlsaXR5MmQoKXtyZXR1cm4gdGhpcy5fZ2V0UG9sZU9mSW5hY2Nlc3NpYmlsaXR5MmQodGhpcy5fcG9seWdvbi5zbGljZSgpKX1nZXRQb2xlT2ZJbmFjY2Vzc2liaWxpdHkzZCh0KXtsZXQgZT10aGlzLl9nZXRQb2xlT2ZJbmFjY2Vzc2liaWxpdHkyZCh0aGlzLl9wb2x5Z29uLnNsaWNlKCkpO3JldHVybiB0LnVucHJvamVjdEJhc2ljKGUsMjAwKX1fZ2V0UG9pbnRzM2QodCxlKXtyZXR1cm4gdC5tYXAoKHQ9PmUudW5wcm9qZWN0QmFzaWModCwyMDApKSl9fWNsYXNzIFlfIGV4dGVuZHMgTWd7Y29uc3RydWN0b3IodCxlLGksbil7c3VwZXIodCxpLG4pLHRoaXMuX29wdGlvbnM9e2NvbG9yOm51bGw9PWUuY29sb3I/MTY3NzcyMTU6ZS5jb2xvcn0sdGhpcy5fY3JlYXRlR2xPYmplY3RzKCl9Y3JlYXRlKCl7aWYodGhpcy5fZ2VvbWV0cnkgaW5zdGFuY2VvZiBxXyl0aGlzLl9jcmVhdGVkJC5uZXh0KHRoaXMpO2Vsc2UgaWYodGhpcy5fZ2VvbWV0cnkgaW5zdGFuY2VvZiBYXyl7Y29uc3QgdD10aGlzLl9nZW9tZXRyeTt0LnJlbW92ZVZlcnRleDJkKHQucG9seWdvbi5sZW5ndGgtMiksdGhpcy5fY3JlYXRlZCQubmV4dCh0aGlzKX19ZGlzcG9zZSgpe3N1cGVyLmRpc3Bvc2UoKSx0aGlzLl9kaXNwb3NlTGluZSh0aGlzLl9vdXRsaW5lKSx0aGlzLl9kaXNwb3NlT2JqZWN0cygpfWdldERPTU9iamVjdHModCxlKXtjb25zdCBpPVtdLG49e29mZnNldEhlaWdodDplLmhlaWdodCxvZmZzZXRXaWR0aDplLndpZHRofSxyPXQ9Pnt0LnN0b3BQcm9wYWdhdGlvbigpLHRoaXMuX2Fib3J0ZWQkLm5leHQodGhpcyl9O2lmKHRoaXMuX2dlb21ldHJ5IGluc3RhbmNlb2YgcV8pe2NvbnN0IGU9dGhpcy5fZ2VvbWV0cnkuYW5jaG9ySW5kZXgscz12b2lkIDA9PT1lPzE6ZSxbbyxhXT10aGlzLl9nZW9tZXRyeS5nZXRWZXJ0ZXgyZChzKSxjPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmJhc2ljVG9DYW52YXNTYWZlKG8sYSxuLHRoaXMuX3RyYW5zZm9ybSx0KTtpZihudWxsIT1jKXtjb25zdCB0PXRoaXMuX2NvbG9yVG9CYWNrZ3JvdW5kKHRoaXMuX29wdGlvbnMuY29sb3IpLGU9dGhpcy5fY2FudmFzVG9UcmFuc2Zvcm0oYyksbj17c3R5bGU6e2JhY2tncm91bmQ6dCx0cmFuc2Zvcm06ZX19LHM9e29uY2xpY2s6cixzdHlsZTp7dHJhbnNmb3JtOmV9fTtpLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLWludGVyYWN0b3JcIixzLFtdKSksaS5wdXNoKGpmLmgoXCJkaXYubWFwaWxsYXJ5LXRhZy12ZXJ0ZXhcIixuLFtdKSl9fWVsc2UgaWYodGhpcy5fZ2VvbWV0cnkgaW5zdGFuY2VvZiBYXyl7Y29uc3QgZT10aGlzLl9nZW9tZXRyeSxbcyxvXT1lLmdldFZlcnRleDJkKDApLGE9dGhpcy5fdmlld3BvcnRDb29yZHMuYmFzaWNUb0NhbnZhc1NhZmUocyxvLG4sdGhpcy5fdHJhbnNmb3JtLHQpO2lmKG51bGwhPWEpe2NvbnN0IHQ9e29uY2xpY2s6ZS5wb2x5Z29uLmxlbmd0aD40P3Q9Pnt0LnN0b3BQcm9wYWdhdGlvbigpLGUucmVtb3ZlVmVydGV4MmQoZS5wb2x5Z29uLmxlbmd0aC0yKSx0aGlzLl9jcmVhdGVkJC5uZXh0KHRoaXMpfTpyLHN0eWxlOnt0cmFuc2Zvcm06dGhpcy5fY2FudmFzVG9UcmFuc2Zvcm0oYSl9fSxuPWUucG9seWdvbi5sZW5ndGg+ND9cIm1hcGlsbGFyeS10YWctY29tcGxldGVyXCI6XCJtYXBpbGxhcnktdGFnLWludGVyYWN0b3JcIjtpLnB1c2goamYuaChcImRpdi5cIituLHQsW10pKX1pZihlLnBvbHlnb24ubGVuZ3RoPjMpe2NvbnN0W3Isc109ZS5nZXRWZXJ0ZXgyZChlLnBvbHlnb24ubGVuZ3RoLTMpLG89dGhpcy5fdmlld3BvcnRDb29yZHMuYmFzaWNUb0NhbnZhc1NhZmUocixzLG4sdGhpcy5fdHJhbnNmb3JtLHQpO2lmKG51bGwhPW8pe2NvbnN0IHQ9e29uY2xpY2s6dD0+e3Quc3RvcFByb3BhZ2F0aW9uKCksZS5yZW1vdmVWZXJ0ZXgyZChlLnBvbHlnb24ubGVuZ3RoLTMpfSxzdHlsZTp7dHJhbnNmb3JtOnRoaXMuX2NhbnZhc1RvVHJhbnNmb3JtKG8pfX07aS5wdXNoKGpmLmgoXCJkaXYubWFwaWxsYXJ5LXRhZy1pbnRlcmFjdG9yXCIsdCxbXSkpfX1jb25zdCBjPWUucG9seWdvbi5zbGljZSgpO2Muc3BsaWNlKC0yLDIpO2Zvcihjb25zdCBlIG9mIGMpe2NvbnN0IHI9dGhpcy5fdmlld3BvcnRDb29yZHMuYmFzaWNUb0NhbnZhc1NhZmUoZVswXSxlWzFdLG4sdGhpcy5fdHJhbnNmb3JtLHQpO2lmKG51bGwhPXIpe2NvbnN0IHQ9e3N0eWxlOntiYWNrZ3JvdW5kOnRoaXMuX2NvbG9yVG9CYWNrZ3JvdW5kKHRoaXMuX29wdGlvbnMuY29sb3IpLHRyYW5zZm9ybTp0aGlzLl9jYW52YXNUb1RyYW5zZm9ybShyKX19O2kucHVzaChqZi5oKFwiZGl2Lm1hcGlsbGFyeS10YWctdmVydGV4XCIsdCxbXSkpfX19cmV0dXJuIGl9YWRkUG9pbnQodCl7aWYodGhpcy5fZ2VvbWV0cnkgaW5zdGFuY2VvZiBxXyl7aWYoIXRoaXMuX2dlb21ldHJ5LnZhbGlkYXRlKHQpKXJldHVybjt0aGlzLl9jcmVhdGVkJC5uZXh0KHRoaXMpfWVsc2UgaWYodGhpcy5fZ2VvbWV0cnkgaW5zdGFuY2VvZiBYXyl7dGhpcy5fZ2VvbWV0cnkuYWRkVmVydGV4MmQodCl9fV9vbkdlb21ldHJ5Q2hhbmdlZCgpe3RoaXMuX2Rpc3Bvc2VMaW5lKHRoaXMuX291dGxpbmUpLHRoaXMuX2Rpc3Bvc2VPYmplY3RzKCksdGhpcy5fY3JlYXRlR2xPYmplY3RzKCl9X2Rpc3Bvc2VPYmplY3RzKCl7dGhpcy5fb3V0bGluZT1udWxsLHRoaXMuX2dsT2JqZWN0cz1bXX1fY3JlYXRlR2xPYmplY3RzKCl7Y29uc3QgdD10aGlzLl9nZW9tZXRyeSBpbnN0YW5jZW9mIHFfP3RoaXMuX2dlb21ldHJ5LmdldFBvaW50czNkKHRoaXMuX3RyYW5zZm9ybSk6dGhpcy5fZ2VvbWV0cnkuZ2V0VmVydGljZXMzZCh0aGlzLl90cmFuc2Zvcm0pO3RoaXMuX291dGxpbmU9dGhpcy5fY3JlYXRlT3V0aW5lKHQsdGhpcy5fb3B0aW9ucy5jb2xvciksdGhpcy5fZ2xPYmplY3RzPVt0aGlzLl9vdXRsaW5lXX19Y2xhc3MgWl97Y29uc3RydWN0b3IodCxlKXt0aGlzLl9jb21wb25lbnQ9dCx0aGlzLl9uYXZpZ2F0b3I9ZSx0aGlzLl90YWdPcGVyYXRpb24kPW5ldyBULHRoaXMuX2NyZWF0ZVBvaW50cyQ9bmV3IFQsdGhpcy5fY3JlYXRlUG9seWdvbiQ9bmV3IFQsdGhpcy5fY3JlYXRlUmVjdCQ9bmV3IFQsdGhpcy5fZGVsZXRlJD1uZXcgVCx0aGlzLl90YWckPXRoaXMuX3RhZ09wZXJhdGlvbiQucGlwZShMZSgoKHQsZSk9PmUodCkpLG51bGwpLFplKCkpLHRoaXMuX3JlcGxheWVkVGFnJD10aGlzLl90YWckLnBpcGUoVWUoMSksRSgpKSx0aGlzLl9yZXBsYXllZFRhZyQuc3Vic2NyaWJlKCksdGhpcy5fY3JlYXRlUG9pbnRzJC5waXBlKGJpKHRoaXMuX2NvbXBvbmVudC5jb25maWd1cmF0aW9uJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKSxydCgoKFt0LGUsaV0pPT4oKT0+e2NvbnN0IG49bmV3IFNnKFtbdFswXSx0WzFdXSxbdFswXSx0WzFdXV0pO3JldHVybiBuZXcgV18obix7Y29sb3I6ZS5jcmVhdGVDb2xvcixpbmRpY2F0ZUNvbXBsZXRlcjplLmluZGljYXRlUG9pbnRzQ29tcGxldGVyfSxpKX0pKSkuc3Vic2NyaWJlKHRoaXMuX3RhZ09wZXJhdGlvbiQpLHRoaXMuX2NyZWF0ZVJlY3QkLnBpcGUoYmkodGhpcy5fY29tcG9uZW50LmNvbmZpZ3VyYXRpb24kLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQpLHJ0KCgoW3QsZSxpXSk9PigpPT57Y29uc3Qgbj1uZXcgcV8oW3RbMF0sdFsxXSx0WzBdLHRbMV1dKTtyZXR1cm4gbmV3IFlfKG4se2NvbG9yOmUuY3JlYXRlQ29sb3J9LGkpfSkpKS5zdWJzY3JpYmUodGhpcy5fdGFnT3BlcmF0aW9uJCksdGhpcy5fY3JlYXRlUG9seWdvbiQucGlwZShiaSh0aGlzLl9jb21wb25lbnQuY29uZmlndXJhdGlvbiQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCkscnQoKChbdCxlLGldKT0+KCk9Pntjb25zdCBuPW5ldyBYXyhbW3RbMF0sdFsxXV0sW3RbMF0sdFsxXV0sW3RbMF0sdFsxXV1dKTtyZXR1cm4gbmV3IFlfKG4se2NvbG9yOmUuY3JlYXRlQ29sb3J9LGkpfSkpKS5zdWJzY3JpYmUodGhpcy5fdGFnT3BlcmF0aW9uJCksdGhpcy5fZGVsZXRlJC5waXBlKHJ0KCgoKT0+KCk9Pm51bGwpKSkuc3Vic2NyaWJlKHRoaXMuX3RhZ09wZXJhdGlvbiQpfWdldCBjcmVhdGVSZWN0JCgpe3JldHVybiB0aGlzLl9jcmVhdGVSZWN0JH1nZXQgY3JlYXRlUG9seWdvbiQoKXtyZXR1cm4gdGhpcy5fY3JlYXRlUG9seWdvbiR9Z2V0IGNyZWF0ZVBvaW50cyQoKXtyZXR1cm4gdGhpcy5fY3JlYXRlUG9pbnRzJH1nZXQgZGVsZXRlJCgpe3JldHVybiB0aGlzLl9kZWxldGUkfWdldCB0YWckKCl7cmV0dXJuIHRoaXMuX3RhZyR9Z2V0IHJlcGxheWVkVGFnJCgpe3JldHVybiB0aGlzLl9yZXBsYXllZFRhZyR9fWNsYXNzIEpfe3JlbmRlcih0LGUsaSxuLHIpe2xldCBzPVtdO2Zvcihjb25zdCBlIG9mIHQpcz1zLmNvbmNhdChlLmdldERPTU9iamVjdHMoaSxuLHIpKTtyZXR1cm4gbnVsbCE9ZSYmKHM9cy5jb25jYXQoZS5nZXRET01PYmplY3RzKG4scikpKSxqZi5oKFwiZGl2Lm1hcGlsbGFyeS10YWctY29udGFpbmVyXCIse30scyl9Y2xlYXIoKXtyZXR1cm4gamYuaChcImRpdlwiLHt9LFtdKX19Y2xhc3MgS197Y29uc3RydWN0b3IodCxlKXt0aGlzLl9jcmVhdGVUYWc9bnVsbCx0aGlzLl9uZWVkc1JlbmRlcj0hMSx0aGlzLl9yYXljYXN0ZXI9ZXx8bmV3IEJ1LHRoaXMuX3NjZW5lPXR8fG5ldyBRYSx0aGlzLl9vYmplY3RUYWdzPXt9LHRoaXMuX3JldHJpZXZhYmxlT2JqZWN0cz1bXSx0aGlzLl90YWdzPXt9fWdldCBuZWVkc1JlbmRlcigpe3JldHVybiB0aGlzLl9uZWVkc1JlbmRlcn1hZGQodCl7Zm9yKGxldCBlIG9mIHQpZS50YWcuaWQgaW4gdGhpcy5fdGFncyYmdGhpcy5fcmVtb3ZlKGUudGFnLmlkKSx0aGlzLl9hZGQoZSk7dGhpcy5fbmVlZHNSZW5kZXI9ITB9YWRkQ3JlYXRlVGFnKHQpe2Zvcihjb25zdCBlIG9mIHQuZ2xPYmplY3RzKXRoaXMuX3NjZW5lLmFkZChlKTt0aGlzLl9jcmVhdGVUYWc9e3RhZzp0LG9iamVjdHM6dC5nbE9iamVjdHN9LHRoaXMuX25lZWRzUmVuZGVyPSEwfWNsZWFyKCl7Zm9yKGNvbnN0IHQgb2YgT2JqZWN0LmtleXModGhpcy5fdGFncykpdGhpcy5fcmVtb3ZlKHQpO3RoaXMuX25lZWRzUmVuZGVyPSExfWdldCh0KXtyZXR1cm4gdGhpcy5oYXModCk/dGhpcy5fdGFnc1t0XS50YWc6dm9pZCAwfWhhcyh0KXtyZXR1cm4gdCBpbiB0aGlzLl90YWdzfWhhc0NyZWF0ZVRhZygpe3JldHVybiBudWxsIT10aGlzLl9jcmVhdGVUYWd9aW50ZXJzZWN0T2JqZWN0cyhbdCxlXSxpKXt0aGlzLl9yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShuZXcgcm4odCxlKSxpKTtjb25zdCBuPXRoaXMuX3JheWNhc3Rlci5pbnRlcnNlY3RPYmplY3RzKHRoaXMuX3JldHJpZXZhYmxlT2JqZWN0cykscj1bXTtmb3IoY29uc3QgdCBvZiBuKXQub2JqZWN0LnV1aWQgaW4gdGhpcy5fb2JqZWN0VGFncyYmci5wdXNoKHRoaXMuX29iamVjdFRhZ3NbdC5vYmplY3QudXVpZF0pO3JldHVybiByfXJlbW92ZSh0KXtmb3IoY29uc3QgZSBvZiB0KXRoaXMuX3JlbW92ZShlKTt0aGlzLl9uZWVkc1JlbmRlcj0hMH1yZW1vdmVBbGwoKXtmb3IoY29uc3QgdCBvZiBPYmplY3Qua2V5cyh0aGlzLl90YWdzKSl0aGlzLl9yZW1vdmUodCk7dGhpcy5fbmVlZHNSZW5kZXI9ITB9cmVtb3ZlQ3JlYXRlVGFnKCl7aWYobnVsbCE9dGhpcy5fY3JlYXRlVGFnKXtmb3IoY29uc3QgdCBvZiB0aGlzLl9jcmVhdGVUYWcub2JqZWN0cyl0aGlzLl9zY2VuZS5yZW1vdmUodCk7dGhpcy5fY3JlYXRlVGFnLnRhZy5kaXNwb3NlKCksdGhpcy5fY3JlYXRlVGFnPW51bGwsdGhpcy5fbmVlZHNSZW5kZXI9ITB9fXJlbmRlcih0LGUpe2UucmVuZGVyKHRoaXMuX3NjZW5lLHQpLHRoaXMuX25lZWRzUmVuZGVyPSExfXVwZGF0ZSgpe3RoaXMuX25lZWRzUmVuZGVyPSEwfXVwZGF0ZUNyZWF0ZVRhZ09iamVjdHModCl7aWYodGhpcy5fY3JlYXRlVGFnLnRhZyE9PXQpdGhyb3cgbmV3IEVycm9yKFwiQ3JlYXRlIHRhZ3MgZG8gbm90IGhhdmUgdGhlIHNhbWUgcmVmZXJlbmNlLlwiKTtmb3IobGV0IHQgb2YgdGhpcy5fY3JlYXRlVGFnLm9iamVjdHMpdGhpcy5fc2NlbmUucmVtb3ZlKHQpO2Zvcihjb25zdCBlIG9mIHQuZ2xPYmplY3RzKXRoaXMuX3NjZW5lLmFkZChlKTt0aGlzLl9jcmVhdGVUYWcub2JqZWN0cz10LmdsT2JqZWN0cyx0aGlzLl9uZWVkc1JlbmRlcj0hMH11cGRhdGVPYmplY3RzKHQpe2NvbnN0IGU9dC50YWcuaWQ7aWYodGhpcy5fdGFnc1tlXS50YWchPT10KXRocm93IG5ldyBFcnJvcihcIlRhZ3MgZG8gbm90IGhhdmUgdGhlIHNhbWUgcmVmZXJlbmNlLlwiKTtjb25zdCBpPXRoaXMuX3RhZ3NbZV07dGhpcy5fcmVtb3ZlT2JqZWN0cyhpKSxkZWxldGUgdGhpcy5fdGFnc1tlXSx0aGlzLl9hZGQodCksdGhpcy5fbmVlZHNSZW5kZXI9ITB9X2FkZCh0KXtjb25zdCBlPXQudGFnLmlkLGk9e3RhZzp0LG9iamVjdHM6W10scmV0cmlldmFibGVPYmplY3RzOltdfTt0aGlzLl90YWdzW2VdPWk7Zm9yKGNvbnN0IGUgb2YgdC5nZXRHTE9iamVjdHMoKSlpLm9iamVjdHMucHVzaChlKSx0aGlzLl9zY2VuZS5hZGQoZSk7Zm9yKGNvbnN0IGUgb2YgdC5nZXRSZXRyaWV2YWJsZU9iamVjdHMoKSlpLnJldHJpZXZhYmxlT2JqZWN0cy5wdXNoKGUpLHRoaXMuX3JldHJpZXZhYmxlT2JqZWN0cy5wdXNoKGUpLHRoaXMuX29iamVjdFRhZ3NbZS51dWlkXT10LnRhZy5pZH1fcmVtb3ZlKHQpe2NvbnN0IGU9dGhpcy5fdGFnc1t0XTt0aGlzLl9yZW1vdmVPYmplY3RzKGUpLGUudGFnLmRpc3Bvc2UoKSxkZWxldGUgdGhpcy5fdGFnc1t0XX1fcmVtb3ZlT2JqZWN0cyh0KXtmb3IoY29uc3QgZSBvZiB0Lm9iamVjdHMpdGhpcy5fc2NlbmUucmVtb3ZlKGUpO2Zvcihjb25zdCBlIG9mIHQucmV0cmlldmFibGVPYmplY3RzKXtjb25zdCB0PXRoaXMuX3JldHJpZXZhYmxlT2JqZWN0cy5pbmRleE9mKGUpOy0xIT09dCYmdGhpcy5fcmV0cmlldmFibGVPYmplY3RzLnNwbGljZSh0LDEpfX19dmFyIFFfLHR2LGV2LGl2O3QuVGFnTW9kZT12b2lkIDAsKFFfPXQuVGFnTW9kZXx8KHQuVGFnTW9kZT17fSkpW1FfLkRlZmF1bHQ9MF09XCJEZWZhdWx0XCIsUV9bUV8uQ3JlYXRlUG9pbnQ9MV09XCJDcmVhdGVQb2ludFwiLFFfW1FfLkNyZWF0ZVBvaW50cz0yXT1cIkNyZWF0ZVBvaW50c1wiLFFfW1FfLkNyZWF0ZVBvbHlnb249M109XCJDcmVhdGVQb2x5Z29uXCIsUV9bUV8uQ3JlYXRlUmVjdD00XT1cIkNyZWF0ZVJlY3RcIixRX1tRXy5DcmVhdGVSZWN0RHJhZz01XT1cIkNyZWF0ZVJlY3REcmFnXCIsZnVuY3Rpb24odCl7dFt0Lk5vbmU9MF09XCJOb25lXCIsdFt0LkNlbnRyb2lkPTFdPVwiQ2VudHJvaWRcIix0W3QuVmVydGV4PTJdPVwiVmVydGV4XCJ9KHR2fHwodHY9e30pKTtjbGFzcyBudntjb25zdHJ1Y3Rvcih0LGUsaSl7dGhpcy5fdGFnPXQsdGhpcy5fdHJhbnNmb3JtPWUsdGhpcy5fdmlld3BvcnRDb29yZHM9aXx8bmV3IFdmLHRoaXMuX2dsT2JqZWN0c0NoYW5nZWQkPW5ldyBULHRoaXMuX2ludGVyYWN0JD1uZXcgVH1nZXQgZ2xPYmplY3RzQ2hhbmdlZCQoKXtyZXR1cm4gdGhpcy5fZ2xPYmplY3RzQ2hhbmdlZCR9Z2V0IGludGVyYWN0JCgpe3JldHVybiB0aGlzLl9pbnRlcmFjdCR9Z2V0IHRhZygpe3JldHVybiB0aGlzLl90YWd9fWNsYXNzIHJ2IGV4dGVuZHMgbnZ7Y29uc3RydWN0b3IodCxlKXtzdXBlcih0LGUpLHRoaXMuX2dlb21ldHJ5Q2hhbmdlZFN1YnNjcmlwdGlvbj10aGlzLl90YWcuZ2VvbWV0cnkuY2hhbmdlZCQuc3Vic2NyaWJlKCgoKT0+e3RoaXMuX29uR2VvbWV0cnlDaGFuZ2VkKCl9KSksdGhpcy5fY2hhbmdlZFN1YnNjcmlwdGlvbj10aGlzLl90YWcuY2hhbmdlZCQuc3Vic2NyaWJlKCgoKT0+e3RoaXMuX29uVGFnQ2hhbmdlZCgpJiZ0aGlzLl9nbE9iamVjdHNDaGFuZ2VkJC5uZXh0KHRoaXMpfSkpfWRpc3Bvc2UoKXt0aGlzLl9jaGFuZ2VkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fZ2VvbWV0cnlDaGFuZ2VkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCl9X2NvbG9yVG9Dc3ModCl7cmV0dXJuXCIjXCIrKFwiMDAwMDAwXCIrdC50b1N0cmluZygxNikpLnN1YnN0cigtNil9X2NyZWF0ZUZpbGwoKXtsZXQgdD10aGlzLl9nZXRUcmlhbmdsZXMoKSxlPW5ldyBGbG9hdDMyQXJyYXkodCksaT1uZXcgaHM7aS5zZXRBdHRyaWJ1dGUoXCJwb3NpdGlvblwiLG5ldyBIcihlLDMpKSxpLmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpO2xldCBuPW5ldyBGcih7c2lkZToyLHRyYW5zcGFyZW50OiEwfSk7cmV0dXJuIHRoaXMuX3VwZGF0ZUZpbGxNYXRlcmlhbChuKSxuZXcgRXMoaSxuKX1fY3JlYXRlTGluZSh0KXtsZXQgZT10aGlzLl9nZXRMaW5lUG9zaXRpb25zKHQpLGk9bmV3IGhzO2kuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSHIoZSwzKSksaS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTtsZXQgbj1uZXcga2M7dGhpcy5fdXBkYXRlTGluZUJhc2ljTWF0ZXJpYWwobik7Y29uc3Qgcj1uZXcgVWMoaSxuKTtyZXR1cm4gci5yZW5kZXJPcmRlcj0xLHJ9X2NyZWF0ZU91dGxpbmUoKXtyZXR1cm4gdGhpcy5fY3JlYXRlTGluZSh0aGlzLl9nZXRQb2ludHMzZCgpKX1fZGlzcG9zZUZpbGwoKXtudWxsIT10aGlzLl9maWxsJiYodGhpcy5fZmlsbC5nZW9tZXRyeS5kaXNwb3NlKCksdGhpcy5fZmlsbC5tYXRlcmlhbC5kaXNwb3NlKCksdGhpcy5fZmlsbD1udWxsKX1fZGlzcG9zZU91dGxpbmUoKXtudWxsIT10aGlzLl9vdXRsaW5lJiYodGhpcy5fb3V0bGluZS5nZW9tZXRyeS5kaXNwb3NlKCksdGhpcy5fb3V0bGluZS5tYXRlcmlhbC5kaXNwb3NlKCksdGhpcy5fb3V0bGluZT1udWxsKX1fZ2V0TGluZVBvc2l0aW9ucyh0KXtsZXQgZT10Lmxlbmd0aCxpPW5ldyBGbG9hdDMyQXJyYXkoMyplKTtmb3IobGV0IG49MDtuPGU7KytuKXtsZXQgZT0zKm4scj10W25dO2lbZSswXT1yWzBdLGlbZSsxXT1yWzFdLGlbZSsyXT1yWzJdfXJldHVybiBpfV9pbnRlcmFjdCh0LGUsaSl7cmV0dXJuIG49PntsZXQgcj1uLm9mZnNldFgtbi50YXJnZXQub2Zmc2V0V2lkdGgvMixzPW4ub2Zmc2V0WS1uLnRhcmdldC5vZmZzZXRIZWlnaHQvMjt0aGlzLl9pbnRlcmFjdCQubmV4dCh7Y3Vyc29yOmUsb2Zmc2V0WDpyLG9mZnNldFk6cyxvcGVyYXRpb246dCx0YWc6dGhpcy5fdGFnLHZlcnRleEluZGV4Oml9KX19X3VwZGF0ZUZpbGxHZW9tZXRyeSgpe2xldCB0PXRoaXMuX2dldFRyaWFuZ2xlcygpLGU9bmV3IEZsb2F0MzJBcnJheSh0KSxpPXRoaXMuX2ZpbGwuZ2VvbWV0cnksbj1pLmdldEF0dHJpYnV0ZShcInBvc2l0aW9uXCIpO24uYXJyYXkubGVuZ3RoPT09ZS5sZW5ndGg/KG4uc2V0KGUpLG4ubmVlZHNVcGRhdGU9ITApOihpLmRlbGV0ZUF0dHJpYnV0ZShcInBvc2l0aW9uXCIpLGkuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIixuZXcgSHIoZSwzKSkpLGkuY29tcHV0ZUJvdW5kaW5nU3BoZXJlKCl9X3VwZGF0ZUxpbmUodCxlKXtsZXQgaT10aGlzLl9nZXRMaW5lUG9zaXRpb25zKGUpLG49dC5nZW9tZXRyeSxyPW4uZ2V0QXR0cmlidXRlKFwicG9zaXRpb25cIik7ci5zZXQoaSksci5uZWVkc1VwZGF0ZT0hMCxuLmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpfV91cGRhdGVPdWxpbmVHZW9tZXRyeSgpe3RoaXMuX3VwZGF0ZUxpbmUodGhpcy5fb3V0bGluZSx0aGlzLl9nZXRQb2ludHMzZCgpKX19Y2xhc3Mgc3YgZXh0ZW5kcyBydntjb25zdHJ1Y3Rvcih0LGUpe3N1cGVyKHQsZSksdGhpcy5fcmVjdEdlb21ldHJ5PW5ldyBxXyh0aGlzLl90YWcuZ2VvbWV0cnkuZ2V0UmVjdDJkKGUpKSx0aGlzLl9maWxsPWRkKGUuY2FtZXJhVHlwZSk/bnVsbDp0aGlzLl9jcmVhdGVGaWxsKCksdGhpcy5fb3V0bGluZT10aGlzLl90YWcubGluZVdpZHRoPj0xP3RoaXMuX2NyZWF0ZU91dGxpbmUoKTpudWxsfWRpc3Bvc2UoKXtzdXBlci5kaXNwb3NlKCksdGhpcy5fZGlzcG9zZUZpbGwoKSx0aGlzLl9kaXNwb3NlT3V0bGluZSgpfWdldERPTU9iamVjdHModCxlLGkpe2NvbnN0IG49W10scj17b2Zmc2V0SGVpZ2h0OmkuaGVpZ2h0LG9mZnNldFdpZHRoOmkud2lkdGh9O2lmKCF0aGlzLl90YWcuZWRpdGFibGUpcmV0dXJuIG47Y29uc3Qgcz10aGlzLl9jb2xvclRvQ3NzKHRoaXMuX3RhZy5saW5lQ29sb3IpLG89dGhpcy5fdGFnLmdlb21ldHJ5LmdldFBvaW50czJkKCk7Zm9yKGxldCB0PTA7dDxvLmxlbmd0aDt0Kyspe2NvbnN0W2ksYV09b1t0XSxjPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmJhc2ljVG9DYW52YXNTYWZlKGksYSxyLHRoaXMuX3RyYW5zZm9ybSxlKTtpZihudWxsPT1jKWNvbnRpbnVlO2NvbnN0IGg9XCJjcm9zc2hhaXJcIixsPXRoaXMuX2ludGVyYWN0KHR2LlZlcnRleCxoLHQpLHU9YHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSB0cmFuc2xhdGUoJHtNYXRoLnJvdW5kKGNbMF0pfXB4LCR7TWF0aC5yb3VuZChjWzFdKX1weClgLGQ9e29ucG9pbnRlcmRvd246bCxzdHlsZTp7YmFja2dyb3VuZDpzLHRyYW5zZm9ybTp1LGN1cnNvcjpofX07aWYobi5wdXNoKGpmLmgoXCJkaXYubWFwaWxsYXJ5LXRhZy1yZXNpemVyXCIsZCxbXSkpLCF0aGlzLl90YWcuaW5kaWNhdGVWZXJ0aWNlcyljb250aW51ZTtjb25zdCBwPXtzdHlsZTp7YmFja2dyb3VuZDpzLHRyYW5zZm9ybTp1fX07bi5wdXNoKGpmLmgoXCJkaXYubWFwaWxsYXJ5LXRhZy12ZXJ0ZXhcIixwLFtdKSl9cmV0dXJuIG59Z2V0R0xPYmplY3RzKCl7Y29uc3QgdD1bXTtyZXR1cm4gbnVsbCE9dGhpcy5fZmlsbCYmdC5wdXNoKHRoaXMuX2ZpbGwpLG51bGwhPXRoaXMuX291dGxpbmUmJnQucHVzaCh0aGlzLl9vdXRsaW5lKSx0fWdldFJldHJpZXZhYmxlT2JqZWN0cygpe3JldHVybiBudWxsIT10aGlzLl9maWxsP1t0aGlzLl9maWxsXTpbXX1fb25HZW9tZXRyeUNoYW5nZWQoKXt0aGlzLl9yZWN0R2VvbWV0cnk9bmV3IHFfKHRoaXMuX3RhZy5nZW9tZXRyeS5nZXRSZWN0MmQodGhpcy5fdHJhbnNmb3JtKSksbnVsbCE9dGhpcy5fZmlsbCYmdGhpcy5fdXBkYXRlRmlsbEdlb21ldHJ5KCksbnVsbCE9dGhpcy5fb3V0bGluZSYmdGhpcy5fdXBkYXRlT3VsaW5lR2VvbWV0cnkoKX1fb25UYWdDaGFuZ2VkKCl7bGV0IHQ9ITE7cmV0dXJuIG51bGwhPXRoaXMuX2ZpbGwmJnRoaXMuX3VwZGF0ZUZpbGxNYXRlcmlhbCh0aGlzLl9maWxsLm1hdGVyaWFsKSxudWxsPT10aGlzLl9vdXRsaW5lP3RoaXMuX3RhZy5saW5lV2lkdGg+PTEmJih0aGlzLl9vdXRsaW5lPXRoaXMuX2NyZWF0ZU91dGxpbmUoKSx0PSEwKTp0aGlzLl91cGRhdGVPdXRsaW5lTWF0ZXJpYWwoKSx0fV9nZXRQb2ludHMzZCgpe3JldHVybiB0aGlzLl9yZWN0R2VvbWV0cnkuZ2V0UG9pbnRzM2QodGhpcy5fdHJhbnNmb3JtKX1fZ2V0VHJpYW5nbGVzKCl7cmV0dXJuIHRoaXMuX3JlY3RHZW9tZXRyeS5nZXRUcmlhbmdsZXMzZCh0aGlzLl90cmFuc2Zvcm0pfV91cGRhdGVGaWxsTWF0ZXJpYWwodCl7dC5jb2xvcj1uZXcgRHIodGhpcy5fdGFnLmZpbGxDb2xvciksdC5vcGFjaXR5PXRoaXMuX3RhZy5maWxsT3BhY2l0eSx0Lm5lZWRzVXBkYXRlPSEwfV91cGRhdGVMaW5lQmFzaWNNYXRlcmlhbCh0KXt0LmNvbG9yPW5ldyBEcih0aGlzLl90YWcubGluZUNvbG9yKSx0LmxpbmV3aWR0aD1NYXRoLm1heCh0aGlzLl90YWcubGluZVdpZHRoLDEpLHQudmlzaWJsZT10aGlzLl90YWcubGluZVdpZHRoPj0xJiZ0aGlzLl90YWcubGluZU9wYWNpdHk+MCx0Lm9wYWNpdHk9dGhpcy5fdGFnLmxpbmVPcGFjaXR5LHQudHJhbnNwYXJlbnQ9dGhpcy5fdGFnLmxpbmVPcGFjaXR5PDEsdC5uZWVkc1VwZGF0ZT0hMH1fdXBkYXRlT3V0bGluZU1hdGVyaWFsKCl7bGV0IHQ9dGhpcy5fb3V0bGluZS5tYXRlcmlhbDt0aGlzLl91cGRhdGVMaW5lQmFzaWNNYXRlcmlhbCh0KX19Y2xhc3Mgb3YgZXh0ZW5kcyBIZntjb25zdHJ1Y3Rvcih0LGUpe3N1cGVyKCksdGhpcy5faWQ9dCx0aGlzLl9nZW9tZXRyeT1lLHRoaXMuX25vdGlmeUNoYW5nZWQkPW5ldyBULHRoaXMuX25vdGlmeUNoYW5nZWQkLnN1YnNjcmliZSgodD0+e2NvbnN0IGU9e3RhcmdldDp0aGlzLHR5cGU6XCJ0YWdcIn07dGhpcy5maXJlKFwidGFnXCIsZSl9KSksdGhpcy5fZ2VvbWV0cnkuY2hhbmdlZCQuc3Vic2NyaWJlKCh0PT57Y29uc3QgZT1cImdlb21ldHJ5XCIsaT17dGFyZ2V0OnRoaXMsdHlwZTplfTt0aGlzLmZpcmUoZSxpKX0pKX1nZXQgaWQoKXtyZXR1cm4gdGhpcy5faWR9Z2V0IGdlb21ldHJ5KCl7cmV0dXJuIHRoaXMuX2dlb21ldHJ5fWdldCBjaGFuZ2VkJCgpe3JldHVybiB0aGlzLl9ub3RpZnlDaGFuZ2VkJH1nZXQgZ2VvbWV0cnlDaGFuZ2VkJCgpe3JldHVybiB0aGlzLl9nZW9tZXRyeS5jaGFuZ2VkJC5waXBlKHJ0KCgoKT0+dGhpcykpLFplKCkpfWZpcmUodCxlKXtzdXBlci5maXJlKHQsZSl9b2ZmKHQsZSl7c3VwZXIub2ZmKHQsZSl9b24odCxlKXtzdXBlci5vbih0LGUpfX1jbGFzcyBhdiBleHRlbmRzIG92e2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUpLGk9aXx8e30sdGhpcy5fZWRpdGFibGU9bnVsbCE9aS5lZGl0YWJsZSYmaS5lZGl0YWJsZSx0aGlzLl9maWxsQ29sb3I9bnVsbD09aS5maWxsQ29sb3I/MTY3NzcyMTU6aS5maWxsQ29sb3IsdGhpcy5fZmlsbE9wYWNpdHk9bnVsbD09aS5maWxsT3BhY2l0eT8wOmkuZmlsbE9wYWNpdHksdGhpcy5faW5kaWNhdGVWZXJ0aWNlcz1udWxsPT1pLmluZGljYXRlVmVydGljZXN8fGkuaW5kaWNhdGVWZXJ0aWNlcyx0aGlzLl9saW5lQ29sb3I9bnVsbD09aS5saW5lQ29sb3I/MTY3NzcyMTU6aS5saW5lQ29sb3IsdGhpcy5fbGluZU9wYWNpdHk9bnVsbD09aS5saW5lT3BhY2l0eT8xOmkubGluZU9wYWNpdHksdGhpcy5fbGluZVdpZHRoPW51bGw9PWkubGluZVdpZHRoPzE6aS5saW5lV2lkdGh9Z2V0IGVkaXRhYmxlKCl7cmV0dXJuIHRoaXMuX2VkaXRhYmxlfXNldCBlZGl0YWJsZSh0KXt0aGlzLl9lZGl0YWJsZT10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IGZpbGxDb2xvcigpe3JldHVybiB0aGlzLl9maWxsQ29sb3J9c2V0IGZpbGxDb2xvcih0KXt0aGlzLl9maWxsQ29sb3I9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCBmaWxsT3BhY2l0eSgpe3JldHVybiB0aGlzLl9maWxsT3BhY2l0eX1zZXQgZmlsbE9wYWNpdHkodCl7dGhpcy5fZmlsbE9wYWNpdHk9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCBnZW9tZXRyeSgpe3JldHVybiB0aGlzLl9nZW9tZXRyeX1nZXQgaW5kaWNhdGVWZXJ0aWNlcygpe3JldHVybiB0aGlzLl9pbmRpY2F0ZVZlcnRpY2VzfXNldCBpbmRpY2F0ZVZlcnRpY2VzKHQpe3RoaXMuX2luZGljYXRlVmVydGljZXM9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCBsaW5lQ29sb3IoKXtyZXR1cm4gdGhpcy5fbGluZUNvbG9yfXNldCBsaW5lQ29sb3IodCl7dGhpcy5fbGluZUNvbG9yPXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXQgbGluZU9wYWNpdHkoKXtyZXR1cm4gdGhpcy5fbGluZU9wYWNpdHl9c2V0IGxpbmVPcGFjaXR5KHQpe3RoaXMuX2xpbmVPcGFjaXR5PXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXQgbGluZVdpZHRoKCl7cmV0dXJuIHRoaXMuX2xpbmVXaWR0aH1zZXQgbGluZVdpZHRoKHQpe3RoaXMuX2xpbmVXaWR0aD10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9c2V0T3B0aW9ucyh0KXt0aGlzLl9lZGl0YWJsZT1udWxsPT10LmVkaXRhYmxlP3RoaXMuX2VkaXRhYmxlOnQuZWRpdGFibGUsdGhpcy5faW5kaWNhdGVWZXJ0aWNlcz1udWxsPT10LmluZGljYXRlVmVydGljZXM/dGhpcy5faW5kaWNhdGVWZXJ0aWNlczp0LmluZGljYXRlVmVydGljZXMsdGhpcy5fbGluZUNvbG9yPW51bGw9PXQubGluZUNvbG9yP3RoaXMuX2xpbmVDb2xvcjp0LmxpbmVDb2xvcix0aGlzLl9saW5lV2lkdGg9bnVsbD09dC5saW5lV2lkdGg/dGhpcy5fbGluZVdpZHRoOnQubGluZVdpZHRoLHRoaXMuX2ZpbGxDb2xvcj1udWxsPT10LmZpbGxDb2xvcj90aGlzLl9maWxsQ29sb3I6dC5maWxsQ29sb3IsdGhpcy5fZmlsbE9wYWNpdHk9bnVsbD09dC5maWxsT3BhY2l0eT90aGlzLl9maWxsT3BhY2l0eTp0LmZpbGxPcGFjaXR5LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9fXQuVGFnRG9tYWluPXZvaWQgMCwoZXY9dC5UYWdEb21haW58fCh0LlRhZ0RvbWFpbj17fSkpW2V2LlR3b0RpbWVuc2lvbmFsPTBdPVwiVHdvRGltZW5zaW9uYWxcIixldltldi5UaHJlZURpbWVuc2lvbmFsPTFdPVwiVGhyZWVEaW1lbnNpb25hbFwiO2NsYXNzIGN2IGV4dGVuZHMgcnZ7Y29uc3RydWN0b3IoZSxpKXtzdXBlcihlLGkpLHRoaXMuX2ZpbGw9ZGQoaS5jYW1lcmFUeXBlKT9lLmRvbWFpbj09PXQuVGFnRG9tYWluLlR3b0RpbWVuc2lvbmFsJiZlLmdlb21ldHJ5IGluc3RhbmNlb2YgWF8/dGhpcy5fY3JlYXRlRmlsbCgpOm51bGw6dGhpcy5fY3JlYXRlRmlsbCgpLHRoaXMuX2hvbGVzPXRoaXMuX3RhZy5saW5lV2lkdGg+PTE/dGhpcy5fY3JlYXRlSG9sZXMoKTpbXSx0aGlzLl9vdXRsaW5lPXRoaXMuX3RhZy5saW5lV2lkdGg+PTE/dGhpcy5fY3JlYXRlT3V0bGluZSgpOm51bGx9ZGlzcG9zZSgpe3N1cGVyLmRpc3Bvc2UoKSx0aGlzLl9kaXNwb3NlRmlsbCgpLHRoaXMuX2Rpc3Bvc2VIb2xlcygpLHRoaXMuX2Rpc3Bvc2VPdXRsaW5lKCl9Z2V0RE9NT2JqZWN0cyh0LGUsaSl7Y29uc3Qgbj1bXSxyPXRoaXMuX3RhZy5nZW9tZXRyeSBpbnN0YW5jZW9mIHFfLHM9IWRkKHRoaXMuX3RyYW5zZm9ybS5jYW1lcmFUeXBlKSxvPXtvZmZzZXRIZWlnaHQ6aS5oZWlnaHQsb2Zmc2V0V2lkdGg6aS53aWR0aH07aWYobnVsbCE9dGhpcy5fdGFnLmljb24mJihyfHxzKSl7Y29uc3RbaSxyXT10aGlzLl90YWcuZ2VvbWV0cnkgaW5zdGFuY2VvZiBxXz90aGlzLl90YWcuZ2VvbWV0cnkuZ2V0VmVydGV4MmQodGhpcy5fdGFnLmljb25JbmRleCk6dGhpcy5fdGFnLmdlb21ldHJ5LmdldFBvbGVPZkluYWNjZXNzaWJpbGl0eTJkKCkscz10aGlzLl92aWV3cG9ydENvb3Jkcy5iYXNpY1RvQ2FudmFzU2FmZShpLHIsbyx0aGlzLl90cmFuc2Zvcm0sZSk7aWYobnVsbCE9cyl7Y29uc3QgZT0oKT0+e3RoaXMuX2ludGVyYWN0JC5uZXh0KHtvZmZzZXRYOjAsb2Zmc2V0WTowLG9wZXJhdGlvbjp0di5Ob25lLHRhZzp0aGlzLl90YWd9KX07aWYodC5sb2FkZWQpe2NvbnN0IGk9dC5nZXRET01TcHJpdGUodGhpcy5fdGFnLmljb24sdGhpcy5fdGFnLmljb25GbG9hdCkscj17b25jbGljazp0PT57dC5zdG9wUHJvcGFnYXRpb24oKSx0aGlzLl90YWcuY2xpY2skLm5leHQodGhpcy5fdGFnKX0sb25wb2ludGVyZG93bjplLHN0eWxlOnt0cmFuc2Zvcm06YHRyYW5zbGF0ZSgke01hdGgucm91bmQoc1swXSl9cHgsJHtNYXRoLnJvdW5kKHNbMV0pfXB4KWB9fTtuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLXN5bWJvbFwiLHIsW2ldKSl9fX1lbHNlIGlmKG51bGwhPXRoaXMuX3RhZy50ZXh0JiYocnx8cykpe2NvbnN0W3QsaV09dGhpcy5fdGFnLmdlb21ldHJ5IGluc3RhbmNlb2YgcV8/dGhpcy5fdGFnLmdlb21ldHJ5LmdldFZlcnRleDJkKDMpOnRoaXMuX3RhZy5nZW9tZXRyeS5nZXRQb2xlT2ZJbmFjY2Vzc2liaWxpdHkyZCgpLHI9dGhpcy5fdmlld3BvcnRDb29yZHMuYmFzaWNUb0NhbnZhc1NhZmUodCxpLG8sdGhpcy5fdHJhbnNmb3JtLGUpO2lmKG51bGwhPXIpe2NvbnN0IHQ9TWF0aC5yb3VuZChyWzBdKSxlPU1hdGgucm91bmQoclsxXSksaT10aGlzLl90YWcuZ2VvbWV0cnkgaW5zdGFuY2VvZiBxXz9gdHJhbnNsYXRlKCR7dH1weCwke2V9cHgpYDpgdHJhbnNsYXRlKC01MCUsIC01MCUpIHRyYW5zbGF0ZSgke3R9cHgsJHtlfXB4KWAscz17b25wb2ludGVyZG93bjooKT0+e3RoaXMuX2ludGVyYWN0JC5uZXh0KHtvZmZzZXRYOjAsb2Zmc2V0WTowLG9wZXJhdGlvbjp0di5Ob25lLHRhZzp0aGlzLl90YWd9KX0sc3R5bGU6e2NvbG9yOnRoaXMuX2NvbG9yVG9Dc3ModGhpcy5fdGFnLnRleHRDb2xvciksdHJhbnNmb3JtOml9LHRleHRDb250ZW50OnRoaXMuX3RhZy50ZXh0fTtuLnB1c2goamYuaChcInNwYW4ubWFwaWxsYXJ5LXRhZy1zeW1ib2xcIixzLFtdKSl9fWlmKCF0aGlzLl90YWcuZWRpdGFibGUpcmV0dXJuIG47Y29uc3QgYT10aGlzLl9jb2xvclRvQ3NzKHRoaXMuX3RhZy5saW5lQ29sb3IpO2lmKHRoaXMuX3RhZy5nZW9tZXRyeSBpbnN0YW5jZW9mIHFfKXtjb25zdFt0LGldPXRoaXMuX3RhZy5nZW9tZXRyeS5nZXRDZW50cm9pZDJkKCkscj10aGlzLl92aWV3cG9ydENvb3Jkcy5iYXNpY1RvQ2FudmFzU2FmZSh0LGksbyx0aGlzLl90cmFuc2Zvcm0sZSk7aWYobnVsbCE9cil7Y29uc3QgdD17b25wb2ludGVyZG93bjp0aGlzLl9pbnRlcmFjdCh0di5DZW50cm9pZCxcIm1vdmVcIiksc3R5bGU6e2JhY2tncm91bmQ6YSx0cmFuc2Zvcm06YHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSB0cmFuc2xhdGUoJHtNYXRoLnJvdW5kKHJbMF0pfXB4LCR7TWF0aC5yb3VuZChyWzFdKX1weClgfX07bi5wdXNoKGpmLmgoXCJkaXYubWFwaWxsYXJ5LXRhZy1tb3ZlclwiLHQsW10pKX19Y29uc3QgYz10aGlzLl90YWcuZ2VvbWV0cnkuZ2V0VmVydGljZXMyZCgpO2ZvcihsZXQgdD0wO3Q8Yy5sZW5ndGgtMTt0Kyspe2lmKHImJihudWxsIT10aGlzLl90YWcuaWNvbiYmdD09PXRoaXMuX3RhZy5pY29uSW5kZXh8fG51bGw9PXRoaXMuX3RhZy5pY29uJiZudWxsIT10aGlzLl90YWcudGV4dCYmMz09PXQpKWNvbnRpbnVlO2NvbnN0W2ksc109Y1t0XSxoPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmJhc2ljVG9DYW52YXNTYWZlKGkscyxvLHRoaXMuX3RyYW5zZm9ybSxlKTtpZihudWxsPT1oKWNvbnRpbnVlO2NvbnN0IGw9cj90JTI9PTA/XCJuZXN3LXJlc2l6ZVwiOlwibndzZS1yZXNpemVcIjpcImNyb3NzaGFpclwiLHU9dGhpcy5faW50ZXJhY3QodHYuVmVydGV4LGwsdCksZD1gdHJhbnNsYXRlKC01MCUsIC01MCUpIHRyYW5zbGF0ZSgke01hdGgucm91bmQoaFswXSl9cHgsJHtNYXRoLnJvdW5kKGhbMV0pfXB4KWAscD17b25wb2ludGVyZG93bjp1LHN0eWxlOntiYWNrZ3JvdW5kOmEsdHJhbnNmb3JtOmQsY3Vyc29yOmx9fTtpZihuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLXJlc2l6ZXJcIixwLFtdKSksIXRoaXMuX3RhZy5pbmRpY2F0ZVZlcnRpY2VzKWNvbnRpbnVlO2NvbnN0IGY9e3N0eWxlOntiYWNrZ3JvdW5kOmEsdHJhbnNmb3JtOmR9fTtuLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLXZlcnRleFwiLGYsW10pKX1yZXR1cm4gbn1nZXRHTE9iamVjdHMoKXtjb25zdCB0PVtdO251bGwhPXRoaXMuX2ZpbGwmJnQucHVzaCh0aGlzLl9maWxsKTtmb3IoY29uc3QgZSBvZiB0aGlzLl9ob2xlcyl0LnB1c2goZSk7cmV0dXJuIG51bGwhPXRoaXMuX291dGxpbmUmJnQucHVzaCh0aGlzLl9vdXRsaW5lKSx0fWdldFJldHJpZXZhYmxlT2JqZWN0cygpe3JldHVybiBudWxsIT10aGlzLl9maWxsP1t0aGlzLl9maWxsXTpbXX1fb25HZW9tZXRyeUNoYW5nZWQoKXtudWxsIT10aGlzLl9maWxsJiZ0aGlzLl91cGRhdGVGaWxsR2VvbWV0cnkoKSx0aGlzLl9ob2xlcy5sZW5ndGg+MCYmdGhpcy5fdXBkYXRlSG9sZUdlb21ldHJpZXMoKSxudWxsIT10aGlzLl9vdXRsaW5lJiZ0aGlzLl91cGRhdGVPdWxpbmVHZW9tZXRyeSgpfV9vblRhZ0NoYW5nZWQoKXtsZXQgdD0hMTtyZXR1cm4gbnVsbCE9dGhpcy5fZmlsbCYmdGhpcy5fdXBkYXRlRmlsbE1hdGVyaWFsKHRoaXMuX2ZpbGwubWF0ZXJpYWwpLG51bGw9PXRoaXMuX291dGxpbmU/dGhpcy5fdGFnLmxpbmVXaWR0aD49MSYmKHRoaXMuX2hvbGVzPXRoaXMuX2NyZWF0ZUhvbGVzKCksdGhpcy5fb3V0bGluZT10aGlzLl9jcmVhdGVPdXRsaW5lKCksdD0hMCk6KHRoaXMuX3VwZGF0ZUhvbGVNYXRlcmlhbHMoKSx0aGlzLl91cGRhdGVPdXRsaW5lTWF0ZXJpYWwoKSksdH1fZ2V0UG9pbnRzM2QoKXtyZXR1cm4gdGhpcy5faW4zZERvbWFpbigpP3RoaXMuX3RhZy5nZW9tZXRyeS5nZXRWZXJ0aWNlczNkKHRoaXMuX3RyYW5zZm9ybSk6dGhpcy5fdGFnLmdlb21ldHJ5LmdldFBvaW50czNkKHRoaXMuX3RyYW5zZm9ybSl9X2dldFRyaWFuZ2xlcygpe3JldHVybiB0aGlzLl9pbjNkRG9tYWluKCk/dGhpcy5fdGFnLmdlb21ldHJ5LmdldDNkRG9tYWluVHJpYW5nbGVzM2QodGhpcy5fdHJhbnNmb3JtKTp0aGlzLl90YWcuZ2VvbWV0cnkuZ2V0VHJpYW5nbGVzM2QodGhpcy5fdHJhbnNmb3JtKX1fdXBkYXRlRmlsbE1hdGVyaWFsKHQpe3QuY29sb3I9bmV3IERyKHRoaXMuX3RhZy5maWxsQ29sb3IpLHQub3BhY2l0eT10aGlzLl90YWcuZmlsbE9wYWNpdHksdC5uZWVkc1VwZGF0ZT0hMH1fdXBkYXRlTGluZUJhc2ljTWF0ZXJpYWwodCl7dC5jb2xvcj1uZXcgRHIodGhpcy5fdGFnLmxpbmVDb2xvciksdC5saW5ld2lkdGg9TWF0aC5tYXgodGhpcy5fdGFnLmxpbmVXaWR0aCwxKSx0LnZpc2libGU9dGhpcy5fdGFnLmxpbmVXaWR0aD49MSYmdGhpcy5fdGFnLmxpbmVPcGFjaXR5PjAsdC5vcGFjaXR5PXRoaXMuX3RhZy5saW5lT3BhY2l0eSx0LnRyYW5zcGFyZW50PXRoaXMuX3RhZy5saW5lT3BhY2l0eTwxLHQubmVlZHNVcGRhdGU9ITB9X2NyZWF0ZUhvbGVzKCl7bGV0IHQ9W107aWYodGhpcy5fdGFnLmdlb21ldHJ5IGluc3RhbmNlb2YgWF8pe2xldCBlPXRoaXMuX2dldEhvbGVzM2QoKTtmb3IobGV0IGkgb2YgZSl7bGV0IGU9dGhpcy5fY3JlYXRlTGluZShpKTt0LnB1c2goZSl9fXJldHVybiB0fV9kaXNwb3NlSG9sZXMoKXtmb3IobGV0IHQgb2YgdGhpcy5faG9sZXMpdC5nZW9tZXRyeS5kaXNwb3NlKCksdC5tYXRlcmlhbC5kaXNwb3NlKCk7dGhpcy5faG9sZXM9W119X2dldEhvbGVzM2QoKXtjb25zdCB0PXRoaXMuX3RhZy5nZW9tZXRyeTtyZXR1cm4gdGhpcy5faW4zZERvbWFpbigpP3QuZ2V0SG9sZVZlcnRpY2VzM2QodGhpcy5fdHJhbnNmb3JtKTp0LmdldEhvbGVQb2ludHMzZCh0aGlzLl90cmFuc2Zvcm0pfV9pbjNkRG9tYWluKCl7cmV0dXJuIHRoaXMuX3RhZy5nZW9tZXRyeSBpbnN0YW5jZW9mIFhfJiZ0aGlzLl90YWcuZG9tYWluPT09dC5UYWdEb21haW4uVGhyZWVEaW1lbnNpb25hbH1fdXBkYXRlSG9sZUdlb21ldHJpZXMoKXtsZXQgdD10aGlzLl9nZXRIb2xlczNkKCk7aWYodC5sZW5ndGghPT10aGlzLl9ob2xlcy5sZW5ndGgpdGhyb3cgbmV3IEVycm9yKFwiQ2hhbmdpbmcgdGhlIG51bWJlciBvZiBob2xlcyBpcyBub3Qgc3VwcG9ydGVkLlwiKTtmb3IobGV0IGU9MDtlPHRoaXMuX2hvbGVzLmxlbmd0aDtlKyspe2xldCBpPXRbZV0sbj10aGlzLl9ob2xlc1tlXTt0aGlzLl91cGRhdGVMaW5lKG4saSl9fV91cGRhdGVIb2xlTWF0ZXJpYWxzKCl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5faG9sZXMpdGhpcy5fdXBkYXRlTGluZUJhc2ljTWF0ZXJpYWwodC5tYXRlcmlhbCl9X3VwZGF0ZU91dGxpbmVNYXRlcmlhbCgpe3RoaXMuX3VwZGF0ZUxpbmVCYXNpY01hdGVyaWFsKHRoaXMuX291dGxpbmUubWF0ZXJpYWwpfX10LkFsaWdubWVudD12b2lkIDAsKGl2PXQuQWxpZ25tZW50fHwodC5BbGlnbm1lbnQ9e30pKVtpdi5Cb3R0b209MF09XCJCb3R0b21cIixpdltpdi5Cb3R0b21MZWZ0PTFdPVwiQm90dG9tTGVmdFwiLGl2W2l2LkJvdHRvbVJpZ2h0PTJdPVwiQm90dG9tUmlnaHRcIixpdltpdi5DZW50ZXI9M109XCJDZW50ZXJcIixpdltpdi5MZWZ0PTRdPVwiTGVmdFwiLGl2W2l2LlJpZ2h0PTVdPVwiUmlnaHRcIixpdltpdi5Ub3A9Nl09XCJUb3BcIixpdltpdi5Ub3BMZWZ0PTddPVwiVG9wTGVmdFwiLGl2W2l2LlRvcFJpZ2h0PThdPVwiVG9wUmlnaHRcIjtjbGFzcyBodiBleHRlbmRzIG92e2NvbnN0cnVjdG9yKGUsaSxuKXtzdXBlcihlLGkpO2NvbnN0IHI9bnVsbCE9KG49bnx8e30pLmRvbWFpbiYmaSBpbnN0YW5jZW9mIFhfP24uZG9tYWluOnQuVGFnRG9tYWluLlR3b0RpbWVuc2lvbmFsLHM9dGhpcy5fdHdvRGltZW5zaW9uYWxQb2x5Z29uKHIsaSk7dGhpcy5fZG9tYWluPXIsdGhpcy5fZWRpdGFibGU9bnVsbCE9bi5lZGl0YWJsZSYmIXMmJm4uZWRpdGFibGUsdGhpcy5fZmlsbENvbG9yPW51bGw9PW4uZmlsbENvbG9yPzE2Nzc3MjE1Om4uZmlsbENvbG9yLHRoaXMuX2ZpbGxPcGFjaXR5PW51bGw9PW4uZmlsbE9wYWNpdHk/MDpuLmZpbGxPcGFjaXR5LHRoaXMuX2ljb249dm9pZCAwPT09bi5pY29uP251bGw6bi5pY29uLHRoaXMuX2ljb25GbG9hdD1udWxsPT1uLmljb25GbG9hdD90LkFsaWdubWVudC5DZW50ZXI6bi5pY29uRmxvYXQsdGhpcy5faWNvbkluZGV4PW51bGw9PW4uaWNvbkluZGV4PzM6bi5pY29uSW5kZXgsdGhpcy5faW5kaWNhdGVWZXJ0aWNlcz1udWxsPT1uLmluZGljYXRlVmVydGljZXN8fG4uaW5kaWNhdGVWZXJ0aWNlcyx0aGlzLl9saW5lQ29sb3I9bnVsbD09bi5saW5lQ29sb3I/MTY3NzcyMTU6bi5saW5lQ29sb3IsdGhpcy5fbGluZU9wYWNpdHk9bnVsbD09bi5saW5lT3BhY2l0eT8xOm4ubGluZU9wYWNpdHksdGhpcy5fbGluZVdpZHRoPW51bGw9PW4ubGluZVdpZHRoPzE6bi5saW5lV2lkdGgsdGhpcy5fdGV4dD12b2lkIDA9PT1uLnRleHQ/bnVsbDpuLnRleHQsdGhpcy5fdGV4dENvbG9yPW51bGw9PW4udGV4dENvbG9yPzE2Nzc3MjE1Om4udGV4dENvbG9yLHRoaXMuX2NsaWNrJD1uZXcgVCx0aGlzLl9jbGljayQuc3Vic2NyaWJlKCgoKT0+e2NvbnN0IHQ9XCJjbGlja1wiLGU9e3RhcmdldDp0aGlzLHR5cGU6dH07dGhpcy5maXJlKHQsZSl9KSl9Z2V0IGNsaWNrJCgpe3JldHVybiB0aGlzLl9jbGljayR9Z2V0IGRvbWFpbigpe3JldHVybiB0aGlzLl9kb21haW59Z2V0IGVkaXRhYmxlKCl7cmV0dXJuIHRoaXMuX2VkaXRhYmxlfXNldCBlZGl0YWJsZSh0KXt0aGlzLl90d29EaW1lbnNpb25hbFBvbHlnb24odGhpcy5fZG9tYWluLHRoaXMuX2dlb21ldHJ5KXx8KHRoaXMuX2VkaXRhYmxlPXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKSl9Z2V0IGZpbGxDb2xvcigpe3JldHVybiB0aGlzLl9maWxsQ29sb3J9c2V0IGZpbGxDb2xvcih0KXt0aGlzLl9maWxsQ29sb3I9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCBmaWxsT3BhY2l0eSgpe3JldHVybiB0aGlzLl9maWxsT3BhY2l0eX1zZXQgZmlsbE9wYWNpdHkodCl7dGhpcy5fZmlsbE9wYWNpdHk9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCBnZW9tZXRyeSgpe3JldHVybiB0aGlzLl9nZW9tZXRyeX1nZXQgaWNvbigpe3JldHVybiB0aGlzLl9pY29ufXNldCBpY29uKHQpe3RoaXMuX2ljb249dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCBpY29uRmxvYXQoKXtyZXR1cm4gdGhpcy5faWNvbkZsb2F0fXNldCBpY29uRmxvYXQodCl7dGhpcy5faWNvbkZsb2F0PXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXQgaWNvbkluZGV4KCl7cmV0dXJuIHRoaXMuX2ljb25JbmRleH1zZXQgaWNvbkluZGV4KHQpe3RoaXMuX2ljb25JbmRleD10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IGluZGljYXRlVmVydGljZXMoKXtyZXR1cm4gdGhpcy5faW5kaWNhdGVWZXJ0aWNlc31zZXQgaW5kaWNhdGVWZXJ0aWNlcyh0KXt0aGlzLl9pbmRpY2F0ZVZlcnRpY2VzPXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXQgbGluZUNvbG9yKCl7cmV0dXJuIHRoaXMuX2xpbmVDb2xvcn1zZXQgbGluZUNvbG9yKHQpe3RoaXMuX2xpbmVDb2xvcj10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IGxpbmVPcGFjaXR5KCl7cmV0dXJuIHRoaXMuX2xpbmVPcGFjaXR5fXNldCBsaW5lT3BhY2l0eSh0KXt0aGlzLl9saW5lT3BhY2l0eT10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IGxpbmVXaWR0aCgpe3JldHVybiB0aGlzLl9saW5lV2lkdGh9c2V0IGxpbmVXaWR0aCh0KXt0aGlzLl9saW5lV2lkdGg9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCB0ZXh0KCl7cmV0dXJuIHRoaXMuX3RleHR9c2V0IHRleHQodCl7dGhpcy5fdGV4dD10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IHRleHRDb2xvcigpe3JldHVybiB0aGlzLl90ZXh0Q29sb3J9c2V0IHRleHRDb2xvcih0KXt0aGlzLl90ZXh0Q29sb3I9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWZpcmUodCxlKXtzdXBlci5maXJlKHQsZSl9b2ZmKHQsZSl7c3VwZXIub2ZmKHQsZSl9b24odCxlKXtzdXBlci5vbih0LGUpfXNldE9wdGlvbnModCl7Y29uc3QgZT10aGlzLl90d29EaW1lbnNpb25hbFBvbHlnb24odGhpcy5fZG9tYWluLHRoaXMuX2dlb21ldHJ5KTt0aGlzLl9lZGl0YWJsZT1lfHxudWxsPT10LmVkaXRhYmxlP3RoaXMuX2VkaXRhYmxlOnQuZWRpdGFibGUsdGhpcy5faWNvbj12b2lkIDA9PT10Lmljb24/dGhpcy5faWNvbjp0Lmljb24sdGhpcy5faWNvbkZsb2F0PW51bGw9PXQuaWNvbkZsb2F0P3RoaXMuX2ljb25GbG9hdDp0Lmljb25GbG9hdCx0aGlzLl9pY29uSW5kZXg9bnVsbD09dC5pY29uSW5kZXg/dGhpcy5faWNvbkluZGV4OnQuaWNvbkluZGV4LHRoaXMuX2luZGljYXRlVmVydGljZXM9bnVsbD09dC5pbmRpY2F0ZVZlcnRpY2VzP3RoaXMuX2luZGljYXRlVmVydGljZXM6dC5pbmRpY2F0ZVZlcnRpY2VzLHRoaXMuX2xpbmVDb2xvcj1udWxsPT10LmxpbmVDb2xvcj90aGlzLl9saW5lQ29sb3I6dC5saW5lQ29sb3IsdGhpcy5fbGluZVdpZHRoPW51bGw9PXQubGluZVdpZHRoP3RoaXMuX2xpbmVXaWR0aDp0LmxpbmVXaWR0aCx0aGlzLl9maWxsQ29sb3I9bnVsbD09dC5maWxsQ29sb3I/dGhpcy5fZmlsbENvbG9yOnQuZmlsbENvbG9yLHRoaXMuX2ZpbGxPcGFjaXR5PW51bGw9PXQuZmlsbE9wYWNpdHk/dGhpcy5fZmlsbE9wYWNpdHk6dC5maWxsT3BhY2l0eSx0aGlzLl90ZXh0PXZvaWQgMD09PXQudGV4dD90aGlzLl90ZXh0OnQudGV4dCx0aGlzLl90ZXh0Q29sb3I9bnVsbD09dC50ZXh0Q29sb3I/dGhpcy5fdGV4dENvbG9yOnQudGV4dENvbG9yLHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9X3R3b0RpbWVuc2lvbmFsUG9seWdvbihlLGkpe3JldHVybiBlIT09dC5UYWdEb21haW4uVGhyZWVEaW1lbnNpb25hbCYmaSBpbnN0YW5jZW9mIFhffX1jbGFzcyBsdiBleHRlbmRzIG52e2Rpc3Bvc2UoKXt9Z2V0RE9NT2JqZWN0cyhlLGksbil7Y29uc3Qgcj10aGlzLl90YWcscz17b2Zmc2V0SGVpZ2h0Om4uaGVpZ2h0LG9mZnNldFdpZHRoOm4ud2lkdGh9LG89W10sW2EsY109ci5nZW9tZXRyeS5nZXRDZW50cm9pZDJkKCksaD10aGlzLl92aWV3cG9ydENvb3Jkcy5iYXNpY1RvQ2FudmFzU2FmZShhLGMscyx0aGlzLl90cmFuc2Zvcm0saSk7aWYobnVsbCE9aCl7Y29uc3QgaT10PT57dGhpcy5faW50ZXJhY3QkLm5leHQoe29mZnNldFg6MCxvZmZzZXRZOjAsb3BlcmF0aW9uOnR2Lk5vbmUsdGFnOnJ9KX0sbj1NYXRoLnJvdW5kKGhbMF0pLHM9TWF0aC5yb3VuZChoWzFdKTtpZihudWxsIT1yLmljb24pe2lmKGUubG9hZGVkKXtjb25zdCBhPWUuZ2V0RE9NU3ByaXRlKHIuaWNvbix0LkFsaWdubWVudC5Cb3R0b20pLGM9e29ucG9pbnRlcmRvd246aSxzdHlsZTp7cG9pbnRlckV2ZW50czpcImFsbFwiLHRyYW5zZm9ybTpgdHJhbnNsYXRlKCR7bn1weCwke3MrOH1weClgfX07by5wdXNoKGpmLmgoXCJkaXZcIixjLFthXSkpfX1lbHNlIGlmKG51bGwhPXIudGV4dCl7Y29uc3QgdD1gdHJhbnNsYXRlKC01MCUsMCUpIHRyYW5zbGF0ZSgke259cHgsJHtzKzh9cHgpYCxlPXtvbnBvaW50ZXJkb3duOmksc3R5bGU6e2NvbG9yOnRoaXMuX2NvbG9yVG9Dc3Moci50ZXh0Q29sb3IpLHRyYW5zZm9ybTp0fSx0ZXh0Q29udGVudDpyLnRleHR9O28ucHVzaChqZi5oKFwic3Bhbi5tYXBpbGxhcnktdGFnLXN5bWJvbFwiLGUsW10pKX1jb25zdCBhPXRoaXMuX2ludGVyYWN0KHR2LkNlbnRyb2lkLHIsXCJtb3ZlXCIpLGM9dGhpcy5fY29sb3JUb0NzcyhyLmNvbG9yKSxsPWB0cmFuc2xhdGUoLTUwJSwtNTAlKSB0cmFuc2xhdGUoJHtufXB4LCR7c31weClgO2lmKHIuZWRpdGFibGUpe2xldCB0PXtvbnBvaW50ZXJkb3duOmEsc3R5bGU6e2JhY2tncm91bmQ6Yyx0cmFuc2Zvcm06bH19O28ucHVzaChqZi5oKFwiZGl2Lm1hcGlsbGFyeS10YWctc3BvdC1pbnRlcmFjdG9yXCIsdCxbXSkpfWNvbnN0IHU9e3N0eWxlOntiYWNrZ3JvdW5kOmMsdHJhbnNmb3JtOmx9fTtvLnB1c2goamYuaChcImRpdi5tYXBpbGxhcnktdGFnLXZlcnRleFwiLHUsW10pKX1yZXR1cm4gb31nZXRHTE9iamVjdHMoKXtyZXR1cm5bXX1nZXRSZXRyaWV2YWJsZU9iamVjdHMoKXtyZXR1cm5bXX1fY29sb3JUb0Nzcyh0KXtyZXR1cm5cIiNcIisoXCIwMDAwMDBcIit0LnRvU3RyaW5nKDE2KSkuc3Vic3RyKC02KX1faW50ZXJhY3QodCxlLGksbil7cmV0dXJuIHI9Pntjb25zdCBzPXIub2Zmc2V0WC1yLnRhcmdldC5vZmZzZXRXaWR0aC8yLG89ci5vZmZzZXRZLXIudGFyZ2V0Lm9mZnNldEhlaWdodC8yO3RoaXMuX2ludGVyYWN0JC5uZXh0KHtjdXJzb3I6aSxvZmZzZXRYOnMsb2Zmc2V0WTpvLG9wZXJhdGlvbjp0LHRhZzplLHZlcnRleEluZGV4Om59KX19fWNsYXNzIHV2IGV4dGVuZHMgb3Z7Y29uc3RydWN0b3IodCxlLGkpe3N1cGVyKHQsZSksaT1pfHx7fSx0aGlzLl9jb2xvcj1udWxsPT1pLmNvbG9yPzE2Nzc3MjE1OmkuY29sb3IsdGhpcy5fZWRpdGFibGU9bnVsbCE9aS5lZGl0YWJsZSYmaS5lZGl0YWJsZSx0aGlzLl9pY29uPXZvaWQgMD09PWkuaWNvbj9udWxsOmkuaWNvbix0aGlzLl90ZXh0PXZvaWQgMD09PWkudGV4dD9udWxsOmkudGV4dCx0aGlzLl90ZXh0Q29sb3I9bnVsbD09aS50ZXh0Q29sb3I/MTY3NzcyMTU6aS50ZXh0Q29sb3J9Z2V0IGNvbG9yKCl7cmV0dXJuIHRoaXMuX2NvbG9yfXNldCBjb2xvcih0KXt0aGlzLl9jb2xvcj10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IGVkaXRhYmxlKCl7cmV0dXJuIHRoaXMuX2VkaXRhYmxlfXNldCBlZGl0YWJsZSh0KXt0aGlzLl9lZGl0YWJsZT10LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9Z2V0IGljb24oKXtyZXR1cm4gdGhpcy5faWNvbn1zZXQgaWNvbih0KXt0aGlzLl9pY29uPXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1nZXQgdGV4dCgpe3JldHVybiB0aGlzLl90ZXh0fXNldCB0ZXh0KHQpe3RoaXMuX3RleHQ9dCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfWdldCB0ZXh0Q29sb3IoKXtyZXR1cm4gdGhpcy5fdGV4dENvbG9yfXNldCB0ZXh0Q29sb3IodCl7dGhpcy5fdGV4dENvbG9yPXQsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1zZXRPcHRpb25zKHQpe3RoaXMuX2NvbG9yPW51bGw9PXQuY29sb3I/dGhpcy5fY29sb3I6dC5jb2xvcix0aGlzLl9lZGl0YWJsZT1udWxsPT10LmVkaXRhYmxlP3RoaXMuX2VkaXRhYmxlOnQuZWRpdGFibGUsdGhpcy5faWNvbj12b2lkIDA9PT10Lmljb24/dGhpcy5faWNvbjp0Lmljb24sdGhpcy5fdGV4dD12b2lkIDA9PT10LnRleHQ/dGhpcy5fdGV4dDp0LnRleHQsdGhpcy5fdGV4dENvbG9yPW51bGw9PXQudGV4dENvbG9yP3RoaXMuX3RleHRDb2xvcjp0LnRleHRDb2xvcix0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfX1jbGFzcyBkdntjb25zdHJ1Y3Rvcigpe3RoaXMuX2FjdGl2ZT0hMSx0aGlzLl9oYXNoPXt9LHRoaXMuX2hhc2hEZWFjdGl2YXRlZD17fSx0aGlzLl9ub3RpZnlDaGFuZ2VkJD1uZXcgVH1nZXQgYWN0aXZlKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZX1nZXQgY2hhbmdlZCQoKXtyZXR1cm4gdGhpcy5fbm90aWZ5Q2hhbmdlZCR9YWN0aXZhdGUodCl7aWYoIXRoaXMuX2FjdGl2ZSl7Zm9yKGNvbnN0IGUgaW4gdGhpcy5faGFzaERlYWN0aXZhdGVkKXtpZighdGhpcy5faGFzaERlYWN0aXZhdGVkLmhhc093blByb3BlcnR5KGUpKWNvbnRpbnVlO2NvbnN0IGk9dGhpcy5faGFzaERlYWN0aXZhdGVkW2VdO3RoaXMuX2FkZChpLHQpfXRoaXMuX2hhc2hEZWFjdGl2YXRlZD17fSx0aGlzLl9hY3RpdmU9ITAsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX19ZGVhY3RpdmF0ZSgpe2lmKHRoaXMuX2FjdGl2ZSl7Zm9yKGNvbnN0IHQgaW4gdGhpcy5faGFzaCl0aGlzLl9oYXNoLmhhc093blByb3BlcnR5KHQpJiYodGhpcy5faGFzaERlYWN0aXZhdGVkW3RdPXRoaXMuX2hhc2hbdF0udGFnKTt0aGlzLl9oYXNoPXt9LHRoaXMuX2FjdGl2ZT0hMX19YWRkKHQsZSl7dGhpcy5fYXNzZXJ0QWN0aXZhdGlvblN0YXRlKCEwKTtmb3IoY29uc3QgaSBvZiB0KXRoaXMuX2FkZChpLGUpO3RoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9YWRkRGVhY3RpdmF0ZWQodCl7dGhpcy5fYXNzZXJ0QWN0aXZhdGlvblN0YXRlKCExKTtmb3IoY29uc3QgZSBvZiB0KXtpZighKGUgaW5zdGFuY2VvZiBodnx8ZSBpbnN0YW5jZW9mIHV2fHxlIGluc3RhbmNlb2YgYXYpKXRocm93IG5ldyBFcnJvcihcIlRhZyB0eXBlIG5vdCBzdXBwb3J0ZWRcIik7dGhpcy5faGFzaERlYWN0aXZhdGVkW2UuaWRdPWV9fWdldCh0KXtyZXR1cm4gdGhpcy5oYXModCk/dGhpcy5faGFzaFt0XTp2b2lkIDB9Z2V0QWxsKCl7Y29uc3QgdD10aGlzLl9oYXNoO3JldHVybiBPYmplY3Qua2V5cyh0KS5tYXAoKGU9PnRbZV0pKX1nZXRBbGxEZWFjdGl2YXRlZCgpe2NvbnN0IHQ9dGhpcy5faGFzaERlYWN0aXZhdGVkO3JldHVybiBPYmplY3Qua2V5cyh0KS5tYXAoKGU9PnRbZV0pKX1nZXREZWFjdGl2YXRlZCh0KXtyZXR1cm4gdGhpcy5oYXNEZWFjdGl2YXRlZCh0KT90aGlzLl9oYXNoRGVhY3RpdmF0ZWRbdF06dm9pZCAwfWhhcyh0KXtyZXR1cm4gdCBpbiB0aGlzLl9oYXNofWhhc0RlYWN0aXZhdGVkKHQpe3JldHVybiB0IGluIHRoaXMuX2hhc2hEZWFjdGl2YXRlZH1yZW1vdmUodCl7dGhpcy5fYXNzZXJ0QWN0aXZhdGlvblN0YXRlKCEwKTtjb25zdCBlPXRoaXMuX2hhc2g7Zm9yKGNvbnN0IGkgb2YgdClpIGluIGUmJmRlbGV0ZSBlW2ldO3RoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9cmVtb3ZlQWxsKCl7dGhpcy5fYXNzZXJ0QWN0aXZhdGlvblN0YXRlKCEwKSx0aGlzLl9oYXNoPXt9LHRoaXMuX25vdGlmeUNoYW5nZWQkLm5leHQodGhpcyl9cmVtb3ZlQWxsRGVhY3RpdmF0ZWQoKXt0aGlzLl9hc3NlcnRBY3RpdmF0aW9uU3RhdGUoITEpLHRoaXMuX2hhc2hEZWFjdGl2YXRlZD17fX1yZW1vdmVEZWFjdGl2YXRlZCh0KXt0aGlzLl9hc3NlcnRBY3RpdmF0aW9uU3RhdGUoITEpO2NvbnN0IGU9dGhpcy5faGFzaERlYWN0aXZhdGVkO2Zvcihjb25zdCBpIG9mIHQpaSBpbiBlJiZkZWxldGUgZVtpXX1fYWRkKHQsZSl7aWYodCBpbnN0YW5jZW9mIGh2KXRoaXMuX2hhc2hbdC5pZF09bmV3IGN2KHQsZSk7ZWxzZSBpZih0IGluc3RhbmNlb2YgdXYpdGhpcy5faGFzaFt0LmlkXT1uZXcgbHYodCxlKTtlbHNle2lmKCEodCBpbnN0YW5jZW9mIGF2KSl0aHJvdyBuZXcgRXJyb3IoXCJUYWcgdHlwZSBub3Qgc3VwcG9ydGVkXCIpO3RoaXMuX2hhc2hbdC5pZF09bmV3IHN2KHQsZSl9fV9hc3NlcnRBY3RpdmF0aW9uU3RhdGUodCl7aWYodCE9PXRoaXMuX2FjdGl2ZSl0aHJvdyBuZXcgRXJyb3IoXCJUYWcgc2V0IG5vdCBpbiBjb3JyZWN0IHN0YXRlIGZvciBvcGVyYXRpb24uXCIpfX1jbGFzcyBwdiBleHRlbmRzIHhne2NvbnN0cnVjdG9yKHQpe3N1cGVyKCk7bGV0IGU9dFswXSxpPXRbMV07aWYoZTwwfHxlPjF8fGk8MHx8aT4xKXRocm93IG5ldyB3ZyhcIkJhc2ljIGNvb3JkaW5hdGVzIG11c3QgYmUgb24gdGhlIGludGVydmFsIFswLCAxXS5cIik7dGhpcy5fcG9pbnQ9dC5zbGljZSgpfWdldCBwb2ludCgpe3JldHVybiB0aGlzLl9wb2ludH1nZXRDZW50cm9pZDJkKCl7cmV0dXJuIHRoaXMuX3BvaW50LnNsaWNlKCl9Z2V0Q2VudHJvaWQzZCh0KXtyZXR1cm4gdC51bnByb2plY3RCYXNpYyh0aGlzLl9wb2ludCwyMDApfXNldENlbnRyb2lkMmQodCxlKXtsZXQgaT1bTWF0aC5tYXgoMCxNYXRoLm1pbigxLHRbMF0pKSxNYXRoLm1heCgwLE1hdGgubWluKDEsdFsxXSkpXTt0aGlzLl9wb2ludFswXT1pWzBdLHRoaXMuX3BvaW50WzFdPWlbMV0sdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX19Y2xhc3MgZnYgZXh0ZW5kcyBUbXtjb25zdHJ1Y3Rvcih0LGUsaSxuKXtzdXBlcih0LGUsaSksdGhpcy5fbmFtZT1gJHt0aGlzLl9jb21wb25lbnQubmFtZX0tJHt0aGlzLl9nZXROYW1lRXh0ZW5zaW9uKCl9YCx0aGlzLl92aWV3cG9ydENvb3Jkcz1ufV9nZXRDb25maWd1cmF0aW9uKHQpe3JldHVybnt9fV9tb3VzZUV2ZW50VG9CYXNpYyh0LGUsaSxuLHIscyl7cj1udWxsIT1yP3I6MCxzPW51bGwhPXM/czowO2NvbnN0W28sYV09dGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzUG9zaXRpb24odCxlKTtyZXR1cm4gdGhpcy5fdmlld3BvcnRDb29yZHMuY2FudmFzVG9CYXNpYyhvLXIsYS1zLGUsbixpLnBlcnNwZWN0aXZlKX19Y2xhc3MgbXYgZXh0ZW5kcyBmdntjb25zdHJ1Y3Rvcih0LGUsaSxuLHIpe3N1cGVyKHQsZSxpLG4pLHRoaXMuX3RhZ0NyZWF0b3I9cix0aGlzLl9nZW9tZXRyeUNyZWF0ZWQkPW5ldyBUfWdldCBnZW9tZXRyeUNyZWF0ZWQkKCl7cmV0dXJuIHRoaXMuX2dlb21ldHJ5Q3JlYXRlZCR9X2VuYWJsZSgpe3RoaXMuX2VuYWJsZUNyZWF0ZSgpLHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIuY2xhc3NMaXN0LmFkZChcImNvbXBvbmVudC10YWctY3JlYXRlXCIpfV9kaXNhYmxlKCl7dGhpcy5fY29udGFpbmVyLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiY29tcG9uZW50LXRhZy1jcmVhdGVcIiksdGhpcy5fZGlzYWJsZUNyZWF0ZSgpfV92YWxpZGF0ZUJhc2ljKHQpe2NvbnN0IGU9dFswXSxpPXRbMV07cmV0dXJuIDA8PWUmJmU8PTEmJjA8PWkmJmk8PTF9X21vdXNlRXZlbnRUb0Jhc2ljJCh0KXtyZXR1cm4gdC5waXBlKGJpKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCkscnQoKChbdCxlLGldKT0+dGhpcy5fbW91c2VFdmVudFRvQmFzaWModCx0aGlzLl9jb250YWluZXIuY29udGFpbmVyLGUsaSkpKSl9fWNsYXNzIGd2IGV4dGVuZHMgbXZ7X2VuYWJsZUNyZWF0ZSgpe3RoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuZGVmZXJQaXhlbHModGhpcy5fbmFtZSw0KSx0aGlzLl9nZW9tZXRyeUNyZWF0ZWRTdWJzY3JpcHRpb249dGhpcy5fbW91c2VFdmVudFRvQmFzaWMkKHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UucHJveGltYXRlQ2xpY2skKS5waXBlKE50KHRoaXMuX3ZhbGlkYXRlQmFzaWMpLHJ0KCh0PT5uZXcgcHYodCkpKSkuc3Vic2NyaWJlKHRoaXMuX2dlb21ldHJ5Q3JlYXRlZCQpfV9kaXNhYmxlQ3JlYXRlKCl7dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS51bmRlZmVyUGl4ZWxzKHRoaXMuX25hbWUpLHRoaXMuX2dlb21ldHJ5Q3JlYXRlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfV9nZXROYW1lRXh0ZW5zaW9uKCl7cmV0dXJuXCJjcmVhdGUtcG9pbnRcIn19Y2xhc3MgX3YgZXh0ZW5kcyBtdntfZW5hYmxlQ3JlYXRlKCl7dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5kZWZlclBpeGVscyh0aGlzLl9uYW1lLDQpO2NvbnN0IHQ9dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJC5waXBlKHJ0KCgoKT0+e30pKSxVZSgxKSxFKCkpO3RoaXMuX2RlbGV0ZVN1YnNjcmlwdGlvbj10LnBpcGUoSmUoMSkpLnN1YnNjcmliZSh0aGlzLl90YWdDcmVhdG9yLmRlbGV0ZSQpO2NvbnN0IGU9dGhpcy5fbW91c2VFdmVudFRvQmFzaWMkKHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UucHJveGltYXRlQ2xpY2skKS5waXBlKFplKCkpO3RoaXMuX2NyZWF0ZVN1YnNjcmlwdGlvbj10LnBpcGUocmkoKCgpPT5lLnBpcGUoTnQodGhpcy5fdmFsaWRhdGVCYXNpYyksdmUoMSkpKSkpLnN1YnNjcmliZSh0aGlzLl9jcmVhdGUkKSx0aGlzLl9zZXRWZXJ0ZXhTdWJzY3JpcHRpb249dGhpcy5fdGFnQ3JlYXRvci50YWckLnBpcGUocmkoKHQ9PnQ/Z3QoRyh0KSxPdCh0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlTW92ZSQsdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5kb21Nb3VzZU1vdmUkKSx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQpOkIoKSkpKS5zdWJzY3JpYmUoKChbdCxlLGksbl0pPT57Y29uc3Qgcj10aGlzLl9tb3VzZUV2ZW50VG9CYXNpYyhlLHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIsaSxuKTt0aGlzLl9zZXRWZXJ0ZXgyZCh0LHIsbil9KSksdGhpcy5fYWRkUG9pbnRTdWJzY3JpcHRpb249dGhpcy5fdGFnQ3JlYXRvci50YWckLnBpcGUocmkoKHQ9PnQ/Z3QoRyh0KSxlKTpCKCkpKSkuc3Vic2NyaWJlKCgoW3QsZV0pPT57dGhpcy5fYWRkUG9pbnQodCxlKX0pKSx0aGlzLl9nZW9tZXRyeUNyZWF0ZVN1YnNjcmlwdGlvbj10aGlzLl90YWdDcmVhdG9yLnRhZyQucGlwZShyaSgodD0+dD90LmNyZWF0ZWQkLnBpcGUocnQoKHQ9PnQuZ2VvbWV0cnkpKSk6QigpKSkpLnN1YnNjcmliZSh0aGlzLl9nZW9tZXRyeUNyZWF0ZWQkKX1fZGlzYWJsZUNyZWF0ZSgpe3RoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UudW5kZWZlclBpeGVscyh0aGlzLl9uYW1lKSx0aGlzLl90YWdDcmVhdG9yLmRlbGV0ZSQubmV4dChudWxsKSx0aGlzLl9hZGRQb2ludFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX2NyZWF0ZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX2RlbGV0ZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX2dlb21ldHJ5Q3JlYXRlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fc2V0VmVydGV4U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCl9fWNsYXNzIHZ2IGV4dGVuZHMgX3Z7Z2V0IF9jcmVhdGUkKCl7cmV0dXJuIHRoaXMuX3RhZ0NyZWF0b3IuY3JlYXRlUG9pbnRzJH1fYWRkUG9pbnQodCxlKXt0Lmdlb21ldHJ5LmFkZFBvaW50MmQoZSl9X2dldE5hbWVFeHRlbnNpb24oKXtyZXR1cm5cImNyZWF0ZS1wb2ludHNcIn1fc2V0VmVydGV4MmQodCxlLGkpe3QuZ2VvbWV0cnkuc2V0UG9pbnQyZCh0Lmdlb21ldHJ5LnBvaW50cy5sZW5ndGgtMSxlLGkpfX1jbGFzcyB5diBleHRlbmRzIF92e2dldCBfY3JlYXRlJCgpe3JldHVybiB0aGlzLl90YWdDcmVhdG9yLmNyZWF0ZVBvbHlnb24kfV9hZGRQb2ludCh0LGUpe3QuYWRkUG9pbnQoZSl9X2dldE5hbWVFeHRlbnNpb24oKXtyZXR1cm5cImNyZWF0ZS1wb2x5Z29uXCJ9X3NldFZlcnRleDJkKHQsZSxpKXt0Lmdlb21ldHJ5LnNldFZlcnRleDJkKHQuZ2VvbWV0cnkucG9seWdvbi5sZW5ndGgtMixlLGkpfX1jbGFzcyBidiBleHRlbmRzIF92e2dldCBfY3JlYXRlJCgpe3JldHVybiB0aGlzLl90YWdDcmVhdG9yLmNyZWF0ZVJlY3QkfV9hZGRQb2ludCh0LGUpe2NvbnN0IGk9dC5nZW9tZXRyeTtpLnZhbGlkYXRlKGUpfHwoZT1pLmdldE5vbkFkanVzdGVkVmVydGV4MmQoMykpLHQuYWRkUG9pbnQoZSl9X2VuYWJsZSgpe3N1cGVyLl9lbmFibGUoKSx0aGlzLl9pbml0aWFsaXplQW5jaG9ySW5kZXhpbmdTdWJzY3JpcHRpb249dGhpcy5fdGFnQ3JlYXRvci50YWckLnBpcGUoTnQoKHQ9PiEhdCkpKS5zdWJzY3JpYmUoKHQ9Pnt0Lmdlb21ldHJ5LmluaXRpYWxpemVBbmNob3JJbmRleGluZygpfSkpfV9kaXNhYmxlKCl7c3VwZXIuX2Rpc2FibGUoKSx0aGlzLl9pbml0aWFsaXplQW5jaG9ySW5kZXhpbmdTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKX1fZ2V0TmFtZUV4dGVuc2lvbigpe3JldHVyblwiY3JlYXRlLXJlY3RcIn1fc2V0VmVydGV4MmQodCxlLGkpe3QuZ2VvbWV0cnkuc2V0T3Bwb3NpdGVWZXJ0ZXgyZChlLGkpfX1jbGFzcyB4diBleHRlbmRzIG12e19lbmFibGVDcmVhdGUoKXt0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmNsYWltTW91c2UodGhpcy5fbmFtZSwyKSx0aGlzLl9kZWxldGVTdWJzY3JpcHRpb249dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJC5waXBlKHJ0KCh0PT5udWxsKSksSmUoMSkpLnN1YnNjcmliZSh0aGlzLl90YWdDcmVhdG9yLmRlbGV0ZSQpLHRoaXMuX2NyZWF0ZVN1YnNjcmlwdGlvbj10aGlzLl9tb3VzZUV2ZW50VG9CYXNpYyQodGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5maWx0ZXJlZCQodGhpcy5fbmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZ1N0YXJ0JCkpLnBpcGUoTnQodGhpcy5fdmFsaWRhdGVCYXNpYykpLnN1YnNjcmliZSh0aGlzLl90YWdDcmVhdG9yLmNyZWF0ZVJlY3QkKSx0aGlzLl9pbml0aWFsaXplQW5jaG9ySW5kZXhpbmdTdWJzY3JpcHRpb249dGhpcy5fdGFnQ3JlYXRvci50YWckLnBpcGUoTnQoKHQ9PiEhdCkpKS5zdWJzY3JpYmUoKHQ9Pnt0Lmdlb21ldHJ5LmluaXRpYWxpemVBbmNob3JJbmRleGluZygpfSkpO2NvbnN0IHQ9Z3QoT3QodGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5maWx0ZXJlZCQodGhpcy5fbmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlTW92ZSQpLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuZmlsdGVyZWQkKHRoaXMuX25hbWUsdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5kb21Nb3VzZU1vdmUkKSksdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCkucGlwZShiaSh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKSxydCgoKFtbdCxlXSxpXSk9PnRoaXMuX21vdXNlRXZlbnRUb0Jhc2ljKHQsdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcixlLGkpKSkpO3RoaXMuX3NldFZlcnRleFN1YnNjcmlwdGlvbj10aGlzLl90YWdDcmVhdG9yLnRhZyQucGlwZShyaSgoZT0+ZT9ndChHKGUpLHQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCk6QigpKSkpLnN1YnNjcmliZSgoKFt0LGUsaV0pPT57dC5nZW9tZXRyeS5zZXRPcHBvc2l0ZVZlcnRleDJkKGUsaSl9KSk7Y29uc3QgZT10aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZ0VuZCQucGlwZShiaSh0aGlzLl9tb3VzZUV2ZW50VG9CYXNpYyQodGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5maWx0ZXJlZCQodGhpcy5fbmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRHJhZyQpKS5waXBlKE50KHRoaXMuX3ZhbGlkYXRlQmFzaWMpKSwoKHQsZSk9PmUpKSxaZSgpKTt0aGlzLl9hZGRQb2ludFN1YnNjcmlwdGlvbj10aGlzLl90YWdDcmVhdG9yLnRhZyQucGlwZShyaSgodD0+dD9ndChHKHQpLGUpOkIoKSkpKS5zdWJzY3JpYmUoKChbdCxlXSk9Pntjb25zdCBpPXQuZ2VvbWV0cnk7aS52YWxpZGF0ZShlKXx8KGU9aS5nZXROb25BZGp1c3RlZFZlcnRleDJkKDMpKSx0LmFkZFBvaW50KGUpfSkpLHRoaXMuX2dlb21ldHJ5Q3JlYXRlZFN1YnNjcmlwdGlvbj10aGlzLl90YWdDcmVhdG9yLnRhZyQucGlwZShyaSgodD0+dD90LmNyZWF0ZWQkLnBpcGUocnQoKHQ9PnQuZ2VvbWV0cnkpKSk6QigpKSkpLnN1YnNjcmliZSh0aGlzLl9nZW9tZXRyeUNyZWF0ZWQkKX1fZGlzYWJsZUNyZWF0ZSgpe3RoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UudW5jbGFpbU1vdXNlKHRoaXMuX25hbWUpLHRoaXMuX3RhZ0NyZWF0b3IuZGVsZXRlJC5uZXh0KG51bGwpLHRoaXMuX2FkZFBvaW50U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fY3JlYXRlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fZGVsZXRlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fZ2VvbWV0cnlDcmVhdGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5faW5pdGlhbGl6ZUFuY2hvckluZGV4aW5nU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fc2V0VmVydGV4U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCl9X2dldE5hbWVFeHRlbnNpb24oKXtyZXR1cm5cImNyZWF0ZS1yZWN0LWRyYWdcIn19Y2xhc3Mgd3YgZXh0ZW5kcyBmdntjb25zdHJ1Y3Rvcih0LGUsaSxuLHIpe3N1cGVyKHQsZSxpLG4pLHRoaXMuX3RhZ1NldD1yfV9lbmFibGUoKXtjb25zdCB0PXRoaXMuX3RhZ1NldC5jaGFuZ2VkJC5waXBlKHJ0KCh0PT50LmdldEFsbCgpKSkscmkoKHQ9PmJ0KHQpLnBpcGUoTXQoKHQ9PnQuaW50ZXJhY3QkKSkpKSkscmkoKHQ9PkF0KEcodCksdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5kb2N1bWVudE1vdXNlVXAkLnBpcGUocnQoKCgpPT4oe29mZnNldFg6MCxvZmZzZXRZOjAsb3BlcmF0aW9uOnR2Lk5vbmUsdGFnOm51bGx9KSkpLEVlKCkpKSkpLFplKCkpO090KHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VNb3ZlJCx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRvbU1vdXNlTW92ZSQpLnBpcGUoWmUoKSksdGhpcy5fY2xhaW1Nb3VzZVN1YnNjcmlwdGlvbj10LnBpcGUocmkoKHQ9PnQudGFnP3RoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuZG9tTW91c2VEcmFnU3RhcnQkOkIoKSkpKS5zdWJzY3JpYmUoKCgpPT57dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5jbGFpbU1vdXNlKHRoaXMuX25hbWUsMyl9KSksdGhpcy5fY3Vyc29yU3Vic2NyaXB0aW9uPXQucGlwZShydCgodD0+dC5jdXJzb3IpKSx1ZSgpKS5zdWJzY3JpYmUoKHQ9Pntjb25zdCBlPVtcImNyb3NzaGFpclwiLFwibW92ZVwiLFwibmVzdy1yZXNpemVcIixcIm53c2UtcmVzaXplXCJdO2Zvcihjb25zdCB0IG9mIGUpdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKGBjb21wb25lbnQtdGFnLWVkaXQtJHt0fWApO3QmJnRoaXMuX2NvbnRhaW5lci5jb250YWluZXIuY2xhc3NMaXN0LmFkZChgY29tcG9uZW50LXRhZy1lZGl0LSR7dH1gKX0pKSx0aGlzLl91bmNsYWltTW91c2VTdWJzY3JpcHRpb249dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5maWx0ZXJlZCQodGhpcy5fbmFtZSx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRvbU1vdXNlRHJhZ0VuZCQpLnN1YnNjcmliZSgodD0+e3RoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UudW5jbGFpbU1vdXNlKHRoaXMuX25hbWUpfSkpLHRoaXMuX3ByZXZlbnREZWZhdWx0U3Vic2NyaXB0aW9uPXQucGlwZShyaSgodD0+dC50YWc/dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5kb2N1bWVudE1vdXNlTW92ZSQ6QigpKSkpLnN1YnNjcmliZSgodD0+e3QucHJldmVudERlZmF1bHQoKX0pKSx0aGlzLl91cGRhdGVHZW9tZXRyeVN1YnNjcmlwdGlvbj10LnBpcGUocmkoKHQ9PntpZih0Lm9wZXJhdGlvbj09PXR2Lk5vbmV8fCF0LnRhZylyZXR1cm4gQigpO3JldHVybiBndCh0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmZpbHRlcmVkJCh0aGlzLl9uYW1lLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UuZG9tTW91c2VEcmFnJCkucGlwZShOdCgodD0+dGhpcy5fdmlld3BvcnRDb29yZHMuaW5zaWRlRWxlbWVudCh0LHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIpKSkpLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQpLnBpcGUoYmkoRyh0KSx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kLCgoW3QsZV0saSxuKT0+W3QsZSxpLG5dKSkpfSkpKS5zdWJzY3JpYmUoKChbdCxlLGksbl0pPT57Y29uc3Qgcj10aGlzLl9tb3VzZUV2ZW50VG9CYXNpYyh0LHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIsZSxuLGkub2Zmc2V0WCxpLm9mZnNldFkpLHM9aS50YWcuZ2VvbWV0cnk7aS5vcGVyYXRpb249PT10di5DZW50cm9pZD9zLnNldENlbnRyb2lkMmQocixuKTppLm9wZXJhdGlvbj09PXR2LlZlcnRleCYmcy5zZXRWZXJ0ZXgyZChpLnZlcnRleEluZGV4LHIsbil9KSl9X2Rpc2FibGUoKXt0aGlzLl9jbGFpbU1vdXNlU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fY3Vyc29yU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fcHJldmVudERlZmF1bHRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl91bmNsYWltTW91c2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKSx0aGlzLl91cGRhdGVHZW9tZXRyeVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfV9nZXROYW1lRXh0ZW5zaW9uKCl7cmV0dXJuXCJlZGl0LXZlcnRleFwifX1jbGFzcyBTdiBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUsaSksdGhpcy5fdGFnRG9tUmVuZGVyZXI9bmV3IEpfLHRoaXMuX3RhZ1NjZW5lPW5ldyBLXyx0aGlzLl90YWdTZXQ9bmV3IGR2LHRoaXMuX3RhZ0NyZWF0b3I9bmV3IFpfKHRoaXMsaSksdGhpcy5fdmlld3BvcnRDb29yZHM9bmV3IFdmLHRoaXMuX2NyZWF0ZUhhbmRsZXJzPXtDcmVhdGVQb2ludDpuZXcgZ3YodGhpcyxlLGksdGhpcy5fdmlld3BvcnRDb29yZHMsdGhpcy5fdGFnQ3JlYXRvciksQ3JlYXRlUG9pbnRzOm5ldyB2dih0aGlzLGUsaSx0aGlzLl92aWV3cG9ydENvb3Jkcyx0aGlzLl90YWdDcmVhdG9yKSxDcmVhdGVQb2x5Z29uOm5ldyB5dih0aGlzLGUsaSx0aGlzLl92aWV3cG9ydENvb3Jkcyx0aGlzLl90YWdDcmVhdG9yKSxDcmVhdGVSZWN0Om5ldyBidih0aGlzLGUsaSx0aGlzLl92aWV3cG9ydENvb3Jkcyx0aGlzLl90YWdDcmVhdG9yKSxDcmVhdGVSZWN0RHJhZzpuZXcgeHYodGhpcyxlLGksdGhpcy5fdmlld3BvcnRDb29yZHMsdGhpcy5fdGFnQ3JlYXRvciksRGVmYXVsdDp2b2lkIDB9LHRoaXMuX2VkaXRWZXJ0ZXhIYW5kbGVyPW5ldyB3dih0aGlzLGUsaSx0aGlzLl92aWV3cG9ydENvb3Jkcyx0aGlzLl90YWdTZXQpLHRoaXMuX3JlbmRlclRhZ3MkPXRoaXMuX3RhZ1NldC5jaGFuZ2VkJC5waXBlKHJ0KCh0PT57Y29uc3QgZT10LmdldEFsbCgpO3JldHVybiBlLnNvcnQoKCh0LGUpPT57Y29uc3QgaT10LnRhZy5pZCxuPWUudGFnLmlkO3JldHVybiBpPG4/LTE6aT5uPzE6MH0pKSxlfSkpLFplKCkpLHRoaXMuX3RhZ0NoYW5nZWQkPXRoaXMuX3JlbmRlclRhZ3MkLnBpcGUocmkoKHQ9PmJ0KHQpLnBpcGUoTXQoKHQ9Pk90KHQudGFnLmNoYW5nZWQkLHQudGFnLmdlb21ldHJ5Q2hhbmdlZCQpKSkpKSksWmUoKSksdGhpcy5fcmVuZGVyVGFnR0xDaGFuZ2VkJD10aGlzLl9yZW5kZXJUYWdzJC5waXBlKHJpKCh0PT5idCh0KS5waXBlKE10KCh0PT50LmdsT2JqZWN0c0NoYW5nZWQkKSkpKSksWmUoKSksdGhpcy5fY3JlYXRlR2VvbWV0cnlDaGFuZ2VkJD10aGlzLl90YWdDcmVhdG9yLnRhZyQucGlwZShyaSgodD0+bnVsbCE9dD90Lmdlb21ldHJ5Q2hhbmdlZCQ6QigpKSksWmUoKSksdGhpcy5fY3JlYXRlR0xPYmplY3RzQ2hhbmdlZCQ9dGhpcy5fdGFnQ3JlYXRvci50YWckLnBpcGUocmkoKHQ9Pm51bGwhPXQ/dC5nbE9iamVjdHNDaGFuZ2VkJDpCKCkpKSxaZSgpKSx0aGlzLl9jcmVhdGluZ0NvbmZpZ3VyYXRpb24kPXRoaXMuX2NvbmZpZ3VyYXRpb24kLnBpcGUodWUoKCh0LGUpPT50Lm1vZGU9PT1lLm1vZGUpLCh0PT4oe2NyZWF0ZUNvbG9yOnQuY3JlYXRlQ29sb3IsbW9kZTp0Lm1vZGV9KSkpLFVlKDEpLEUoKSksdGhpcy5fY3JlYXRpbmdDb25maWd1cmF0aW9uJC5zdWJzY3JpYmUoKHQ9Pntjb25zdCBlPVwidGFnbW9kZVwiLGk9e21vZGU6dC5tb2RlLHRhcmdldDp0aGlzLHR5cGU6ZX07dGhpcy5maXJlKGUsaSl9KSl9YWRkKHQpe3RoaXMuX2FjdGl2YXRlZD90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kLnBpcGUoRWUoKSkuc3Vic2NyaWJlKChlPT57dGhpcy5fdGFnU2V0LmFkZCh0LGUpO2NvbnN0IGk9dC5tYXAoKHQ9PnRoaXMuX3RhZ1NldC5nZXQodC5pZCkpKTt0aGlzLl90YWdTY2VuZS5hZGQoaSl9KSk6dGhpcy5fdGFnU2V0LmFkZERlYWN0aXZhdGVkKHQpfWNhbGN1bGF0ZVJlY3QodCl7cmV0dXJuIG5ldyBQcm9taXNlKCgoZSxpKT0+e3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQucGlwZShFZSgpLHJ0KChlPT50LmdldFJlY3QyZChlKSkpKS5zdWJzY3JpYmUoKHQ9PntlKHQpfSksKHQ9PntpKHQpfSkpfSkpfWNyZWF0ZSgpe3RoaXMuX3RhZ0NyZWF0b3IucmVwbGF5ZWRUYWckLnBpcGUoRWUoKSxOdCgodD0+ISF0KSkpLnN1YnNjcmliZSgodD0+e3QuY3JlYXRlKCl9KSl9Y2hhbmdlTW9kZSh0KXt0aGlzLmNvbmZpZ3VyZSh7bW9kZTp0fSl9ZmlyZSh0LGUpe3N1cGVyLmZpcmUodCxlKX1nZXQodCl7aWYodGhpcy5fYWN0aXZhdGVkKXtjb25zdCBlPXRoaXMuX3RhZ1NldC5nZXQodCk7cmV0dXJuIHZvaWQgMCE9PWU/ZS50YWc6dm9pZCAwfXJldHVybiB0aGlzLl90YWdTZXQuZ2V0RGVhY3RpdmF0ZWQodCl9Z2V0QWxsKCl7cmV0dXJuIHRoaXMuYWN0aXZhdGVkP3RoaXMuX3RhZ1NldC5nZXRBbGwoKS5tYXAoKHQ9PnQudGFnKSk6dGhpcy5fdGFnU2V0LmdldEFsbERlYWN0aXZhdGVkKCl9Z2V0VGFnSWRzQXQodCl7cmV0dXJuIG5ldyBQcm9taXNlKCgoZSxpKT0+e3RoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQucGlwZShFZSgpLHJ0KChlPT57Y29uc3QgaT10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNUb1ZpZXdwb3J0KHRbMF0sdFsxXSx0aGlzLl9jb250YWluZXIuY29udGFpbmVyKTtyZXR1cm4gdGhpcy5fdGFnU2NlbmUuaW50ZXJzZWN0T2JqZWN0cyhpLGUucGVyc3BlY3RpdmUpfSkpKS5zdWJzY3JpYmUoKHQ9PntlKHQpfSksKHQ9PntpKHQpfSkpfSkpfWhhcyh0KXtyZXR1cm4gdGhpcy5fYWN0aXZhdGVkP3RoaXMuX3RhZ1NldC5oYXModCk6dGhpcy5fdGFnU2V0Lmhhc0RlYWN0aXZhdGVkKHQpfW9mZih0LGUpe3N1cGVyLm9mZih0LGUpfW9uKHQsZSl7c3VwZXIub24odCxlKX1yZW1vdmUodCl7dGhpcy5fYWN0aXZhdGVkPyh0aGlzLl90YWdTZXQucmVtb3ZlKHQpLHRoaXMuX3RhZ1NjZW5lLnJlbW92ZSh0KSk6dGhpcy5fdGFnU2V0LnJlbW92ZURlYWN0aXZhdGVkKHQpfXJlbW92ZUFsbCgpe3RoaXMuX2FjdGl2YXRlZD8odGhpcy5fdGFnU2V0LnJlbW92ZUFsbCgpLHRoaXMuX3RhZ1NjZW5lLnJlbW92ZUFsbCgpKTp0aGlzLl90YWdTZXQucmVtb3ZlQWxsRGVhY3RpdmF0ZWQoKX1fYWN0aXZhdGUoKXt0aGlzLl9lZGl0VmVydGV4SGFuZGxlci5lbmFibGUoKTtjb25zdCBlPWJ0KE9iamVjdC5rZXlzKHRoaXMuX2NyZWF0ZUhhbmRsZXJzKSkucGlwZShydCgodD0+dGhpcy5fY3JlYXRlSGFuZGxlcnNbdF0pKSxOdCgodD0+ISF0KSksTXQoKHQ9PnQuZ2VvbWV0cnlDcmVhdGVkJCkpLFplKCkpLGk9dGhpcy5fc3Vic2NyaXB0aW9ucztpLnB1c2goZS5zdWJzY3JpYmUoKHQ9Pntjb25zdCBlPVwiZ2VvbWV0cnljcmVhdGVcIixpPXtnZW9tZXRyeTp0LHRhcmdldDp0aGlzLHR5cGU6ZX07dGhpcy5maXJlKGUsaSl9KSkpLGkucHVzaCh0aGlzLl90YWdDcmVhdG9yLnRhZyQucGlwZSh0aSgodD0+bnVsbD09dCkpLHVlKCkpLnN1YnNjcmliZSgodD0+e2NvbnN0IGU9bnVsbCE9dD9cInRhZ2NyZWF0ZXN0YXJ0XCI6XCJ0YWdjcmVhdGVlbmRcIixpPXt0YXJnZXQ6dGhpcyx0eXBlOmV9O3RoaXMuZmlyZShlLGkpfSkpKSxpLnB1c2goZS5zdWJzY3JpYmUoKCgpPT57dGhpcy5jaGFuZ2VNb2RlKHQuVGFnTW9kZS5EZWZhdWx0KX0pKSksaS5wdXNoKHRoaXMuX2NyZWF0aW5nQ29uZmlndXJhdGlvbiQuc3Vic2NyaWJlKChlPT57dGhpcy5fZGlzYWJsZUNyZWF0ZUhhbmRsZXJzKCk7Y29uc3QgaT10LlRhZ01vZGVbZS5tb2RlXSxuPXRoaXMuX2NyZWF0ZUhhbmRsZXJzW2ldO24mJm4uZW5hYmxlKCl9KSkpLGkucHVzaCh0aGlzLl9yZW5kZXJUYWdzJC5zdWJzY3JpYmUoKCgpPT57Y29uc3QgdD1cInRhZ3NcIixlPXt0YXJnZXQ6dGhpcyx0eXBlOnR9O3RoaXMuZmlyZSh0LGUpfSkpKSxpLnB1c2godGhpcy5fdGFnQ3JlYXRvci50YWckLnBpcGUocmkoKHQ9Pm51bGwhPXQ/dC5hYm9ydGVkJC5waXBlKHJ0KCgoKT0+bnVsbCkpKTpCKCkpKSkuc3Vic2NyaWJlKCgoKT0+e3RoaXMuY2hhbmdlTW9kZSh0LlRhZ01vZGUuRGVmYXVsdCl9KSkpLGkucHVzaCh0aGlzLl90YWdDcmVhdG9yLnRhZyQuc3Vic2NyaWJlKCh0PT57dGhpcy5fdGFnU2NlbmUuaGFzQ3JlYXRlVGFnKCkmJnRoaXMuX3RhZ1NjZW5lLnJlbW92ZUNyZWF0ZVRhZygpLG51bGwhPXQmJnRoaXMuX3RhZ1NjZW5lLmFkZENyZWF0ZVRhZyh0KX0pKSksaS5wdXNoKHRoaXMuX2NyZWF0ZUdMT2JqZWN0c0NoYW5nZWQkLnN1YnNjcmliZSgodD0+e3RoaXMuX3RhZ1NjZW5lLnVwZGF0ZUNyZWF0ZVRhZ09iamVjdHModCl9KSkpLGkucHVzaCh0aGlzLl9yZW5kZXJUYWdHTENoYW5nZWQkLnN1YnNjcmliZSgodD0+e3RoaXMuX3RhZ1NjZW5lLnVwZGF0ZU9iamVjdHModCl9KSkpLGkucHVzaCh0aGlzLl90YWdDaGFuZ2VkJC5zdWJzY3JpYmUoKCgpPT57dGhpcy5fdGFnU2NlbmUudXBkYXRlKCl9KSkpLGkucHVzaChndCh0aGlzLl9yZW5kZXJUYWdzJC5waXBlKG5pKFtdKSxwaSgoKCk9Pnt0aGlzLl9jb250YWluZXIuZG9tUmVuZGVyZXIucmVuZGVyJC5uZXh0KHtuYW1lOnRoaXMuX25hbWUsdk5vZGU6dGhpcy5fdGFnRG9tUmVuZGVyZXIuY2xlYXIoKX0pfSkpKSx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX2NvbnRhaW5lci5zcHJpdGVTZXJ2aWNlLnNwcml0ZUF0bGFzJCx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5zaXplJCx0aGlzLl90YWdDaGFuZ2VkJC5waXBlKG5pKG51bGwpKSxPdCh0aGlzLl90YWdDcmVhdG9yLnRhZyQsdGhpcy5fY3JlYXRlR2VvbWV0cnlDaGFuZ2VkJCkucGlwZShuaShudWxsKSkpLnBpcGUocnQoKChbdCxlLGksbiwscl0pPT4oe25hbWU6dGhpcy5fbmFtZSx2Tm9kZTp0aGlzLl90YWdEb21SZW5kZXJlci5yZW5kZXIodCxyLGksZS5wZXJzcGVjdGl2ZSxuKX0pKSkpLnN1YnNjcmliZSh0aGlzLl9jb250YWluZXIuZG9tUmVuZGVyZXIucmVuZGVyJCkpLGkucHVzaCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShydCgodD0+e2NvbnN0IGU9dGhpcy5fdGFnU2NlbmU7cmV0dXJue25hbWU6dGhpcy5fbmFtZSxyZW5kZXJlcjp7ZnJhbWVJZDp0LmlkLG5lZWRzUmVuZGVyOmUubmVlZHNSZW5kZXIscmVuZGVyOmUucmVuZGVyLmJpbmQoZSkscGFzczpybS5PcGFxdWV9fX0pKSkuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLnJlbmRlciQpKSx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kLnBpcGUoRWUoKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fdGFnU2V0LmFjdGl2YXRlKHQpLHRoaXMuX3RhZ1NjZW5lLmFkZCh0aGlzLl90YWdTZXQuZ2V0QWxsKCkpfSkpfV9kZWFjdGl2YXRlKCl7dGhpcy5fZWRpdFZlcnRleEhhbmRsZXIuZGlzYWJsZSgpLHRoaXMuX2Rpc2FibGVDcmVhdGVIYW5kbGVycygpLHRoaXMuX3RhZ1NjZW5lLmNsZWFyKCksdGhpcy5fdGFnU2V0LmRlYWN0aXZhdGUoKSx0aGlzLl90YWdDcmVhdG9yLmRlbGV0ZSQubmV4dChudWxsKSx0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCksdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiY29tcG9uZW50LXRhZy1jcmVhdGVcIil9X2dldERlZmF1bHRDb25maWd1cmF0aW9uKCl7cmV0dXJue2NyZWF0ZUNvbG9yOjE2Nzc3MjE1LGluZGljYXRlUG9pbnRzQ29tcGxldGVyOiEwLG1vZGU6dC5UYWdNb2RlLkRlZmF1bHR9fV9kaXNhYmxlQ3JlYXRlSGFuZGxlcnMoKXtjb25zdCB0PXRoaXMuX2NyZWF0ZUhhbmRsZXJzO2Zvcihjb25zdCBlIGluIHQpe2lmKCF0Lmhhc093blByb3BlcnR5KGUpKWNvbnRpbnVlO2NvbnN0IGk9dFtlXTtpJiZpLmRpc2FibGUoKX19fVN2LmNvbXBvbmVudE5hbWU9XCJ0YWdcIjtjbGFzcyBNdiBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUsaSksdGhpcy5fdmlld3BvcnRDb29yZHM9bmV3IFdmLHRoaXMuX3pvb21EZWx0YSQ9bmV3IFR9X2FjdGl2YXRlKCl7Y29uc3QgZT10aGlzLl9zdWJzY3JpcHRpb25zO2UucHVzaChndCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zdGF0ZSQsdGhpcy5fY29uZmlndXJhdGlvbiQsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQpLnBpcGUocnQoKChbZSxpLG4scl0pPT57Y29uc3Qgcz1lLnN0YXRlLnpvb20sbz1qZi5oKFwiZGl2Lm1hcGlsbGFyeS16b29tLWluLWljb25cIixbXSksYT1zPj0zfHxpPT09dm0uV2FpdGluZz9qZi5oKFwiZGl2Lm1hcGlsbGFyeS16b29tLWluLWJ1dHRvbi1pbmFjdGl2ZVwiLFtvXSk6amYuaChcImRpdi5tYXBpbGxhcnktem9vbS1pbi1idXR0b25cIix7b25jbGljazooKT0+e3RoaXMuX3pvb21EZWx0YSQubmV4dCgxKX19LFtvXSksYz1qZi5oKFwiZGl2Lm1hcGlsbGFyeS16b29tLW91dC1pY29uXCIsW10pLGg9czw9MHx8aT09PXZtLldhaXRpbmc/amYuaChcImRpdi5tYXBpbGxhcnktem9vbS1vdXQtYnV0dG9uLWluYWN0aXZlXCIsW2NdKTpqZi5oKFwiZGl2Lm1hcGlsbGFyeS16b29tLW91dC1idXR0b25cIix7b25jbGljazooKT0+e3RoaXMuX3pvb21EZWx0YSQubmV4dCgtMSl9fSxbY10pLGw9bi5zaXplPT09dC5Db21wb25lbnRTaXplLlNtYWxsfHxuLnNpemU9PT10LkNvbXBvbmVudFNpemUuQXV0b21hdGljJiZyLndpZHRoPDY0MD9cIi5tYXBpbGxhcnktem9vbS1jb21wYWN0XCI6XCJcIjtyZXR1cm57bmFtZTp0aGlzLl9uYW1lLHZOb2RlOmpmLmgoXCJkaXYubWFwaWxsYXJ5LXpvb20tY29udGFpbmVyXCIrbCx7b25jb250ZXh0bWVudTp0PT57dC5wcmV2ZW50RGVmYXVsdCgpfX0sW2EsaF0pfX0pKSkuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lci5kb21SZW5kZXJlci5yZW5kZXIkKSksZS5wdXNoKHRoaXMuX3pvb21EZWx0YSQucGlwZShiaSh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQpKS5zdWJzY3JpYmUoKChbdCxlLGldKT0+e2NvbnN0IG49dGhpcy5fdmlld3BvcnRDb29yZHMudW5wcm9qZWN0RnJvbVZpZXdwb3J0KDAsMCxlLnBlcnNwZWN0aXZlKSxyPWkucHJvamVjdEJhc2ljKG4udG9BcnJheSgpKTt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnpvb21Jbih0LHIpfSkpKX1fZGVhY3RpdmF0ZSgpe3RoaXMuX3N1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKX1fZ2V0RGVmYXVsdENvbmZpZ3VyYXRpb24oKXtyZXR1cm57c2l6ZTp0LkNvbXBvbmVudFNpemUuQXV0b21hdGljfX19TXYuY29tcG9uZW50TmFtZT1cInpvb21cIjtjbGFzcyBUdiBleHRlbmRzIFZme2NvbnN0cnVjdG9yKHQsZSxpLG4pe3N1cGVyKHQsZSxpKSx0aGlzLl9jYW52YXNJZD1gJHtlLmlkfS0ke3RoaXMuX25hbWV9YCx0aGlzLl9kb209bnx8bmV3IFhtfV9hY3RpdmF0ZSgpe2NvbnN0IHQ9dGhpcy5fY29udGFpbmVyLmRvbVJlbmRlcmVyLmVsZW1lbnQkLnBpcGUocnQoKCgpPT50aGlzLl9kb20uZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5fY2FudmFzSWQpKSksTnQoKHQ9PiEhdCkpLHJ0KCh0PT57Y29uc3QgZT10LnBhcmVudEVsZW1lbnQsaT1lLm9mZnNldFdpZHRoO3JldHVyblt0LHtoZWlnaHQ6ZS5vZmZzZXRIZWlnaHQsd2lkdGg6aX1dfSkpLHVlKCgodCxlKT0+dC5oZWlnaHQ9PT1lLmhlaWdodCYmdC53aWR0aD09PWUud2lkdGgpLCgoWyx0XSk9PnQpKSk7dGhpcy5fc3Vic2NyaXB0aW9ucy5wdXNoKGd0KHQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkKS5zdWJzY3JpYmUoKChbW3QsZV0saV0pPT57dC53aWR0aD1lLndpZHRoLHQuaGVpZ2h0PWUuaGVpZ2h0LHQuZ2V0Q29udGV4dChcIjJkXCIpLmRyYXdJbWFnZShpLmltYWdlLDAsMCxlLndpZHRoLGUuaGVpZ2h0KX0pKSksdGhpcy5fY29udGFpbmVyLmRvbVJlbmRlcmVyLnJlbmRlckFkYXB0aXZlJC5uZXh0KHtuYW1lOnRoaXMuX25hbWUsdk5vZGU6amYuaChgY2FudmFzIyR7dGhpcy5fY2FudmFzSWR9YCxbXSl9KX1fZGVhY3RpdmF0ZSgpe3RoaXMuX3N1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKX1fZ2V0RGVmYXVsdENvbmZpZ3VyYXRpb24oKXtyZXR1cm57fX19VHYuY29tcG9uZW50TmFtZT1cImltYWdlZmFsbGJhY2tcIjtjbGFzcyBDdiBleHRlbmRzIFZme2NvbnN0cnVjdG9yKGUsaSxuKXtzdXBlcihlLGksbiksdGhpcy5fc2VxTmFtZXM9e30sdGhpcy5fc2VxTmFtZXNbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5QcmV2XV09XCItcHJldlwiLHRoaXMuX3NlcU5hbWVzW3QuTmF2aWdhdGlvbkRpcmVjdGlvblt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uTmV4dF1dPVwiLW5leHRcIix0aGlzLl9zcGFUb3BOYW1lcz17fSx0aGlzLl9zcGFUb3BOYW1lc1t0Lk5hdmlnYXRpb25EaXJlY3Rpb25bdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5MZWZ0XV09XCItdHVybi1sZWZ0XCIsdGhpcy5fc3BhVG9wTmFtZXNbdC5OYXZpZ2F0aW9uRGlyZWN0aW9uW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5TdGVwTGVmdF1dPVwiLWxlZnRcIix0aGlzLl9zcGFUb3BOYW1lc1t0Lk5hdmlnYXRpb25EaXJlY3Rpb25bdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBGb3J3YXJkXV09XCItZm9yd2FyZFwiLHRoaXMuX3NwYVRvcE5hbWVzW3QuTmF2aWdhdGlvbkRpcmVjdGlvblt0Lk5hdmlnYXRpb25EaXJlY3Rpb24uU3RlcFJpZ2h0XV09XCItcmlnaHRcIix0aGlzLl9zcGFUb3BOYW1lc1t0Lk5hdmlnYXRpb25EaXJlY3Rpb25bdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5SaWdodF1dPVwiLXR1cm4tcmlnaHRcIix0aGlzLl9zcGFCb3R0b21OYW1lcz17fSx0aGlzLl9zcGFCb3R0b21OYW1lc1t0Lk5hdmlnYXRpb25EaXJlY3Rpb25bdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlR1cm5VXV09XCItdHVybi1hcm91bmRcIix0aGlzLl9zcGFCb3R0b21OYW1lc1t0Lk5hdmlnYXRpb25EaXJlY3Rpb25bdC5OYXZpZ2F0aW9uRGlyZWN0aW9uLlN0ZXBCYWNrd2FyZF1dPVwiLWJhY2t3YXJkXCJ9X2FjdGl2YXRlKCl7dGhpcy5fc3Vic2NyaXB0aW9ucy5wdXNoKGd0KHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlJCx0aGlzLl9jb25maWd1cmF0aW9uJCkucGlwZShyaSgoKFt0LGVdKT0+Z3QoZS5zZXF1ZW5jZT90LnNlcXVlbmNlRWRnZXMkLnBpcGUocnQoKHQ9PnQuZWRnZXMubWFwKCh0PT50LmRhdGEuZGlyZWN0aW9uKSkpKSk6RyhbXSksIWRkKHQuY2FtZXJhVHlwZSkmJmUuc3BhdGlhbD90LnNwYXRpYWxFZGdlcyQucGlwZShydCgodD0+dC5lZGdlcy5tYXAoKHQ9PnQuZGF0YS5kaXJlY3Rpb24pKSkpKTpHKFtdKSkucGlwZShydCgoKFt0LGVdKT0+dC5jb25jYXQoZSkpKSkpKSxydCgodD0+e2NvbnN0IGU9dGhpcy5fY3JlYXRlQXJyb3dSb3codGhpcy5fc2VxTmFtZXMsdCksaT10aGlzLl9jcmVhdGVBcnJvd1Jvdyh0aGlzLl9zcGFUb3BOYW1lcyx0KSxuPXRoaXMuX2NyZWF0ZUFycm93Um93KHRoaXMuX3NwYUJvdHRvbU5hbWVzLHQpLHI9amYuaChcImRpdi5tYXBpbGxhcnktbmF2aWdhdGlvbi1zZXF1ZW5jZVwiLGUpLHM9amYuaChcImRpdi5OYXZpZ2F0aW9uU3BhdGlhbFRvcFwiLGkpLG89amYuaChcImRpdi5tYXBpbGxhcnktbmF2aWdhdGlvbi1zcGF0aWFsLWJvdHRvbVwiLG4pLGE9amYuaChcImRpdi5tYXBpbGxhcnktbmF2aWdhdGlvbi1zcGF0aWFsXCIsW3Msb10pO3JldHVybntuYW1lOnRoaXMuX25hbWUsdk5vZGU6amYuaChcImRpdi5OYXZpZ2F0aW9uQ29udGFpbmVyXCIsW3IsYV0pfX0pKSkuc3Vic2NyaWJlKHRoaXMuX2NvbnRhaW5lci5kb21SZW5kZXJlci5yZW5kZXIkKSl9X2RlYWN0aXZhdGUoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9X2dldERlZmF1bHRDb25maWd1cmF0aW9uKCl7cmV0dXJue3NlcXVlbmNlOiEwLHNwYXRpYWw6ITB9fV9jcmVhdGVBcnJvd1JvdyhlLGkpe2NvbnN0IG49W107Zm9yKGNvbnN0IHIgaW4gZSl7aWYoIWUuaGFzT3duUHJvcGVydHkocikpY29udGludWU7Y29uc3Qgcz10Lk5hdmlnYXRpb25EaXJlY3Rpb25bcl07LTEhPT1pLmluZGV4T2Yocyk/bi5wdXNoKHRoaXMuX2NyZWF0ZVZOb2RlKHMsZVtyXSxcInZpc2libGVcIikpOm4ucHVzaCh0aGlzLl9jcmVhdGVWTm9kZShzLGVbcl0sXCJoaWRkZW5cIikpfXJldHVybiBufV9jcmVhdGVWTm9kZSh0LGUsaSl7cmV0dXJuIGpmLmgoYHNwYW4ubWFwaWxsYXJ5LW5hdmlnYXRpb24tYnV0dG9uLm1hcGlsbGFyeS1uYXZpZ2F0aW9uJHtlfWAse29uY2xpY2s6KCk9Pnt0aGlzLl9uYXZpZ2F0b3IubW92ZURpciQodCkuc3Vic2NyaWJlKHZvaWQgMCwodD0+e3QgaW5zdGFuY2VvZiBaZnx8Y29uc29sZS5lcnJvcih0KX0pKX0sc3R5bGU6e3Zpc2liaWxpdHk6aX19LFtdKX19Q3YuY29tcG9uZW50TmFtZT1cIm5hdmlnYXRpb25mYWxsYmFja1wiO2Z1bmN0aW9uIEV2KHQpe2xldCBlPXQubGVuZ3RoO2Zvcig7LS1lPj0wOyl0W2VdPTB9Y29uc3QgSXY9MjU2LEF2PTI4NixQdj0zMCxSdj0xNSxMdj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDEsMSwxLDEsMiwyLDIsMiwzLDMsMywzLDQsNCw0LDQsNSw1LDUsNSwwXSksT3Y9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMSwxLDIsMiwzLDMsNCw0LDUsNSw2LDYsNyw3LDgsOCw5LDksMTAsMTAsMTEsMTEsMTIsMTIsMTMsMTNdKSxOdj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwyLDMsN10pLER2PW5ldyBVaW50OEFycmF5KFsxNiwxNywxOCwwLDgsNyw5LDYsMTAsNSwxMSw0LDEyLDMsMTMsMiwxNCwxLDE1XSksJHY9bmV3IEFycmF5KDU3Nik7RXYoJHYpO2NvbnN0IGt2PW5ldyBBcnJheSg2MCk7RXYoa3YpO2NvbnN0IHp2PW5ldyBBcnJheSg1MTIpO0V2KHp2KTtjb25zdCBGdj1uZXcgQXJyYXkoMjU2KTtFdihGdik7Y29uc3QgQnY9bmV3IEFycmF5KDI5KTtFdihCdik7Y29uc3QganY9bmV3IEFycmF5KFB2KTtmdW5jdGlvbiBIdih0LGUsaSxuLHIpe3RoaXMuc3RhdGljX3RyZWU9dCx0aGlzLmV4dHJhX2JpdHM9ZSx0aGlzLmV4dHJhX2Jhc2U9aSx0aGlzLmVsZW1zPW4sdGhpcy5tYXhfbGVuZ3RoPXIsdGhpcy5oYXNfc3RyZWU9dCYmdC5sZW5ndGh9bGV0IFV2LFZ2LEd2O2Z1bmN0aW9uIHF2KHQsZSl7dGhpcy5keW5fdHJlZT10LHRoaXMubWF4X2NvZGU9MCx0aGlzLnN0YXRfZGVzYz1lfUV2KGp2KTtjb25zdCBXdj10PT50PDI1Nj96dlt0XTp6dlsyNTYrKHQ+Pj43KV0sWHY9KHQsZSk9Pnt0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmZSx0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT1lPj4+OCYyNTV9LFl2PSh0LGUsaSk9Pnt0LmJpX3ZhbGlkPjE2LWk/KHQuYmlfYnVmfD1lPDx0LmJpX3ZhbGlkJjY1NTM1LFh2KHQsdC5iaV9idWYpLHQuYmlfYnVmPWU+PjE2LXQuYmlfdmFsaWQsdC5iaV92YWxpZCs9aS0xNik6KHQuYmlfYnVmfD1lPDx0LmJpX3ZhbGlkJjY1NTM1LHQuYmlfdmFsaWQrPWkpfSxadj0odCxlLGkpPT57WXYodCxpWzIqZV0saVsyKmUrMV0pfSxKdj0odCxlKT0+e2xldCBpPTA7ZG97aXw9MSZ0LHQ+Pj49MSxpPDw9MX13aGlsZSgtLWU+MCk7cmV0dXJuIGk+Pj4xfSxLdj0odCxlLGkpPT57Y29uc3Qgbj1uZXcgQXJyYXkoMTYpO2xldCByLHMsbz0wO2ZvcihyPTE7cjw9UnY7cisrKW5bcl09bz1vK2lbci0xXTw8MTtmb3Iocz0wO3M8PWU7cysrKXtsZXQgZT10WzIqcysxXTswIT09ZSYmKHRbMipzXT1KdihuW2VdKyssZSkpfX0sUXY9dD0+e2xldCBlO2ZvcihlPTA7ZTxBdjtlKyspdC5keW5fbHRyZWVbMiplXT0wO2ZvcihlPTA7ZTxQdjtlKyspdC5keW5fZHRyZWVbMiplXT0wO2ZvcihlPTA7ZTwxOTtlKyspdC5ibF90cmVlWzIqZV09MDt0LmR5bl9sdHJlZVs1MTJdPTEsdC5vcHRfbGVuPXQuc3RhdGljX2xlbj0wLHQubGFzdF9saXQ9dC5tYXRjaGVzPTB9LHR5PXQ9Pnt0LmJpX3ZhbGlkPjg/WHYodCx0LmJpX2J1Zik6dC5iaV92YWxpZD4wJiYodC5wZW5kaW5nX2J1Zlt0LnBlbmRpbmcrK109dC5iaV9idWYpLHQuYmlfYnVmPTAsdC5iaV92YWxpZD0wfSxleT0odCxlLGksbik9Pntjb25zdCByPTIqZSxzPTIqaTtyZXR1cm4gdFtyXTx0W3NdfHx0W3JdPT09dFtzXSYmbltlXTw9bltpXX0saXk9KHQsZSxpKT0+e2NvbnN0IG49dC5oZWFwW2ldO2xldCByPWk8PDE7Zm9yKDtyPD10LmhlYXBfbGVuJiYocjx0LmhlYXBfbGVuJiZleShlLHQuaGVhcFtyKzFdLHQuaGVhcFtyXSx0LmRlcHRoKSYmcisrLCFleShlLG4sdC5oZWFwW3JdLHQuZGVwdGgpKTspdC5oZWFwW2ldPXQuaGVhcFtyXSxpPXIscjw8PTE7dC5oZWFwW2ldPW59LG55PSh0LGUsaSk9PntsZXQgbixyLHMsbyxhPTA7aWYoMCE9PXQubGFzdF9saXQpZG97bj10LnBlbmRpbmdfYnVmW3QuZF9idWYrMiphXTw8OHx0LnBlbmRpbmdfYnVmW3QuZF9idWYrMiphKzFdLHI9dC5wZW5kaW5nX2J1Zlt0LmxfYnVmK2FdLGErKywwPT09bj9adih0LHIsZSk6KHM9RnZbcl0sWnYodCxzK0l2KzEsZSksbz1MdltzXSwwIT09byYmKHItPUJ2W3NdLFl2KHQscixvKSksbi0tLHM9V3YobiksWnYodCxzLGkpLG89T3Zbc10sMCE9PW8mJihuLT1qdltzXSxZdih0LG4sbykpKX13aGlsZShhPHQubGFzdF9saXQpO1p2KHQsMjU2LGUpfSxyeT0odCxlKT0+e2NvbnN0IGk9ZS5keW5fdHJlZSxuPWUuc3RhdF9kZXNjLnN0YXRpY190cmVlLHI9ZS5zdGF0X2Rlc2MuaGFzX3N0cmVlLHM9ZS5zdGF0X2Rlc2MuZWxlbXM7bGV0IG8sYSxjLGg9LTE7Zm9yKHQuaGVhcF9sZW49MCx0LmhlYXBfbWF4PTU3MyxvPTA7bzxzO28rKykwIT09aVsyKm9dPyh0LmhlYXBbKyt0LmhlYXBfbGVuXT1oPW8sdC5kZXB0aFtvXT0wKTppWzIqbysxXT0wO2Zvcig7dC5oZWFwX2xlbjwyOyljPXQuaGVhcFsrK3QuaGVhcF9sZW5dPWg8Mj8rK2g6MCxpWzIqY109MSx0LmRlcHRoW2NdPTAsdC5vcHRfbGVuLS0sciYmKHQuc3RhdGljX2xlbi09blsyKmMrMV0pO2ZvcihlLm1heF9jb2RlPWgsbz10LmhlYXBfbGVuPj4xO28+PTE7by0tKWl5KHQsaSxvKTtjPXM7ZG97bz10LmhlYXBbMV0sdC5oZWFwWzFdPXQuaGVhcFt0LmhlYXBfbGVuLS1dLGl5KHQsaSwxKSxhPXQuaGVhcFsxXSx0LmhlYXBbLS10LmhlYXBfbWF4XT1vLHQuaGVhcFstLXQuaGVhcF9tYXhdPWEsaVsyKmNdPWlbMipvXStpWzIqYV0sdC5kZXB0aFtjXT0odC5kZXB0aFtvXT49dC5kZXB0aFthXT90LmRlcHRoW29dOnQuZGVwdGhbYV0pKzEsaVsyKm8rMV09aVsyKmErMV09Yyx0LmhlYXBbMV09YysrLGl5KHQsaSwxKX13aGlsZSh0LmhlYXBfbGVuPj0yKTt0LmhlYXBbLS10LmhlYXBfbWF4XT10LmhlYXBbMV0sKCh0LGUpPT57Y29uc3QgaT1lLmR5bl90cmVlLG49ZS5tYXhfY29kZSxyPWUuc3RhdF9kZXNjLnN0YXRpY190cmVlLHM9ZS5zdGF0X2Rlc2MuaGFzX3N0cmVlLG89ZS5zdGF0X2Rlc2MuZXh0cmFfYml0cyxhPWUuc3RhdF9kZXNjLmV4dHJhX2Jhc2UsYz1lLnN0YXRfZGVzYy5tYXhfbGVuZ3RoO2xldCBoLGwsdSxkLHAsZixtPTA7Zm9yKGQ9MDtkPD1SdjtkKyspdC5ibF9jb3VudFtkXT0wO2ZvcihpWzIqdC5oZWFwW3QuaGVhcF9tYXhdKzFdPTAsaD10LmhlYXBfbWF4KzE7aDw1NzM7aCsrKWw9dC5oZWFwW2hdLGQ9aVsyKmlbMipsKzFdKzFdKzEsZD5jJiYoZD1jLG0rKyksaVsyKmwrMV09ZCxsPm58fCh0LmJsX2NvdW50W2RdKysscD0wLGw+PWEmJihwPW9bbC1hXSksZj1pWzIqbF0sdC5vcHRfbGVuKz1mKihkK3ApLHMmJih0LnN0YXRpY19sZW4rPWYqKHJbMipsKzFdK3ApKSk7aWYoMCE9PW0pe2Rve2ZvcihkPWMtMTswPT09dC5ibF9jb3VudFtkXTspZC0tO3QuYmxfY291bnRbZF0tLSx0LmJsX2NvdW50W2QrMV0rPTIsdC5ibF9jb3VudFtjXS0tLG0tPTJ9d2hpbGUobT4wKTtmb3IoZD1jOzAhPT1kO2QtLSlmb3IobD10LmJsX2NvdW50W2RdOzAhPT1sOyl1PXQuaGVhcFstLWhdLHU+bnx8KGlbMip1KzFdIT09ZCYmKHQub3B0X2xlbis9KGQtaVsyKnUrMV0pKmlbMip1XSxpWzIqdSsxXT1kKSxsLS0pfX0pKHQsZSksS3YoaSxoLHQuYmxfY291bnQpfSxzeT0odCxlLGkpPT57bGV0IG4scixzPS0xLG89ZVsxXSxhPTAsYz03LGg9NDtmb3IoMD09PW8mJihjPTEzOCxoPTMpLGVbMiooaSsxKSsxXT02NTUzNSxuPTA7bjw9aTtuKyspcj1vLG89ZVsyKihuKzEpKzFdLCsrYTxjJiZyPT09b3x8KGE8aD90LmJsX3RyZWVbMipyXSs9YTowIT09cj8ociE9PXMmJnQuYmxfdHJlZVsyKnJdKyssdC5ibF90cmVlWzMyXSsrKTphPD0xMD90LmJsX3RyZWVbMzRdKys6dC5ibF90cmVlWzM2XSsrLGE9MCxzPXIsMD09PW8/KGM9MTM4LGg9Myk6cj09PW8/KGM9NixoPTMpOihjPTcsaD00KSl9LG95PSh0LGUsaSk9PntsZXQgbixyLHM9LTEsbz1lWzFdLGE9MCxjPTcsaD00O2ZvcigwPT09byYmKGM9MTM4LGg9Myksbj0wO248PWk7bisrKWlmKHI9byxvPWVbMioobisxKSsxXSwhKCsrYTxjJiZyPT09bykpe2lmKGE8aClkb3tadih0LHIsdC5ibF90cmVlKX13aGlsZSgwIT0tLWEpO2Vsc2UgMCE9PXI/KHIhPT1zJiYoWnYodCxyLHQuYmxfdHJlZSksYS0tKSxadih0LDE2LHQuYmxfdHJlZSksWXYodCxhLTMsMikpOmE8PTEwPyhadih0LDE3LHQuYmxfdHJlZSksWXYodCxhLTMsMykpOihadih0LDE4LHQuYmxfdHJlZSksWXYodCxhLTExLDcpKTthPTAscz1yLDA9PT1vPyhjPTEzOCxoPTMpOnI9PT1vPyhjPTYsaD0zKTooYz03LGg9NCl9fTtsZXQgYXk9ITE7Y29uc3QgY3k9KHQsZSxpLG4pPT57WXYodCwwKyhuPzE6MCksMyksKCh0LGUsaSxuKT0+e3R5KHQpLG4mJihYdih0LGkpLFh2KHQsfmkpKSx0LnBlbmRpbmdfYnVmLnNldCh0LndpbmRvdy5zdWJhcnJheShlLGUraSksdC5wZW5kaW5nKSx0LnBlbmRpbmcrPWl9KSh0LGUsaSwhMCl9O3ZhciBoeT17X3RyX2luaXQ6dD0+e2F5fHwoKCgpPT57bGV0IHQsZSxpLG4scjtjb25zdCBzPW5ldyBBcnJheSgxNik7Zm9yKGk9MCxuPTA7bjwyODtuKyspZm9yKEJ2W25dPWksdD0wO3Q8MTw8THZbbl07dCsrKUZ2W2krK109bjtmb3IoRnZbaS0xXT1uLHI9MCxuPTA7bjwxNjtuKyspZm9yKGp2W25dPXIsdD0wO3Q8MTw8T3Zbbl07dCsrKXp2W3IrK109bjtmb3Iocj4+PTc7bjxQdjtuKyspZm9yKGp2W25dPXI8PDcsdD0wO3Q8MTw8T3Zbbl0tNzt0KyspenZbMjU2K3IrK109bjtmb3IoZT0wO2U8PVJ2O2UrKylzW2VdPTA7Zm9yKHQ9MDt0PD0xNDM7KSR2WzIqdCsxXT04LHQrKyxzWzhdKys7Zm9yKDt0PD0yNTU7KSR2WzIqdCsxXT05LHQrKyxzWzldKys7Zm9yKDt0PD0yNzk7KSR2WzIqdCsxXT03LHQrKyxzWzddKys7Zm9yKDt0PD0yODc7KSR2WzIqdCsxXT04LHQrKyxzWzhdKys7Zm9yKEt2KCR2LDI4NyxzKSx0PTA7dDxQdjt0Kyspa3ZbMip0KzFdPTUsa3ZbMip0XT1Kdih0LDUpO1V2PW5ldyBIdigkdixMdiwyNTcsQXYsUnYpLFZ2PW5ldyBIdihrdixPdiwwLFB2LFJ2KSxHdj1uZXcgSHYobmV3IEFycmF5KDApLE52LDAsMTksNyl9KSgpLGF5PSEwKSx0LmxfZGVzYz1uZXcgcXYodC5keW5fbHRyZWUsVXYpLHQuZF9kZXNjPW5ldyBxdih0LmR5bl9kdHJlZSxWdiksdC5ibF9kZXNjPW5ldyBxdih0LmJsX3RyZWUsR3YpLHQuYmlfYnVmPTAsdC5iaV92YWxpZD0wLFF2KHQpfSxfdHJfc3RvcmVkX2Jsb2NrOmN5LF90cl9mbHVzaF9ibG9jazoodCxlLGksbik9PntsZXQgcixzLG89MDt0LmxldmVsPjA/KDI9PT10LnN0cm0uZGF0YV90eXBlJiYodC5zdHJtLmRhdGFfdHlwZT0odD0+e2xldCBlLGk9NDA5MzYyNDQ0Nztmb3IoZT0wO2U8PTMxO2UrKyxpPj4+PTEpaWYoMSZpJiYwIT09dC5keW5fbHRyZWVbMiplXSlyZXR1cm4gMDtpZigwIT09dC5keW5fbHRyZWVbMThdfHwwIT09dC5keW5fbHRyZWVbMjBdfHwwIT09dC5keW5fbHRyZWVbMjZdKXJldHVybiAxO2ZvcihlPTMyO2U8SXY7ZSsrKWlmKDAhPT10LmR5bl9sdHJlZVsyKmVdKXJldHVybiAxO3JldHVybiAwfSkodCkpLHJ5KHQsdC5sX2Rlc2MpLHJ5KHQsdC5kX2Rlc2MpLG89KHQ9PntsZXQgZTtmb3Ioc3kodCx0LmR5bl9sdHJlZSx0LmxfZGVzYy5tYXhfY29kZSksc3kodCx0LmR5bl9kdHJlZSx0LmRfZGVzYy5tYXhfY29kZSkscnkodCx0LmJsX2Rlc2MpLGU9MTg7ZT49MyYmMD09PXQuYmxfdHJlZVsyKkR2W2VdKzFdO2UtLSk7cmV0dXJuIHQub3B0X2xlbis9MyooZSsxKSs1KzUrNCxlfSkodCkscj10Lm9wdF9sZW4rMys3Pj4+MyxzPXQuc3RhdGljX2xlbiszKzc+Pj4zLHM8PXImJihyPXMpKTpyPXM9aSs1LGkrNDw9ciYmLTEhPT1lP2N5KHQsZSxpLG4pOjQ9PT10LnN0cmF0ZWd5fHxzPT09cj8oWXYodCwyKyhuPzE6MCksMyksbnkodCwkdixrdikpOihZdih0LDQrKG4/MTowKSwzKSwoKHQsZSxpLG4pPT57bGV0IHI7Zm9yKFl2KHQsZS0yNTcsNSksWXYodCxpLTEsNSksWXYodCxuLTQsNCkscj0wO3I8bjtyKyspWXYodCx0LmJsX3RyZWVbMipEdltyXSsxXSwzKTtveSh0LHQuZHluX2x0cmVlLGUtMSksb3kodCx0LmR5bl9kdHJlZSxpLTEpfSkodCx0LmxfZGVzYy5tYXhfY29kZSsxLHQuZF9kZXNjLm1heF9jb2RlKzEsbysxKSxueSh0LHQuZHluX2x0cmVlLHQuZHluX2R0cmVlKSksUXYodCksbiYmdHkodCl9LF90cl90YWxseToodCxlLGkpPT4odC5wZW5kaW5nX2J1Zlt0LmRfYnVmKzIqdC5sYXN0X2xpdF09ZT4+PjgmMjU1LHQucGVuZGluZ19idWZbdC5kX2J1ZisyKnQubGFzdF9saXQrMV09MjU1JmUsdC5wZW5kaW5nX2J1Zlt0LmxfYnVmK3QubGFzdF9saXRdPTI1NSZpLHQubGFzdF9saXQrKywwPT09ZT90LmR5bl9sdHJlZVsyKmldKys6KHQubWF0Y2hlcysrLGUtLSx0LmR5bl9sdHJlZVsyKihGdltpXStJdisxKV0rKyx0LmR5bl9kdHJlZVsyKld2KGUpXSsrKSx0Lmxhc3RfbGl0PT09dC5saXRfYnVmc2l6ZS0xKSxfdHJfYWxpZ246dD0+e1l2KHQsMiwzKSxadih0LDI1NiwkdiksKHQ9PnsxNj09PXQuYmlfdmFsaWQ/KFh2KHQsdC5iaV9idWYpLHQuYmlfYnVmPTAsdC5iaV92YWxpZD0wKTp0LmJpX3ZhbGlkPj04JiYodC5wZW5kaW5nX2J1Zlt0LnBlbmRpbmcrK109MjU1JnQuYmlfYnVmLHQuYmlfYnVmPj49OCx0LmJpX3ZhbGlkLT04KX0pKHQpfX07dmFyIGx5PSh0LGUsaSxuKT0+e2xldCByPTY1NTM1JnR8MCxzPXQ+Pj4xNiY2NTUzNXwwLG89MDtmb3IoOzAhPT1pOyl7bz1pPjJlMz8yZTM6aSxpLT1vO2Rve3I9citlW24rK118MCxzPXMrcnwwfXdoaWxlKC0tbyk7ciU9NjU1MjEscyU9NjU1MjF9cmV0dXJuIHJ8czw8MTZ8MH07Y29uc3QgdXk9bmV3IFVpbnQzMkFycmF5KCgoKT0+e2xldCB0LGU9W107Zm9yKHZhciBpPTA7aTwyNTY7aSsrKXt0PWk7Zm9yKHZhciBuPTA7bjw4O24rKyl0PTEmdD8zOTg4MjkyMzg0XnQ+Pj4xOnQ+Pj4xO2VbaV09dH1yZXR1cm4gZX0pKCkpO3ZhciBkeT0odCxlLGksbik9Pntjb25zdCByPXV5LHM9bitpO3RePS0xO2ZvcihsZXQgaT1uO2k8cztpKyspdD10Pj4+OF5yWzI1NSYodF5lW2ldKV07cmV0dXJuLTFedH0scHk9ezI6XCJuZWVkIGRpY3Rpb25hcnlcIiwxOlwic3RyZWFtIGVuZFwiLDA6XCJcIixcIi0xXCI6XCJmaWxlIGVycm9yXCIsXCItMlwiOlwic3RyZWFtIGVycm9yXCIsXCItM1wiOlwiZGF0YSBlcnJvclwiLFwiLTRcIjpcImluc3VmZmljaWVudCBtZW1vcnlcIixcIi01XCI6XCJidWZmZXIgZXJyb3JcIixcIi02XCI6XCJpbmNvbXBhdGlibGUgdmVyc2lvblwifSxmeT17Wl9OT19GTFVTSDowLFpfUEFSVElBTF9GTFVTSDoxLFpfU1lOQ19GTFVTSDoyLFpfRlVMTF9GTFVTSDozLFpfRklOSVNIOjQsWl9CTE9DSzo1LFpfVFJFRVM6NixaX09LOjAsWl9TVFJFQU1fRU5EOjEsWl9ORUVEX0RJQ1Q6MixaX0VSUk5POi0xLFpfU1RSRUFNX0VSUk9SOi0yLFpfREFUQV9FUlJPUjotMyxaX01FTV9FUlJPUjotNCxaX0JVRl9FUlJPUjotNSxaX05PX0NPTVBSRVNTSU9OOjAsWl9CRVNUX1NQRUVEOjEsWl9CRVNUX0NPTVBSRVNTSU9OOjksWl9ERUZBVUxUX0NPTVBSRVNTSU9OOi0xLFpfRklMVEVSRUQ6MSxaX0hVRkZNQU5fT05MWToyLFpfUkxFOjMsWl9GSVhFRDo0LFpfREVGQVVMVF9TVFJBVEVHWTowLFpfQklOQVJZOjAsWl9URVhUOjEsWl9VTktOT1dOOjIsWl9ERUZMQVRFRDo4fTtjb25zdHtfdHJfaW5pdDpteSxfdHJfc3RvcmVkX2Jsb2NrOmd5LF90cl9mbHVzaF9ibG9jazpfeSxfdHJfdGFsbHk6dnksX3RyX2FsaWduOnl5fT1oeSx7Wl9OT19GTFVTSDpieSxaX1BBUlRJQUxfRkxVU0g6eHksWl9GVUxMX0ZMVVNIOnd5LFpfRklOSVNIOlN5LFpfQkxPQ0s6TXksWl9PSzpUeSxaX1NUUkVBTV9FTkQ6Q3ksWl9TVFJFQU1fRVJST1I6RXksWl9EQVRBX0VSUk9SOkl5LFpfQlVGX0VSUk9SOkF5LFpfREVGQVVMVF9DT01QUkVTU0lPTjpQeSxaX0ZJTFRFUkVEOlJ5LFpfSFVGRk1BTl9PTkxZOkx5LFpfUkxFOk95LFpfRklYRUQ6TnksWl9ERUZBVUxUX1NUUkFURUdZOkR5LFpfVU5LTk9XTjokeSxaX0RFRkxBVEVEOmt5fT1meSx6eT0yNTgsRnk9MjYyLEJ5PTEwMyxqeT0xMTMsSHk9NjY2LFV5PSh0LGUpPT4odC5tc2c9cHlbZV0sZSksVnk9dD0+KHQ8PDEpLSh0PjQ/OTowKSxHeT10PT57bGV0IGU9dC5sZW5ndGg7Zm9yKDstLWU+PTA7KXRbZV09MH07bGV0IHF5PSh0LGUsaSk9PihlPDx0Lmhhc2hfc2hpZnReaSkmdC5oYXNoX21hc2s7Y29uc3QgV3k9dD0+e2NvbnN0IGU9dC5zdGF0ZTtsZXQgaT1lLnBlbmRpbmc7aT50LmF2YWlsX291dCYmKGk9dC5hdmFpbF9vdXQpLDAhPT1pJiYodC5vdXRwdXQuc2V0KGUucGVuZGluZ19idWYuc3ViYXJyYXkoZS5wZW5kaW5nX291dCxlLnBlbmRpbmdfb3V0K2kpLHQubmV4dF9vdXQpLHQubmV4dF9vdXQrPWksZS5wZW5kaW5nX291dCs9aSx0LnRvdGFsX291dCs9aSx0LmF2YWlsX291dC09aSxlLnBlbmRpbmctPWksMD09PWUucGVuZGluZyYmKGUucGVuZGluZ19vdXQ9MCkpfSxYeT0odCxlKT0+e195KHQsdC5ibG9ja19zdGFydD49MD90LmJsb2NrX3N0YXJ0Oi0xLHQuc3Ryc3RhcnQtdC5ibG9ja19zdGFydCxlKSx0LmJsb2NrX3N0YXJ0PXQuc3Ryc3RhcnQsV3kodC5zdHJtKX0sWXk9KHQsZSk9Pnt0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT1lfSxaeT0odCxlKT0+e3QucGVuZGluZ19idWZbdC5wZW5kaW5nKytdPWU+Pj44JjI1NSx0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXT0yNTUmZX0sSnk9KHQsZSxpLG4pPT57bGV0IHI9dC5hdmFpbF9pbjtyZXR1cm4gcj5uJiYocj1uKSwwPT09cj8wOih0LmF2YWlsX2luLT1yLGUuc2V0KHQuaW5wdXQuc3ViYXJyYXkodC5uZXh0X2luLHQubmV4dF9pbityKSxpKSwxPT09dC5zdGF0ZS53cmFwP3QuYWRsZXI9bHkodC5hZGxlcixlLHIsaSk6Mj09PXQuc3RhdGUud3JhcCYmKHQuYWRsZXI9ZHkodC5hZGxlcixlLHIsaSkpLHQubmV4dF9pbis9cix0LnRvdGFsX2luKz1yLHIpfSxLeT0odCxlKT0+e2xldCBpLG4scj10Lm1heF9jaGFpbl9sZW5ndGgscz10LnN0cnN0YXJ0LG89dC5wcmV2X2xlbmd0aCxhPXQubmljZV9tYXRjaDtjb25zdCBjPXQuc3Ryc3RhcnQ+dC53X3NpemUtRnk/dC5zdHJzdGFydC0odC53X3NpemUtRnkpOjAsaD10LndpbmRvdyxsPXQud19tYXNrLHU9dC5wcmV2LGQ9dC5zdHJzdGFydCt6eTtsZXQgcD1oW3Mrby0xXSxmPWhbcytvXTt0LnByZXZfbGVuZ3RoPj10Lmdvb2RfbWF0Y2gmJihyPj49MiksYT50Lmxvb2thaGVhZCYmKGE9dC5sb29rYWhlYWQpO2Rve2lmKGk9ZSxoW2krb109PT1mJiZoW2krby0xXT09PXAmJmhbaV09PT1oW3NdJiZoWysraV09PT1oW3MrMV0pe3MrPTIsaSsrO2Rve313aGlsZShoWysrc109PT1oWysraV0mJmhbKytzXT09PWhbKytpXSYmaFsrK3NdPT09aFsrK2ldJiZoWysrc109PT1oWysraV0mJmhbKytzXT09PWhbKytpXSYmaFsrK3NdPT09aFsrK2ldJiZoWysrc109PT1oWysraV0mJmhbKytzXT09PWhbKytpXSYmczxkKTtpZihuPXp5LShkLXMpLHM9ZC16eSxuPm8pe2lmKHQubWF0Y2hfc3RhcnQ9ZSxvPW4sbj49YSlicmVhaztwPWhbcytvLTFdLGY9aFtzK29dfX19d2hpbGUoKGU9dVtlJmxdKT5jJiYwIT0tLXIpO3JldHVybiBvPD10Lmxvb2thaGVhZD9vOnQubG9va2FoZWFkfSxReT10PT57Y29uc3QgZT10Lndfc2l6ZTtsZXQgaSxuLHIscyxvO2Rve2lmKHM9dC53aW5kb3dfc2l6ZS10Lmxvb2thaGVhZC10LnN0cnN0YXJ0LHQuc3Ryc3RhcnQ+PWUrKGUtRnkpKXt0LndpbmRvdy5zZXQodC53aW5kb3cuc3ViYXJyYXkoZSxlK2UpLDApLHQubWF0Y2hfc3RhcnQtPWUsdC5zdHJzdGFydC09ZSx0LmJsb2NrX3N0YXJ0LT1lLG49dC5oYXNoX3NpemUsaT1uO2Rve3I9dC5oZWFkWy0taV0sdC5oZWFkW2ldPXI+PWU/ci1lOjB9d2hpbGUoLS1uKTtuPWUsaT1uO2Rve3I9dC5wcmV2Wy0taV0sdC5wcmV2W2ldPXI+PWU/ci1lOjB9d2hpbGUoLS1uKTtzKz1lfWlmKDA9PT10LnN0cm0uYXZhaWxfaW4pYnJlYWs7aWYobj1KeSh0LnN0cm0sdC53aW5kb3csdC5zdHJzdGFydCt0Lmxvb2thaGVhZCxzKSx0Lmxvb2thaGVhZCs9bix0Lmxvb2thaGVhZCt0Lmluc2VydD49Mylmb3Iobz10LnN0cnN0YXJ0LXQuaW5zZXJ0LHQuaW5zX2g9dC53aW5kb3dbb10sdC5pbnNfaD1xeSh0LHQuaW5zX2gsdC53aW5kb3dbbysxXSk7dC5pbnNlcnQmJih0Lmluc19oPXF5KHQsdC5pbnNfaCx0LndpbmRvd1tvKzMtMV0pLHQucHJldltvJnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPW8sbysrLHQuaW5zZXJ0LS0sISh0Lmxvb2thaGVhZCt0Lmluc2VydDwzKSk7KTt9d2hpbGUodC5sb29rYWhlYWQ8RnkmJjAhPT10LnN0cm0uYXZhaWxfaW4pfSx0Yj0odCxlKT0+e2xldCBpLG47Zm9yKDs7KXtpZih0Lmxvb2thaGVhZDxGeSl7aWYoUXkodCksdC5sb29rYWhlYWQ8RnkmJmU9PT1ieSlyZXR1cm4gMTtpZigwPT09dC5sb29rYWhlYWQpYnJlYWt9aWYoaT0wLHQubG9va2FoZWFkPj0zJiYodC5pbnNfaD1xeSh0LHQuaW5zX2gsdC53aW5kb3dbdC5zdHJzdGFydCszLTFdKSxpPXQucHJldlt0LnN0cnN0YXJ0JnQud19tYXNrXT10LmhlYWRbdC5pbnNfaF0sdC5oZWFkW3QuaW5zX2hdPXQuc3Ryc3RhcnQpLDAhPT1pJiZ0LnN0cnN0YXJ0LWk8PXQud19zaXplLUZ5JiYodC5tYXRjaF9sZW5ndGg9S3kodCxpKSksdC5tYXRjaF9sZW5ndGg+PTMpaWYobj12eSh0LHQuc3Ryc3RhcnQtdC5tYXRjaF9zdGFydCx0Lm1hdGNoX2xlbmd0aC0zKSx0Lmxvb2thaGVhZC09dC5tYXRjaF9sZW5ndGgsdC5tYXRjaF9sZW5ndGg8PXQubWF4X2xhenlfbWF0Y2gmJnQubG9va2FoZWFkPj0zKXt0Lm1hdGNoX2xlbmd0aC0tO2Rve3Quc3Ryc3RhcnQrKyx0Lmluc19oPXF5KHQsdC5pbnNfaCx0LndpbmRvd1t0LnN0cnN0YXJ0KzMtMV0pLGk9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydH13aGlsZSgwIT0tLXQubWF0Y2hfbGVuZ3RoKTt0LnN0cnN0YXJ0Kyt9ZWxzZSB0LnN0cnN0YXJ0Kz10Lm1hdGNoX2xlbmd0aCx0Lm1hdGNoX2xlbmd0aD0wLHQuaW5zX2g9dC53aW5kb3dbdC5zdHJzdGFydF0sdC5pbnNfaD1xeSh0LHQuaW5zX2gsdC53aW5kb3dbdC5zdHJzdGFydCsxXSk7ZWxzZSBuPXZ5KHQsMCx0LndpbmRvd1t0LnN0cnN0YXJ0XSksdC5sb29rYWhlYWQtLSx0LnN0cnN0YXJ0Kys7aWYobiYmKFh5KHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gMX1yZXR1cm4gdC5pbnNlcnQ9dC5zdHJzdGFydDwyP3Quc3Ryc3RhcnQ6MixlPT09U3k/KFh5KHQsITApLDA9PT10LnN0cm0uYXZhaWxfb3V0PzM6NCk6dC5sYXN0X2xpdCYmKFh5KHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT8xOjJ9LGViPSh0LGUpPT57bGV0IGksbixyO2Zvcig7Oyl7aWYodC5sb29rYWhlYWQ8Rnkpe2lmKFF5KHQpLHQubG9va2FoZWFkPEZ5JiZlPT09YnkpcmV0dXJuIDE7aWYoMD09PXQubG9va2FoZWFkKWJyZWFrfWlmKGk9MCx0Lmxvb2thaGVhZD49MyYmKHQuaW5zX2g9cXkodCx0Lmluc19oLHQud2luZG93W3Quc3Ryc3RhcnQrMy0xXSksaT10LnByZXZbdC5zdHJzdGFydCZ0LndfbWFza109dC5oZWFkW3QuaW5zX2hdLHQuaGVhZFt0Lmluc19oXT10LnN0cnN0YXJ0KSx0LnByZXZfbGVuZ3RoPXQubWF0Y2hfbGVuZ3RoLHQucHJldl9tYXRjaD10Lm1hdGNoX3N0YXJ0LHQubWF0Y2hfbGVuZ3RoPTIsMCE9PWkmJnQucHJldl9sZW5ndGg8dC5tYXhfbGF6eV9tYXRjaCYmdC5zdHJzdGFydC1pPD10Lndfc2l6ZS1GeSYmKHQubWF0Y2hfbGVuZ3RoPUt5KHQsaSksdC5tYXRjaF9sZW5ndGg8PTUmJih0LnN0cmF0ZWd5PT09Unl8fDM9PT10Lm1hdGNoX2xlbmd0aCYmdC5zdHJzdGFydC10Lm1hdGNoX3N0YXJ0PjQwOTYpJiYodC5tYXRjaF9sZW5ndGg9MikpLHQucHJldl9sZW5ndGg+PTMmJnQubWF0Y2hfbGVuZ3RoPD10LnByZXZfbGVuZ3RoKXtyPXQuc3Ryc3RhcnQrdC5sb29rYWhlYWQtMyxuPXZ5KHQsdC5zdHJzdGFydC0xLXQucHJldl9tYXRjaCx0LnByZXZfbGVuZ3RoLTMpLHQubG9va2FoZWFkLT10LnByZXZfbGVuZ3RoLTEsdC5wcmV2X2xlbmd0aC09Mjtkb3srK3Quc3Ryc3RhcnQ8PXImJih0Lmluc19oPXF5KHQsdC5pbnNfaCx0LndpbmRvd1t0LnN0cnN0YXJ0KzMtMV0pLGk9dC5wcmV2W3Quc3Ryc3RhcnQmdC53X21hc2tdPXQuaGVhZFt0Lmluc19oXSx0LmhlYWRbdC5pbnNfaF09dC5zdHJzdGFydCl9d2hpbGUoMCE9LS10LnByZXZfbGVuZ3RoKTtpZih0Lm1hdGNoX2F2YWlsYWJsZT0wLHQubWF0Y2hfbGVuZ3RoPTIsdC5zdHJzdGFydCsrLG4mJihYeSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIDF9ZWxzZSBpZih0Lm1hdGNoX2F2YWlsYWJsZSl7aWYobj12eSh0LDAsdC53aW5kb3dbdC5zdHJzdGFydC0xXSksbiYmWHkodCwhMSksdC5zdHJzdGFydCsrLHQubG9va2FoZWFkLS0sMD09PXQuc3RybS5hdmFpbF9vdXQpcmV0dXJuIDF9ZWxzZSB0Lm1hdGNoX2F2YWlsYWJsZT0xLHQuc3Ryc3RhcnQrKyx0Lmxvb2thaGVhZC0tfXJldHVybiB0Lm1hdGNoX2F2YWlsYWJsZSYmKG49dnkodCwwLHQud2luZG93W3Quc3Ryc3RhcnQtMV0pLHQubWF0Y2hfYXZhaWxhYmxlPTApLHQuaW5zZXJ0PXQuc3Ryc3RhcnQ8Mj90LnN0cnN0YXJ0OjIsZT09PVN5PyhYeSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD8zOjQpOnQubGFzdF9saXQmJihYeSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCk/MToyfTtmdW5jdGlvbiBpYih0LGUsaSxuLHIpe3RoaXMuZ29vZF9sZW5ndGg9dCx0aGlzLm1heF9sYXp5PWUsdGhpcy5uaWNlX2xlbmd0aD1pLHRoaXMubWF4X2NoYWluPW4sdGhpcy5mdW5jPXJ9Y29uc3QgbmI9W25ldyBpYigwLDAsMCwwLCgodCxlKT0+e2xldCBpPTY1NTM1O2ZvcihpPnQucGVuZGluZ19idWZfc2l6ZS01JiYoaT10LnBlbmRpbmdfYnVmX3NpemUtNSk7Oyl7aWYodC5sb29rYWhlYWQ8PTEpe2lmKFF5KHQpLDA9PT10Lmxvb2thaGVhZCYmZT09PWJ5KXJldHVybiAxO2lmKDA9PT10Lmxvb2thaGVhZClicmVha310LnN0cnN0YXJ0Kz10Lmxvb2thaGVhZCx0Lmxvb2thaGVhZD0wO2NvbnN0IG49dC5ibG9ja19zdGFydCtpO2lmKCgwPT09dC5zdHJzdGFydHx8dC5zdHJzdGFydD49bikmJih0Lmxvb2thaGVhZD10LnN0cnN0YXJ0LW4sdC5zdHJzdGFydD1uLFh5KHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gMTtpZih0LnN0cnN0YXJ0LXQuYmxvY2tfc3RhcnQ+PXQud19zaXplLUZ5JiYoWHkodCwhMSksMD09PXQuc3RybS5hdmFpbF9vdXQpKXJldHVybiAxfXJldHVybiB0Lmluc2VydD0wLGU9PT1TeT8oWHkodCwhMCksMD09PXQuc3RybS5hdmFpbF9vdXQ/Mzo0KToodC5zdHJzdGFydD50LmJsb2NrX3N0YXJ0JiYoWHkodCwhMSksdC5zdHJtLmF2YWlsX291dCksMSl9KSksbmV3IGliKDQsNCw4LDQsdGIpLG5ldyBpYig0LDUsMTYsOCx0YiksbmV3IGliKDQsNiwzMiwzMix0YiksbmV3IGliKDQsNCwxNiwxNixlYiksbmV3IGliKDgsMTYsMzIsMzIsZWIpLG5ldyBpYig4LDE2LDEyOCwxMjgsZWIpLG5ldyBpYig4LDMyLDEyOCwyNTYsZWIpLG5ldyBpYigzMiwxMjgsMjU4LDEwMjQsZWIpLG5ldyBpYigzMiwyNTgsMjU4LDQwOTYsZWIpXTtmdW5jdGlvbiByYigpe3RoaXMuc3RybT1udWxsLHRoaXMuc3RhdHVzPTAsdGhpcy5wZW5kaW5nX2J1Zj1udWxsLHRoaXMucGVuZGluZ19idWZfc2l6ZT0wLHRoaXMucGVuZGluZ19vdXQ9MCx0aGlzLnBlbmRpbmc9MCx0aGlzLndyYXA9MCx0aGlzLmd6aGVhZD1udWxsLHRoaXMuZ3ppbmRleD0wLHRoaXMubWV0aG9kPWt5LHRoaXMubGFzdF9mbHVzaD0tMSx0aGlzLndfc2l6ZT0wLHRoaXMud19iaXRzPTAsdGhpcy53X21hc2s9MCx0aGlzLndpbmRvdz1udWxsLHRoaXMud2luZG93X3NpemU9MCx0aGlzLnByZXY9bnVsbCx0aGlzLmhlYWQ9bnVsbCx0aGlzLmluc19oPTAsdGhpcy5oYXNoX3NpemU9MCx0aGlzLmhhc2hfYml0cz0wLHRoaXMuaGFzaF9tYXNrPTAsdGhpcy5oYXNoX3NoaWZ0PTAsdGhpcy5ibG9ja19zdGFydD0wLHRoaXMubWF0Y2hfbGVuZ3RoPTAsdGhpcy5wcmV2X21hdGNoPTAsdGhpcy5tYXRjaF9hdmFpbGFibGU9MCx0aGlzLnN0cnN0YXJ0PTAsdGhpcy5tYXRjaF9zdGFydD0wLHRoaXMubG9va2FoZWFkPTAsdGhpcy5wcmV2X2xlbmd0aD0wLHRoaXMubWF4X2NoYWluX2xlbmd0aD0wLHRoaXMubWF4X2xhenlfbWF0Y2g9MCx0aGlzLmxldmVsPTAsdGhpcy5zdHJhdGVneT0wLHRoaXMuZ29vZF9tYXRjaD0wLHRoaXMubmljZV9tYXRjaD0wLHRoaXMuZHluX2x0cmVlPW5ldyBVaW50MTZBcnJheSgxMTQ2KSx0aGlzLmR5bl9kdHJlZT1uZXcgVWludDE2QXJyYXkoMTIyKSx0aGlzLmJsX3RyZWU9bmV3IFVpbnQxNkFycmF5KDc4KSxHeSh0aGlzLmR5bl9sdHJlZSksR3kodGhpcy5keW5fZHRyZWUpLEd5KHRoaXMuYmxfdHJlZSksdGhpcy5sX2Rlc2M9bnVsbCx0aGlzLmRfZGVzYz1udWxsLHRoaXMuYmxfZGVzYz1udWxsLHRoaXMuYmxfY291bnQ9bmV3IFVpbnQxNkFycmF5KDE2KSx0aGlzLmhlYXA9bmV3IFVpbnQxNkFycmF5KDU3MyksR3kodGhpcy5oZWFwKSx0aGlzLmhlYXBfbGVuPTAsdGhpcy5oZWFwX21heD0wLHRoaXMuZGVwdGg9bmV3IFVpbnQxNkFycmF5KDU3MyksR3kodGhpcy5kZXB0aCksdGhpcy5sX2J1Zj0wLHRoaXMubGl0X2J1ZnNpemU9MCx0aGlzLmxhc3RfbGl0PTAsdGhpcy5kX2J1Zj0wLHRoaXMub3B0X2xlbj0wLHRoaXMuc3RhdGljX2xlbj0wLHRoaXMubWF0Y2hlcz0wLHRoaXMuaW5zZXJ0PTAsdGhpcy5iaV9idWY9MCx0aGlzLmJpX3ZhbGlkPTB9Y29uc3Qgc2I9dD0+e2lmKCF0fHwhdC5zdGF0ZSlyZXR1cm4gVXkodCxFeSk7dC50b3RhbF9pbj10LnRvdGFsX291dD0wLHQuZGF0YV90eXBlPSR5O2NvbnN0IGU9dC5zdGF0ZTtyZXR1cm4gZS5wZW5kaW5nPTAsZS5wZW5kaW5nX291dD0wLGUud3JhcDwwJiYoZS53cmFwPS1lLndyYXApLGUuc3RhdHVzPWUud3JhcD80MjpqeSx0LmFkbGVyPTI9PT1lLndyYXA/MDoxLGUubGFzdF9mbHVzaD1ieSxteShlKSxUeX0sb2I9dD0+e2NvbnN0IGU9c2IodCk7dmFyIGk7cmV0dXJuIGU9PT1UeSYmKChpPXQuc3RhdGUpLndpbmRvd19zaXplPTIqaS53X3NpemUsR3koaS5oZWFkKSxpLm1heF9sYXp5X21hdGNoPW5iW2kubGV2ZWxdLm1heF9sYXp5LGkuZ29vZF9tYXRjaD1uYltpLmxldmVsXS5nb29kX2xlbmd0aCxpLm5pY2VfbWF0Y2g9bmJbaS5sZXZlbF0ubmljZV9sZW5ndGgsaS5tYXhfY2hhaW5fbGVuZ3RoPW5iW2kubGV2ZWxdLm1heF9jaGFpbixpLnN0cnN0YXJ0PTAsaS5ibG9ja19zdGFydD0wLGkubG9va2FoZWFkPTAsaS5pbnNlcnQ9MCxpLm1hdGNoX2xlbmd0aD1pLnByZXZfbGVuZ3RoPTIsaS5tYXRjaF9hdmFpbGFibGU9MCxpLmluc19oPTApLGV9LGFiPSh0LGUsaSxuLHIscyk9PntpZighdClyZXR1cm4gRXk7bGV0IG89MTtpZihlPT09UHkmJihlPTYpLG48MD8obz0wLG49LW4pOm4+MTUmJihvPTIsbi09MTYpLHI8MXx8cj45fHxpIT09a3l8fG48OHx8bj4xNXx8ZTwwfHxlPjl8fHM8MHx8cz5OeSlyZXR1cm4gVXkodCxFeSk7OD09PW4mJihuPTkpO2NvbnN0IGE9bmV3IHJiO3JldHVybiB0LnN0YXRlPWEsYS5zdHJtPXQsYS53cmFwPW8sYS5nemhlYWQ9bnVsbCxhLndfYml0cz1uLGEud19zaXplPTE8PGEud19iaXRzLGEud19tYXNrPWEud19zaXplLTEsYS5oYXNoX2JpdHM9cis3LGEuaGFzaF9zaXplPTE8PGEuaGFzaF9iaXRzLGEuaGFzaF9tYXNrPWEuaGFzaF9zaXplLTEsYS5oYXNoX3NoaWZ0PX5+KChhLmhhc2hfYml0cyszLTEpLzMpLGEud2luZG93PW5ldyBVaW50OEFycmF5KDIqYS53X3NpemUpLGEuaGVhZD1uZXcgVWludDE2QXJyYXkoYS5oYXNoX3NpemUpLGEucHJldj1uZXcgVWludDE2QXJyYXkoYS53X3NpemUpLGEubGl0X2J1ZnNpemU9MTw8cis2LGEucGVuZGluZ19idWZfc2l6ZT00KmEubGl0X2J1ZnNpemUsYS5wZW5kaW5nX2J1Zj1uZXcgVWludDhBcnJheShhLnBlbmRpbmdfYnVmX3NpemUpLGEuZF9idWY9MSphLmxpdF9idWZzaXplLGEubF9idWY9MyphLmxpdF9idWZzaXplLGEubGV2ZWw9ZSxhLnN0cmF0ZWd5PXMsYS5tZXRob2Q9aSxvYih0KX07dmFyIGNiPXtkZWZsYXRlSW5pdDoodCxlKT0+YWIodCxlLGt5LDE1LDgsRHkpLGRlZmxhdGVJbml0MjphYixkZWZsYXRlUmVzZXQ6b2IsZGVmbGF0ZVJlc2V0S2VlcDpzYixkZWZsYXRlU2V0SGVhZGVyOih0LGUpPT50JiZ0LnN0YXRlPzIhPT10LnN0YXRlLndyYXA/RXk6KHQuc3RhdGUuZ3poZWFkPWUsVHkpOkV5LGRlZmxhdGU6KHQsZSk9PntsZXQgaSxuO2lmKCF0fHwhdC5zdGF0ZXx8ZT5NeXx8ZTwwKXJldHVybiB0P1V5KHQsRXkpOkV5O2NvbnN0IHI9dC5zdGF0ZTtpZighdC5vdXRwdXR8fCF0LmlucHV0JiYwIT09dC5hdmFpbF9pbnx8ci5zdGF0dXM9PT1IeSYmZSE9PVN5KXJldHVybiBVeSh0LDA9PT10LmF2YWlsX291dD9BeTpFeSk7ci5zdHJtPXQ7Y29uc3Qgcz1yLmxhc3RfZmx1c2g7aWYoci5sYXN0X2ZsdXNoPWUsNDI9PT1yLnN0YXR1cylpZigyPT09ci53cmFwKXQuYWRsZXI9MCxZeShyLDMxKSxZeShyLDEzOSksWXkociw4KSxyLmd6aGVhZD8oWXkociwoci5nemhlYWQudGV4dD8xOjApKyhyLmd6aGVhZC5oY3JjPzI6MCkrKHIuZ3poZWFkLmV4dHJhPzQ6MCkrKHIuZ3poZWFkLm5hbWU/ODowKSsoci5nemhlYWQuY29tbWVudD8xNjowKSksWXkociwyNTUmci5nemhlYWQudGltZSksWXkocixyLmd6aGVhZC50aW1lPj44JjI1NSksWXkocixyLmd6aGVhZC50aW1lPj4xNiYyNTUpLFl5KHIsci5nemhlYWQudGltZT4+MjQmMjU1KSxZeShyLDk9PT1yLmxldmVsPzI6ci5zdHJhdGVneT49THl8fHIubGV2ZWw8Mj80OjApLFl5KHIsMjU1JnIuZ3poZWFkLm9zKSxyLmd6aGVhZC5leHRyYSYmci5nemhlYWQuZXh0cmEubGVuZ3RoJiYoWXkociwyNTUmci5nemhlYWQuZXh0cmEubGVuZ3RoKSxZeShyLHIuZ3poZWFkLmV4dHJhLmxlbmd0aD4+OCYyNTUpKSxyLmd6aGVhZC5oY3JjJiYodC5hZGxlcj1keSh0LmFkbGVyLHIucGVuZGluZ19idWYsci5wZW5kaW5nLDApKSxyLmd6aW5kZXg9MCxyLnN0YXR1cz02OSk6KFl5KHIsMCksWXkociwwKSxZeShyLDApLFl5KHIsMCksWXkociwwKSxZeShyLDk9PT1yLmxldmVsPzI6ci5zdHJhdGVneT49THl8fHIubGV2ZWw8Mj80OjApLFl5KHIsMyksci5zdGF0dXM9ankpO2Vsc2V7bGV0IGU9a3krKHIud19iaXRzLTg8PDQpPDw4LGk9LTE7aT1yLnN0cmF0ZWd5Pj1MeXx8ci5sZXZlbDwyPzA6ci5sZXZlbDw2PzE6Nj09PXIubGV2ZWw/MjozLGV8PWk8PDYsMCE9PXIuc3Ryc3RhcnQmJihlfD0zMiksZSs9MzEtZSUzMSxyLnN0YXR1cz1qeSxaeShyLGUpLDAhPT1yLnN0cnN0YXJ0JiYoWnkocix0LmFkbGVyPj4+MTYpLFp5KHIsNjU1MzUmdC5hZGxlcikpLHQuYWRsZXI9MX1pZig2OT09PXIuc3RhdHVzKWlmKHIuZ3poZWFkLmV4dHJhKXtmb3IoaT1yLnBlbmRpbmc7ci5nemluZGV4PCg2NTUzNSZyLmd6aGVhZC5leHRyYS5sZW5ndGgpJiYoci5wZW5kaW5nIT09ci5wZW5kaW5nX2J1Zl9zaXplfHwoci5nemhlYWQuaGNyYyYmci5wZW5kaW5nPmkmJih0LmFkbGVyPWR5KHQuYWRsZXIsci5wZW5kaW5nX2J1ZixyLnBlbmRpbmctaSxpKSksV3kodCksaT1yLnBlbmRpbmcsci5wZW5kaW5nIT09ci5wZW5kaW5nX2J1Zl9zaXplKSk7KVl5KHIsMjU1JnIuZ3poZWFkLmV4dHJhW3IuZ3ppbmRleF0pLHIuZ3ppbmRleCsrO3IuZ3poZWFkLmhjcmMmJnIucGVuZGluZz5pJiYodC5hZGxlcj1keSh0LmFkbGVyLHIucGVuZGluZ19idWYsci5wZW5kaW5nLWksaSkpLHIuZ3ppbmRleD09PXIuZ3poZWFkLmV4dHJhLmxlbmd0aCYmKHIuZ3ppbmRleD0wLHIuc3RhdHVzPTczKX1lbHNlIHIuc3RhdHVzPTczO2lmKDczPT09ci5zdGF0dXMpaWYoci5nemhlYWQubmFtZSl7aT1yLnBlbmRpbmc7ZG97aWYoci5wZW5kaW5nPT09ci5wZW5kaW5nX2J1Zl9zaXplJiYoci5nemhlYWQuaGNyYyYmci5wZW5kaW5nPmkmJih0LmFkbGVyPWR5KHQuYWRsZXIsci5wZW5kaW5nX2J1ZixyLnBlbmRpbmctaSxpKSksV3kodCksaT1yLnBlbmRpbmcsci5wZW5kaW5nPT09ci5wZW5kaW5nX2J1Zl9zaXplKSl7bj0xO2JyZWFrfW49ci5nemluZGV4PHIuZ3poZWFkLm5hbWUubGVuZ3RoPzI1NSZyLmd6aGVhZC5uYW1lLmNoYXJDb2RlQXQoci5nemluZGV4KyspOjAsWXkocixuKX13aGlsZSgwIT09bik7ci5nemhlYWQuaGNyYyYmci5wZW5kaW5nPmkmJih0LmFkbGVyPWR5KHQuYWRsZXIsci5wZW5kaW5nX2J1ZixyLnBlbmRpbmctaSxpKSksMD09PW4mJihyLmd6aW5kZXg9MCxyLnN0YXR1cz05MSl9ZWxzZSByLnN0YXR1cz05MTtpZig5MT09PXIuc3RhdHVzKWlmKHIuZ3poZWFkLmNvbW1lbnQpe2k9ci5wZW5kaW5nO2Rve2lmKHIucGVuZGluZz09PXIucGVuZGluZ19idWZfc2l6ZSYmKHIuZ3poZWFkLmhjcmMmJnIucGVuZGluZz5pJiYodC5hZGxlcj1keSh0LmFkbGVyLHIucGVuZGluZ19idWYsci5wZW5kaW5nLWksaSkpLFd5KHQpLGk9ci5wZW5kaW5nLHIucGVuZGluZz09PXIucGVuZGluZ19idWZfc2l6ZSkpe249MTticmVha31uPXIuZ3ppbmRleDxyLmd6aGVhZC5jb21tZW50Lmxlbmd0aD8yNTUmci5nemhlYWQuY29tbWVudC5jaGFyQ29kZUF0KHIuZ3ppbmRleCsrKTowLFl5KHIsbil9d2hpbGUoMCE9PW4pO3IuZ3poZWFkLmhjcmMmJnIucGVuZGluZz5pJiYodC5hZGxlcj1keSh0LmFkbGVyLHIucGVuZGluZ19idWYsci5wZW5kaW5nLWksaSkpLDA9PT1uJiYoci5zdGF0dXM9QnkpfWVsc2Ugci5zdGF0dXM9Qnk7aWYoci5zdGF0dXM9PT1CeSYmKHIuZ3poZWFkLmhjcmM/KHIucGVuZGluZysyPnIucGVuZGluZ19idWZfc2l6ZSYmV3kodCksci5wZW5kaW5nKzI8PXIucGVuZGluZ19idWZfc2l6ZSYmKFl5KHIsMjU1JnQuYWRsZXIpLFl5KHIsdC5hZGxlcj4+OCYyNTUpLHQuYWRsZXI9MCxyLnN0YXR1cz1qeSkpOnIuc3RhdHVzPWp5KSwwIT09ci5wZW5kaW5nKXtpZihXeSh0KSwwPT09dC5hdmFpbF9vdXQpcmV0dXJuIHIubGFzdF9mbHVzaD0tMSxUeX1lbHNlIGlmKDA9PT10LmF2YWlsX2luJiZWeShlKTw9VnkocykmJmUhPT1TeSlyZXR1cm4gVXkodCxBeSk7aWYoci5zdGF0dXM9PT1IeSYmMCE9PXQuYXZhaWxfaW4pcmV0dXJuIFV5KHQsQXkpO2lmKDAhPT10LmF2YWlsX2lufHwwIT09ci5sb29rYWhlYWR8fGUhPT1ieSYmci5zdGF0dXMhPT1IeSl7bGV0IGk9ci5zdHJhdGVneT09PUx5PygodCxlKT0+e2xldCBpO2Zvcig7Oyl7aWYoMD09PXQubG9va2FoZWFkJiYoUXkodCksMD09PXQubG9va2FoZWFkKSl7aWYoZT09PWJ5KXJldHVybiAxO2JyZWFrfWlmKHQubWF0Y2hfbGVuZ3RoPTAsaT12eSh0LDAsdC53aW5kb3dbdC5zdHJzdGFydF0pLHQubG9va2FoZWFkLS0sdC5zdHJzdGFydCsrLGkmJihYeSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCkpcmV0dXJuIDF9cmV0dXJuIHQuaW5zZXJ0PTAsZT09PVN5PyhYeSh0LCEwKSwwPT09dC5zdHJtLmF2YWlsX291dD8zOjQpOnQubGFzdF9saXQmJihYeSh0LCExKSwwPT09dC5zdHJtLmF2YWlsX291dCk/MToyfSkocixlKTpyLnN0cmF0ZWd5PT09T3k/KCh0LGUpPT57bGV0IGksbixyLHM7Y29uc3Qgbz10LndpbmRvdztmb3IoOzspe2lmKHQubG9va2FoZWFkPD16eSl7aWYoUXkodCksdC5sb29rYWhlYWQ8PXp5JiZlPT09YnkpcmV0dXJuIDE7aWYoMD09PXQubG9va2FoZWFkKWJyZWFrfWlmKHQubWF0Y2hfbGVuZ3RoPTAsdC5sb29rYWhlYWQ+PTMmJnQuc3Ryc3RhcnQ+MCYmKHI9dC5zdHJzdGFydC0xLG49b1tyXSxuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdKSl7cz10LnN0cnN0YXJ0K3p5O2Rve313aGlsZShuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdJiZuPT09b1srK3JdJiZyPHMpO3QubWF0Y2hfbGVuZ3RoPXp5LShzLXIpLHQubWF0Y2hfbGVuZ3RoPnQubG9va2FoZWFkJiYodC5tYXRjaF9sZW5ndGg9dC5sb29rYWhlYWQpfWlmKHQubWF0Y2hfbGVuZ3RoPj0zPyhpPXZ5KHQsMSx0Lm1hdGNoX2xlbmd0aC0zKSx0Lmxvb2thaGVhZC09dC5tYXRjaF9sZW5ndGgsdC5zdHJzdGFydCs9dC5tYXRjaF9sZW5ndGgsdC5tYXRjaF9sZW5ndGg9MCk6KGk9dnkodCwwLHQud2luZG93W3Quc3Ryc3RhcnRdKSx0Lmxvb2thaGVhZC0tLHQuc3Ryc3RhcnQrKyksaSYmKFh5KHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KSlyZXR1cm4gMX1yZXR1cm4gdC5pbnNlcnQ9MCxlPT09U3k/KFh5KHQsITApLDA9PT10LnN0cm0uYXZhaWxfb3V0PzM6NCk6dC5sYXN0X2xpdCYmKFh5KHQsITEpLDA9PT10LnN0cm0uYXZhaWxfb3V0KT8xOjJ9KShyLGUpOm5iW3IubGV2ZWxdLmZ1bmMocixlKTtpZigzIT09aSYmNCE9PWl8fChyLnN0YXR1cz1IeSksMT09PWl8fDM9PT1pKXJldHVybiAwPT09dC5hdmFpbF9vdXQmJihyLmxhc3RfZmx1c2g9LTEpLFR5O2lmKDI9PT1pJiYoZT09PXh5P3l5KHIpOmUhPT1NeSYmKGd5KHIsMCwwLCExKSxlPT09d3kmJihHeShyLmhlYWQpLDA9PT1yLmxvb2thaGVhZCYmKHIuc3Ryc3RhcnQ9MCxyLmJsb2NrX3N0YXJ0PTAsci5pbnNlcnQ9MCkpKSxXeSh0KSwwPT09dC5hdmFpbF9vdXQpKXJldHVybiByLmxhc3RfZmx1c2g9LTEsVHl9cmV0dXJuIGUhPT1TeT9UeTpyLndyYXA8PTA/Q3k6KDI9PT1yLndyYXA/KFl5KHIsMjU1JnQuYWRsZXIpLFl5KHIsdC5hZGxlcj4+OCYyNTUpLFl5KHIsdC5hZGxlcj4+MTYmMjU1KSxZeShyLHQuYWRsZXI+PjI0JjI1NSksWXkociwyNTUmdC50b3RhbF9pbiksWXkocix0LnRvdGFsX2luPj44JjI1NSksWXkocix0LnRvdGFsX2luPj4xNiYyNTUpLFl5KHIsdC50b3RhbF9pbj4+MjQmMjU1KSk6KFp5KHIsdC5hZGxlcj4+PjE2KSxaeShyLDY1NTM1JnQuYWRsZXIpKSxXeSh0KSxyLndyYXA+MCYmKHIud3JhcD0tci53cmFwKSwwIT09ci5wZW5kaW5nP1R5OkN5KX0sZGVmbGF0ZUVuZDp0PT57aWYoIXR8fCF0LnN0YXRlKXJldHVybiBFeTtjb25zdCBlPXQuc3RhdGUuc3RhdHVzO3JldHVybiA0MiE9PWUmJjY5IT09ZSYmNzMhPT1lJiY5MSE9PWUmJmUhPT1CeSYmZSE9PWp5JiZlIT09SHk/VXkodCxFeSk6KHQuc3RhdGU9bnVsbCxlPT09ank/VXkodCxJeSk6VHkpfSxkZWZsYXRlU2V0RGljdGlvbmFyeToodCxlKT0+e2xldCBpPWUubGVuZ3RoO2lmKCF0fHwhdC5zdGF0ZSlyZXR1cm4gRXk7Y29uc3Qgbj10LnN0YXRlLHI9bi53cmFwO2lmKDI9PT1yfHwxPT09ciYmNDIhPT1uLnN0YXR1c3x8bi5sb29rYWhlYWQpcmV0dXJuIEV5O2lmKDE9PT1yJiYodC5hZGxlcj1seSh0LmFkbGVyLGUsaSwwKSksbi53cmFwPTAsaT49bi53X3NpemUpezA9PT1yJiYoR3kobi5oZWFkKSxuLnN0cnN0YXJ0PTAsbi5ibG9ja19zdGFydD0wLG4uaW5zZXJ0PTApO2xldCB0PW5ldyBVaW50OEFycmF5KG4ud19zaXplKTt0LnNldChlLnN1YmFycmF5KGktbi53X3NpemUsaSksMCksZT10LGk9bi53X3NpemV9Y29uc3Qgcz10LmF2YWlsX2luLG89dC5uZXh0X2luLGE9dC5pbnB1dDtmb3IodC5hdmFpbF9pbj1pLHQubmV4dF9pbj0wLHQuaW5wdXQ9ZSxReShuKTtuLmxvb2thaGVhZD49Mzspe2xldCB0PW4uc3Ryc3RhcnQsZT1uLmxvb2thaGVhZC0yO2Rve24uaW5zX2g9cXkobixuLmluc19oLG4ud2luZG93W3QrMy0xXSksbi5wcmV2W3Qmbi53X21hc2tdPW4uaGVhZFtuLmluc19oXSxuLmhlYWRbbi5pbnNfaF09dCx0Kyt9d2hpbGUoLS1lKTtuLnN0cnN0YXJ0PXQsbi5sb29rYWhlYWQ9MixReShuKX1yZXR1cm4gbi5zdHJzdGFydCs9bi5sb29rYWhlYWQsbi5ibG9ja19zdGFydD1uLnN0cnN0YXJ0LG4uaW5zZXJ0PW4ubG9va2FoZWFkLG4ubG9va2FoZWFkPTAsbi5tYXRjaF9sZW5ndGg9bi5wcmV2X2xlbmd0aD0yLG4ubWF0Y2hfYXZhaWxhYmxlPTAsdC5uZXh0X2luPW8sdC5pbnB1dD1hLHQuYXZhaWxfaW49cyxuLndyYXA9cixUeX0sZGVmbGF0ZUluZm86XCJwYWtvIGRlZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpXCJ9O2NvbnN0IGhiPSh0LGUpPT5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxlKTt2YXIgbGI9ZnVuY3Rpb24odCl7Y29uc3QgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7Zm9yKDtlLmxlbmd0aDspe2NvbnN0IGk9ZS5zaGlmdCgpO2lmKGkpe2lmKFwib2JqZWN0XCIhPXR5cGVvZiBpKXRocm93IG5ldyBUeXBlRXJyb3IoaStcIm11c3QgYmUgbm9uLW9iamVjdFwiKTtmb3IoY29uc3QgZSBpbiBpKWhiKGksZSkmJih0W2VdPWlbZV0pfX1yZXR1cm4gdH0sdWI9dD0+e2xldCBlPTA7Zm9yKGxldCBpPTAsbj10Lmxlbmd0aDtpPG47aSsrKWUrPXRbaV0ubGVuZ3RoO2NvbnN0IGk9bmV3IFVpbnQ4QXJyYXkoZSk7Zm9yKGxldCBlPTAsbj0wLHI9dC5sZW5ndGg7ZTxyO2UrKyl7bGV0IHI9dFtlXTtpLnNldChyLG4pLG4rPXIubGVuZ3RofXJldHVybiBpfTtsZXQgZGI9ITA7dHJ5e1N0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCxuZXcgVWludDhBcnJheSgxKSl9Y2F0Y2godCl7ZGI9ITF9Y29uc3QgcGI9bmV3IFVpbnQ4QXJyYXkoMjU2KTtmb3IobGV0IHQ9MDt0PDI1Njt0KyspcGJbdF09dD49MjUyPzY6dD49MjQ4PzU6dD49MjQwPzQ6dD49MjI0PzM6dD49MTkyPzI6MTtwYlsyNTRdPXBiWzI1NF09MTt2YXIgZmI9dD0+e2xldCBlLGksbixyLHMsbz10Lmxlbmd0aCxhPTA7Zm9yKHI9MDtyPG87cisrKWk9dC5jaGFyQ29kZUF0KHIpLDU1Mjk2PT0oNjQ1MTImaSkmJnIrMTxvJiYobj10LmNoYXJDb2RlQXQocisxKSw1NjMyMD09KDY0NTEyJm4pJiYoaT02NTUzNisoaS01NTI5Njw8MTApKyhuLTU2MzIwKSxyKyspKSxhKz1pPDEyOD8xOmk8MjA0OD8yOmk8NjU1MzY/Mzo0O2ZvcihlPW5ldyBVaW50OEFycmF5KGEpLHM9MCxyPTA7czxhO3IrKylpPXQuY2hhckNvZGVBdChyKSw1NTI5Nj09KDY0NTEyJmkpJiZyKzE8byYmKG49dC5jaGFyQ29kZUF0KHIrMSksNTYzMjA9PSg2NDUxMiZuKSYmKGk9NjU1MzYrKGktNTUyOTY8PDEwKSsobi01NjMyMCkscisrKSksaTwxMjg/ZVtzKytdPWk6aTwyMDQ4PyhlW3MrK109MTkyfGk+Pj42LGVbcysrXT0xMjh8NjMmaSk6aTw2NTUzNj8oZVtzKytdPTIyNHxpPj4+MTIsZVtzKytdPTEyOHxpPj4+NiY2MyxlW3MrK109MTI4fDYzJmkpOihlW3MrK109MjQwfGk+Pj4xOCxlW3MrK109MTI4fGk+Pj4xMiY2MyxlW3MrK109MTI4fGk+Pj42JjYzLGVbcysrXT0xMjh8NjMmaSk7cmV0dXJuIGV9LG1iPSh0LGUpPT57bGV0IGksbjtjb25zdCByPWV8fHQubGVuZ3RoLHM9bmV3IEFycmF5KDIqcik7Zm9yKG49MCxpPTA7aTxyOyl7bGV0IGU9dFtpKytdO2lmKGU8MTI4KXtzW24rK109ZTtjb250aW51ZX1sZXQgbz1wYltlXTtpZihvPjQpc1tuKytdPTY1NTMzLGkrPW8tMTtlbHNle2ZvcihlJj0yPT09bz8zMTozPT09bz8xNTo3O28+MSYmaTxyOyllPWU8PDZ8NjMmdFtpKytdLG8tLTtvPjE/c1tuKytdPTY1NTMzOmU8NjU1MzY/c1tuKytdPWU6KGUtPTY1NTM2LHNbbisrXT01NTI5NnxlPj4xMCYxMDIzLHNbbisrXT01NjMyMHwxMDIzJmUpfX1yZXR1cm4oKHQsZSk9PntpZihlPDY1NTM0JiZ0LnN1YmFycmF5JiZkYilyZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLHQubGVuZ3RoPT09ZT90OnQuc3ViYXJyYXkoMCxlKSk7bGV0IGk9XCJcIjtmb3IobGV0IG49MDtuPGU7bisrKWkrPVN0cmluZy5mcm9tQ2hhckNvZGUodFtuXSk7cmV0dXJuIGl9KShzLG4pfSxnYj0odCxlKT0+eyhlPWV8fHQubGVuZ3RoKT50Lmxlbmd0aCYmKGU9dC5sZW5ndGgpO2xldCBpPWUtMTtmb3IoO2k+PTAmJjEyOD09KDE5MiZ0W2ldKTspaS0tO3JldHVybiBpPDB8fDA9PT1pP2U6aStwYlt0W2ldXT5lP2k6ZX07dmFyIF9iPWZ1bmN0aW9uKCl7dGhpcy5pbnB1dD1udWxsLHRoaXMubmV4dF9pbj0wLHRoaXMuYXZhaWxfaW49MCx0aGlzLnRvdGFsX2luPTAsdGhpcy5vdXRwdXQ9bnVsbCx0aGlzLm5leHRfb3V0PTAsdGhpcy5hdmFpbF9vdXQ9MCx0aGlzLnRvdGFsX291dD0wLHRoaXMubXNnPVwiXCIsdGhpcy5zdGF0ZT1udWxsLHRoaXMuZGF0YV90eXBlPTIsdGhpcy5hZGxlcj0wfTtjb25zdCB2Yj1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLHtaX05PX0ZMVVNIOnliLFpfU1lOQ19GTFVTSDpiYixaX0ZVTExfRkxVU0g6eGIsWl9GSU5JU0g6d2IsWl9PSzpTYixaX1NUUkVBTV9FTkQ6TWIsWl9ERUZBVUxUX0NPTVBSRVNTSU9OOlRiLFpfREVGQVVMVF9TVFJBVEVHWTpDYixaX0RFRkxBVEVEOkVifT1meTtmdW5jdGlvbiBJYih0KXt0aGlzLm9wdGlvbnM9bGIoe2xldmVsOlRiLG1ldGhvZDpFYixjaHVua1NpemU6MTYzODQsd2luZG93Qml0czoxNSxtZW1MZXZlbDo4LHN0cmF0ZWd5OkNifSx0fHx7fSk7bGV0IGU9dGhpcy5vcHRpb25zO2UucmF3JiZlLndpbmRvd0JpdHM+MD9lLndpbmRvd0JpdHM9LWUud2luZG93Qml0czplLmd6aXAmJmUud2luZG93Qml0cz4wJiZlLndpbmRvd0JpdHM8MTYmJihlLndpbmRvd0JpdHMrPTE2KSx0aGlzLmVycj0wLHRoaXMubXNnPVwiXCIsdGhpcy5lbmRlZD0hMSx0aGlzLmNodW5rcz1bXSx0aGlzLnN0cm09bmV3IF9iLHRoaXMuc3RybS5hdmFpbF9vdXQ9MDtsZXQgaT1jYi5kZWZsYXRlSW5pdDIodGhpcy5zdHJtLGUubGV2ZWwsZS5tZXRob2QsZS53aW5kb3dCaXRzLGUubWVtTGV2ZWwsZS5zdHJhdGVneSk7aWYoaSE9PVNiKXRocm93IG5ldyBFcnJvcihweVtpXSk7aWYoZS5oZWFkZXImJmNiLmRlZmxhdGVTZXRIZWFkZXIodGhpcy5zdHJtLGUuaGVhZGVyKSxlLmRpY3Rpb25hcnkpe2xldCB0O2lmKHQ9XCJzdHJpbmdcIj09dHlwZW9mIGUuZGljdGlvbmFyeT9mYihlLmRpY3Rpb25hcnkpOlwiW29iamVjdCBBcnJheUJ1ZmZlcl1cIj09PXZiLmNhbGwoZS5kaWN0aW9uYXJ5KT9uZXcgVWludDhBcnJheShlLmRpY3Rpb25hcnkpOmUuZGljdGlvbmFyeSxpPWNiLmRlZmxhdGVTZXREaWN0aW9uYXJ5KHRoaXMuc3RybSx0KSxpIT09U2IpdGhyb3cgbmV3IEVycm9yKHB5W2ldKTt0aGlzLl9kaWN0X3NldD0hMH19SWIucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24odCxlKXtjb25zdCBpPXRoaXMuc3RybSxuPXRoaXMub3B0aW9ucy5jaHVua1NpemU7bGV0IHIscztpZih0aGlzLmVuZGVkKXJldHVybiExO2ZvcihzPWU9PT1+fmU/ZTohMD09PWU/d2I6eWIsXCJzdHJpbmdcIj09dHlwZW9mIHQ/aS5pbnB1dD1mYih0KTpcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT12Yi5jYWxsKHQpP2kuaW5wdXQ9bmV3IFVpbnQ4QXJyYXkodCk6aS5pbnB1dD10LGkubmV4dF9pbj0wLGkuYXZhaWxfaW49aS5pbnB1dC5sZW5ndGg7OylpZigwPT09aS5hdmFpbF9vdXQmJihpLm91dHB1dD1uZXcgVWludDhBcnJheShuKSxpLm5leHRfb3V0PTAsaS5hdmFpbF9vdXQ9biksKHM9PT1iYnx8cz09PXhiKSYmaS5hdmFpbF9vdXQ8PTYpdGhpcy5vbkRhdGEoaS5vdXRwdXQuc3ViYXJyYXkoMCxpLm5leHRfb3V0KSksaS5hdmFpbF9vdXQ9MDtlbHNle2lmKHI9Y2IuZGVmbGF0ZShpLHMpLHI9PT1NYilyZXR1cm4gaS5uZXh0X291dD4wJiZ0aGlzLm9uRGF0YShpLm91dHB1dC5zdWJhcnJheSgwLGkubmV4dF9vdXQpKSxyPWNiLmRlZmxhdGVFbmQodGhpcy5zdHJtKSx0aGlzLm9uRW5kKHIpLHRoaXMuZW5kZWQ9ITAscj09PVNiO2lmKDAhPT1pLmF2YWlsX291dCl7aWYocz4wJiZpLm5leHRfb3V0PjApdGhpcy5vbkRhdGEoaS5vdXRwdXQuc3ViYXJyYXkoMCxpLm5leHRfb3V0KSksaS5hdmFpbF9vdXQ9MDtlbHNlIGlmKDA9PT1pLmF2YWlsX2luKWJyZWFrfWVsc2UgdGhpcy5vbkRhdGEoaS5vdXRwdXQpfXJldHVybiEwfSxJYi5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKHQpe3RoaXMuY2h1bmtzLnB1c2godCl9LEliLnByb3RvdHlwZS5vbkVuZD1mdW5jdGlvbih0KXt0PT09U2ImJih0aGlzLnJlc3VsdD11Yih0aGlzLmNodW5rcykpLHRoaXMuY2h1bmtzPVtdLHRoaXMuZXJyPXQsdGhpcy5tc2c9dGhpcy5zdHJtLm1zZ307dmFyIEFiPWZ1bmN0aW9uKHQsZSl7bGV0IGksbixyLHMsbyxhLGMsaCxsLHUsZCxwLGYsbSxnLF8sdix5LGIseCx3LFMsTSxUO2NvbnN0IEM9dC5zdGF0ZTtpPXQubmV4dF9pbixNPXQuaW5wdXQsbj1pKyh0LmF2YWlsX2luLTUpLHI9dC5uZXh0X291dCxUPXQub3V0cHV0LHM9ci0oZS10LmF2YWlsX291dCksbz1yKyh0LmF2YWlsX291dC0yNTcpLGE9Qy5kbWF4LGM9Qy53c2l6ZSxoPUMud2hhdmUsbD1DLnduZXh0LHU9Qy53aW5kb3csZD1DLmhvbGQscD1DLmJpdHMsZj1DLmxlbmNvZGUsbT1DLmRpc3Rjb2RlLGc9KDE8PEMubGVuYml0cyktMSxfPSgxPDxDLmRpc3RiaXRzKS0xO3Q6ZG97cDwxNSYmKGQrPU1baSsrXTw8cCxwKz04LGQrPU1baSsrXTw8cCxwKz04KSx2PWZbZCZnXTtlOmZvcig7Oyl7aWYoeT12Pj4+MjQsZD4+Pj15LHAtPXkseT12Pj4+MTYmMjU1LDA9PT15KVRbcisrXT02NTUzNSZ2O2Vsc2V7aWYoISgxNiZ5KSl7aWYoMD09KDY0JnkpKXt2PWZbKDY1NTM1JnYpKyhkJigxPDx5KS0xKV07Y29udGludWUgZX1pZigzMiZ5KXtDLm1vZGU9MTI7YnJlYWsgdH10Lm1zZz1cImludmFsaWQgbGl0ZXJhbC9sZW5ndGggY29kZVwiLEMubW9kZT0zMDticmVhayB0fWI9NjU1MzUmdix5Jj0xNSx5JiYocDx5JiYoZCs9TVtpKytdPDxwLHArPTgpLGIrPWQmKDE8PHkpLTEsZD4+Pj15LHAtPXkpLHA8MTUmJihkKz1NW2krK108PHAscCs9OCxkKz1NW2krK108PHAscCs9OCksdj1tW2QmX107aTpmb3IoOzspe2lmKHk9dj4+PjI0LGQ+Pj49eSxwLT15LHk9dj4+PjE2JjI1NSwhKDE2JnkpKXtpZigwPT0oNjQmeSkpe3Y9bVsoNjU1MzUmdikrKGQmKDE8PHkpLTEpXTtjb250aW51ZSBpfXQubXNnPVwiaW52YWxpZCBkaXN0YW5jZSBjb2RlXCIsQy5tb2RlPTMwO2JyZWFrIHR9aWYoeD02NTUzNSZ2LHkmPTE1LHA8eSYmKGQrPU1baSsrXTw8cCxwKz04LHA8eSYmKGQrPU1baSsrXTw8cCxwKz04KSkseCs9ZCYoMTw8eSktMSx4PmEpe3QubXNnPVwiaW52YWxpZCBkaXN0YW5jZSB0b28gZmFyIGJhY2tcIixDLm1vZGU9MzA7YnJlYWsgdH1pZihkPj4+PXkscC09eSx5PXItcyx4Pnkpe2lmKHk9eC15LHk+aCYmQy5zYW5lKXt0Lm1zZz1cImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrXCIsQy5tb2RlPTMwO2JyZWFrIHR9aWYodz0wLFM9dSwwPT09bCl7aWYodys9Yy15LHk8Yil7Yi09eTtkb3tUW3IrK109dVt3KytdfXdoaWxlKC0teSk7dz1yLXgsUz1UfX1lbHNlIGlmKGw8eSl7aWYodys9YytsLXkseS09bCx5PGIpe2ItPXk7ZG97VFtyKytdPXVbdysrXX13aGlsZSgtLXkpO2lmKHc9MCxsPGIpe3k9bCxiLT15O2Rve1RbcisrXT11W3crK119d2hpbGUoLS15KTt3PXIteCxTPVR9fX1lbHNlIGlmKHcrPWwteSx5PGIpe2ItPXk7ZG97VFtyKytdPXVbdysrXX13aGlsZSgtLXkpO3c9ci14LFM9VH1mb3IoO2I+MjspVFtyKytdPVNbdysrXSxUW3IrK109U1t3KytdLFRbcisrXT1TW3crK10sYi09MztiJiYoVFtyKytdPVNbdysrXSxiPjEmJihUW3IrK109U1t3KytdKSl9ZWxzZXt3PXIteDtkb3tUW3IrK109VFt3KytdLFRbcisrXT1UW3crK10sVFtyKytdPVRbdysrXSxiLT0zfXdoaWxlKGI+Mik7YiYmKFRbcisrXT1UW3crK10sYj4xJiYoVFtyKytdPVRbdysrXSkpfWJyZWFrfX1icmVha319d2hpbGUoaTxuJiZyPG8pO2I9cD4+MyxpLT1iLHAtPWI8PDMsZCY9KDE8PHApLTEsdC5uZXh0X2luPWksdC5uZXh0X291dD1yLHQuYXZhaWxfaW49aTxuP24taSs1OjUtKGktbiksdC5hdmFpbF9vdXQ9cjxvP28tcisyNTc6MjU3LShyLW8pLEMuaG9sZD1kLEMuYml0cz1wfTtjb25zdCBQYj0xNSxSYj1uZXcgVWludDE2QXJyYXkoWzMsNCw1LDYsNyw4LDksMTAsMTEsMTMsMTUsMTcsMTksMjMsMjcsMzEsMzUsNDMsNTEsNTksNjcsODMsOTksMTE1LDEzMSwxNjMsMTk1LDIyNywyNTgsMCwwXSksTGI9bmV3IFVpbnQ4QXJyYXkoWzE2LDE2LDE2LDE2LDE2LDE2LDE2LDE2LDE3LDE3LDE3LDE3LDE4LDE4LDE4LDE4LDE5LDE5LDE5LDE5LDIwLDIwLDIwLDIwLDIxLDIxLDIxLDIxLDE2LDcyLDc4XSksT2I9bmV3IFVpbnQxNkFycmF5KFsxLDIsMyw0LDUsNyw5LDEzLDE3LDI1LDMzLDQ5LDY1LDk3LDEyOSwxOTMsMjU3LDM4NSw1MTMsNzY5LDEwMjUsMTUzNywyMDQ5LDMwNzMsNDA5Nyw2MTQ1LDgxOTMsMTIyODksMTYzODUsMjQ1NzcsMCwwXSksTmI9bmV3IFVpbnQ4QXJyYXkoWzE2LDE2LDE2LDE2LDE3LDE3LDE4LDE4LDE5LDE5LDIwLDIwLDIxLDIxLDIyLDIyLDIzLDIzLDI0LDI0LDI1LDI1LDI2LDI2LDI3LDI3LDI4LDI4LDI5LDI5LDY0LDY0XSk7dmFyIERiPSh0LGUsaSxuLHIscyxvLGEpPT57Y29uc3QgYz1hLmJpdHM7bGV0IGgsbCx1LGQscCxmLG09MCxnPTAsXz0wLHY9MCx5PTAsYj0wLHg9MCx3PTAsUz0wLE09MCxUPW51bGwsQz0wO2NvbnN0IEU9bmV3IFVpbnQxNkFycmF5KDE2KSxJPW5ldyBVaW50MTZBcnJheSgxNik7bGV0IEEsUCxSLEw9bnVsbCxPPTA7Zm9yKG09MDttPD1QYjttKyspRVttXT0wO2ZvcihnPTA7ZzxuO2crKylFW2VbaStnXV0rKztmb3IoeT1jLHY9UGI7dj49MSYmMD09PUVbdl07di0tKTtpZih5PnYmJih5PXYpLDA9PT12KXJldHVybiByW3MrK109MjA5NzE1MjAscltzKytdPTIwOTcxNTIwLGEuYml0cz0xLDA7Zm9yKF89MTtfPHYmJjA9PT1FW19dO18rKyk7Zm9yKHk8XyYmKHk9Xyksdz0xLG09MTttPD1QYjttKyspaWYodzw8PTEsdy09RVttXSx3PDApcmV0dXJuLTE7aWYodz4wJiYoMD09PXR8fDEhPT12KSlyZXR1cm4tMTtmb3IoSVsxXT0wLG09MTttPFBiO20rKylJW20rMV09SVttXStFW21dO2ZvcihnPTA7ZzxuO2crKykwIT09ZVtpK2ddJiYob1tJW2VbaStnXV0rK109Zyk7aWYoMD09PXQ/KFQ9TD1vLGY9MTkpOjE9PT10PyhUPVJiLEMtPTI1NyxMPUxiLE8tPTI1NyxmPTI1Nik6KFQ9T2IsTD1OYixmPS0xKSxNPTAsZz0wLG09XyxwPXMsYj15LHg9MCx1PS0xLFM9MTw8eSxkPVMtMSwxPT09dCYmUz44NTJ8fDI9PT10JiZTPjU5MilyZXR1cm4gMTtmb3IoOzspe0E9bS14LG9bZ108Zj8oUD0wLFI9b1tnXSk6b1tnXT5mPyhQPUxbTytvW2ddXSxSPVRbQytvW2ddXSk6KFA9OTYsUj0wKSxoPTE8PG0teCxsPTE8PGIsXz1sO2Rve2wtPWgscltwKyhNPj54KStsXT1BPDwyNHxQPDwxNnxSfDB9d2hpbGUoMCE9PWwpO2ZvcihoPTE8PG0tMTtNJmg7KWg+Pj0xO2lmKDAhPT1oPyhNJj1oLTEsTSs9aCk6TT0wLGcrKywwPT0tLUVbbV0pe2lmKG09PT12KWJyZWFrO209ZVtpK29bZ11dfWlmKG0+eSYmKE0mZCkhPT11KXtmb3IoMD09PXgmJih4PXkpLHArPV8sYj1tLXgsdz0xPDxiO2IreDx2JiYody09RVtiK3hdLCEodzw9MCkpOyliKyssdzw8PTE7aWYoUys9MTw8YiwxPT09dCYmUz44NTJ8fDI9PT10JiZTPjU5MilyZXR1cm4gMTt1PU0mZCxyW3VdPXk8PDI0fGI8PDE2fHAtc3wwfX1yZXR1cm4gMCE9PU0mJihyW3ArTV09bS14PDwyNHw2NDw8MTZ8MCksYS5iaXRzPXksMH07Y29uc3R7Wl9GSU5JU0g6JGIsWl9CTE9DSzprYixaX1RSRUVTOnpiLFpfT0s6RmIsWl9TVFJFQU1fRU5EOkJiLFpfTkVFRF9ESUNUOmpiLFpfU1RSRUFNX0VSUk9SOkhiLFpfREFUQV9FUlJPUjpVYixaX01FTV9FUlJPUjpWYixaX0JVRl9FUlJPUjpHYixaX0RFRkxBVEVEOnFifT1meSxXYj0xMixYYj0zMCxZYj10PT4odD4+PjI0JjI1NSkrKHQ+Pj44JjY1MjgwKSsoKDY1MjgwJnQpPDw4KSsoKDI1NSZ0KTw8MjQpO2Z1bmN0aW9uIFpiKCl7dGhpcy5tb2RlPTAsdGhpcy5sYXN0PSExLHRoaXMud3JhcD0wLHRoaXMuaGF2ZWRpY3Q9ITEsdGhpcy5mbGFncz0wLHRoaXMuZG1heD0wLHRoaXMuY2hlY2s9MCx0aGlzLnRvdGFsPTAsdGhpcy5oZWFkPW51bGwsdGhpcy53Yml0cz0wLHRoaXMud3NpemU9MCx0aGlzLndoYXZlPTAsdGhpcy53bmV4dD0wLHRoaXMud2luZG93PW51bGwsdGhpcy5ob2xkPTAsdGhpcy5iaXRzPTAsdGhpcy5sZW5ndGg9MCx0aGlzLm9mZnNldD0wLHRoaXMuZXh0cmE9MCx0aGlzLmxlbmNvZGU9bnVsbCx0aGlzLmRpc3Rjb2RlPW51bGwsdGhpcy5sZW5iaXRzPTAsdGhpcy5kaXN0Yml0cz0wLHRoaXMubmNvZGU9MCx0aGlzLm5sZW49MCx0aGlzLm5kaXN0PTAsdGhpcy5oYXZlPTAsdGhpcy5uZXh0PW51bGwsdGhpcy5sZW5zPW5ldyBVaW50MTZBcnJheSgzMjApLHRoaXMud29yaz1uZXcgVWludDE2QXJyYXkoMjg4KSx0aGlzLmxlbmR5bj1udWxsLHRoaXMuZGlzdGR5bj1udWxsLHRoaXMuc2FuZT0wLHRoaXMuYmFjaz0wLHRoaXMud2FzPTB9Y29uc3QgSmI9dD0+e2lmKCF0fHwhdC5zdGF0ZSlyZXR1cm4gSGI7Y29uc3QgZT10LnN0YXRlO3JldHVybiB0LnRvdGFsX2luPXQudG90YWxfb3V0PWUudG90YWw9MCx0Lm1zZz1cIlwiLGUud3JhcCYmKHQuYWRsZXI9MSZlLndyYXApLGUubW9kZT0xLGUubGFzdD0wLGUuaGF2ZWRpY3Q9MCxlLmRtYXg9MzI3NjgsZS5oZWFkPW51bGwsZS5ob2xkPTAsZS5iaXRzPTAsZS5sZW5jb2RlPWUubGVuZHluPW5ldyBJbnQzMkFycmF5KDg1MiksZS5kaXN0Y29kZT1lLmRpc3RkeW49bmV3IEludDMyQXJyYXkoNTkyKSxlLnNhbmU9MSxlLmJhY2s9LTEsRmJ9LEtiPXQ9PntpZighdHx8IXQuc3RhdGUpcmV0dXJuIEhiO2NvbnN0IGU9dC5zdGF0ZTtyZXR1cm4gZS53c2l6ZT0wLGUud2hhdmU9MCxlLnduZXh0PTAsSmIodCl9LFFiPSh0LGUpPT57bGV0IGk7aWYoIXR8fCF0LnN0YXRlKXJldHVybiBIYjtjb25zdCBuPXQuc3RhdGU7cmV0dXJuIGU8MD8oaT0wLGU9LWUpOihpPTErKGU+PjQpLGU8NDgmJihlJj0xNSkpLGUmJihlPDh8fGU+MTUpP0hiOihudWxsIT09bi53aW5kb3cmJm4ud2JpdHMhPT1lJiYobi53aW5kb3c9bnVsbCksbi53cmFwPWksbi53Yml0cz1lLEtiKHQpKX0sdHg9KHQsZSk9PntpZighdClyZXR1cm4gSGI7Y29uc3QgaT1uZXcgWmI7dC5zdGF0ZT1pLGkud2luZG93PW51bGw7Y29uc3Qgbj1RYih0LGUpO3JldHVybiBuIT09RmImJih0LnN0YXRlPW51bGwpLG59O2xldCBleCxpeCxueD0hMDtjb25zdCByeD10PT57aWYobngpe2V4PW5ldyBJbnQzMkFycmF5KDUxMiksaXg9bmV3IEludDMyQXJyYXkoMzIpO2xldCBlPTA7Zm9yKDtlPDE0NDspdC5sZW5zW2UrK109ODtmb3IoO2U8MjU2Oyl0LmxlbnNbZSsrXT05O2Zvcig7ZTwyODA7KXQubGVuc1tlKytdPTc7Zm9yKDtlPDI4ODspdC5sZW5zW2UrK109ODtmb3IoRGIoMSx0LmxlbnMsMCwyODgsZXgsMCx0Lndvcmsse2JpdHM6OX0pLGU9MDtlPDMyOyl0LmxlbnNbZSsrXT01O0RiKDIsdC5sZW5zLDAsMzIsaXgsMCx0Lndvcmsse2JpdHM6NX0pLG54PSExfXQubGVuY29kZT1leCx0LmxlbmJpdHM9OSx0LmRpc3Rjb2RlPWl4LHQuZGlzdGJpdHM9NX0sc3g9KHQsZSxpLG4pPT57bGV0IHI7Y29uc3Qgcz10LnN0YXRlO3JldHVybiBudWxsPT09cy53aW5kb3cmJihzLndzaXplPTE8PHMud2JpdHMscy53bmV4dD0wLHMud2hhdmU9MCxzLndpbmRvdz1uZXcgVWludDhBcnJheShzLndzaXplKSksbj49cy53c2l6ZT8ocy53aW5kb3cuc2V0KGUuc3ViYXJyYXkoaS1zLndzaXplLGkpLDApLHMud25leHQ9MCxzLndoYXZlPXMud3NpemUpOihyPXMud3NpemUtcy53bmV4dCxyPm4mJihyPW4pLHMud2luZG93LnNldChlLnN1YmFycmF5KGktbixpLW4rcikscy53bmV4dCksKG4tPXIpPyhzLndpbmRvdy5zZXQoZS5zdWJhcnJheShpLW4saSksMCkscy53bmV4dD1uLHMud2hhdmU9cy53c2l6ZSk6KHMud25leHQrPXIscy53bmV4dD09PXMud3NpemUmJihzLnduZXh0PTApLHMud2hhdmU8cy53c2l6ZSYmKHMud2hhdmUrPXIpKSksMH07dmFyIG94PXtpbmZsYXRlUmVzZXQ6S2IsaW5mbGF0ZVJlc2V0MjpRYixpbmZsYXRlUmVzZXRLZWVwOkpiLGluZmxhdGVJbml0OnQ9PnR4KHQsMTUpLGluZmxhdGVJbml0Mjp0eCxpbmZsYXRlOih0LGUpPT57bGV0IGksbixyLHMsbyxhLGMsaCxsLHUsZCxwLGYsbSxnLF8sdix5LGIseCx3LFMsTT0wO2NvbnN0IFQ9bmV3IFVpbnQ4QXJyYXkoNCk7bGV0IEMsRTtjb25zdCBJPW5ldyBVaW50OEFycmF5KFsxNiwxNywxOCwwLDgsNyw5LDYsMTAsNSwxMSw0LDEyLDMsMTMsMiwxNCwxLDE1XSk7aWYoIXR8fCF0LnN0YXRlfHwhdC5vdXRwdXR8fCF0LmlucHV0JiYwIT09dC5hdmFpbF9pbilyZXR1cm4gSGI7aT10LnN0YXRlLGkubW9kZT09PVdiJiYoaS5tb2RlPTEzKSxvPXQubmV4dF9vdXQscj10Lm91dHB1dCxjPXQuYXZhaWxfb3V0LHM9dC5uZXh0X2luLG49dC5pbnB1dCxhPXQuYXZhaWxfaW4saD1pLmhvbGQsbD1pLmJpdHMsdT1hLGQ9YyxTPUZiO3Q6Zm9yKDs7KXN3aXRjaChpLm1vZGUpe2Nhc2UgMTppZigwPT09aS53cmFwKXtpLm1vZGU9MTM7YnJlYWt9Zm9yKDtsPDE2Oyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aWYoMiZpLndyYXAmJjM1NjE1PT09aCl7aS5jaGVjaz0wLFRbMF09MjU1JmgsVFsxXT1oPj4+OCYyNTUsaS5jaGVjaz1keShpLmNoZWNrLFQsMiwwKSxoPTAsbD0wLGkubW9kZT0yO2JyZWFrfWlmKGkuZmxhZ3M9MCxpLmhlYWQmJihpLmhlYWQuZG9uZT0hMSksISgxJmkud3JhcCl8fCgoKDI1NSZoKTw8OCkrKGg+PjgpKSUzMSl7dC5tc2c9XCJpbmNvcnJlY3QgaGVhZGVyIGNoZWNrXCIsaS5tb2RlPVhiO2JyZWFrfWlmKCgxNSZoKSE9PXFiKXt0Lm1zZz1cInVua25vd24gY29tcHJlc3Npb24gbWV0aG9kXCIsaS5tb2RlPVhiO2JyZWFrfWlmKGg+Pj49NCxsLT00LHc9OCsoMTUmaCksMD09PWkud2JpdHMpaS53Yml0cz13O2Vsc2UgaWYodz5pLndiaXRzKXt0Lm1zZz1cImludmFsaWQgd2luZG93IHNpemVcIixpLm1vZGU9WGI7YnJlYWt9aS5kbWF4PTE8PGkud2JpdHMsdC5hZGxlcj1pLmNoZWNrPTEsaS5tb2RlPTUxMiZoPzEwOldiLGg9MCxsPTA7YnJlYWs7Y2FzZSAyOmZvcig7bDwxNjspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWlmKGkuZmxhZ3M9aCwoMjU1JmkuZmxhZ3MpIT09cWIpe3QubXNnPVwidW5rbm93biBjb21wcmVzc2lvbiBtZXRob2RcIixpLm1vZGU9WGI7YnJlYWt9aWYoNTczNDQmaS5mbGFncyl7dC5tc2c9XCJ1bmtub3duIGhlYWRlciBmbGFncyBzZXRcIixpLm1vZGU9WGI7YnJlYWt9aS5oZWFkJiYoaS5oZWFkLnRleHQ9aD4+OCYxKSw1MTImaS5mbGFncyYmKFRbMF09MjU1JmgsVFsxXT1oPj4+OCYyNTUsaS5jaGVjaz1keShpLmNoZWNrLFQsMiwwKSksaD0wLGw9MCxpLm1vZGU9MztjYXNlIDM6Zm9yKDtsPDMyOyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aS5oZWFkJiYoaS5oZWFkLnRpbWU9aCksNTEyJmkuZmxhZ3MmJihUWzBdPTI1NSZoLFRbMV09aD4+PjgmMjU1LFRbMl09aD4+PjE2JjI1NSxUWzNdPWg+Pj4yNCYyNTUsaS5jaGVjaz1keShpLmNoZWNrLFQsNCwwKSksaD0wLGw9MCxpLm1vZGU9NDtjYXNlIDQ6Zm9yKDtsPDE2Oyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aS5oZWFkJiYoaS5oZWFkLnhmbGFncz0yNTUmaCxpLmhlYWQub3M9aD4+OCksNTEyJmkuZmxhZ3MmJihUWzBdPTI1NSZoLFRbMV09aD4+PjgmMjU1LGkuY2hlY2s9ZHkoaS5jaGVjayxULDIsMCkpLGg9MCxsPTAsaS5tb2RlPTU7Y2FzZSA1OmlmKDEwMjQmaS5mbGFncyl7Zm9yKDtsPDE2Oyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aS5sZW5ndGg9aCxpLmhlYWQmJihpLmhlYWQuZXh0cmFfbGVuPWgpLDUxMiZpLmZsYWdzJiYoVFswXT0yNTUmaCxUWzFdPWg+Pj44JjI1NSxpLmNoZWNrPWR5KGkuY2hlY2ssVCwyLDApKSxoPTAsbD0wfWVsc2UgaS5oZWFkJiYoaS5oZWFkLmV4dHJhPW51bGwpO2kubW9kZT02O2Nhc2UgNjppZigxMDI0JmkuZmxhZ3MmJihwPWkubGVuZ3RoLHA+YSYmKHA9YSkscCYmKGkuaGVhZCYmKHc9aS5oZWFkLmV4dHJhX2xlbi1pLmxlbmd0aCxpLmhlYWQuZXh0cmF8fChpLmhlYWQuZXh0cmE9bmV3IFVpbnQ4QXJyYXkoaS5oZWFkLmV4dHJhX2xlbikpLGkuaGVhZC5leHRyYS5zZXQobi5zdWJhcnJheShzLHMrcCksdykpLDUxMiZpLmZsYWdzJiYoaS5jaGVjaz1keShpLmNoZWNrLG4scCxzKSksYS09cCxzKz1wLGkubGVuZ3RoLT1wKSxpLmxlbmd0aCkpYnJlYWsgdDtpLmxlbmd0aD0wLGkubW9kZT03O2Nhc2UgNzppZigyMDQ4JmkuZmxhZ3Mpe2lmKDA9PT1hKWJyZWFrIHQ7cD0wO2Rve3c9bltzK3ArK10saS5oZWFkJiZ3JiZpLmxlbmd0aDw2NTUzNiYmKGkuaGVhZC5uYW1lKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHcpKX13aGlsZSh3JiZwPGEpO2lmKDUxMiZpLmZsYWdzJiYoaS5jaGVjaz1keShpLmNoZWNrLG4scCxzKSksYS09cCxzKz1wLHcpYnJlYWsgdH1lbHNlIGkuaGVhZCYmKGkuaGVhZC5uYW1lPW51bGwpO2kubGVuZ3RoPTAsaS5tb2RlPTg7Y2FzZSA4OmlmKDQwOTYmaS5mbGFncyl7aWYoMD09PWEpYnJlYWsgdDtwPTA7ZG97dz1uW3MrcCsrXSxpLmhlYWQmJncmJmkubGVuZ3RoPDY1NTM2JiYoaS5oZWFkLmNvbW1lbnQrPVN0cmluZy5mcm9tQ2hhckNvZGUodykpfXdoaWxlKHcmJnA8YSk7aWYoNTEyJmkuZmxhZ3MmJihpLmNoZWNrPWR5KGkuY2hlY2ssbixwLHMpKSxhLT1wLHMrPXAsdylicmVhayB0fWVsc2UgaS5oZWFkJiYoaS5oZWFkLmNvbW1lbnQ9bnVsbCk7aS5tb2RlPTk7Y2FzZSA5OmlmKDUxMiZpLmZsYWdzKXtmb3IoO2w8MTY7KXtpZigwPT09YSlicmVhayB0O2EtLSxoKz1uW3MrK108PGwsbCs9OH1pZihoIT09KDY1NTM1JmkuY2hlY2spKXt0Lm1zZz1cImhlYWRlciBjcmMgbWlzbWF0Y2hcIixpLm1vZGU9WGI7YnJlYWt9aD0wLGw9MH1pLmhlYWQmJihpLmhlYWQuaGNyYz1pLmZsYWdzPj45JjEsaS5oZWFkLmRvbmU9ITApLHQuYWRsZXI9aS5jaGVjaz0wLGkubW9kZT1XYjticmVhaztjYXNlIDEwOmZvcig7bDwzMjspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fXQuYWRsZXI9aS5jaGVjaz1ZYihoKSxoPTAsbD0wLGkubW9kZT0xMTtjYXNlIDExOmlmKDA9PT1pLmhhdmVkaWN0KXJldHVybiB0Lm5leHRfb3V0PW8sdC5hdmFpbF9vdXQ9Yyx0Lm5leHRfaW49cyx0LmF2YWlsX2luPWEsaS5ob2xkPWgsaS5iaXRzPWwsamI7dC5hZGxlcj1pLmNoZWNrPTEsaS5tb2RlPVdiO2Nhc2UgV2I6aWYoZT09PWtifHxlPT09emIpYnJlYWsgdDtjYXNlIDEzOmlmKGkubGFzdCl7aD4+Pj03JmwsbC09NyZsLGkubW9kZT0yNzticmVha31mb3IoO2w8Mzspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fXN3aXRjaChpLmxhc3Q9MSZoLGg+Pj49MSxsLT0xLDMmaCl7Y2FzZSAwOmkubW9kZT0xNDticmVhaztjYXNlIDE6aWYocngoaSksaS5tb2RlPTIwLGU9PT16Yil7aD4+Pj0yLGwtPTI7YnJlYWsgdH1icmVhaztjYXNlIDI6aS5tb2RlPTE3O2JyZWFrO2Nhc2UgMzp0Lm1zZz1cImludmFsaWQgYmxvY2sgdHlwZVwiLGkubW9kZT1YYn1oPj4+PTIsbC09MjticmVhaztjYXNlIDE0OmZvcihoPj4+PTcmbCxsLT03Jmw7bDwzMjspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWlmKCg2NTUzNSZoKSE9KGg+Pj4xNl42NTUzNSkpe3QubXNnPVwiaW52YWxpZCBzdG9yZWQgYmxvY2sgbGVuZ3Roc1wiLGkubW9kZT1YYjticmVha31pZihpLmxlbmd0aD02NTUzNSZoLGg9MCxsPTAsaS5tb2RlPTE1LGU9PT16YilicmVhayB0O2Nhc2UgMTU6aS5tb2RlPTE2O2Nhc2UgMTY6aWYocD1pLmxlbmd0aCxwKXtpZihwPmEmJihwPWEpLHA+YyYmKHA9YyksMD09PXApYnJlYWsgdDtyLnNldChuLnN1YmFycmF5KHMscytwKSxvKSxhLT1wLHMrPXAsYy09cCxvKz1wLGkubGVuZ3RoLT1wO2JyZWFrfWkubW9kZT1XYjticmVhaztjYXNlIDE3OmZvcig7bDwxNDspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWlmKGkubmxlbj0yNTcrKDMxJmgpLGg+Pj49NSxsLT01LGkubmRpc3Q9MSsoMzEmaCksaD4+Pj01LGwtPTUsaS5uY29kZT00KygxNSZoKSxoPj4+PTQsbC09NCxpLm5sZW4+Mjg2fHxpLm5kaXN0PjMwKXt0Lm1zZz1cInRvbyBtYW55IGxlbmd0aCBvciBkaXN0YW5jZSBzeW1ib2xzXCIsaS5tb2RlPVhiO2JyZWFrfWkuaGF2ZT0wLGkubW9kZT0xODtjYXNlIDE4OmZvcig7aS5oYXZlPGkubmNvZGU7KXtmb3IoO2w8Mzspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWkubGVuc1tJW2kuaGF2ZSsrXV09NyZoLGg+Pj49MyxsLT0zfWZvcig7aS5oYXZlPDE5OylpLmxlbnNbSVtpLmhhdmUrK11dPTA7aWYoaS5sZW5jb2RlPWkubGVuZHluLGkubGVuYml0cz03LEM9e2JpdHM6aS5sZW5iaXRzfSxTPURiKDAsaS5sZW5zLDAsMTksaS5sZW5jb2RlLDAsaS53b3JrLEMpLGkubGVuYml0cz1DLmJpdHMsUyl7dC5tc2c9XCJpbnZhbGlkIGNvZGUgbGVuZ3RocyBzZXRcIixpLm1vZGU9WGI7YnJlYWt9aS5oYXZlPTAsaS5tb2RlPTE5O2Nhc2UgMTk6Zm9yKDtpLmhhdmU8aS5ubGVuK2kubmRpc3Q7KXtmb3IoO009aS5sZW5jb2RlW2gmKDE8PGkubGVuYml0cyktMV0sZz1NPj4+MjQsXz1NPj4+MTYmMjU1LHY9NjU1MzUmTSwhKGc8PWwpOyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aWYodjwxNiloPj4+PWcsbC09ZyxpLmxlbnNbaS5oYXZlKytdPXY7ZWxzZXtpZigxNj09PXYpe2ZvcihFPWcrMjtsPEU7KXtpZigwPT09YSlicmVhayB0O2EtLSxoKz1uW3MrK108PGwsbCs9OH1pZihoPj4+PWcsbC09ZywwPT09aS5oYXZlKXt0Lm1zZz1cImludmFsaWQgYml0IGxlbmd0aCByZXBlYXRcIixpLm1vZGU9WGI7YnJlYWt9dz1pLmxlbnNbaS5oYXZlLTFdLHA9MysoMyZoKSxoPj4+PTIsbC09Mn1lbHNlIGlmKDE3PT09dil7Zm9yKEU9ZyszO2w8RTspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWg+Pj49ZyxsLT1nLHc9MCxwPTMrKDcmaCksaD4+Pj0zLGwtPTN9ZWxzZXtmb3IoRT1nKzc7bDxFOyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aD4+Pj1nLGwtPWcsdz0wLHA9MTErKDEyNyZoKSxoPj4+PTcsbC09N31pZihpLmhhdmUrcD5pLm5sZW4raS5uZGlzdCl7dC5tc2c9XCJpbnZhbGlkIGJpdCBsZW5ndGggcmVwZWF0XCIsaS5tb2RlPVhiO2JyZWFrfWZvcig7cC0tOylpLmxlbnNbaS5oYXZlKytdPXd9fWlmKGkubW9kZT09PVhiKWJyZWFrO2lmKDA9PT1pLmxlbnNbMjU2XSl7dC5tc2c9XCJpbnZhbGlkIGNvZGUgLS0gbWlzc2luZyBlbmQtb2YtYmxvY2tcIixpLm1vZGU9WGI7YnJlYWt9aWYoaS5sZW5iaXRzPTksQz17Yml0czppLmxlbmJpdHN9LFM9RGIoMSxpLmxlbnMsMCxpLm5sZW4saS5sZW5jb2RlLDAsaS53b3JrLEMpLGkubGVuYml0cz1DLmJpdHMsUyl7dC5tc2c9XCJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RocyBzZXRcIixpLm1vZGU9WGI7YnJlYWt9aWYoaS5kaXN0Yml0cz02LGkuZGlzdGNvZGU9aS5kaXN0ZHluLEM9e2JpdHM6aS5kaXN0Yml0c30sUz1EYigyLGkubGVucyxpLm5sZW4saS5uZGlzdCxpLmRpc3Rjb2RlLDAsaS53b3JrLEMpLGkuZGlzdGJpdHM9Qy5iaXRzLFMpe3QubXNnPVwiaW52YWxpZCBkaXN0YW5jZXMgc2V0XCIsaS5tb2RlPVhiO2JyZWFrfWlmKGkubW9kZT0yMCxlPT09emIpYnJlYWsgdDtjYXNlIDIwOmkubW9kZT0yMTtjYXNlIDIxOmlmKGE+PTYmJmM+PTI1OCl7dC5uZXh0X291dD1vLHQuYXZhaWxfb3V0PWMsdC5uZXh0X2luPXMsdC5hdmFpbF9pbj1hLGkuaG9sZD1oLGkuYml0cz1sLEFiKHQsZCksbz10Lm5leHRfb3V0LHI9dC5vdXRwdXQsYz10LmF2YWlsX291dCxzPXQubmV4dF9pbixuPXQuaW5wdXQsYT10LmF2YWlsX2luLGg9aS5ob2xkLGw9aS5iaXRzLGkubW9kZT09PVdiJiYoaS5iYWNrPS0xKTticmVha31mb3IoaS5iYWNrPTA7TT1pLmxlbmNvZGVbaCYoMTw8aS5sZW5iaXRzKS0xXSxnPU0+Pj4yNCxfPU0+Pj4xNiYyNTUsdj02NTUzNSZNLCEoZzw9bCk7KXtpZigwPT09YSlicmVhayB0O2EtLSxoKz1uW3MrK108PGwsbCs9OH1pZihfJiYwPT0oMjQwJl8pKXtmb3IoeT1nLGI9Xyx4PXY7TT1pLmxlbmNvZGVbeCsoKGgmKDE8PHkrYiktMSk+PnkpXSxnPU0+Pj4yNCxfPU0+Pj4xNiYyNTUsdj02NTUzNSZNLCEoeStnPD1sKTspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWg+Pj49eSxsLT15LGkuYmFjays9eX1pZihoPj4+PWcsbC09ZyxpLmJhY2srPWcsaS5sZW5ndGg9diwwPT09Xyl7aS5tb2RlPTI2O2JyZWFrfWlmKDMyJl8pe2kuYmFjaz0tMSxpLm1vZGU9V2I7YnJlYWt9aWYoNjQmXyl7dC5tc2c9XCJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGVcIixpLm1vZGU9WGI7YnJlYWt9aS5leHRyYT0xNSZfLGkubW9kZT0yMjtjYXNlIDIyOmlmKGkuZXh0cmEpe2ZvcihFPWkuZXh0cmE7bDxFOyl7aWYoMD09PWEpYnJlYWsgdDthLS0saCs9bltzKytdPDxsLGwrPTh9aS5sZW5ndGgrPWgmKDE8PGkuZXh0cmEpLTEsaD4+Pj1pLmV4dHJhLGwtPWkuZXh0cmEsaS5iYWNrKz1pLmV4dHJhfWkud2FzPWkubGVuZ3RoLGkubW9kZT0yMztjYXNlIDIzOmZvcig7TT1pLmRpc3Rjb2RlW2gmKDE8PGkuZGlzdGJpdHMpLTFdLGc9TT4+PjI0LF89TT4+PjE2JjI1NSx2PTY1NTM1Jk0sIShnPD1sKTspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWlmKDA9PSgyNDAmXykpe2Zvcih5PWcsYj1fLHg9djtNPWkuZGlzdGNvZGVbeCsoKGgmKDE8PHkrYiktMSk+PnkpXSxnPU0+Pj4yNCxfPU0+Pj4xNiYyNTUsdj02NTUzNSZNLCEoeStnPD1sKTspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWg+Pj49eSxsLT15LGkuYmFjays9eX1pZihoPj4+PWcsbC09ZyxpLmJhY2srPWcsNjQmXyl7dC5tc2c9XCJpbnZhbGlkIGRpc3RhbmNlIGNvZGVcIixpLm1vZGU9WGI7YnJlYWt9aS5vZmZzZXQ9dixpLmV4dHJhPTE1Jl8saS5tb2RlPTI0O2Nhc2UgMjQ6aWYoaS5leHRyYSl7Zm9yKEU9aS5leHRyYTtsPEU7KXtpZigwPT09YSlicmVhayB0O2EtLSxoKz1uW3MrK108PGwsbCs9OH1pLm9mZnNldCs9aCYoMTw8aS5leHRyYSktMSxoPj4+PWkuZXh0cmEsbC09aS5leHRyYSxpLmJhY2srPWkuZXh0cmF9aWYoaS5vZmZzZXQ+aS5kbWF4KXt0Lm1zZz1cImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrXCIsaS5tb2RlPVhiO2JyZWFrfWkubW9kZT0yNTtjYXNlIDI1OmlmKDA9PT1jKWJyZWFrIHQ7aWYocD1kLWMsaS5vZmZzZXQ+cCl7aWYocD1pLm9mZnNldC1wLHA+aS53aGF2ZSYmaS5zYW5lKXt0Lm1zZz1cImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrXCIsaS5tb2RlPVhiO2JyZWFrfXA+aS53bmV4dD8ocC09aS53bmV4dCxmPWkud3NpemUtcCk6Zj1pLnduZXh0LXAscD5pLmxlbmd0aCYmKHA9aS5sZW5ndGgpLG09aS53aW5kb3d9ZWxzZSBtPXIsZj1vLWkub2Zmc2V0LHA9aS5sZW5ndGg7cD5jJiYocD1jKSxjLT1wLGkubGVuZ3RoLT1wO2Rve3JbbysrXT1tW2YrK119d2hpbGUoLS1wKTswPT09aS5sZW5ndGgmJihpLm1vZGU9MjEpO2JyZWFrO2Nhc2UgMjY6aWYoMD09PWMpYnJlYWsgdDtyW28rK109aS5sZW5ndGgsYy0tLGkubW9kZT0yMTticmVhaztjYXNlIDI3OmlmKGkud3JhcCl7Zm9yKDtsPDMyOyl7aWYoMD09PWEpYnJlYWsgdDthLS0saHw9bltzKytdPDxsLGwrPTh9aWYoZC09Yyx0LnRvdGFsX291dCs9ZCxpLnRvdGFsKz1kLGQmJih0LmFkbGVyPWkuY2hlY2s9aS5mbGFncz9keShpLmNoZWNrLHIsZCxvLWQpOmx5KGkuY2hlY2sscixkLG8tZCkpLGQ9YywoaS5mbGFncz9oOlliKGgpKSE9PWkuY2hlY2spe3QubXNnPVwiaW5jb3JyZWN0IGRhdGEgY2hlY2tcIixpLm1vZGU9WGI7YnJlYWt9aD0wLGw9MH1pLm1vZGU9Mjg7Y2FzZSAyODppZihpLndyYXAmJmkuZmxhZ3Mpe2Zvcig7bDwzMjspe2lmKDA9PT1hKWJyZWFrIHQ7YS0tLGgrPW5bcysrXTw8bCxsKz04fWlmKGghPT0oNDI5NDk2NzI5NSZpLnRvdGFsKSl7dC5tc2c9XCJpbmNvcnJlY3QgbGVuZ3RoIGNoZWNrXCIsaS5tb2RlPVhiO2JyZWFrfWg9MCxsPTB9aS5tb2RlPTI5O2Nhc2UgMjk6Uz1CYjticmVhayB0O2Nhc2UgWGI6Uz1VYjticmVhayB0O2Nhc2UgMzE6cmV0dXJuIFZiO2Nhc2UgMzI6ZGVmYXVsdDpyZXR1cm4gSGJ9cmV0dXJuIHQubmV4dF9vdXQ9byx0LmF2YWlsX291dD1jLHQubmV4dF9pbj1zLHQuYXZhaWxfaW49YSxpLmhvbGQ9aCxpLmJpdHM9bCwoaS53c2l6ZXx8ZCE9PXQuYXZhaWxfb3V0JiZpLm1vZGU8WGImJihpLm1vZGU8Mjd8fGUhPT0kYikpJiZzeCh0LHQub3V0cHV0LHQubmV4dF9vdXQsZC10LmF2YWlsX291dCksdS09dC5hdmFpbF9pbixkLT10LmF2YWlsX291dCx0LnRvdGFsX2luKz11LHQudG90YWxfb3V0Kz1kLGkudG90YWwrPWQsaS53cmFwJiZkJiYodC5hZGxlcj1pLmNoZWNrPWkuZmxhZ3M/ZHkoaS5jaGVjayxyLGQsdC5uZXh0X291dC1kKTpseShpLmNoZWNrLHIsZCx0Lm5leHRfb3V0LWQpKSx0LmRhdGFfdHlwZT1pLmJpdHMrKGkubGFzdD82NDowKSsoaS5tb2RlPT09V2I/MTI4OjApKygyMD09PWkubW9kZXx8MTU9PT1pLm1vZGU/MjU2OjApLCgwPT09dSYmMD09PWR8fGU9PT0kYikmJlM9PT1GYiYmKFM9R2IpLFN9LGluZmxhdGVFbmQ6dD0+e2lmKCF0fHwhdC5zdGF0ZSlyZXR1cm4gSGI7bGV0IGU9dC5zdGF0ZTtyZXR1cm4gZS53aW5kb3cmJihlLndpbmRvdz1udWxsKSx0LnN0YXRlPW51bGwsRmJ9LGluZmxhdGVHZXRIZWFkZXI6KHQsZSk9PntpZighdHx8IXQuc3RhdGUpcmV0dXJuIEhiO2NvbnN0IGk9dC5zdGF0ZTtyZXR1cm4gMD09KDImaS53cmFwKT9IYjooaS5oZWFkPWUsZS5kb25lPSExLEZiKX0saW5mbGF0ZVNldERpY3Rpb25hcnk6KHQsZSk9Pntjb25zdCBpPWUubGVuZ3RoO2xldCBuLHIscztyZXR1cm4gdCYmdC5zdGF0ZT8obj10LnN0YXRlLDAhPT1uLndyYXAmJjExIT09bi5tb2RlP0hiOjExPT09bi5tb2RlJiYocj0xLHI9bHkocixlLGksMCksciE9PW4uY2hlY2spP1ViOihzPXN4KHQsZSxpLGkpLHM/KG4ubW9kZT0zMSxWYik6KG4uaGF2ZWRpY3Q9MSxGYikpKTpIYn0saW5mbGF0ZUluZm86XCJwYWtvIGluZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpXCJ9O3ZhciBheD1mdW5jdGlvbigpe3RoaXMudGV4dD0wLHRoaXMudGltZT0wLHRoaXMueGZsYWdzPTAsdGhpcy5vcz0wLHRoaXMuZXh0cmE9bnVsbCx0aGlzLmV4dHJhX2xlbj0wLHRoaXMubmFtZT1cIlwiLHRoaXMuY29tbWVudD1cIlwiLHRoaXMuaGNyYz0wLHRoaXMuZG9uZT0hMX07Y29uc3QgY3g9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyx7Wl9OT19GTFVTSDpoeCxaX0ZJTklTSDpseCxaX09LOnV4LFpfU1RSRUFNX0VORDpkeCxaX05FRURfRElDVDpweCxaX1NUUkVBTV9FUlJPUjpmeCxaX0RBVEFfRVJST1I6bXgsWl9NRU1fRVJST1I6Z3h9PWZ5O2Z1bmN0aW9uIF94KHQpe3RoaXMub3B0aW9ucz1sYih7Y2h1bmtTaXplOjY1NTM2LHdpbmRvd0JpdHM6MTUsdG86XCJcIn0sdHx8e30pO2NvbnN0IGU9dGhpcy5vcHRpb25zO2UucmF3JiZlLndpbmRvd0JpdHM+PTAmJmUud2luZG93Qml0czwxNiYmKGUud2luZG93Qml0cz0tZS53aW5kb3dCaXRzLDA9PT1lLndpbmRvd0JpdHMmJihlLndpbmRvd0JpdHM9LTE1KSksIShlLndpbmRvd0JpdHM+PTAmJmUud2luZG93Qml0czwxNil8fHQmJnQud2luZG93Qml0c3x8KGUud2luZG93Qml0cys9MzIpLGUud2luZG93Qml0cz4xNSYmZS53aW5kb3dCaXRzPDQ4JiYwPT0oMTUmZS53aW5kb3dCaXRzKSYmKGUud2luZG93Qml0c3w9MTUpLHRoaXMuZXJyPTAsdGhpcy5tc2c9XCJcIix0aGlzLmVuZGVkPSExLHRoaXMuY2h1bmtzPVtdLHRoaXMuc3RybT1uZXcgX2IsdGhpcy5zdHJtLmF2YWlsX291dD0wO2xldCBpPW94LmluZmxhdGVJbml0Mih0aGlzLnN0cm0sZS53aW5kb3dCaXRzKTtpZihpIT09dXgpdGhyb3cgbmV3IEVycm9yKHB5W2ldKTtpZih0aGlzLmhlYWRlcj1uZXcgYXgsb3guaW5mbGF0ZUdldEhlYWRlcih0aGlzLnN0cm0sdGhpcy5oZWFkZXIpLGUuZGljdGlvbmFyeSYmKFwic3RyaW5nXCI9PXR5cGVvZiBlLmRpY3Rpb25hcnk/ZS5kaWN0aW9uYXJ5PWZiKGUuZGljdGlvbmFyeSk6XCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiPT09Y3guY2FsbChlLmRpY3Rpb25hcnkpJiYoZS5kaWN0aW9uYXJ5PW5ldyBVaW50OEFycmF5KGUuZGljdGlvbmFyeSkpLGUucmF3JiYoaT1veC5pbmZsYXRlU2V0RGljdGlvbmFyeSh0aGlzLnN0cm0sZS5kaWN0aW9uYXJ5KSxpIT09dXgpKSl0aHJvdyBuZXcgRXJyb3IocHlbaV0pfWZ1bmN0aW9uIHZ4KHQsZSl7Y29uc3QgaT1uZXcgX3goZSk7aWYoaS5wdXNoKHQpLGkuZXJyKXRocm93IGkubXNnfHxweVtpLmVycl07cmV0dXJuIGkucmVzdWx0fV94LnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKHQsZSl7Y29uc3QgaT10aGlzLnN0cm0sbj10aGlzLm9wdGlvbnMuY2h1bmtTaXplLHI9dGhpcy5vcHRpb25zLmRpY3Rpb25hcnk7bGV0IHMsbyxhO2lmKHRoaXMuZW5kZWQpcmV0dXJuITE7Zm9yKG89ZT09PX5+ZT9lOiEwPT09ZT9seDpoeCxcIltvYmplY3QgQXJyYXlCdWZmZXJdXCI9PT1jeC5jYWxsKHQpP2kuaW5wdXQ9bmV3IFVpbnQ4QXJyYXkodCk6aS5pbnB1dD10LGkubmV4dF9pbj0wLGkuYXZhaWxfaW49aS5pbnB1dC5sZW5ndGg7Oyl7Zm9yKDA9PT1pLmF2YWlsX291dCYmKGkub3V0cHV0PW5ldyBVaW50OEFycmF5KG4pLGkubmV4dF9vdXQ9MCxpLmF2YWlsX291dD1uKSxzPW94LmluZmxhdGUoaSxvKSxzPT09cHgmJnImJihzPW94LmluZmxhdGVTZXREaWN0aW9uYXJ5KGkscikscz09PXV4P3M9b3guaW5mbGF0ZShpLG8pOnM9PT1teCYmKHM9cHgpKTtpLmF2YWlsX2luPjAmJnM9PT1keCYmaS5zdGF0ZS53cmFwPjAmJjAhPT10W2kubmV4dF9pbl07KW94LmluZmxhdGVSZXNldChpKSxzPW94LmluZmxhdGUoaSxvKTtzd2l0Y2gocyl7Y2FzZSBmeDpjYXNlIG14OmNhc2UgcHg6Y2FzZSBneDpyZXR1cm4gdGhpcy5vbkVuZChzKSx0aGlzLmVuZGVkPSEwLCExfWlmKGE9aS5hdmFpbF9vdXQsaS5uZXh0X291dCYmKDA9PT1pLmF2YWlsX291dHx8cz09PWR4KSlpZihcInN0cmluZ1wiPT09dGhpcy5vcHRpb25zLnRvKXtsZXQgdD1nYihpLm91dHB1dCxpLm5leHRfb3V0KSxlPWkubmV4dF9vdXQtdCxyPW1iKGkub3V0cHV0LHQpO2kubmV4dF9vdXQ9ZSxpLmF2YWlsX291dD1uLWUsZSYmaS5vdXRwdXQuc2V0KGkub3V0cHV0LnN1YmFycmF5KHQsdCtlKSwwKSx0aGlzLm9uRGF0YShyKX1lbHNlIHRoaXMub25EYXRhKGkub3V0cHV0Lmxlbmd0aD09PWkubmV4dF9vdXQ/aS5vdXRwdXQ6aS5vdXRwdXQuc3ViYXJyYXkoMCxpLm5leHRfb3V0KSk7aWYocyE9PXV4fHwwIT09YSl7aWYocz09PWR4KXJldHVybiBzPW94LmluZmxhdGVFbmQodGhpcy5zdHJtKSx0aGlzLm9uRW5kKHMpLHRoaXMuZW5kZWQ9ITAsITA7aWYoMD09PWkuYXZhaWxfaW4pYnJlYWt9fXJldHVybiEwfSxfeC5wcm90b3R5cGUub25EYXRhPWZ1bmN0aW9uKHQpe3RoaXMuY2h1bmtzLnB1c2godCl9LF94LnByb3RvdHlwZS5vbkVuZD1mdW5jdGlvbih0KXt0PT09dXgmJihcInN0cmluZ1wiPT09dGhpcy5vcHRpb25zLnRvP3RoaXMucmVzdWx0PXRoaXMuY2h1bmtzLmpvaW4oXCJcIik6dGhpcy5yZXN1bHQ9dWIodGhpcy5jaHVua3MpKSx0aGlzLmNodW5rcz1bXSx0aGlzLmVycj10LHRoaXMubXNnPXRoaXMuc3RybS5tc2d9O3ZhciB5eD17SW5mbGF0ZTpfeCxpbmZsYXRlOnZ4LGluZmxhdGVSYXc6ZnVuY3Rpb24odCxlKXtyZXR1cm4oZT1lfHx7fSkucmF3PSEwLHZ4KHQsZSl9LHVuZ3ppcDp2eCxjb25zdGFudHM6Znl9O2NvbnN0e0luZmxhdGU6YngsaW5mbGF0ZTp4eCxpbmZsYXRlUmF3Ond4LHVuZ3ppcDpTeH09eXg7dmFyIE14PXh4LFR4PWZ1bmN0aW9uKHQsZSxpLG4scil7dmFyIHMsbyxhPTgqci1uLTEsYz0oMTw8YSktMSxoPWM+PjEsbD0tNyx1PWk/ci0xOjAsZD1pPy0xOjEscD10W2UrdV07Zm9yKHUrPWQscz1wJigxPDwtbCktMSxwPj49LWwsbCs9YTtsPjA7cz0yNTYqcyt0W2UrdV0sdSs9ZCxsLT04KTtmb3Iobz1zJigxPDwtbCktMSxzPj49LWwsbCs9bjtsPjA7bz0yNTYqbyt0W2UrdV0sdSs9ZCxsLT04KTtpZigwPT09cylzPTEtaDtlbHNle2lmKHM9PT1jKXJldHVybiBvP05hTjoxLzAqKHA/LTE6MSk7bys9TWF0aC5wb3coMixuKSxzLT1ofXJldHVybihwPy0xOjEpKm8qTWF0aC5wb3coMixzLW4pfSxDeD1mdW5jdGlvbih0LGUsaSxuLHIscyl7dmFyIG8sYSxjLGg9OCpzLXItMSxsPSgxPDxoKS0xLHU9bD4+MSxkPTIzPT09cj9NYXRoLnBvdygyLC0yNCktTWF0aC5wb3coMiwtNzcpOjAscD1uPzA6cy0xLGY9bj8xOi0xLG09ZTwwfHwwPT09ZSYmMS9lPDA/MTowO2ZvcihlPU1hdGguYWJzKGUpLGlzTmFOKGUpfHxlPT09MS8wPyhhPWlzTmFOKGUpPzE6MCxvPWwpOihvPU1hdGguZmxvb3IoTWF0aC5sb2coZSkvTWF0aC5MTjIpLGUqKGM9TWF0aC5wb3coMiwtbykpPDEmJihvLS0sYyo9MiksKGUrPW8rdT49MT9kL2M6ZCpNYXRoLnBvdygyLDEtdSkpKmM+PTImJihvKyssYy89Miksbyt1Pj1sPyhhPTAsbz1sKTpvK3U+PTE/KGE9KGUqYy0xKSpNYXRoLnBvdygyLHIpLG8rPXUpOihhPWUqTWF0aC5wb3coMix1LTEpKk1hdGgucG93KDIsciksbz0wKSk7cj49ODt0W2krcF09MjU1JmEscCs9ZixhLz0yNTYsci09OCk7Zm9yKG89bzw8cnxhLGgrPXI7aD4wO3RbaStwXT0yNTUmbyxwKz1mLG8vPTI1NixoLT04KTt0W2krcC1mXXw9MTI4Km19LEV4PUl4O1xuLyohIGllZWU3NTQuIEJTRC0zLUNsYXVzZSBMaWNlbnNlLiBGZXJvc3MgQWJvdWtoYWRpamVoIDxodHRwczovL2Zlcm9zcy5vcmcvb3BlbnNvdXJjZT4gKi9mdW5jdGlvbiBJeCh0KXt0aGlzLmJ1Zj1BcnJheUJ1ZmZlci5pc1ZpZXcmJkFycmF5QnVmZmVyLmlzVmlldyh0KT90Om5ldyBVaW50OEFycmF5KHR8fDApLHRoaXMucG9zPTAsdGhpcy50eXBlPTAsdGhpcy5sZW5ndGg9dGhpcy5idWYubGVuZ3RofUl4LlZhcmludD0wLEl4LkZpeGVkNjQ9MSxJeC5CeXRlcz0yLEl4LkZpeGVkMzI9NTt2YXIgQXg9NDI5NDk2NzI5NixQeD0xL0F4LFJ4PVwidW5kZWZpbmVkXCI9PXR5cGVvZiBUZXh0RGVjb2Rlcj9udWxsOm5ldyBUZXh0RGVjb2RlcihcInV0ZjhcIik7ZnVuY3Rpb24gTHgodCl7cmV0dXJuIHQudHlwZT09PUl4LkJ5dGVzP3QucmVhZFZhcmludCgpK3QucG9zOnQucG9zKzF9ZnVuY3Rpb24gT3godCxlLGkpe3JldHVybiBpPzQyOTQ5NjcyOTYqZSsodD4+PjApOjQyOTQ5NjcyOTYqKGU+Pj4wKSsodD4+PjApfWZ1bmN0aW9uIE54KHQsZSxpKXt2YXIgbj1lPD0xNjM4Mz8xOmU8PTIwOTcxNTE/MjplPD0yNjg0MzU0NTU/MzpNYXRoLmZsb29yKE1hdGgubG9nKGUpLyg3Kk1hdGguTE4yKSk7aS5yZWFsbG9jKG4pO2Zvcih2YXIgcj1pLnBvcy0xO3I+PXQ7ci0tKWkuYnVmW3Irbl09aS5idWZbcl19ZnVuY3Rpb24gRHgodCxlKXtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyllLndyaXRlVmFyaW50KHRbaV0pfWZ1bmN0aW9uICR4KHQsZSl7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspZS53cml0ZVNWYXJpbnQodFtpXSl9ZnVuY3Rpb24ga3godCxlKXtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyllLndyaXRlRmxvYXQodFtpXSl9ZnVuY3Rpb24gengodCxlKXtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyllLndyaXRlRG91YmxlKHRbaV0pfWZ1bmN0aW9uIEZ4KHQsZSl7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspZS53cml0ZUJvb2xlYW4odFtpXSl9ZnVuY3Rpb24gQngodCxlKXtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyllLndyaXRlRml4ZWQzMih0W2ldKX1mdW5jdGlvbiBqeCh0LGUpe2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKWUud3JpdGVTRml4ZWQzMih0W2ldKX1mdW5jdGlvbiBIeCh0LGUpe2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKWUud3JpdGVGaXhlZDY0KHRbaV0pfWZ1bmN0aW9uIFV4KHQsZSl7Zm9yKHZhciBpPTA7aTx0Lmxlbmd0aDtpKyspZS53cml0ZVNGaXhlZDY0KHRbaV0pfWZ1bmN0aW9uIFZ4KHQsZSl7cmV0dXJuKHRbZV18dFtlKzFdPDw4fHRbZSsyXTw8MTYpKzE2Nzc3MjE2KnRbZSszXX1mdW5jdGlvbiBHeCh0LGUsaSl7dFtpXT1lLHRbaSsxXT1lPj4+OCx0W2krMl09ZT4+PjE2LHRbaSszXT1lPj4+MjR9ZnVuY3Rpb24gcXgodCxlKXtyZXR1cm4odFtlXXx0W2UrMV08PDh8dFtlKzJdPDwxNikrKHRbZSszXTw8MjQpfWZ1bmN0aW9uIFd4KHQpe2NvbnN0IGU9TXgodCx7dG86XCJzdHJpbmdcIn0pO3JldHVybiBKU09OLnBhcnNlKGUpfWZ1bmN0aW9uIFh4KHQsZSl7cmV0dXJuIFl4KHQsXCJHRVRcIixcImFycmF5YnVmZmVyXCIsW10sbnVsbCxlKX1mdW5jdGlvbiBZeCh0LGUsaSxuLHIscyl7Y29uc3Qgbz1uZXcgWE1MSHR0cFJlcXVlc3QsYT1uZXcgUHJvbWlzZSgoKHMsYSk9PntvLm9wZW4oZSx0LCEwKTtmb3IoY29uc3QgdCBvZiBuKW8uc2V0UmVxdWVzdEhlYWRlcih0Lm5hbWUsdC52YWx1ZSk7by5yZXNwb25zZVR5cGU9aSxvLnRpbWVvdXQ9MTVlMyxvLm9ubG9hZD0oKT0+e3ZhciBlO2lmKDIwMCE9PW8uc3RhdHVzKXtjb25zdCBpPW51bGwhPT0oZT1vLnJlc3BvbnNlKSYmdm9pZCAwIT09ZT9lOm5ldyBjZChgUmVzcG9uc2Ugc3RhdHVzIGVycm9yOiAke3R9YCk7YShpKX1vLnJlc3BvbnNlfHxhKG5ldyBjZChgUmVzcG9uc2UgZW1wdHk6ICR7dH1gKSkscyhvLnJlc3BvbnNlKX0sby5vbmVycm9yPSgpPT57YShuZXcgY2QoYFJlcXVlc3QgZXJyb3I6ICR7dH1gKSl9LG8ub250aW1lb3V0PSgpPT57YShuZXcgY2QoYFJlcXVlc3QgdGltZW91dDogJHt0fWApKX0sby5vbmFib3J0PSgpPT57YShuZXcgY2QoYFJlcXVlc3QgYWJvcnRlZDogJHt0fWApKX0sby5zZW5kKFwiUE9TVFwiPT09ZT9yOm51bGwpfSkpO3JldHVybiBzJiZzLmNhdGNoKCgoKT0+e28uYWJvcnQoKX0pKSxhfWZ1bmN0aW9uIFp4KHQpe3JldHVybiBuZXcgRXgodCkucmVhZEZpZWxkcyhKeCx7ZmFjZXM6W10sdmVydGljZXM6W119KX1mdW5jdGlvbiBKeCh0LGUsaSl7MT09PXQ/ZS52ZXJ0aWNlcy5wdXNoKGkucmVhZEZsb2F0KCkpOjI9PT10P2UuZmFjZXMucHVzaChpLnJlYWRWYXJpbnQoKSk6Y29uc29sZS53YXJuKGBVbnN1cHBvcnRlZCBwYmYgdGFnICgke3R9KWApfUl4LnByb3RvdHlwZT17ZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuYnVmPW51bGx9LHJlYWRGaWVsZHM6ZnVuY3Rpb24odCxlLGkpe2ZvcihpPWl8fHRoaXMubGVuZ3RoO3RoaXMucG9zPGk7KXt2YXIgbj10aGlzLnJlYWRWYXJpbnQoKSxyPW4+PjMscz10aGlzLnBvczt0aGlzLnR5cGU9NyZuLHQocixlLHRoaXMpLHRoaXMucG9zPT09cyYmdGhpcy5za2lwKG4pfXJldHVybiBlfSxyZWFkTWVzc2FnZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLnJlYWRGaWVsZHModCxlLHRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zKX0scmVhZEZpeGVkMzI6ZnVuY3Rpb24oKXt2YXIgdD1WeCh0aGlzLmJ1Zix0aGlzLnBvcyk7cmV0dXJuIHRoaXMucG9zKz00LHR9LHJlYWRTRml4ZWQzMjpmdW5jdGlvbigpe3ZhciB0PXF4KHRoaXMuYnVmLHRoaXMucG9zKTtyZXR1cm4gdGhpcy5wb3MrPTQsdH0scmVhZEZpeGVkNjQ6ZnVuY3Rpb24oKXt2YXIgdD1WeCh0aGlzLmJ1Zix0aGlzLnBvcykrVngodGhpcy5idWYsdGhpcy5wb3MrNCkqQXg7cmV0dXJuIHRoaXMucG9zKz04LHR9LHJlYWRTRml4ZWQ2NDpmdW5jdGlvbigpe3ZhciB0PVZ4KHRoaXMuYnVmLHRoaXMucG9zKStxeCh0aGlzLmJ1Zix0aGlzLnBvcys0KSpBeDtyZXR1cm4gdGhpcy5wb3MrPTgsdH0scmVhZEZsb2F0OmZ1bmN0aW9uKCl7dmFyIHQ9VHgodGhpcy5idWYsdGhpcy5wb3MsITAsMjMsNCk7cmV0dXJuIHRoaXMucG9zKz00LHR9LHJlYWREb3VibGU6ZnVuY3Rpb24oKXt2YXIgdD1UeCh0aGlzLmJ1Zix0aGlzLnBvcywhMCw1Miw4KTtyZXR1cm4gdGhpcy5wb3MrPTgsdH0scmVhZFZhcmludDpmdW5jdGlvbih0KXt2YXIgZSxpLG49dGhpcy5idWY7cmV0dXJuIGU9MTI3JihpPW5bdGhpcy5wb3MrK10pLGk8MTI4P2U6KGV8PSgxMjcmKGk9blt0aGlzLnBvcysrXSkpPDw3LGk8MTI4P2U6KGV8PSgxMjcmKGk9blt0aGlzLnBvcysrXSkpPDwxNCxpPDEyOD9lOihlfD0oMTI3JihpPW5bdGhpcy5wb3MrK10pKTw8MjEsaTwxMjg/ZTpmdW5jdGlvbih0LGUsaSl7dmFyIG4scixzPWkuYnVmO2lmKHI9c1tpLnBvcysrXSxuPSgxMTImcik+PjQscjwxMjgpcmV0dXJuIE94KHQsbixlKTtpZihyPXNbaS5wb3MrK10sbnw9KDEyNyZyKTw8MyxyPDEyOClyZXR1cm4gT3godCxuLGUpO2lmKHI9c1tpLnBvcysrXSxufD0oMTI3JnIpPDwxMCxyPDEyOClyZXR1cm4gT3godCxuLGUpO2lmKHI9c1tpLnBvcysrXSxufD0oMTI3JnIpPDwxNyxyPDEyOClyZXR1cm4gT3godCxuLGUpO2lmKHI9c1tpLnBvcysrXSxufD0oMTI3JnIpPDwyNCxyPDEyOClyZXR1cm4gT3godCxuLGUpO2lmKHI9c1tpLnBvcysrXSxufD0oMSZyKTw8MzEscjwxMjgpcmV0dXJuIE94KHQsbixlKTt0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCB2YXJpbnQgbm90IG1vcmUgdGhhbiAxMCBieXRlc1wiKX0oZXw9KDE1JihpPW5bdGhpcy5wb3NdKSk8PDI4LHQsdGhpcykpKSl9LHJlYWRWYXJpbnQ2NDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRWYXJpbnQoITApfSxyZWFkU1ZhcmludDpmdW5jdGlvbigpe3ZhciB0PXRoaXMucmVhZFZhcmludCgpO3JldHVybiB0JTI9PTE/KHQrMSkvLTI6dC8yfSxyZWFkQm9vbGVhbjpmdW5jdGlvbigpe3JldHVybiBCb29sZWFuKHRoaXMucmVhZFZhcmludCgpKX0scmVhZFN0cmluZzpmdW5jdGlvbigpe3ZhciB0PXRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zLGU9dGhpcy5wb3M7cmV0dXJuIHRoaXMucG9zPXQsdC1lPj0xMiYmUng/ZnVuY3Rpb24odCxlLGkpe3JldHVybiBSeC5kZWNvZGUodC5zdWJhcnJheShlLGkpKX0odGhpcy5idWYsZSx0KTpmdW5jdGlvbih0LGUsaSl7dmFyIG49XCJcIixyPWU7Zm9yKDtyPGk7KXt2YXIgcyxvLGEsYz10W3JdLGg9bnVsbCxsPWM+MjM5PzQ6Yz4yMjM/MzpjPjE5MT8yOjE7aWYocitsPmkpYnJlYWs7MT09PWw/YzwxMjgmJihoPWMpOjI9PT1sPzEyOD09KDE5MiYocz10W3IrMV0pKSYmKGg9KDMxJmMpPDw2fDYzJnMpPD0xMjcmJihoPW51bGwpOjM9PT1sPyhzPXRbcisxXSxvPXRbcisyXSwxMjg9PSgxOTImcykmJjEyOD09KDE5MiZvKSYmKChoPSgxNSZjKTw8MTJ8KDYzJnMpPDw2fDYzJm8pPD0yMDQ3fHxoPj01NTI5NiYmaDw9NTczNDMpJiYoaD1udWxsKSk6ND09PWwmJihzPXRbcisxXSxvPXRbcisyXSxhPXRbciszXSwxMjg9PSgxOTImcykmJjEyOD09KDE5MiZvKSYmMTI4PT0oMTkyJmEpJiYoKGg9KDE1JmMpPDwxOHwoNjMmcyk8PDEyfCg2MyZvKTw8Nnw2MyZhKTw9NjU1MzV8fGg+PTExMTQxMTIpJiYoaD1udWxsKSksbnVsbD09PWg/KGg9NjU1MzMsbD0xKTpoPjY1NTM1JiYoaC09NjU1MzYsbis9U3RyaW5nLmZyb21DaGFyQ29kZShoPj4+MTAmMTAyM3w1NTI5NiksaD01NjMyMHwxMDIzJmgpLG4rPVN0cmluZy5mcm9tQ2hhckNvZGUoaCkscis9bH1yZXR1cm4gbn0odGhpcy5idWYsZSx0KX0scmVhZEJ5dGVzOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5yZWFkVmFyaW50KCkrdGhpcy5wb3MsZT10aGlzLmJ1Zi5zdWJhcnJheSh0aGlzLnBvcyx0KTtyZXR1cm4gdGhpcy5wb3M9dCxlfSxyZWFkUGFja2VkVmFyaW50OmZ1bmN0aW9uKHQsZSl7aWYodGhpcy50eXBlIT09SXguQnl0ZXMpcmV0dXJuIHQucHVzaCh0aGlzLnJlYWRWYXJpbnQoZSkpO3ZhciBpPUx4KHRoaXMpO2Zvcih0PXR8fFtdO3RoaXMucG9zPGk7KXQucHVzaCh0aGlzLnJlYWRWYXJpbnQoZSkpO3JldHVybiB0fSxyZWFkUGFja2VkU1ZhcmludDpmdW5jdGlvbih0KXtpZih0aGlzLnR5cGUhPT1JeC5CeXRlcylyZXR1cm4gdC5wdXNoKHRoaXMucmVhZFNWYXJpbnQoKSk7dmFyIGU9THgodGhpcyk7Zm9yKHQ9dHx8W107dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZFNWYXJpbnQoKSk7cmV0dXJuIHR9LHJlYWRQYWNrZWRCb29sZWFuOmZ1bmN0aW9uKHQpe2lmKHRoaXMudHlwZSE9PUl4LkJ5dGVzKXJldHVybiB0LnB1c2godGhpcy5yZWFkQm9vbGVhbigpKTt2YXIgZT1MeCh0aGlzKTtmb3IodD10fHxbXTt0aGlzLnBvczxlOyl0LnB1c2godGhpcy5yZWFkQm9vbGVhbigpKTtyZXR1cm4gdH0scmVhZFBhY2tlZEZsb2F0OmZ1bmN0aW9uKHQpe2lmKHRoaXMudHlwZSE9PUl4LkJ5dGVzKXJldHVybiB0LnB1c2godGhpcy5yZWFkRmxvYXQoKSk7dmFyIGU9THgodGhpcyk7Zm9yKHQ9dHx8W107dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZEZsb2F0KCkpO3JldHVybiB0fSxyZWFkUGFja2VkRG91YmxlOmZ1bmN0aW9uKHQpe2lmKHRoaXMudHlwZSE9PUl4LkJ5dGVzKXJldHVybiB0LnB1c2godGhpcy5yZWFkRG91YmxlKCkpO3ZhciBlPUx4KHRoaXMpO2Zvcih0PXR8fFtdO3RoaXMucG9zPGU7KXQucHVzaCh0aGlzLnJlYWREb3VibGUoKSk7cmV0dXJuIHR9LHJlYWRQYWNrZWRGaXhlZDMyOmZ1bmN0aW9uKHQpe2lmKHRoaXMudHlwZSE9PUl4LkJ5dGVzKXJldHVybiB0LnB1c2godGhpcy5yZWFkRml4ZWQzMigpKTt2YXIgZT1MeCh0aGlzKTtmb3IodD10fHxbXTt0aGlzLnBvczxlOyl0LnB1c2godGhpcy5yZWFkRml4ZWQzMigpKTtyZXR1cm4gdH0scmVhZFBhY2tlZFNGaXhlZDMyOmZ1bmN0aW9uKHQpe2lmKHRoaXMudHlwZSE9PUl4LkJ5dGVzKXJldHVybiB0LnB1c2godGhpcy5yZWFkU0ZpeGVkMzIoKSk7dmFyIGU9THgodGhpcyk7Zm9yKHQ9dHx8W107dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZFNGaXhlZDMyKCkpO3JldHVybiB0fSxyZWFkUGFja2VkRml4ZWQ2NDpmdW5jdGlvbih0KXtpZih0aGlzLnR5cGUhPT1JeC5CeXRlcylyZXR1cm4gdC5wdXNoKHRoaXMucmVhZEZpeGVkNjQoKSk7dmFyIGU9THgodGhpcyk7Zm9yKHQ9dHx8W107dGhpcy5wb3M8ZTspdC5wdXNoKHRoaXMucmVhZEZpeGVkNjQoKSk7cmV0dXJuIHR9LHJlYWRQYWNrZWRTRml4ZWQ2NDpmdW5jdGlvbih0KXtpZih0aGlzLnR5cGUhPT1JeC5CeXRlcylyZXR1cm4gdC5wdXNoKHRoaXMucmVhZFNGaXhlZDY0KCkpO3ZhciBlPUx4KHRoaXMpO2Zvcih0PXR8fFtdO3RoaXMucG9zPGU7KXQucHVzaCh0aGlzLnJlYWRTRml4ZWQ2NCgpKTtyZXR1cm4gdH0sc2tpcDpmdW5jdGlvbih0KXt2YXIgZT03JnQ7aWYoZT09PUl4LlZhcmludClmb3IoO3RoaXMuYnVmW3RoaXMucG9zKytdPjEyNzspO2Vsc2UgaWYoZT09PUl4LkJ5dGVzKXRoaXMucG9zPXRoaXMucmVhZFZhcmludCgpK3RoaXMucG9zO2Vsc2UgaWYoZT09PUl4LkZpeGVkMzIpdGhpcy5wb3MrPTQ7ZWxzZXtpZihlIT09SXguRml4ZWQ2NCl0aHJvdyBuZXcgRXJyb3IoXCJVbmltcGxlbWVudGVkIHR5cGU6IFwiK2UpO3RoaXMucG9zKz04fX0sd3JpdGVUYWc6ZnVuY3Rpb24odCxlKXt0aGlzLndyaXRlVmFyaW50KHQ8PDN8ZSl9LHJlYWxsb2M6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXRoaXMubGVuZ3RofHwxNjtlPHRoaXMucG9zK3Q7KWUqPTI7aWYoZSE9PXRoaXMubGVuZ3RoKXt2YXIgaT1uZXcgVWludDhBcnJheShlKTtpLnNldCh0aGlzLmJ1ZiksdGhpcy5idWY9aSx0aGlzLmxlbmd0aD1lfX0sZmluaXNoOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RoPXRoaXMucG9zLHRoaXMucG9zPTAsdGhpcy5idWYuc3ViYXJyYXkoMCx0aGlzLmxlbmd0aCl9LHdyaXRlRml4ZWQzMjpmdW5jdGlvbih0KXt0aGlzLnJlYWxsb2MoNCksR3godGhpcy5idWYsdCx0aGlzLnBvcyksdGhpcy5wb3MrPTR9LHdyaXRlU0ZpeGVkMzI6ZnVuY3Rpb24odCl7dGhpcy5yZWFsbG9jKDQpLEd4KHRoaXMuYnVmLHQsdGhpcy5wb3MpLHRoaXMucG9zKz00fSx3cml0ZUZpeGVkNjQ6ZnVuY3Rpb24odCl7dGhpcy5yZWFsbG9jKDgpLEd4KHRoaXMuYnVmLC0xJnQsdGhpcy5wb3MpLEd4KHRoaXMuYnVmLE1hdGguZmxvb3IodCpQeCksdGhpcy5wb3MrNCksdGhpcy5wb3MrPTh9LHdyaXRlU0ZpeGVkNjQ6ZnVuY3Rpb24odCl7dGhpcy5yZWFsbG9jKDgpLEd4KHRoaXMuYnVmLC0xJnQsdGhpcy5wb3MpLEd4KHRoaXMuYnVmLE1hdGguZmxvb3IodCpQeCksdGhpcy5wb3MrNCksdGhpcy5wb3MrPTh9LHdyaXRlVmFyaW50OmZ1bmN0aW9uKHQpeyh0PSt0fHwwKT4yNjg0MzU0NTV8fHQ8MD9mdW5jdGlvbih0LGUpe3ZhciBpLG47dD49MD8oaT10JTQyOTQ5NjcyOTZ8MCxuPXQvNDI5NDk2NzI5NnwwKToobj1+KC10LzQyOTQ5NjcyOTYpLDQyOTQ5NjcyOTVeKGk9figtdCU0Mjk0OTY3Mjk2KSk/aT1pKzF8MDooaT0wLG49bisxfDApKTtpZih0Pj0weDEwMDAwMDAwMDAwMDAwMDAwfHx0PC0weDEwMDAwMDAwMDAwMDAwMDAwKXRocm93IG5ldyBFcnJvcihcIkdpdmVuIHZhcmludCBkb2Vzbid0IGZpdCBpbnRvIDEwIGJ5dGVzXCIpO2UucmVhbGxvYygxMCksZnVuY3Rpb24odCxlLGkpe2kuYnVmW2kucG9zKytdPTEyNyZ0fDEyOCx0Pj4+PTcsaS5idWZbaS5wb3MrK109MTI3JnR8MTI4LHQ+Pj49NyxpLmJ1ZltpLnBvcysrXT0xMjcmdHwxMjgsdD4+Pj03LGkuYnVmW2kucG9zKytdPTEyNyZ0fDEyOCx0Pj4+PTcsaS5idWZbaS5wb3NdPTEyNyZ0fShpLDAsZSksZnVuY3Rpb24odCxlKXt2YXIgaT0oNyZ0KTw8NDtpZihlLmJ1ZltlLnBvcysrXXw9aXwoKHQ+Pj49Myk/MTI4OjApLCF0KXJldHVybjtpZihlLmJ1ZltlLnBvcysrXT0xMjcmdHwoKHQ+Pj49Nyk/MTI4OjApLCF0KXJldHVybjtpZihlLmJ1ZltlLnBvcysrXT0xMjcmdHwoKHQ+Pj49Nyk/MTI4OjApLCF0KXJldHVybjtpZihlLmJ1ZltlLnBvcysrXT0xMjcmdHwoKHQ+Pj49Nyk/MTI4OjApLCF0KXJldHVybjtpZihlLmJ1ZltlLnBvcysrXT0xMjcmdHwoKHQ+Pj49Nyk/MTI4OjApLCF0KXJldHVybjtlLmJ1ZltlLnBvcysrXT0xMjcmdH0obixlKX0odCx0aGlzKToodGhpcy5yZWFsbG9jKDQpLHRoaXMuYnVmW3RoaXMucG9zKytdPTEyNyZ0fCh0PjEyNz8xMjg6MCksdDw9MTI3fHwodGhpcy5idWZbdGhpcy5wb3MrK109MTI3Jih0Pj4+PTcpfCh0PjEyNz8xMjg6MCksdDw9MTI3fHwodGhpcy5idWZbdGhpcy5wb3MrK109MTI3Jih0Pj4+PTcpfCh0PjEyNz8xMjg6MCksdDw9MTI3fHwodGhpcy5idWZbdGhpcy5wb3MrK109dD4+PjcmMTI3KSkpKX0sd3JpdGVTVmFyaW50OmZ1bmN0aW9uKHQpe3RoaXMud3JpdGVWYXJpbnQodDwwPzIqLXQtMToyKnQpfSx3cml0ZUJvb2xlYW46ZnVuY3Rpb24odCl7dGhpcy53cml0ZVZhcmludChCb29sZWFuKHQpKX0sd3JpdGVTdHJpbmc6ZnVuY3Rpb24odCl7dD1TdHJpbmcodCksdGhpcy5yZWFsbG9jKDQqdC5sZW5ndGgpLHRoaXMucG9zKys7dmFyIGU9dGhpcy5wb3M7dGhpcy5wb3M9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgbixyLHM9MDtzPGUubGVuZ3RoO3MrKyl7aWYoKG49ZS5jaGFyQ29kZUF0KHMpKT41NTI5NSYmbjw1NzM0NCl7aWYoIXIpe24+NTYzMTl8fHMrMT09PWUubGVuZ3RoPyh0W2krK109MjM5LHRbaSsrXT0xOTEsdFtpKytdPTE4OSk6cj1uO2NvbnRpbnVlfWlmKG48NTYzMjApe3RbaSsrXT0yMzksdFtpKytdPTE5MSx0W2krK109MTg5LHI9bjtjb250aW51ZX1uPXItNTUyOTY8PDEwfG4tNTYzMjB8NjU1MzYscj1udWxsfWVsc2UgciYmKHRbaSsrXT0yMzksdFtpKytdPTE5MSx0W2krK109MTg5LHI9bnVsbCk7bjwxMjg/dFtpKytdPW46KG48MjA0OD90W2krK109bj4+NnwxOTI6KG48NjU1MzY/dFtpKytdPW4+PjEyfDIyNDoodFtpKytdPW4+PjE4fDI0MCx0W2krK109bj4+MTImNjN8MTI4KSx0W2krK109bj4+NiY2M3wxMjgpLHRbaSsrXT02MyZufDEyOCl9cmV0dXJuIGl9KHRoaXMuYnVmLHQsdGhpcy5wb3MpO3ZhciBpPXRoaXMucG9zLWU7aT49MTI4JiZOeChlLGksdGhpcyksdGhpcy5wb3M9ZS0xLHRoaXMud3JpdGVWYXJpbnQoaSksdGhpcy5wb3MrPWl9LHdyaXRlRmxvYXQ6ZnVuY3Rpb24odCl7dGhpcy5yZWFsbG9jKDQpLEN4KHRoaXMuYnVmLHQsdGhpcy5wb3MsITAsMjMsNCksdGhpcy5wb3MrPTR9LHdyaXRlRG91YmxlOmZ1bmN0aW9uKHQpe3RoaXMucmVhbGxvYyg4KSxDeCh0aGlzLmJ1Zix0LHRoaXMucG9zLCEwLDUyLDgpLHRoaXMucG9zKz04fSx3cml0ZUJ5dGVzOmZ1bmN0aW9uKHQpe3ZhciBlPXQubGVuZ3RoO3RoaXMud3JpdGVWYXJpbnQoZSksdGhpcy5yZWFsbG9jKGUpO2Zvcih2YXIgaT0wO2k8ZTtpKyspdGhpcy5idWZbdGhpcy5wb3MrK109dFtpXX0sd3JpdGVSYXdNZXNzYWdlOmZ1bmN0aW9uKHQsZSl7dGhpcy5wb3MrKzt2YXIgaT10aGlzLnBvczt0KGUsdGhpcyk7dmFyIG49dGhpcy5wb3MtaTtuPj0xMjgmJk54KGksbix0aGlzKSx0aGlzLnBvcz1pLTEsdGhpcy53cml0ZVZhcmludChuKSx0aGlzLnBvcys9bn0sd3JpdGVNZXNzYWdlOmZ1bmN0aW9uKHQsZSxpKXt0aGlzLndyaXRlVGFnKHQsSXguQnl0ZXMpLHRoaXMud3JpdGVSYXdNZXNzYWdlKGUsaSl9LHdyaXRlUGFja2VkVmFyaW50OmZ1bmN0aW9uKHQsZSl7ZS5sZW5ndGgmJnRoaXMud3JpdGVNZXNzYWdlKHQsRHgsZSl9LHdyaXRlUGFja2VkU1ZhcmludDpmdW5jdGlvbih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LCR4LGUpfSx3cml0ZVBhY2tlZEJvb2xlYW46ZnVuY3Rpb24odCxlKXtlLmxlbmd0aCYmdGhpcy53cml0ZU1lc3NhZ2UodCxGeCxlKX0sd3JpdGVQYWNrZWRGbG9hdDpmdW5jdGlvbih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LGt4LGUpfSx3cml0ZVBhY2tlZERvdWJsZTpmdW5jdGlvbih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LHp4LGUpfSx3cml0ZVBhY2tlZEZpeGVkMzI6ZnVuY3Rpb24odCxlKXtlLmxlbmd0aCYmdGhpcy53cml0ZU1lc3NhZ2UodCxCeCxlKX0sd3JpdGVQYWNrZWRTRml4ZWQzMjpmdW5jdGlvbih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LGp4LGUpfSx3cml0ZVBhY2tlZEZpeGVkNjQ6ZnVuY3Rpb24odCxlKXtlLmxlbmd0aCYmdGhpcy53cml0ZU1lc3NhZ2UodCxIeCxlKX0sd3JpdGVQYWNrZWRTRml4ZWQ2NDpmdW5jdGlvbih0LGUpe2UubGVuZ3RoJiZ0aGlzLndyaXRlTWVzc2FnZSh0LFV4LGUpfSx3cml0ZUJ5dGVzRmllbGQ6ZnVuY3Rpb24odCxlKXt0aGlzLndyaXRlVGFnKHQsSXguQnl0ZXMpLHRoaXMud3JpdGVCeXRlcyhlKX0sd3JpdGVGaXhlZDMyRmllbGQ6ZnVuY3Rpb24odCxlKXt0aGlzLndyaXRlVGFnKHQsSXguRml4ZWQzMiksdGhpcy53cml0ZUZpeGVkMzIoZSl9LHdyaXRlU0ZpeGVkMzJGaWVsZDpmdW5jdGlvbih0LGUpe3RoaXMud3JpdGVUYWcodCxJeC5GaXhlZDMyKSx0aGlzLndyaXRlU0ZpeGVkMzIoZSl9LHdyaXRlRml4ZWQ2NEZpZWxkOmZ1bmN0aW9uKHQsZSl7dGhpcy53cml0ZVRhZyh0LEl4LkZpeGVkNjQpLHRoaXMud3JpdGVGaXhlZDY0KGUpfSx3cml0ZVNGaXhlZDY0RmllbGQ6ZnVuY3Rpb24odCxlKXt0aGlzLndyaXRlVGFnKHQsSXguRml4ZWQ2NCksdGhpcy53cml0ZVNGaXhlZDY0KGUpfSx3cml0ZVZhcmludEZpZWxkOmZ1bmN0aW9uKHQsZSl7dGhpcy53cml0ZVRhZyh0LEl4LlZhcmludCksdGhpcy53cml0ZVZhcmludChlKX0sd3JpdGVTVmFyaW50RmllbGQ6ZnVuY3Rpb24odCxlKXt0aGlzLndyaXRlVGFnKHQsSXguVmFyaW50KSx0aGlzLndyaXRlU1ZhcmludChlKX0sd3JpdGVTdHJpbmdGaWVsZDpmdW5jdGlvbih0LGUpe3RoaXMud3JpdGVUYWcodCxJeC5CeXRlcyksdGhpcy53cml0ZVN0cmluZyhlKX0sd3JpdGVGbG9hdEZpZWxkOmZ1bmN0aW9uKHQsZSl7dGhpcy53cml0ZVRhZyh0LEl4LkZpeGVkMzIpLHRoaXMud3JpdGVGbG9hdChlKX0sd3JpdGVEb3VibGVGaWVsZDpmdW5jdGlvbih0LGUpe3RoaXMud3JpdGVUYWcodCxJeC5GaXhlZDY0KSx0aGlzLndyaXRlRG91YmxlKGUpfSx3cml0ZUJvb2xlYW5GaWVsZDpmdW5jdGlvbih0LGUpe3RoaXMud3JpdGVWYXJpbnRGaWVsZCh0LEJvb2xlYW4oZSkpfX07Y2xhc3MgS3h7Y29uc3RydWN0b3IoKXt9YmJveFRvQ2VsbElkcyh0LGUpe3Rocm93IG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKX1nZXRBZGphY2VudCh0KXt0aHJvdyBuZXcgY2QoXCJOb3QgaW1wbGVtZW50ZWRcIil9Z2V0VmVydGljZXModCl7dGhyb3cgbmV3IGNkKFwiTm90IGltcGxlbWVudGVkXCIpfWxuZ0xhdFRvQ2VsbElkKHQpe3Rocm93IG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKX1fYXBwcm94QmJveFRvQ2VsbElkcyh0LGUpe2lmKGUubGF0PD10LmxhdHx8ZS5sbmc8PXQubG5nKXRocm93IG5ldyBjZChcIk5vcnRoIGVhc3QgbmVlZHMgdG8gYmUgdG9wIHJpZ2h0IG9mIHNvdXRoIHdlc3RcIik7Y29uc3QgaT0odC5sYXQrZS5sYXQpLzIsbj0odC5sbmcrZS5sbmcpLzIscj1KdShlLmxuZyxlLmxhdCwwLG4saSwwKSxzPU1hdGgubWF4KHJbMF0sclsxXSk7cmV0dXJuIHRoaXMuX2xuZ0xhdFRvQ2VsbElkcyh7bGF0OmksbG5nOm59LHMpfV9lbnVUb0dlb2RldGljKHQsZSl7Y29uc3RbaSxuXT1LdSh0WzBdLHRbMV0sdFsyXSxlLmxuZyxlLmxhdCwwKTtyZXR1cm57bGF0Om4sbG5nOml9fV9nZXRMbmdMYXRCb3VuZGluZ0JveENvcm5lcnModCxlKXtyZXR1cm5bWy1lLGUsMF0sW2UsZSwwXSxbZSwtZSwwXSxbLWUsLWUsMF1dLm1hcCgoZT0+dGhpcy5fZW51VG9HZW9kZXRpYyhlLHQpKSl9X2xuZ0xhdFRvQ2VsbElkcyh0LGUpe2NvbnN0IGk9dGhpcy5sbmdMYXRUb0NlbGxJZCh0KSxuPXRoaXMuX2dldExuZ0xhdEJvdW5kaW5nQm94Q29ybmVycyh0LGUpO2Zvcihjb25zdCB0IG9mIG4pe2lmKHRoaXMubG5nTGF0VG9DZWxsSWQodCkhPT1pKXJldHVybltpLC4uLnRoaXMuZ2V0QWRqYWNlbnQoaSldfXJldHVybltpXX19Y2xhc3MgUXggZXh0ZW5kcyBIZntjb25zdHJ1Y3Rvcih0KXtpZihzdXBlcigpLHRoaXMuX2dlb21ldHJ5PXQsISh0aGlzLl9nZW9tZXRyeSBpbnN0YW5jZW9mIEt4KSl0aHJvdyBuZXcgY2QoXCJUaGUgZGF0YSBwcm92aWRlciByZXF1aXJlcyBhIGdlb21ldHJ5IHByb3ZpZGVyIGJhc2UgaW5zdGFuY2UuXCIpfWdldCBnZW9tZXRyeSgpe3JldHVybiB0aGlzLl9nZW9tZXRyeX1maXJlKHQsZSl7c3VwZXIuZmlyZSh0LGUpfWdldENvcmVJbWFnZXModCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKSl9Z2V0Q2x1c3Rlcih0LGUpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgY2QoXCJOb3QgaW1wbGVtZW50ZWRcIikpfWdldFNwYXRpYWxJbWFnZXModCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKSl9Z2V0SW1hZ2VzKHQpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgY2QoXCJOb3QgaW1wbGVtZW50ZWRcIikpfWdldEltYWdlQnVmZmVyKHQsZSl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKSl9Z2V0SW1hZ2VUaWxlcyh0KXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IGNkKFwiTm90IGltcGxlbWVudGVkXCIpKX1nZXRNZXNoKHQsZSl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKSl9Z2V0U2VxdWVuY2UodCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKSl9b2ZmKHQsZSl7c3VwZXIub2ZmKHQsZSl9b24odCxlKXtzdXBlci5vbih0LGUpfXNldEFjY2Vzc1Rva2VuKHQpe3Rocm93IG5ldyBjZChcIk5vdCBpbXBsZW1lbnRlZFwiKX19dmFyIHR3PXdwKChmdW5jdGlvbih0KXtcbi8qKlxuICAgICAqIEBsaWNlbnNlIGxvbmcuanMgKGMpIDIwMTMgRGFuaWVsIFdpcnR6IDxkY29kZUBkY29kZS5pbz5cbiAgICAgKiBSZWxlYXNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wXG4gICAgICogc2VlOiBodHRwczovL2dpdGh1Yi5jb20vZGNvZGVJTy9sb25nLmpzIGZvciBkZXRhaWxzXG4gICAgICovXG4hZnVuY3Rpb24oZSxpKXt0JiZ0LmV4cG9ydHM/dC5leHBvcnRzPWkoKTooZS5kY29kZUlPPWUuZGNvZGVJT3x8e30pLkxvbmc9aSgpfShicCwoZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHQsZSxpKXt0aGlzLmxvdz0wfHQsdGhpcy5oaWdoPTB8ZSx0aGlzLnVuc2lnbmVkPSEhaX1mdW5jdGlvbiBlKHQpe3JldHVybiEwPT09KHQmJnQuX19pc0xvbmdfXyl9dC5wcm90b3R5cGUuX19pc0xvbmdfXyxPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsXCJfX2lzTG9uZ19fXCIse3ZhbHVlOiEwLGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiExfSksdC5pc0xvbmc9ZTt2YXIgaT17fSxuPXt9O2Z1bmN0aW9uIHIodCxlKXt2YXIgcixzLGE7cmV0dXJuIGU/KGE9MDw9KHQ+Pj49MCkmJnQ8MjU2KSYmKHM9blt0XSk/czoocj1vKHQsKDB8dCk8MD8tMTowLCEwKSxhJiYoblt0XT1yKSxyKTooYT0tMTI4PD0odHw9MCkmJnQ8MTI4KSYmKHM9aVt0XSk/czoocj1vKHQsdDwwPy0xOjAsITEpLGEmJihpW3RdPXIpLHIpfWZ1bmN0aW9uIHModCxlKXtpZihpc05hTih0KXx8IWlzRmluaXRlKHQpKXJldHVybiBlP206ZjtpZihlKXtpZih0PDApcmV0dXJuIG07aWYodD49dSlyZXR1cm4gYn1lbHNle2lmKHQ8PS1kKXJldHVybiB4O2lmKHQrMT49ZClyZXR1cm4geX1yZXR1cm4gdDwwP3MoLXQsZSkubmVnKCk6byh0JWx8MCx0L2x8MCxlKX1mdW5jdGlvbiBvKGUsaSxuKXtyZXR1cm4gbmV3IHQoZSxpLG4pfXQuZnJvbUludD1yLHQuZnJvbU51bWJlcj1zLHQuZnJvbUJpdHM9bzt2YXIgYT1NYXRoLnBvdztmdW5jdGlvbiBjKHQsZSxpKXtpZigwPT09dC5sZW5ndGgpdGhyb3cgRXJyb3IoXCJlbXB0eSBzdHJpbmdcIik7aWYoXCJOYU5cIj09PXR8fFwiSW5maW5pdHlcIj09PXR8fFwiK0luZmluaXR5XCI9PT10fHxcIi1JbmZpbml0eVwiPT09dClyZXR1cm4gZjtpZihcIm51bWJlclwiPT10eXBlb2YgZT8oaT1lLGU9ITEpOmU9ISFlLChpPWl8fDEwKTwyfHwzNjxpKXRocm93IFJhbmdlRXJyb3IoXCJyYWRpeFwiKTt2YXIgbjtpZigobj10LmluZGV4T2YoXCItXCIpKT4wKXRocm93IEVycm9yKFwiaW50ZXJpb3IgaHlwaGVuXCIpO2lmKDA9PT1uKXJldHVybiBjKHQuc3Vic3RyaW5nKDEpLGUsaSkubmVnKCk7Zm9yKHZhciByPXMoYShpLDgpKSxvPWYsaD0wO2g8dC5sZW5ndGg7aCs9OCl7dmFyIGw9TWF0aC5taW4oOCx0Lmxlbmd0aC1oKSx1PXBhcnNlSW50KHQuc3Vic3RyaW5nKGgsaCtsKSxpKTtpZihsPDgpe3ZhciBkPXMoYShpLGwpKTtvPW8ubXVsKGQpLmFkZChzKHUpKX1lbHNlIG89KG89by5tdWwocikpLmFkZChzKHUpKX1yZXR1cm4gby51bnNpZ25lZD1lLG99ZnVuY3Rpb24gaChlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIHQ/ZTpcIm51bWJlclwiPT10eXBlb2YgZT9zKGUpOlwic3RyaW5nXCI9PXR5cGVvZiBlP2MoZSk6byhlLmxvdyxlLmhpZ2gsZS51bnNpZ25lZCl9dC5mcm9tU3RyaW5nPWMsdC5mcm9tVmFsdWU9aDt2YXIgbD00Mjk0OTY3Mjk2LHU9bCpsLGQ9dS8yLHA9cigxPDwyNCksZj1yKDApO3QuWkVSTz1mO3ZhciBtPXIoMCwhMCk7dC5VWkVSTz1tO3ZhciBnPXIoMSk7dC5PTkU9Zzt2YXIgXz1yKDEsITApO3QuVU9ORT1fO3ZhciB2PXIoLTEpO3QuTkVHX09ORT12O3ZhciB5PW8oLTEsMjE0NzQ4MzY0NywhMSk7dC5NQVhfVkFMVUU9eTt2YXIgYj1vKC0xLC0xLCEwKTt0Lk1BWF9VTlNJR05FRF9WQUxVRT1iO3ZhciB4PW8oMCwtMjE0NzQ4MzY0OCwhMSk7dC5NSU5fVkFMVUU9eDt2YXIgdz10LnByb3RvdHlwZTtyZXR1cm4gdy50b0ludD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnVuc2lnbmVkP3RoaXMubG93Pj4+MDp0aGlzLmxvd30sdy50b051bWJlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnVuc2lnbmVkPyh0aGlzLmhpZ2g+Pj4wKSpsKyh0aGlzLmxvdz4+PjApOnRoaXMuaGlnaCpsKyh0aGlzLmxvdz4+PjApfSx3LnRvU3RyaW5nPWZ1bmN0aW9uKHQpe2lmKCh0PXR8fDEwKTwyfHwzNjx0KXRocm93IFJhbmdlRXJyb3IoXCJyYWRpeFwiKTtpZih0aGlzLmlzWmVybygpKXJldHVyblwiMFwiO2lmKHRoaXMuaXNOZWdhdGl2ZSgpKXtpZih0aGlzLmVxKHgpKXt2YXIgZT1zKHQpLGk9dGhpcy5kaXYoZSksbj1pLm11bChlKS5zdWIodGhpcyk7cmV0dXJuIGkudG9TdHJpbmcodCkrbi50b0ludCgpLnRvU3RyaW5nKHQpfXJldHVyblwiLVwiK3RoaXMubmVnKCkudG9TdHJpbmcodCl9Zm9yKHZhciByPXMoYSh0LDYpLHRoaXMudW5zaWduZWQpLG89dGhpcyxjPVwiXCI7Oyl7dmFyIGg9by5kaXYociksbD0oby5zdWIoaC5tdWwocikpLnRvSW50KCk+Pj4wKS50b1N0cmluZyh0KTtpZigobz1oKS5pc1plcm8oKSlyZXR1cm4gbCtjO2Zvcig7bC5sZW5ndGg8NjspbD1cIjBcIitsO2M9XCJcIitsK2N9fSx3LmdldEhpZ2hCaXRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGlnaH0sdy5nZXRIaWdoQml0c1Vuc2lnbmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaGlnaD4+PjB9LHcuZ2V0TG93Qml0cz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxvd30sdy5nZXRMb3dCaXRzVW5zaWduZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sb3c+Pj4wfSx3LmdldE51bUJpdHNBYnM9ZnVuY3Rpb24oKXtpZih0aGlzLmlzTmVnYXRpdmUoKSlyZXR1cm4gdGhpcy5lcSh4KT82NDp0aGlzLm5lZygpLmdldE51bUJpdHNBYnMoKTtmb3IodmFyIHQ9MCE9dGhpcy5oaWdoP3RoaXMuaGlnaDp0aGlzLmxvdyxlPTMxO2U+MCYmMD09KHQmMTw8ZSk7ZS0tKTtyZXR1cm4gMCE9dGhpcy5oaWdoP2UrMzM6ZSsxfSx3LmlzWmVybz1mdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5oaWdoJiYwPT09dGhpcy5sb3d9LHcuaXNOZWdhdGl2ZT1mdW5jdGlvbigpe3JldHVybiF0aGlzLnVuc2lnbmVkJiZ0aGlzLmhpZ2g8MH0sdy5pc1Bvc2l0aXZlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5zaWduZWR8fHRoaXMuaGlnaD49MH0sdy5pc09kZD1mdW5jdGlvbigpe3JldHVybiAxPT0oMSZ0aGlzLmxvdyl9LHcuaXNFdmVuPWZ1bmN0aW9uKCl7cmV0dXJuIDA9PSgxJnRoaXMubG93KX0sdy5lcXVhbHM9ZnVuY3Rpb24odCl7cmV0dXJuIGUodCl8fCh0PWgodCkpLCh0aGlzLnVuc2lnbmVkPT09dC51bnNpZ25lZHx8dGhpcy5oaWdoPj4+MzEhPTF8fHQuaGlnaD4+PjMxIT0xKSYmKHRoaXMuaGlnaD09PXQuaGlnaCYmdGhpcy5sb3c9PT10Lmxvdyl9LHcuZXE9dy5lcXVhbHMsdy5ub3RFcXVhbHM9ZnVuY3Rpb24odCl7cmV0dXJuIXRoaXMuZXEodCl9LHcubmVxPXcubm90RXF1YWxzLHcubGVzc1RoYW49ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcCh0KTwwfSx3Lmx0PXcubGVzc1RoYW4sdy5sZXNzVGhhbk9yRXF1YWw9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuY29tcCh0KTw9MH0sdy5sdGU9dy5sZXNzVGhhbk9yRXF1YWwsdy5ncmVhdGVyVGhhbj1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wKHQpPjB9LHcuZ3Q9dy5ncmVhdGVyVGhhbix3LmdyZWF0ZXJUaGFuT3JFcXVhbD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jb21wKHQpPj0wfSx3Lmd0ZT13LmdyZWF0ZXJUaGFuT3JFcXVhbCx3LmNvbXBhcmU9ZnVuY3Rpb24odCl7aWYoZSh0KXx8KHQ9aCh0KSksdGhpcy5lcSh0KSlyZXR1cm4gMDt2YXIgaT10aGlzLmlzTmVnYXRpdmUoKSxuPXQuaXNOZWdhdGl2ZSgpO3JldHVybiBpJiYhbj8tMTohaSYmbj8xOnRoaXMudW5zaWduZWQ/dC5oaWdoPj4+MD50aGlzLmhpZ2g+Pj4wfHx0LmhpZ2g9PT10aGlzLmhpZ2gmJnQubG93Pj4+MD50aGlzLmxvdz4+PjA/LTE6MTp0aGlzLnN1Yih0KS5pc05lZ2F0aXZlKCk/LTE6MX0sdy5jb21wPXcuY29tcGFyZSx3Lm5lZ2F0ZT1mdW5jdGlvbigpe3JldHVybiF0aGlzLnVuc2lnbmVkJiZ0aGlzLmVxKHgpP3g6dGhpcy5ub3QoKS5hZGQoZyl9LHcubmVnPXcubmVnYXRlLHcuYWRkPWZ1bmN0aW9uKHQpe2UodCl8fCh0PWgodCkpO3ZhciBpPXRoaXMuaGlnaD4+PjE2LG49NjU1MzUmdGhpcy5oaWdoLHI9dGhpcy5sb3c+Pj4xNixzPTY1NTM1JnRoaXMubG93LGE9dC5oaWdoPj4+MTYsYz02NTUzNSZ0LmhpZ2gsbD10Lmxvdz4+PjE2LHU9MCxkPTAscD0wLGY9MDtyZXR1cm4gcCs9KGYrPXMrKDY1NTM1JnQubG93KSk+Pj4xNixkKz0ocCs9citsKT4+PjE2LHUrPShkKz1uK2MpPj4+MTYsdSs9aSthLG8oKHAmPTY1NTM1KTw8MTZ8KGYmPTY1NTM1KSwodSY9NjU1MzUpPDwxNnwoZCY9NjU1MzUpLHRoaXMudW5zaWduZWQpfSx3LnN1YnRyYWN0PWZ1bmN0aW9uKHQpe3JldHVybiBlKHQpfHwodD1oKHQpKSx0aGlzLmFkZCh0Lm5lZygpKX0sdy5zdWI9dy5zdWJ0cmFjdCx3Lm11bHRpcGx5PWZ1bmN0aW9uKHQpe2lmKHRoaXMuaXNaZXJvKCkpcmV0dXJuIGY7aWYoZSh0KXx8KHQ9aCh0KSksdC5pc1plcm8oKSlyZXR1cm4gZjtpZih0aGlzLmVxKHgpKXJldHVybiB0LmlzT2RkKCk/eDpmO2lmKHQuZXEoeCkpcmV0dXJuIHRoaXMuaXNPZGQoKT94OmY7aWYodGhpcy5pc05lZ2F0aXZlKCkpcmV0dXJuIHQuaXNOZWdhdGl2ZSgpP3RoaXMubmVnKCkubXVsKHQubmVnKCkpOnRoaXMubmVnKCkubXVsKHQpLm5lZygpO2lmKHQuaXNOZWdhdGl2ZSgpKXJldHVybiB0aGlzLm11bCh0Lm5lZygpKS5uZWcoKTtpZih0aGlzLmx0KHApJiZ0Lmx0KHApKXJldHVybiBzKHRoaXMudG9OdW1iZXIoKSp0LnRvTnVtYmVyKCksdGhpcy51bnNpZ25lZCk7dmFyIGk9dGhpcy5oaWdoPj4+MTYsbj02NTUzNSZ0aGlzLmhpZ2gscj10aGlzLmxvdz4+PjE2LGE9NjU1MzUmdGhpcy5sb3csYz10LmhpZ2g+Pj4xNixsPTY1NTM1JnQuaGlnaCx1PXQubG93Pj4+MTYsZD02NTUzNSZ0LmxvdyxtPTAsZz0wLF89MCx2PTA7cmV0dXJuIF8rPSh2Kz1hKmQpPj4+MTYsZys9KF8rPXIqZCk+Pj4xNixfJj02NTUzNSxnKz0oXys9YSp1KT4+PjE2LG0rPShnKz1uKmQpPj4+MTYsZyY9NjU1MzUsbSs9KGcrPXIqdSk+Pj4xNixnJj02NTUzNSxtKz0oZys9YSpsKT4+PjE2LG0rPWkqZCtuKnUrcipsK2EqYyxvKChfJj02NTUzNSk8PDE2fCh2Jj02NTUzNSksKG0mPTY1NTM1KTw8MTZ8KGcmPTY1NTM1KSx0aGlzLnVuc2lnbmVkKX0sdy5tdWw9dy5tdWx0aXBseSx3LmRpdmlkZT1mdW5jdGlvbih0KXtpZihlKHQpfHwodD1oKHQpKSx0LmlzWmVybygpKXRocm93IEVycm9yKFwiZGl2aXNpb24gYnkgemVyb1wiKTtpZih0aGlzLmlzWmVybygpKXJldHVybiB0aGlzLnVuc2lnbmVkP206Zjt2YXIgaSxuLHI7aWYodGhpcy51bnNpZ25lZCl7aWYodC51bnNpZ25lZHx8KHQ9dC50b1Vuc2lnbmVkKCkpLHQuZ3QodGhpcykpcmV0dXJuIG07aWYodC5ndCh0aGlzLnNocnUoMSkpKXJldHVybiBfO3I9bX1lbHNle2lmKHRoaXMuZXEoeCkpcmV0dXJuIHQuZXEoZyl8fHQuZXEodik/eDp0LmVxKHgpP2c6KGk9dGhpcy5zaHIoMSkuZGl2KHQpLnNobCgxKSkuZXEoZik/dC5pc05lZ2F0aXZlKCk/Zzp2OihuPXRoaXMuc3ViKHQubXVsKGkpKSxyPWkuYWRkKG4uZGl2KHQpKSk7aWYodC5lcSh4KSlyZXR1cm4gdGhpcy51bnNpZ25lZD9tOmY7aWYodGhpcy5pc05lZ2F0aXZlKCkpcmV0dXJuIHQuaXNOZWdhdGl2ZSgpP3RoaXMubmVnKCkuZGl2KHQubmVnKCkpOnRoaXMubmVnKCkuZGl2KHQpLm5lZygpO2lmKHQuaXNOZWdhdGl2ZSgpKXJldHVybiB0aGlzLmRpdih0Lm5lZygpKS5uZWcoKTtyPWZ9Zm9yKG49dGhpcztuLmd0ZSh0KTspe2k9TWF0aC5tYXgoMSxNYXRoLmZsb29yKG4udG9OdW1iZXIoKS90LnRvTnVtYmVyKCkpKTtmb3IodmFyIG89TWF0aC5jZWlsKE1hdGgubG9nKGkpL01hdGguTE4yKSxjPW88PTQ4PzE6YSgyLG8tNDgpLGw9cyhpKSx1PWwubXVsKHQpO3UuaXNOZWdhdGl2ZSgpfHx1Lmd0KG4pOyl1PShsPXMoaS09Yyx0aGlzLnVuc2lnbmVkKSkubXVsKHQpO2wuaXNaZXJvKCkmJihsPWcpLHI9ci5hZGQobCksbj1uLnN1Yih1KX1yZXR1cm4gcn0sdy5kaXY9dy5kaXZpZGUsdy5tb2R1bG89ZnVuY3Rpb24odCl7cmV0dXJuIGUodCl8fCh0PWgodCkpLHRoaXMuc3ViKHRoaXMuZGl2KHQpLm11bCh0KSl9LHcubW9kPXcubW9kdWxvLHcubm90PWZ1bmN0aW9uKCl7cmV0dXJuIG8ofnRoaXMubG93LH50aGlzLmhpZ2gsdGhpcy51bnNpZ25lZCl9LHcuYW5kPWZ1bmN0aW9uKHQpe3JldHVybiBlKHQpfHwodD1oKHQpKSxvKHRoaXMubG93JnQubG93LHRoaXMuaGlnaCZ0LmhpZ2gsdGhpcy51bnNpZ25lZCl9LHcub3I9ZnVuY3Rpb24odCl7cmV0dXJuIGUodCl8fCh0PWgodCkpLG8odGhpcy5sb3d8dC5sb3csdGhpcy5oaWdofHQuaGlnaCx0aGlzLnVuc2lnbmVkKX0sdy54b3I9ZnVuY3Rpb24odCl7cmV0dXJuIGUodCl8fCh0PWgodCkpLG8odGhpcy5sb3dedC5sb3csdGhpcy5oaWdoXnQuaGlnaCx0aGlzLnVuc2lnbmVkKX0sdy5zaGlmdExlZnQ9ZnVuY3Rpb24odCl7cmV0dXJuIGUodCkmJih0PXQudG9JbnQoKSksMD09KHQmPTYzKT90aGlzOnQ8MzI/byh0aGlzLmxvdzw8dCx0aGlzLmhpZ2g8PHR8dGhpcy5sb3c+Pj4zMi10LHRoaXMudW5zaWduZWQpOm8oMCx0aGlzLmxvdzw8dC0zMix0aGlzLnVuc2lnbmVkKX0sdy5zaGw9dy5zaGlmdExlZnQsdy5zaGlmdFJpZ2h0PWZ1bmN0aW9uKHQpe3JldHVybiBlKHQpJiYodD10LnRvSW50KCkpLDA9PSh0Jj02Myk/dGhpczp0PDMyP28odGhpcy5sb3c+Pj50fHRoaXMuaGlnaDw8MzItdCx0aGlzLmhpZ2g+PnQsdGhpcy51bnNpZ25lZCk6byh0aGlzLmhpZ2g+PnQtMzIsdGhpcy5oaWdoPj0wPzA6LTEsdGhpcy51bnNpZ25lZCl9LHcuc2hyPXcuc2hpZnRSaWdodCx3LnNoaWZ0UmlnaHRVbnNpZ25lZD1mdW5jdGlvbih0KXtpZihlKHQpJiYodD10LnRvSW50KCkpLDA9PT0odCY9NjMpKXJldHVybiB0aGlzO3ZhciBpPXRoaXMuaGlnaDtyZXR1cm4gdDwzMj9vKHRoaXMubG93Pj4+dHxpPDwzMi10LGk+Pj50LHRoaXMudW5zaWduZWQpOm8oMzI9PT10P2k6aT4+PnQtMzIsMCx0aGlzLnVuc2lnbmVkKX0sdy5zaHJ1PXcuc2hpZnRSaWdodFVuc2lnbmVkLHcudG9TaWduZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy51bnNpZ25lZD9vKHRoaXMubG93LHRoaXMuaGlnaCwhMSk6dGhpc30sdy50b1Vuc2lnbmVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudW5zaWduZWQ/dGhpczpvKHRoaXMubG93LHRoaXMuaGlnaCwhMCl9LHcudG9CeXRlcz1mdW5jdGlvbih0KXtyZXR1cm4gdD90aGlzLnRvQnl0ZXNMRSgpOnRoaXMudG9CeXRlc0JFKCl9LHcudG9CeXRlc0xFPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5oaWdoLGU9dGhpcy5sb3c7cmV0dXJuWzI1NSZlLGU+Pj44JjI1NSxlPj4+MTYmMjU1LGU+Pj4yNCYyNTUsMjU1JnQsdD4+PjgmMjU1LHQ+Pj4xNiYyNTUsdD4+PjI0JjI1NV19LHcudG9CeXRlc0JFPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5oaWdoLGU9dGhpcy5sb3c7cmV0dXJuW3Q+Pj4yNCYyNTUsdD4+PjE2JjI1NSx0Pj4+OCYyNTUsMjU1JnQsZT4+PjI0JjI1NSxlPj4+MTYmMjU1LGU+Pj44JjI1NSwyNTUmZV19LHR9KSl9KSksZXc9d3AoKGZ1bmN0aW9uKHQpeyFmdW5jdGlvbih0KXt2YXIgZT10LlMyPXtMOnt9fTtlLkwuTGF0TG5nPWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1wYXJzZUZsb2F0KHQsMTApLHI9cGFyc2VGbG9hdChlLDEwKTtpZihpc05hTihuKXx8aXNOYU4ocikpdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBMYXRMbmcgb2JqZWN0OiAoXCIrdCtcIiwgXCIrZStcIilcIik7cmV0dXJuITAhPT1pJiYobj1NYXRoLm1heChNYXRoLm1pbihuLDkwKSwtOTApLHI9KHIrMTgwKSUzNjArKHI8LTE4MHx8MTgwPT09cj8xODA6LTE4MCkpLHtsYXQ6bixsbmc6cn19LGUuTC5MYXRMbmcuREVHX1RPX1JBRD1NYXRoLlBJLzE4MCxlLkwuTGF0TG5nLlJBRF9UT19ERUc9MTgwL01hdGguUEksZS5MYXRMbmdUb1hZWj1mdW5jdGlvbih0KXt2YXIgaT1lLkwuTGF0TG5nLkRFR19UT19SQUQsbj10LmxhdCppLHI9dC5sbmcqaSxzPU1hdGguY29zKG4pO3JldHVybltNYXRoLmNvcyhyKSpzLE1hdGguc2luKHIpKnMsTWF0aC5zaW4obildfSxlLlhZWlRvTGF0TG5nPWZ1bmN0aW9uKHQpe3ZhciBpPWUuTC5MYXRMbmcuUkFEX1RPX0RFRyxuPU1hdGguYXRhbjIodFsyXSxNYXRoLnNxcnQodFswXSp0WzBdK3RbMV0qdFsxXSkpLHI9TWF0aC5hdGFuMih0WzFdLHRbMF0pO3JldHVybiBlLkwuTGF0TG5nKG4qaSxyKmkpfTtlLlhZWlRvRmFjZVVWPWZ1bmN0aW9uKHQpe3ZhciBlPWZ1bmN0aW9uKHQpe3ZhciBlPVtNYXRoLmFicyh0WzBdKSxNYXRoLmFicyh0WzFdKSxNYXRoLmFicyh0WzJdKV07cmV0dXJuIGVbMF0+ZVsxXT9lWzBdPmVbMl0/MDoyOmVbMV0+ZVsyXT8xOjJ9KHQpO3JldHVybiB0W2VdPDAmJihlKz0zKSxbZSxmdW5jdGlvbih0LGUpe3ZhciBpLG47c3dpdGNoKHQpe2Nhc2UgMDppPWVbMV0vZVswXSxuPWVbMl0vZVswXTticmVhaztjYXNlIDE6aT0tZVswXS9lWzFdLG49ZVsyXS9lWzFdO2JyZWFrO2Nhc2UgMjppPS1lWzBdL2VbMl0sbj0tZVsxXS9lWzJdO2JyZWFrO2Nhc2UgMzppPWVbMl0vZVswXSxuPWVbMV0vZVswXTticmVhaztjYXNlIDQ6aT1lWzJdL2VbMV0sbj0tZVswXS9lWzFdO2JyZWFrO2Nhc2UgNTppPS1lWzFdL2VbMl0sbj0tZVswXS9lWzJdO2JyZWFrO2RlZmF1bHQ6dGhyb3d7ZXJyb3I6XCJJbnZhbGlkIGZhY2VcIn19cmV0dXJuW2ksbl19KGUsdCldfSxlLkZhY2VVVlRvWFlaPWZ1bmN0aW9uKHQsZSl7dmFyIGk9ZVswXSxuPWVbMV07c3dpdGNoKHQpe2Nhc2UgMDpyZXR1cm5bMSxpLG5dO2Nhc2UgMTpyZXR1cm5bLWksMSxuXTtjYXNlIDI6cmV0dXJuWy1pLC1uLDFdO2Nhc2UgMzpyZXR1cm5bLTEsLW4sLWldO2Nhc2UgNDpyZXR1cm5bbiwtMSwtaV07Y2FzZSA1OnJldHVybltuLGksLTFdO2RlZmF1bHQ6dGhyb3d7ZXJyb3I6XCJJbnZhbGlkIGZhY2VcIn19fTt2YXIgaT1mdW5jdGlvbih0KXtyZXR1cm4gdD49LjU/MS8zKig0KnQqdC0xKToxLzMqKDEtNCooMS10KSooMS10KSl9O2UuU1RUb1VWPWZ1bmN0aW9uKHQpe3JldHVybltpKHRbMF0pLGkodFsxXSldfTt2YXIgbj1mdW5jdGlvbih0KXtyZXR1cm4gdD49MD8uNSpNYXRoLnNxcnQoMSszKnQpOjEtLjUqTWF0aC5zcXJ0KDEtMyp0KX07ZS5VVlRvU1Q9ZnVuY3Rpb24odCl7cmV0dXJuW24odFswXSksbih0WzFdKV19LGUuU1RUb0lKPWZ1bmN0aW9uKHQsZSl7dmFyIGk9MTw8ZSxuPWZ1bmN0aW9uKHQpe3ZhciBlPU1hdGguZmxvb3IodCppKTtyZXR1cm4gTWF0aC5tYXgoMCxNYXRoLm1pbihpLTEsZSkpfTtyZXR1cm5bbih0WzBdKSxuKHRbMV0pXX0sZS5JSlRvU1Q9ZnVuY3Rpb24odCxlLGkpe3ZhciBuPTE8PGU7cmV0dXJuWyh0WzBdK2lbMF0pL24sKHRbMV0raVsxXSkvbl19O3ZhciByPWZ1bmN0aW9uKHQsZSxpLG4pe2lmKDA9PW4pezE9PWkmJihlLng9dC0xLWUueCxlLnk9dC0xLWUueSk7dmFyIHI9ZS54O2UueD1lLnksZS55PXJ9fSxzPWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciByPXthOltbMCxcImRcIl0sWzEsXCJhXCJdLFszLFwiYlwiXSxbMixcImFcIl1dLGI6W1syLFwiYlwiXSxbMSxcImJcIl0sWzMsXCJhXCJdLFswLFwiY1wiXV0sYzpbWzIsXCJjXCJdLFszLFwiZFwiXSxbMSxcImNcIl0sWzAsXCJiXCJdXSxkOltbMCxcImFcIl0sWzMsXCJjXCJdLFsxLFwiZFwiXSxbMixcImRcIl1dfTtcIm51bWJlclwiIT10eXBlb2YgbiYmY29uc29sZS53YXJuKG5ldyBFcnJvcihcImNhbGxlZCBwb2ludFRvSGlsYmVydFF1YWRMaXN0IHdpdGhvdXQgZmFjZSB2YWx1ZSwgZGVmYXVsdGluZyB0byAnMCdcIikuc3RhY2spO2Zvcih2YXIgcz1uJTI/XCJkXCI6XCJhXCIsbz1bXSxhPWktMTthPj0wO2EtLSl7dmFyIGM9MTw8YSxoPXJbc11bMioodCZjPzE6MCkrKGUmYz8xOjApXTtvLnB1c2goaFswXSkscz1oWzFdfXJldHVybiBvfTtlLlMyQ2VsbD1mdW5jdGlvbigpe30sZS5TMkNlbGwuRnJvbUhpbGJlcnRRdWFkS2V5PWZ1bmN0aW9uKHQpe3ZhciBpLG4scyxvLGEsYyxoPXQuc3BsaXQoXCIvXCIpLGw9cGFyc2VJbnQoaFswXSksdT1oWzFdLGQ9dS5sZW5ndGgscD17eDowLHk6MH07Zm9yKGk9ZC0xO2k+PTA7aS0tKW49ZC1pLG89MCxhPTAsXCIxXCI9PT0ocz11W2ldKT9hPTE6XCIyXCI9PT1zPyhvPTEsYT0xKTpcIjNcIj09PXMmJihvPTEpLGM9TWF0aC5wb3coMixuLTEpLHIoYyxwLG8sYSkscC54Kz1jKm8scC55Kz1jKmE7aWYobCUyPT0xKXt2YXIgZj1wLng7cC54PXAueSxwLnk9Zn1yZXR1cm4gZS5TMkNlbGwuRnJvbUZhY2VJSihwYXJzZUludChsKSxbcC54LHAueV0sbil9LGUuUzJDZWxsLkZyb21MYXRMbmc9ZnVuY3Rpb24odCxpKXtpZighdC5sYXQmJjAhPT10LmxhdHx8IXQubG5nJiYwIT09dC5sbmcpdGhyb3cgbmV3IEVycm9yKFwiUGFzcyB7IGxhdDogbGF0LCBsbmc6IGxuZyB9IHRvIFMyLlMyQ2VsbC5Gcm9tTGF0TG5nXCIpO3ZhciBuPWUuTGF0TG5nVG9YWVoodCkscj1lLlhZWlRvRmFjZVVWKG4pLHM9ZS5VVlRvU1QoclsxXSksbz1lLlNUVG9JSihzLGkpO3JldHVybiBlLlMyQ2VsbC5Gcm9tRmFjZUlKKHJbMF0sbyxpKX0sZS5TMkNlbGwuRnJvbUZhY2VJSj1mdW5jdGlvbih0LGksbil7dmFyIHI9bmV3IGUuUzJDZWxsO3JldHVybiByLmZhY2U9dCxyLmlqPWksci5sZXZlbD1uLHJ9LGUuUzJDZWxsLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiRlwiK3RoaXMuZmFjZStcImlqW1wiK3RoaXMuaWpbMF0rXCIsXCIrdGhpcy5palsxXStcIl1AXCIrdGhpcy5sZXZlbH0sZS5TMkNlbGwucHJvdG90eXBlLmdldExhdExuZz1mdW5jdGlvbigpe3ZhciB0PWUuSUpUb1NUKHRoaXMuaWosdGhpcy5sZXZlbCxbLjUsLjVdKSxpPWUuU1RUb1VWKHQpLG49ZS5GYWNlVVZUb1hZWih0aGlzLmZhY2UsaSk7cmV0dXJuIGUuWFlaVG9MYXRMbmcobil9LGUuUzJDZWxsLnByb3RvdHlwZS5nZXRDb3JuZXJMYXRMbmdzPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PVtdLGk9W1swLDBdLFswLDFdLFsxLDFdLFsxLDBdXSxuPTA7bjw0O24rKyl7dmFyIHI9ZS5JSlRvU1QodGhpcy5paix0aGlzLmxldmVsLGlbbl0pLHM9ZS5TVFRvVVYociksbz1lLkZhY2VVVlRvWFlaKHRoaXMuZmFjZSxzKTt0LnB1c2goZS5YWVpUb0xhdExuZyhvKSl9cmV0dXJuIHR9LGUuUzJDZWxsLnByb3RvdHlwZS5nZXRGYWNlQW5kUXVhZHM9ZnVuY3Rpb24oKXt2YXIgdD1zKHRoaXMuaWpbMF0sdGhpcy5palsxXSx0aGlzLmxldmVsLHRoaXMuZmFjZSk7cmV0dXJuW3RoaXMuZmFjZSx0XX0sZS5TMkNlbGwucHJvdG90eXBlLnRvSGlsYmVydFF1YWRrZXk9ZnVuY3Rpb24oKXt2YXIgdD1zKHRoaXMuaWpbMF0sdGhpcy5palsxXSx0aGlzLmxldmVsLHRoaXMuZmFjZSk7cmV0dXJuIHRoaXMuZmFjZS50b1N0cmluZygxMCkrXCIvXCIrdC5qb2luKFwiXCIpfSxlLmxhdExuZ1RvTmVpZ2hib3JLZXlzPWUuUzJDZWxsLmxhdExuZ1RvTmVpZ2hib3JLZXlzPWZ1bmN0aW9uKHQsaSxuKXtyZXR1cm4gZS5TMkNlbGwuRnJvbUxhdExuZyh7bGF0OnQsbG5nOml9LG4pLmdldE5laWdoYm9ycygpLm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIHQudG9IaWxiZXJ0UXVhZGtleSgpfSkpfSxlLlMyQ2VsbC5wcm90b3R5cGUuZ2V0TmVpZ2hib3JzPWZ1bmN0aW9uKCl7dmFyIHQ9ZnVuY3Rpb24odCxpLG4pe3ZhciByPTE8PG47aWYoaVswXT49MCYmaVsxXT49MCYmaVswXTxyJiZpWzFdPHIpcmV0dXJuIGUuUzJDZWxsLkZyb21GYWNlSUoodCxpLG4pO3ZhciBzPWUuSUpUb1NUKGksbixbLjUsLjVdKSxvPWUuU1RUb1VWKHMpLGE9ZS5GYWNlVVZUb1hZWih0LG8pLGM9ZS5YWVpUb0ZhY2VVVihhKTtyZXR1cm4gdD1jWzBdLG89Y1sxXSxzPWUuVVZUb1NUKG8pLGk9ZS5TVFRvSUoocyxuKSxlLlMyQ2VsbC5Gcm9tRmFjZUlKKHQsaSxuKX0saT10aGlzLmZhY2Usbj10aGlzLmlqWzBdLHI9dGhpcy5palsxXSxzPXRoaXMubGV2ZWw7cmV0dXJuW3QoaSxbbi0xLHJdLHMpLHQoaSxbbixyLTFdLHMpLHQoaSxbbisxLHJdLHMpLHQoaSxbbixyKzFdLHMpXX0sZS5GQUNFX0JJVFM9MyxlLk1BWF9MRVZFTD0zMCxlLlBPU19CSVRTPTIqZS5NQVhfTEVWRUwrMSxlLmZhY2VQb3NMZXZlbFRvSWQ9ZS5TMkNlbGwuZmFjZVBvc0xldmVsVG9JZD1lLmZyb21GYWNlUG9zTGV2ZWw9ZnVuY3Rpb24oaSxuLHIpe3ZhciBzLG8sYSxjPXQuZGNvZGVJTyYmdC5kY29kZUlPLkxvbmd8fHR3O2ZvcihyfHwocj1uLmxlbmd0aCksbi5sZW5ndGg+ciYmKG49bi5zdWJzdHIoMCxyKSkscz1jLmZyb21TdHJpbmcoaS50b1N0cmluZygxMCksITAsMTApLnRvU3RyaW5nKDIpO3MubGVuZ3RoPGUuRkFDRV9CSVRTOylzPVwiMFwiK3M7Zm9yKG89Yy5mcm9tU3RyaW5nKG4sITAsNCkudG9TdHJpbmcoMik7by5sZW5ndGg8MipyOylvPVwiMFwiK287Zm9yKGE9cytvLGErPVwiMVwiO2EubGVuZ3RoPGUuRkFDRV9CSVRTK2UuUE9TX0JJVFM7KWErPVwiMFwiO3JldHVybiBjLmZyb21TdHJpbmcoYSwhMCwyKS50b1N0cmluZygxMCl9LGUua2V5VG9JZD1lLlMyQ2VsbC5rZXlUb0lkPWUudG9JZD1lLnRvQ2VsbElkPWUuZnJvbUtleT1mdW5jdGlvbih0KXt2YXIgaT10LnNwbGl0KFwiL1wiKTtyZXR1cm4gZS5mcm9tRmFjZVBvc0xldmVsKGlbMF0saVsxXSxpWzFdLmxlbmd0aCl9LGUuaWRUb0tleT1lLlMyQ2VsbC5pZFRvS2V5PWUuUzJDZWxsLnRvS2V5PWUudG9LZXk9ZS5mcm9tSWQ9ZS5mcm9tQ2VsbElkPWUuUzJDZWxsLnRvSGlsYmVydFF1YWRrZXk9ZS50b0hpbGJlcnRRdWFka2V5PWZ1bmN0aW9uKGkpe2Zvcih2YXIgbj10LmRjb2RlSU8mJnQuZGNvZGVJTy5Mb25nfHx0dyxyPW4uZnJvbVN0cmluZyhpLCEwLDEwKS50b1N0cmluZygyKTtyLmxlbmd0aDxlLkZBQ0VfQklUUytlLlBPU19CSVRTOylyPVwiMFwiK3I7Zm9yKHZhciBzPXIubGFzdEluZGV4T2YoXCIxXCIpLG89ci5zdWJzdHJpbmcoMCwzKSxhPXIuc3Vic3RyaW5nKDMscyksYz1hLmxlbmd0aC8yLGg9bi5mcm9tU3RyaW5nKG8sITAsMikudG9TdHJpbmcoMTApLGw9bi5mcm9tU3RyaW5nKGEsITAsMikudG9TdHJpbmcoNCk7bC5sZW5ndGg8YzspbD1cIjBcIitsO3JldHVybiBoK1wiL1wiK2x9LGUua2V5VG9MYXRMbmc9ZS5TMkNlbGwua2V5VG9MYXRMbmc9ZnVuY3Rpb24odCl7cmV0dXJuIGUuUzJDZWxsLkZyb21IaWxiZXJ0UXVhZEtleSh0KS5nZXRMYXRMbmcoKX0sZS5pZFRvTGF0TG5nPWUuUzJDZWxsLmlkVG9MYXRMbmc9ZnVuY3Rpb24odCl7dmFyIGk9ZS5pZFRvS2V5KHQpO3JldHVybiBlLmtleVRvTGF0TG5nKGkpfSxlLlMyQ2VsbC5sYXRMbmdUb0tleT1lLmxhdExuZ1RvS2V5PWUubGF0TG5nVG9RdWFka2V5PWZ1bmN0aW9uKHQsaSxuKXtpZihpc05hTihuKXx8bjwxfHxuPjMwKXRocm93IG5ldyBFcnJvcihcIidsZXZlbCcgaXMgbm90IGEgbnVtYmVyIGJldHdlZW4gMSBhbmQgMzAgKGJ1dCBpdCBzaG91bGQgYmUpXCIpO3JldHVybiBlLlMyQ2VsbC5Gcm9tTGF0TG5nKHtsYXQ6dCxsbmc6aX0sbikudG9IaWxiZXJ0UXVhZGtleSgpfSxlLnN0ZXBLZXk9ZnVuY3Rpb24oZSxpKXt2YXIgbixyPXQuZGNvZGVJTyYmdC5kY29kZUlPLkxvbmd8fHR3LHM9ZS5zcGxpdChcIi9cIiksbz1zWzBdLGE9c1sxXSxjPXNbMV0ubGVuZ3RoLGg9ci5mcm9tU3RyaW5nKGEsITAsNCk7aT4wP249aC5hZGQoTWF0aC5hYnMoaSkpOmk8MCYmKG49aC5zdWJ0cmFjdChNYXRoLmFicyhpKSkpO3ZhciBsPW4udG9TdHJpbmcoNCk7Zm9yKFwiMFwiPT09bCYmY29uc29sZS53YXJuaW5nKG5ldyBFcnJvcihcImZhY2UvcG9zaXRpb24gd3JhcHBpbmcgaXMgbm90IHlldCBzdXBwb3J0ZWRcIikpO2wubGVuZ3RoPGM7KWw9XCIwXCIrbDtyZXR1cm4gbytcIi9cIitsfSxlLlMyQ2VsbC5wcmV2S2V5PWUucHJldktleT1mdW5jdGlvbih0KXtyZXR1cm4gZS5zdGVwS2V5KHQsLTEpfSxlLlMyQ2VsbC5uZXh0S2V5PWUubmV4dEtleT1mdW5jdGlvbih0KXtyZXR1cm4gZS5zdGVwS2V5KHQsMSl9fSh0LmV4cG9ydHMpfSkpO2NsYXNzIGl3IGV4dGVuZHMgS3h7Y29uc3RydWN0b3IodD0xNyl7c3VwZXIoKSx0aGlzLl9sZXZlbD10fWJib3hUb0NlbGxJZHModCxlKXtyZXR1cm4gdGhpcy5fYXBwcm94QmJveFRvQ2VsbElkcyh0LGUpfWdldEFkamFjZW50KHQpe2NvbnN0IGU9ZXcuUzIuaWRUb0tleSh0KSxpPWUuc3BsaXQoXCIvXCIpWzFdLmxlbmd0aCxbbixyLHMsb109dGhpcy5fZ2V0TmVpZ2hib3JzKGUsaSksYT1bZSxuLHIscyxvXSxjPUFycmF5LmZyb20obmV3IFNldChbLi4udGhpcy5fZ2V0TmVpZ2hib3JzKG4saSksLi4udGhpcy5fZ2V0TmVpZ2hib3JzKHIsaSksLi4udGhpcy5fZ2V0TmVpZ2hib3JzKHMsaSksLi4udGhpcy5fZ2V0TmVpZ2hib3JzKG8saSldLmZpbHRlcigodD0+IWEuaW5jbHVkZXModCkpKSkpLGg9W24scixzLG9dO2Zvcihjb25zdCB0IG9mIGMpe2xldCBlPTA7Zm9yKGNvbnN0IG4gb2YgdGhpcy5fZ2V0TmVpZ2hib3JzKHQsaSkpYS5pbmNsdWRlcyhuKSYmZSsrOzI9PT1lJiZoLnB1c2godCl9cmV0dXJuIGgubWFwKCh0PT5ldy5TMi5rZXlUb0lkKHQpKSl9Z2V0VmVydGljZXModCl7Y29uc3QgZT1ldy5TMi5pZFRvS2V5KHQpO3JldHVybiBldy5TMi5TMkNlbGwuRnJvbUhpbGJlcnRRdWFkS2V5KGUpLmdldENvcm5lckxhdExuZ3MoKS5tYXAoKHQ9Pih7bGF0OnQubGF0LGxuZzp0LmxuZ30pKSl9bG5nTGF0VG9DZWxsSWQodCl7cmV0dXJuIHRoaXMuX2xuZ0xhdFRvSWQodCx0aGlzLl9sZXZlbCl9X2dldE5laWdoYm9ycyh0LGUpe2NvbnN0IGk9ZXcuUzIua2V5VG9MYXRMbmcodCk7cmV0dXJuIGV3LlMyLmxhdExuZ1RvTmVpZ2hib3JLZXlzKGkubGF0LGkubG5nLGUpfV9sbmdMYXRUb0lkKHQsZSl7Y29uc3QgaT1ldy5TMi5sYXRMbmdUb0tleSh0LmxhdCx0LmxuZyxlKTtyZXR1cm4gZXcuUzIua2V5VG9JZChpKX19Y2xhc3Mgbnd7Y2x1c3RlclJlY29uc3RydWN0aW9uKHQpe2NvbnN0IGU9dC5wb2ludHMsaT0xLzI1NTtmb3IoY29uc3QgdCBpbiBlKXtpZighZS5oYXNPd25Qcm9wZXJ0eSh0KSljb250aW51ZTtjb25zdCBuPWVbdF0uY29sb3I7blswXSo9aSxuWzFdKj1pLG5bMl0qPWl9Y29uc3Qgbj10LnJlZmVyZW5jZV9sbGE7cmV0dXJue2lkOm51bGwscG9pbnRzOmUscmVmZXJlbmNlOnthbHQ6bi5hbHRpdHVkZSxsYXQ6bi5sYXRpdHVkZSxsbmc6bi5sb25naXR1ZGV9fX1jb3JlSW1hZ2UodCl7Y29uc3QgZT10aGlzLl9nZW9tZXRyeSh0Lmdlb21ldHJ5KSxpPXRoaXMuX2dlb21ldHJ5KHQuY29tcHV0ZWRfZ2VvbWV0cnkpLG49e2lkOnQuc2VxdWVuY2V9O3JldHVybntjb21wdXRlZF9nZW9tZXRyeTppLGdlb21ldHJ5OmUsaWQ6dC5pZCxzZXF1ZW5jZTpufX1zcGF0aWFsSW1hZ2UodCl7dmFyIGUsaSxuLHI7dC5jYW1lcmFfdHlwZT1mdW5jdGlvbih0KXtzd2l0Y2godCl7Y2FzZVwiZXF1aXJlY3Rhbmd1bGFyXCI6Y2FzZVwic3BoZXJpY2FsXCI6cmV0dXJuXCJzcGhlcmljYWxcIjtjYXNlXCJmaXNoZXllXCI6cmV0dXJuXCJmaXNoZXllXCI7ZGVmYXVsdDpyZXR1cm5cInBlcnNwZWN0aXZlXCJ9fSh0LmNhbWVyYV90eXBlKSx0Lm1lcmdlX2lkPXQubWVyZ2VfY2M/dC5tZXJnZV9jYy50b1N0cmluZygpOm51bGwsdC5wcml2YXRlPW51bGw7Y29uc3Qgcz1cInNwaGVyaWNhbFwiPT09dC5jYW1lcmFfdHlwZT90LnRodW1iXzIwNDhfdXJsOnQudGh1bWJfMTAyNF91cmw7cmV0dXJuIHQudGh1bWI9bnVsbCE9PShlPXQudGh1bWIpJiZ2b2lkIDAhPT1lP2U6e2lkOm51bGwsdXJsOnN9LHQuY2x1c3Rlcj1udWxsIT09KGk9dC5zZm1fY2x1c3RlcikmJnZvaWQgMCE9PWk/aTp7aWQ6bnVsbCx1cmw6bnVsbH0sdC5jcmVhdG9yPXtpZDpudWxsLHVzZXJuYW1lOm51bGx9LHQub3duZXI9bnVsbCE9PShuPXQub3duZXIpJiZ2b2lkIDAhPT1uP246e2lkOm51bGx9LHQubWVzaD1udWxsIT09KHI9dC5tZXNoKSYmdm9pZCAwIT09cj9yOntpZDpudWxsLHVybDpudWxsfSx0fV9nZW9tZXRyeSh0KXtjb25zdCBlPW51bGw9PXQ/dm9pZCAwOnQuY29vcmRpbmF0ZXM7cmV0dXJuIGU/e2xhdDplWzFdLGxuZzplWzBdfTpudWxsfX1jbGFzcyByd3tjb25zdHJ1Y3Rvcigpe3RoaXMuaW1hZ2VzUGF0aD1cImltYWdlc1wiLHRoaXMuc2VxdWVuY2VQYXRoPVwiaW1hZ2VfaWRzXCIsdGhpcy5faW1hZ2VUaWxlc1BhdGg9XCJ0aWxlc1wiLHRoaXMuY29yZUZpZWxkcz1bXCJjb21wdXRlZF9nZW9tZXRyeVwiLFwiZ2VvbWV0cnlcIixcInNlcXVlbmNlXCJdLHRoaXMuaWRGaWVsZHM9W1wiaWRcIl0sdGhpcy5zcGF0aWFsRmllbGRzPVtcImFsdGl0dWRlXCIsXCJhdG9taWNfc2NhbGVcIixcImNhbWVyYV9wYXJhbWV0ZXJzXCIsXCJjYW1lcmFfdHlwZVwiLFwiY2FwdHVyZWRfYXRcIixcImNvbXBhc3NfYW5nbGVcIixcImNvbXB1dGVkX2FsdGl0dWRlXCIsXCJjb21wdXRlZF9jb21wYXNzX2FuZ2xlXCIsXCJjb21wdXRlZF9yb3RhdGlvblwiLFwiZXhpZl9vcmllbnRhdGlvblwiLFwiaGVpZ2h0XCIsXCJtZXJnZV9jY1wiLFwibWVzaFwiLFwicXVhbGl0eV9zY29yZVwiLFwic2ZtX2NsdXN0ZXJcIixcInRodW1iXzEwMjRfdXJsXCIsXCJ0aHVtYl8yMDQ4X3VybFwiLFwid2lkdGhcIl0sdGhpcy5pbWFnZVRpbGVGaWVsZHM9W1widXJsXCIsXCJ6XCIsXCJ4XCIsXCJ5XCJdfWltYWdlcyh0LGUpe3JldHVybmBpbWFnZV9pZHM9JHt0LmpvaW4oXCIsXCIpfSZmaWVsZHM9JHtlLmpvaW4oXCIsXCIpfWB9aW1hZ2VzUzIodCxlKXtyZXR1cm5gczI9JHt0fSZmaWVsZHM9JHtlLmpvaW4oXCIsXCIpfWB9aW1hZ2VUaWxlcyh0LGUpe3JldHVybmB6PSR7dH0mZmllbGRzPSR7ZS5qb2luKFwiLFwiKX1gfWltYWdlVGlsZXNQYXRoKHQpe3JldHVybmAke3R9LyR7dGhpcy5faW1hZ2VUaWxlc1BhdGh9YH1zZXF1ZW5jZSh0KXtyZXR1cm5gc2VxdWVuY2VfaWQ9JHt0fWB9fWNsYXNzIHN3IGV4dGVuZHMgUXh7Y29uc3RydWN0b3IodCxlLGksbil7dmFyIHI7c3VwZXIobnVsbCE9ZT9lOm5ldyBpdyksdGhpcy5fY29udmVydD1udWxsIT1pP2k6bmV3IG53LHRoaXMuX3F1ZXJ5PW51bGwhPW4/bjpuZXcgcncsdGhpcy5fbWV0aG9kPVwiR0VUXCI7Y29uc3Qgcz1udWxsIT10P3Q6e307dGhpcy5fZW5kcG9pbnQ9bnVsbCE9PShyPXMuZW5kcG9pbnQpJiZ2b2lkIDAhPT1yP3I6XCJodHRwczovL2dyYXBoLm1hcGlsbGFyeS5jb21cIix0aGlzLl9hY2Nlc3NUb2tlbj1zLmFjY2Vzc1Rva2VufWdldENsdXN0ZXIodCxlKXtyZXR1cm4gWHgodCxlKS50aGVuKCh0PT57Y29uc3QgZT1XeCh0KTtpZihlLmxlbmd0aDwxKXRocm93IG5ldyBFcnJvcihcIkNsdXN0ZXIgcmVjb25zdHJ1Y3Rpb24gZW1wdHlcIik7cmV0dXJuIHRoaXMuX2NvbnZlcnQuY2x1c3RlclJlY29uc3RydWN0aW9uKGVbMF0pfSkpfWdldENvcmVJbWFnZXModCl7Y29uc3QgZT1bLi4udGhpcy5fcXVlcnkuaWRGaWVsZHMsLi4udGhpcy5fcXVlcnkuY29yZUZpZWxkc10saT10aGlzLl9xdWVyeS5pbWFnZXNTMih0LGUpLG49bmV3IFVSTCh0aGlzLl9xdWVyeS5pbWFnZXNQYXRoLHRoaXMuX2VuZHBvaW50KS5ocmVmO3JldHVybiB0aGlzLl9mZXRjaEdyYXBoQ29udHJhY3QoaSxuKS50aGVuKChlPT57Y29uc3QgaT17Y2VsbF9pZDp0LGltYWdlczpbXX0sbj1lLmRhdGE7Zm9yKGNvbnN0IHQgb2Ygbil7Y29uc3QgZT10aGlzLl9jb252ZXJ0LmNvcmVJbWFnZSh0KTtpLmltYWdlcy5wdXNoKGUpfXJldHVybiBpfSkpfWdldEltYWdlQnVmZmVyKHQsZSl7cmV0dXJuIFh4KHQsZSl9Z2V0SW1hZ2VzKHQpe2NvbnN0IGU9Wy4uLnRoaXMuX3F1ZXJ5LmlkRmllbGRzLC4uLnRoaXMuX3F1ZXJ5LmNvcmVGaWVsZHMsLi4udGhpcy5fcXVlcnkuc3BhdGlhbEZpZWxkc10saT10aGlzLl9xdWVyeS5pbWFnZXModCxlKSxuPW5ldyBVUkwodGhpcy5fcXVlcnkuaW1hZ2VzUGF0aCx0aGlzLl9lbmRwb2ludCkuaHJlZjtyZXR1cm4gdGhpcy5fZmV0Y2hHcmFwaENvbnRyYWN0KGksbikudGhlbigodD0+e2NvbnN0IGU9W10saT10LmRhdGE7Zm9yKGNvbnN0IHQgb2YgaSl7Y29uc3QgaT10aGlzLl9jb252ZXJ0LmNvcmVJbWFnZSh0KSxuPXRoaXMuX2NvbnZlcnQuc3BhdGlhbEltYWdlKHQpLHI9e25vZGU6T2JqZWN0LmFzc2lnbih7fSxuLGkpLG5vZGVfaWQ6dC5pZH07ZS5wdXNoKHIpfXJldHVybiBlfSkpfWdldEltYWdlVGlsZXModCl7Y29uc3QgZT1bLi4udGhpcy5fcXVlcnkuaW1hZ2VUaWxlRmllbGRzXSxpPXRoaXMuX3F1ZXJ5LmltYWdlVGlsZXModC56LGUpLG49bmV3IFVSTCh0aGlzLl9xdWVyeS5pbWFnZVRpbGVzUGF0aCh0LmltYWdlSWQpLHRoaXMuX2VuZHBvaW50KS5ocmVmO3JldHVybiB0aGlzLl9mZXRjaEdyYXBoQ29udHJhY3QoaSxuKS50aGVuKChlPT4oe25vZGU6ZS5kYXRhLG5vZGVfaWQ6dC5pbWFnZUlkfSkpKX1nZXRNZXNoKHQsZSl7cmV0dXJuIFh4KHQsZSkudGhlbigodD0+WngodCkpKX1nZXRTZXF1ZW5jZSh0KXtjb25zdCBlPXRoaXMuX3F1ZXJ5LnNlcXVlbmNlKHQpLGk9bmV3IFVSTCh0aGlzLl9xdWVyeS5zZXF1ZW5jZVBhdGgsdGhpcy5fZW5kcG9pbnQpLmhyZWY7cmV0dXJuIHRoaXMuX2ZldGNoR3JhcGhDb250cmFjdChlLGkpLnRoZW4oKGU9Pih7aWQ6dCxpbWFnZV9pZHM6ZS5kYXRhLm1hcCgodD0+dC5pZCkpfSkpKX1nZXRTcGF0aWFsSW1hZ2VzKHQpe2NvbnN0IGU9Wy4uLnRoaXMuX3F1ZXJ5LmlkRmllbGRzLC4uLnRoaXMuX3F1ZXJ5LmNvcmVGaWVsZHMsLi4udGhpcy5fcXVlcnkuc3BhdGlhbEZpZWxkc10saT10aGlzLl9xdWVyeS5pbWFnZXModCxlKSxuPW5ldyBVUkwodGhpcy5fcXVlcnkuaW1hZ2VzUGF0aCx0aGlzLl9lbmRwb2ludCkuaHJlZjtyZXR1cm4gdGhpcy5fZmV0Y2hHcmFwaENvbnRyYWN0KGksbikudGhlbigodD0+e2NvbnN0IGU9W10saT10LmRhdGE7Zm9yKGNvbnN0IHQgb2YgaSl7Y29uc3QgaT17bm9kZTp0aGlzLl9jb252ZXJ0LnNwYXRpYWxJbWFnZSh0KSxub2RlX2lkOnQuaWR9O2UucHVzaChpKX1yZXR1cm4gZX0pKX1zZXRBY2Nlc3NUb2tlbih0KXt0aGlzLl9hY2Nlc3NUb2tlbj10fV9jcmVhdGVIZWFkZXJzKCl7Y29uc3QgdD1be25hbWU6XCJBY2NlcHRcIix2YWx1ZTpcImFwcGxpY2F0aW9uL2pzb25cIn0se25hbWU6XCJDb250ZW50LVR5cGVcIix2YWx1ZTpcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwifV07cmV0dXJuIHRoaXMuX2FjY2Vzc1Rva2VuJiZ0LnB1c2goe25hbWU6XCJBdXRob3JpemF0aW9uXCIsdmFsdWU6YE9BdXRoICR7dGhpcy5fYWNjZXNzVG9rZW59YH0pLHR9X2ZldGNoR3JhcGhDb250cmFjdCh0LGUpe3JldHVybiBZeChgJHtlfT8ke3R9YCx0aGlzLl9tZXRob2QsXCJqc29uXCIsdGhpcy5fY3JlYXRlSGVhZGVycygpLG51bGwsbnVsbCkuY2F0Y2goKHQ9Pntjb25zdCBlPXRoaXMuX21ha2VFcnJvck1lc3NhZ2UodCk7dGhyb3cgbmV3IGNkKGUpfSkpfV9tYWtlRXJyb3JNZXNzYWdlKHQpe2NvbnN0IGU9dC5lcnJvcjtyZXR1cm4gZT9gJHtlLmNvZGV9ICgke2UudHlwZX0sICR7ZS5mYnRyYWNlX2lkfSk6ICR7ZS5tZXNzYWdlfWA6XCJGYWlsZWQgdG8gZmV0Y2ggZGF0YVwifX1jbGFzcyBvd3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX2lkPXQsdGhpcy5fbG5nTGF0PWV9Z2V0IGlkKCl7cmV0dXJuIHRoaXMuX2lkfWdldCBnZW9tZXRyeSgpe3JldHVybiB0aGlzLl9nZW9tZXRyeX1nZXQgbG5nTGF0KCl7cmV0dXJuIHRoaXMuX2xuZ0xhdH1jcmVhdGVHZW9tZXRyeSh0KXt0aGlzLl9nZW9tZXRyeXx8KHRoaXMuX2NyZWF0ZUdlb21ldHJ5KHQpLHRoaXMuX2dlb21ldHJ5LnVwZGF0ZU1hdHJpeFdvcmxkKCEwKSl9ZGlzcG9zZUdlb21ldHJ5KCl7dGhpcy5fZ2VvbWV0cnkmJih0aGlzLl9kaXNwb3NlR2VvbWV0cnkoKSx0aGlzLl9nZW9tZXRyeT12b2lkIDApfWdldEludGVyYWN0aXZlT2JqZWN0cygpe3JldHVybiB0aGlzLl9nZW9tZXRyeT90aGlzLl9nZXRJbnRlcmFjdGl2ZU9iamVjdHMoKTpbXX1sZXJwQWx0aXR1ZGUodCxlKXt0aGlzLl9nZW9tZXRyeSYmKHRoaXMuX2dlb21ldHJ5LnBvc2l0aW9uLno9KDEtZSkqdGhpcy5fZ2VvbWV0cnkucG9zaXRpb24ueitlKnQpfXVwZGF0ZVBvc2l0aW9uKHQsZSl7ZSYmKHRoaXMuX2xuZ0xhdC5sYXQ9ZS5sYXQsdGhpcy5fbG5nTGF0LmxuZz1lLmxuZyksdGhpcy5fZ2VvbWV0cnkmJih0aGlzLl9nZW9tZXRyeS5wb3NpdGlvbi5mcm9tQXJyYXkodCksdGhpcy5fZ2VvbWV0cnkudXBkYXRlTWF0cml4V29ybGQoITApKX19bGV0IGF3O2Z1bmN0aW9uIGN3KCl7cmV0dXJuIHZvaWQgMD09PWF3JiYoYXc9ZnVuY3Rpb24oKXtjb25zdCB0PXthbHBoYTohMSxhbnRpYWxpYXM6ITEsZGVwdGg6ITAsZmFpbElmTWFqb3JQZXJmb3JtYW5jZUNhdmVhdDohMSxwcmVtdWx0aXBsaWVkQWxwaGE6ITAscHJlc2VydmVEcmF3aW5nQnVmZmVyOiExLHN0ZW5jaWw6ITB9LGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtpZihlLmdldENvbnRleHQoXCJ3ZWJnbDJcIix0KSlyZXR1cm4hMDtjb25zdCBpPWUuZ2V0Q29udGV4dChcIndlYmdsXCIsdCl8fGUuZ2V0Q29udGV4dChcImV4cGVyaW1lbnRhbC13ZWJnbFwiLHQpO2lmKCFpKXJldHVybiExO2NvbnN0IG49W1wiT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzXCJdLHI9aS5nZXRTdXBwb3J0ZWRFeHRlbnNpb25zKCk7Zm9yKGNvbnN0IHQgb2YgbilpZigtMT09PXIuaW5kZXhPZih0KSlyZXR1cm4hMTtyZXR1cm4hMH0oKSksYXd9ZnVuY3Rpb24gaHcoKXtyZXR1cm5cInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93JiZcInVuZGVmaW5lZFwiIT10eXBlb2YgZG9jdW1lbnQmJiEhKEFycmF5LnByb3RvdHlwZSYmQXJyYXkucHJvdG90eXBlLmNvbmNhdCYmQXJyYXkucHJvdG90eXBlLmZpbHRlciYmQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzJiZBcnJheS5wcm90b3R5cGUuaW5kZXhPZiYmQXJyYXkucHJvdG90eXBlLmpvaW4mJkFycmF5LnByb3RvdHlwZS5tYXAmJkFycmF5LnByb3RvdHlwZS5wdXNoJiZBcnJheS5wcm90b3R5cGUucG9wJiZBcnJheS5wcm90b3R5cGUucmV2ZXJzZSYmQXJyYXkucHJvdG90eXBlLnNoaWZ0JiZBcnJheS5wcm90b3R5cGUuc2xpY2UmJkFycmF5LnByb3RvdHlwZS5zcGxpY2UmJkFycmF5LnByb3RvdHlwZS5zb3J0JiZBcnJheS5wcm90b3R5cGUudW5zaGlmdCkmJlwiQmxvYlwiaW4gd2luZG93JiZcIlVSTFwiaW4gd2luZG93JiYhIShGdW5jdGlvbi5wcm90b3R5cGUmJkZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseSYmRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQpJiZcIkpTT05cImluIHdpbmRvdyYmXCJwYXJzZVwiaW4gSlNPTiYmXCJzdHJpbmdpZnlcImluIEpTT04mJlwiTWFwXCJpbiB3aW5kb3cmJiEhKE9iamVjdC5hc3NpZ24mJk9iamVjdC5rZXlzJiZPYmplY3QudmFsdWVzKSYmISEoXCJQcm9taXNlXCJpbiB3aW5kb3cmJlByb21pc2UucmVzb2x2ZSYmUHJvbWlzZS5yZWplY3QmJlByb21pc2UucHJvdG90eXBlJiZQcm9taXNlLnByb3RvdHlwZS5jYXRjaCYmUHJvbWlzZS5wcm90b3R5cGUudGhlbikmJlwiU2V0XCJpbiB3aW5kb3d9dmFyIGx3LHV3O3QuQ2FtZXJhQ29udHJvbHM9dm9pZCAwLChsdz10LkNhbWVyYUNvbnRyb2xzfHwodC5DYW1lcmFDb250cm9scz17fSkpW2x3LkN1c3RvbT0wXT1cIkN1c3RvbVwiLGx3W2x3LkVhcnRoPTFdPVwiRWFydGhcIixsd1tsdy5TdHJlZXQ9Ml09XCJTdHJlZXRcIix0LlJlbmRlck1vZGU9dm9pZCAwLCh1dz10LlJlbmRlck1vZGV8fCh0LlJlbmRlck1vZGU9e30pKVt1dy5MZXR0ZXJib3g9MF09XCJMZXR0ZXJib3hcIix1d1t1dy5GaWxsPTFdPVwiRmlsbFwiLHQuUmVuZGVyUGFzcz12b2lkIDAsZnVuY3Rpb24odCl7dFt0Lk9wYXF1ZT0wXT1cIk9wYXF1ZVwifSh0LlJlbmRlclBhc3N8fCh0LlJlbmRlclBhc3M9e30pKTtjbGFzcyBkd3tjb25zdHJ1Y3Rvcih0LGUsaSxuLHIscyl7dGhpcy5fY29udGFpbmVyPXQsdGhpcy5fb2JzZXJ2ZXI9aSx0aGlzLl9uYXZpZ2F0b3I9ZSx0aGlzLl9vcHRpb25zPW51bGwhPXI/cjp7fSx0aGlzLl9rZXk9bix0aGlzLl9uYXZpZ2FibGU9bnVsbD09bix0aGlzLl9jb21wb25lbnRTZXJ2aWNlPXN8fG5ldyBXZCh0aGlzLl9jb250YWluZXIsdGhpcy5fbmF2aWdhdG9yKSx0aGlzLl9jb3ZlckNvbXBvbmVudD10aGlzLl9jb21wb25lbnRTZXJ2aWNlLmdldENvdmVyKCksdGhpcy5faW5pdGlhbGl6ZUNvbXBvbmVudHMoKSxuPyh0aGlzLl9pbml0aWxpemVDb3ZlckNvbXBvbmVudCgpLHRoaXMuX3N1YnNjcmliZUNvdmVyQ29tcG9uZW50KCkpOnRoaXMuX25hdmlnYXRvci5tb3ZlZFRvSWQkLnBpcGUoRWUoKHQ9Pm51bGwhPXQpKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fa2V5PXQsdGhpcy5fY29tcG9uZW50U2VydmljZS5kZWFjdGl2YXRlQ292ZXIoKSx0aGlzLl9jb3ZlckNvbXBvbmVudC5jb25maWd1cmUoe2lkOnRoaXMuX2tleSxzdGF0ZTpGZi5IaWRkZW59KSx0aGlzLl9zdWJzY3JpYmVDb3ZlckNvbXBvbmVudCgpLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhcnQoKSx0aGlzLl9uYXZpZ2F0b3IuY2FjaGVTZXJ2aWNlLnN0YXJ0KCksdGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2Uuc3RhcnQoKSx0aGlzLl9vYnNlcnZlci5zdGFydEVtaXQoKX0pKX1nZXQgbmF2aWdhYmxlKCl7cmV0dXJuIHRoaXMuX25hdmlnYWJsZX1nZXQodCl7cmV0dXJuIHRoaXMuX2NvbXBvbmVudFNlcnZpY2UuZ2V0KHQpfWFjdGl2YXRlKHQpe3RoaXMuX2NvbXBvbmVudFNlcnZpY2UuYWN0aXZhdGUodCl9YWN0aXZhdGVDb3Zlcigpe3RoaXMuX2NvdmVyQ29tcG9uZW50LmNvbmZpZ3VyZSh7c3RhdGU6RmYuVmlzaWJsZX0pfWRlYWN0aXZhdGUodCl7dGhpcy5fY29tcG9uZW50U2VydmljZS5kZWFjdGl2YXRlKHQpfWRlYWN0aXZhdGVDb3Zlcigpe3RoaXMuX2NvdmVyQ29tcG9uZW50LmNvbmZpZ3VyZSh7c3RhdGU6RmYuTG9hZGluZ30pfXJlbW92ZSgpe3RoaXMuX2NvbXBvbmVudFNlcnZpY2UucmVtb3ZlKCksbnVsbCE9dGhpcy5fY29uZmlndXJhdGlvblN1YnNjcmlwdGlvbiYmdGhpcy5fY29uZmlndXJhdGlvblN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfV9pbml0aWFsaXplQ29tcG9uZW50cygpe3ZhciB0LGU7Y29uc3QgaT10aGlzLl9vcHRpb25zO3RoaXMuX3VGYWxzZShudWxsPT09KHQ9aS5mYWxsYmFjayl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuaW1hZ2UsXCJpbWFnZWZhbGxiYWNrXCIpLHRoaXMuX3VGYWxzZShudWxsPT09KGU9aS5mYWxsYmFjayl8fHZvaWQgMD09PWU/dm9pZCAwOmUubmF2aWdhdGlvbixcIm5hdmlnYXRpb25mYWxsYmFja1wiKSx0aGlzLl91RmFsc2UoaS5tYXJrZXIsXCJtYXJrZXJcIiksdGhpcy5fdUZhbHNlKGkucG9wdXAsXCJwb3B1cFwiKSx0aGlzLl91RmFsc2UoaS5zbGlkZXIsXCJzbGlkZXJcIiksdGhpcy5fdUZhbHNlKGkuc3BhdGlhbCxcInNwYXRpYWxcIiksdGhpcy5fdUZhbHNlKGkudGFnLFwidGFnXCIpLHRoaXMuX3VUcnVlKGkuYXR0cmlidXRpb24sXCJhdHRyaWJ1dGlvblwiKSx0aGlzLl91VHJ1ZShpLmJlYXJpbmcsXCJiZWFyaW5nXCIpLHRoaXMuX3VUcnVlKGkuY2FjaGUsXCJjYWNoZVwiKSx0aGlzLl91VHJ1ZShpLmRpcmVjdGlvbixcImRpcmVjdGlvblwiKSx0aGlzLl91VHJ1ZShpLmltYWdlLFwiaW1hZ2VcIiksdGhpcy5fdVRydWUoaS5rZXlib2FyZCxcImtleWJvYXJkXCIpLHRoaXMuX3VUcnVlKGkucG9pbnRlcixcInBvaW50ZXJcIiksdGhpcy5fdVRydWUoaS5zZXF1ZW5jZSxcInNlcXVlbmNlXCIpLHRoaXMuX3VUcnVlKGkuem9vbSxcInpvb21cIil9X2luaXRpbGl6ZUNvdmVyQ29tcG9uZW50KCl7bGV0IHQ9dGhpcy5fb3B0aW9uczt0aGlzLl9jb3ZlckNvbXBvbmVudC5jb25maWd1cmUoe2lkOnRoaXMuX2tleX0pLHZvaWQgMD09PXQuY292ZXJ8fHQuY292ZXI/dGhpcy5hY3RpdmF0ZUNvdmVyKCk6dGhpcy5kZWFjdGl2YXRlQ292ZXIoKX1fc2V0TmF2aWdhYmxlKHQpe3RoaXMuX25hdmlnYWJsZSE9PXQmJih0aGlzLl9uYXZpZ2FibGU9dCx0aGlzLl9vYnNlcnZlci5uYXZpZ2FibGUkLm5leHQodCkpfV9zdWJzY3JpYmVDb3ZlckNvbXBvbmVudCgpe3RoaXMuX2NvbmZpZ3VyYXRpb25TdWJzY3JpcHRpb249dGhpcy5fY292ZXJDb21wb25lbnQuY29uZmlndXJhdGlvbiQucGlwZSh1ZSh2b2lkIDAsKHQ9PnQuc3RhdGUpKSkuc3Vic2NyaWJlKCh0PT57dC5zdGF0ZT09PUZmLkxvYWRpbmc/dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SWQkLnBpcGUoRWUoKSxyaSgoZT0+e2NvbnN0IGk9bnVsbD09ZXx8ZSE9PXQuaWQ7cmV0dXJuIGkmJnRoaXMuX3NldE5hdmlnYWJsZSghMSksaT90aGlzLl9uYXZpZ2F0b3IubW92ZVRvJCh0LmlkKTp0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQucGlwZShFZSgpKX0pKSkuc3Vic2NyaWJlKCgoKT0+e3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhcnQoKSx0aGlzLl9uYXZpZ2F0b3IuY2FjaGVTZXJ2aWNlLnN0YXJ0KCksdGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2Uuc3RhcnQoKSx0aGlzLl9vYnNlcnZlci5zdGFydEVtaXQoKSx0aGlzLl9jb3ZlckNvbXBvbmVudC5jb25maWd1cmUoe3N0YXRlOkZmLkhpZGRlbn0pLHRoaXMuX2NvbXBvbmVudFNlcnZpY2UuZGVhY3RpdmF0ZUNvdmVyKCksdGhpcy5fc2V0TmF2aWdhYmxlKCEwKX0pLCh0PT57Y29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBkZWFjdGl2YXRlIGNvdmVyLlwiLHQpLHRoaXMuX2NvdmVyQ29tcG9uZW50LmNvbmZpZ3VyZSh7c3RhdGU6RmYuVmlzaWJsZX0pfSkpOnQuc3RhdGU9PT1GZi5WaXNpYmxlJiYodGhpcy5fb2JzZXJ2ZXIuc3RvcEVtaXQoKSx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0b3AoKSx0aGlzLl9uYXZpZ2F0b3IuY2FjaGVTZXJ2aWNlLnN0b3AoKSx0aGlzLl9uYXZpZ2F0b3IucGxheVNlcnZpY2Uuc3RvcCgpLHRoaXMuX25hdmlnYXRvci5wYW5TZXJ2aWNlLnN0b3AoKSx0aGlzLl9jb21wb25lbnRTZXJ2aWNlLmFjdGl2YXRlQ292ZXIoKSx0aGlzLl9zZXROYXZpZ2FibGUobnVsbD09dC5pZCkpfSkpfV91RmFsc2UodCxlKXt2b2lkIDAhPT10P1wiYm9vbGVhblwiIT10eXBlb2YgdD8odGhpcy5fY29tcG9uZW50U2VydmljZS5jb25maWd1cmUoZSx0KSx0aGlzLl9jb21wb25lbnRTZXJ2aWNlLmFjdGl2YXRlKGUpKTp0P3RoaXMuX2NvbXBvbmVudFNlcnZpY2UuYWN0aXZhdGUoZSk6dGhpcy5fY29tcG9uZW50U2VydmljZS5kZWFjdGl2YXRlKGUpOnRoaXMuX2NvbXBvbmVudFNlcnZpY2UuZGVhY3RpdmF0ZShlKX1fdVRydWUodCxlKXt2b2lkIDAhPT10P1wiYm9vbGVhblwiIT10eXBlb2YgdD8odGhpcy5fY29tcG9uZW50U2VydmljZS5jb25maWd1cmUoZSx0KSx0aGlzLl9jb21wb25lbnRTZXJ2aWNlLmFjdGl2YXRlKGUpKTp0P3RoaXMuX2NvbXBvbmVudFNlcnZpY2UuYWN0aXZhdGUoZSk6dGhpcy5fY29tcG9uZW50U2VydmljZS5kZWFjdGl2YXRlKGUpOnRoaXMuX2NvbXBvbmVudFNlcnZpY2UuYWN0aXZhdGUoZSl9fWNsYXNzIHB3e2NvbnN0cnVjdG9yKGUsaSxuKXt0aGlzLl9hZGFwdGl2ZU9wZXJhdGlvbiQ9bmV3IFQsdGhpcy5fcmVuZGVyJD1uZXcgVCx0aGlzLl9yZW5kZXJBZGFwdGl2ZSQ9bmV3IFQsdGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fcmVuZGVyU2VydmljZT1pLHRoaXMuX2N1cnJlbnRGcmFtZSQ9bjtjb25zdCByPXRoaXMuX3N1YnNjcmlwdGlvbnMscz1qZi5jcmVhdGUoamYuaChcImRpdi5tYXBpbGxhcnktZG9tLXJlbmRlcmVyXCIsW10pKTtlLmFwcGVuZENoaWxkKHMpLHRoaXMuX29mZnNldCQ9dGhpcy5fYWRhcHRpdmVPcGVyYXRpb24kLnBpcGUoTGUoKCh0LGUpPT5lKHQpKSx7ZWxlbWVudEhlaWdodDplLm9mZnNldEhlaWdodCxlbGVtZW50V2lkdGg6ZS5vZmZzZXRXaWR0aCxpbWFnZUFzcGVjdDowLHJlbmRlck1vZGU6dC5SZW5kZXJNb2RlLkZpbGx9KSxOdCgodD0+dC5pbWFnZUFzcGVjdD4wJiZ0LmVsZW1lbnRXaWR0aD4wJiZ0LmVsZW1lbnRIZWlnaHQ+MCkpLHJ0KChlPT57Y29uc3QgaT1lLmVsZW1lbnRXaWR0aC9lLmVsZW1lbnRIZWlnaHQsbj1lLmltYWdlQXNwZWN0L2k7bGV0IHI9MCxzPTA7cmV0dXJuIGUucmVuZGVyTW9kZT09PXQuUmVuZGVyTW9kZS5MZXR0ZXJib3g/ZS5pbWFnZUFzcGVjdD5pP3I9ZS5lbGVtZW50SGVpZ2h0KigxLTEvbikvMjpzPWUuZWxlbWVudFdpZHRoKigxLW4pLzI6ZS5pbWFnZUFzcGVjdD5pP3M9LWUuZWxlbWVudFdpZHRoKihuLTEpLzI6cj0tZS5lbGVtZW50SGVpZ2h0KigxL24tMSkvMix7Ym90dG9tOnIsbGVmdDpzLHJpZ2h0OnMsdG9wOnJ9fSkpKTtjb25zdCBvPXRoaXMuX2N1cnJlbnRGcmFtZSQucGlwZShOdCgodD0+bnVsbCE9dC5zdGF0ZS5jdXJyZW50SW1hZ2UpKSx1ZSgoKHQsZSk9PnQ9PT1lKSwodD0+dC5zdGF0ZS5jdXJyZW50SW1hZ2UuaWQpKSxydCgodD0+dC5zdGF0ZS5jdXJyZW50VHJhbnNmb3JtLmJhc2ljQXNwZWN0KSkscnQoKHQ9PmU9PihlLmltYWdlQXNwZWN0PXQsZSkpKSkuc3Vic2NyaWJlKHRoaXMuX2FkYXB0aXZlT3BlcmF0aW9uJCksYT1ndCh0aGlzLl9yZW5kZXJBZGFwdGl2ZSQucGlwZShMZSgoKHQsZSk9PihudWxsPT1lLnZOb2RlP2RlbGV0ZSB0W2UubmFtZV06dFtlLm5hbWVdPWUudk5vZGUsdCkpLHt9KSksdGhpcy5fb2Zmc2V0JCkucGlwZShydCgodD0+e2NvbnN0IGU9W10saT10WzBdO2Zvcihjb25zdCB0IGluIGkpaS5oYXNPd25Qcm9wZXJ0eSh0KSYmZS5wdXNoKGlbdF0pO2NvbnN0IG49dFsxXSxyPXtzdHlsZTp7Ym90dG9tOm4uYm90dG9tK1wicHhcIixsZWZ0Om4ubGVmdCtcInB4XCIsXCJwb2ludGVyLWV2ZW50c1wiOlwibm9uZVwiLHBvc2l0aW9uOlwiYWJzb2x1dGVcIixyaWdodDpuLnJpZ2h0K1wicHhcIix0b3A6bi50b3ArXCJweFwifX07cmV0dXJue25hbWU6XCJtYXBpbGxhcnktZG9tLWFkYXB0aXZlLXJlbmRlcmVyXCIsdk5vZGU6amYuaChcImRpdi5tYXBpbGxhcnktZG9tLWFkYXB0aXZlLXJlbmRlcmVyXCIscixlKX19KSkpLnN1YnNjcmliZSh0aGlzLl9yZW5kZXIkKTt0aGlzLl92Tm9kZSQ9dGhpcy5fcmVuZGVyJC5waXBlKExlKCgodCxlKT0+KG51bGw9PWUudk5vZGU/ZGVsZXRlIHRbZS5uYW1lXTp0W2UubmFtZV09ZS52Tm9kZSx0KSkse30pLHJ0KCh0PT57Y29uc3QgZT1bXTtmb3IoY29uc3QgaSBpbiB0KXQuaGFzT3duUHJvcGVydHkoaSkmJmUucHVzaCh0W2ldKTtyZXR1cm4gamYuaChcImRpdi5tYXBpbGxhcnktZG9tLXJlbmRlcmVyXCIsZSl9KSkpLHRoaXMuX3ZQYXRjaCQ9dGhpcy5fdk5vZGUkLnBpcGUoTGUoKCh0LGUpPT4odC52cGF0Y2g9amYuZGlmZih0LnZOb2RlLGUpLHQudk5vZGU9ZSx0KSkse3ZOb2RlOmpmLmgoXCJkaXYubWFwaWxsYXJ5LWRvbS1yZW5kZXJlclwiLFtdKSx2cGF0Y2g6bnVsbH0pLGZ1bmN0aW9uKCl7Zm9yKHZhciB0PVtdLGU9MDtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXRbZV09YXJndW1lbnRzW2VdO3ZhciBpPXQubGVuZ3RoO2lmKDA9PT1pKXRocm93IG5ldyBFcnJvcihcImxpc3Qgb2YgcHJvcGVydGllcyBjYW5ub3QgYmUgZW1wdHkuXCIpO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gcnQoamUodCxpKSkoZSl9fShcInZwYXRjaFwiKSksdGhpcy5fZWxlbWVudCQ9dGhpcy5fdlBhdGNoJC5waXBlKExlKCgodCxlKT0+amYucGF0Y2godCxlKSkscyksVWUoMSksRSgpKSxyLnB1c2gobyksci5wdXNoKGEpLHIucHVzaCh0aGlzLl9lbGVtZW50JC5zdWJzY3JpYmUoKCgpPT57fSkpKSxyLnB1c2godGhpcy5fcmVuZGVyU2VydmljZS5zaXplJC5waXBlKHJ0KCh0PT5lPT4oZS5lbGVtZW50V2lkdGg9dC53aWR0aCxlLmVsZW1lbnRIZWlnaHQ9dC5oZWlnaHQsZSkpKSkuc3Vic2NyaWJlKHRoaXMuX2FkYXB0aXZlT3BlcmF0aW9uJCkpLHIucHVzaCh0aGlzLl9yZW5kZXJTZXJ2aWNlLnJlbmRlck1vZGUkLnBpcGUocnQoKHQ9PmU9PihlLnJlbmRlck1vZGU9dCxlKSkpKS5zdWJzY3JpYmUodGhpcy5fYWRhcHRpdmVPcGVyYXRpb24kKSl9Z2V0IGVsZW1lbnQkKCl7cmV0dXJuIHRoaXMuX2VsZW1lbnQkfWdldCByZW5kZXIkKCl7cmV0dXJuIHRoaXMuX3JlbmRlciR9Z2V0IHJlbmRlckFkYXB0aXZlJCgpe3JldHVybiB0aGlzLl9yZW5kZXJBZGFwdGl2ZSR9Y2xlYXIodCl7dGhpcy5fcmVuZGVyQWRhcHRpdmUkLm5leHQoe25hbWU6dCx2Tm9kZTpudWxsfSksdGhpcy5fcmVuZGVyJC5uZXh0KHtuYW1lOnQsdk5vZGU6bnVsbH0pfXJlbW92ZSgpe3RoaXMuX3N1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKX19Y2xhc3MgZnd7Y29uc3RydWN0b3IodCxlLGkpe3RoaXMuX3JlbmRlckZyYW1lJD1uZXcgVCx0aGlzLl9yZW5kZXJDYW1lcmFPcGVyYXRpb24kPW5ldyBULHRoaXMuX3JlbmRlciQ9bmV3IFQsdGhpcy5fY2xlYXIkPW5ldyBULHRoaXMuX3JlbmRlck9wZXJhdGlvbiQ9bmV3IFQsdGhpcy5fcmVuZGVyZXJPcGVyYXRpb24kPW5ldyBULHRoaXMuX2VyYXNlck9wZXJhdGlvbiQ9bmV3IFQsdGhpcy5fdHJpZ2dlck9wZXJhdGlvbiQ9bmV3IFQsdGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fb3BhcXVlUmVuZGVyJD1uZXcgVCx0aGlzLl9yZW5kZXJTZXJ2aWNlPWk7Y29uc3Qgbj10aGlzLl9zdWJzY3JpcHRpb25zO3RoaXMuX3JlbmRlcmVyJD10aGlzLl9yZW5kZXJlck9wZXJhdGlvbiQucGlwZShMZSgoKHQsZSk9PmUodCkpLHtuZWVkc1JlbmRlcjohMSxyZW5kZXJlcjpudWxsfSksTnQoKHQ9PiEhdC5yZW5kZXJlcikpKSx0aGlzLl9yZW5kZXJDb2xsZWN0aW9uJD10aGlzLl9yZW5kZXJPcGVyYXRpb24kLnBpcGUoTGUoKCh0LGUpPT5lKHQpKSx7fSksWmUoKSksdGhpcy5fcmVuZGVyQ2FtZXJhJD10aGlzLl9yZW5kZXJDYW1lcmFPcGVyYXRpb24kLnBpcGUoTGUoKCh0LGUpPT5lKHQpKSx7ZnJhbWVJZDotMSxuZWVkc1JlbmRlcjohMSxwZXJzcGVjdGl2ZTpudWxsfSkpLHRoaXMuX2VyYXNlciQ9dGhpcy5fZXJhc2VyT3BlcmF0aW9uJC5waXBlKG5pKCh0PT50KSksTGUoKCh0LGUpPT5lKHQpKSx7bmVlZHNSZW5kZXI6ITF9KSk7Y29uc3Qgcj10aGlzLl90cmlnZ2VyT3BlcmF0aW9uJC5waXBlKG5pKCh0PT50KSksTGUoKCh0LGUpPT5lKHQpKSx7bmVlZHNSZW5kZXI6ITF9KSkscz1uZXcgRHIoOTg2ODk1KSxvPWd0KHRoaXMuX3JlbmRlcmVyJCx0aGlzLl9yZW5kZXJDb2xsZWN0aW9uJCx0aGlzLl9yZW5kZXJDYW1lcmEkLHRoaXMuX2VyYXNlciQscikucGlwZShydCgoKFt0LGUsaSxuLHJdKT0+KHtjYW1lcmE6aSxlcmFzZXI6bix0cmlnZ2VyOnIscmVuZGVyZXI6dCxyZW5kZXJzOk9iamVjdC5rZXlzKGUpLm1hcCgodD0+ZVt0XSkpfSkpKSxOdCgodD0+e2xldCBlPXQucmVuZGVyZXIubmVlZHNSZW5kZXJ8fHQuY2FtZXJhLm5lZWRzUmVuZGVyfHx0LmVyYXNlci5uZWVkc1JlbmRlcnx8dC50cmlnZ2VyLm5lZWRzUmVuZGVyO2NvbnN0IGk9dC5jYW1lcmEuZnJhbWVJZDtmb3IoY29uc3QgbiBvZiB0LnJlbmRlcnMpe2lmKG4uZnJhbWVJZCE9PWkpcmV0dXJuITE7ZT1lfHxuLm5lZWRzUmVuZGVyfXJldHVybiBlfSkpLHVlKCgodCxlKT0+dD09PWUpLCh0PT50LmVyYXNlci5uZWVkc1JlbmRlcnx8dC50cmlnZ2VyLm5lZWRzUmVuZGVyPy10LmNhbWVyYS5mcmFtZUlkOnQuY2FtZXJhLmZyYW1lSWQpKSkuc3Vic2NyaWJlKCh0PT57dC5yZW5kZXJlci5uZWVkc1JlbmRlcj0hMSx0LmNhbWVyYS5uZWVkc1JlbmRlcj0hMSx0LmVyYXNlci5uZWVkc1JlbmRlcj0hMSx0LnRyaWdnZXIubmVlZHNSZW5kZXI9ITE7Y29uc3QgZT10LmNhbWVyYS5wZXJzcGVjdGl2ZSxpPVtdLG49W107Zm9yKGNvbnN0IGUgb2YgdC5yZW5kZXJzKWUucGFzcz09PXJtLkJhY2tncm91bmQ/aS5wdXNoKGUucmVuZGVyKTplLnBhc3M9PT1ybS5PcGFxdWUmJm4ucHVzaChlLnJlbmRlcik7Y29uc3Qgcj10LnJlbmRlcmVyLnJlbmRlcmVyO3IucmVzZXRTdGF0ZSgpLHIuc2V0Q2xlYXJDb2xvcihzLDEpLHIuY2xlYXIoKTtmb3IoY29uc3QgdCBvZiBpKXQoZSxyKTtyLmNsZWFyRGVwdGgoKTtmb3IoY29uc3QgdCBvZiBuKXQoZSxyKTtyLnJlc2V0U3RhdGUoKSx0aGlzLl9vcGFxdWVSZW5kZXIkLm5leHQoKX0pKTtuLnB1c2gobyksbi5wdXNoKHRoaXMuX3JlbmRlckZyYW1lJC5waXBlKHJ0KCh0PT5lPT4oZS5mcmFtZUlkPXQuZnJhbWVJZCxlLnBlcnNwZWN0aXZlPXQucGVyc3BlY3RpdmUsITA9PT10LmNoYW5nZWQmJihlLm5lZWRzUmVuZGVyPSEwKSxlKSkpKS5zdWJzY3JpYmUodGhpcy5fcmVuZGVyQ2FtZXJhT3BlcmF0aW9uJCkpLHRoaXMuX3JlbmRlckZyYW1lU3Vic2NyaWJlKCk7Y29uc3QgYT10aGlzLl9yZW5kZXIkLnBpcGUocnQoKHQ9PmU9PihlW3QubmFtZV09dC5yZW5kZXJlcixlKSkpKSxjPXRoaXMuX2NsZWFyJC5waXBlKHJ0KCh0PT5lPT4oZGVsZXRlIGVbdF0sZSkpKSk7bi5wdXNoKE90KGEsYykuc3Vic2NyaWJlKHRoaXMuX3JlbmRlck9wZXJhdGlvbiQpKSx0aGlzLl93ZWJHTFJlbmRlcmVyJD10aGlzLl9yZW5kZXIkLnBpcGUoRWUoKSxydCgoKCk9PntlLmFwcGVuZENoaWxkKHQpO2NvbnN0IG49aS5lbGVtZW50LHI9bmV3IEphKHtjYW52YXM6dH0pO3JldHVybiByLnNldFBpeGVsUmF0aW8od2luZG93LmRldmljZVBpeGVsUmF0aW8pLHIuc2V0U2l6ZShuLm9mZnNldFdpZHRoLG4ub2Zmc2V0SGVpZ2h0KSxyLmF1dG9DbGVhcj0hMSxyfSkpLFVlKDEpLEUoKSksbi5wdXNoKHRoaXMuX3dlYkdMUmVuZGVyZXIkLnN1YnNjcmliZSgoKCk9Pnt9KSkpO2NvbnN0IGg9dGhpcy5fd2ViR0xSZW5kZXJlciQucGlwZShFZSgpLHJ0KCh0PT5lPT4oZS5uZWVkc1JlbmRlcj0hMCxlLnJlbmRlcmVyPXQsZSkpKSksbD10aGlzLl9yZW5kZXJTZXJ2aWNlLnNpemUkLnBpcGUocnQoKHQ9PmU9PihudWxsPT1lLnJlbmRlcmVyfHwoZS5yZW5kZXJlci5zZXRTaXplKHQud2lkdGgsdC5oZWlnaHQpLGUubmVlZHNSZW5kZXI9ITApLGUpKSkpLHU9dGhpcy5fY2xlYXIkLnBpcGUocnQoKCgpPT50PT4obnVsbD09dC5yZW5kZXJlcnx8KHQubmVlZHNSZW5kZXI9ITApLHQpKSkpO24ucHVzaChPdChoLGwsdSkuc3Vic2NyaWJlKHRoaXMuX3JlbmRlcmVyT3BlcmF0aW9uJCkpO2NvbnN0IGQ9dGhpcy5fcmVuZGVyQ29sbGVjdGlvbiQucGlwZShOdCgodD0+MD09PU9iamVjdC5rZXlzKHQpLmxlbmd0aCkpLFplKCkpO24ucHVzaChkLnN1YnNjcmliZSgoKCk9PntudWxsIT10aGlzLl9yZW5kZXJGcmFtZVN1YnNjcmlwdGlvbiYmKHRoaXMuX3JlbmRlckZyYW1lU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fcmVuZGVyRnJhbWVTdWJzY3JpcHRpb249bnVsbCx0aGlzLl9yZW5kZXJGcmFtZVN1YnNjcmliZSgpKX0pKSksbi5wdXNoKGQucGlwZShydCgoKCk9PnQ9Pih0Lm5lZWRzUmVuZGVyPSEwLHQpKSkpLnN1YnNjcmliZSh0aGlzLl9lcmFzZXJPcGVyYXRpb24kKSl9Z2V0IHJlbmRlciQoKXtyZXR1cm4gdGhpcy5fcmVuZGVyJH1nZXQgb3BhcXVlUmVuZGVyJCgpe3JldHVybiB0aGlzLl9vcGFxdWVSZW5kZXIkfWdldCB3ZWJHTFJlbmRlcmVyJCgpe3JldHVybiB0aGlzLl93ZWJHTFJlbmRlcmVyJH1jbGVhcih0KXt0aGlzLl9jbGVhciQubmV4dCh0KX1yZW1vdmUoKXt0aGlzLl9yZW5kZXJlck9wZXJhdGlvbiQubmV4dCgodD0+e2lmKG51bGwhPXQucmVuZGVyZXIpe2NvbnN0IGU9dC5yZW5kZXJlci5nZXRDb250ZXh0KCkuZ2V0RXh0ZW5zaW9uKFwiV0VCR0xfbG9zZV9jb250ZXh0XCIpO2UmJmUubG9zZUNvbnRleHQoKSx0LnJlbmRlcmVyPW51bGx9cmV0dXJuIHR9KSksbnVsbCE9dGhpcy5fcmVuZGVyRnJhbWVTdWJzY3JpcHRpb24mJnRoaXMuX3JlbmRlckZyYW1lU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfXRyaWdnZXJSZXJlbmRlcigpe3RoaXMuX3JlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhRnJhbWUkLnBpcGUoSmUoMSksRWUoKSkuc3Vic2NyaWJlKCgoKT0+e3RoaXMuX3RyaWdnZXJPcGVyYXRpb24kLm5leHQoKHQ9Pih0Lm5lZWRzUmVuZGVyPSEwLHQpKSl9KSl9X3JlbmRlckZyYW1lU3Vic2NyaWJlKCl7dGhpcy5fcmVuZGVyJC5waXBlKEVlKCkscnQoKCgpPT50PT4odC5uZWVkc1JlbmRlcj0hMCx0KSkpKS5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9yZW5kZXJDYW1lcmFPcGVyYXRpb24kLm5leHQodCl9KSksdGhpcy5fcmVuZGVyRnJhbWVTdWJzY3JpcHRpb249dGhpcy5fcmVuZGVyJC5waXBlKEVlKCksTXQoKCgpPT50aGlzLl9yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYUZyYW1lJCkpKS5zdWJzY3JpYmUodGhpcy5fcmVuZGVyRnJhbWUkKX19Y2xhc3MgbXd7Y29uc3RydWN0b3IodCxlLGkpe3RoaXMuX3NwYXRpYWw9bmV3IGxkLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPW5ldyBXZix0aGlzLl9zaXplPXt3aWR0aDp0LGhlaWdodDplfSx0aGlzLl9pbml0aWFsRm92PTYwLHRoaXMuX2FscGhhPS0xLHRoaXMuX3JlbmRlck1vZGU9aSx0aGlzLl96b29tPTAsdGhpcy5fZnJhbWVJZD0tMSx0aGlzLl9jaGFuZ2VkPSExLHRoaXMuX2NoYW5nZWRGb3JGcmFtZT0tMSx0aGlzLl9jdXJyZW50SW1hZ2VJZD1udWxsLHRoaXMuX3ByZXZpb3VzSW1hZ2VJZD1udWxsLHRoaXMuX2N1cnJlbnRTcGhlcmljYWw9ITEsdGhpcy5fcHJldmlvdXNTcGhlcmljYWw9ITEsdGhpcy5fc3RhdGU9bnVsbCx0aGlzLl9jdXJyZW50UHJvamVjdGVkUG9pbnRzPVtdLHRoaXMuX3ByZXZpb3VzUHJvamVjdGVkUG9pbnRzPVtdLHRoaXMuX2N1cnJlbnRGb3Y9dGhpcy5faW5pdGlhbEZvdix0aGlzLl9wcmV2aW91c0Zvdj10aGlzLl9pbml0aWFsRm92LHRoaXMuX2NhbWVyYT1uZXcgamQsdGhpcy5fcGVyc3BlY3RpdmU9bmV3IERzKHRoaXMuX2luaXRpYWxGb3YsdGhpcy5fY29tcHV0ZUFzcGVjdCh0LGUpLC4xNiwxZTQpLHRoaXMuX3BlcnNwZWN0aXZlLnBvc2l0aW9uLmNvcHkodGhpcy5fY2FtZXJhLnBvc2l0aW9uKSx0aGlzLl9wZXJzcGVjdGl2ZS51cC5jb3B5KHRoaXMuX2NhbWVyYS51cCksdGhpcy5fcGVyc3BlY3RpdmUubG9va0F0KHRoaXMuX2NhbWVyYS5sb29rYXQpLHRoaXMuX3BlcnNwZWN0aXZlLnVwZGF0ZU1hdHJpeFdvcmxkKCEwKSx0aGlzLl9wZXJzcGVjdGl2ZS5tYXRyaXhBdXRvVXBkYXRlPSExLHRoaXMuX3JvdGF0aW9uPXtwaGk6MCx0aGV0YTowfX1nZXQgYWxwaGEoKXtyZXR1cm4gdGhpcy5fYWxwaGF9Z2V0IGNhbWVyYSgpe3JldHVybiB0aGlzLl9jYW1lcmF9Z2V0IGNoYW5nZWQoKXtyZXR1cm4gdGhpcy5fZnJhbWVJZD09PXRoaXMuX2NoYW5nZWRGb3JGcmFtZX1nZXQgZnJhbWVJZCgpe3JldHVybiB0aGlzLl9mcmFtZUlkfWdldCBwZXJzcGVjdGl2ZSgpe3JldHVybiB0aGlzLl9wZXJzcGVjdGl2ZX1nZXQgcmVuZGVyTW9kZSgpe3JldHVybiB0aGlzLl9yZW5kZXJNb2RlfWdldCByb3RhdGlvbigpe3JldHVybiB0aGlzLl9yb3RhdGlvbn1nZXQgem9vbSgpe3JldHVybiB0aGlzLl96b29tfWdldCBzaXplKCl7cmV0dXJuIHRoaXMuX3NpemV9Z2V0VGlsdCgpe3JldHVybiA5MC10aGlzLl9zcGF0aWFsLnJhZFRvRGVnKHRoaXMuX3JvdGF0aW9uLnRoZXRhKX1mb3ZUb1pvb20odCl7dD1NYXRoLm1pbig5MCxNYXRoLm1heCgwLHQpKTtjb25zdCBlPXRoaXMuX2NvbXB1dGVDdXJyZW50Rm92KDApLGk9MT09PXRoaXMuX2FscGhhP2U6dGhpcy5faW50ZXJwb2xhdGVGb3YoZSx0aGlzLl9jb21wdXRlUHJldmlvdXNGb3YoMCksdGhpcy5fYWxwaGEpLG49TWF0aC50YW4oaS8yKk1hdGguUEkvMTgwKSxyPU1hdGgudGFuKHQvMipNYXRoLlBJLzE4MCk7cmV0dXJuIE1hdGgubG9nKG4vcikvTWF0aC5sb2coMil9c2V0RnJhbWUodCl7Y29uc3QgZT10LnN0YXRlO2Uuc3RhdGUhPT10aGlzLl9zdGF0ZSYmKHRoaXMuX3N0YXRlPWUuc3RhdGUsdGhpcy5fc3RhdGUhPT12bS5DdXN0b20mJih0aGlzLnNldFJlbmRlck1vZGUodGhpcy5fcmVuZGVyTW9kZSksdGhpcy5zZXRTaXplKHRoaXMuX3NpemUpKSx0aGlzLl9jaGFuZ2VkPSEwKTtjb25zdCBpPWUuY3VycmVudEltYWdlLmlkLG49ZS5wcmV2aW91c0ltYWdlP2UucHJldmlvdXNJbWFnZS5pZDpudWxsO2khPT10aGlzLl9jdXJyZW50SW1hZ2VJZCYmKHRoaXMuX2N1cnJlbnRJbWFnZUlkPWksdGhpcy5fY3VycmVudFNwaGVyaWNhbD1kZChlLmN1cnJlbnRUcmFuc2Zvcm0uY2FtZXJhVHlwZSksdGhpcy5fY3VycmVudFByb2plY3RlZFBvaW50cz10aGlzLl9jb21wdXRlUHJvamVjdGVkUG9pbnRzKGUuY3VycmVudFRyYW5zZm9ybSksdGhpcy5fY2hhbmdlZD0hMCksbiE9PXRoaXMuX3ByZXZpb3VzSW1hZ2VJZCYmKHRoaXMuX3ByZXZpb3VzSW1hZ2VJZD1uLHRoaXMuX3ByZXZpb3VzU3BoZXJpY2FsPWRkKGUucHJldmlvdXNUcmFuc2Zvcm0uY2FtZXJhVHlwZSksdGhpcy5fcHJldmlvdXNQcm9qZWN0ZWRQb2ludHM9dGhpcy5fY29tcHV0ZVByb2plY3RlZFBvaW50cyhlLnByZXZpb3VzVHJhbnNmb3JtKSx0aGlzLl9jaGFuZ2VkPSEwKTtjb25zdCByPWUuem9vbTtyIT09dGhpcy5fem9vbSYmKHRoaXMuX3pvb209cix0aGlzLl9jaGFuZ2VkPSEwKSx0aGlzLl9jaGFuZ2VkJiYodGhpcy5fY3VycmVudEZvdj10aGlzLl9jb21wdXRlQ3VycmVudEZvdih0aGlzLnpvb20pLHRoaXMuX3ByZXZpb3VzRm92PXRoaXMuX2NvbXB1dGVQcmV2aW91c0Zvdih0aGlzLl96b29tKSk7Y29uc3Qgcz1lLmFscGhhO2lmKHRoaXMuX2NoYW5nZWR8fHMhPT10aGlzLl9hbHBoYSl7c3dpdGNoKHRoaXMuX2FscGhhPXMsdGhpcy5fc3RhdGUpe2Nhc2Ugdm0uRWFydGg6dGhpcy5fcGVyc3BlY3RpdmUuZm92PTYwLHRoaXMuX2NoYW5nZWQ9ITA7YnJlYWs7Y2FzZSB2bS5DdXN0b206YnJlYWs7ZGVmYXVsdDp0aGlzLl9wZXJzcGVjdGl2ZS5mb3Y9dGhpcy5faW50ZXJwb2xhdGVGb3YodGhpcy5fY3VycmVudEZvdix0aGlzLl9wcmV2aW91c0Zvdix0aGlzLl9hbHBoYSksdGhpcy5fY2hhbmdlZD0hMH10aGlzLl9zdGF0ZSE9PXZtLkN1c3RvbSYmdGhpcy5fcGVyc3BlY3RpdmUudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpfWNvbnN0IG89ZS5jYW1lcmE7dGhpcy5fY2FtZXJhLmRpZmYobyk+MWUtOSYmKHRoaXMuX2NhbWVyYS5jb3B5KG8pLHRoaXMuX3JvdGF0aW9uPXRoaXMuX2NvbXB1dGVSb3RhdGlvbihvKSx0aGlzLl9wZXJzcGVjdGl2ZS51cC5jb3B5KG8udXApLHRoaXMuX3BlcnNwZWN0aXZlLnBvc2l0aW9uLmNvcHkoby5wb3NpdGlvbiksdGhpcy5fcGVyc3BlY3RpdmUubWF0cml4QXV0b1VwZGF0ZT0hMCx0aGlzLl9wZXJzcGVjdGl2ZS5sb29rQXQoby5sb29rYXQpLHRoaXMuX3BlcnNwZWN0aXZlLm1hdHJpeEF1dG9VcGRhdGU9ITEsdGhpcy5fcGVyc3BlY3RpdmUudXBkYXRlTWF0cml4KCksdGhpcy5fcGVyc3BlY3RpdmUudXBkYXRlTWF0cml4V29ybGQoITEpLHRoaXMuX2NoYW5nZWQ9ITApLHRoaXMuX3NldEZyYW1lSWQodC5pZCl9c2V0UHJvamVjdGlvbk1hdHJpeCh0KXt0aGlzLl9wZXJzcGVjdGl2ZS5wcm9qZWN0aW9uTWF0cml4LmZyb21BcnJheSh0KSx0aGlzLl9wZXJzcGVjdGl2ZS5wcm9qZWN0aW9uTWF0cml4SW52ZXJzZS5jb3B5KHRoaXMuX3BlcnNwZWN0aXZlLnByb2plY3Rpb25NYXRyaXgpLmludmVydCgpLHRoaXMuX2NoYW5nZWQ9ITB9c2V0UmVuZGVyTW9kZSh0KXt0aGlzLl9yZW5kZXJNb2RlPXQsdGhpcy5fc3RhdGUhPT12bS5DdXN0b20mJih0aGlzLl9wZXJzcGVjdGl2ZS5mb3Y9dGhpcy5fY29tcHV0ZUZvdigpLHRoaXMuX3BlcnNwZWN0aXZlLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKSx0aGlzLl9jaGFuZ2VkPSEwKX1zZXRTaXplKHQpe3RoaXMuX3NpemU9dCx0aGlzLl9zdGF0ZSE9PXZtLkN1c3RvbSYmKHRoaXMuX3BlcnNwZWN0aXZlLmFzcGVjdD10aGlzLl9jb21wdXRlQXNwZWN0KHQud2lkdGgsdC5oZWlnaHQpLHRoaXMuX3BlcnNwZWN0aXZlLmZvdj10aGlzLl9jb21wdXRlRm92KCksdGhpcy5fcGVyc3BlY3RpdmUudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpLHRoaXMuX2NoYW5nZWQ9ITApfV9jb21wdXRlQXNwZWN0KHQsZSl7cmV0dXJuIDA9PT10PzA6dC9lfV9jb21wdXRlQ3VycmVudEZvdih0KXtyZXR1cm4gMD09PXRoaXMuX3BlcnNwZWN0aXZlLmFzcGVjdD8wOnRoaXMuX2N1cnJlbnRJbWFnZUlkP3RoaXMuX2N1cnJlbnRTcGhlcmljYWw/dGhpcy5feVRvRm92KDEsdCk6dGhpcy5fY29tcHV0ZVZlcnRpY2FsRm92KHRoaXMuX2N1cnJlbnRQcm9qZWN0ZWRQb2ludHMsdGhpcy5fcmVuZGVyTW9kZSx0LHRoaXMucGVyc3BlY3RpdmUuYXNwZWN0KTp0aGlzLl9pbml0aWFsRm92fV9jb21wdXRlRm92KCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRGb3Y9dGhpcy5fY29tcHV0ZUN1cnJlbnRGb3YodGhpcy5fem9vbSksdGhpcy5fcHJldmlvdXNGb3Y9dGhpcy5fY29tcHV0ZVByZXZpb3VzRm92KHRoaXMuX3pvb20pLHRoaXMuX2ludGVycG9sYXRlRm92KHRoaXMuX2N1cnJlbnRGb3YsdGhpcy5fcHJldmlvdXNGb3YsdGhpcy5fYWxwaGEpfV9jb21wdXRlUHJldmlvdXNGb3YodCl7cmV0dXJuIDA9PT10aGlzLl9wZXJzcGVjdGl2ZS5hc3BlY3Q/MDp0aGlzLl9jdXJyZW50SW1hZ2VJZD90aGlzLl9wcmV2aW91c0ltYWdlSWQ/dGhpcy5fcHJldmlvdXNTcGhlcmljYWw/dGhpcy5feVRvRm92KDEsdCk6dGhpcy5fY29tcHV0ZVZlcnRpY2FsRm92KHRoaXMuX3ByZXZpb3VzUHJvamVjdGVkUG9pbnRzLHRoaXMuX3JlbmRlck1vZGUsdCx0aGlzLnBlcnNwZWN0aXZlLmFzcGVjdCk6dGhpcy5fY3VycmVudEZvdjp0aGlzLl9pbml0aWFsRm92fV9jb21wdXRlUHJvamVjdGVkUG9pbnRzKHQpe3JldHVybiBtZCh0LFtbLjUsMF0sWzEsMF1dLFtbLjUsMF0sWzAsLjVdXSwxMDAsdGhpcy5fdmlld3BvcnRDb29yZHMpfV9jb21wdXRlUmVxdWlyZWRWZXJ0aWNhbEZvdih0LGUsaSl7Y29uc3Qgbj1NYXRoLm1heCh0WzBdL2ksdFsxXSk7cmV0dXJuIHRoaXMuX3lUb0ZvdihuLGUpfV9jb21wdXRlUm90YXRpb24odCl7bGV0IGU9dC5sb29rYXQuY2xvbmUoKS5zdWIodC5wb3NpdGlvbiksaT10LnVwLmNsb25lKCk7cmV0dXJue3BoaTp0aGlzLl9zcGF0aWFsLmF6aW11dGhhbChlLnRvQXJyYXkoKSxpLnRvQXJyYXkoKSksdGhldGE6TWF0aC5QSS8yLXRoaXMuX3NwYXRpYWwuYW5nbGVUb1BsYW5lKGUudG9BcnJheSgpLFswLDAsMV0pfX1fY29tcHV0ZVZlcnRpY2FsRm92KGUsaSxuLHIpe2NvbnN0IHM9ZS5tYXAoKHQ9PnRoaXMuX2NvbXB1dGVSZXF1aXJlZFZlcnRpY2FsRm92KHQsbixyKSkpO3JldHVybiBpPT09dC5SZW5kZXJNb2RlLkZpbGw/Ljk5NSpNYXRoLm1pbiguLi5zKTpNYXRoLm1heCguLi5zKX1feVRvRm92KHQsZSl7cmV0dXJuIDIqTWF0aC5hdGFuKHQvTWF0aC5wb3coMixlKSkqMTgwL01hdGguUEl9X2ludGVycG9sYXRlRm92KHQsZSxpKXtyZXR1cm4gaSp0KygxLWkpKmV9X3NldEZyYW1lSWQodCl7dGhpcy5fZnJhbWVJZD10LHRoaXMuX2NoYW5nZWQmJih0aGlzLl9jaGFuZ2VkPSExLHRoaXMuX2NoYW5nZWRGb3JGcmFtZT10KX19Y2xhc3MgZ3d7Y29uc3RydWN0b3IoZSxpLG4scil7dGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fZWxlbWVudD1lLHRoaXMuX2N1cnJlbnRGcmFtZSQ9aSx0aGlzLl9zcGF0aWFsPW5ldyBsZCxuPW51bGwhPW4/bjp0LlJlbmRlck1vZGUuRmlsbCx0aGlzLl9yZXNpemUkPW5ldyBULHRoaXMuX3Byb2plY3Rpb25NYXRyaXgkPW5ldyBULHRoaXMuX3JlbmRlckNhbWVyYU9wZXJhdGlvbiQ9bmV3IFQsdGhpcy5fc2l6ZSQ9bmV3IE8oe2hlaWdodDp0aGlzLl9lbGVtZW50Lm9mZnNldEhlaWdodCx3aWR0aDp0aGlzLl9lbGVtZW50Lm9mZnNldFdpZHRofSk7Y29uc3Qgcz10aGlzLl9zdWJzY3JpcHRpb25zO3MucHVzaCh0aGlzLl9yZXNpemUkLnBpcGUocnQoKCgpPT4oe2hlaWdodDp0aGlzLl9lbGVtZW50Lm9mZnNldEhlaWdodCx3aWR0aDp0aGlzLl9lbGVtZW50Lm9mZnNldFdpZHRofSkpKSkuc3Vic2NyaWJlKHRoaXMuX3NpemUkKSksdGhpcy5fcmVuZGVyTW9kZSQ9bmV3IE8obiksdGhpcy5fcmVuZGVyQ2FtZXJhSG9sZGVyJD10aGlzLl9yZW5kZXJDYW1lcmFPcGVyYXRpb24kLnBpcGUobmkoKHQ9PnQpKSxMZSgoKHQsZSk9PmUodCkpLG51bGwhPXI/cjpuZXcgbXcodGhpcy5fZWxlbWVudC5vZmZzZXRXaWR0aCx0aGlzLl9lbGVtZW50Lm9mZnNldEhlaWdodCxuKSksVWUoMSksRSgpKSx0aGlzLl9yZW5kZXJDYW1lcmFGcmFtZSQ9dGhpcy5fY3VycmVudEZyYW1lJC5waXBlKGJpKHRoaXMuX3JlbmRlckNhbWVyYUhvbGRlciQpLHBpKCgoW3QsZV0pPT57ZS5zZXRGcmFtZSh0KX0pKSxydCgodD0+dFsxXSkpLFVlKDEpLEUoKSksdGhpcy5fcmVuZGVyQ2FtZXJhJD10aGlzLl9yZW5kZXJDYW1lcmFGcmFtZSQucGlwZShOdCgodD0+dC5jaGFuZ2VkKSksVWUoMSksRSgpKSx0aGlzLl9iZWFyaW5nJD10aGlzLl9yZW5kZXJDYW1lcmEkLnBpcGUocnQoKHQ9PntsZXQgZT10aGlzLl9zcGF0aWFsLnJhZFRvRGVnKHRoaXMuX3NwYXRpYWwuYXppbXV0aGFsVG9CZWFyaW5nKHQucm90YXRpb24ucGhpKSk7cmV0dXJuIHRoaXMuX3NwYXRpYWwud3JhcChlLDAsMzYwKX0pKSxVZSgxKSxFKCkpLHMucHVzaCh0aGlzLl9zaXplJC5waXBlKEplKDEpLHJ0KCh0PT5lPT4oZS5zZXRTaXplKHQpLGUpKSkpLnN1YnNjcmliZSh0aGlzLl9yZW5kZXJDYW1lcmFPcGVyYXRpb24kKSkscy5wdXNoKHRoaXMuX3JlbmRlck1vZGUkLnBpcGUoSmUoMSkscnQoKHQ9PmU9PihlLnNldFJlbmRlck1vZGUodCksZSkpKSkuc3Vic2NyaWJlKHRoaXMuX3JlbmRlckNhbWVyYU9wZXJhdGlvbiQpKSxzLnB1c2godGhpcy5fcHJvamVjdGlvbk1hdHJpeCQucGlwZShydCgodD0+ZT0+KGUuc2V0UHJvamVjdGlvbk1hdHJpeCh0KSxlKSkpKS5zdWJzY3JpYmUodGhpcy5fcmVuZGVyQ2FtZXJhT3BlcmF0aW9uJCkpLHMucHVzaCh0aGlzLl9iZWFyaW5nJC5zdWJzY3JpYmUoKCgpPT57fSkpKSxzLnB1c2godGhpcy5fcmVuZGVyQ2FtZXJhSG9sZGVyJC5zdWJzY3JpYmUoKCgpPT57fSkpKSxzLnB1c2godGhpcy5fc2l6ZSQuc3Vic2NyaWJlKCgoKT0+e30pKSkscy5wdXNoKHRoaXMuX3JlbmRlck1vZGUkLnN1YnNjcmliZSgoKCk9Pnt9KSkpLHMucHVzaCh0aGlzLl9yZW5kZXJDYW1lcmEkLnN1YnNjcmliZSgoKCk9Pnt9KSkpLHMucHVzaCh0aGlzLl9yZW5kZXJDYW1lcmFGcmFtZSQuc3Vic2NyaWJlKCgoKT0+e30pKSl9Z2V0IGJlYXJpbmckKCl7cmV0dXJuIHRoaXMuX2JlYXJpbmckfWdldCBlbGVtZW50KCl7cmV0dXJuIHRoaXMuX2VsZW1lbnR9Z2V0IHByb2plY3Rpb25NYXRyaXgkKCl7cmV0dXJuIHRoaXMuX3Byb2plY3Rpb25NYXRyaXgkfWdldCByZW5kZXJDYW1lcmEkKCl7cmV0dXJuIHRoaXMuX3JlbmRlckNhbWVyYSR9Z2V0IHJlbmRlckNhbWVyYUZyYW1lJCgpe3JldHVybiB0aGlzLl9yZW5kZXJDYW1lcmFGcmFtZSR9Z2V0IHJlbmRlck1vZGUkKCl7cmV0dXJuIHRoaXMuX3JlbmRlck1vZGUkfWdldCByZXNpemUkKCl7cmV0dXJuIHRoaXMuX3Jlc2l6ZSR9Z2V0IHNpemUkKCl7cmV0dXJuIHRoaXMuX3NpemUkfWRpc3Bvc2UoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9fWNsYXNzIF93e2NvbnN0cnVjdG9yKHQpe3RoaXMuX2tleURvd24kPVB0KHQsXCJrZXlkb3duXCIpLHRoaXMuX2tleVVwJD1QdCh0LFwia2V5dXBcIil9Z2V0IGtleURvd24kKCl7cmV0dXJuIHRoaXMuX2tleURvd24kfWdldCBrZXlVcCQoKXtyZXR1cm4gdGhpcy5fa2V5VXAkfX1jb25zdCB2dz17MDoxLDI6Mn07Y2xhc3MgeXd7Y29uc3RydWN0b3IodCxlLGksbil7dGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWY7Y29uc3Qgcj10aGlzLl9zdWJzY3JpcHRpb25zO3RoaXMuX2FjdGl2ZVN1YmplY3QkPW5ldyBPKCExKSx0aGlzLl9hY3RpdmUkPXRoaXMuX2FjdGl2ZVN1YmplY3QkLnBpcGUodWUoKSxVZSgxKSxFKCkpLHRoaXMuX2NsYWltTW91c2UkPW5ldyBULHRoaXMuX2NsYWltV2hlZWwkPW5ldyBULHRoaXMuX2RlZmVyUGl4ZWxDbGFpbXMkPW5ldyBULHRoaXMuX2RlZmVyUGl4ZWxzJD10aGlzLl9kZWZlclBpeGVsQ2xhaW1zJC5waXBlKExlKCgodCxlKT0+KG51bGw9PWUuZGVmZXJQaXhlbHM/ZGVsZXRlIHRbZS5uYW1lXTp0W2UubmFtZV09ZS5kZWZlclBpeGVscyx0KSkse30pLHJ0KCh0PT57bGV0IGU9LTE7Zm9yKGNvbnN0IGkgaW4gdCl7aWYoIXQuaGFzT3duUHJvcGVydHkoaSkpY29udGludWU7Y29uc3Qgbj10W2ldO24+ZSYmKGU9bil9cmV0dXJuIGV9KSksbmkoLTEpLFVlKDEpLEUoKSksci5wdXNoKHRoaXMuX2RlZmVyUGl4ZWxzJC5zdWJzY3JpYmUoKCgpPT57fSkpKSx0aGlzLl9kb2N1bWVudE1vdXNlTW92ZSQ9UHQobixcInBvaW50ZXJtb3ZlXCIpLnBpcGUoTnQodGhpcy5faXNNb3VzZVBlbikpLHRoaXMuX2RvY3VtZW50TW91c2VVcCQ9UHQobixcInBvaW50ZXJ1cFwiKS5waXBlKE50KHRoaXMuX2lzTW91c2VQZW4pKSx0aGlzLl9tb3VzZURvd24kPVB0KGUsXCJwb2ludGVyZG93blwiKS5waXBlKE50KHRoaXMuX2lzTW91c2VQZW4pKSx0aGlzLl9tb3VzZUVudGVyJD1QdChlLFwicG9pbnRlcmVudGVyXCIpLnBpcGUoTnQodGhpcy5faXNNb3VzZVBlbikpLHRoaXMuX21vdXNlTGVhdmUkPVB0KGUsXCJwb2ludGVybGVhdmVcIikucGlwZShOdCh0aGlzLl9pc01vdXNlUGVuKSksdGhpcy5fbW91c2VNb3ZlJD1QdChlLFwicG9pbnRlcm1vdmVcIikucGlwZShOdCh0aGlzLl9pc01vdXNlUGVuKSksdGhpcy5fbW91c2VVcCQ9UHQoZSxcInBvaW50ZXJ1cFwiKS5waXBlKE50KHRoaXMuX2lzTW91c2VQZW4pKSx0aGlzLl9tb3VzZU91dCQ9UHQoZSxcInBvaW50ZXJvdXRcIikucGlwZShOdCh0aGlzLl9pc01vdXNlUGVuKSksdGhpcy5fbW91c2VPdmVyJD1QdChlLFwicG9pbnRlcm92ZXJcIikucGlwZShOdCh0aGlzLl9pc01vdXNlUGVuKSksdGhpcy5fZG9tTW91c2VEb3duJD1QdChpLFwicG9pbnRlcmRvd25cIikucGlwZShOdCh0aGlzLl9pc01vdXNlUGVuKSksdGhpcy5fZG9tTW91c2VNb3ZlJD1QdChpLFwicG9pbnRlcm1vdmVcIikucGlwZShOdCh0aGlzLl9pc01vdXNlUGVuKSksdGhpcy5fY2xpY2skPVB0KGUsXCJjbGlja1wiKSx0aGlzLl9jb250ZXh0TWVudSQ9UHQoZSxcImNvbnRleHRtZW51XCIpLHRoaXMuX3dpbmRvd0JsdXIkPVB0KHdpbmRvdyxcImJsdXJcIiksdGhpcy5fZGJsQ2xpY2skPU90KFB0KHQsXCJjbGlja1wiKSxQdChlLFwiZGJsY2xpY2tcIikpLnBpcGUoWHQoMywxKSxOdCgodD0+e2NvbnN0IGk9dFswXSxuPXRbMV0scj10WzJdO3JldHVyblwiY2xpY2tcIj09PWkudHlwZSYmXCJjbGlja1wiPT09bi50eXBlJiZcImRibGNsaWNrXCI9PT1yLnR5cGUmJmkudGFyZ2V0LnBhcmVudE5vZGU9PT1lJiZuLnRhcmdldC5wYXJlbnROb2RlPT09ZX0pKSxydCgodD0+dFsyXSkpLFplKCkpLHIucHVzaChPdCh0aGlzLl9kb21Nb3VzZURvd24kLHRoaXMuX2RvbU1vdXNlTW92ZSQsdGhpcy5fZGJsQ2xpY2skLHRoaXMuX2NvbnRleHRNZW51JCkuc3Vic2NyaWJlKCh0PT57dC5wcmV2ZW50RGVmYXVsdCgpfSkpKSx0aGlzLl9tb3VzZVdoZWVsJD1PdChQdChlLFwid2hlZWxcIiksUHQoaSxcIndoZWVsXCIpKS5waXBlKFplKCkpLHRoaXMuX2NvbnNpc3RlbnRDb250ZXh0TWVudSQ9T3QodGhpcy5fbW91c2VEb3duJCx0aGlzLl9tb3VzZU1vdmUkLHRoaXMuX21vdXNlT3V0JCx0aGlzLl9tb3VzZVVwJCx0aGlzLl9jb250ZXh0TWVudSQpLnBpcGUoWHQoMywxKSxOdCgodD0+XCJwb2ludGVyZG93blwiPT09dFswXS50eXBlJiZcImNvbnRleHRtZW51XCI9PT10WzFdLnR5cGUmJlwicG9pbnRlcnVwXCI9PT10WzJdLnR5cGUpKSxydCgodD0+dFsxXSkpLFplKCkpO2NvbnN0IHM9T3QodGhpcy5fd2luZG93Qmx1ciQsdGhpcy5fZG9jdW1lbnRNb3VzZU1vdmUkLnBpcGUoTnQoKHQ9PnRoaXMuX2J1dHRvblJlbGVhc2VkKHQsMCkpKSksdGhpcy5fZG9jdW1lbnRNb3VzZVVwJC5waXBlKE50KCh0PT4wPT09dGhpcy5fbW91c2VCdXR0b24odCkpKSkpLnBpcGUoWmUoKSksbz10aGlzLl9jcmVhdGVNb3VzZURyYWdJbml0aWF0ZSQoMCx0aGlzLl9tb3VzZURvd24kLHMsITApLnBpcGUoWmUoKSk7dGhpcy5fbW91c2VEcmFnU3RhcnQkPXRoaXMuX2NyZWF0ZU1vdXNlRHJhZ1N0YXJ0JChvKS5waXBlKFplKCkpLHRoaXMuX21vdXNlRHJhZyQ9dGhpcy5fY3JlYXRlTW91c2VEcmFnJChvLHMpLnBpcGUoWmUoKSksdGhpcy5fbW91c2VEcmFnRW5kJD10aGlzLl9jcmVhdGVNb3VzZURyYWdFbmQkKHRoaXMuX21vdXNlRHJhZ1N0YXJ0JCxzKS5waXBlKFplKCkpO2NvbnN0IGE9dGhpcy5fY3JlYXRlTW91c2VEcmFnSW5pdGlhdGUkKDAsdGhpcy5fZG9tTW91c2VEb3duJCxzLCExKS5waXBlKFplKCkpO3RoaXMuX2RvbU1vdXNlRHJhZ1N0YXJ0JD10aGlzLl9jcmVhdGVNb3VzZURyYWdTdGFydCQoYSkucGlwZShaZSgpKSx0aGlzLl9kb21Nb3VzZURyYWckPXRoaXMuX2NyZWF0ZU1vdXNlRHJhZyQoYSxzKS5waXBlKFplKCkpLHRoaXMuX2RvbU1vdXNlRHJhZ0VuZCQ9dGhpcy5fY3JlYXRlTW91c2VEcmFnRW5kJCh0aGlzLl9kb21Nb3VzZURyYWdTdGFydCQscykucGlwZShaZSgpKTtjb25zdCBjPU90KHRoaXMuX3dpbmRvd0JsdXIkLHRoaXMuX2RvY3VtZW50TW91c2VNb3ZlJC5waXBlKE50KCh0PT50aGlzLl9idXR0b25SZWxlYXNlZCh0LDIpKSkpLHRoaXMuX2RvY3VtZW50TW91c2VVcCQucGlwZShOdCgodD0+Mj09PXRoaXMuX21vdXNlQnV0dG9uKHQpKSkpKS5waXBlKFplKCkpLGg9dGhpcy5fY3JlYXRlTW91c2VEcmFnSW5pdGlhdGUkKDIsdGhpcy5fbW91c2VEb3duJCxjLCEwKS5waXBlKFplKCkpO3RoaXMuX21vdXNlUmlnaHREcmFnU3RhcnQkPXRoaXMuX2NyZWF0ZU1vdXNlRHJhZ1N0YXJ0JChoKS5waXBlKFplKCkpLHRoaXMuX21vdXNlUmlnaHREcmFnJD10aGlzLl9jcmVhdGVNb3VzZURyYWckKGgsYykucGlwZShaZSgpKSx0aGlzLl9tb3VzZVJpZ2h0RHJhZ0VuZCQ9dGhpcy5fY3JlYXRlTW91c2VEcmFnRW5kJCh0aGlzLl9tb3VzZVJpZ2h0RHJhZ1N0YXJ0JCxjKS5waXBlKFplKCkpLHRoaXMuX3Byb3hpbWF0ZUNsaWNrJD10aGlzLl9tb3VzZURvd24kLnBpcGUocmkoKHQ9PnRoaXMuX2NsaWNrJC5waXBlKGFpKHRoaXMuX2NyZWF0ZURlZmVycmVkTW91c2VNb3ZlJCh0LHRoaXMuX2RvY3VtZW50TW91c2VNb3ZlJCkpLHZlKDEpKSkpLFplKCkpLHRoaXMuX3N0YXRpY0NsaWNrJD10aGlzLl9tb3VzZURvd24kLnBpcGUocmkoKCgpPT50aGlzLl9jbGljayQucGlwZShhaSh0aGlzLl9kb2N1bWVudE1vdXNlTW92ZSQpLHZlKDEpKSkpLFplKCkpLHIucHVzaCh0aGlzLl9tb3VzZURyYWdTdGFydCQuc3Vic2NyaWJlKCkpLHIucHVzaCh0aGlzLl9tb3VzZURyYWckLnN1YnNjcmliZSgpKSxyLnB1c2godGhpcy5fbW91c2VEcmFnRW5kJC5zdWJzY3JpYmUoKSksci5wdXNoKHRoaXMuX2RvbU1vdXNlRHJhZ1N0YXJ0JC5zdWJzY3JpYmUoKSksci5wdXNoKHRoaXMuX2RvbU1vdXNlRHJhZyQuc3Vic2NyaWJlKCkpLHIucHVzaCh0aGlzLl9kb21Nb3VzZURyYWdFbmQkLnN1YnNjcmliZSgpKSxyLnB1c2godGhpcy5fbW91c2VSaWdodERyYWdTdGFydCQuc3Vic2NyaWJlKCkpLHIucHVzaCh0aGlzLl9tb3VzZVJpZ2h0RHJhZyQuc3Vic2NyaWJlKCkpLHIucHVzaCh0aGlzLl9tb3VzZVJpZ2h0RHJhZ0VuZCQuc3Vic2NyaWJlKCkpLHIucHVzaCh0aGlzLl9zdGF0aWNDbGljayQuc3Vic2NyaWJlKCkpLHRoaXMuX21vdXNlT3duZXIkPXRoaXMuX2NyZWF0ZU93bmVyJCh0aGlzLl9jbGFpbU1vdXNlJCkucGlwZShVZSgxKSxFKCkpLHRoaXMuX3doZWVsT3duZXIkPXRoaXMuX2NyZWF0ZU93bmVyJCh0aGlzLl9jbGFpbVdoZWVsJCkucGlwZShVZSgxKSxFKCkpLHIucHVzaCh0aGlzLl9tb3VzZU93bmVyJC5zdWJzY3JpYmUoKCgpPT57fSkpKSxyLnB1c2godGhpcy5fd2hlZWxPd25lciQuc3Vic2NyaWJlKCgoKT0+e30pKSl9Z2V0IGFjdGl2ZSQoKXtyZXR1cm4gdGhpcy5fYWN0aXZlJH1nZXQgYWN0aXZhdGUkKCl7cmV0dXJuIHRoaXMuX2FjdGl2ZVN1YmplY3QkfWdldCBkb2N1bWVudE1vdXNlTW92ZSQoKXtyZXR1cm4gdGhpcy5fZG9jdW1lbnRNb3VzZU1vdmUkfWdldCBkb2N1bWVudE1vdXNlVXAkKCl7cmV0dXJuIHRoaXMuX2RvY3VtZW50TW91c2VVcCR9Z2V0IGRvbU1vdXNlRHJhZ1N0YXJ0JCgpe3JldHVybiB0aGlzLl9kb21Nb3VzZURyYWdTdGFydCR9Z2V0IGRvbU1vdXNlRHJhZyQoKXtyZXR1cm4gdGhpcy5fZG9tTW91c2VEcmFnJH1nZXQgZG9tTW91c2VEcmFnRW5kJCgpe3JldHVybiB0aGlzLl9kb21Nb3VzZURyYWdFbmQkfWdldCBkb21Nb3VzZURvd24kKCl7cmV0dXJuIHRoaXMuX2RvbU1vdXNlRG93biR9Z2V0IGRvbU1vdXNlTW92ZSQoKXtyZXR1cm4gdGhpcy5fZG9tTW91c2VNb3ZlJH1nZXQgbW91c2VPd25lciQoKXtyZXR1cm4gdGhpcy5fbW91c2VPd25lciR9Z2V0IG1vdXNlRG93biQoKXtyZXR1cm4gdGhpcy5fbW91c2VEb3duJH1nZXQgbW91c2VFbnRlciQoKXtyZXR1cm4gdGhpcy5fbW91c2VFbnRlciR9Z2V0IG1vdXNlTW92ZSQoKXtyZXR1cm4gdGhpcy5fbW91c2VNb3ZlJH1nZXQgbW91c2VMZWF2ZSQoKXtyZXR1cm4gdGhpcy5fbW91c2VMZWF2ZSR9Z2V0IG1vdXNlT3V0JCgpe3JldHVybiB0aGlzLl9tb3VzZU91dCR9Z2V0IG1vdXNlT3ZlciQoKXtyZXR1cm4gdGhpcy5fbW91c2VPdmVyJH1nZXQgbW91c2VVcCQoKXtyZXR1cm4gdGhpcy5fbW91c2VVcCR9Z2V0IGNsaWNrJCgpe3JldHVybiB0aGlzLl9jbGljayR9Z2V0IGRibENsaWNrJCgpe3JldHVybiB0aGlzLl9kYmxDbGljayR9Z2V0IGNvbnRleHRNZW51JCgpe3JldHVybiB0aGlzLl9jb25zaXN0ZW50Q29udGV4dE1lbnUkfWdldCBtb3VzZVdoZWVsJCgpe3JldHVybiB0aGlzLl9tb3VzZVdoZWVsJH1nZXQgbW91c2VEcmFnU3RhcnQkKCl7cmV0dXJuIHRoaXMuX21vdXNlRHJhZ1N0YXJ0JH1nZXQgbW91c2VEcmFnJCgpe3JldHVybiB0aGlzLl9tb3VzZURyYWckfWdldCBtb3VzZURyYWdFbmQkKCl7cmV0dXJuIHRoaXMuX21vdXNlRHJhZ0VuZCR9Z2V0IG1vdXNlUmlnaHREcmFnU3RhcnQkKCl7cmV0dXJuIHRoaXMuX21vdXNlUmlnaHREcmFnU3RhcnQkfWdldCBtb3VzZVJpZ2h0RHJhZyQoKXtyZXR1cm4gdGhpcy5fbW91c2VSaWdodERyYWckfWdldCBtb3VzZVJpZ2h0RHJhZ0VuZCQoKXtyZXR1cm4gdGhpcy5fbW91c2VSaWdodERyYWdFbmQkfWdldCBwcm94aW1hdGVDbGljayQoKXtyZXR1cm4gdGhpcy5fcHJveGltYXRlQ2xpY2skfWdldCBzdGF0aWNDbGljayQoKXtyZXR1cm4gdGhpcy5fc3RhdGljQ2xpY2skfWdldCB3aW5kb3dCbHVyJCgpe3JldHVybiB0aGlzLl93aW5kb3dCbHVyJH1kaXNwb3NlKCl7dGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfWNsYWltTW91c2UodCxlKXt0aGlzLl9jbGFpbU1vdXNlJC5uZXh0KHtuYW1lOnQsemluZGV4OmV9KX11bmNsYWltTW91c2UodCl7dGhpcy5fY2xhaW1Nb3VzZSQubmV4dCh7bmFtZTp0LHppbmRleDpudWxsfSl9ZGVmZXJQaXhlbHModCxlKXt0aGlzLl9kZWZlclBpeGVsQ2xhaW1zJC5uZXh0KHtuYW1lOnQsZGVmZXJQaXhlbHM6ZX0pfXVuZGVmZXJQaXhlbHModCl7dGhpcy5fZGVmZXJQaXhlbENsYWltcyQubmV4dCh7bmFtZTp0LGRlZmVyUGl4ZWxzOm51bGx9KX1jbGFpbVdoZWVsKHQsZSl7dGhpcy5fY2xhaW1XaGVlbCQubmV4dCh7bmFtZTp0LHppbmRleDplfSl9dW5jbGFpbVdoZWVsKHQpe3RoaXMuX2NsYWltV2hlZWwkLm5leHQoe25hbWU6dCx6aW5kZXg6bnVsbH0pfWZpbHRlcmVkJCh0LGUpe3JldHVybiB0aGlzLl9maWx0ZXJlZCh0LGUsdGhpcy5fbW91c2VPd25lciQpfWZpbHRlcmVkV2hlZWwkKHQsZSl7cmV0dXJuIHRoaXMuX2ZpbHRlcmVkKHQsZSx0aGlzLl93aGVlbE93bmVyJCl9X2NyZWF0ZURlZmVycmVkTW91c2VNb3ZlJCh0LGUpe3JldHVybiBlLnBpcGUocnQoKGU9Pntjb25zdCBpPWUuY2xpZW50WC10LmNsaWVudFgsbj1lLmNsaWVudFktdC5jbGllbnRZO3JldHVybltlLE1hdGguc3FydChpKmkrbipuKV19KSksYmkodGhpcy5fZGVmZXJQaXhlbHMkKSxOdCgoKFtbLHRdLGVdKT0+dD5lKSkscnQoKChbW3RdXSk9PnQpKSl9X2NyZWF0ZU1vdXNlRHJhZyQodCxlKXtyZXR1cm4gdC5waXBlKHJ0KCgoWyx0XSk9PnQpKSxyaSgodD0+QXQoRyh0KSx0aGlzLl9kb2N1bWVudE1vdXNlTW92ZSQpLnBpcGUoYWkoZSkpKSkpfV9jcmVhdGVNb3VzZURyYWdFbmQkKHQsZSl7cmV0dXJuIHQucGlwZShyaSgoKCk9PmUucGlwZShFZSgpKSkpKX1fY3JlYXRlTW91c2VEcmFnU3RhcnQkKHQpe3JldHVybiB0LnBpcGUocnQoKChbdF0pPT50KSkpfV9jcmVhdGVNb3VzZURyYWdJbml0aWF0ZSQodCxlLGksbil7cmV0dXJuIGUucGlwZShOdCgoZT0+dGhpcy5fbW91c2VCdXR0b24oZSk9PT10KSkscmkoKHQ9Pmd0KEcodCksbj90aGlzLl9jcmVhdGVEZWZlcnJlZE1vdXNlTW92ZSQodCx0aGlzLl9kb2N1bWVudE1vdXNlTW92ZSQpOnRoaXMuX2RvY3VtZW50TW91c2VNb3ZlJCkucGlwZShhaShpKSx2ZSgxKSkpKSl9X2NyZWF0ZU93bmVyJCh0KXtyZXR1cm4gdC5waXBlKExlKCgodCxlKT0+KG51bGw9PWUuemluZGV4P2RlbGV0ZSB0W2UubmFtZV06dFtlLm5hbWVdPWUuemluZGV4LHQpKSx7fSkscnQoKHQ9PntsZXQgZT1udWxsLGk9LTE7Zm9yKGNvbnN0IG4gaW4gdCl0Lmhhc093blByb3BlcnR5KG4pJiZ0W25dPmkmJihpPXRbbl0sZT1uKTtyZXR1cm4gZX0pKSxuaShudWxsKSl9X2ZpbHRlcmVkKHQsZSxpKXtyZXR1cm4gZS5waXBlKGJpKGkpLE50KCgoWyxlXSk9PmU9PT10KSkscnQoKChbdF0pPT50KSkpfV9tb3VzZUJ1dHRvbih0KXtjb25zdCBlPVwicG9pbnRlcmRvd25cIj09PXQudHlwZXx8XCJwb2ludGVydXBcIj09PXQudHlwZSxpPXdpbmRvdy5JbnN0YWxsVHJpZ2dlcjtyZXR1cm4gZSYmdm9pZCAwIT09aSYmMj09PXQuYnV0dG9uJiZ0LmN0cmxLZXkmJndpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0udG9VcHBlckNhc2UoKS5pbmRleE9mKFwiTUFDXCIpPj0wPzA6dC5idXR0b259X2J1dHRvblJlbGVhc2VkKHQsZSl7Y29uc3QgaT12d1tlXTtyZXR1cm4gdm9pZCAwPT09dC5idXR0b25zfHwodC5idXR0b25zJmkpIT09aX1faXNNb3VzZVBlbih0KXtjb25zdCBlPXQucG9pbnRlclR5cGU7cmV0dXJuXCJtb3VzZVwiPT09ZXx8XCJwZW5cIj09PWV9fWNsYXNzIGJ3e3NldCBqc29uKHQpe3RoaXMuX2pzb249dH1zZXQgaW1hZ2UodCl7dGhpcy5faW1hZ2U9dCx0aGlzLl90ZXh0dXJlPW5ldyBobih0aGlzLl9pbWFnZSksdGhpcy5fdGV4dHVyZS5taW5GaWx0ZXI9SWl9Z2V0IGxvYWRlZCgpe3JldHVybiEoIXRoaXMuX2ltYWdlfHwhdGhpcy5fanNvbil9Z2V0R0xTcHJpdGUodCl7aWYoIXRoaXMubG9hZGVkKXRocm93IG5ldyBFcnJvcihcIlNwcml0ZXMgY2Fubm90IGJlIHJldHJpZXZlZCBiZWZvcmUgdGhlIGF0bGFzIGlzIGxvYWRlZC5cIik7bGV0IGU9dGhpcy5fanNvblt0XTtpZighZSlyZXR1cm4gY29uc29sZS53YXJuKFwiU3ByaXRlIHdpdGgga2V5XCIrdCtcImRvZXMgbm90IGV4aXN0IGluIHNwcml0ZSBkZWZpbml0aW9uLlwiKSxuZXcgcHI7bGV0IGk9dGhpcy5fdGV4dHVyZS5jbG9uZSgpO2kubmVlZHNVcGRhdGU9ITA7bGV0IG49dGhpcy5faW1hZ2Uud2lkdGgscj10aGlzLl9pbWFnZS5oZWlnaHQ7cmV0dXJuIGkub2Zmc2V0Lng9ZS54L24saS5vZmZzZXQueT0oci1lLnktZS5oZWlnaHQpL3IsaS5yZXBlYXQueD1lLndpZHRoL24saS5yZXBlYXQueT1lLmhlaWdodC9yLG5ldyBfYyhuZXcgbmMoe21hcDppfSkpfWdldERPTVNwcml0ZShlLGkpe2lmKCF0aGlzLmxvYWRlZCl0aHJvdyBuZXcgRXJyb3IoXCJTcHJpdGVzIGNhbm5vdCBiZSByZXRyaWV2ZWQgYmVmb3JlIHRoZSBhdGxhcyBpcyBsb2FkZWQuXCIpO251bGw9PWkmJihpPXQuQWxpZ25tZW50LkNlbnRlcik7bGV0IG49dGhpcy5fanNvbltlXTtpZighbilyZXR1cm4gY29uc29sZS53YXJuKFwiU3ByaXRlIHdpdGgga2V5XCIrZStcImRvZXMgbm90IGV4aXN0IGluIHNwcml0ZSBkZWZpbml0aW9uLlwiKSxqZi5oKFwiZGl2XCIse30sW10pO2xldCByPW4ueSxzPW4ueCtuLndpZHRoLG89bi55K24uaGVpZ2h0LGE9bi54LGM9LW4ueCxoPS1uLnksbD10aGlzLl9pbWFnZS5oZWlnaHQsdT10aGlzLl9pbWFnZS53aWR0aDtzd2l0Y2goaSl7Y2FzZSB0LkFsaWdubWVudC5Cb3R0b206Y2FzZSB0LkFsaWdubWVudC5DZW50ZXI6Y2FzZSB0LkFsaWdubWVudC5Ub3A6Yy09bi53aWR0aC8yO2JyZWFrO2Nhc2UgdC5BbGlnbm1lbnQuQm90dG9tTGVmdDpjYXNlIHQuQWxpZ25tZW50LkxlZnQ6Y2FzZSB0LkFsaWdubWVudC5Ub3BMZWZ0OmMtPW4ud2lkdGg7YnJlYWs7Y2FzZSB0LkFsaWdubWVudC5Cb3R0b21SaWdodDpjYXNlIHQuQWxpZ25tZW50LlJpZ2h0OmNhc2UgdC5BbGlnbm1lbnQuVG9wUmlnaHQ6fXN3aXRjaChpKXtjYXNlIHQuQWxpZ25tZW50LkNlbnRlcjpjYXNlIHQuQWxpZ25tZW50LkxlZnQ6Y2FzZSB0LkFsaWdubWVudC5SaWdodDpoLT1uLmhlaWdodC8yO2JyZWFrO2Nhc2UgdC5BbGlnbm1lbnQuVG9wOmNhc2UgdC5BbGlnbm1lbnQuVG9wTGVmdDpjYXNlIHQuQWxpZ25tZW50LlRvcFJpZ2h0OmgtPW4uaGVpZ2h0O2JyZWFrO2Nhc2UgdC5BbGlnbm1lbnQuQm90dG9tOmNhc2UgdC5BbGlnbm1lbnQuQm90dG9tTGVmdDpjYXNlIHQuQWxpZ25tZW50LkJvdHRvbVJpZ2h0On1sZXQgZD0xL24ucGl4ZWxSYXRpbztyKj1kLHMqPWQsbyo9ZCxhKj1kLGMqPWQsaCo9ZCxsKj1kLHUqPWQ7bGV0IHA9e3NyYzp0aGlzLl9pbWFnZS5zcmMsc3R5bGU6e2NsaXA6YHJlY3QoJHtyfXB4LCAke3N9cHgsICR7b31weCwgJHthfXB4KWAsaGVpZ2h0OmAke2x9cHhgLGxlZnQ6YCR7Y31weGAscG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpgJHtofXB4YCx3aWR0aDpgJHt1fXB4YH19O3JldHVybiBqZi5oKFwiaW1nXCIscCxbXSl9fWNsYXNzIHh3e2NvbnN0cnVjdG9yKHQpe2lmKHRoaXMuX3JldGluYT13aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbz4xLHRoaXMuX3Nwcml0ZUF0bGFzT3BlcmF0aW9uJD1uZXcgVCx0aGlzLl9zcHJpdGVBdGxhcyQ9dGhpcy5fc3ByaXRlQXRsYXNPcGVyYXRpb24kLnBpcGUobmkoKHQ9PnQpKSxMZSgoKHQsZSk9PmUodCkpLG5ldyBidyksVWUoMSksRSgpKSx0aGlzLl9hdGxhc1N1YnNjcmlwdGlvbj10aGlzLl9zcHJpdGVBdGxhcyQuc3Vic2NyaWJlKCgoKT0+e30pKSxudWxsPT10KXJldHVybjtsZXQgZT10aGlzLl9yZXRpbmE/XCJAMnhcIjpcIlwiLGk9bmV3IFhNTEh0dHBSZXF1ZXN0O2kub3BlbihcIkdFVFwiLHQrZStcIi5wbmdcIiwhMCksaS5yZXNwb25zZVR5cGU9XCJhcnJheWJ1ZmZlclwiLGkub25sb2FkPSgpPT57bGV0IHQ9bmV3IEltYWdlO3Qub25sb2FkPSgpPT57dGhpcy5fc3ByaXRlQXRsYXNPcGVyYXRpb24kLm5leHQoKGU9PihlLmltYWdlPXQsZSkpKX07bGV0IGU9bmV3IEJsb2IoW2kucmVzcG9uc2VdKTt0LnNyYz13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChlKX0saS5vbmVycm9yPWk9Pntjb25zb2xlLmVycm9yKG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHNwcml0ZSBzaGVldCAoJHt0fSR7ZX0ucG5nKWApKX0saS5zZW5kKCk7bGV0IG49bmV3IFhNTEh0dHBSZXF1ZXN0O24ub3BlbihcIkdFVFwiLHQrZStcIi5qc29uXCIsITApLG4ucmVzcG9uc2VUeXBlPVwidGV4dFwiLG4ub25sb2FkPSgpPT57bGV0IHQ9SlNPTi5wYXJzZShuLnJlc3BvbnNlKTt0aGlzLl9zcHJpdGVBdGxhc09wZXJhdGlvbiQubmV4dCgoZT0+KGUuanNvbj10LGUpKSl9LG4ub25lcnJvcj1pPT57Y29uc29sZS5lcnJvcihuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBzaGVldCAoJHt0fSR7ZX0uanNvbilgKSl9LG4uc2VuZCgpfWdldCBzcHJpdGVBdGxhcyQoKXtyZXR1cm4gdGhpcy5fc3ByaXRlQXRsYXMkfWRpc3Bvc2UoKXt0aGlzLl9hdGxhc1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpfX1jbGFzcyB3d3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX3N1YnNjcmlwdGlvbnM9bmV3IFVmO2NvbnN0IGk9dGhpcy5fc3Vic2NyaXB0aW9uczt0aGlzLl9hY3RpdmVTdWJqZWN0JD1uZXcgTyghMSksdGhpcy5fYWN0aXZlJD10aGlzLl9hY3RpdmVTdWJqZWN0JC5waXBlKHVlKCksVWUoMSksRSgpKSxpLnB1c2goUHQoZSxcInRvdWNobW92ZVwiKS5zdWJzY3JpYmUoKHQ9Pnt0LnByZXZlbnREZWZhdWx0KCl9KSkpLHRoaXMuX3RvdWNoU3RhcnQkPVB0KHQsXCJ0b3VjaHN0YXJ0XCIpLHRoaXMuX3RvdWNoTW92ZSQ9UHQodCxcInRvdWNobW92ZVwiKSx0aGlzLl90b3VjaEVuZCQ9UHQodCxcInRvdWNoZW5kXCIpLHRoaXMuX3RvdWNoQ2FuY2VsJD1QdCh0LFwidG91Y2hjYW5jZWxcIik7Y29uc3Qgbj10aGlzLl90b3VjaFN0YXJ0JC5waXBlKE50KCh0PT4xPT09dC50b3VjaGVzLmxlbmd0aCYmMT09PXQudGFyZ2V0VG91Y2hlcy5sZW5ndGgpKSxaZSgpKTt2YXIgcjt0aGlzLl9kb3VibGVUYXAkPW4ucGlwZSgocj0oKT0+bi5waXBlKEVlKCkscmkoKCgpPT5PdChrdCgzMDApLG4pLnBpcGUodmUoMSkpKSkpLGZ1bmN0aW9uKHQpe3JldHVybiB0LmxpZnQobmV3IEt0KHIpKX0pLE50KCh0PT4yPT09dC5sZW5ndGgpKSxydCgodD0+dFt0Lmxlbmd0aC0xXSkpLFplKCkpLGkucHVzaCh0aGlzLl9kb3VibGVUYXAkLnN1YnNjcmliZSgodD0+e3QucHJldmVudERlZmF1bHQoKX0pKSksdGhpcy5fc2luZ2xlVG91Y2hNb3ZlJD10aGlzLl90b3VjaE1vdmUkLnBpcGUoTnQoKHQ9PjE9PT10LnRvdWNoZXMubGVuZ3RoJiYxPT09dC50YXJnZXRUb3VjaGVzLmxlbmd0aCkpLFplKCkpO2xldCBzPU90KHRoaXMuX3RvdWNoU3RhcnQkLHRoaXMuX3RvdWNoRW5kJCx0aGlzLl90b3VjaENhbmNlbCQpLnBpcGUoTnQoKHQ9PjE9PT10LnRvdWNoZXMubGVuZ3RoJiYxPT09dC50YXJnZXRUb3VjaGVzLmxlbmd0aCkpKSxvPU90KHRoaXMuX3RvdWNoU3RhcnQkLHRoaXMuX3RvdWNoRW5kJCx0aGlzLl90b3VjaENhbmNlbCQpLnBpcGUoTnQoKHQ9PnQudG91Y2hlcy5sZW5ndGg+PTEpKSksYT1PdCh0aGlzLl90b3VjaEVuZCQsdGhpcy5fdG91Y2hDYW5jZWwkKS5waXBlKE50KCh0PT4wPT09dC50b3VjaGVzLmxlbmd0aCkpKTt0aGlzLl9zaW5nbGVUb3VjaERyYWdTdGFydCQ9cy5waXBlKE10KCgoKT0+dGhpcy5fc2luZ2xlVG91Y2hNb3ZlJC5waXBlKGFpKE90KGEsbykpLHZlKDEpKSkpKSx0aGlzLl9zaW5nbGVUb3VjaERyYWdFbmQkPXMucGlwZShNdCgoKCk9Pk90KGEsbykucGlwZShFZSgpKSkpKSx0aGlzLl9zaW5nbGVUb3VjaERyYWckPXMucGlwZShyaSgoKCk9PnRoaXMuX3NpbmdsZVRvdWNoTW92ZSQucGlwZShKZSgxKSxhaShPdChvLGEpKSkpKSk7bGV0IGM9T3QodGhpcy5fdG91Y2hTdGFydCQsdGhpcy5fdG91Y2hFbmQkLHRoaXMuX3RvdWNoQ2FuY2VsJCk7dGhpcy5fcGluY2hTdGFydCQ9Yy5waXBlKE50KCh0PT4yPT09dC50b3VjaGVzLmxlbmd0aCYmMj09PXQudGFyZ2V0VG91Y2hlcy5sZW5ndGgpKSksdGhpcy5fcGluY2hFbmQkPWMucGlwZShOdCgodD0+MiE9PXQudG91Y2hlcy5sZW5ndGh8fDIhPT10LnRhcmdldFRvdWNoZXMubGVuZ3RoKSkpLHRoaXMuX3BpbmNoT3BlcmF0aW9uJD1uZXcgVCx0aGlzLl9waW5jaCQ9dGhpcy5fcGluY2hPcGVyYXRpb24kLnBpcGUoTGUoKCh0LGUpPT5lKHQpKSx7Y2hhbmdlWDowLGNoYW5nZVk6MCxjbGllbnRYOjAsY2xpZW50WTowLGRpc3RhbmNlOjAsZGlzdGFuY2VDaGFuZ2U6MCxkaXN0YW5jZVg6MCxkaXN0YW5jZVk6MCxvcmlnaW5hbEV2ZW50Om51bGwscGFnZVg6MCxwYWdlWTowLHNjcmVlblg6MCxzY3JlZW5ZOjAsdG91Y2gxOm51bGwsdG91Y2gyOm51bGx9KSk7Y29uc3QgaD10aGlzLl90b3VjaE1vdmUkLnBpcGUoTnQoKHQ9PjI9PT10LnRvdWNoZXMubGVuZ3RoJiYyPT09dC50YXJnZXRUb3VjaGVzLmxlbmd0aCkpLHJ0KCh0PT5lPT57bGV0IGk9dC50b3VjaGVzWzBdLG49dC50b3VjaGVzWzFdLHI9TWF0aC5taW4oaS5jbGllbnRYLG4uY2xpZW50WCkscz1NYXRoLm1heChpLmNsaWVudFgsbi5jbGllbnRYKSxvPU1hdGgubWluKGkuY2xpZW50WSxuLmNsaWVudFkpLGE9cisocy1yKS8yLGM9bysoTWF0aC5tYXgoaS5jbGllbnRZLG4uY2xpZW50WSktbykvMixoPWEraS5wYWdlWC1pLmNsaWVudFgsbD1jK2kucGFnZVktaS5jbGllbnRZLHU9YStpLnNjcmVlblgtaS5jbGllbnRYLGQ9YytpLnNjcmVlblktaS5jbGllbnRZLHA9TWF0aC5hYnMoaS5jbGllbnRYLW4uY2xpZW50WCksZj1NYXRoLmFicyhpLmNsaWVudFktbi5jbGllbnRZKSxtPU1hdGguc3FydChwKnArZipmKSxnPW0tZS5kaXN0YW5jZTtyZXR1cm57Y2hhbmdlWDpwLWUuZGlzdGFuY2VYLGNoYW5nZVk6Zi1lLmRpc3RhbmNlWSxjbGllbnRYOmEsY2xpZW50WTpjLGRpc3RhbmNlOm0sZGlzdGFuY2VDaGFuZ2U6ZyxkaXN0YW5jZVg6cCxkaXN0YW5jZVk6ZixvcmlnaW5hbEV2ZW50OnQscGFnZVg6aCxwYWdlWTpsLHNjcmVlblg6dSxzY3JlZW5ZOmQsdG91Y2gxOmksdG91Y2gyOm59fSkpKS5zdWJzY3JpYmUodGhpcy5fcGluY2hPcGVyYXRpb24kKTtpLnB1c2goaCksdGhpcy5fcGluY2hDaGFuZ2UkPXRoaXMuX3BpbmNoU3RhcnQkLnBpcGUocmkoKCgpPT50aGlzLl9waW5jaCQucGlwZShKZSgxKSxhaSh0aGlzLl9waW5jaEVuZCQpKSkpKX1nZXQgYWN0aXZlJCgpe3JldHVybiB0aGlzLl9hY3RpdmUkfWdldCBhY3RpdmF0ZSQoKXtyZXR1cm4gdGhpcy5fYWN0aXZlU3ViamVjdCR9Z2V0IGRvdWJsZVRhcCQoKXtyZXR1cm4gdGhpcy5fZG91YmxlVGFwJH1nZXQgdG91Y2hTdGFydCQoKXtyZXR1cm4gdGhpcy5fdG91Y2hTdGFydCR9Z2V0IHRvdWNoTW92ZSQoKXtyZXR1cm4gdGhpcy5fdG91Y2hNb3ZlJH1nZXQgdG91Y2hFbmQkKCl7cmV0dXJuIHRoaXMuX3RvdWNoRW5kJH1nZXQgdG91Y2hDYW5jZWwkKCl7cmV0dXJuIHRoaXMuX3RvdWNoQ2FuY2VsJH1nZXQgc2luZ2xlVG91Y2hEcmFnU3RhcnQkKCl7cmV0dXJuIHRoaXMuX3NpbmdsZVRvdWNoRHJhZ1N0YXJ0JH1nZXQgc2luZ2xlVG91Y2hEcmFnJCgpe3JldHVybiB0aGlzLl9zaW5nbGVUb3VjaERyYWckfWdldCBzaW5nbGVUb3VjaERyYWdFbmQkKCl7cmV0dXJuIHRoaXMuX3NpbmdsZVRvdWNoRHJhZ0VuZCR9Z2V0IHBpbmNoJCgpe3JldHVybiB0aGlzLl9waW5jaENoYW5nZSR9Z2V0IHBpbmNoU3RhcnQkKCl7cmV0dXJuIHRoaXMuX3BpbmNoU3RhcnQkfWdldCBwaW5jaEVuZCQoKXtyZXR1cm4gdGhpcy5fcGluY2hFbmQkfWRpc3Bvc2UoKXt0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9fWNsYXNzIFN3e2NvbnN0cnVjdG9yKHQpe3ZhciBlLGksbixyO2NvbnN0IHM9bnVsbCE9PShpPW51bGw9PT0oZT1udWxsPT10P3ZvaWQgMDp0LnVybCl8fHZvaWQgMD09PWU/dm9pZCAwOmUuZXhwbG9yZUhvc3QpJiZ2b2lkIDAhPT1pP2k6XCJ3d3cubWFwaWxsYXJ5LmNvbVwiLG89YCR7bnVsbCE9PShyPW51bGw9PT0obj1udWxsPT10P3ZvaWQgMDp0LnVybCl8fHZvaWQgMD09PW4/dm9pZCAwOm4uc2NoZW1lKSYmdm9pZCAwIT09cj9yOlwiaHR0cHNcIn06Ly8ke3N9YDt0aGlzLl9leHBsb3JlVXJsJD1HKG8pO2NvbnN0IGE9ITEhPT0obnVsbD09dD92b2lkIDA6dC5pbWFnZVRpbGluZyk7dGhpcy5faW1hZ2VUaWxpbmckPUcoYSl9Z2V0IGV4cGxvcmVVcmwkKCl7cmV0dXJuIHRoaXMuX2V4cGxvcmVVcmwkfWdldCBpbWFnZVRpbGluZyQoKXtyZXR1cm4gdGhpcy5faW1hZ2VUaWxpbmckfX1jbGFzcyBNd3tjb25zdHJ1Y3Rvcih0LGUsaSl7dmFyIG47aWYodGhpcy5fb25XaW5kb3dSZXNpemU9KCk9Pnt0aGlzLl90cmFja1Jlc2l6ZSYmdGhpcy5yZW5kZXJTZXJ2aWNlLnJlc2l6ZSQubmV4dCgpfSx0aGlzLl9kb209bnVsbCE9aT9pOm5ldyBYbSxcInN0cmluZ1wiPT10eXBlb2YgdC5jb250YWluZXIpe2lmKHRoaXMuX2NvbnRhaW5lcj10aGlzLl9kb20uZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodC5jb250YWluZXIpLCF0aGlzLl9jb250YWluZXIpdGhyb3cgbmV3IEVycm9yKGBDb250YWluZXIgXCIke3QuY29udGFpbmVyfVwiIG5vdCBmb3VuZC5gKX1lbHNle2lmKCEodC5jb250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHR5cGU6IFwiY29udGFpbmVyXCIgbXVzdCBiZSBhIFN0cmluZyBvciBIVE1MRWxlbWVudC4nKTt0aGlzLl9jb250YWluZXI9dC5jb250YWluZXJ9dGhpcy5fdHJhY2tSZXNpemU9ITEhPT10LnRyYWNrUmVzaXplLHRoaXMuaWQ9bnVsbCE9PShuPXRoaXMuX2NvbnRhaW5lci5pZCkmJnZvaWQgMCE9PW4/bjpcIm1hcGlsbGFyeS1mYWxsYmFjay1jb250YWluZXItaWRcIix0aGlzLl9jb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm1hcGlsbGFyeS12aWV3ZXJcIiksdGhpcy5fY2FudmFzQ29udGFpbmVyPXRoaXMuX2RvbS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsXCJtYXBpbGxhcnktaW50ZXJhY3RpdmVcIix0aGlzLl9jb250YWluZXIpLHRoaXMuX2NhbnZhcz10aGlzLl9kb20uY3JlYXRlRWxlbWVudChcImNhbnZhc1wiLFwibWFwaWxsYXJ5LWNhbnZhc1wiKSx0aGlzLl9jYW52YXMuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLHRoaXMuX2NhbnZhcy5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLFwiMFwiKSx0aGlzLl9kb21Db250YWluZXI9dGhpcy5fZG9tLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIixcIm1hcGlsbGFyeS1kb21cIix0aGlzLl9jb250YWluZXIpLHRoaXMuY29uZmlndXJhdGlvblNlcnZpY2U9bmV3IFN3KHQpLHRoaXMucmVuZGVyU2VydmljZT1uZXcgZ3codGhpcy5fY29udGFpbmVyLGUuY3VycmVudFN0YXRlJCx0LnJlbmRlck1vZGUpLHRoaXMuZ2xSZW5kZXJlcj1uZXcgZncodGhpcy5fY2FudmFzLHRoaXMuX2NhbnZhc0NvbnRhaW5lcix0aGlzLnJlbmRlclNlcnZpY2UpLHRoaXMuZG9tUmVuZGVyZXI9bmV3IHB3KHRoaXMuX2RvbUNvbnRhaW5lcix0aGlzLnJlbmRlclNlcnZpY2UsZS5jdXJyZW50U3RhdGUkKSx0aGlzLmtleWJvYXJkU2VydmljZT1uZXcgX3codGhpcy5fY2FudmFzQ29udGFpbmVyKSx0aGlzLm1vdXNlU2VydmljZT1uZXcgeXcodGhpcy5fY29udGFpbmVyLHRoaXMuX2NhbnZhc0NvbnRhaW5lcix0aGlzLl9kb21Db250YWluZXIsZG9jdW1lbnQpLHRoaXMudG91Y2hTZXJ2aWNlPW5ldyB3dyh0aGlzLl9jYW52YXNDb250YWluZXIsdGhpcy5fZG9tQ29udGFpbmVyKSx0aGlzLnNwcml0ZVNlcnZpY2U9bmV3IHh3KHQuc3ByaXRlKSx3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLHRoaXMuX29uV2luZG93UmVzaXplLCExKX1nZXQgY2FudmFzKCl7cmV0dXJuIHRoaXMuX2NhbnZhcy5wYXJlbnROb2RlP3RoaXMuX2NhbnZhczpudWxsfWdldCBjYW52YXNDb250YWluZXIoKXtyZXR1cm4gdGhpcy5fY2FudmFzQ29udGFpbmVyfWdldCBjb250YWluZXIoKXtyZXR1cm4gdGhpcy5fY29udGFpbmVyfWdldCBkb21Db250YWluZXIoKXtyZXR1cm4gdGhpcy5fZG9tQ29udGFpbmVyfXJlbW92ZSgpe3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcy5fb25XaW5kb3dSZXNpemUsITEpLHRoaXMuc3ByaXRlU2VydmljZS5kaXNwb3NlKCksdGhpcy50b3VjaFNlcnZpY2UuZGlzcG9zZSgpLHRoaXMubW91c2VTZXJ2aWNlLmRpc3Bvc2UoKSx0aGlzLmdsUmVuZGVyZXIucmVtb3ZlKCksdGhpcy5kb21SZW5kZXJlci5yZW1vdmUoKSx0aGlzLnJlbmRlclNlcnZpY2UuZGlzcG9zZSgpLHRoaXMuX3JlbW92ZU5vZGUodGhpcy5fY2FudmFzQ29udGFpbmVyKSx0aGlzLl9yZW1vdmVOb2RlKHRoaXMuX2RvbUNvbnRhaW5lciksdGhpcy5fY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJtYXBpbGxhcnktdmlld2VyXCIpfV9yZW1vdmVOb2RlKHQpe3QucGFyZW50Tm9kZSYmdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpfX1jbGFzcyBUd3tjb25zdHJ1Y3Rvcih0LGUsaSl7dGhpcy5fZ3JhcGhTZXJ2aWNlPXQsdGhpcy5fc3RhdGVTZXJ2aWNlPWUsdGhpcy5fYXBpPWksdGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fc3RhcnRlZD0hMSx0aGlzLl9jZWxsRGVwdGg9MX1nZXQgc3RhcnRlZCgpe3JldHVybiB0aGlzLl9zdGFydGVkfWNvbmZpZ3VyZSh0KXt0aGlzLl9jZWxsRGVwdGg9dD9NYXRoLm1heCgxLE1hdGgubWluKDMsdC5jZWxsRGVwdGgpKToxfXN0YXJ0KCl7aWYodGhpcy5fc3RhcnRlZClyZXR1cm47Y29uc3QgdD10aGlzLl9zdWJzY3JpcHRpb25zO3QucHVzaCh0aGlzLl9zdGF0ZVNlcnZpY2UuY3VycmVudFN0YXRlJC5waXBlKHVlKHZvaWQgMCwodD0+dC5zdGF0ZS5jdXJyZW50SW1hZ2UuaWQpKSxydCgodD0+e2NvbnN0IGU9dC5zdGF0ZSxpPWUudHJhamVjdG9yeSxuPWkubWFwKCh0PT50LmlkKSkscj1pW2kubGVuZ3RoLTFdLnNlcXVlbmNlSWQ7cmV0dXJuW24sZS5jdXJyZW50SW1hZ2Uub3JpZ2luYWxMbmdMYXQscl19KSksWHQoMSw1KSxiaSh0aGlzLl9ncmFwaFNlcnZpY2UuZ3JhcGhNb2RlJCkscmkoKChbdCxlXSk9Pntjb25zdCBpPXRbMF1bMF0sbj10WzBdWzFdLHI9dGhpcy5fYXBpLmRhdGEuZ2VvbWV0cnkscz12ZyhyLmxuZ0xhdFRvQ2VsbElkKG4pLHRoaXMuX2NlbGxEZXB0aCxyKSxvPWU9PT15bS5TZXF1ZW5jZT90WzBdWzJdOnZvaWQgMDtyZXR1cm4gdGhpcy5fZ3JhcGhTZXJ2aWNlLnVuY2FjaGUkKGkscyxvKX0pKSkuc3Vic2NyaWJlKCgoKT0+e30pKSksdC5wdXNoKHRoaXMuX2dyYXBoU2VydmljZS5ncmFwaE1vZGUkLnBpcGUoSmUoMSksYmkodGhpcy5fc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQpLHJpKCgoW3QsZV0pPT50PT09eW0uU2VxdWVuY2U/dGhpcy5fa2V5VG9FZGdlcyhlLnN0YXRlLmN1cnJlbnRJbWFnZS5pZCwodD0+dC5zZXF1ZW5jZUVkZ2VzJCkpOmJ0KGUuc3RhdGUudHJhamVjdG9yeS5tYXAoKHQ9PnQuaWQpKS5zbGljZShlLnN0YXRlLmN1cnJlbnRJbmRleCkpLnBpcGUoTXQoKHQ9PnRoaXMuX2tleVRvRWRnZXModCwodD0+dC5zcGF0aWFsRWRnZXMkKSkpLDYpKSkpKS5zdWJzY3JpYmUoKCgpPT57fSkpKSx0LnB1c2godGhpcy5fZ3JhcGhTZXJ2aWNlLmRhdGFBZGRlZCQucGlwZShiaSh0aGlzLl9zdGF0ZVNlcnZpY2UuY3VycmVudElkJCkscmkoKChbdCxlXSk9PnRoaXMuX2dyYXBoU2VydmljZS5jYWNoZUltYWdlJChlKSkpKS5zdWJzY3JpYmUoKCgpPT57fSkpKSx0aGlzLl9zdGFydGVkPSEwfXN0b3AoKXt0aGlzLl9zdGFydGVkJiYodGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpLHRoaXMuX3N0YXJ0ZWQ9ITEpfV9rZXlUb0VkZ2VzKHQsZSl7cmV0dXJuIHRoaXMuX2dyYXBoU2VydmljZS5jYWNoZUltYWdlJCh0KS5waXBlKHJpKGUpLEVlKCh0PT50LmNhY2hlZCkpLHlpKDE1ZTMpLHRlKChlPT4oY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGNhY2hlIGVkZ2VzICgke3R9KS5gLGUpLEIoKSkpKSl9fWNsYXNzIEN3e2NvbnN0cnVjdG9yKCl7dGhpcy5fbG9hZGVyc1N1YmplY3QkPW5ldyBULHRoaXMuX2xvYWRlcnMkPXRoaXMuX2xvYWRlcnNTdWJqZWN0JC5waXBlKExlKCgodCxlKT0+KHZvaWQgMCE9PWUudGFzayYmKHRbZS50YXNrXT1lLmxvYWRpbmcpLHQpKSx7fSksbmkoe30pLFVlKDEpLEUoKSl9Z2V0IGxvYWRpbmckKCl7cmV0dXJuIHRoaXMuX2xvYWRlcnMkLnBpcGUocnQoKHQ9Pntmb3IoY29uc3QgZSBpbiB0KWlmKHQuaGFzT3duUHJvcGVydHkoZSkmJnRbZV0pcmV0dXJuITA7cmV0dXJuITF9KSkscmUoMTAwKSx1ZSgpKX10YXNrTG9hZGluZyQodCl7cmV0dXJuIHRoaXMuX2xvYWRlcnMkLnBpcGUocnQoKGU9PiEhZVt0XSkpLHJlKDEwMCksdWUoKSl9c3RhcnRMb2FkaW5nKHQpe3RoaXMuX2xvYWRlcnNTdWJqZWN0JC5uZXh0KHtsb2FkaW5nOiEwLHRhc2s6dH0pfXN0b3BMb2FkaW5nKHQpe3RoaXMuX2xvYWRlcnNTdWJqZWN0JC5uZXh0KHtsb2FkaW5nOiExLHRhc2s6dH0pfX12YXIgRXc7IWZ1bmN0aW9uKHQpe3RbdC5EaXNhYmxlZD0wXT1cIkRpc2FibGVkXCIsdFt0LkVuYWJsZWQ9MV09XCJFbmFibGVkXCIsdFt0LlN0YXJ0ZWQ9Ml09XCJTdGFydGVkXCJ9KEV3fHwoRXc9e30pKTtjbGFzcyBJd3tjb25zdHJ1Y3Rvcih0LGUsaSxuLHIscyl7dGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fZ3JhcGhTZXJ2aWNlPXQsdGhpcy5fc3RhdGVTZXJ2aWNlPWUsdGhpcy5fZ3JhcGhDYWxjdWxhdG9yPW51bGwhPW4/bjpuZXcgdGQsdGhpcy5fc3BhdGlhbD1udWxsIT1yP3I6bmV3IGxkLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPW51bGwhPXM/czpuZXcgV2YsdGhpcy5fbW9kZT0hMSE9PWk/RXcuRW5hYmxlZDpFdy5EaXNhYmxlZCx0aGlzLl9wYW5JbWFnZXNTdWJqZWN0JD1uZXcgVCx0aGlzLl9wYW5JbWFnZXMkPXRoaXMuX3BhbkltYWdlc1N1YmplY3QkLnBpcGUobmkoW10pLFVlKDEpLEUoKSksdGhpcy5fc3Vic2NyaXB0aW9ucy5wdXNoKHRoaXMuX3BhbkltYWdlcyQuc3Vic2NyaWJlKCkpfWdldCBwYW5JbWFnZXMkKCl7cmV0dXJuIHRoaXMuX3BhbkltYWdlcyR9ZGlzcG9zZSgpe3RoaXMuc3RvcCgpLG51bGwhPXRoaXMuX3BhbkltYWdlc1N1YnNjcmlwdGlvbiYmdGhpcy5fcGFuSW1hZ2VzU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpfWVuYWJsZSgpe3RoaXMuX21vZGU9PT1Fdy5EaXNhYmxlZCYmKHRoaXMuX21vZGU9RXcuRW5hYmxlZCx0aGlzLnN0YXJ0KCkpfWRpc2FibGUoKXt0aGlzLl9tb2RlIT09RXcuRGlzYWJsZWQmJih0aGlzLnN0b3AoKSx0aGlzLl9tb2RlPUV3LkRpc2FibGVkKX1zdGFydCgpe2lmKHRoaXMuX21vZGUhPT1Fdy5FbmFibGVkKXJldHVybjtjb25zdCB0PXRoaXMuX3N0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUocmkoKHQ9PntpZighdC5tZXJnZWR8fGRkKHQuY2FtZXJhVHlwZSkpcmV0dXJuIEcoW10pO2NvbnN0IGU9Ryh0KSxpPXRoaXMuX2dyYXBoQ2FsY3VsYXRvci5ib3VuZGluZ0JveENvcm5lcnModC5sbmdMYXQsMjApO3JldHVybiBndChlLHRoaXMuX2dyYXBoU2VydmljZS5jYWNoZUJvdW5kaW5nQm94JChpWzBdLGlbMV0pLnBpcGUodGUoKGU9Pihjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgcGVyaXBoZXJ5IGJvdW5kaW5nIGJveCAoJHt0LmlkfSlgLGUpLEIoKSkpKSxydCgoZT0+e2lmKGRkKHQuY2FtZXJhVHlwZSkpcmV0dXJuW107Y29uc3QgaT1bXTtmb3IoY29uc3QgbiBvZiBlKW4uaWQhPT10LmlkJiZuLm1lcmdlSWQ9PT10Lm1lcmdlSWQmJihkZChuLmNhbWVyYVR5cGUpfHx0aGlzLl9kaXN0YW5jZShuLHQpPjR8fGkucHVzaChuKSk7cmV0dXJuIGl9KSkpKS5waXBlKGJpKHRoaXMuX3N0YXRlU2VydmljZS5yZWZlcmVuY2UkKSxydCgoKFtbdCxlXSxpXSk9Pntjb25zdCBuPXRoaXMuX3NwYXRpYWwudmlld2luZ0RpcmVjdGlvbih0LnJvdGF0aW9uKSxyPWZkKHtsYXQ6dC5sbmdMYXQubGF0LGxuZzp0LmxuZ0xhdC5sbmcsYWx0OnQuY29tcHV0ZWRBbHRpdHVkZX0sdC5yb3RhdGlvbixpKSxzPXRoaXMuX2NyZWF0ZVRyYW5zZm9ybSh0LHIpLG89dGhpcy5fc3BhdGlhbC53cmFwKHRoaXMuX3NwYXRpYWwuYXppbXV0aGFsKG4udG9BcnJheSgpLHMudXBWZWN0b3IoKS50b0FycmF5KCkpLDAsMipNYXRoLlBJKSxhPXRoaXMuX2NvbXB1dGVQcm9qZWN0ZWRQb2ludHMocyksYz10aGlzLl9jb21wdXRlSG9yaXpvbnRhbEZvdihhKS8xODAqTWF0aC5QSSxoPU1hdGguUEkvODtsZXQgbCx1O2Zvcihjb25zdCByIG9mIGUpe2NvbnN0IGU9ZmQoe2xhdDpyLmxuZ0xhdC5sYXQsbG5nOnIubG5nTGF0LmxuZyxhbHQ6ci5jb21wdXRlZEFsdGl0dWRlfSxyLnJvdGF0aW9uLGkpLHM9dGhpcy5fY3JlYXRlVHJhbnNmb3JtKHIsZSksYT10aGlzLl9jb21wdXRlUHJvamVjdGVkUG9pbnRzKHMpLGQ9dGhpcy5fY29tcHV0ZUhvcml6b250YWxGb3YoYSkvMTgwKk1hdGguUEkscD10aGlzLl9zcGF0aWFsLnZpZXdpbmdEaXJlY3Rpb24oci5yb3RhdGlvbiksZj10aGlzLl9zcGF0aWFsLndyYXAodGhpcy5fc3BhdGlhbC5hemltdXRoYWwocC50b0FycmF5KCkscy51cFZlY3RvcigpLnRvQXJyYXkoKSksMCwyKk1hdGguUEkpLG09dGhpcy5fc3BhdGlhbC5hbmdsZUJldHdlZW5WZWN0b3IyKG4ueCxuLnkscC54LHAueSk7bGV0IGc9TnVtYmVyLk5FR0FUSVZFX0lORklOSVRZO2c9bT4wP28+Zj9vLTIqTWF0aC5QSStjLzItKGYtZC8yKTpvK2MvMi0oZi1kLzIpOm88Zj9mK2QvMi0obysyKk1hdGguUEktYy8yKTpmK2QvMi0oby1jLzIpO2NvbnN0IF89TWF0aC5hYnMoZC1nKSx2PXRoaXMuX2Rpc3RhbmNlKHIsdCkrTWF0aC5taW4odGhpcy5fdGltZURpZmZlcmVuY2Uocix0KSw0KSsyMCpNYXRoLmFicyhnLWgpK01hdGgubWluKDUsMS9NYXRoLm1pbihkL2MsMSkpKyhnPjA/LTIqXzowKTtnPjAmJmc8LjUqYyYmZzwuNSpkJiZfPi41KmMmJihtPjA/bD92PGxbMF0mJihsPVt2LHIscyxkXSk6bD1bdixyLHMsZF06dT92PHVbMF0mJih1PVt2LHIscyxkXSk6dT1bdixyLHMsZF0pfWNvbnN0IGQ9W107cmV0dXJuIGwmJmQucHVzaChbbFsxXSxsWzJdLGxbM11dKSx1JiZkLnB1c2goW3VbMV0sdVsyXSx1WzNdXSksZH0pKSxuaShbXSkpfSkpKTt0aGlzLl9wYW5JbWFnZXNTdWJzY3JpcHRpb249dGhpcy5fc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShydCgodD0+dC5zdGF0ZS5pbWFnZXNBaGVhZD4wKSksdWUoKSxyaSgoZT0+ZT9HKFtdKTp0KSkpLnN1YnNjcmliZSgodD0+e3RoaXMuX3BhbkltYWdlc1N1YmplY3QkLm5leHQodCl9KSksdGhpcy5fbW9kZT1Fdy5TdGFydGVkfXN0b3AoKXt0aGlzLl9tb2RlPT09RXcuU3RhcnRlZCYmKHRoaXMuX3BhbkltYWdlc1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3BhbkltYWdlc1N1YmplY3QkLm5leHQoW10pLHRoaXMuX21vZGU9RXcuRW5hYmxlZCl9X2Rpc3RhbmNlKHQsZSl7Y29uc3RbaSxuLHJdPUp1KHQubG5nTGF0LmxuZyx0LmxuZ0xhdC5sYXQsdC5jb21wdXRlZEFsdGl0dWRlLGUubG5nTGF0LmxuZyxlLmxuZ0xhdC5sYXQsZS5jb21wdXRlZEFsdGl0dWRlKTtyZXR1cm4gTWF0aC5zcXJ0KGkqaStuKm4rcipyKX1fdGltZURpZmZlcmVuY2UodCxlKXtyZXR1cm4gTWF0aC5hYnModC5jYXB0dXJlZEF0LWUuY2FwdHVyZWRBdCkvMjU5MmU2fV9jcmVhdGVUcmFuc2Zvcm0odCxlKXtyZXR1cm4gbmV3IEhkKHQuZXhpZk9yaWVudGF0aW9uLHQud2lkdGgsdC5oZWlnaHQsdC5zY2FsZSx0LnJvdGF0aW9uLGUsdC5hc3NldHNDYWNoZWQ/dC5pbWFnZTp2b2lkIDAsdm9pZCAwLHQuY2FtZXJhUGFyYW1ldGVycyx0LmNhbWVyYVR5cGUpfV9jb21wdXRlUHJvamVjdGVkUG9pbnRzKHQpe3JldHVybiBtZCh0LFtbMSwwXV0sW1swLC41XV0sMjAsdGhpcy5fdmlld3BvcnRDb29yZHMpfV9jb21wdXRlSG9yaXpvbnRhbEZvdih0KXtjb25zdCBlPXQubWFwKCh0PT50aGlzLl9jb29yZFRvRm92KHRbMF0pKSk7cmV0dXJuIE1hdGgubWluKC4uLmUpfV9jb29yZFRvRm92KHQpe3JldHVybiAyKk1hdGguYXRhbih0KSoxODAvTWF0aC5QSX19Y2xhc3MgQXd7Y29uc3RydWN0b3IodCl7dGhpcy5fZGF0YT10fWdldCBkYXRhKCl7cmV0dXJuIHRoaXMuX2RhdGF9Z2V0Q29yZUltYWdlcyQodCl7cmV0dXJuIHRoaXMuX3dyYXAkKHRoaXMuX2RhdGEuZ2V0Q29yZUltYWdlcyh0KSl9Z2V0SW1hZ2VzJCh0KXtyZXR1cm4gdGhpcy5fd3JhcCQodGhpcy5fZGF0YS5nZXRJbWFnZXModCkpfWdldEltYWdlVGlsZXMkKHQpe3JldHVybiB0aGlzLl93cmFwJCh0aGlzLl9kYXRhLmdldEltYWdlVGlsZXModCkpfWdldFNlcXVlbmNlJCh0KXtyZXR1cm4gdGhpcy5fd3JhcCQodGhpcy5fZGF0YS5nZXRTZXF1ZW5jZSh0KSl9Z2V0U3BhdGlhbEltYWdlcyQodCl7cmV0dXJuIHRoaXMuX3dyYXAkKHRoaXMuX2RhdGEuZ2V0U3BhdGlhbEltYWdlcyh0KSl9c2V0QWNjZXNzVG9rZW4odCl7dGhpcy5fZGF0YS5zZXRBY2Nlc3NUb2tlbih0KX1fd3JhcCQodCl7cmV0dXJuIGIuY3JlYXRlKChlPT57dC50aGVuKCh0PT57ZS5uZXh0KHQpLGUuY29tcGxldGUoKX0pLCh0PT57ZS5lcnJvcih0KX0pKX0pKX19Y2xhc3MgUHd7Y29uc3RydWN0b3IodCl7dGhpcy5fZGF0YUFkZGVkJD1uZXcgVCx0aGlzLl9zdWJzY3JpcHRpb25zPW5ldyBVZix0aGlzLl9vbkRhdGFBZGRlZD10PT57dGhpcy5fZ3JhcGgkLnBpcGUoRWUoKSxNdCgoZT0+ZS51cGRhdGVDZWxscyQodC5jZWxsSWRzKS5waXBlKHBpKCgoKT0+e2UucmVzZXRTcGF0aWFsRWRnZXMoKX0pKSkpKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fZGF0YUFkZGVkJC5uZXh0KHQpfSkpfTtjb25zdCBlPXRoaXMuX3N1YnNjcmlwdGlvbnM7dGhpcy5fZ3JhcGgkPUF0KEcodCksdC5jaGFuZ2VkJCkucGlwZShVZSgxKSxFKCkpLGUucHVzaCh0aGlzLl9ncmFwaCQuc3Vic2NyaWJlKCgoKT0+e30pKSksdGhpcy5fZ3JhcGhNb2RlPXltLlNwYXRpYWwsdGhpcy5fZ3JhcGhNb2RlU3ViamVjdCQ9bmV3IFQsdGhpcy5fZ3JhcGhNb2RlJD10aGlzLl9ncmFwaE1vZGVTdWJqZWN0JC5waXBlKG5pKHRoaXMuX2dyYXBoTW9kZSksVWUoMSksRSgpKSxlLnB1c2godGhpcy5fZ3JhcGhNb2RlJC5zdWJzY3JpYmUoKCgpPT57fSkpKSx0aGlzLl9maXJzdEdyYXBoU3ViamVjdHMkPVtdLHRoaXMuX2luaXRpYWxpemVDYWNoZVN1YnNjcmlwdGlvbnM9W10sdGhpcy5fc2VxdWVuY2VTdWJzY3JpcHRpb25zPVtdLHRoaXMuX3NwYXRpYWxTdWJzY3JpcHRpb25zPVtdLHQuYXBpLmRhdGEub24oXCJkYXRhY3JlYXRlXCIsdGhpcy5fb25EYXRhQWRkZWQpfWdldCBkYXRhQWRkZWQkKCl7cmV0dXJuIHRoaXMuX2RhdGFBZGRlZCR9Z2V0IGZpbHRlciQoKXtyZXR1cm4gdGhpcy5fZ3JhcGgkLnBpcGUoRWUoKSxNdCgodD0+dC5maWx0ZXIkKSkpfWdldCBncmFwaE1vZGUkKCl7cmV0dXJuIHRoaXMuX2dyYXBoTW9kZSR9Y2FjaGVCb3VuZGluZ0JveCQodCxlKXtyZXR1cm4gdGhpcy5fZ3JhcGgkLnBpcGUoRWUoKSxNdCgoaT0+aS5jYWNoZUJvdW5kaW5nQm94JCh0LGUpKSkpfWNhY2hlQ2VsbCQodCl7cmV0dXJuIHRoaXMuX2dyYXBoJC5waXBlKEVlKCksTXQoKGU9PmUuY2FjaGVDZWxsJCh0KSkpKX1jYWNoZUltYWdlJCh0KXtjb25zdCBlPW5ldyBUO3RoaXMuX2ZpcnN0R3JhcGhTdWJqZWN0cyQucHVzaChlKTtjb25zdCBpPWUucGlwZShVZSgxKSxFKCkpLG49aS5waXBlKHJ0KChlPT5lLmdldE5vZGUodCkpKSxNdCgodD0+dC5hc3NldHNDYWNoZWQ/Ryh0KTp0LmNhY2hlQXNzZXRzJCgpKSksVWUoMSksRSgpKTtsZXQgcjtuLnN1YnNjcmliZSh2b2lkIDAsKGU9Pntjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgaW1hZ2UgKCR7dH0pLmAsZSl9KSkscj10aGlzLl9ncmFwaCQucGlwZShFZSgpLE10KChlPT5lLmlzQ2FjaGluZ0Z1bGwodCl8fCFlLmhhc05vZGUodCk/ZS5jYWNoZUZ1bGwkKHQpOmUuaXNDYWNoaW5nRmlsbCh0KXx8IWUuZ2V0Tm9kZSh0KS5jb21wbGV0ZT9lLmNhY2hlRmlsbCQodCk6RyhlKSkpLHBpKChlPT57aWYoIWUuaGFzTm9kZSh0KSl0aHJvdyBuZXcgX2QoYEZhaWxlZCB0byBjYWNoZSBpbWFnZSAoJHt0fSlgKTtlLmhhc0luaXRpYWxpemVkQ2FjaGUodCl8fGUuaW5pdGlhbGl6ZUNhY2hlKHQpfSkpLE1lKCgoKT0+e251bGwhPXImJih0aGlzLl9yZW1vdmVGcm9tQXJyYXkocix0aGlzLl9pbml0aWFsaXplQ2FjaGVTdWJzY3JpcHRpb25zKSx0aGlzLl9yZW1vdmVGcm9tQXJyYXkoZSx0aGlzLl9maXJzdEdyYXBoU3ViamVjdHMkKSl9KSkpLnN1YnNjcmliZSgodD0+e2UubmV4dCh0KSxlLmNvbXBsZXRlKCl9KSwodD0+e2UuZXJyb3IodCl9KSksci5jbG9zZWR8fHRoaXMuX2luaXRpYWxpemVDYWNoZVN1YnNjcmlwdGlvbnMucHVzaChyKTtjb25zdCBzPWkucGlwZSh0ZSgoKCk9PkIoKSkpLE10KChlPT5lLmlzQ2FjaGluZ05vZGVTZXF1ZW5jZSh0KXx8IWUuaGFzTm9kZVNlcXVlbmNlKHQpP2UuY2FjaGVOb2RlU2VxdWVuY2UkKHQpOkcoZSkpKSxVZSgxKSxFKCkpO2xldCBvO2lmKG89cy5waXBlKHBpKChlPT57ZS5nZXROb2RlKHQpLnNlcXVlbmNlRWRnZXMuY2FjaGVkfHxlLmNhY2hlU2VxdWVuY2VFZGdlcyh0KX0pKSxNZSgoKCk9PntudWxsIT1vJiZ0aGlzLl9yZW1vdmVGcm9tQXJyYXkobyx0aGlzLl9zZXF1ZW5jZVN1YnNjcmlwdGlvbnMpfSkpKS5zdWJzY3JpYmUoKCgpPT57fSksKGU9Pntjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgc2VxdWVuY2UgZWRnZXMgKCR7dH0pLmAsZSl9KSksby5jbG9zZWR8fHRoaXMuX3NlcXVlbmNlU3Vic2NyaXB0aW9ucy5wdXNoKG8pLHRoaXMuX2dyYXBoTW9kZT09PXltLlNwYXRpYWwpe2xldCBlO2U9aS5waXBlKHRlKCgoKT0+QigpKSkseGUoKGU9PmUuaGFzVGlsZXModCk/QigpOmJ0KGUuY2FjaGVUaWxlcyQodCkpLnBpcGUoTXQoKGU9PmUucGlwZShNdCgoZT0+ZS5pc0NhY2hpbmdUaWxlcyh0KT9CKCk6RyhlKSkpLHRlKChlPT4oY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGNhY2hlIHRpbGUgZGF0YSAoJHt0fSkuYCxlKSxCKCkpKSkpKSkpKSksSWUoMSksTXQoKGU9PmUuaGFzU3BhdGlhbEFyZWEodCk/RyhlKTpidChlLmNhY2hlU3BhdGlhbEFyZWEkKHQpKS5waXBlKE10KChlPT5lLnBpcGUodGUoKGU9Pihjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY2FjaGUgc3BhdGlhbCBpbWFnZXMgKCR7dH0pLmAsZSksQigpKSkpKSkpKSkpLEllKDEpLE10KChlPT5lLmhhc05vZGVTZXF1ZW5jZSh0KT9HKGUpOmUuY2FjaGVOb2RlU2VxdWVuY2UkKHQpKSkscGkoKGU9PntlLmdldE5vZGUodCkuc3BhdGlhbEVkZ2VzLmNhY2hlZHx8ZS5jYWNoZVNwYXRpYWxFZGdlcyh0KX0pKSxNZSgoKCk9PntudWxsIT1lJiZ0aGlzLl9yZW1vdmVGcm9tQXJyYXkoZSx0aGlzLl9zcGF0aWFsU3Vic2NyaXB0aW9ucyl9KSkpLnN1YnNjcmliZSgoKCk9Pnt9KSwoZT0+e2NvbnN0IGk9YEZhaWxlZCB0byBjYWNoZSBzcGF0aWFsIGVkZ2VzICgke3R9KS5gO2NvbnNvbGUuZXJyb3IoaSxlKX0pKSxlLmNsb3NlZHx8dGhpcy5fc3BhdGlhbFN1YnNjcmlwdGlvbnMucHVzaChlKX1yZXR1cm4gbi5waXBlKEVlKCh0PT50LmFzc2V0c0NhY2hlZCkpKX1jYWNoZVNlcXVlbmNlJCh0KXtyZXR1cm4gdGhpcy5fZ3JhcGgkLnBpcGUoRWUoKSxNdCgoZT0+ZS5pc0NhY2hpbmdTZXF1ZW5jZSh0KXx8IWUuaGFzU2VxdWVuY2UodCk/ZS5jYWNoZVNlcXVlbmNlJCh0KTpHKGUpKSkscnQoKGU9PmUuZ2V0U2VxdWVuY2UodCkpKSl9Y2FjaGVTZXF1ZW5jZUltYWdlcyQodCxlKXtyZXR1cm4gdGhpcy5fZ3JhcGgkLnBpcGUoRWUoKSxNdCgoZT0+ZS5pc0NhY2hpbmdTZXF1ZW5jZSh0KXx8IWUuaGFzU2VxdWVuY2UodCk/ZS5jYWNoZVNlcXVlbmNlJCh0KTpHKGUpKSksTXQoKGk9PmkuaXNDYWNoaW5nU2VxdWVuY2VOb2Rlcyh0KXx8IWkuaGFzU2VxdWVuY2VOb2Rlcyh0KT9pLmNhY2hlU2VxdWVuY2VOb2RlcyQodCxlKTpHKGkpKSkscnQoKGU9PmUuZ2V0U2VxdWVuY2UodCkpKSl9ZGlzcG9zZSgpe3RoaXMuX2dyYXBoJC5waXBlKEVlKCkpLnN1YnNjcmliZSgodD0+e3QudW5zdWJzY3JpYmUoKX0pKSx0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9c2V0RmlsdGVyJCh0KXtyZXR1cm4gdGhpcy5fcmVzZXRTdWJzY3JpcHRpb25zKHRoaXMuX3NwYXRpYWxTdWJzY3JpcHRpb25zKSx0aGlzLl9ncmFwaCQucGlwZShFZSgpLHBpKChlPT57ZS5yZXNldFNwYXRpYWxFZGdlcygpLGUuc2V0RmlsdGVyKHQpfSkpLHJ0KCgoKT0+e30pKSl9c2V0R3JhcGhNb2RlKHQpe3RoaXMuX2dyYXBoTW9kZSE9PXQmJih0PT09eW0uU2VxdWVuY2UmJnRoaXMuX3Jlc2V0U3Vic2NyaXB0aW9ucyh0aGlzLl9zcGF0aWFsU3Vic2NyaXB0aW9ucyksdGhpcy5fZ3JhcGhNb2RlPXQsdGhpcy5fZ3JhcGhNb2RlU3ViamVjdCQubmV4dCh0aGlzLl9ncmFwaE1vZGUpKX1yZXNldCQodCl7cmV0dXJuIHRoaXMuX2Fib3J0U3ViamVjdHModGhpcy5fZmlyc3RHcmFwaFN1YmplY3RzJCksdGhpcy5fcmVzZXRTdWJzY3JpcHRpb25zKHRoaXMuX2luaXRpYWxpemVDYWNoZVN1YnNjcmlwdGlvbnMpLHRoaXMuX3Jlc2V0U3Vic2NyaXB0aW9ucyh0aGlzLl9zZXF1ZW5jZVN1YnNjcmlwdGlvbnMpLHRoaXMuX3Jlc2V0U3Vic2NyaXB0aW9ucyh0aGlzLl9zcGF0aWFsU3Vic2NyaXB0aW9ucyksdGhpcy5fZ3JhcGgkLnBpcGUoRWUoKSxwaSgoZT0+e2UucmVzZXQodCl9KSkscnQoKCgpPT57fSkpKX11bmNhY2hlJCh0LGUsaSl7cmV0dXJuIHRoaXMuX2dyYXBoJC5waXBlKEVlKCkscGkoKG49PntuLnVuY2FjaGUodCxlLGkpfSkpLHJ0KCgoKT0+e30pKSl9X2Fib3J0U3ViamVjdHModCl7Zm9yKGNvbnN0IGUgb2YgdC5zbGljZSgpKXRoaXMuX3JlbW92ZUZyb21BcnJheShlLHQpLGUuZXJyb3IobmV3IEVycm9yKFwiQ2FjaGUgaW1hZ2UgcmVxdWVzdCB3YXMgYWJvcnRlZC5cIikpfV9yZW1vdmVGcm9tQXJyYXkodCxlKXtjb25zdCBpPWUuaW5kZXhPZih0KTstMSE9PWkmJmUuc3BsaWNlKGksMSl9X3Jlc2V0U3Vic2NyaXB0aW9ucyh0KXtmb3IoY29uc3QgZSBvZiB0LnNsaWNlKCkpdGhpcy5fcmVtb3ZlRnJvbUFycmF5KGUsdCksZS5jbG9zZWR8fGUudW5zdWJzY3JpYmUoKX19Y2xhc3MgUnd7Y29uc3RydWN0b3IodCl7dC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/KHRoaXMuX2NhbmNlbEFuaW1hdGlvbkZyYW1lPXQuY2FuY2VsQW5pbWF0aW9uRnJhbWUuYmluZCh0KSx0aGlzLl9yZXF1ZXN0QW5pbWF0aW9uRnJhbWU9dC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh0KSk6dC5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWU/KHRoaXMuX2NhbmNlbEFuaW1hdGlvbkZyYW1lPXQubW96Q2FuY2VsQW5pbWF0aW9uRnJhbWUuYmluZCh0KSx0aGlzLl9yZXF1ZXN0QW5pbWF0aW9uRnJhbWU9dC5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh0KSk6dC53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWU/KHRoaXMuX2NhbmNlbEFuaW1hdGlvbkZyYW1lPXQud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWUuYmluZCh0KSx0aGlzLl9yZXF1ZXN0QW5pbWF0aW9uRnJhbWU9dC53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh0KSk6dC5tc1JlcXVlc3RBbmltYXRpb25GcmFtZT8odGhpcy5fY2FuY2VsQW5pbWF0aW9uRnJhbWU9dC5tc0NhbmNlbEFuaW1hdGlvbkZyYW1lLmJpbmQodCksdGhpcy5fcmVxdWVzdEFuaW1hdGlvbkZyYW1lPXQubXNSZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh0KSk6dC5vUmVxdWVzdEFuaW1hdGlvbkZyYW1lPyh0aGlzLl9jYW5jZWxBbmltYXRpb25GcmFtZT10Lm9DYW5jZWxBbmltYXRpb25GcmFtZS5iaW5kKHQpLHRoaXMuX3JlcXVlc3RBbmltYXRpb25GcmFtZT10Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh0KSk6KHRoaXMuX2NhbmNlbEFuaW1hdGlvbkZyYW1lPXQuY2xlYXJUaW1lb3V0LmJpbmQodCksdGhpcy5fcmVxdWVzdEFuaW1hdGlvbkZyYW1lPWU9PnQuc2V0VGltZW91dChlLDFlMy82MCkpfWdldCBjYW5jZWxBbmltYXRpb25GcmFtZSgpe3JldHVybiB0aGlzLl9jYW5jZWxBbmltYXRpb25GcmFtZX1nZXQgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCl7cmV0dXJuIHRoaXMuX3JlcXVlc3RBbmltYXRpb25GcmFtZX19Y2xhc3MgTHcgZXh0ZW5kcyBVZHtjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KX1zZXRWaWV3TWF0cml4KHQpe2NvbnN0IGU9KG5ldyBIbikuZnJvbUFycmF5KHQpLmludmVydCgpLmVsZW1lbnRzLGk9bmV3IGZuKGVbMTJdLGVbMTNdLGVbMTRdKSxuPW5ldyBmbigtZVs4XSwtZVs5XSwtZVsxMF0pLHI9bmV3IGZuKGVbNF0sZVs1XSxlWzZdKSxzPXRoaXMuX2NhbWVyYTtzLnBvc2l0aW9uLmNvcHkoaSkscy5sb29rYXQuY29weShpLmNsb25lKCkuYWRkKG4pKSxzLnVwLmNvcHkocik7Y29uc3Qgbz0uNS9NYXRoLnRhbihNYXRoLlBJLzMpO3MuZm9jYWw9b319Y2xhc3MgT3cgZXh0ZW5kcyBVZHtjb25zdHJ1Y3Rvcih0KXtzdXBlcih0KTtjb25zdCBlPXRoaXMuX2NhbWVyYS5wb3NpdGlvbi5jbG9uZSgpLGk9dGhpcy5fY2FtZXJhLmxvb2thdC5jbG9uZSgpLnN1YihlKS5ub3JtYWxpemUoKSxuPU1hdGguc3FydChpLngqaS54K2kueSppLnkpLHI9TWF0aC5hdGFuMihpLnosbikscz1uZXcgZm47aWYocj4tTWF0aC5QSS80NSlzLmNvcHkoZSksZS5hZGQobmV3IGZuKGkueCxpLnksMCkubXVsdGlwbHlTY2FsYXIoLTUwKSksZS56PTMwO2Vsc2V7Y29uc3QgdD1lLmNsb25lKCksbj1uZXcgZm4oMCwwLDEpLHI9bmV3IGZuKDAsMCwtMiksbz0obmV3IGZuKS5zdWJWZWN0b3JzKHIsdCkuZG90KG4pL2kuZG90KG4pLGE9MWU0LGM9dC5jbG9uZSgpLmFkZChpLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoTWF0aC5taW4oYSxvKSkpO3MuY29weShjKTtjb25zdCBoPWUuY2xvbmUoKS5zdWIoYykubm9ybWFsaXplKCk7ZS5jb3B5KGMuYWRkKGgubXVsdGlwbHlTY2FsYXIoTWF0aC5tYXgoNTAsaC5sZW5ndGgoKSkpKSl9dGhpcy5fY2FtZXJhLnBvc2l0aW9uLmNvcHkoZSksdGhpcy5fY2FtZXJhLmxvb2thdC5jb3B5KHMpLHRoaXMuX2NhbWVyYS51cC5zZXQoMCwwLDEpfWRvbGx5KHQpe2NvbnN0IGU9dGhpcy5fY2FtZXJhLGk9ZS5wb3NpdGlvbi5jbG9uZSgpLnN1YihlLmxvb2thdCksbj1pLmxlbmd0aCgpKk1hdGgucG93KDIsLXQpLHI9TWF0aC5tYXgoMSxNYXRoLm1pbihuLDRlMykpO2kubm9ybWFsaXplKCksaS5tdWx0aXBseVNjYWxhcihyKSxlLnBvc2l0aW9uLmNvcHkoZS5sb29rYXQpLmFkZChpKX1vcmJpdCh0KXtjb25zdCBlPXRoaXMuX2NhbWVyYSxpPShuZXcgcG4pLnNldEZyb21Vbml0VmVjdG9ycyhlLnVwLG5ldyBmbigwLDAsMSkpLG49aS5jbG9uZSgpLmludmVydCgpLHI9ZS5wb3NpdGlvbi5jbG9uZSgpLnN1YihlLmxvb2thdCk7ci5hcHBseVF1YXRlcm5pb24oaSk7Y29uc3Qgcz1yLmxlbmd0aCgpO2xldCBvPU1hdGguYXRhbjIoci55LHIueCk7bys9dC5waGk7bGV0IGE9TWF0aC5hdGFuMihNYXRoLnNxcnQoci54KnIueCtyLnkqci55KSxyLnopO2ErPXQudGhldGE7Y29uc3QgYz1NYXRoLlBJLzM2O2E9TWF0aC5tYXgoYyxNYXRoLm1pbihNYXRoLlBJLzItYyxhKSksci54PU1hdGguc2luKGEpKk1hdGguY29zKG8pLHIueT1NYXRoLnNpbihhKSpNYXRoLnNpbihvKSxyLno9TWF0aC5jb3MoYSksci5hcHBseVF1YXRlcm5pb24obiksZS5wb3NpdGlvbi5jb3B5KGUubG9va2F0KS5hZGQoci5tdWx0aXBseVNjYWxhcihzKSl9dHJ1Y2sodCl7Y29uc3QgZT10aGlzLl9jYW1lcmE7ZS5wb3NpdGlvbi5hZGQoKG5ldyBmbikuZnJvbUFycmF5KHQpKSxlLmxvb2thdC5hZGQoKG5ldyBmbikuZnJvbUFycmF5KHQpKX11cGRhdGUoKXt9fWNsYXNzIE53IGV4dGVuZHMgR2R7Y29uc3RydWN0b3IodCl7c3VwZXIodCksdGhpcy5fYWRqdXN0Q2FtZXJhcygpLHRoaXMuX21vdGlvbmxlc3M9dGhpcy5fbW90aW9ubGVzc1RyYW5zaXRpb24oKX1wcmVwZW5kKHQpe3N1cGVyLnByZXBlbmQodCksdGhpcy5fbW90aW9ubGVzcz10aGlzLl9tb3Rpb25sZXNzVHJhbnNpdGlvbigpfXNldCh0KXtzdXBlci5zZXQodCksdGhpcy5fbW90aW9ubGVzcz10aGlzLl9tb3Rpb25sZXNzVHJhbnNpdGlvbigpfW1vdmUodCl7dGhpcy5fYWxwaGE9TWF0aC5tYXgoMCxNYXRoLm1pbigxLHRoaXMuX2FscGhhK3QpKX1tb3ZlVG8odCl7dGhpcy5fYWxwaGE9TWF0aC5tYXgoMCxNYXRoLm1pbigxLHQpKX11cGRhdGUodCl7dGhpcy5fdXBkYXRlUm90YXRpb24oKSx0aGlzLl9yb3RhdGlvbkRlbHRhLmlzWmVyb3x8KHRoaXMuX2FwcGx5Um90YXRpb24odGhpcy5fcm90YXRpb25EZWx0YSx0aGlzLl9wcmV2aW91c0NhbWVyYSksdGhpcy5fYXBwbHlSb3RhdGlvbih0aGlzLl9yb3RhdGlvbkRlbHRhLHRoaXMuX2N1cnJlbnRDYW1lcmEpKSx0aGlzLl91cGRhdGVSb3RhdGlvbkJhc2ljKCksMD09PXRoaXMuX2Jhc2ljUm90YXRpb25bMF0mJjA9PT10aGlzLl9iYXNpY1JvdGF0aW9uWzFdfHx0aGlzLl9hcHBseVJvdGF0aW9uQmFzaWModGhpcy5fYmFzaWNSb3RhdGlvbik7bGV0IGU9dGhpcy5fYW5pbWF0aW9uU3BlZWQqKDYwL3QpO3RoaXMuX3VwZGF0ZVpvb20oZSksdGhpcy5fdXBkYXRlTG9va2F0KGUpLHRoaXMuX2NhbWVyYS5sZXJwQ2FtZXJhcyh0aGlzLl9wcmV2aW91c0NhbWVyYSx0aGlzLl9jdXJyZW50Q2FtZXJhLHRoaXMuYWxwaGEpfV9nZXRBbHBoYSgpe3JldHVybiB0aGlzLl9tb3Rpb25sZXNzP01hdGgucm91bmQodGhpcy5fYWxwaGEpOnRoaXMuX2FscGhhfV9zZXRDdXJyZW50Q2FtZXJhKCl7c3VwZXIuX3NldEN1cnJlbnRDYW1lcmEoKSx0aGlzLl9hZGp1c3RDYW1lcmFzKCl9X2FkanVzdENhbWVyYXMoKXtpZihudWxsIT10aGlzLl9wcmV2aW91c0ltYWdlKXtpZihkZCh0aGlzLl9jdXJyZW50SW1hZ2UuY2FtZXJhVHlwZSkpe2xldCB0PXRoaXMuX2NhbWVyYS5sb29rYXQuY2xvbmUoKS5zdWIodGhpcy5fY2FtZXJhLnBvc2l0aW9uKTt0aGlzLl9jdXJyZW50Q2FtZXJhLmxvb2thdC5jb3B5KHQuY2xvbmUoKS5hZGQodGhpcy5fY3VycmVudENhbWVyYS5wb3NpdGlvbikpfWlmKGRkKHRoaXMuX3ByZXZpb3VzSW1hZ2UuY2FtZXJhVHlwZSkpe2xldCB0PXRoaXMuX2N1cnJlbnRDYW1lcmEubG9va2F0LmNsb25lKCkuc3ViKHRoaXMuX2N1cnJlbnRDYW1lcmEucG9zaXRpb24pO3RoaXMuX3ByZXZpb3VzQ2FtZXJhLmxvb2thdC5jb3B5KHQuY2xvbmUoKS5hZGQodGhpcy5fcHJldmlvdXNDYW1lcmEucG9zaXRpb24pKX19fX1jbGFzcyBEdyBleHRlbmRzIFVke2NvbnN0cnVjdG9yKHQpe3N1cGVyKHQpLHRoaXMuX3pvb209MCx0aGlzLl9hZGp1c3RDYW1lcmFzKCksdGhpcy5fbW90aW9ubGVzcz10aGlzLl9tb3Rpb25sZXNzVHJhbnNpdGlvbigpfXByZXBlbmQodCl7c3VwZXIucHJlcGVuZCh0KSx0aGlzLl9tb3Rpb25sZXNzPXRoaXMuX21vdGlvbmxlc3NUcmFuc2l0aW9uKCl9c2V0KHQpe3N1cGVyLnNldCh0KSx0aGlzLl9tb3Rpb25sZXNzPXRoaXMuX21vdGlvbmxlc3NUcmFuc2l0aW9uKCl9bW92ZSh0KXt0aGlzLl9hbHBoYT1NYXRoLm1heCgwLE1hdGgubWluKDEsdGhpcy5fYWxwaGErdCkpfW1vdmVUbyh0KXt0aGlzLl9hbHBoYT1NYXRoLm1heCgwLE1hdGgubWluKDEsdCkpfXVwZGF0ZSh0KXt0aGlzLl9jYW1lcmEubGVycENhbWVyYXModGhpcy5fcHJldmlvdXNDYW1lcmEsdGhpcy5fY3VycmVudENhbWVyYSx0aGlzLmFscGhhKX1fZ2V0QWxwaGEoKXtyZXR1cm4gdGhpcy5fbW90aW9ubGVzcz9NYXRoLnJvdW5kKHRoaXMuX2FscGhhKTp0aGlzLl9hbHBoYX1fc2V0Q3VycmVudENhbWVyYSgpe3N1cGVyLl9zZXRDdXJyZW50Q2FtZXJhKCksdGhpcy5fYWRqdXN0Q2FtZXJhcygpfV9hZGp1c3RDYW1lcmFzKCl7aWYobnVsbCE9dGhpcy5fcHJldmlvdXNJbWFnZSl7aWYoZGQodGhpcy5fY3VycmVudEltYWdlLmNhbWVyYVR5cGUpKXtsZXQgdD10aGlzLl9jYW1lcmEubG9va2F0LmNsb25lKCkuc3ViKHRoaXMuX2NhbWVyYS5wb3NpdGlvbik7dGhpcy5fY3VycmVudENhbWVyYS5sb29rYXQuY29weSh0LmNsb25lKCkuYWRkKHRoaXMuX2N1cnJlbnRDYW1lcmEucG9zaXRpb24pKX1pZihkZCh0aGlzLl9wcmV2aW91c0ltYWdlLmNhbWVyYVR5cGUpKXtsZXQgdD10aGlzLl9jdXJyZW50Q2FtZXJhLmxvb2thdC5jbG9uZSgpLnN1Yih0aGlzLl9jdXJyZW50Q2FtZXJhLnBvc2l0aW9uKTt0aGlzLl9wcmV2aW91c0NhbWVyYS5sb29rYXQuY29weSh0LmNsb25lKCkuYWRkKHRoaXMuX3ByZXZpb3VzQ2FtZXJhLnBvc2l0aW9uKSl9fX19Y2xhc3MgJHd7Y29uc3RydWN0b3IoKXtjb25zdCB0PXZtW3ZtLkN1c3RvbV0sZT12bVt2bS5FYXJ0aF0saT12bVt2bS5UcmF2ZXJzaW5nXSxuPXZtW3ZtLldhaXRpbmddLHI9dm1bdm0uV2FpdGluZ0ludGVyYWN0aXZlbHldO3RoaXMuX2NyZWF0b3JzPW5ldyBNYXA7Y29uc3Qgcz10aGlzLl9jcmVhdG9ycztzLnNldCh0LEx3KSxzLnNldChlLE93KSxzLnNldChpLHFkKSxzLnNldChuLER3KSxzLnNldChyLE53KSx0aGlzLl90cmFuc2l0aW9ucz1uZXcgTWFwO2NvbnN0IG89dGhpcy5fdHJhbnNpdGlvbnM7by5zZXQodCxbZSxpXSksby5zZXQoZSxbdCxpXSksby5zZXQoaSxbdCxlLG4scl0pLG8uc2V0KG4sW2kscl0pLG8uc2V0KHIsW2ksbl0pfWdldFN0YXRlKHQpe2lmKHQgaW5zdGFuY2VvZiBMdylyZXR1cm4gdm0uQ3VzdG9tO2lmKHQgaW5zdGFuY2VvZiBPdylyZXR1cm4gdm0uRWFydGg7aWYodCBpbnN0YW5jZW9mIHFkKXJldHVybiB2bS5UcmF2ZXJzaW5nO2lmKHQgaW5zdGFuY2VvZiBEdylyZXR1cm4gdm0uV2FpdGluZztpZih0IGluc3RhbmNlb2YgTncpcmV0dXJuIHZtLldhaXRpbmdJbnRlcmFjdGl2ZWx5O3Rocm93IG5ldyBFcnJvcihcIkludmFsaWQgc3RhdGUgaW5zdGFuY2VcIil9Z2VuZXJhdGUodCxlKXtyZXR1cm4gbmV3KHRoaXMuX2NyZWF0b3JzLmdldCh2bVt0XSkpKGUpfXRyYW5zaXRpb24odCxlKXtpZighdGhpcy52YWxpZGF0ZSh0LGUpKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdHJhbnNpdGlvblwiKTtyZXR1cm4gdGhpcy5nZW5lcmF0ZShlLHQpfXZhbGlkYXRlKHQsZSl7Y29uc3QgaT12bVt0aGlzLmdldFN0YXRlKHQpXSxuPXZtW2VdLHI9dGhpcy5fdHJhbnNpdGlvbnM7cmV0dXJuIHIuaGFzKGkpJiZyLmdldChpKS5pbmNsdWRlcyhuKX19Y2xhc3Mga3d7Y29uc3RydWN0b3IoZSxpKXt0aGlzLl90cmFuc2l0aW9ucz1uZXcgJHcsdGhpcy5fc3RhdGU9dGhpcy5fdHJhbnNpdGlvbnMuZ2VuZXJhdGUoZSx7YWxwaGE6MSxjYW1lcmE6bmV3IGpkLGN1cnJlbnRJbmRleDotMSxyZWZlcmVuY2U6e2FsdDowLGxhdDowLGxuZzowfSx0cmFqZWN0b3J5OltdLHRyYW5zaXRpb25Nb2RlOm51bGw9PWk/dC5UcmFuc2l0aW9uTW9kZS5EZWZhdWx0Omksem9vbTowfSl9Z2V0IHN0YXRlKCl7cmV0dXJuIHRoaXMuX3RyYW5zaXRpb25zLmdldFN0YXRlKHRoaXMuX3N0YXRlKX1nZXQgcmVmZXJlbmNlKCl7cmV0dXJuIHRoaXMuX3N0YXRlLnJlZmVyZW5jZX1nZXQgYWxwaGEoKXtyZXR1cm4gdGhpcy5fc3RhdGUuYWxwaGF9Z2V0IGNhbWVyYSgpe3JldHVybiB0aGlzLl9zdGF0ZS5jYW1lcmF9Z2V0IHpvb20oKXtyZXR1cm4gdGhpcy5fc3RhdGUuem9vbX1nZXQgY3VycmVudEltYWdlKCl7cmV0dXJuIHRoaXMuX3N0YXRlLmN1cnJlbnRJbWFnZX1nZXQgcHJldmlvdXNJbWFnZSgpe3JldHVybiB0aGlzLl9zdGF0ZS5wcmV2aW91c0ltYWdlfWdldCBjdXJyZW50Q2FtZXJhKCl7cmV0dXJuIHRoaXMuX3N0YXRlLmN1cnJlbnRDYW1lcmF9Z2V0IGN1cnJlbnRUcmFuc2Zvcm0oKXtyZXR1cm4gdGhpcy5fc3RhdGUuY3VycmVudFRyYW5zZm9ybX1nZXQgcHJldmlvdXNUcmFuc2Zvcm0oKXtyZXR1cm4gdGhpcy5fc3RhdGUucHJldmlvdXNUcmFuc2Zvcm19Z2V0IHRyYWplY3RvcnkoKXtyZXR1cm4gdGhpcy5fc3RhdGUudHJhamVjdG9yeX1nZXQgY3VycmVudEluZGV4KCl7cmV0dXJuIHRoaXMuX3N0YXRlLmN1cnJlbnRJbmRleH1nZXQgbGFzdEltYWdlKCl7cmV0dXJuIHRoaXMuX3N0YXRlLnRyYWplY3RvcnlbdGhpcy5fc3RhdGUudHJhamVjdG9yeS5sZW5ndGgtMV19Z2V0IGltYWdlc0FoZWFkKCl7cmV0dXJuIHRoaXMuX3N0YXRlLnRyYWplY3RvcnkubGVuZ3RoLTEtdGhpcy5fc3RhdGUuY3VycmVudEluZGV4fWdldCBtb3Rpb25sZXNzKCl7cmV0dXJuIHRoaXMuX3N0YXRlLm1vdGlvbmxlc3N9Y3VzdG9tKCl7dGhpcy5fdHJhbnNpdGlvbih2bS5DdXN0b20pfWVhcnRoKCl7dGhpcy5fdHJhbnNpdGlvbih2bS5FYXJ0aCl9dHJhdmVyc2UoKXt0aGlzLl90cmFuc2l0aW9uKHZtLlRyYXZlcnNpbmcpfXdhaXQoKXt0aGlzLl90cmFuc2l0aW9uKHZtLldhaXRpbmcpfXdhaXRJbnRlcmFjdGl2ZWx5KCl7dGhpcy5fdHJhbnNpdGlvbih2bS5XYWl0aW5nSW50ZXJhY3RpdmVseSl9Z2V0Q2VudGVyKCl7cmV0dXJuIHRoaXMuX3N0YXRlLmdldENlbnRlcigpfXNldENlbnRlcih0KXt0aGlzLl9zdGF0ZS5zZXRDZW50ZXIodCl9c2V0Wm9vbSh0KXt0aGlzLl9zdGF0ZS5zZXRab29tKHQpfXVwZGF0ZSh0KXt0aGlzLl9zdGF0ZS51cGRhdGUodCl9YXBwZW5kKHQpe3RoaXMuX3N0YXRlLmFwcGVuZCh0KX1wcmVwZW5kKHQpe3RoaXMuX3N0YXRlLnByZXBlbmQodCl9cmVtb3ZlKHQpe3RoaXMuX3N0YXRlLnJlbW92ZSh0KX1jbGVhcigpe3RoaXMuX3N0YXRlLmNsZWFyKCl9Y2xlYXJQcmlvcigpe3RoaXMuX3N0YXRlLmNsZWFyUHJpb3IoKX1jdXQoKXt0aGlzLl9zdGF0ZS5jdXQoKX1zZXQodCl7dGhpcy5fc3RhdGUuc2V0KHQpfXNldFZpZXdNYXRyaXgodCl7dGhpcy5fc3RhdGUuc2V0Vmlld01hdHJpeCh0KX1yb3RhdGUodCl7dGhpcy5fc3RhdGUucm90YXRlKHQpfXJvdGF0ZVVuYm91bmRlZCh0KXt0aGlzLl9zdGF0ZS5yb3RhdGVVbmJvdW5kZWQodCl9cm90YXRlV2l0aG91dEluZXJ0aWEodCl7dGhpcy5fc3RhdGUucm90YXRlV2l0aG91dEluZXJ0aWEodCl9cm90YXRlQmFzaWModCl7dGhpcy5fc3RhdGUucm90YXRlQmFzaWModCl9cm90YXRlQmFzaWNVbmJvdW5kZWQodCl7dGhpcy5fc3RhdGUucm90YXRlQmFzaWNVbmJvdW5kZWQodCl9cm90YXRlQmFzaWNXaXRob3V0SW5lcnRpYSh0KXt0aGlzLl9zdGF0ZS5yb3RhdGVCYXNpY1dpdGhvdXRJbmVydGlhKHQpfXJvdGF0ZVRvQmFzaWModCl7dGhpcy5fc3RhdGUucm90YXRlVG9CYXNpYyh0KX1tb3ZlKHQpe3RoaXMuX3N0YXRlLm1vdmUodCl9bW92ZVRvKHQpe3RoaXMuX3N0YXRlLm1vdmVUbyh0KX16b29tSW4odCxlKXt0aGlzLl9zdGF0ZS56b29tSW4odCxlKX1zZXRTcGVlZCh0KXt0aGlzLl9zdGF0ZS5zZXRTcGVlZCh0KX1zZXRUcmFuc2l0aW9uTW9kZSh0KXt0aGlzLl9zdGF0ZS5zZXRUcmFuc2l0aW9uTW9kZSh0KX1kb2xseSh0KXt0aGlzLl9zdGF0ZS5kb2xseSh0KX1vcmJpdCh0KXt0aGlzLl9zdGF0ZS5vcmJpdCh0KX10cnVjayh0KXt0aGlzLl9zdGF0ZS50cnVjayh0KX1fdHJhbnNpdGlvbih0KXtpZighdGhpcy5fdHJhbnNpdGlvbnMudmFsaWRhdGUodGhpcy5fc3RhdGUsdCkpe2NvbnN0IGU9dGhpcy5fdHJhbnNpdGlvbnMuZ2V0U3RhdGUodGhpcy5fc3RhdGUpO3JldHVybiB2b2lkIGNvbnNvbGUud2FybihgVHJhbnNpdGlvbiBub3QgdmFsaWQgKCR7dm1bZV19IC0gJHt2bVt0XX0pYCl9Y29uc3QgZT10aGlzLl90cmFuc2l0aW9ucy50cmFuc2l0aW9uKHRoaXMuX3N0YXRlLHQpO3RoaXMuX3N0YXRlPWV9fWNsYXNzIHp3e2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5fYXBwZW5kSW1hZ2UkPW5ldyBULHRoaXMuX3N1YnNjcmlwdGlvbnM9bmV3IFVmO2NvbnN0IGk9dGhpcy5fc3Vic2NyaXB0aW9uczt0aGlzLl9zdGFydCQ9bmV3IFQsdGhpcy5fZnJhbWUkPW5ldyBULHRoaXMuX2Zwc1NhbXBsZVJhdGU9MzAsdGhpcy5fY29udGV4dE9wZXJhdGlvbiQ9bmV3IE8oKHQ9PnQpKSx0aGlzLl9jb250ZXh0JD10aGlzLl9jb250ZXh0T3BlcmF0aW9uJC5waXBlKExlKCgodCxlKT0+ZSh0KSksbmV3IGt3KHQsZSkpLFVlKDEpLEUoKSksdGhpcy5fc3RhdGUkPXRoaXMuX2NvbnRleHQkLnBpcGUocnQoKHQ9PnQuc3RhdGUpKSx1ZSgpLFVlKDEpLEUoKSksdGhpcy5fZnBzJD10aGlzLl9zdGFydCQucGlwZShyaSgoKCk9PnRoaXMuX2ZyYW1lJC5waXBlKFh0KDEsdGhpcy5fZnBzU2FtcGxlUmF0ZSkscnQoKCgpPT4obmV3IERhdGUpLmdldFRpbWUoKSkpLHplKCkscnQoKHQ9Pk1hdGgubWF4KDIwLDFlMyp0aGlzLl9mcHNTYW1wbGVSYXRlLyh0WzFdLXRbMF0pKSkpLG5pKDYwKSkpKSxaZSgpKSx0aGlzLl9jdXJyZW50U3RhdGUkPXRoaXMuX2ZyYW1lJC5waXBlKGJpKHRoaXMuX2ZwcyQsdGhpcy5fY29udGV4dCQsKCh0LGUsaSk9Plt0LGUsaV0pKSxOdCgodD0+bnVsbCE9dFsyXS5jdXJyZW50SW1hZ2UpKSxwaSgodD0+e3RbMl0udXBkYXRlKHRbMV0pfSkpLHJ0KCh0PT4oe2Zwczp0WzFdLGlkOnRbMF0sc3RhdGU6dFsyXX0pKSksWmUoKSksdGhpcy5fbGFzdFN0YXRlJD10aGlzLl9jdXJyZW50U3RhdGUkLnBpcGUoVWUoMSksRSgpKTtsZXQgbj10aGlzLl9jdXJyZW50U3RhdGUkLnBpcGUodWUodm9pZCAwLCh0PT50LnN0YXRlLmN1cnJlbnRJbWFnZS5pZCkpLFVlKDEpLEUoKSkscj1uZXcgVDtpLnB1c2gobi5zdWJzY3JpYmUocikpLHRoaXMuX2N1cnJlbnRJZCQ9bmV3IE8obnVsbCksaS5wdXNoKHIucGlwZShydCgodD0+dC5zdGF0ZS5jdXJyZW50SW1hZ2UuaWQpKSkuc3Vic2NyaWJlKHRoaXMuX2N1cnJlbnRJZCQpKSx0aGlzLl9jdXJyZW50SW1hZ2UkPXIucGlwZShydCgodD0+dC5zdGF0ZS5jdXJyZW50SW1hZ2UpKSxVZSgxKSxFKCkpLHRoaXMuX2N1cnJlbnRDYW1lcmEkPXIucGlwZShydCgodD0+dC5zdGF0ZS5jdXJyZW50Q2FtZXJhKSksVWUoMSksRSgpKSx0aGlzLl9jdXJyZW50VHJhbnNmb3JtJD1yLnBpcGUocnQoKHQ9PnQuc3RhdGUuY3VycmVudFRyYW5zZm9ybSkpLFVlKDEpLEUoKSksdGhpcy5fcmVmZXJlbmNlJD1yLnBpcGUocnQoKHQ9PnQuc3RhdGUucmVmZXJlbmNlKSksdWUoKCh0LGUpPT50LmxhdD09PWUubGF0JiZ0LmxuZz09PWUubG5nKSwodD0+KHtsYXQ6dC5sYXQsbG5nOnQubG5nfSkpKSxVZSgxKSxFKCkpLHRoaXMuX2N1cnJlbnRJbWFnZUV4dGVybmFsJD1uLnBpcGUocnQoKHQ9PnQuc3RhdGUuY3VycmVudEltYWdlKSksVWUoMSksRSgpKSxpLnB1c2godGhpcy5fYXBwZW5kSW1hZ2UkLnBpcGUocnQoKHQ9PmU9PihlLmFwcGVuZChbdF0pLGUpKSkpLnN1YnNjcmliZSh0aGlzLl9jb250ZXh0T3BlcmF0aW9uJCkpLHRoaXMuX2luTW90aW9uT3BlcmF0aW9uJD1uZXcgVCxpLnB1c2gobi5waXBlKHJ0KCgoKT0+ITApKSkuc3Vic2NyaWJlKHRoaXMuX2luTW90aW9uT3BlcmF0aW9uJCkpLGkucHVzaCh0aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQucGlwZSh1ZSgpLE50KCh0PT50KSkscmkoKCgpPT50aGlzLl9jdXJyZW50U3RhdGUkLnBpcGUoTnQoKHQ9PjA9PT10LnN0YXRlLmltYWdlc0FoZWFkKSkscnQoKHQ9Plt0LnN0YXRlLmNhbWVyYS5jbG9uZSgpLHQuc3RhdGUuem9vbV0pKSx6ZSgpLHJ0KCh0PT57bGV0IGU9dFswXVswXSxpPXRbMV1bMF0sbj10WzBdWzFdLHI9dFsxXVsxXTtyZXR1cm4gZS5kaWZmKGkpPjFlLTV8fE1hdGguYWJzKG4tcik+MWUtNX0pKSxFZSgodD0+IXQpKSkpKSkuc3Vic2NyaWJlKHRoaXMuX2luTW90aW9uT3BlcmF0aW9uJCkpLHRoaXMuX2luTW90aW9uJD10aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQucGlwZSh1ZSgpLFVlKDEpLEUoKSksdGhpcy5faW5UcmFuc2xhdGlvbk9wZXJhdGlvbiQ9bmV3IFQsaS5wdXNoKG4ucGlwZShydCgoKCk9PiEwKSkpLnN1YnNjcmliZSh0aGlzLl9pblRyYW5zbGF0aW9uT3BlcmF0aW9uJCkpLGkucHVzaCh0aGlzLl9pblRyYW5zbGF0aW9uT3BlcmF0aW9uJC5waXBlKHVlKCksTnQoKHQ9PnQpKSxyaSgoKCk9PnRoaXMuX2N1cnJlbnRTdGF0ZSQucGlwZShOdCgodD0+MD09PXQuc3RhdGUuaW1hZ2VzQWhlYWQpKSxydCgodD0+dC5zdGF0ZS5jYW1lcmEucG9zaXRpb24uY2xvbmUoKSkpLHplKCkscnQoKHQ9PjAhPT10WzBdLmRpc3RhbmNlVG9TcXVhcmVkKHRbMV0pKSksRWUoKHQ9PiF0KSkpKSkpLnN1YnNjcmliZSh0aGlzLl9pblRyYW5zbGF0aW9uT3BlcmF0aW9uJCkpLHRoaXMuX2luVHJhbnNsYXRpb24kPXRoaXMuX2luVHJhbnNsYXRpb25PcGVyYXRpb24kLnBpcGUodWUoKSxVZSgxKSxFKCkpLGkucHVzaCh0aGlzLl9zdGF0ZSQuc3Vic2NyaWJlKCgoKT0+e30pKSksaS5wdXNoKHRoaXMuX2N1cnJlbnRJbWFnZSQuc3Vic2NyaWJlKCgoKT0+e30pKSksaS5wdXNoKHRoaXMuX2N1cnJlbnRDYW1lcmEkLnN1YnNjcmliZSgoKCk9Pnt9KSkpLGkucHVzaCh0aGlzLl9jdXJyZW50VHJhbnNmb3JtJC5zdWJzY3JpYmUoKCgpPT57fSkpKSxpLnB1c2godGhpcy5fcmVmZXJlbmNlJC5zdWJzY3JpYmUoKCgpPT57fSkpKSxpLnB1c2godGhpcy5fY3VycmVudEltYWdlRXh0ZXJuYWwkLnN1YnNjcmliZSgoKCk9Pnt9KSkpLGkucHVzaCh0aGlzLl9sYXN0U3RhdGUkLnN1YnNjcmliZSgoKCk9Pnt9KSkpLGkucHVzaCh0aGlzLl9pbk1vdGlvbiQuc3Vic2NyaWJlKCgoKT0+e30pKSksaS5wdXNoKHRoaXMuX2luVHJhbnNsYXRpb24kLnN1YnNjcmliZSgoKCk9Pnt9KSkpLHRoaXMuX2ZyYW1lSWQ9bnVsbCx0aGlzLl9mcmFtZUdlbmVyYXRvcj1uZXcgUncod2luZG93KX1nZXQgY3VycmVudFN0YXRlJCgpe3JldHVybiB0aGlzLl9jdXJyZW50U3RhdGUkfWdldCBjdXJyZW50SW1hZ2UkKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRJbWFnZSR9Z2V0IGN1cnJlbnRJZCQoKXtyZXR1cm4gdGhpcy5fY3VycmVudElkJH1nZXQgY3VycmVudEltYWdlRXh0ZXJuYWwkKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRJbWFnZUV4dGVybmFsJH1nZXQgY3VycmVudENhbWVyYSQoKXtyZXR1cm4gdGhpcy5fY3VycmVudENhbWVyYSR9Z2V0IGN1cnJlbnRUcmFuc2Zvcm0kKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRUcmFuc2Zvcm0kfWdldCBzdGF0ZSQoKXtyZXR1cm4gdGhpcy5fc3RhdGUkfWdldCByZWZlcmVuY2UkKCl7cmV0dXJuIHRoaXMuX3JlZmVyZW5jZSR9Z2V0IGluTW90aW9uJCgpe3JldHVybiB0aGlzLl9pbk1vdGlvbiR9Z2V0IGluVHJhbnNsYXRpb24kKCl7cmV0dXJuIHRoaXMuX2luVHJhbnNsYXRpb24kfWdldCBhcHBlbmRJbWFnZSQoKXtyZXR1cm4gdGhpcy5fYXBwZW5kSW1hZ2UkfWRpc3Bvc2UoKXt0aGlzLnN0b3AoKSx0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9Y3VzdG9tKCl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKHQ9Pnt0LmN1c3RvbSgpfSkpfWVhcnRoKCl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKHQ9Pnt0LmVhcnRoKCl9KSl9dHJhdmVyc2UoKXt0aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQubmV4dCghMCksdGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigodD0+e3QudHJhdmVyc2UoKX0pKX13YWl0KCl7dGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigodD0+e3Qud2FpdCgpfSkpfXdhaXRJbnRlcmFjdGl2ZWx5KCl7dGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigodD0+e3Qud2FpdEludGVyYWN0aXZlbHkoKX0pKX1hcHBlbmRJbWFnZXNzKHQpe3RoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLmFwcGVuZCh0KX0pKX1wcmVwZW5kSW1hZ2VzKHQpe3RoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLnByZXBlbmQodCl9KSl9cmVtb3ZlSW1hZ2VzKHQpe3RoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLnJlbW92ZSh0KX0pKX1jbGVhckltYWdlcygpe3RoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKHQ9Pnt0LmNsZWFyKCl9KSl9Y2xlYXJQcmlvckltYWdlcygpe3RoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKHQ9Pnt0LmNsZWFyUHJpb3IoKX0pKX1jdXRJbWFnZXMoKXt0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKCh0PT57dC5jdXQoKX0pKX1zZXRJbWFnZXModCl7dGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2Uuc2V0KHQpfSkpfXNldFZpZXdNYXRyaXgodCl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLnNldFZpZXdNYXRyaXgodCl9KSl9cm90YXRlKHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5yb3RhdGUodCl9KSl9cm90YXRlVW5ib3VuZGVkKHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5yb3RhdGVVbmJvdW5kZWQodCl9KSl9cm90YXRlV2l0aG91dEluZXJ0aWEodCl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLnJvdGF0ZVdpdGhvdXRJbmVydGlhKHQpfSkpfXJvdGF0ZUJhc2ljKHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5yb3RhdGVCYXNpYyh0KX0pKX1yb3RhdGVCYXNpY1VuYm91bmRlZCh0KXt0aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQubmV4dCghMCksdGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2Uucm90YXRlQmFzaWNVbmJvdW5kZWQodCl9KSl9cm90YXRlQmFzaWNXaXRob3V0SW5lcnRpYSh0KXt0aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQubmV4dCghMCksdGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2Uucm90YXRlQmFzaWNXaXRob3V0SW5lcnRpYSh0KX0pKX1yb3RhdGVUb0Jhc2ljKHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5yb3RhdGVUb0Jhc2ljKHQpfSkpfW1vdmUodCl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLm1vdmUodCl9KSl9bW92ZVRvKHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5tb3ZlVG8odCl9KSl9ZG9sbHkodCl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGU9PntlLmRvbGx5KHQpfSkpfW9yYml0KHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5vcmJpdCh0KX0pKX10cnVjayh0KXt0aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQubmV4dCghMCksdGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2UudHJ1Y2sodCl9KSl9em9vbUluKHQsZSl7dGhpcy5faW5Nb3Rpb25PcGVyYXRpb24kLm5leHQoITApLHRoaXMuX2ludm9rZUNvbnRleHRPcGVyYXRpb24oKGk9PntpLnpvb21Jbih0LGUpfSkpfWdldENlbnRlcigpe3JldHVybiB0aGlzLl9sYXN0U3RhdGUkLnBpcGUoRWUoKSxydCgodD0+dC5zdGF0ZS5nZXRDZW50ZXIoKSkpKX1nZXRab29tKCl7cmV0dXJuIHRoaXMuX2xhc3RTdGF0ZSQucGlwZShFZSgpLHJ0KCh0PT50LnN0YXRlLnpvb20pKSl9c2V0Q2VudGVyKHQpe3RoaXMuX2luTW90aW9uT3BlcmF0aW9uJC5uZXh0KCEwKSx0aGlzLl9pbnZva2VDb250ZXh0T3BlcmF0aW9uKChlPT57ZS5zZXRDZW50ZXIodCl9KSl9c2V0U3BlZWQodCl7dGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2Uuc2V0U3BlZWQodCl9KSl9c2V0VHJhbnNpdGlvbk1vZGUodCl7dGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2Uuc2V0VHJhbnNpdGlvbk1vZGUodCl9KSl9c2V0Wm9vbSh0KXt0aGlzLl9pbk1vdGlvbk9wZXJhdGlvbiQubmV4dCghMCksdGhpcy5faW52b2tlQ29udGV4dE9wZXJhdGlvbigoZT0+e2Uuc2V0Wm9vbSh0KX0pKX1zdGFydCgpe251bGw9PXRoaXMuX2ZyYW1lSWQmJih0aGlzLl9zdGFydCQubmV4dChudWxsKSx0aGlzLl9mcmFtZUlkPXRoaXMuX2ZyYW1lR2VuZXJhdG9yLnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9mcmFtZS5iaW5kKHRoaXMpKSx0aGlzLl9mcmFtZSQubmV4dCh0aGlzLl9mcmFtZUlkKSl9c3RvcCgpe251bGwhPXRoaXMuX2ZyYW1lSWQmJih0aGlzLl9mcmFtZUdlbmVyYXRvci5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl9mcmFtZUlkKSx0aGlzLl9mcmFtZUlkPW51bGwpfV9pbnZva2VDb250ZXh0T3BlcmF0aW9uKHQpe3RoaXMuX2NvbnRleHRPcGVyYXRpb24kLm5leHQoKGU9Pih0KGUpLGUpKSl9X2ZyYW1lKCl7dGhpcy5fZnJhbWVJZD10aGlzLl9mcmFtZUdlbmVyYXRvci5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fZnJhbWUuYmluZCh0aGlzKSksdGhpcy5fZnJhbWUkLm5leHQodGhpcy5fZnJhbWVJZCl9fWZ1bmN0aW9uIEZ3KGUpe3N3aXRjaChlKXtjYXNlIHQuQ2FtZXJhQ29udHJvbHMuQ3VzdG9tOnJldHVybiB2bS5DdXN0b207Y2FzZSB0LkNhbWVyYUNvbnRyb2xzLkVhcnRoOnJldHVybiB2bS5FYXJ0aDtjYXNlIHQuQ2FtZXJhQ29udHJvbHMuU3RyZWV0OnJldHVybiB2bS5UcmF2ZXJzaW5nO2RlZmF1bHQ6cmV0dXJuIG51bGx9fWNsYXNzIEJ3e2NvbnN0cnVjdG9yKGUsaSxuLHIscyxvLGEsYyl7dmFyIGg7aWYoaSl0aGlzLl9hcGk9aTtlbHNlIGlmKGUuZGF0YVByb3ZpZGVyKXtpZighKGUuZGF0YVByb3ZpZGVyIGluc3RhbmNlb2YgUXgpKXRocm93IG5ldyBFcnJvcihcIkluY29ycmVjdCB0eXBlOiAnZGF0YVByb3ZpZGVyJyBtdXN0IGV4dGVuZCB0aGUgRGF0YVByb3ZpZGVyQmFzZSBjbGFzcy5cIik7dGhpcy5fYXBpPW5ldyBBdyhlLmRhdGFQcm92aWRlcil9ZWxzZSB0aGlzLl9hcGk9bmV3IEF3KG5ldyBzdyh7YWNjZXNzVG9rZW46ZS5hY2Nlc3NUb2tlbn0pKTt0aGlzLl9ncmFwaFNlcnZpY2U9bnVsbCE9bj9uOm5ldyBQdyhuZXcgdmQodGhpcy5hcGkpKSx0aGlzLl9sb2FkaW5nTmFtZT1cIm5hdmlnYXRvclwiLHRoaXMuX2xvYWRpbmdTZXJ2aWNlPW51bGwhPXI/cjpuZXcgQ3c7Y29uc3QgbD1udWxsIT09KGg9ZS5jYW1lcmFDb250cm9scykmJnZvaWQgMCE9PWg/aDp0LkNhbWVyYUNvbnRyb2xzLlN0cmVldDt0aGlzLl9zdGF0ZVNlcnZpY2U9bnVsbCE9cz9zOm5ldyB6dyhGdyhsKSxlLnRyYW5zaXRpb25Nb2RlKSx0aGlzLl9jYWNoZVNlcnZpY2U9bnVsbCE9bz9vOm5ldyBUdyh0aGlzLl9ncmFwaFNlcnZpY2UsdGhpcy5fc3RhdGVTZXJ2aWNlLHRoaXMuX2FwaSksdGhpcy5fcGxheVNlcnZpY2U9bnVsbCE9YT9hOm5ldyBlZyh0aGlzLl9ncmFwaFNlcnZpY2UsdGhpcy5fc3RhdGVTZXJ2aWNlKSx0aGlzLl9wYW5TZXJ2aWNlPW51bGwhPWM/YzpuZXcgSXcodGhpcy5fZ3JhcGhTZXJ2aWNlLHRoaXMuX3N0YXRlU2VydmljZSxlLmNvbWJpbmVkUGFubmluZyksdGhpcy5faWRSZXF1ZXN0ZWQkPW5ldyBPKG51bGwpLHRoaXMuX21vdmVkVG9JZCQ9bmV3IE8obnVsbCksdGhpcy5fcmVxdWVzdCQ9bnVsbCx0aGlzLl9yZXF1ZXN0U3Vic2NyaXB0aW9uPW51bGwsdGhpcy5faW1hZ2VSZXF1ZXN0U3Vic2NyaXB0aW9uPW51bGx9Z2V0IGFwaSgpe3JldHVybiB0aGlzLl9hcGl9Z2V0IGNhY2hlU2VydmljZSgpe3JldHVybiB0aGlzLl9jYWNoZVNlcnZpY2V9Z2V0IGdyYXBoU2VydmljZSgpe3JldHVybiB0aGlzLl9ncmFwaFNlcnZpY2V9Z2V0IGxvYWRpbmdTZXJ2aWNlKCl7cmV0dXJuIHRoaXMuX2xvYWRpbmdTZXJ2aWNlfWdldCBtb3ZlZFRvSWQkKCl7cmV0dXJuIHRoaXMuX21vdmVkVG9JZCR9Z2V0IHBhblNlcnZpY2UoKXtyZXR1cm4gdGhpcy5fcGFuU2VydmljZX1nZXQgcGxheVNlcnZpY2UoKXtyZXR1cm4gdGhpcy5fcGxheVNlcnZpY2V9Z2V0IHN0YXRlU2VydmljZSgpe3JldHVybiB0aGlzLl9zdGF0ZVNlcnZpY2V9ZGlzcG9zZSgpe3RoaXMuX2Fib3J0UmVxdWVzdChcInZpZXdlciByZW1vdmVkXCIpLHRoaXMuX2NhY2hlU2VydmljZS5zdG9wKCksdGhpcy5fZ3JhcGhTZXJ2aWNlLmRpc3Bvc2UoKSx0aGlzLl9wYW5TZXJ2aWNlLmRpc3Bvc2UoKSx0aGlzLl9wbGF5U2VydmljZS5kaXNwb3NlKCksdGhpcy5fc3RhdGVTZXJ2aWNlLmRpc3Bvc2UoKX1tb3ZlVG8kKHQpe3RoaXMuX2Fib3J0UmVxdWVzdChgdG8gaWQgJHt0fWApLHRoaXMuX2xvYWRpbmdTZXJ2aWNlLnN0YXJ0TG9hZGluZyh0aGlzLl9sb2FkaW5nTmFtZSk7Y29uc3QgZT10aGlzLl9tb3ZlVG8kKHQpO3JldHVybiB0aGlzLl9tYWtlUmVxdWVzdCQoZSl9bW92ZURpciQoZSl7dGhpcy5fYWJvcnRSZXF1ZXN0KGBpbiBkaXIgJHt0Lk5hdmlnYXRpb25EaXJlY3Rpb25bZV19YCksdGhpcy5fbG9hZGluZ1NlcnZpY2Uuc3RhcnRMb2FkaW5nKHRoaXMuX2xvYWRpbmdOYW1lKTtjb25zdCBpPXRoaXMuc3RhdGVTZXJ2aWNlLmN1cnJlbnRJbWFnZSQucGlwZShFZSgpLE10KChpPT4oW3QuTmF2aWdhdGlvbkRpcmVjdGlvbi5OZXh0LHQuTmF2aWdhdGlvbkRpcmVjdGlvbi5QcmV2XS5pbmRleE9mKGUpPi0xP2kuc2VxdWVuY2VFZGdlcyQ6aS5zcGF0aWFsRWRnZXMkKS5waXBlKEVlKCkscnQoKHQ9Pntmb3IobGV0IGkgb2YgdC5lZGdlcylpZihpLmRhdGEuZGlyZWN0aW9uPT09ZSlyZXR1cm4gaS50YXJnZXQ7cmV0dXJuIG51bGx9KSkpKSksTXQoKHQ9Pm51bGw9PXQ/KHRoaXMuX2xvYWRpbmdTZXJ2aWNlLnN0b3BMb2FkaW5nKHRoaXMuX2xvYWRpbmdOYW1lKSxxKG5ldyBFcnJvcihgRGlyZWN0aW9uICgke2V9KSBkb2VzIG5vdCBleGlzdCBmb3IgY3VycmVudCBpbWFnZS5gKSkpOnRoaXMuX21vdmVUbyQodCkpKSk7cmV0dXJuIHRoaXMuX21ha2VSZXF1ZXN0JChpKX1zZXRGaWx0ZXIkKHQpe3JldHVybiB0aGlzLl9zdGF0ZVNlcnZpY2UuY2xlYXJJbWFnZXMoKSx0aGlzLl9tb3ZlZFRvSWQkLnBpcGUoRWUoKSxNdCgoZT0+bnVsbCE9ZT90aGlzLl90cmFqZWN0b3J5SWRzJCgpLnBpcGUoTXQoKGU9PnRoaXMuX2dyYXBoU2VydmljZS5zZXRGaWx0ZXIkKHQpLnBpcGUoTXQoKCgpPT50aGlzLl9jYWNoZUlkcyQoZSkpKSkpKSxSZSgpKTp0aGlzLl9pZFJlcXVlc3RlZCQucGlwZShFZSgpLE10KChlPT5udWxsIT1lP3RoaXMuX2dyYXBoU2VydmljZS5zZXRGaWx0ZXIkKHQpLnBpcGUoTXQoKCgpPT50aGlzLl9ncmFwaFNlcnZpY2UuY2FjaGVJbWFnZSQoZSkpKSk6dGhpcy5fZ3JhcGhTZXJ2aWNlLnNldEZpbHRlciQodCkucGlwZShydCgoKCk9Pnt9KSkpKSkpKSkscnQoKCgpPT57fSkpKX1zZXRBY2Nlc3NUb2tlbiQodCl7cmV0dXJuIHRoaXMuX2Fib3J0UmVxdWVzdChcInRvIHNldCB1c2VyIHRva2VuXCIpLHRoaXMuX3N0YXRlU2VydmljZS5jbGVhckltYWdlcygpLHRoaXMuX21vdmVkVG9JZCQucGlwZShFZSgpLHBpKCgoKT0+e3RoaXMuX2FwaS5zZXRBY2Nlc3NUb2tlbih0KX0pKSxNdCgodD0+bnVsbD09dD90aGlzLl9ncmFwaFNlcnZpY2UucmVzZXQkKFtdKTp0aGlzLl90cmFqZWN0b3J5SWRzJCgpLnBpcGUoTXQoKHQ9PnRoaXMuX2dyYXBoU2VydmljZS5yZXNldCQodCkucGlwZShNdCgoKCk9PnRoaXMuX2NhY2hlSWRzJCh0KSkpKSkpLFJlKCkscnQoKCgpPT57fSkpKSkpKX1fY2FjaGVJZHMkKHQpe3JldHVybiBidCh0Lm1hcCgodD0+dGhpcy5fZ3JhcGhTZXJ2aWNlLmNhY2hlSW1hZ2UkKHQpKSkpLnBpcGUoRXQoKSl9X2Fib3J0UmVxdWVzdCh0KXtudWxsIT10aGlzLl9yZXF1ZXN0U3Vic2NyaXB0aW9uJiYodGhpcy5fcmVxdWVzdFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpLHRoaXMuX3JlcXVlc3RTdWJzY3JpcHRpb249bnVsbCksbnVsbCE9dGhpcy5faW1hZ2VSZXF1ZXN0U3Vic2NyaXB0aW9uJiYodGhpcy5faW1hZ2VSZXF1ZXN0U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCksdGhpcy5faW1hZ2VSZXF1ZXN0U3Vic2NyaXB0aW9uPW51bGwpLG51bGwhPXRoaXMuX3JlcXVlc3QkJiYodGhpcy5fcmVxdWVzdCQuaXNTdG9wcGVkfHx0aGlzLl9yZXF1ZXN0JC5oYXNFcnJvcnx8dGhpcy5fcmVxdWVzdCQuZXJyb3IobmV3IFpmKGBSZXF1ZXN0IGFib3J0ZWQgYnkgYSBzdWJzZXF1ZW50IHJlcXVlc3QgJHt0fS5gKSksdGhpcy5fcmVxdWVzdCQ9bnVsbCl9X21ha2VSZXF1ZXN0JCh0KXtjb25zdCBlPW5ldyBKKDEpO3JldHVybiB0aGlzLl9yZXF1ZXN0U3Vic2NyaXB0aW9uPWUuc3Vic2NyaWJlKHZvaWQgMCwoKCk9Pnt9KSksdGhpcy5fcmVxdWVzdCQ9ZSx0aGlzLl9pbWFnZVJlcXVlc3RTdWJzY3JpcHRpb249dC5zdWJzY3JpYmUoKHQ9Pnt0aGlzLl9yZXF1ZXN0JD1udWxsLGUubmV4dCh0KSxlLmNvbXBsZXRlKCl9KSwodD0+e3RoaXMuX3JlcXVlc3QkPW51bGwsZS5lcnJvcih0KX0pKSxlfV9tb3ZlVG8kKHQpe3JldHVybiB0aGlzLl9pZFJlcXVlc3RlZCQubmV4dCh0KSx0aGlzLl9ncmFwaFNlcnZpY2UuY2FjaGVJbWFnZSQodCkucGlwZShwaSgodD0+e3RoaXMuX3N0YXRlU2VydmljZS5zZXRJbWFnZXMoW3RdKSx0aGlzLl9tb3ZlZFRvSWQkLm5leHQodC5pZCl9KSksTWUoKCgpPT57dGhpcy5fbG9hZGluZ1NlcnZpY2Uuc3RvcExvYWRpbmcodGhpcy5fbG9hZGluZ05hbWUpfSkpKX1fdHJhamVjdG9yeUlkcyQoKXtyZXR1cm4gdGhpcy5fc3RhdGVTZXJ2aWNlLmN1cnJlbnRTdGF0ZSQucGlwZShFZSgpLHJ0KCh0PT50LnN0YXRlLnRyYWplY3RvcnkubWFwKCh0PT50LmlkKSkpKSl9fWNsYXNzIGp3e2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5fc3BhdGlhbD1udWxsIT1lP2U6bmV3IGxkLHRoaXMuX3ZpZXdwb3J0Q29vcmRzPW51bGwhPXQ/dDpuZXcgV2Z9YmFzaWNUb0NhbnZhcyh0LGUsaSxuKXtyZXR1cm4gdGhpcy5fdmlld3BvcnRDb29yZHMuYmFzaWNUb0NhbnZhc1NhZmUodFswXSx0WzFdLGUsbixpLnBlcnNwZWN0aXZlKX1jYW52YXNUb0Jhc2ljKHQsZSxpLG4pe2xldCByPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1RvQmFzaWModFswXSx0WzFdLGUsbixpLnBlcnNwZWN0aXZlKTtyZXR1cm4oclswXTwwfHxyWzBdPjF8fHJbMV08MHx8clsxXT4xKSYmKHI9bnVsbCkscn1ldmVudFRvVW5wcm9qZWN0aW9uKHQsZSxpLG4scil7Y29uc3Qgcz10aGlzLl92aWV3cG9ydENvb3Jkcy5jYW52YXNQb3NpdGlvbih0LGUpO3JldHVybiB0aGlzLmNhbnZhc1RvVW5wcm9qZWN0aW9uKHMsZSxpLG4scil9Y2FudmFzVG9VbnByb2plY3Rpb24odCxlLGksbixyKXtjb25zdCBzPXRbMF0sbz10WzFdLFthLGNdPXRoaXMuX3ZpZXdwb3J0Q29vcmRzLmNhbnZhc1RvVmlld3BvcnQocyxvLGUpLGg9bmV3IGZuKGEsYywxKS51bnByb2plY3QoaS5wZXJzcGVjdGl2ZSk7bGV0IGw9ci5wcm9qZWN0QmFzaWMoaC50b0FycmF5KCkpOyhsWzBdPDB8fGxbMF0+MXx8bFsxXTwwfHxsWzFdPjEpJiYobD1udWxsKTtjb25zdCB1PWguY2xvbmUoKS5zdWIoaS5jYW1lcmEucG9zaXRpb24pLm5vcm1hbGl6ZSgpLGQ9LTIvdS56O2xldCBwPW51bGw7aWYoZD4wJiZkPDEwMCYmbCl7Y29uc3QgdD11LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoZCkuYWRkKGkuY2FtZXJhLnBvc2l0aW9uKSxbZSxyXT1LdSh0LngsdC55LHQueixuLmxuZyxuLmxhdCxuLmFsdCk7cD17bGF0OnIsbG5nOmV9fXJldHVybntiYXNpY1BvaW50OmwsbG5nTGF0OnAscGl4ZWxQb2ludDpbcyxvXX19Y2FtZXJhVG9MbmdMYXQodCxlKXtjb25zdCBpPXQuY2FtZXJhLnBvc2l0aW9uLFtuLHJdPUt1KGkueCxpLnksaS56LGUubG5nLGUubGF0LGUuYWx0KTtyZXR1cm57bGF0OnIsbG5nOm59fWxuZ0xhdFRvQ2FudmFzKHQsZSxpLG4pe2NvbnN0IHI9SnUodC5sbmcsdC5sYXQsMCxuLmxuZyxuLmxhdCxuLmFsdCk7cmV0dXJuIHRoaXMuX3ZpZXdwb3J0Q29vcmRzLnByb2plY3RUb0NhbnZhc1NhZmUocixlLGkucGVyc3BlY3RpdmUpfWRpc3RhbmNlQmV0d2VlbkxuZ0xhdHModCxlKXtyZXR1cm4gdGhpcy5fc3BhdGlhbC5kaXN0YW5jZUZyb21MbmdMYXQodC5sbmcsdC5sYXQsZS5sbmcsZS5sYXQpfX1jbGFzcyBId3tjb25zdHJ1Y3Rvcih0LGUsaSl7dGhpcy5fc3Vic2NyaXB0aW9ucz1uZXcgVWYsdGhpcy5fZW1pdFN1YnNjcmlwdGlvbnM9bmV3IFVmLHRoaXMuX2NvbnRhaW5lcj1pLHRoaXMuX3ZpZXdlcj10LHRoaXMuX25hdmlnYXRvcj1lLHRoaXMuX3Byb2plY3Rpb249bmV3IGp3LHRoaXMuX3N0YXJ0ZWQ9ITEsdGhpcy5fbmF2aWdhYmxlJD1uZXcgVDtjb25zdCBuPXRoaXMuX3N1YnNjcmlwdGlvbnM7bi5wdXNoKHRoaXMuX25hdmlnYWJsZSQuc3Vic2NyaWJlKCh0PT57Y29uc3QgZT1cIm5hdmlnYWJsZVwiLGk9e25hdmlnYWJsZTp0LHRhcmdldDp0aGlzLl92aWV3ZXIsdHlwZTplfTt0aGlzLl92aWV3ZXIuZmlyZShlLGkpfSkpKSxuLnB1c2godGhpcy5fbmF2aWdhdG9yLmxvYWRpbmdTZXJ2aWNlLmxvYWRpbmckLnN1YnNjcmliZSgodD0+e2NvbnN0IGU9XCJkYXRhbG9hZGluZ1wiLGk9e2xvYWRpbmc6dCx0YXJnZXQ6dGhpcy5fdmlld2VyLHR5cGU6ZX07dGhpcy5fdmlld2VyLmZpcmUoZSxpKX0pKSksbi5wdXNoKHRoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLm9wYXF1ZVJlbmRlciQucGlwZShFZSgpKS5zdWJzY3JpYmUoKCgpPT57Y29uc3QgdD1cImxvYWRcIixlPXt0YXJnZXQ6dGhpcy5fdmlld2VyLHR5cGU6dH07dGhpcy5fdmlld2VyLmZpcmUodCxlKX0pKSl9Z2V0IHN0YXJ0ZWQoKXtyZXR1cm4gdGhpcy5fc3RhcnRlZH1nZXQgbmF2aWdhYmxlJCgpe3JldHVybiB0aGlzLl9uYXZpZ2FibGUkfWdldCBwcm9qZWN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2plY3Rpb259ZGlzcG9zZSgpe3RoaXMuc3RvcEVtaXQoKSx0aGlzLl9zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCl9cHJvamVjdCQodCl7cmV0dXJuIGd0KHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCkucGlwZShFZSgpLHJ0KCgoW2UsaSxuXSk9PntpZih0aGlzLl9wcm9qZWN0aW9uLmRpc3RhbmNlQmV0d2VlbkxuZ0xhdHModCxpLmxuZ0xhdCk+MWUzKXJldHVybiBudWxsO2NvbnN0IHI9dGhpcy5fcHJvamVjdGlvbi5sbmdMYXRUb0NhbnZhcyh0LHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIsZSxuKTtyZXR1cm4gcj9bTWF0aC5yb3VuZChyWzBdKSxNYXRoLnJvdW5kKHJbMV0pXTpudWxsfSkpKX1wcm9qZWN0QmFzaWMkKHQpe3JldHVybiBndCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudFRyYW5zZm9ybSQpLnBpcGUoRWUoKSxydCgoKFtlLGldKT0+e2NvbnN0IG49dGhpcy5fcHJvamVjdGlvbi5iYXNpY1RvQ2FudmFzKHQsdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcixlLGkpO3JldHVybiBuP1tNYXRoLnJvdW5kKG5bMF0pLE1hdGgucm91bmQoblsxXSldOm51bGx9KSkpfXN0YXJ0RW1pdCgpe2lmKHRoaXMuX3N0YXJ0ZWQpcmV0dXJuO3RoaXMuX3N0YXJ0ZWQ9ITA7Y29uc3QgdD10aGlzLl9lbWl0U3Vic2NyaXB0aW9uczt0LnB1c2godGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2VFeHRlcm5hbCQuc3Vic2NyaWJlKCh0PT57Y29uc3QgZT1cImltYWdlXCIsaT17aW1hZ2U6dCx0YXJnZXQ6dGhpcy5fdmlld2VyLHR5cGU6ZX07dGhpcy5fdmlld2VyLmZpcmUoZSxpKX0pKSksdC5wdXNoKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlRXh0ZXJuYWwkLnBpcGUocmkoKHQ9PnQuc2VxdWVuY2VFZGdlcyQpKSkuc3Vic2NyaWJlKCh0PT57Y29uc3QgZT1cInNlcXVlbmNlZWRnZXNcIixpPXtzdGF0dXM6dCx0YXJnZXQ6dGhpcy5fdmlld2VyLHR5cGU6ZX07dGhpcy5fdmlld2VyLmZpcmUoZSxpKX0pKSksdC5wdXNoKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VycmVudEltYWdlRXh0ZXJuYWwkLnBpcGUocmkoKHQ9PnQuc3BhdGlhbEVkZ2VzJCkpKS5zdWJzY3JpYmUoKHQ9Pntjb25zdCBlPVwic3BhdGlhbGVkZ2VzXCIsaT17c3RhdHVzOnQsdGFyZ2V0OnRoaXMuX3ZpZXdlcix0eXBlOmV9O3RoaXMuX3ZpZXdlci5maXJlKGUsaSl9KSkpLHQucHVzaChndCh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmluTW90aW9uJCx0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmFjdGl2ZSQsdGhpcy5fY29udGFpbmVyLnRvdWNoU2VydmljZS5hY3RpdmUkKS5waXBlKHJ0KCh0PT50WzBdfHx0WzFdfHx0WzJdKSksdWUoKSkuc3Vic2NyaWJlKCh0PT57Y29uc3QgZT10P1wibW92ZXN0YXJ0XCI6XCJtb3ZlZW5kXCIsaT17dGFyZ2V0OnRoaXMuX3ZpZXdlcix0eXBlOmV9O3RoaXMuX3ZpZXdlci5maXJlKGUsaSl9KSkpLHQucHVzaCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5iZWFyaW5nJC5waXBlKFd0KDEwMCksdWUoKCh0LGUpPT5NYXRoLmFicyhlLXQpPDEpKSkuc3Vic2NyaWJlKCh0PT57Y29uc3QgZT1cImJlYXJpbmdcIixpPXtiZWFyaW5nOnQsdGFyZ2V0OnRoaXMuX3ZpZXdlcix0eXBlOmV9O3RoaXMuX3ZpZXdlci5maXJlKGUsaSl9KSkpO2NvbnN0IGU9dGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5hY3RpdmUkLnBpcGUocmkoKHQ9PnQ/QigpOnRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VNb3ZlJCkpKTt0LnB1c2goT3QodGhpcy5fbWFwTW91c2VFdmVudCQoXCJjbGlja1wiLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2Uuc3RhdGljQ2xpY2skKSx0aGlzLl9tYXBNb3VzZUV2ZW50JChcImNvbnRleHRtZW51XCIsdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5jb250ZXh0TWVudSQpLHRoaXMuX21hcE1vdXNlRXZlbnQkKFwiZGJsY2xpY2tcIix0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLmRibENsaWNrJCksdGhpcy5fbWFwTW91c2VFdmVudCQoXCJtb3VzZWRvd25cIix0aGlzLl9jb250YWluZXIubW91c2VTZXJ2aWNlLm1vdXNlRG93biQpLHRoaXMuX21hcE1vdXNlRXZlbnQkKFwibW91c2Vtb3ZlXCIsZSksdGhpcy5fbWFwTW91c2VFdmVudCQoXCJtb3VzZW91dFwiLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VPdXQkKSx0aGlzLl9tYXBNb3VzZUV2ZW50JChcIm1vdXNlb3ZlclwiLHRoaXMuX2NvbnRhaW5lci5tb3VzZVNlcnZpY2UubW91c2VPdmVyJCksdGhpcy5fbWFwTW91c2VFdmVudCQoXCJtb3VzZXVwXCIsdGhpcy5fY29udGFpbmVyLm1vdXNlU2VydmljZS5tb3VzZVVwJCkpLnBpcGUoYmkodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0YXRlJCkscnQoKChbW3QsZV0saSxuLHIsc10pPT57Y29uc3Qgbz10aGlzLl9wcm9qZWN0aW9uLmV2ZW50VG9VbnByb2plY3Rpb24oZSx0aGlzLl9jb250YWluZXIuY29udGFpbmVyLGksbixyKTtyZXR1cm57YmFzaWNQb2ludDpzPT09dm0uVHJhdmVyc2luZz9vLmJhc2ljUG9pbnQ6bnVsbCxsbmdMYXQ6by5sbmdMYXQsb3JpZ2luYWxFdmVudDplLHBpeGVsUG9pbnQ6by5waXhlbFBvaW50LHRhcmdldDp0aGlzLl92aWV3ZXIsdHlwZTp0fX0pKSkuc3Vic2NyaWJlKCh0PT57dGhpcy5fdmlld2VyLmZpcmUodC50eXBlLHQpfSkpKSx0LnB1c2godGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJC5waXBlKHVlKCgoW3QsZV0sW2ksbl0pPT50aGlzLl9jbG9zZVRvKHQsaSwuMDEpJiZ0aGlzLl9jbG9zZVRvKGUsbiwuMDEpKSwodD0+dC5jYW1lcmEucG9zaXRpb24udG9BcnJheSgpKSkpLnN1YnNjcmliZSgoKCk9Pntjb25zdCB0PVwicG9zaXRpb25cIixlPXt0YXJnZXQ6dGhpcy5fdmlld2VyLHR5cGU6dH07dGhpcy5fdmlld2VyLmZpcmUodCxlKX0pKSksdC5wdXNoKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQucGlwZSh1ZSgoKFt0LGVdLFtpLG5dKT0+dGhpcy5fY2xvc2VUbyh0LGksLjAwMSkmJnRoaXMuX2Nsb3NlVG8oZSxuLC4wMDEpKSwodD0+W3Qucm90YXRpb24ucGhpLHQucm90YXRpb24udGhldGFdKSkpLnN1YnNjcmliZSgoKCk9Pntjb25zdCB0PXt0YXJnZXQ6dGhpcy5fdmlld2VyLHR5cGU6XCJwb3ZcIn07dGhpcy5fdmlld2VyLmZpcmUoXCJwb3ZcIix0KX0pKSksdC5wdXNoKHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQucGlwZSh1ZSgoKHQsZSk9PnRoaXMuX2Nsb3NlVG8odCxlLC4wMSkpLCh0PT50LnBlcnNwZWN0aXZlLmZvdikpKS5zdWJzY3JpYmUoKCgpPT57Y29uc3QgdD17dGFyZ2V0OnRoaXMuX3ZpZXdlcix0eXBlOlwiZm92XCJ9O3RoaXMuX3ZpZXdlci5maXJlKFwiZm92XCIsdCl9KSkpfXN0b3BFbWl0KCl7dGhpcy5zdGFydGVkJiYodGhpcy5fZW1pdFN1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKSx0aGlzLl9zdGFydGVkPSExKX11bnByb2plY3QkKHQpe3JldHVybiBndCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmN1cnJlbnRUcmFuc2Zvcm0kKS5waXBlKEVlKCkscnQoKChbZSxpLG5dKT0+dGhpcy5fcHJvamVjdGlvbi5jYW52YXNUb1VucHJvamVjdGlvbih0LHRoaXMuX2NvbnRhaW5lci5jb250YWluZXIsZSxpLG4pLmxuZ0xhdCkpKX11bnByb2plY3RCYXNpYyQodCl7cmV0dXJuIGd0KHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLnJlbmRlckNhbWVyYSQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50VHJhbnNmb3JtJCkucGlwZShFZSgpLHJ0KCgoW2UsaV0pPT50aGlzLl9wcm9qZWN0aW9uLmNhbnZhc1RvQmFzaWModCx0aGlzLl9jb250YWluZXIuY29udGFpbmVyLGUsaSkpKSl9X2Nsb3NlVG8odCxlLGkpe3JldHVybiBNYXRoLmFicyh0LWUpPD1pfV9tYXBNb3VzZUV2ZW50JCh0LGUpe3JldHVybiBlLnBpcGUocnQoKGU9Plt0LGVdKSkpfX1jbGFzcyBVd3tjb25zdHJ1Y3Rvcih0LGUpe3RoaXMuX2NvbnRhaW5lcj10LHRoaXMuX25hdmlnYXRvcj1lLHRoaXMuX3JlbmRlcmVycz17fX1hZGQodCxlKXtjb25zdCBpPW5ldyBVZjt0aGlzLl9yZW5kZXJlcnNbdC5pZF09e3N1YnM6aSxyZW5kZXJlcjp0fSxpLnB1c2goZ3QoW3RoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLndlYkdMUmVuZGVyZXIkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJF0pLnBpcGUodmUoMSkpLnN1YnNjcmliZSgoKFtpLG5dKT0+e3Qub25BZGQoZSxuLGkuZ2V0Q29udGV4dCgpKX0pKSksaS5wdXNoKHRoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLm9wYXF1ZVJlbmRlciQucGlwZShiaSh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLndlYkdMUmVuZGVyZXIkKSkuc3Vic2NyaWJlKCgoWyxlLGldKT0+e2NvbnN0IG49aS5nZXRDb250ZXh0KCkscj1lLnBlcnNwZWN0aXZlLm1hdHJpeFdvcmxkSW52ZXJzZSxzPWUucGVyc3BlY3RpdmUucHJvamVjdGlvbk1hdHJpeDt0LnJlbmRlcihuLHIudG9BcnJheSgpLHMudG9BcnJheSgpKX0pKSksaS5wdXNoKHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJC5waXBlKEplKDEpKS5zdWJzY3JpYmUoKGk9Pnt0Lm9uUmVmZXJlbmNlKGUsaSl9KSkpfWRpc3Bvc2UodCl7Zm9yKGNvbnN0IGUgb2YgT2JqZWN0LmtleXModGhpcy5fcmVuZGVyZXJzKSl0aGlzLnJlbW92ZShlLHQpfWhhcyh0KXtyZXR1cm4gdCBpbiB0aGlzLl9yZW5kZXJlcnN9cmVtb3ZlKHQsZSl7dGhpcy5fcmVuZGVyZXJzW3RdLnN1YnMudW5zdWJzY3JpYmUoKTtjb25zdCBpPXRoaXMuX3JlbmRlcmVyc1t0XS5yZW5kZXJlcjtkZWxldGUgdGhpcy5fcmVuZGVyZXJzW3RdLHRoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLndlYkdMUmVuZGVyZXIkLnN1YnNjcmliZSgodD0+e2kub25SZW1vdmUoZSx0LmdldENvbnRleHQoKSl9KSl9fWNsYXNzIFZ3e2NvbnN0cnVjdG9yKHQsZSl7dGhpcy5fY29udGFpbmVyPXQsdGhpcy5fbmF2aWdhdG9yPWUsdGhpcy5fY29udHJvbHM9bnVsbCx0aGlzLl9zdWJzY3JpcHRpb25zPW5ldyBVZn1hdHRhY2godCxlKXtpZih0aGlzLl9jb250cm9scyl0aHJvdyBuZXcgY2QoXCJDdXN0b20gY2FtZXJhIGNvbnRyb2xzIGFscmVhZHkgYXR0YWNoZWRcIik7Y29uc3QgaT1uZXcgVCxuPWkucGlwZShyaSgoKCk9PnRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhdGUkKSkscnQoKHQ9PnQ9PT12bS5DdXN0b20pKSx1ZSgpKSxyPXRoaXMuX3N1YnNjcmlwdGlvbnM7ci5wdXNoKG4ucGlwZShuaSghMSksemUoKSxiaSh0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQsdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCkpLnN1YnNjcmliZSgoKFtbaSxuXSxyLHNdKT0+e24/dC5vbkFjdGl2YXRlKGUscy5wZXJzcGVjdGl2ZS5tYXRyaXhXb3JsZEludmVyc2UudG9BcnJheSgpLHMucGVyc3BlY3RpdmUucHJvamVjdGlvbk1hdHJpeC50b0FycmF5KCkscik6aSYmdC5vbkRlYWN0aXZhdGUoZSl9KSkpLHIucHVzaChuLnBpcGUocmkoKHQ9PnQ/dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50U3RhdGUkLnBpcGUoSmUoMSkpOkIoKSkpKS5zdWJzY3JpYmUoKGk9Pnt0Lm9uQW5pbWF0aW9uRnJhbWUoZSxpLmlkKX0pKSksci5wdXNoKG4ucGlwZShyaSgodD0+dD90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQucGlwZShKZSgxKSk6QigpKSkpLnN1YnNjcmliZSgoaT0+dC5vblJlZmVyZW5jZShlLGkpKSkpLHIucHVzaChuLnBpcGUocmkoKHQ9PnQ/dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2Uuc2l6ZSQucGlwZShKZSgxKSk6QigpKSkpLnN1YnNjcmliZSgoKCk9PnQub25SZXNpemUoZSkpKSksci5wdXNoKGd0KFt0aGlzLl9jb250YWluZXIuZ2xSZW5kZXJlci53ZWJHTFJlbmRlcmVyJCx0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UucmVmZXJlbmNlJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0YXRlJF0pLnBpcGUoRWUoKSkuc3Vic2NyaWJlKCgoKT0+e3Qub25BdHRhY2goZSwoZT0+e3RoaXMuX2NvbnRyb2xzJiZ0PT09dGhpcy5fY29udHJvbHMmJnRoaXMuX3VwZGF0ZVZpZXdNYXRyaXgoZSl9KSwoZT0+e3RoaXMuX2NvbnRyb2xzJiZ0PT09dGhpcy5fY29udHJvbHMmJnRoaXMuX3VwZGF0ZVByb2plY3Rpb25NYXRyaXgoZSl9KSksaS5uZXh0KCksaS5jb21wbGV0ZSgpfSkpKSx0aGlzLl9jb250cm9scz10fWRpc3Bvc2UodCl7dGhpcy5kZXRhY2godCl9ZGV0YWNoKHQpe3RoaXMuX2NvbnRyb2xzJiYodGhpcy5fc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpLHRoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2Uuc3RhdGUkLnN1YnNjcmliZSgoZT0+e2U9PT12bS5DdXN0b20mJnRoaXMuX2NvbnRyb2xzLm9uRGVhY3RpdmF0ZSh0KSx0aGlzLl9jb250cm9scy5vbkRldGFjaCh0KSx0aGlzLl9jb250cm9scz1udWxsfSkpKX1fdXBkYXRlUHJvamVjdGlvbk1hdHJpeCh0KXt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0YXRlJC5waXBlKEVlKCkpLnN1YnNjcmliZSgoZT0+e2lmKGU9PT12bS5DdXN0b20pdGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucHJvamVjdGlvbk1hdHJpeCQubmV4dCh0KTtlbHNle2NvbnN0IHQ9XCJJbmNvcnJlY3QgY2FtZXJhIGNvbnRyb2wgbW9kZSBmb3IgcHJvamVjdGlvbiBtYXRyaXggdXBkYXRlXCI7Y29uc29sZS53YXJuKHQpfX0pKX1fdXBkYXRlVmlld01hdHJpeCh0KXt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnN0YXRlJC5waXBlKEVlKCkpLnN1YnNjcmliZSgoZT0+e2lmKGU9PT12bS5DdXN0b20pdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zZXRWaWV3TWF0cml4KHQpO2Vsc2V7Y29uc3QgdD1cIkluY29ycmVjdCBjYW1lcmEgY29udHJvbCBtb2RlIGZvciB2aWV3IG1hdHJpeCB1cGRhdGVcIjtjb25zb2xlLndhcm4odCl9fSkpfX12ZC5yZWdpc3RlcihrZCkseWQucmVnaXN0ZXIoa2QpLHFkLnJlZ2lzdGVyKEZkKSxXZC5yZWdpc3RlckNvdmVyKEdmKSxXZC5yZWdpc3RlcihxZiksV2QucmVnaXN0ZXIoWGYpLFdkLnJlZ2lzdGVyKFlmKSxXZC5yZWdpc3RlcihRZiksV2QucmVnaXN0ZXIoTW0pLFdkLnJlZ2lzdGVyKFBtKSxXZC5yZWdpc3RlcihMbSksV2QucmVnaXN0ZXIoV20pLFdkLnJlZ2lzdGVyKFltKSxXZC5yZWdpc3RlcihKbSksV2QucmVnaXN0ZXIodGcpLFdkLnJlZ2lzdGVyKGJnKSxXZC5yZWdpc3RlcihTdiksV2QucmVnaXN0ZXIoTXYpLFdkLnJlZ2lzdGVyKFR2KSxXZC5yZWdpc3RlcihDdiksdC5Bcmd1bWVudE1hcGlsbGFyeUVycm9yPWhkLHQuQmVhcmluZ0NvbXBvbmVudD1YZix0LkNhY2hlQ29tcG9uZW50PVlmLHQuQ2FuY2VsTWFwaWxsYXJ5RXJyb3I9WmYsdC5DaXJjbGVNYXJrZXI9Y2xhc3MgZXh0ZW5kcyBvd3tjb25zdHJ1Y3Rvcih0LGUsaSl7c3VwZXIodCxlKSxpPWl8fHt9LHRoaXMuX2NvbG9yPW51bGwhPWkuY29sb3I/aS5jb2xvcjoxNjc3NzIxNSx0aGlzLl9vcGFjaXR5PW51bGwhPWkub3BhY2l0eT9pLm9wYWNpdHk6LjQsdGhpcy5fcmFkaXVzPW51bGwhPWkucmFkaXVzP2kucmFkaXVzOjF9X2NyZWF0ZUdlb21ldHJ5KHQpe2NvbnN0IGU9bmV3IEVzKG5ldyBzaCh0aGlzLl9yYWRpdXMsMTYpLG5ldyBGcih7Y29sb3I6dGhpcy5fY29sb3Isb3BhY2l0eTp0aGlzLl9vcGFjaXR5LHRyYW5zcGFyZW50OiEwfSkpO2UudXAuZnJvbUFycmF5KFswLDAsMV0pLGUucmVuZGVyT3JkZXI9LTE7Y29uc3QgaT1uZXcgcHI7aS5hZGQoZSksaS5wb3NpdGlvbi5mcm9tQXJyYXkodCksdGhpcy5fZ2VvbWV0cnk9aX1fZGlzcG9zZUdlb21ldHJ5KCl7Zm9yKGxldCB0IG9mIHRoaXMuX2dlb21ldHJ5LmNoaWxkcmVuKXQuZ2VvbWV0cnkuZGlzcG9zZSgpLHQubWF0ZXJpYWwuZGlzcG9zZSgpfV9nZXRJbnRlcmFjdGl2ZU9iamVjdHMoKXtyZXR1cm5bXX19LHQuQ29tcG9uZW50PVZmLHQuRGF0YVByb3ZpZGVyQmFzZT1ReCx0LkRpcmVjdGlvbkNvbXBvbmVudD1RZix0LkRyYWdQYW5IYW5kbGVyPVVtLHQuRXh0cmVtZVBvaW50VGFnPWF2LHQuR2VvbWV0cnk9eGcsdC5HZW9tZXRyeVByb3ZpZGVyQmFzZT1LeCx0Lkdlb21ldHJ5VGFnRXJyb3I9d2csdC5HcmFwaERhdGFQcm92aWRlcj1zdyx0LkdyYXBoTWFwaWxsYXJ5RXJyb3I9X2QsdC5JbWFnZT1lZCx0LktleVBsYXlIYW5kbGVyPUFtLHQuS2V5U2VxdWVuY2VOYXZpZ2F0aW9uSGFuZGxlcj1DbSx0LktleVNwYXRpYWxOYXZpZ2F0aW9uSGFuZGxlcj1FbSx0LktleVpvb21IYW5kbGVyPUltLHQuS2V5Ym9hcmRDb21wb25lbnQ9UG0sdC5NYXBpbGxhcnlFcnJvcj1jZCx0Lk1hcmtlcj1vdyx0Lk1hcmtlckNvbXBvbmVudD1MbSx0Lk91dGxpbmVUYWc9aHYsdC5Qb2ludEdlb21ldHJ5PXB2LHQuUG9pbnRlckNvbXBvbmVudD1XbSx0LlBvaW50c0dlb21ldHJ5PVNnLHQuUG9seWdvbkdlb21ldHJ5PVhfLHQuUG9wdXA9Y2xhc3N7Y29uc3RydWN0b3IodCxlLGkpe3RoaXMuX29wdGlvbnM9e30sdD10fHx7fSx0aGlzLl9vcHRpb25zLmNhcHR1cmVQb2ludGVyPSExIT09dC5jYXB0dXJlUG9pbnRlcnx8dC5jYXB0dXJlUG9pbnRlcix0aGlzLl9vcHRpb25zLmNsZWFuPXQuY2xlYW4sdGhpcy5fb3B0aW9ucy5mbG9hdD10LmZsb2F0LHRoaXMuX29wdGlvbnMub2Zmc2V0PXQub2Zmc2V0LHRoaXMuX29wdGlvbnMub3BhY2l0eT10Lm9wYWNpdHksdGhpcy5fb3B0aW9ucy5wb3NpdGlvbj10LnBvc2l0aW9uLHRoaXMuX2RvbT1pfHxuZXcgWG0sdGhpcy5fdmlld3BvcnRDb29yZHM9ZXx8bmV3IFdmLHRoaXMuX25vdGlmeUNoYW5nZWQkPW5ldyBUfWdldCBjaGFuZ2VkJCgpe3JldHVybiB0aGlzLl9ub3RpZnlDaGFuZ2VkJH1yZW1vdmUoKXt0aGlzLl9jb250ZW50JiZ0aGlzLl9jb250ZW50LnBhcmVudE5vZGUmJnRoaXMuX2NvbnRlbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLl9jb250ZW50KSx0aGlzLl9jb250YWluZXImJih0aGlzLl9jb250YWluZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLl9jb250YWluZXIpLGRlbGV0ZSB0aGlzLl9jb250YWluZXIpLHRoaXMuX3BhcmVudENvbnRhaW5lciYmZGVsZXRlIHRoaXMuX3BhcmVudENvbnRhaW5lcn1zZXRCYXNpY1BvaW50KHQpe3RoaXMuX3BvaW50PXQuc2xpY2UoKSx0aGlzLl9yZWN0PW51bGwsdGhpcy5fbm90aWZ5Q2hhbmdlZCQubmV4dCh0aGlzKX1zZXRCYXNpY1JlY3QodCl7dGhpcy5fcmVjdD10LnNsaWNlKCksdGhpcy5fcG9pbnQ9bnVsbCx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfXNldERPTUNvbnRlbnQodCl7dGhpcy5fY29udGVudCYmdGhpcy5fY29udGVudC5wYXJlbnROb2RlJiZ0aGlzLl9jb250ZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5fY29udGVudCk7Y29uc3QgZT1cIm1hcGlsbGFyeS1wb3B1cC1jb250ZW50XCIrKCEwPT09dGhpcy5fb3B0aW9ucy5jbGVhbj9cIi1jbGVhblwiOlwiXCIpKyghMD09PXRoaXMuX29wdGlvbnMuY2FwdHVyZVBvaW50ZXI/XCIgbWFwaWxsYXJ5LXBvcHVwLWNhcHR1cmUtcG9pbnRlclwiOlwiXCIpO3RoaXMuX2NvbnRlbnQ9dGhpcy5fZG9tLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIixlLHRoaXMuX2NvbnRhaW5lciksdGhpcy5fY29udGVudC5hcHBlbmRDaGlsZCh0KSx0aGlzLl9ub3RpZnlDaGFuZ2VkJC5uZXh0KHRoaXMpfXNldEhUTUwodCl7Y29uc3QgZT10aGlzLl9kb20uZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGk9dGhpcy5fZG9tLmNyZWF0ZUVsZW1lbnQoXCJib2R5XCIpO2xldCBuO2ZvcihpLmlubmVySFRNTD10O249aS5maXJzdENoaWxkLG47KWUuYXBwZW5kQ2hpbGQobik7dGhpcy5zZXRET01Db250ZW50KGUpfXNldFRleHQodCl7dGhpcy5zZXRET01Db250ZW50KHRoaXMuX2RvbS5kb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0KSl9c2V0UGFyZW50Q29udGFpbmVyKHQpe3RoaXMuX3BhcmVudENvbnRhaW5lcj10fXVwZGF0ZShlLGksbil7aWYoIXRoaXMuX3BhcmVudENvbnRhaW5lcnx8IXRoaXMuX2NvbnRlbnQpcmV0dXJuO2lmKCF0aGlzLl9wb2ludCYmIXRoaXMuX3JlY3QpcmV0dXJuO2lmKCF0aGlzLl9jb250YWluZXIpe3RoaXMuX2NvbnRhaW5lcj10aGlzLl9kb20uY3JlYXRlRWxlbWVudChcImRpdlwiLFwibWFwaWxsYXJ5LXBvcHVwXCIsdGhpcy5fcGFyZW50Q29udGFpbmVyKTtpZighMCE9PXRoaXMuX29wdGlvbnMuY2xlYW4mJnRoaXMuX29wdGlvbnMuZmxvYXQhPT10LkFsaWdubWVudC5DZW50ZXIpe2NvbnN0IHQ9XCJtYXBpbGxhcnktcG9wdXAtdGlwXCIrKCEwPT09dGhpcy5fb3B0aW9ucy5jYXB0dXJlUG9pbnRlcj9cIiBtYXBpbGxhcnktcG9wdXAtY2FwdHVyZS1wb2ludGVyXCI6XCJcIik7dGhpcy5fdGlwPXRoaXMuX2RvbS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsdCx0aGlzLl9jb250YWluZXIpLHRoaXMuX2RvbS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsXCJtYXBpbGxhcnktcG9wdXAtdGlwLWlubmVyXCIsdGhpcy5fdGlwKX10aGlzLl9jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5fY29udGVudCksdGhpcy5fcGFyZW50Q29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuX2NvbnRhaW5lciksbnVsbCE9dGhpcy5fb3B0aW9ucy5vcGFjaXR5JiYodGhpcy5fY29udGFpbmVyLnN0eWxlLm9wYWNpdHk9dGhpcy5fb3B0aW9ucy5vcGFjaXR5LnRvU3RyaW5nKCkpfWxldCByPW51bGwscz10aGlzLl9hbGlnbm1lbnRUb1BvcHVwQWxpZ21lbnQodGhpcy5fb3B0aW9ucy5wb3NpdGlvbiksbz10aGlzLl9hbGlnbm1lbnRUb1BvcHVwQWxpZ21lbnQodGhpcy5fb3B0aW9ucy5mbG9hdCk7Y29uc3QgYT10aGlzLl9jb250YWluZXIuY2xhc3NMaXN0O2lmKG51bGwhPXRoaXMuX3BvaW50KXI9dGhpcy5fdmlld3BvcnRDb29yZHMuYmFzaWNUb0NhbnZhc1NhZmUodGhpcy5fcG9pbnRbMF0sdGhpcy5fcG9pbnRbMV0se29mZnNldEhlaWdodDppLmhlaWdodCxvZmZzZXRXaWR0aDppLndpZHRofSxuLGUucGVyc3BlY3RpdmUpO2Vsc2V7Y29uc3QgdD1bXCJjZW50ZXJcIixcInRvcFwiLFwiYm90dG9tXCIsXCJsZWZ0XCIsXCJyaWdodFwiLFwidG9wLWxlZnRcIixcInRvcC1yaWdodFwiLFwiYm90dG9tLWxlZnRcIixcImJvdHRvbS1yaWdodFwiXTtsZXQgYz1udWxsO2Zvcihjb25zdCBlIG9mIHQpaWYoYS5jb250YWlucyhgbWFwaWxsYXJ5LXBvcHVwLWZsb2F0LSR7ZX1gKSl7Yz1lO2JyZWFrfVtyLHNdPXRoaXMuX3JlY3RUb1BpeGVsKHRoaXMuX3JlY3QscyxjLGUsaSxuKSxvfHwobz1zKX1pZihudWxsPT1yKXJldHVybiB2b2lkKHRoaXMuX2NvbnRhaW5lci5zdHlsZS5kaXNwbGF5PVwibm9uZVwiKTtpZih0aGlzLl9jb250YWluZXIuc3R5bGUuZGlzcGxheT1cIlwiLCFvKXtjb25zdCB0PXRoaXMuX2NvbnRhaW5lci5vZmZzZXRXaWR0aCxlPXRoaXMuX2NvbnRhaW5lci5vZmZzZXRIZWlnaHQsbj10aGlzLl9waXhlbFRvRmxvYXRzKHIsaSx0LGUpO289MD09PW4ubGVuZ3RoP1widG9wXCI6bi5qb2luKFwiLVwiKX1jb25zdCBjPXRoaXMuX25vcm1hbGl6ZU9mZnNldCh0aGlzLl9vcHRpb25zLm9mZnNldCk7cj1bclswXStjW29dWzBdLHJbMV0rY1tvXVsxXV0scj1bTWF0aC5yb3VuZChyWzBdKSxNYXRoLnJvdW5kKHJbMV0pXTtjb25zdCBoPXtib3R0b206XCJ0cmFuc2xhdGUoLTUwJSwwKVwiLFwiYm90dG9tLWxlZnRcIjpcInRyYW5zbGF0ZSgtMTAwJSwwKVwiLFwiYm90dG9tLXJpZ2h0XCI6XCJ0cmFuc2xhdGUoMCwwKVwiLGNlbnRlcjpcInRyYW5zbGF0ZSgtNTAlLC01MCUpXCIsbGVmdDpcInRyYW5zbGF0ZSgtMTAwJSwtNTAlKVwiLHJpZ2h0OlwidHJhbnNsYXRlKDAsLTUwJSlcIix0b3A6XCJ0cmFuc2xhdGUoLTUwJSwtMTAwJSlcIixcInRvcC1sZWZ0XCI6XCJ0cmFuc2xhdGUoLTEwMCUsLTEwMCUpXCIsXCJ0b3AtcmlnaHRcIjpcInRyYW5zbGF0ZSgwLC0xMDAlKVwifTtmb3IoY29uc3QgdCBpbiBoKWguaGFzT3duUHJvcGVydHkodCkmJmEucmVtb3ZlKGBtYXBpbGxhcnktcG9wdXAtZmxvYXQtJHt0fWApO2EuYWRkKGBtYXBpbGxhcnktcG9wdXAtZmxvYXQtJHtvfWApLHRoaXMuX2NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm09YCR7aFtvXX0gdHJhbnNsYXRlKCR7clswXX1weCwke3JbMV19cHgpYH1fcmVjdFRvUGl4ZWwodCxlLGksbixyLHMpe2lmKCFlKXtjb25zdCBlPXRoaXMuX2NvbnRhaW5lci5vZmZzZXRXaWR0aCxvPXRoaXMuX2NvbnRhaW5lci5vZmZzZXRIZWlnaHQsYT17Ym90dG9tOlswLG8vMl0sXCJib3R0b20tbGVmdFwiOlstZS8yLG8vMl0sXCJib3R0b20tcmlnaHRcIjpbZS8yLG8vMl0sbGVmdDpbLWUvMiwwXSxyaWdodDpbZS8yLDBdLHRvcDpbMCwtby8yXSxcInRvcC1sZWZ0XCI6Wy1lLzIsLW8vMl0sXCJ0b3AtcmlnaHRcIjpbZS8yLC1vLzJdfSxjPVtcInRvcFwiLFwiYm90dG9tXCIsXCJsZWZ0XCIsXCJyaWdodFwiXTtsZXQgaD1bMCxudWxsLG51bGxdO2Zvcihjb25zdCBsIG9mIGMpe2NvbnN0IGM9dGhpcy5fcG9pbnRGcm9tUmVjdFBvc2l0aW9uKHQsbCksdT10aGlzLl92aWV3cG9ydENvb3Jkcy5iYXNpY1RvQ2FudmFzU2FmZShjWzBdLGNbMV0se29mZnNldEhlaWdodDpyLmhlaWdodCxvZmZzZXRXaWR0aDpyLndpZHRofSxzLG4ucGVyc3BlY3RpdmUpO2lmKG51bGw9PXUpY29udGludWU7Y29uc3QgZD1hW2xdLHA9W3VbMF0rZFswXSx1WzFdK2RbMV1dLGY9bnVsbCE9aSYmaT09PWw/MTouNztpZigwPT09dGhpcy5fcGl4ZWxUb0Zsb2F0cyhwLHIsZS9mLG8vKDIqZikpLmxlbmd0aCYmdVswXT4wJiZ1WzBdPHIud2lkdGgmJnVbMV0+MCYmdVsxXTxyLmhlaWdodClyZXR1cm5bdSxsXTtjb25zdCBtPU1hdGgubWF4KHBbMF0tZS8yLDApLGc9TWF0aC5taW4ocFswXStlLzIsci53aWR0aCksXz1NYXRoLm1heChwWzFdLW8vMiwwKSx2PU1hdGgubWluKHBbMV0rby8yLHIuaGVpZ2h0KSx5PWYqTWF0aC5tYXgoMCxnLW0pKk1hdGgubWF4KDAsdi1fKTt5PmhbMF0mJihoWzBdPXksaFsxXT11LGhbMl09bCl9aWYoaFswXT4wKXJldHVybltoWzFdLGhbMl1dfWNvbnN0IG89dGhpcy5fcG9pbnRGcm9tUmVjdFBvc2l0aW9uKHQsZSk7cmV0dXJuW3RoaXMuX3ZpZXdwb3J0Q29vcmRzLmJhc2ljVG9DYW52YXNTYWZlKG9bMF0sb1sxXSx7b2Zmc2V0SGVpZ2h0OnIuaGVpZ2h0LG9mZnNldFdpZHRoOnIud2lkdGh9LHMsbi5wZXJzcGVjdGl2ZSksbnVsbCE9ZT9lOlwidG9wXCJdfV9hbGlnbm1lbnRUb1BvcHVwQWxpZ21lbnQoZSl7c3dpdGNoKGUpe2Nhc2UgdC5BbGlnbm1lbnQuQm90dG9tOnJldHVyblwiYm90dG9tXCI7Y2FzZSB0LkFsaWdubWVudC5Cb3R0b21MZWZ0OnJldHVyblwiYm90dG9tLWxlZnRcIjtjYXNlIHQuQWxpZ25tZW50LkJvdHRvbVJpZ2h0OnJldHVyblwiYm90dG9tLXJpZ2h0XCI7Y2FzZSB0LkFsaWdubWVudC5DZW50ZXI6cmV0dXJuXCJjZW50ZXJcIjtjYXNlIHQuQWxpZ25tZW50LkxlZnQ6cmV0dXJuXCJsZWZ0XCI7Y2FzZSB0LkFsaWdubWVudC5SaWdodDpyZXR1cm5cInJpZ2h0XCI7Y2FzZSB0LkFsaWdubWVudC5Ub3A6cmV0dXJuXCJ0b3BcIjtjYXNlIHQuQWxpZ25tZW50LlRvcExlZnQ6cmV0dXJuXCJ0b3AtbGVmdFwiO2Nhc2UgdC5BbGlnbm1lbnQuVG9wUmlnaHQ6cmV0dXJuXCJ0b3AtcmlnaHRcIjtkZWZhdWx0OnJldHVybiBudWxsfX1fbm9ybWFsaXplT2Zmc2V0KHQpe2lmKG51bGw9PXQpcmV0dXJuIHRoaXMuX25vcm1hbGl6ZU9mZnNldCgwKTtpZihcIm51bWJlclwiPT10eXBlb2YgdCl7Y29uc3QgZT10LGk9KGU+PTA/MTotMSkqTWF0aC5yb3VuZChNYXRoLnNxcnQoLjUqTWF0aC5wb3coZSwyKSkpO3JldHVybntib3R0b206WzAsZV0sXCJib3R0b20tbGVmdFwiOlstaSxpXSxcImJvdHRvbS1yaWdodFwiOltpLGldLGNlbnRlcjpbMCwwXSxsZWZ0OlstZSwwXSxyaWdodDpbZSwwXSx0b3A6WzAsLWVdLFwidG9wLWxlZnRcIjpbLWksLWldLFwidG9wLXJpZ2h0XCI6W2ksLWldfX1yZXR1cm57Ym90dG9tOnQuYm90dG9tfHxbMCwwXSxcImJvdHRvbS1sZWZ0XCI6dC5ib3R0b21MZWZ0fHxbMCwwXSxcImJvdHRvbS1yaWdodFwiOnQuYm90dG9tUmlnaHR8fFswLDBdLGNlbnRlcjp0LmNlbnRlcnx8WzAsMF0sbGVmdDp0LmxlZnR8fFswLDBdLHJpZ2h0OnQucmlnaHR8fFswLDBdLHRvcDp0LnRvcHx8WzAsMF0sXCJ0b3AtbGVmdFwiOnQudG9wTGVmdHx8WzAsMF0sXCJ0b3AtcmlnaHRcIjp0LnRvcFJpZ2h0fHxbMCwwXX19X3BpeGVsVG9GbG9hdHModCxlLGksbil7Y29uc3Qgcj1bXTtyZXR1cm4gdFsxXTxuP3IucHVzaChcImJvdHRvbVwiKTp0WzFdPmUuaGVpZ2h0LW4mJnIucHVzaChcInRvcFwiKSx0WzBdPGkvMj9yLnB1c2goXCJyaWdodFwiKTp0WzBdPmUud2lkdGgtaS8yJiZyLnB1c2goXCJsZWZ0XCIpLHJ9X3BvaW50RnJvbVJlY3RQb3NpdGlvbih0LGUpe2NvbnN0IGk9dFswXSxuPXRbMF08dFsyXT90WzJdOnRbMl0rMSxyPXRbMV0scz10WzNdO3N3aXRjaChlKXtjYXNlXCJib3R0b21cIjpyZXR1cm5bKGkrbikvMixzXTtjYXNlXCJib3R0b20tbGVmdFwiOnJldHVybltpLHNdO2Nhc2VcImJvdHRvbS1yaWdodFwiOnJldHVybltuLHNdO2Nhc2VcImNlbnRlclwiOnJldHVyblsoaStuKS8yLChyK3MpLzJdO2Nhc2VcImxlZnRcIjpyZXR1cm5baSwocitzKS8yXTtjYXNlXCJyaWdodFwiOnJldHVybltuLChyK3MpLzJdO2Nhc2VcInRvcFwiOnJldHVyblsoaStuKS8yLHJdO2Nhc2VcInRvcC1sZWZ0XCI6cmV0dXJuW2kscl07Y2FzZVwidG9wLXJpZ2h0XCI6cmV0dXJuW24scl07ZGVmYXVsdDpyZXR1cm5bKGkrbikvMixzXX19fSx0LlBvcHVwQ29tcG9uZW50PVltLHQuUmVjdEdlb21ldHJ5PXFfLHQuUzJHZW9tZXRyeVByb3ZpZGVyPWl3LHQuU2Nyb2xsWm9vbUhhbmRsZXI9R20sdC5TZXF1ZW5jZUNvbXBvbmVudD1KbSx0LlNpbXBsZU1hcmtlcj1jbGFzcyBleHRlbmRzIG93e2NvbnN0cnVjdG9yKHQsZSxpKXtzdXBlcih0LGUpLGk9aXx8e30sdGhpcy5fYmFsbENvbG9yPW51bGwhPWkuYmFsbENvbG9yP2kuYmFsbENvbG9yOjE2NzExNjgwLHRoaXMuX2JhbGxPcGFjaXR5PW51bGwhPWkuYmFsbE9wYWNpdHk/aS5iYWxsT3BhY2l0eTouOCx0aGlzLl9jaXJjbGVUb1JheUFuZ2xlPTIsdGhpcy5fY29sb3I9bnVsbCE9aS5jb2xvcj9pLmNvbG9yOjE2NzExNjgwLHRoaXMuX2ludGVyYWN0aXZlPSEhaS5pbnRlcmFjdGl2ZSx0aGlzLl9vcGFjaXR5PW51bGwhPWkub3BhY2l0eT9pLm9wYWNpdHk6LjQsdGhpcy5fcmFkaXVzPW51bGwhPWkucmFkaXVzP2kucmFkaXVzOjF9X2NyZWF0ZUdlb21ldHJ5KHQpe2NvbnN0IGU9dGhpcy5fcmFkaXVzLGk9dGhpcy5fbWFya2VySGVpZ2h0KGUpLG49bmV3IEZyKHtjb2xvcjp0aGlzLl9jb2xvcixvcGFjaXR5OnRoaXMuX29wYWNpdHksdHJhbnNwYXJlbnQ6ITAsZGVwdGhXcml0ZTohMX0pLHI9bmV3IEVzKHRoaXMuX2NyZWF0ZU1hcmtlckdlb21ldHJ5KGUsOCw4KSxuKSxzPW5ldyBFcyhuZXcgemgoZS8yLDgsOCksbmV3IEZyKHtjb2xvcjp0aGlzLl9iYWxsQ29sb3Isb3BhY2l0eTp0aGlzLl9iYWxsT3BhY2l0eSx0cmFuc3BhcmVudDohMH0pKTtzLnBvc2l0aW9uLno9aSxzLnJlbmRlck9yZGVyPTE7Y29uc3Qgbz1uZXcgcHI7by5hZGQocyksby5hZGQociksby5wb3NpdGlvbi5mcm9tQXJyYXkodCksdGhpcy5fZ2VvbWV0cnk9b31fZGlzcG9zZUdlb21ldHJ5KCl7Zm9yKGNvbnN0IHQgb2YgdGhpcy5fZ2VvbWV0cnkuY2hpbGRyZW4pdC5nZW9tZXRyeS5kaXNwb3NlKCksdC5tYXRlcmlhbC5kaXNwb3NlKCl9X2dldEludGVyYWN0aXZlT2JqZWN0cygpe3JldHVybiB0aGlzLl9pbnRlcmFjdGl2ZT9bdGhpcy5fZ2VvbWV0cnkuY2hpbGRyZW5bMF1dOltdfV9tYXJrZXJIZWlnaHQodCl7Y29uc3QgZT1NYXRoLnRhbihNYXRoLlBJLXRoaXMuX2NpcmNsZVRvUmF5QW5nbGUpO3JldHVybiB0Kk1hdGguc3FydCgxK2UqZSl9X2NyZWF0ZU1hcmtlckdlb21ldHJ5KHQsZSxpKXtjb25zdCBuPXRoaXMuX21hcmtlckhlaWdodCh0KSxyPXRoaXMuX2NpcmNsZVRvUmF5QW5nbGUscz1bXSxvPW5ldyBGbG9hdDMyQXJyYXkoMyooZSsxKSooaSsxKSk7bGV0IGE9MDtmb3IobGV0IGM9MDtjPD1pOysrYyl7Y29uc3QgaD1bXTtmb3IobGV0IHM9MDtzPD1lOysrcyl7Y29uc3QgbD1zL2UqTWF0aC5QSSoyLHU9Yy9pKk1hdGguUEk7bGV0IGQ9dDtpZih1PnIpe2NvbnN0IGU9TWF0aC50YW4odS1yKTtkPXQqTWF0aC5zcXJ0KDErZSplKX1jb25zdCBwPTMqYSxmPU1hdGguc2luKHUpO29bcCswXT1kKk1hdGguY29zKGwpKmYsb1twKzFdPWQqTWF0aC5zaW4obCkqZixvW3ArMl09ZCpNYXRoLmNvcyh1KStuLGgucHVzaChhKyspfXMucHVzaChoKX1jb25zdCBjPW5ldyBVaW50MTZBcnJheSg2KmUqaSk7bGV0IGg9MDtmb3IobGV0IHQ9MDt0PGk7Kyt0KWZvcihsZXQgaT0wO2k8ZTsrK2kpe2NvbnN0IGU9c1t0XVtpKzFdLG49c1t0XVtpXSxyPXNbdCsxXVtpXSxvPXNbdCsxXVtpKzFdO2NbaCsrXT1lLGNbaCsrXT1uLGNbaCsrXT1vLGNbaCsrXT1uLGNbaCsrXT1yLGNbaCsrXT1vfWNvbnN0IGw9bmV3IGhzLHU9bmV3IEhyKG8sMyk7cmV0dXJuIGwuc2V0QXR0cmlidXRlKFwicG9zaXRpb25cIix1KSxsLnNldEluZGV4KG5ldyBIcihjLDEpKSxsfX0sdC5TbGlkZXJDb21wb25lbnQ9dGcsdC5TcGF0aWFsQ29tcG9uZW50PWJnLHQuU3BvdFRhZz11dix0LlRhZz1vdix0LlRhZ0NvbXBvbmVudD1Tdix0LlRvdWNoWm9vbUhhbmRsZXI9cW0sdC5WZXJ0ZXhHZW9tZXRyeT1HXyx0LlZpZXdlcj1jbGFzcyBleHRlbmRzIEhme2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksdGhpcy5fbmF2aWdhdG9yPW5ldyBCdyh0KSx0aGlzLl9jb250YWluZXI9bmV3IE13KHQsdGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZSksdGhpcy5fb2JzZXJ2ZXI9bmV3IEh3KHRoaXMsdGhpcy5fbmF2aWdhdG9yLHRoaXMuX2NvbnRhaW5lciksdGhpcy5fY29tcG9uZW50Q29udHJvbGxlcj1uZXcgZHcodGhpcy5fY29udGFpbmVyLHRoaXMuX25hdmlnYXRvcix0aGlzLl9vYnNlcnZlcix0LmltYWdlSWQsdC5jb21wb25lbnQpLHRoaXMuX2N1c3RvbVJlbmRlcmVyPW5ldyBVdyh0aGlzLl9jb250YWluZXIsdGhpcy5fbmF2aWdhdG9yKSx0aGlzLl9jdXN0b21DYW1lcmFDb250cm9scz1uZXcgVncodGhpcy5fY29udGFpbmVyLHRoaXMuX25hdmlnYXRvcil9Z2V0IGlzTmF2aWdhYmxlKCl7cmV0dXJuIHRoaXMuX2NvbXBvbmVudENvbnRyb2xsZXIubmF2aWdhYmxlfWFjdGl2YXRlQ29tYmluZWRQYW5uaW5nKCl7dGhpcy5fbmF2aWdhdG9yLnBhblNlcnZpY2UuZW5hYmxlKCl9YWN0aXZhdGVDb21wb25lbnQodCl7dGhpcy5fY29tcG9uZW50Q29udHJvbGxlci5hY3RpdmF0ZSh0KX1hY3RpdmF0ZUNvdmVyKCl7dGhpcy5fY29tcG9uZW50Q29udHJvbGxlci5hY3RpdmF0ZUNvdmVyKCl9YWRkQ3VzdG9tUmVuZGVyZXIodCl7dGhpcy5fY3VzdG9tUmVuZGVyZXIuYWRkKHQsdGhpcyl9YXR0YWNoQ3VzdG9tQ2FtZXJhQ29udHJvbHModCl7dGhpcy5fY3VzdG9tQ2FtZXJhQ29udHJvbHMuYXR0YWNoKHQsdGhpcyl9ZGVhY3RpdmF0ZUNvbWJpbmVkUGFubmluZygpe3RoaXMuX25hdmlnYXRvci5wYW5TZXJ2aWNlLmRpc2FibGUoKX1kZWFjdGl2YXRlQ29tcG9uZW50KHQpe3RoaXMuX2NvbXBvbmVudENvbnRyb2xsZXIuZGVhY3RpdmF0ZSh0KX1kZWFjdGl2YXRlQ292ZXIoKXt0aGlzLl9jb21wb25lbnRDb250cm9sbGVyLmRlYWN0aXZhdGVDb3ZlcigpfWRldGFjaEN1c3RvbUNhbWVyYUNvbnRyb2xzKCl7dGhpcy5fY3VzdG9tQ2FtZXJhQ29udHJvbHMuZGV0YWNoKHRoaXMpfWZpcmUodCxlKXtzdXBlci5maXJlKHQsZSl9Z2V0QmVhcmluZygpe3JldHVybiBuZXcgUHJvbWlzZSgoKHQsZSk9Pnt0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5iZWFyaW5nJC5waXBlKEVlKCkpLnN1YnNjcmliZSgoZT0+e3QoZSl9KSwodD0+e2UodCl9KSl9KSl9Z2V0Q2FtZXJhQ29udHJvbHMoKXtyZXR1cm4gbmV3IFByb21pc2UoKChlLGkpPT57dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zdGF0ZSQucGlwZShFZSgpKS5zdWJzY3JpYmUoKGk9Pntzd2l0Y2goaSl7Y2FzZSB2bS5DdXN0b206ZSh0LkNhbWVyYUNvbnRyb2xzLkN1c3RvbSk7YnJlYWs7Y2FzZSB2bS5FYXJ0aDplKHQuQ2FtZXJhQ29udHJvbHMuRWFydGgpO2JyZWFrO2RlZmF1bHQ6ZSh0LkNhbWVyYUNvbnRyb2xzLlN0cmVldCl9fSksKHQ9PntpKHQpfSkpfSkpfWdldENhbnZhcygpe3JldHVybiB0aGlzLl9jb250YWluZXIuY2FudmFzfWdldENhbnZhc0NvbnRhaW5lcigpe3JldHVybiB0aGlzLl9jb250YWluZXIuY2FudmFzQ29udGFpbmVyfWdldENlbnRlcigpe3JldHVybiBuZXcgUHJvbWlzZSgoKHQsZSk9Pnt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLmdldENlbnRlcigpLnN1YnNjcmliZSgoZT0+e3QoZSl9KSwodD0+e2UodCl9KSl9KSl9Z2V0Q29tcG9uZW50KHQpe3JldHVybiB0aGlzLl9jb21wb25lbnRDb250cm9sbGVyLmdldCh0KX1nZXRDb250YWluZXIoKXtyZXR1cm4gdGhpcy5fY29udGFpbmVyLmNvbnRhaW5lcn1nZXRGaWVsZE9mVmlldygpe3JldHVybiBuZXcgUHJvbWlzZSgoKHQsZSk9Pnt0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLnBpcGUoRWUoKSkuc3Vic2NyaWJlKChlPT57dChlLnBlcnNwZWN0aXZlLmZvdil9KSwodD0+e2UodCl9KSl9KSl9Z2V0SW1hZ2UoKXtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGUpPT57dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5jdXJyZW50SW1hZ2UkLnBpcGUoRWUoKSkuc3Vic2NyaWJlKChlPT57dChlKX0pLCh0PT57ZSh0KX0pKX0pKX1nZXRQb2ludE9mVmlldygpe3JldHVybiBuZXcgUHJvbWlzZSgoKHQsZSk9PntndCh0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLHRoaXMuX2NvbnRhaW5lci5yZW5kZXJTZXJ2aWNlLmJlYXJpbmckKS5waXBlKEVlKCkpLnN1YnNjcmliZSgoKFtlLGldKT0+e3Qoe2JlYXJpbmc6aSx0aWx0OmUuZ2V0VGlsdCgpfSl9KSwodD0+e2UodCl9KSl9KSl9Z2V0UG9zaXRpb24oKXtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGUpPT57Z3QodGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyQ2FtZXJhJCx0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnJlZmVyZW5jZSQpLnBpcGUoRWUoKSkuc3Vic2NyaWJlKCgoW2UsaV0pPT57dCh0aGlzLl9vYnNlcnZlci5wcm9qZWN0aW9uLmNhbWVyYVRvTG5nTGF0KGUsaSkpfSksKHQ9PntlKHQpfSkpfSkpfWdldFpvb20oKXtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGUpPT57dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5nZXRab29tKCkuc3Vic2NyaWJlKChlPT57dChlKX0pLCh0PT57ZSh0KX0pKX0pKX1oYXNDdXN0b21SZW5kZXJlcih0KXtyZXR1cm4gdGhpcy5fY3VzdG9tUmVuZGVyZXIuaGFzKHQpfW1vdmVEaXIodCl7Y29uc3QgZT10aGlzLmlzTmF2aWdhYmxlP3RoaXMuX25hdmlnYXRvci5tb3ZlRGlyJCh0KTpxKG5ldyBFcnJvcihcIkNhbGxpbmcgbW92ZURpciBpcyBub3Qgc3VwcG9ydGVkIHdoZW4gdmlld2VyIGlzIG5vdCBuYXZpZ2FibGUuXCIpKTtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGkpPT57ZS5zdWJzY3JpYmUoKGU9Pnt0KGUpfSksKHQ9PntpKHQpfSkpfSkpfW1vdmVUbyh0KXtjb25zdCBlPXRoaXMuaXNOYXZpZ2FibGU/dGhpcy5fbmF2aWdhdG9yLm1vdmVUbyQodCk6cShuZXcgRXJyb3IoXCJDYWxsaW5nIG1vdmVUbyBpcyBub3Qgc3VwcG9ydGVkIHdoZW4gdmlld2VyIGlzIG5vdCBuYXZpZ2FibGUuXCIpKTtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGkpPT57ZS5zdWJzY3JpYmUoKGU9Pnt0KGUpfSksKHQ9PntpKHQpfSkpfSkpfW9mZih0LGUpe3N1cGVyLm9mZih0LGUpfW9uKHQsZSl7c3VwZXIub24odCxlKX1wcm9qZWN0KHQpe3JldHVybiBuZXcgUHJvbWlzZSgoKGUsaSk9Pnt0aGlzLl9vYnNlcnZlci5wcm9qZWN0JCh0KS5zdWJzY3JpYmUoKHQ9PntlKHQpfSksKHQ9PntpKHQpfSkpfSkpfXByb2plY3RGcm9tQmFzaWModCl7cmV0dXJuIG5ldyBQcm9taXNlKCgoZSxpKT0+e3RoaXMuX29ic2VydmVyLnByb2plY3RCYXNpYyQodCkuc3Vic2NyaWJlKCh0PT57ZSh0KX0pLCh0PT57aSh0KX0pKX0pKX1yZW1vdmUoKXt0aGlzLl9jdXN0b21SZW5kZXJlci5kaXNwb3NlKHRoaXMpLHRoaXMuX2N1c3RvbUNhbWVyYUNvbnRyb2xzLmRpc3Bvc2UodGhpcyksdGhpcy5fb2JzZXJ2ZXIuZGlzcG9zZSgpLHRoaXMuX2NvbXBvbmVudENvbnRyb2xsZXIucmVtb3ZlKCksdGhpcy5fbmF2aWdhdG9yLmRpc3Bvc2UoKSx0aGlzLl9jb250YWluZXIucmVtb3ZlKCk7Y29uc3QgdD1cInJlbW92ZVwiLGU9e3RhcmdldDp0aGlzLHR5cGU6dH07dGhpcy5maXJlKHQsZSl9cmVtb3ZlQ3VzdG9tUmVuZGVyZXIodCl7dGhpcy5fY3VzdG9tUmVuZGVyZXIucmVtb3ZlKHQsdGhpcyl9cmVzaXplKCl7dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVzaXplJC5uZXh0KCl9c2V0Q2FtZXJhQ29udHJvbHModCl7Y29uc3QgZT1Gdyh0KTtlPT09dm0uVHJhdmVyc2luZz90aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnRyYXZlcnNlKCk6ZT09PXZtLkVhcnRoP3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuZWFydGgoKTplPT09dm0uQ3VzdG9tP3RoaXMuX25hdmlnYXRvci5zdGF0ZVNlcnZpY2UuY3VzdG9tKCk6Y29uc29sZS53YXJuKGBVbnN1cHBvcnRlZCBjYW1lcmEgY29udHJvbCB0cmFuc2l0aW9uICgke3R9KWApfXNldENlbnRlcih0KXt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnNldENlbnRlcih0KX1zZXRGaWVsZE9mVmlldyh0KXt0aGlzLl9jb250YWluZXIucmVuZGVyU2VydmljZS5yZW5kZXJDYW1lcmEkLnBpcGUoRWUoKSkuc3Vic2NyaWJlKChlPT57Y29uc3QgaT1lLmZvdlRvWm9vbSh0KTt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnNldFpvb20oaSl9KSl9c2V0RmlsdGVyKHQpe3JldHVybiBuZXcgUHJvbWlzZSgoKGUsaSk9Pnt0aGlzLl9uYXZpZ2F0b3Iuc2V0RmlsdGVyJCh0KS5zdWJzY3JpYmUoKCgpPT57ZSh2b2lkIDApfSksKHQ9PntpKHQpfSkpfSkpfXNldFJlbmRlck1vZGUodCl7dGhpcy5fY29udGFpbmVyLnJlbmRlclNlcnZpY2UucmVuZGVyTW9kZSQubmV4dCh0KX1zZXRUcmFuc2l0aW9uTW9kZSh0KXt0aGlzLl9uYXZpZ2F0b3Iuc3RhdGVTZXJ2aWNlLnNldFRyYW5zaXRpb25Nb2RlKHQpfXNldEFjY2Vzc1Rva2VuKHQpe2NvbnN0IGU9dGhpcy5pc05hdmlnYWJsZT90aGlzLl9uYXZpZ2F0b3Iuc2V0QWNjZXNzVG9rZW4kKHQpOnEobmV3IEVycm9yKFwiQ2FsbGluZyBzZXRBY2Nlc3NUb2tlbiBpcyBub3Qgc3VwcG9ydGVkIHdoZW4gdmlld2VyIGlzIG5vdCBuYXZpZ2FibGUuXCIpKTtyZXR1cm4gbmV3IFByb21pc2UoKCh0LGkpPT57ZS5zdWJzY3JpYmUoKCgpPT57dCh2b2lkIDApfSksKHQ9PntpKHQpfSkpfSkpfXNldFpvb20odCl7dGhpcy5fbmF2aWdhdG9yLnN0YXRlU2VydmljZS5zZXRab29tKHQpfXRyaWdnZXJSZXJlbmRlcigpe3RoaXMuX2NvbnRhaW5lci5nbFJlbmRlcmVyLnRyaWdnZXJSZXJlbmRlcigpfXVucHJvamVjdCh0KXtyZXR1cm4gbmV3IFByb21pc2UoKChlLGkpPT57dGhpcy5fb2JzZXJ2ZXIudW5wcm9qZWN0JCh0KS5zdWJzY3JpYmUoKHQ9PntlKHQpfSksKHQ9PntpKHQpfSkpfSkpfXVucHJvamVjdFRvQmFzaWModCl7cmV0dXJuIG5ldyBQcm9taXNlKCgoZSxpKT0+e3RoaXMuX29ic2VydmVyLnVucHJvamVjdEJhc2ljJCh0KS5zdWJzY3JpYmUoKHQ9PntlKHQpfSksKHQ9PntpKHQpfSkpfSkpfX0sdC5ab29tQ29tcG9uZW50PU12LHQuZGVjb21wcmVzcz1XeCx0LmVudVRvR2VvZGV0aWM9S3UsdC5mZXRjaEFycmF5QnVmZmVyPVh4LHQuZ2VvZGV0aWNUb0VudT1KdSx0LmlzRmFsbGJhY2tTdXBwb3J0ZWQ9aHcsdC5pc1N1cHBvcnRlZD1mdW5jdGlvbigpe3JldHVybiBodygpJiZjdygpfSx0LnJlYWRNZXNoUGJmPVp4LE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pfSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFwaWxsYXJ5LmpzLm1hcFxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBIiwic291cmNlUm9vdCI6IiJ9